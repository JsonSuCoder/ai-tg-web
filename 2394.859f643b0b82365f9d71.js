"use strict";(self.webpackChunkTelyAI=self.webpackChunkTelyAI||[]).push([[2394],{127:(e,t,a)=>{a.d(t,{I:()=>n,c:()=>i});const n=new Uint16Array([55357,56841,55357,56845,55357,56859,55357,56877,55357,56881,55357,56865,55357,56846,55357,56884,55357,56885,55357,56840,55357,56876,55357,56839,55357,56847,55357,56430,55357,56439,55357,56450,55357,56438,55357,56424,55357,56425,55357,56436,55357,56437,55357,56891,55357,56893,55357,56896,55357,56442,55357,56904,55357,56905,55357,56906,55357,56448,55357,56445,55357,56489,55357,56613,55357,56485,55357,56484,55357,56386,55357,56384,55357,56387,55357,56389,55357,56388,55357,56397,55357,56398,55357,56396,55357,56394,9996,9995,55357,56400,55357,56390,55357,56391,55357,56393,55357,56392,55357,56911,55357,56399,55357,56490,55357,57014,55356,57283,55357,56451,55357,56427,55357,56426,55357,56428,55357,56429,55357,56453,55356,57257,55357,56401,55357,56402,55357,56415,55357,56414,55357,56416,55357,56405,55357,56407,55357,56406,55357,56409,55357,56412,55357,56403,55356,57216,55357,56452,55357,56475,55357,56473,55357,56476,55357,56474,55357,56461,55357,56462,55357,56374,55357,56378,55357,56369,55357,56365,55357,56377,55357,56368,55357,56376,55357,56367,55357,56360,55357,56379,55357,56375,55357,56366,55357,56343,55357,56372,55357,56337,55357,56344,55357,56380,55357,56359,55357,56357,55357,56340,55357,56333,55357,56354,55357,56347,55357,56349,55357,56348,55357,56350,55357,56332,55357,56345,55357,56346,55357,56351,55357,56364,55357,56331,55357,56336,55357,56330,55357,56363,55356,57152,55356,57145,55356,57147,55356,57153,55356,57150,55356,57156,55356,57141,55356,57140,55356,57139,55356,57118,55356,57114,55356,57113,55356,57102,55356,57099,9889,9748,10052,9924,55356,57088,55356,57096,55356,57098,55356,57235,55356,57222,55356,57219,55357,56443,55356,57221,55356,57220,55356,57217,55356,57224,55357,56622,55356,57253,55357,56567,55357,56511,55357,56507,9742,55357,56545,55357,56570,55357,56571,55357,56585,55357,56596,9203,9200,8986,55357,56594,55357,56593,55357,56590,55357,56481,55357,56614,55357,56588,55357,56587,55357,57023,55357,57021,55357,56615,55357,56616,55357,57002,55357,57004,55357,56483,55357,56619,55357,56618,55357,56458,55357,56457,55357,56496,55357,56501,55357,56499,9993,55357,56555,55357,56550,55357,56517,55357,56513,9986,55357,56524,55357,56526,10002,9999,55357,56528,55357,56538,55357,56620,55357,56621,55356,57256,55356,57260,55356,57252,55356,57255,55356,57269,55356,57273,55356,57275,55356,57274,55356,57272,55357,56446,55356,57262,55356,56527,55356,57266,55356,57263,55356,57288,55356,57280,9917,9918,55356,57278,55356,57265,55356,57289,55356,57267,55356,57281,55356,57287,55356,57286,55356,57290,55356,57284,9749,55356,57212,55356,57210,55356,57207,55356,57204,55356,57173,55356,57172,55356,57183,55356,57175,55356,57201,55356,57178,55356,57180,55356,57185,55356,57203,55356,57182,55356,57193,55356,57190,55356,57218,55356,57200,55356,57194,55356,57195,55356,57197,55356,57199,55356,57166,55356,57167,55356,57162,55356,57163,55356,57170,55356,57159,55356,57161,55356,57171,55356,57169,55356,57164,55356,57168,55356,57165,55356,57158,55356,57157,55356,57149,55356,57313,55356,57317,55356,57318,9962,55356,57328,9978,55356,57325,55357,56827,55357,56829,55356,57248,55356,57249,9970,55356,57250,55357,56994,55357,56996,9875,55357,56960,9992,55357,56961,55357,56962,55357,56971,55357,56974,55357,56972,55357,56985,55357,56983,55357,56981,55357,56987,55357,57e3,55357,56980,55357,56978,55357,56977,55357,57010,55357,56992,55357,56988,55357,56998,9888,55357,56999,9981,55356,57264,55357,56831,55356,57258,55356,57261,55356,56815,55356,56821,55356,56816,55356,56823,55356,56809,55356,56810,55356,56808,55356,56819,55356,56826,55356,56824,55356,56811,55356,56823,55356,56810,55356,56824,55356,56814,55356,56825,55356,56823,55356,56826,55356,56812,55356,56807,49,8419,50,8419,51,8419,52,8419,53,8419,54,8419,55,8419,56,8419,57,8419,48,8419,55357,56607,10071,10067,9829,9830,55357,56495,55357,56599,55357,56625,55357,56628,55357,56629,55357,56630,55357,56631]),i=[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,87,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,118,120,122,124,126,128,130,132,134,136,138,140,142,144,146,148,150,152,154,156,158,160,162,164,166,168,170,172,174,176,178,180,182,184,186,188,190,192,194,196,198,200,202,204,206,208,210,212,214,216,218,220,222,224,226,228,230,232,234,236,238,240,242,244,246,248,250,252,254,256,258,259,260,261,262,264,266,268,270,272,274,276,278,280,282,284,286,288,290,292,294,295,297,299,301,303,305,306,307,308,310,312,314,316,318,320,322,324,326,328,330,332,334,336,338,340,342,344,346,348,350,351,353,355,357,359,360,362,364,365,366,368,370,372,374,376,378,380,382,384,386,388,390,392,394,396,398,400,402,404,406,407,408,410,412,414,416,418,420,422,424,426,427,429,431,433,435,437,439,441,443,445,447,449,451,453,455,457,459,461,463,465,467,469,471,473,475,477,479,481,483,485,487,489,491,493,495,497,499,501,503,505,507,508,510,511,513,515,517,519,521,522,524,526,528,529,531,532,534,536,538,540,542,544,546,548,550,552,554,556,558,560,562,564,566,567,569,570,572,574,576,578,582,586,590,594,598,602,606,610,614,618,620,622,624,626,628,630,632,634,636,638,640,641,642,643,644,646,648,650,652,654,656,658]},285:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.d(t,{A:()=>m});var i=a(84051),o=a(13439),s=a(90709),r=a(60919),c=a(4961),l=a(59030),d=a(94189),u=e([l,d]);[l,d]=u.then?(await u)():u;const p=({isOpen:e,chat:t,userId:a,contactName:n,onClose:s})=>{const{deleteChatMember:r}=(0,o.getActions)(),u=(0,l.A)(),p=(0,i.hb)(()=>{r({chatId:t.id,userId:a}),s()},[t,r,s,a]);if(t&&a)return i.Ay.createElement(d.A,{isOpen:e,onClose:s,title:u("GroupRemoved.Remove"),textParts:(0,c.A)(u("PeerInfo.Confirm.RemovePeer",n)),confirmLabel:u("lng_box_remove"),confirmHandler:p,confirmIsDestructive:!0})},m=(0,i.ph)((0,o.EK)((e,{userId:t})=>{const a=(0,r.meB)(e),n=t&&(0,r.mBe)(e,t);return{chat:a,contactName:n?(0,s.u0)(n):void 0}})(p));n()}catch(e){n(e)}})},1265:(e,t,a)=>{a.a(e,async(e,t)=>{try{var n=a(17538),i=a(96454),o=a(14487),s=a(87894),r=a(6e4),c=a(127),l=a(24021),d=a(13439),u=a(80840),p=a(32989),m=a(71331),A=e([r,l]);[r,l]=A.then?(await A)():A,(0,d.aJ)("apiUpdate",(e,t,a)=>{const{activeGroupCallId:A}=e.groupCalls;switch(a["@type"]){case"updateGroupCallLeavePresentation":t.toggleGroupCallPresentation({value:!1});break;case"updateGroupCallStreams":if(!a.userId||!A)break;if(!(0,m.n5)(e,A,a.userId))break;return(0,u.c5)(e,A,a.userId,(0,s.cJ)(a,["@type","userId"]));case"updateGroupCallConnectionState":if(!A)break;if("disconnected"===a.connectionState){"leaveGroupCall"in t&&t.leaveGroupCall({isFromLibrary:!0,tabId:(0,o.g0)()});break}return(0,u.h9)(e,A,{connectionState:a.connectionState,isSpeakerDisabled:a.isSpeakerDisabled});case"updateGroupCallParticipants":{const{groupCallId:e,participants:t}=a;A===e&&(0,n.p3)(t);break}case"updateGroupCallConnection":{if(a.data.stream){t.showNotification({message:"Big live streams are not yet supported",tabId:(0,o.g0)()}),"leaveGroupCall"in t&&t.leaveGroupCall({tabId:(0,o.g0)()});break}(0,n.t6)(a.data,a.presentation);const i=(0,m.iT)(e);i?.participants&&Object.keys(i.participants).length>0&&(0,n.p3)(Object.values(i.participants));break}case"updatePhoneCallMediaState":return{...e,phoneCall:{...e.phoneCall,...(0,s.cJ)(a,["@type"])}};case"updatePhoneCall":{if(!i.OL)return;const{phoneCall:s,currentUserId:u}=e,A={...s,...a.call},h=s?.adminId===u;if(e={...e,phoneCall:A},(0,d.UF)(e),e=(0,d.mS)(),s&&s.id&&A.id!==s.id)return void("discarded"!==A.state&&(0,l.px)("discardCall",{call:A,isBusy:!0}));const{accessHash:f,state:v,connections:y,gB:V}=A;if(("active"===v||"accepted"===v)&&(g=A.protocol,!g?.libraryVersions.some(e=>"4.0.0"===e||"4.0.1"===e))){const a=(0,m.uu)(e);return"hangUp"in t&&t.hangUp({tabId:(0,o.g0)()}),void t.showNotification({message:r.yE("VoipPeerIncompatible",a?.firstName),tabId:(0,o.g0)()})}if("discarded"===v){if(!s)return;return(0,p.w)(e,{...A.needRating&&{ratingPhoneCall:A},isCallPanelVisible:void 0},(0,o.g0)())}return"accepted"===v&&f&&V?(async()=>{const{gA:t,keyFingerprint:a,emojis:n}=await(0,l.px)("confirmPhoneCall",[V,c.I,c.c]),i={...(e=(0,d.mS)()).phoneCall,emojis:n};e={...e,phoneCall:i},(0,d.UF)(e),(0,l.px)("confirmCall",{call:A,gA:t,keyFingerprint:a})})():"active"===v&&y&&"active"!==s?.state&&(h||((0,l.px)("receivedCall",{call:A}),(async()=>{const{emojis:t}=await(0,l.px)("confirmPhoneCall",[A.gAOrB,c.I,c.c]),a={...(e=(0,d.mS)()).phoneCall,emojis:t};e={...e,phoneCall:a},(0,d.UF)(e)})()),(0,n.F$)(y,t.sendSignalingData,h,Boolean(A?.isVideo),Boolean(A.isP2pAllowed),t.apiUpdate)),e}case"updatePhoneCallConnectionState":{const{connectionState:n}=a;return e.phoneCall?"closed"===n||"disconnected"===n||"failed"===n?void("hangUp"in t&&t.hangUp({tabId:(0,o.g0)()})):{...e,phoneCall:{...e.phoneCall,isConnected:"connected"===n}}:e}case"updatePhoneCallSignalingData":{const{phoneCall:t}=e;if(!t)break;(0,l.px)("decodePhoneCallData",[a.data])?.then(n.Tt);break}}var g}),t()}catch(e){t(e)}})},3992:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.d(t,{A:()=>w});var i=a(84051),o=a(13439),s=a(31481),r=a(17538),c=a(60919),l=a(87357),d=a(4961),u=a(82892),p=a(10722),m=a(59030),A=a(21849),g=a(35384),h=a(54746),f=a(22720),v=a(99053),y=a(77641),V=a(31710),C=e([m,A,g,f,v]);[m,A,g,f,v]=C.then?(await C)():C;const b=({participant:e,peer:t})=>{const a=(0,i.li)(),n=(0,i.li)(),o=(0,m.A)(),{isSelf:c,isMutedByMe:C,isMuted:b,hasVideoStream:w,hasPresentationStream:E}=e,S=(e.amplitude||0)>r.yW,k=Boolean(e.raiseHandRating),{isContextMenuOpen:I,contextMenuAnchor:P,handleContextMenu:T,handleBeforeContextMenu:N,handleContextMenuClose:M,handleContextMenuHide:x}=(0,p.A)(a,c),G=(0,i.hb)(()=>a.current,[]),B=(0,i.hb)(()=>a.current.closest(".custom-scroll, .no-scrollbar"),[]),R=(0,i.hb)(()=>n.current,[]),U=(0,i.hb)(()=>({withPortal:!0}),[]),L=Boolean(!b&&S&&e.volume&&e.volume!==s.iRY),[F,D]=(0,i.Kr)(()=>C?[o("VoipGroupMutedForMe"),V.A.subtitleRed]:k?[o("WantsToSpeak"),V.A.subtitleBlue]:L?[o("SpeakingWithVolume",(0,u.A)(e)).replace("%%","%"),V.A.subtitleGreen]:!b&&S?[o("Speaking"),V.A.subtitleGreen]:c?[o("ThisIsYou"),V.A.subtitleBlue]:e.about?[e.about,""]:[o("Listening"),V.A.subtitleBlue],[C,k,L,b,S,c,e,o]);if(t)return i.Ay.createElement(f.A,{leftElement:i.Ay.createElement(A.A,{peer:t,className:V.A.avatar}),rightElement:i.Ay.createElement(y.A,{participant:e,className:V.A.icon}),className:V.A.root,onClick:T,onMouseDown:N,onContextMenu:T,multiline:!0,ripple:!0,ref:a},i.Ay.createElement(g.A,{peer:t,withEmojiStatus:!0,className:V.A.title}),i.Ay.createElement("span",{className:(0,l.A)(V.A.subtitle,"subtitle",D)},E&&i.Ay.createElement(h.A,{name:"share-screen"}),w&&i.Ay.createElement(h.A,{name:"video"}),L&&i.Ay.createElement(h.A,{name:"speaker"}),i.Ay.createElement("span",{className:V.A.subtitleText},(0,d.A)(F))),i.Ay.createElement(v.A,{participant:e,isDropdownOpen:I,anchor:P,getTriggerElement:G,getRootElement:B,getMenuElement:R,getLayout:U,onClose:M,onCloseAnimationEnd:x,menuRef:n}))},w=(0,i.ph)((0,o.EK)((e,{participant:t})=>({peer:(0,c.mBe)(e,t.id)||(0,c.hds)(e,t.id)}))(b));n()}catch(e){n(e)}})},4104:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.r(t),a.d(t,{ActiveCallHeader:()=>r.A,GroupCall:()=>s.A,PhoneCall:()=>c.A,RatePhoneCallModal:()=>l.A});var i=a(12859),o=a(96454),s=a(44751),r=a(59545),c=a(58995),l=a(15550),d=e([i,s,r,c,l]);[i,s,r,c,l]=d.then?(await d)():d,(o.Yw||o.pz)&&document.addEventListener("click",i.cw,{once:!0}),n()}catch(e){n(e)}})},12859:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.d(t,{Hc:()=>M,JD:()=>S,cw:()=>E,ow:()=>x,re:()=>G,sN:()=>N});var i=a(66644),o=a(96454),s=a(85982),r=a(14487),c=a(87894),l=a(6e4),d=a(41733),u=a(24021),p=a(90709),m=a(13439),A=a(80840),g=a(32989),h=a(60919),f=a(71331),v=a(42347),y=e([l,u,v]);[l,u,v]=y.then?(await y)():y;const V="data:audio/mpeg;base64,SUQzBAAAAAABEVRYWFgAAAAtAAADY29tbWVudABCaWdTb3VuZEJhbmsuY29tIC8gTGFTb25vdGhlcXVlLm9yZwBURU5DAAAAHQAAA1N3aXRjaCBQbHVzIMKpIE5DSCBTb2Z0d2FyZQBUSVQyAAAABgAAAzIyMzUAVFNTRQAAAA8AAANMYXZmNTcuODMuMTAwAAAAAAAAAAAAAAD/80DEAAAAA0gAAAAATEFNRTMuMTAwVVVVVVVVVVVVVUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/zQsRbAAADSAAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/zQMSkAAADSAAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV";let C,b,w;function E(){return S(),Promise.all(Object.values(w).map(e=>{const t=e.src;return e.src=V,e.muted=!0,e.volume=1e-4,e.play().then(()=>{e.pause(),e.volume=1,e.currentTime=0,e.muted=!1,(0,i.Uz)(()=>{e.src=t})})}))}function S(){if(w)return;const e=new Audio("./voicechat_join.mp3"),t=new Audio("./voicechat_connecting.mp3");t.loop=!0;const a=new Audio("./voicechat_leave.mp3"),n=new Audio("./voicechat_onallowtalk.mp3"),i=new Audio("./call_busy.mp3"),o=new Audio("./call_connect.mp3"),s=new Audio("./call_end.mp3"),r=new Audio("./call_incoming.mp3");r.loop=!0;const c=new Audio("./call_ringing.mp3");c.loop=!0,w={join:e,allowTalk:n,leave:a,connecting:t,incoming:r,end:s,connect:o,busy:i,ringing:c}}async function k(e,t){if((0,h.trm)(e))return;const a=await(0,u.px)("getGroupCall",{call:t});if(!a)return;e=(0,m.mS)();const n=(0,f.Ip)(e,t.id);return e=(0,A.h9)(e,t.id,(0,c.cJ)(a.groupCall,["connectionState"]),void 0,n?.isLoaded?void 0:a.groupCall.participantsCount),(0,m.UF)(e),a.groupCall}function I(e,t){return(0,u.px)("fetchGroupCallParticipants",{call:e,offset:t})}(0,m.aJ)("toggleGroupCallPanel",(e,t,a)=>{const{force:n,tabId:i=(0,r.g0)()}=a||{};return(0,g.w)(e,{isCallPanelVisible:"force"in(a||{})?n:!(0,h.nTw)(e,i).isCallPanelVisible},i)}),(0,m.aJ)("createGroupCall",async(e,t,a)=>{const{chatId:n,tabId:i=(0,r.g0)()}=a,o=(0,h.hds)(e,n);if(!o)return;const s=await(0,u.px)("createGroupCall",{peer:o});s&&(e=(0,m.mS)(),e=(0,A.h9)(e,s.id,{...s,chatId:n}),(0,m.UF)(e),t.requestMasterAndJoinGroupCall({id:s.id,accessHash:s.accessHash,tabId:i}))}),(0,m.aJ)("createGroupCallInviteLink",async(e,t,a)=>{const{tabId:n=(0,r.g0)()}=a||{},i=(0,f.iT)(e);if(!i||!i.chatId)return;const o=(0,h.hds)(e,i.chatId);if(!o)return;const c=Boolean((0,p.Kl)(o));let l=(0,h.AWZ)(e,o.id)?.inviteLink;c&&(l=await(0,u.px)("exportGroupCallInvite",{call:i,canSelfUnmute:!1})),l&&((0,s.eM)(l),t.showNotification({message:{key:"LinkCopied"},tabId:n}))}),(0,m.aJ)("joinVoiceChatByLink",async(e,t,a)=>{const{username:n,inviteHash:i,tabId:o=(0,r.g0)()}=a,s=await(0,v.A$)(e,n);if(!s)return void t.showNotification({message:l.yE("NoUsernameFound"),tabId:o});e=(0,m.mS)();const c=await(0,v.ad)(e,t,s);c?.groupCall&&t.requestMasterAndJoinGroupCall({id:c.groupCall.id,accessHash:c.groupCall.accessHash,inviteHash:i,tabId:o})}),(0,m.aJ)("requestMasterAndJoinGroupCall",(e,t,a)=>{t.requestMasterAndCallAction({action:"joinGroupCall",payload:a,tabId:a.tabId||(0,r.g0)()})}),(0,m.aJ)("requestMasterAndAcceptCall",(e,t,a)=>{t.requestMasterAndCallAction({action:"acceptCall",payload:void 0,tabId:a?.tabId||(0,r.g0)()})}),(0,m.aJ)("joinGroupCall",async(e,t,a)=>{const{chatId:n,id:i,accessHash:s,inviteHash:c,tabId:l=(0,r.g0)()}=a;if(!o.OL)return void t.showNotification({message:"Sorry, your browser doesn't support group calls",tabId:l});if(e.phoneCall)return void t.toggleGroupCallPanel({tabId:l});T(),S(),G(e=(0,m.mS)(),t,!0,l);const{groupCalls:{activeGroupCallId:d}}=e;let u=i?(0,f.Ip)(e,i):(0,f.mD)(e,n);if(u&&u.id===d)t.toggleGroupCallPanel({tabId:l});else if(d)"leaveGroupCall"in t&&t.leaveGroupCall({rejoin:a,tabId:l});else if(u&&d===u.id)t.toggleGroupCallPanel({tabId:l});else{if(u||i&&s||!n)!u&&i&&s&&(u=await k(e,{id:i,accessHash:s}));else{const a=(0,h.hds)(e,n);if(!a)return;await(0,v.ad)(e,t,a),e=(0,m.mS)(),u=(0,f.mD)(e,n)}u&&(e=(0,m.mS)(),e=(0,A.h9)(e,u.id,{...u,inviteHash:c},void 0,u.participantsCount+1),e={...e,groupCalls:{...e.groupCalls,activeGroupCallId:u.id}},(0,m.UF)(e),t.toggleGroupCallPanel({force:!1,tabId:l}))}}),(0,m.aJ)("playGroupCallSound",(e,t,a)=>{const{sound:n}=a;w?.[n]&&("connecting"!==n&&w.connecting.pause(),"incoming"!==n&&w.incoming.pause(),"ringing"!==n&&w.ringing.pause(),(0,d.A)(w[n]))}),(0,m.aJ)("loadMoreGroupCallParticipants",e=>{const t=(0,f.iT)(e);t&&I(t,t.nextOffset)}),(0,m.aJ)("requestMasterAndRequestCall",(e,t,a)=>{t.requestMasterAndCallAction({action:"requestCall",payload:a,tabId:a.tabId||(0,r.g0)()})}),(0,m.aJ)("requestCall",(e,t,a)=>{const{userId:n,isVideo:i,tabId:o=(0,r.g0)()}=a;e.phoneCall?t.toggleGroupCallPanel({tabId:o}):(0,h.mBe)(e,n)&&(S(),G(e=(0,m.mS)(),t,i,o),e=(0,m.mS)(),e={...e,phoneCall:{id:"",state:"requesting",participantId:n,isVideo:i,adminId:e.currentUserId}},(0,m.UF)(e),t.toggleGroupCallPanel({force:!1,tabId:o}))});const P=e=>{const t=e.createOscillator(),a=t.connect(e.createMediaStreamDestination());return t.start(),new MediaStream([Object.assign(a.stream.getAudioTracks()[0],{enabled:!1})])};function T(){const e=new(window.AudioContext||window.webkitAudioContext);C=new Audio,b=e,C.srcObject=P(e),(0,d.A)(C)}function N(){return C}function M(){return b}function x(){C?.pause(),b=void 0,C=void 0}function G(e,t,a,...[n=(0,r.g0)()]){a?navigator.mediaDevices.getUserMedia({video:!0}).then(e=>{0===e.getVideoTracks().length?t.showNotification({message:l.yE("Call.Camera.Error"),tabId:n}):(e.getTracks().forEach(e=>e.stop()),B(0,t,n))}).catch(()=>{t.showNotification({message:l.yE("Call.Camera.Error"),tabId:n})}):B(0,t,n)}function B(e,t,...[a=(0,r.g0)()]){navigator.mediaDevices.getUserMedia({audio:!0}).then(e=>{0===e.getAudioTracks().length?t.showNotification({message:l.yE("RequestAcces.Error.HaveNotAccess.Call"),tabId:a}):e.getTracks().forEach(e=>e.stop())}).catch(()=>{t.showNotification({message:l.yE("RequestAcces.Error.HaveNotAccess.Call"),tabId:a})})}n()}catch(R){n(R)}})},13266:(e,t,a)=>{a.d(t,{A:()=>n});const n={root:"npTa6CmI",portrait:"v7oB2HTv"}},13899:(e,t,a)=>{a.d(t,{A:()=>n});const n={root:"GNYRVAUg",blurred:"RBmbMiou","single-column":"O7cZE08z",singleColumn:"O7cZE08z",header:"GI6dY5aJ","close-button":"ULiJZuaP",closeButton:"ULiJZuaP","emojis-backdrop":"RFBKZpjx",emojisBackdrop:"RFBKZpjx",open:"zi1NlOXX",emojis:"DFco1VIN","emoji-tooltip":"MRIShZ3V",emojiTooltip:"MRIShZ3V","user-info":"eaUe2A0c",userInfo:"eaUe2A0c",buttons:"qIeflO02",leave:"hclywYYk",accept:"ln_ZBUHy","accept-icon":"cVRd3twS",acceptIcon:"cVRd3twS","main-video":"bGlBFSJq",mainVideo:"bGlBFSJq","second-video":"TOFu1n5x",secondVideo:"TOFu1n5x",visible:"LOnSFN9w",fullscreen:"Omg5T1o6"}},15550:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.d(t,{A:()=>g});var i=a(84051),o=a(13439),s=a(87357),r=a(59030),c=a(54746),l=a(64493),d=a(40664),u=a(8410),p=a(34808),m=e([r,l,d,u]);[r,l,d,u]=m.then?(await m)():m;const A=({isOpen:e})=>{const{closeCallRatingModal:t,setCallRating:a}=(0,o.getActions)(),n=(0,i.li)(),m=(0,r.A)(),[A,g]=(0,i.J0)(),h=(0,i.hb)(()=>{A?a({rating:A+1,comment:n.current?.value||""}):t()},[t,A,a]),f=(0,i.hb)(()=>{t()},[t]);return i.Ay.createElement(u.A,{title:m("lng_call_rate_label"),className:"narrow",onClose:t,isOpen:e},i.Ay.createElement("div",{className:p.A.stars},new Array(5).fill(void 0).map((e,t)=>{const a=void 0!==A&&A>=t;return i.Ay.createElement(c.A,{name:a?"favorite-filled":"favorite",className:(0,s.A)(a&&p.A.isFilled,p.A.star),onClick:(n=t,()=>g(A===n?void 0:n))});var n})),i.Ay.createElement(d.A,{ref:n,placeholder:m("lng_call_rate_comment"),className:(0,s.A)(p.A.comment,4!==A&&void 0!==A&&p.A.visible)}),i.Ay.createElement("div",{className:"dialog-buttons mt-2"},i.Ay.createElement(l.A,{className:"confirm-dialog-button",isText:!0,onClick:h},m("Send")),i.Ay.createElement(l.A,{className:"confirm-dialog-button",isText:!0,onClick:f},m("Cancel"))))},g=(0,i.ph)(A);n()}catch(e){n(e)}})},17538:(e,t,a)=>{function n(e){return 0|e}function i(e){return e>>>0}function o(e,t=3){if(!e)return 0;const{length:a}=e;let n=0;for(let t=0;t<a;t++)n+=e[t]*e[t];const i=Math.sqrt(n/a)/255;return Math.min(1,i*t)}function s(e){return{id:e.id,name:e.name,"rtcp-fbs":e.feedbackTypes,clockrate:e.clockrate,parameters:e.parameters,channels:e.channels}}a.d(t,{_2:()=>c,yW:()=>r,SK:()=>L,F0:()=>C,t6:()=>M,p3:()=>N,Y8:()=>w,U7:()=>R,F$:()=>J,F3:()=>P,Tt:()=>K,ls:()=>b,Dd:()=>B,Bd:()=>j,qS:()=>_,jP:()=>k,PX:()=>O});const r=.1,c="getDisplayMedia"in(navigator?.mediaDevices||{}),l=navigator?.mediaDevices?.getSupportedConstraints().echoCancellation,d=navigator?.mediaDevices?.getSupportedConstraints().noiseSuppression,u=(e,t=!1)=>{if(!e||!e.sdp)throw Error("Failed parsing SDP: session description is null");const a=e.sdp.split("\r\nm=").map((e,t)=>0===t?e:`m=${e}`).reduce((e,t)=>{const a=t.match(/^m=(.+?)\s/)?.[1]||"header";return e[e.hasOwnProperty(a)&&"video"===a?"screencast":a]=t.split("\r\n").filter(Boolean),e},{}),i=(e,t)=>t?a[t]?.find(t=>t.startsWith(e))?.substr(e.length):Object.values(a).map(t=>t.find(t=>t.startsWith(e))?.substr(e.length)).filter(Boolean)[0],o=e=>a[e].filter(e=>e.startsWith("a=extmap")).map(e=>{const[,t,a]=e.match(/extmap:(\d+)(?:\/.+)?\s(.+)/);return{id:Number(t),uri:a}}),s=e=>{const t=a[e].filter(e=>e.startsWith("a=rtpmap")).map(e=>{const[,t,a]=e.match(/:(\d+)\s(.+)/)||[],[n,i,o]=a.split("/");return{id:Number(t),name:n,clockrate:Number(i),...o&&{channels:Number(o)}}}),n=a[e].filter(e=>e.startsWith("a=rtcp-fb")).map(e=>{const[,t,a]=e.match(/:(\d+)\s(.+)/)||[],[n,i]=a.split(" ");return{id:Number(t),type:n,subtype:i||""}}),i=a[e].filter(e=>e.startsWith("a=fmtp")).map(e=>{const[,t,a]=e.match(/:(\d+)\s(.+)/)||[],n=a?.split(";").reduce((e,t)=>{const[a,n]=t.split("=");return e[a]=n,e},{});if(n&&!Object.values(n).some(e=>!e))return{id:Number(t),data:n}}).filter(Boolean);return t.map(e=>{const t=i.filter(t=>t.id===e.id).map(e=>e.data).reduce((e,t)=>Object.assign(e,t),{}),a=n.filter(t=>t.id===e.id).map(e=>({type:e.type,subtype:e.subtype}));return{...e,...Object.keys(t).length>0&&{parameters:t},...a.length>0&&{feedbackTypes:a}}})},r=i("a=ssrc:","audio"),c=r&&Number(r.split(" ")[0]),l=i("a=ssrc-group:","video")?.split(" ")||void 0,d=i("a=ssrc-group:","screencast")?.split(" ")||void 0;if(!l)throw Error("Failed parsing SDP: no video ssrc");const[u,p]=i("a=fingerprint:")?.split(" ")||[],m=i("a=setup:");if(!u||!p)throw Error("Failed parsing SDP: no fingerprint");console.log(a);const A=i("a=ice-ufrag:"),g=i("a=ice-pwd:");if(!A||!g)throw Error("Failed parsing SDP: no ICE ufrag or pwd");return{fingerprints:[{fingerprint:p,hash:u,setup:t?m:"active"}],pwd:g,ufrag:A,...c&&{ssrc:n(c)},...l&&{"ssrc-groups":[{semantics:l[0],sources:l.slice(1,l.length).map(Number).map(n)},t&&d&&{semantics:d[0],sources:d.slice(1,d.length).map(Number).map(n)}].filter(Boolean)},...t&&{audioExtmap:o("audio"),videoExtmap:o("video"),screencastExtmap:o("screencast"),audioPayloadTypes:s("audio"),videoPayloadTypes:s("video"),screencastPayloadTypes:s("screencast")}}},p=(e,t=!1,a=!1,n=!1)=>{const o=[],s=e=>{o.push(e)},{sessionId:r,ssrcs:c,audioExtensions:l,videoExtensions:d,audioPayloadTypes:u,videoPayloadTypes:p,transport:{ufrag:m,pwd:A,fingerprints:g,candidates:h}}=e;s("v=0"),s(`o=- ${r} 2 IN IP4 0.0.0.0`),s("s=-"),s("t=0 0"),s("a=ice-options:trickle"),s("a=msid-semantic:WMS *"),s(`a=group:BUNDLE ${c.map(e=>e.mid).join(" ")}${a?"":" "+(n?"3":"2")}`),n||s("a=ice-lite");const f=e=>{if(e.sdpString)s(`a=${e.sdpString}`);else{let t="";t+="a=candidate:",t+=`${e.foundation} ${e.component} ${e.protocol} ${e.priority} ${e.ip} ${e.port} typ ${e.type}`,"rel-addr"in e&&(t+=` raddr ${e["rel-addr"]} rport ${e["rel-port"]}`),t+=` generation ${e.generation}`,s(t)}},v=()=>{s(`a=ice-ufrag:${m}`),s(`a=ice-pwd:${A}`),g.forEach(e=>{s(`a=fingerprint:${e.hash} ${e.fingerprint}`),s(`a=setup:${n?e.setup:"passive"}`)}),h.forEach(f)},y=e=>{const{channels:t,id:a,name:n,clockrate:i,parameters:o}=e;if(s(`a=rtpmap:${a} ${n}/${i}${t?`/${t}`:""}`),o){const e=Object.keys(o).map(e=>`${e}=${o[e]};`).join(" ");s(`a=fmtp:${a} ${e}`)}e["rtcp-fbs"]?.forEach(e=>{s(`a=rtcp-fb:${a} ${e.type}${e.subtype?` ${e.subtype}`:""}`)})},V=e=>{const a=e.isVideo?p:u,o=e.isVideo?"video":"audio";if(s(`m=${o} ${e.isMain?1:0} RTP/SAVPF ${a.map(e=>e.id).join(" ")}`),s("c=IN IP4 0.0.0.0"),s("b=AS:1300"),s(`a=mid:${e.mid}`),s("a=rtcp-mux"),a.forEach(y),s("a=rtcp:1 IN IP4 0.0.0.0"),e.isVideo&&s("a=rtcp-rsize"),(e.isVideo?d:l).forEach(({id:e,uri:t})=>{s(`a=extmap:${e} ${t}`)}),e.isRemoved)s("a=inactive");else{if(v(),n)s("a=sendrecv"),s("a=bundle-only");else{if(t)return void s("a=recvonly");e.isMain?s("a=sendrecv"):(s("a=sendonly"),s("a=bundle-only"))}e.sourceGroups.forEach(t=>{t.semantics&&s(`a=ssrc-group:${t.semantics} ${t.sources.map(i).join(" ")}`),t.sources.forEach(t=>{const a=i(t);s(`a=ssrc:${a} cname:${e.endpoint}`),s(`a=ssrc:${a} msid:${e.endpoint} ${e.endpoint}`),s(`a=ssrc:${a} mslabel:${e.endpoint}`),s(`a=ssrc:${a} label:${e.endpoint}`)})})}};return n?c.filter(V):c.filter(e=>"0"===e.mid||"1"===e.mid).map(V),a||(s("m=application 1 UDP/DTLS/SCTP webrtc-datachannel"),s("c=IN IP4 0.0.0.0"),v(),s("a=ice-options:trickle"),s("a=mid:"+(n?"3":a?"1":"2")),s("a=sctp-port:5000"),s("a=max-message-size:262144")),n||c.filter(e=>"0"!==e.mid&&"1"!==e.mid).map(V),`${o.join("\n")}\n`},m=e=>{const t=e.createOscillator(),a=t.connect(e.createMediaStreamDestination());return t.start(),new MediaStream([Object.assign(a.stream.getAudioTracks()[0],{enabled:!1})])},A=({width:e=640,height:t=480}={})=>{const a=Object.assign(document.createElement("canvas"),{width:e,height:t}),n=a.getContext("2d");if(!n)throw Error("Cannot create canvas ctx");n.fillRect(0,0,e,t);const i=a.captureStream();return new MediaStream([Object.assign(i.getVideoTracks()[0],{enabled:!1})])};var g=a(9705),h=a(41733);const f=3;let v,y;function V(e){v&&(v.screenshareDataChannel?.close(),v.screenshareConnection?.close(),e||v.onUpdate?.({"@type":"updateGroupCallLeavePresentation"}))}function C(e){return v?.streams?.[e]}function b(e,t){const a=v?.participantFunctions?.[e];a&&a.setVolume?.(t)}function w(e,t){const a=t||v?.myId,n=a&&C(a)?.[e];return!!n&&n.getTracks()[0]?.enabled}function E(e){v?.onUpdate?.({"@type":"updateGroupCallStreams",userId:e,hasAudioStream:w("audio",e),hasVideoStream:w("video",e),hasPresentationStream:w("presentation",e),amplitude:v.speaking?.[e]})}async function S(e,t="user"){if("audio"===e&&v?.audioStream)return v.audioStream;if("presentation"===e)return navigator.mediaDevices.getDisplayMedia({audio:!1,video:!0});const a=await navigator.mediaDevices.getUserMedia({audio:"audio"===e&&{...l&&{echoCancellation:!0},...d&&{noiseSuppression:!0}},video:"video"===e&&{facingMode:t}});if(v&&"audio"===e&&(v.audioStream=a),"video"===e){const e=document.createElement("video");e.srcObject=a;const t=new g.A;e.oncanplay=()=>t.resolve(),await t.promise}return a}async function k(e,t=void 0){if(!(v&&v.myId&&v.connection&&v.streams))return;const a=C(v.myId)?.[e];if(!a)return;const n=a.getTracks()[0];if(!n)return;const i=[...v.connection.getSenders(),...v.screenshareConnection?.getSenders()||[]].find(e=>n.id===e.track?.id);if(i){t=void 0===t?!n.enabled:t;try{if(t&&!n.enabled){const t=await S(e);if(await i.replaceTrack(t.getTracks()[0]),v.streams[v.myId][e]=t,"video"===e)v.facingMode="user";else if("audio"===e){const{audioContext:e}=v;if(!e)return;const a=v.audioSource||e.createMediaStreamSource(t),n=v.audioAnalyser||e.createAnalyser();n.minDecibels=-100,n.maxDecibels=-30,n.smoothingTimeConstant=.05,n.fftSize=1024,a.connect(n),v={...v,audioSource:a,audioAnalyser:n,participantFunctions:{...v.participantFunctions,[v.myId]:{...v.participantFunctions?.[v.myId],getCurrentAmplitude:()=>{const e=new Uint8Array(n.frequencyBinCount);return n.getByteFrequencyData(e),o(e,1.5)}}}}}}else if(!t&&n.enabled){const t="audio"===e?v.silence:v.black;if(!t)return;await i.replaceTrack(t.getTracks()[0]),v.streams[v.myId][e]=t,"video"===e&&(v.facingMode=void 0),"audio"!==e?n.stop():(v.audioSource?.disconnect(),v.audioAnalyser?.disconnect())}E(v.myId),"presentation"!==e||t||V(!0)}catch(e){}}}function I(e){v?.onUpdate?.({"@type":"updateGroupCallConnectionState",connectionState:e})}function P(){v&&(v.myId&&v.streams?.[v.myId]&&Object.values(v.streams[v.myId]||{}).forEach(e=>{e?.getTracks().forEach(e=>{e.stop()})}),v.audioStream?.getTracks().forEach(e=>{e.stop()}),V(!0),v.dataChannel?.close(),v.connection?.close(),I("disconnected"),v.analyserInterval&&clearInterval(v.analyserInterval),v=void 0)}function T(){v&&v.participantFunctions&&Object.keys(v.participantFunctions).forEach(e=>{const{getCurrentAmplitude:t}=v.participantFunctions[Number(e)];if(t){const a=t(),n=v.speaking[e]||0;v.speaking[e]=a,(a>r&&n<=r||a<=r&&n>r)&&E(e)}})}async function N(e){if(!v)return;const{participants:t,conference:a,connection:n,myId:i}=v;if(!(t&&a&&n&&a.ssrcs&&a.transport&&i))return;if(e.find(e=>e.isSelf&&e.source!==v?.conference?.ssrcs?.find(e=>e.isMain&&!e.isVideo)?.sourceGroups[0].sources[0]))return void P();const o=[];if(e.forEach(e=>{if(e.isSelf)return void(e.isMuted&&!e.canSelfUnmute&&(k("audio",!1),k("video",!1),k("presentation",!1)));const{isLeft:t}=e,n=e.isMuted||e.isMutedByMe,i=!e.isVideoJoined||!e.video||t,s=!e.presentation||t;let r=!1,c=!1,l=!1;a.ssrcs.filter(t=>t.userId===e.id).forEach(t=>{t.isVideo||(t.sourceGroups[0].sources[0]===e.source&&(c=!0),t.isRemoved=n),t.isVideo&&(t.isPresentation||(e.video&&t.endpoint===e.video.endpoint&&(r=!0),t.isRemoved=i),t.isPresentation&&(e.presentation&&t.endpoint===e.presentation.endpoint&&(l=!0),t.isRemoved=s))}),n||c||(v.lastMid=v.lastMid+1,a.ssrcs.push({userId:e.id,isMain:!1,endpoint:`audio${e.source}`,isVideo:!1,sourceGroups:[{sources:[e.source]}],mid:v.lastMid.toString()})),i||r||!e.video||(v.lastMid=v.lastMid+1,o.push(e.video.endpoint),a.ssrcs.push({userId:e.id,isMain:!1,endpoint:e.video.endpoint,isVideo:!0,sourceGroups:e.video.sourceGroups,mid:v.lastMid.toString()})),s||l||!e.presentation||(v.lastMid=v.lastMid+1,a.ssrcs.push({isPresentation:!0,userId:e.id,isMain:!1,endpoint:e.presentation.endpoint,isVideo:!0,sourceGroups:e.presentation.sourceGroups,mid:v.lastMid.toString()}))}),v.updatingParticipantsQueue)return void v.updatingParticipantsQueue.push(a);v.updatingParticipantsQueue=[];const s=p(a);await n.setRemoteDescription({type:"offer",sdp:s});try{const e=await n.createAnswer();if(await n.setLocalDescription(e),E(i),v.updatingParticipantsQueue.length>0)for(const e of v.updatingParticipantsQueue){await n.setRemoteDescription({type:"offer",sdp:p(e)});const t=await n.createAnswer();await n.setLocalDescription(t),E(i)}v.updatingParticipantsQueue=void 0}catch(e){console.error(e)}}async function M(e,t){if(!v)return;const a=t?v.screenshareConference:v.conference,n=t?v.screenshareConnection:v.connection;if(!a||!n||!a.ssrcs)return;const i=Date.now(),o={...a,transport:e.transport,sessionId:i,audioExtensions:e.audio?.["rtp-hdrexts"],audioPayloadTypes:e.audio?.["payload-types"],videoExtensions:e.video?.["rtp-hdrexts"],videoPayloadTypes:e.video?.["payload-types"]};v={...v,...t?{screenshareConference:o}:{conference:o}};try{await n.setRemoteDescription({type:"answer",sdp:p(o,!0,t)})}catch(e){console.error(e)}}function x(e){if(!(v&&v.audioElement&&v.audioContext&&v.mediaStream))return;const t=v.conference?.ssrcs?.find(t=>t.endpoint===e.track.id);if(!t||!t.userId)return;const{userId:a,isPresentation:n}=t,i=v.participants?.find(e=>e.id===a),s="video"===e.track.kind?n?"presentation":"video":"audio";e.track.onended=()=>{delete v?.streams?.[a][s],E(a)};const r=e.streams[0];if("audio"===e.track.kind){const{mediaStream:e}=v,t=new window.AudioContext,n=t.createMediaStreamSource(r),s=t.createGain();s.gain.value=(i?.volume||1e4)/1e4;const c=t.createGain();s.gain.value=1;const l=t.createAnalyser();l.minDecibels=-100,l.maxDecibels=-30,l.smoothingTimeConstant=.05,l.fftSize=1024,n.connect(l).connect(c).connect(s).connect(t.destination),e.addTrack(n.mediaStream.getAudioTracks()[0]);const d=new Audio;d.srcObject=r,d.muted=!0,d.remove(),v={...v,participantFunctions:{...v.participantFunctions,[a]:{...v.participantFunctions?.[a],setVolume:e=>{s.gain.value=e>1?2*e:e},toggleMute:e=>{c.gain.value=e?0:1},getCurrentAmplitude:()=>{const e=new Uint8Array(l.frequencyBinCount);return l.getByteFrequencyData(e),o(e,1.5)}}}}}v={...v,streams:{...v.streams,[a]:{...v.streams?.[a],[s]:r}}},E(a)}function G(e,t,a=!1){const n=new RTCPeerConnection,i=a?void 0:function(e){const t=e.createDataChannel("data",{id:0});return t.onopen=()=>{},t.onmessage=e=>{JSON.parse(e.data).colibriClass},t.onerror=e=>{console.log("%conerror","background: green; font-size: 5em"),console.error(e)},t}(n);return e.forEach(e=>e.getTracks().forEach(t=>{n.addTrack(t,e)})),a||(n.oniceconnectionstatechange=()=>{const e=n.iceConnectionState;console.log("iceconnectionstatechange",e),"connected"===e||"completed"===e?I("connected"):"checking"===e||"new"===e?I("connecting"):"disconnected"===n.iceConnectionState&&I("reconnecting")}),n.onconnectionstatechange=()=>{console.log("connectionstatechange",n.connectionState)},n.ontrack=x,n.onnegotiationneeded=async()=>{if(!v)return;console.log("onnegotiationneeded");const{myId:i}=v;if(!i)return;const o=await n.createOffer({offerToReceiveVideo:!0,offerToReceiveAudio:!a});if(console.log("offer created"),await n.setLocalDescription(o),console.log("local desc set"),!o.sdp)return;const s=u(o),r=a?void 0:{userId:"",sourceGroups:[{sources:[s.ssrc||0]}],isRemoved:a,isMain:!0,isVideo:!1,isPresentation:a,endpoint:a?"1":"0",mid:a?"1":"0"},c=s["ssrc-groups"]&&{isPresentation:a,userId:"",sourceGroups:s["ssrc-groups"],isMain:!0,isVideo:!0,endpoint:a?"0":"1",mid:a?"0":"1"},l=a?v.screenshareConference:v.conference,d=[];a?(c&&d.push(c),r&&d.push(r)):(r&&d.push(r),c&&d.push(c));const p=e.find(e=>"audio"===e.getTracks()[0].kind),m=e.find(e=>"video"===e.getTracks()[0].kind);v={...v,...a?{screenshareConference:{...l,ssrcs:d}}:{conference:{...l,ssrcs:d}},streams:{...v.streams,[i]:{...v.streams?.[i],...p&&{audio:p},...!a&&m?{video:m}:{presentation:m}}}},E(i),t(s)},{connection:n,dataChannel:i}}async function B(){if(v)try{const e=await S("presentation");if(!e)return;return e.getTracks()[0].onended=()=>{v&&v.myId&&(delete v.streams?.[v.myId].presentation,E(v.myId),V())},await new Promise(t=>{const{connection:a,dataChannel:n}=G([e],t,!0);v={...v,screenshareConnection:a,screenshareDataChannel:n}})}catch(e){return}}function R(e,t,a,n){if(v)throw Error("Already in call");I("connecting");const i=new MediaStream;return a.srcObject=i,(0,h.A)(a),v={onUpdate:n,participants:[],myId:e,speaking:{},silence:m(t),black:A({width:640,height:480}),analyserInterval:setInterval(T,1e3),audioElement:a,audioContext:t,mediaStream:i,lastMid:f},S("audio"),new Promise(e=>{v={...v,...G([v.silence,v.black],e)}})}const U=10;function L(){return y?.streams}function F(){y?.onUpdate({...y.mediaState,"@type":"updatePhoneCallMediaState"})}function D(e,t="user"){return"presentation"===e?navigator.mediaDevices.getDisplayMedia({audio:!1,video:!0}):navigator.mediaDevices.getUserMedia({audio:"audio"===e&&{...l&&{echoCancellation:!0},...d&&{noiseSuppression:!0}},video:"video"===e&&{facingMode:t}})}async function _(){if(!y||!y.facingMode)return;const e=y.streams.ownVideo;if(!e)return;const t=e.getTracks()[0];if(!t)return;const a=y.connection.getSenders().find(e=>t.id===e.track?.id);if(a){y.facingMode="environment"===y.facingMode?"user":"environment";try{const e=await D("video",y.facingMode);await a.replaceTrack(e.getTracks()[0]),y.streams.ownVideo=e,F()}catch(e){}}}async function O(e,t=void 0){if(!y)return;const a="audio"===e?y.streams.ownAudio:"video"===e?y.streams.ownVideo:y.streams.ownPresentation;if(!a)return;const n=a.getTracks()[0];if(!n)return;const i=y.connection.getSenders().find(e=>n.id===e.track?.id);if(i){t=void 0===t?!n.enabled:t;try{if(t&&!n.enabled){const t=await D(e);t.getTracks()[0].onended=()=>{O(e,!1)},await i.replaceTrack(t.getTracks()[0]),"audio"===e?y.streams.ownAudio=t:"video"===e?(y.streams.ownVideo=t,y.facingMode="user"):y.streams.ownPresentation=t,"video"!==e&&"presentation"!==e||O("video"===e?"presentation":"video",!1)}else if(!t&&n.enabled){n.stop();const t="audio"===e?y.silence:"video"===e?y.blackVideo:y.blackPresentation;if(!t)return;await i.replaceTrack(t.getTracks()[0]),"audio"===e?y.streams.ownAudio=t:"video"===e?y.streams.ownVideo=t:y.streams.ownPresentation=t}F(),H()}catch(e){console.error(e)}}}async function J(e,t,a,n,i,o){const s=new RTCPeerConnection({iceServers:e.map(e=>({urls:[e.isTurn&&`turn:${e.ip}:${e.port}`,e.isStun&&`stun:${e.ip}:${e.port}`].filter(Boolean),username:e.username,credentialType:"password",credential:e.password})),iceTransportPolicy:i?"all":"relay",bundlePolicy:"max-bundle",iceCandidatePoolSize:U});s.onicecandidate=e=>{e.candidate&&t({"@type":"Candidates",candidates:[{sdpString:e.candidate.candidate}]})},s.onconnectionstatechange=()=>{o({"@type":"updatePhoneCallConnectionState",connectionState:s.connectionState})},s.ontrack=e=>{if(!y)return;const t=e.streams[0];"audio"===e.track.kind?(y.audio.srcObject=t,y.audio.play().catch(),y.streams.audio=t):"1"===e.transceiver.mid?y.streams.video=t:y.streams.presentation=t,F()},s.oniceconnectionstatechange=async e=>{switch(s.iceConnectionState){case"disconnected":case"failed":a&&await W(s,{offerToReceiveAudio:!0,offerToReceiveVideo:!0,iceRestart:!0})}};const r=m(new AudioContext),c=A({width:640,height:480}),l=A({width:640,height:480});s.addTrack(r.getTracks()[0],r),s.addTrack(c.getTracks()[0],c),s.addTrack(l.getTracks()[0],l);const d=s.createDataChannel("data",{id:0,negotiated:!0});d.onmessage=e=>{K(JSON.parse(e.data))};const u=new Audio;y={audio:u,connection:s,emitSignalingData:t,isOutgoing:a,pendingCandidates:[],onUpdate:o,streams:{ownVideo:c,ownAudio:r,ownPresentation:l},mediaState:{isBatteryLow:!1,screencastState:"inactive",videoState:"inactive",videoRotation:0,isMuted:!0},blackVideo:c,blackPresentation:l,silence:r,dataChannel:d};try{O("audio",!0)}catch(e){console.error(e)}a&&await W(s,{offerToReceiveAudio:!0,offerToReceiveVideo:!0})}function j(){y&&(y.streams.ownVideo?.getTracks().forEach(e=>e.stop()),y.streams.ownPresentation?.getTracks().forEach(e=>e.stop()),y.streams.ownAudio?.getTracks().forEach(e=>e.stop()),y.dataChannel.close(),y.connection.close(),y=void 0)}function H(){if(!y)return;const{emitSignalingData:e,streams:t}=y;e({"@type":"MediaState",videoRotation:0,isMuted:!t.ownAudio?.getTracks()[0].enabled,isBatteryLow:!0,videoState:t.ownVideo?.getTracks()[0].enabled?"active":"inactive",screencastState:t.ownPresentation?.getTracks()[0].enabled?"active":"inactive"})}function $(e){if(!y||y.isOutgoing)return e;const{payloadTypes:t}=e,a=t.findIndex(e=>"VP8"===e.name),n=t[a],i=t.findIndex(e=>Number(e.parameters?.apt)===n.id);return e.payloadTypes=[t[a],t[i]],e}function z(e){if(!y)return;const{emitSignalingData:t}=y;e.ssrc&&e["ssrc-groups"]&&e["ssrc-groups"][0]&&e["ssrc-groups"][1]&&t({"@type":"InitialSetup",fingerprints:e.fingerprints,ufrag:e.ufrag,pwd:e.pwd,audio:{ssrc:i(e.ssrc).toString(),ssrcGroups:[],payloadTypes:e.audioPayloadTypes,rtpExtensions:e.audioExtmap},video:$({ssrc:i(e["ssrc-groups"][0].sources[0]).toString(),ssrcGroups:[{semantics:e["ssrc-groups"][0].semantics,ssrcs:e["ssrc-groups"][0].sources.map(i)}],payloadTypes:e.videoPayloadTypes,rtpExtensions:e.videoExtmap}),screencast:$({ssrc:i(e["ssrc-groups"][1].sources[0]).toString(),ssrcGroups:[{semantics:e["ssrc-groups"][1].semantics,ssrcs:e["ssrc-groups"][1].sources.map(i)}],payloadTypes:e.screencastPayloadTypes,rtpExtensions:e.screencastExtmap})})}async function K(e){if(y&&y.connection)switch(e["@type"]){case"MediaState":y.mediaState=e,F(),H();break;case"Candidates":{const{pendingCandidates:t,gotInitialSetup:a}=y;e.candidates.forEach(e=>{t.push(e.sdpString)}),a&&await q();break}case"InitialSetup":{const{connection:t,isOutgoing:a}=y;if(!t)return;const n={transport:{candidates:[],ufrag:e.ufrag,pwd:e.pwd,fingerprints:e.fingerprints,"rtcp-mux":!1,xmlns:""},sessionId:Date.now(),ssrcs:[e.audio&&{isVideo:!1,isMain:!1,userId:"123",endpoint:"0",mid:"0",sourceGroups:[{sources:[e.audio.ssrc]}]},e.video&&{isVideo:!0,isPresentation:!1,isMain:!1,userId:"123",endpoint:"1",mid:"1",sourceGroups:e.video.ssrcGroups.map(e=>({semantics:e.semantics,sources:e.ssrcs}))},e.screencast&&{isVideo:!0,isPresentation:!0,isMain:!1,userId:"123",endpoint:"2",mid:"2",sourceGroups:e.screencast.ssrcGroups.map(e=>({semantics:e.semantics,sources:e.ssrcs}))}],audioPayloadTypes:e.audio.payloadTypes?.map(s)||[],audioExtensions:e.audio.rtpExtensions,videoPayloadTypes:$(e.video).payloadTypes?.map(s)||[],videoExtensions:e.video.rtpExtensions};if(await t.setRemoteDescription({sdp:p(n,a,void 0,!0),type:a?"answer":"offer"}),y.conference=n,!a){const e=await t.createAnswer();await t.setLocalDescription(e),z(u(t.localDescription,!0))}y.gotInitialSetup=!0,await q();break}}}async function q(){if(!y)return;const{pendingCandidates:e,connection:t}=y;e.length&&(await Promise.all(e.map(e=>async function(e,t){try{await e.addIceCandidate({candidate:t,sdpMLineIndex:0})}catch(e){console.error(e)}}(t,e))),y.pendingCandidates=[])}async function W(e,t){const a=await e.createOffer(t);await e.setLocalDescription(a),z(u(e.localDescription,!0))}},17599:(e,t,a)=>{a.a(e,async(e,t)=>{try{var n=a(31481),i=a(17538),o=a(14487),s=a(24021),r=a(13439),c=a(80840),l=a(32989),d=a(60919),u=a(71331),p=a(12859),m=a(42347),A=e([s,p,m]);[s,p,m]=A.then?(await A)():A;const g=500;(0,r.aJ)("leaveGroupCall",async(e,t,a)=>{const{isFromLibrary:n,shouldDiscard:l,shouldRemove:d,rejoin:m,isPageUnload:A,tabId:g=(0,o.g0)()}=a||{},h=(0,u.iT)(e);h&&(e=(0,c.R6)(e,{connectionState:"disconnected"},h.participantsCount-1),e={...e,groupCalls:{...e.groupCalls,activeGroupCallId:void 0}},(0,r.UF)(e),await(0,s.px)("leaveGroupCall",{call:h,isPageUnload:A}),await(0,s.px)("abortRequestGroup","call"),l&&await(0,s.px)("discardGroupCall",{call:h}),e=(0,r.mS)(),d&&(e=(0,c.um)(e,h.id)),(0,p.ow)(),(0,r.UF)(e),t.toggleGroupCallPanel({force:void 0,tabId:g}),n||(0,i.F3)(),t.afterHangUp(),m&&t.requestMasterAndJoinGroupCall({...m,tabId:g}))}),(0,r.aJ)("toggleGroupCallVideo",async e=>{const t=(0,u.iT)(e),a=(0,d.mBe)(e,e.currentUserId);a&&t&&(await(0,i.jP)("video"),await(0,s.px)("editGroupCallParticipant",{call:t,videoStopped:!(0,i.Y8)("video"),participant:a}))}),(0,r.aJ)("requestToSpeak",(e,t,a)=>{const{value:n}=a||{value:!0},i=(0,u.iT)(e),o=(0,d.mBe)(e,e.currentUserId);o&&i&&(0,s.px)("editGroupCallParticipant",{call:i,raiseHand:n,participant:o})}),(0,r.aJ)("setGroupCallParticipantVolume",(e,t,a)=>{const{participantId:o,volume:r}=a,c=(0,u.iT)(e),l=(0,d.mBe)(e,o);l&&c&&((0,i.ls)(o,Math.floor(r/n.CH0)/100),(0,s.px)("editGroupCallParticipant",{call:c,volume:Number(r),participant:l}))}),(0,r.aJ)("toggleGroupCallMute",async(e,t,a)=>{const{participantId:n,value:o}=a||{},r=(0,u.iT)(e),c=(0,d.mBe)(e,n||e.currentUserId);if(!c||!r)return;const l=void 0===o?(0,i.Y8)("audio",c.id):o;n?(0,i.ls)(n,l?0:1):await(0,i.jP)("audio"),await(0,s.px)("editGroupCallParticipant",{call:r,muted:l,participant:c})}),(0,r.aJ)("toggleGroupCallPresentation",async(e,t,a)=>{const n=(0,u.iT)(e),o=(0,d.mBe)(e,e.currentUserId);if(o&&n){if(void 0!==a?.value?a?.value:!(0,i.Y8)("presentation")){const e=await(0,i.Dd)();if(!e)return;await(0,s.px)("joinGroupCallPresentation",{call:n,params:e})}else await(0,i.jP)("presentation",!1),await(0,s.px)("leaveGroupCallPresentation",{call:n});await(0,s.px)("editGroupCallParticipant",{call:n,presentationPaused:!(0,i.Y8)("presentation"),participant:o})}}),(0,r.aJ)("connectToActiveGroupCall",async(e,t,a)=>{const{tabId:n=(0,o.g0)()}=a||{},c=(0,u.iT)(e);if(!c)return;if("discarded"===c.connectionState)return void t.showNotification({message:"This voice chat is not active",tabId:n});const l=(0,p.sN)(),A=(0,p.Hc)();if(!l||!A)return;const{currentUserId:g}=e;if(!g)return;const h=await(0,i.U7)(g,A,l,t.apiUpdate),f=await(0,s.px)("joinGroupCall",{call:c,params:h,inviteHash:c.inviteHash});if(e=(0,r.mS)(),!f)return t.showNotification({message:"Failed to join voice chat",tabId:n}),void t.leaveGroupCall({tabId:n});if(t.loadMoreGroupCallParticipants(),c.chatId){e=(0,r.mS)();const a=(0,d.hds)(e,c.chatId);if(!a)return;await(0,m.ad)(e,t,a)}}),(0,r.aJ)("connectToActivePhoneCall",async(e,t)=>{const{phoneCall:a}=e;if(!a)return;const n=(0,u.uu)(e);if(!n)return;const i=await(0,s.px)("getDhConfig");if(!i)return;await(0,s.px)("createPhoneCallState",[!0]);const r=await(0,s.px)("requestPhoneCall",[i]);await(0,s.px)("requestCall",{user:n,gAHash:r,isVideo:a.isVideo})||"hangUp"in t&&t.hangUp({tabId:(0,o.g0)()})}),(0,r.aJ)("acceptCall",async e=>{const{phoneCall:t}=e;if(!t)return;const a=await(0,s.px)("getDhConfig");if(!a)return;await(0,s.px)("createPhoneCallState",[!1]);const n=await(0,s.px)("acceptPhoneCall",[a]);await(0,s.px)("acceptCall",{call:t,gB:n})}),(0,r.aJ)("sendSignalingData",(e,t,a)=>{const{phoneCall:n}=e;if(!n)return;const i=JSON.stringify(a);(async()=>{const e=await(0,s.px)("encodePhoneCallData",[i]);e&&(0,s.px)("sendSignalingData",{data:e,call:n})})()}),(0,r.aJ)("closeCallRatingModal",(e,t,a)=>{const{tabId:n=(0,o.g0)()}=a||{};return(0,l.w)(e,{ratingPhoneCall:void 0},n)}),(0,r.aJ)("setCallRating",(e,t,a)=>{const{rating:n,comment:i,tabId:r=(0,o.g0)()}=a,{ratingPhoneCall:c}=(0,d.nTw)(e,r);if(c)return(0,s.px)("setCallRating",{call:c,rating:n,comment:i}),(0,l.w)(e,{ratingPhoneCall:void 0},r)}),(0,r.aJ)("hangUp",(e,t,a)=>{const{isPageUnload:n,tabId:c=(0,o.g0)()}=a||{},{phoneCall:l}=e;if(l){if("discarded"===l.state)return(0,s.px)("destroyPhoneCallState"),(0,i.Bd)(),e={...e,phoneCall:void 0},(0,r.UF)(e),t.toggleGroupCallPanel({force:void 0,tabId:c}),void t.afterHangUp();if((0,s.px)("destroyPhoneCallState"),(0,i.Bd)(),(0,s.px)("discardCall",{call:l,isPageUnload:n}),"requesting"===l.state)return e={...e,phoneCall:void 0},(0,r.UF)(e),t.toggleGroupCallPanel({force:void 0,tabId:c}),void t.afterHangUp();setTimeout(()=>{e=(0,r.mS)(),e={...e,phoneCall:void 0},(0,r.UF)(e),t.toggleGroupCallPanel({force:void 0,tabId:c}),t.afterHangUp()},g)}}),t()}catch(e){t(e)}})},31710:(e,t,a)=>{a.d(t,{A:()=>n});const n={root:"Wk7JwPx3",subtitle:"ShcCNemD",subtitleText:"UZLgp2cx",icon:"vRc6jhKf",subtitleBlue:"yA7bxEWw",subtitleRed:"DnuZwImI",subtitleGreen:"BkgYQGFq",avatar:"ouHUJ9ff"}},31791:(e,t,a)=>{a.d(t,{v:()=>n});let n=function(e){return e.FULLSCREEN_CHANGE="fullscreen-change",e.UPDATE_ERROR="update-error",e.UPDATE_AVAILABLE="update-available",e.DEEPLINK="deeplink",e}({})},33492:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.d(t,{A:()=>b});var i=a(84051),o=a(13439),s=a(71331),r=a(87357),c=a(61191),l=a(58443),d=a(59030),u=a(73767),p=a(4438),m=a(64493),A=a(57474),g=a(71066),h=e([d,m]);[d,m]=h.then?(await h)():h;const f="discarded",v=3e3,y=200,V=36,C=({className:e,noAudioStream:t,canSelfUnmute:a,isMuted:n,connectionState:s})=>{const{toggleGroupCallMute:h,requestToSpeak:f,playGroupCallSound:C}=(0,o.getActions)(),b=(0,d.A)(),w=(0,i.li)("up"),[E,S]=(0,i.J0)(!1),k="connected"!==s,I=!a&&n,P=(0,u.A)(I);(0,i.vJ)(()=>{P&&!I&&C({sound:"allowTalk"})},[C,P,I]);const T=(0,i.Kr)(()=>{if(E){const e=Math.floor(100*Math.random());return e<32?[0,120]:e<64?[120,240]:e<97?[240,420]:[420,540]}return!P&&I?t?[99,135]:[136,172]:P&&!I?[0,36]:I?[0,0]:t?[69,99]:[36,69]},[P,E,t,I]),N=E?"HandFilled":"VoiceMini",M=(0,i.hb)(()=>{(0,c.g)(),h()},[h]),x=(0,i.hb)(()=>{if(I){if(E)return;return(0,c.g)(),f(),S(!0),void setTimeout(()=>{S(!1)},v)}w.current="down",t&&setTimeout(()=>{"down"===w.current&&(w.current="hold",M())},y)},[E,t,f,I,M]),G=(0,i.hb)(()=>{I||(M(),w.current="up")},[I,M]);return i.Ay.createElement(m.A,{round:!0,size:"default",className:(0,r.A)(g.A.root,!k&&t&&g.A.canUnmute,!k&&I&&g.A.mutedByAdmin,e),onMouseDown:x,onMouseUp:G,ariaLabel:b(n?"VoipUnmute":"VoipMute"),disabled:k},i.Ay.createElement(p.A,{tgsUrl:l.w[N],size:V,play:T.toString(),playSegment:T,className:g.A.icon,forceAlways:!0}),i.Ay.createElement(A.A,{className:(0,r.A)(g.A.spinner,k&&g.A.spinnerVisible),color:"white"}))},b=(0,i.ph)((0,o.EK)(e=>{const t=(0,s.iT)(e),{connectionState:a}=t||{},n=t&&(0,s.n5)(e,t.id,e.currentUserId),{raiseHandRating:i,hasAudioStream:o,canSelfUnmute:r,isMuted:c}=n||{};return{connectionState:a||f,hasRequestedToSpeak:Boolean(i),noAudioStream:!o,canSelfUnmute:r,isMuted:c}})(C));n()}catch(e){n(e)}})},34808:(e,t,a)=>{a.d(t,{A:()=>n});const n={stars:"P7EfDKJN",star:"t8LJLFSN",isFilled:"_XX6q8YW",comment:"EvL0WaKD",visible:"v5hn1XvT"}},44751:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.d(t,{A:()=>M});var i=a(84051),o=a(85958),s=a(13439),r=a(17538),c=a(60919),l=a(71331),d=a(87357),u=a(87894),p=a(43874),m=a(37661),A=a(5912),g=a(17712),h=a(59030),f=a(90423),v=a(98522),y=a(54746),V=a(64493),C=a(19806),b=a(12933),w=a(8410),E=a(87900),S=a(48995),k=a(33492),I=a(86783),P=e([o,h,V,C,b,w,E,S,k]);[o,h,V,C,b,w,E,S,k]=P.then?(await P)():P;const T=200,N=({groupCallId:e,isCallPanelVisible:t,connectionState:a,participantsCount:n,title:o,meParticipant:c,isAdmin:l,participants:P,canInvite:N})=>{const{toggleGroupCallVideo:M,toggleGroupCallPresentation:x,leaveGroupCall:G,toggleGroupCallPanel:B,connectToActiveGroupCall:R,playGroupCallSound:U,createGroupCallInviteLink:L}=(0,s.getActions)(),F=(0,h.A)(),D=(0,i.li)(),_=(0,i.li)(),O=(0,i.li)(),J=(0,i.li)(),j=(0,i.li)(),[H,$]=(0,i.J0)(!1),z=!t&&!H,{observe:K}=(0,A.BL)({rootRef:j,throttleMs:T,isDisabled:!z}),q=!(0,A.Vz)(J,z?K:void 0),{isMobile:W,isLandscape:Y}=(0,p.Ay)(),[Z,Q,X]=(0,m.A)(),[ee,te,ae]=(0,m.A)(!0),ne=Boolean(Z&&Y),ie=(0,f.zk)(),oe=(0,i.Kr)(()=>Object.values(P).find(({presentation:e})=>e),[P]),se=(0,i.Kr)(()=>Object.values(P).filter(({video:e,presentation:t})=>e||t).flatMap(({id:e,video:t,presentation:a})=>(0,u.oE)([t?{id:e,type:"video"}:void 0,a?{id:e,type:"screen"}:void 0])),[P]),re=se.length>0,ce=o||F("VoipGroupVoiceChat"),le=F("Participants",n,"i"),[de,ue,pe]=(0,m.A)(),[me,Ae]=(0,i.J0)(!1),[ge,he]=(0,i.J0)(!1),fe=c?.hasVideoStream,ve=c?.hasPresentationStream,ye=c?.hasAudioStream,Ve="connected"!==a,Ce=c?.canSelfUnmute,be=!Ce&&!ye;(0,i.vJ)(()=>{"connected"===a?U({sound:"join"}):"reconnecting"===a&&U({sound:"connecting"})},[a]);const we=(0,g.A)(()=>{pe(),Ae(!1)}),Ee=(0,g.A)(()=>{D.current&&!W&&(Z?X():Q())}),Se=(0,g.A)(()=>{ee?ae():te()}),ke=(0,g.A)(()=>{B()}),Ie=(0,g.A)(()=>{L()}),Pe=(0,g.A)(()=>{M()});(0,i.vJ)(()=>{R()},[R,e]);const Te=(0,g.A)(()=>{!l||de?(U({sound:"leave"}),$(!0),pe()):ue()}),Ne=(0,g.A)(()=>{H&&G({shouldDiscard:ge})}),Me=(0,g.A)(()=>{x()}),xe=se.length>1&&!W,Ge=ne&&re,[Be,Re]=(0,i.J0)(void 0),{videoLayout:Ue,panelOffset:Le}=(0,v.A)({primaryContainerRef:_,secondaryContainerRef:O,videoParticipants:se,isLandscapeLayout:ne,pinnedVideo:Be}),Fe=(0,g.A)(e=>{Re(e),e&&!Z&&Q()}),De=(0,g.A)(()=>{oe&&Re({id:oe.id,type:"screen"})});return(0,i.vJ)(De,[De,Boolean(oe)]),(0,i.vJ)(()=>{Be&&(se.some(e=>e.type===Be.type&&e.id===Be.id)||Re(void 0))},[Be,Ue,se]),i.Ay.createElement(w.A,{isOpen:z,onClose:B,className:(0,d.A)(I.A.root,(Z||W)&&I.A.fullscreen,ie&&I.A.appFullscreen,ne&&I.A.landscape,!re&&I.A.noVideoParticipants,!ne&&I.A.portrait,!ee&&Ge&&I.A.noSidebar),dialogRef:D,onCloseAnimationEnd:Ne},Ge&&i.Ay.createElement("div",{className:I.A.videos},i.Ay.createElement("div",{className:I.A.videosHeader},!W&&i.Ay.createElement(V.A,{round:!0,size:"smaller",color:"translucent",onClick:Ee,className:(0,d.A)(I.A.headerButton,I.A.firstButton),ariaLabel:F(Z?"AccExitFullscreen":"AccSwitchToFullscreen")},i.Ay.createElement(y.A,{name:Z?"smallscreen":"fullscreen"})),i.Ay.createElement("h3",{className:(0,d.A)(I.A.title,I.A.bigger)},o||F("VoipGroupVoiceChat")),Ge&&!ee&&i.Ay.createElement(V.A,{round:!0,size:"smaller",color:"translucent",className:(0,d.A)(I.A.headerButton,I.A.videosHeaderLastButton),onClick:Se,ariaLabel:F("AccDescrExpandPanel")},i.Ay.createElement(y.A,{name:"sidebar"}))),i.Ay.createElement("div",{className:I.A.videosContent,ref:_})),i.Ay.createElement("div",{className:I.A.panelWrapper,ref:j},i.Ay.createElement("div",{className:(0,d.A)(I.A.panel,"custom-scroll")},i.Ay.createElement("div",{className:I.A.panelScrollTrigger,ref:J}),i.Ay.createElement("div",{className:(0,d.A)(I.A.panelHeader,q&&I.A.scrolled)},!Ge&&!W&&i.Ay.createElement(V.A,{round:!0,size:"smaller",color:"translucent",ripple:!W,className:(0,d.A)(I.A.firstButton,I.A.headerButton),onClick:Ee,ariaLabel:F("AccSwitchToFullscreen")},i.Ay.createElement(y.A,{name:"fullscreen"})),W&&i.Ay.createElement(V.A,{round:!0,size:"smaller",color:"translucent",onClick:ke,className:(0,d.A)(I.A.headerButton,I.A.firstButton),ariaLabel:F("Close")},i.Ay.createElement(y.A,{name:"close"})),Ge&&i.Ay.createElement(V.A,{round:!0,size:"smaller",ripple:!W,className:(0,d.A)(I.A.firstButton,I.A.headerButton),color:"translucent",onClick:Se,ariaLabel:F("AccDescrCollapsePanel")},i.Ay.createElement(y.A,{name:"sidebar"})),i.Ay.createElement("div",{className:I.A.panelHeaderText},i.Ay.createElement("h3",{className:(0,d.A)(I.A.title,Ge&&I.A.bigger)},Ge?le:ce),!Ge&&i.Ay.createElement("span",{className:I.A.subtitle},le)),!Ge&&N&&i.Ay.createElement(V.A,{round:!0,size:"smaller",ripple:!W,className:(0,d.A)(I.A.lastButton,I.A.headerButton),color:"translucent",onClick:Ie,ariaLabel:F("VoipGroupInviteMember")},i.Ay.createElement(y.A,{name:"add-user"}))),i.Ay.createElement("div",{className:I.A.participants},i.Ay.createElement("div",{className:I.A.participantVideos,ref:O,style:`height: ${Le}px;`},Ue.map(e=>{const t=P[e.participantId];return e.isRemounted&&t?i.Ay.createElement(S.A,{teactOrderKey:e.orderKey,key:`${e.participantId}_${e.type}`,layout:e,canPin:xe,setPinned:Fe,pinnedVideo:Be,participant:t}):i.Ay.createElement("div",{teactOrderKey:e.orderKey,key:`${e.participantId}_${e.type}`})})),i.Ay.createElement(E.A,{panelOffset:Le,isLandscape:Ge}))),i.Ay.createElement(b.A,{key:"add-participant",isShown:Ge&&N,onClick:Ie,className:I.A.addParticipantButton,ariaLabel:F("VoipGroupInviteMember")},i.Ay.createElement(y.A,{name:"add-user-filled"}))),i.Ay.createElement("div",{className:I.A.mainVideoContainer},Ue.map(e=>{const t=P[e.participantId];return e.isRemounted||!t?i.Ay.createElement("div",{teactOrderKey:e.orderKey,key:`${e.participantId}_${e.type}`}):i.Ay.createElement(S.A,{teactOrderKey:e.orderKey,key:`${e.participantId}_${e.type}`,layout:e,canPin:xe,setPinned:Fe,pinnedVideo:Be,participant:t,className:I.A.video})})),i.Ay.createElement("div",{className:I.A.actions},i.Ay.createElement(V.A,{round:!0,size:"default",ripple:!0,className:(0,d.A)(I.A.actionButton,!ye&&I.A.muted,be&&I.A.canRequestToSpeak),onClick:Pe,ariaLabel:F(fe?"VoipStopVideo":"VoipStartVideo"),disabled:Ve},i.Ay.createElement(y.A,{name:fe?"video":"video-stop"})),i.Ay.createElement(V.A,{round:!0,size:"default",ripple:!0,className:(0,d.A)(I.A.actionButton,!ye&&I.A.muted,be&&I.A.canRequestToSpeak),onClick:Me,ariaLabel:F(ve?"lng_group_call_screen_share_stop":"lng_group_call_tooltip_screen"),disabled:Ve||!r._2},i.Ay.createElement(y.A,{name:ve?"share-screen":"share-screen-stop"})),i.Ay.createElement(k.A,{className:I.A.actionButton}),i.Ay.createElement(V.A,{round:!0,size:"default",ripple:!0,className:(0,d.A)(I.A.actionButton,!ye&&I.A.muted,be&&I.A.canRequestToSpeak),ariaLabel:F("lng_group_call_settings"),disabled:!0},i.Ay.createElement(y.A,{name:"settings-filled"})),i.Ay.createElement(V.A,{round:!0,size:"default",ripple:!0,className:(0,d.A)(I.A.actionButton,I.A.destructive),onClick:Te,ariaLabel:F("lng_group_call_leave")},i.Ay.createElement(y.A,{name:"close"}))),i.Ay.createElement(w.A,{isOpen:de,onClose:we,className:"error",title:F(me?"VoipGroupEndAlertTitle":"VoipGroupLeaveAlertTitle")},i.Ay.createElement("p",null,F(me?"VoipGroupEndAlertText":"VoipGroupLeaveAlertText")),!me&&i.Ay.createElement(C.A,{className:"dialog-checkbox",label:F("VoipGroupEndChat"),checked:ge,onCheck:he}),i.Ay.createElement("div",{className:"dialog-buttons"},i.Ay.createElement(V.A,{isText:!0,className:"confirm-dialog-button",onClick:Te},F(me?"VoipGroupEnd":"VoipGroupLeave")),i.Ay.createElement(V.A,{isText:!0,className:"confirm-dialog-button",onClick:we},F("Cancel")))))},M=(0,i.ph)((0,s.EK)((e,{groupCallId:t})=>{const{connectionState:a,title:n,participants:i,participantsCount:o,chatId:s}=(0,l.Ip)(e,t)||{},r=s?(0,c.hds)(e,s):void 0;return{connectionState:a,title:n||r?.title,participantsCount:o,meParticipant:(0,l.n5)(e,t,e.currentUserId),isCallPanelVisible:Boolean((0,c.nTw)(e).isCallPanelVisible),isAdmin:(0,l.qI)(e),participants:i,canInvite:(0,l.O7)(e)}})(N));n()}catch(e){n(e)}})},48995:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.d(t,{A:()=>x});var i=a(84051),o=a(13439),s=a(31481),r=a(32610),c=a(66644),l=a(17538),d=a(60919),u=a(19822),p=a(96454),m=a(87357),A=a(37836),g=a(82892),h=a(32625),f=a(10722),v=a(17712),y=a(59030),V=a(35384),C=a(54746),b=a(64493),w=a(55158),E=a(99053),S=a(77641),k=a(56143),I=e([y,V,b,E]);[y,V,b,E]=I.then?(await I)():I;const P=2,T=2,N=1e3,M=({layout:e,pinnedVideo:t,setPinned:a,canPin:n,className:o,participant:d,user:I,chat:M})=>{const x=(0,y.A)(),G=(0,i.li)(),B=(0,i.li)(),R=(0,i.li)(),{x:U,y:L,width:F,height:D,noAnimate:_,isRemoved:O,type:J}=e,{isSelf:j,isMutedByMe:H,isMuted:$}=d,z=t?.id===d.id&&t?.type===J,K=(d.amplitude||0)>l.yW,q=Boolean(d.raiseHandRating),W="video"===J&&d.isSelf,Y=(0,i.Kr)(()=>j?x("ThisIsYou"):H?x("VoipGroupMutedForMe"):q?x("WantsToSpeak"):$||!K?x("Listening"):d.volume&&d.volume!==s.iRY?x("SpeakingWithVolume",(0,g.A)(d)).replace("%%","%"):x("Speaking"),[j,H,q,$,K,d,x]),Z=(0,i.li)();O||(Z.current=e);const{x:Q,y:X,width:ee,height:te}=Z.current||{},[ae,ne,ie,oe]=O?[Q,X,ee,te]:[U,L,F,D],[se,re]=(0,i.J0)(!_),ce=(0,l.F0)(I?.id||M.id),le="video"===J?ce?.video:ce?.presentation,de=(0,i.li)(le);le?.active&&le?.getVideoTracks()[0].enabled&&(de.current=le);const ue=de.current,pe=(0,v.A)(()=>{const e=B.current;e&&(e.srcObject=null)});(0,i.vJ)(()=>(ue?.addEventListener("inactive",pe),()=>{ue?.removeEventListener("inactive",pe)}),[pe,ue]),(0,i.vJ)(()=>{re(!1)},[]);const[me,Ae]=(0,i.J0)(!0),ge=(0,v.A)(()=>{Ae(!1)});(0,h.A)(()=>{if(!ue?.active)return;const e=B.current,t=R.current;(0,c.RK)(()=>{t.width=e.videoWidth,t.height=e.videoHeight,t.getContext("2d").drawImage(e,0,0,t.width,t.height)})},N),(0,i.vJ)(()=>{const e=B.current,t=G.current;if(!e||!t||!ue)return;const a=t.getContext("2d",{alpha:!1});if(!a)return;let n=!0;return(0,c.RK)(()=>{n&&(t.width=16,t.height=16,a.filter="blur(2px)",(0,u.i0)(()=>!!n&&!!ue.active&&(a.drawImage(e,0,0,e.videoWidth,e.videoHeight,0,0,t.width,t.height),p.QH||(0,r.A)(a,0,0,t.width,t.height,P,T),!0),A.IJ))}),()=>{n=!1}},[ue]);const he=(0,i.li)(),fe=(0,i.li)(),{isContextMenuOpen:ve,contextMenuAnchor:ye,handleContextMenu:Ve,handleContextMenuClose:Ce,handleContextMenuHide:be}=(0,f.A)(he,j),we=(0,i.hb)(()=>he.current,[]),Ee=(0,i.hb)(()=>he.current.closest(".custom-scroll, .no-scrollbar"),[]),Se=(0,i.hb)(()=>fe.current,[]),ke=(0,i.hb)(()=>({withPortal:!0}),[]),Ie=(0,i.hb)(()=>{a(z?void 0:{id:I?.id||M.id,type:J})},[M,z,a,J,I?.id]);return i.Ay.createElement("div",{className:(0,m.A)(k.A.wrapper,(se||O)&&k.A.hidden,_&&k.A.noAnimate,o,z&&k.A.pinned),style:`--x: ${ae}px; --y: ${ne}px; --width: ${ie}px; --height: ${oe}px;`,ref:he,onContextMenu:Ve,onDoubleClick:n?Ie:void 0},i.Ay.createElement("div",{className:(0,m.A)(k.A.root,K&&k.A.speaking)},me&&i.Ay.createElement(w.A,{className:(0,m.A)(k.A.video,k.A.loader)}),ue&&i.Ay.createElement("video",{className:(0,m.A)(k.A.video,W&&k.A.flipped),muted:!0,autoPlay:!0,playsInline:!0,srcObject:ue,ref:B,onCanPlay:ge}),i.Ay.createElement("canvas",{className:(0,m.A)(k.A.videoFallback,W&&k.A.flipped),ref:R}),i.Ay.createElement("div",{className:k.A.thumbnailWrapper},i.Ay.createElement("canvas",{className:(0,m.A)(k.A.thumbnail,W&&k.A.flipped),ref:G})),n&&i.Ay.createElement(b.A,{round:!0,size:"smaller",ripple:!0,color:"translucent",className:k.A.pinButton,ariaLabel:x(z?"lng_group_call_context_unpin_camera":"lng_group_call_context_pin_camera"),onClick:Ie},i.Ay.createElement(C.A,{name:z?"unpin":"pin"})),i.Ay.createElement("div",{className:k.A.bottomPanel},i.Ay.createElement("div",{className:k.A.info},i.Ay.createElement(V.A,{peer:I||M,className:k.A.name}),i.Ay.createElement("div",{className:k.A.status},Y)),i.Ay.createElement(S.A,{participant:d,className:k.A.icon,noColor:!0}))),i.Ay.createElement(E.A,{participant:d,isDropdownOpen:ve,anchor:ye,getTriggerElement:we,getRootElement:Ee,getMenuElement:Se,getLayout:ke,onClose:Ce,onCloseAnimationEnd:be,menuRef:fe}))},x=(0,i.ph)((0,o.EK)((e,{participant:t})=>({user:t.isUser?(0,d.mBe)(e,t.id):void 0,chat:t.isUser?void 0:(0,d.hds)(e,t.id)}))(M));n()}catch(e){n(e)}})},56143:(e,t,a)=>{a.d(t,{A:()=>n});const n={wrapper:"DKuzmnN7",hidden:"T_wodAHA",noAnimate:"yPCkJzpi",root:"eBq1NoLo",speaking:"h4NcT6OS",loader:"XedVWQii",video:"eUXuK9Oz",videoFallback:"eTpvBU_b eUXuK9Oz",thumbnailWrapper:"R5ULTrF9",thumbnail:"cjUWuViy",flipped:"O2bTiH2E",pinButton:"lPdblo0y",bottomPanel:"T1deCDSn",info:"LzFFayK3",pinned:"B4WZhF9P",name:"RBwMAuKp",status:"z1ZZTsjC",icon:"j1aDzn1H"}},58995:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.d(t,{A:()=>T});var i=a(84051),o=a(85958),s=a(13439),r=a(17538),c=a(60919),l=a(71331),d=a(96454),u=a(87357),p=a(17663),m=a(58443),A=a(4961),g=a(32625),h=a(43874),f=a(37661),v=a(30857),y=a(59030),V=a(4438),C=a(21849),b=a(54746),w=a(64493),E=a(8410),S=a(83551),k=a(13899),I=e([o,y,C,w,E,S]);[o,y,C,w,E,S]=I.then?(await I)():I;const P=({user:e,isOutgoing:t,phoneCall:a,isCallPanelVisible:n})=>{const o=(0,y.A)(),{hangUp:c,requestMasterAndAcceptCall:l,playGroupCallSound:I,toggleGroupCallPanel:P,connectToActivePhoneCall:T}=(0,s.getActions)(),N=(0,i.li)(),[M,x,G]=(0,f.A)(),{isMobile:B}=(0,h.Ay)(),R=(0,i.hb)(()=>{M?G():x()},[G,M,x]),U=(0,i.hb)(()=>{N.current&&(M?document.exitFullscreen().then(G):N.current.requestFullscreen().then(x))},[G,M,x]);(0,i.vJ)(()=>{if(!d.SC)return;const e=N.current;return e?(e.addEventListener("fullscreenchange",R),()=>{e.removeEventListener("fullscreenchange",R)}):void 0},[R]);const L=(0,i.hb)(()=>{P(),M&&G()},[G,M,P]),F="discarded"===a?.state,D="busy"===a?.reason,_="requested"===a?.state&&!t,O=("requested"===a?.state||"waiting"===a?.state)&&t,J="active"===a?.state,j=a?.isConnected,[H,$,z]=(0,f.A)(),K=(0,i.hb)(()=>{$(),c()},[c,$]);(0,i.vJ)(()=>{H?I({sound:"end"}):_?I({sound:"incoming"}):D?I({sound:"busy"}):F?I({sound:"end"}):O?I({sound:"ringing"}):j&&I({sound:"connect"})},[D,F,_,O,j,I,H]),(0,i.vJ)(()=>{a?.id?z():T()},[T,a?.id,z]);const q=(0,v.A)();(0,g.A)(q,j?1e3:void 0);const W=(0,i.Kr)(()=>{const e=a?.state;return H?o("lng_call_status_hanging"):D?"busy":"requesting"===e?o("lng_call_status_requesting"):"requested"===e?o(t?"lng_call_status_ringing":"lng_call_status_incoming"):"waiting"===e?o("lng_call_status_waiting"):"active"===e&&j?void 0:o("lng_call_status_exchanging")},[D,j,H,t,o,a?.state]),Y="active"===a?.videoState,Z="active"===a?.screencastState,Q=(0,r.SK)(),X=Q?.ownAudio?.getTracks()[0].enabled,ee=Q?.ownPresentation?.getTracks()[0].enabled,te=Q?.ownVideo?.getTracks()[0].enabled,[ae,ne,ie]=(0,f.A)(),[oe,se,re]=(0,f.A)(),ce=(0,i.hb)(()=>{ee&&ne(),te&&se(),setTimeout(async()=>{await(0,r.PX)("presentation"),ie(),re()},250)},[ee,te,ne,se,ie,re]),le=(0,i.hb)(()=>{te&&se(),ee&&ne(),setTimeout(async()=>{await(0,r.PX)("video"),ie(),re()},250)},[ee,te,ne,se,ie,re]),de=(0,i.hb)(()=>{(0,r.PX)("audio")},[]),[ue,pe,me]=(0,f.A)(),[Ae,ge,he]=(0,f.A)(),fe=(0,i.hb)(()=>{ge(),(0,r.qS)(),setTimeout(he,250)},[ge,he]),ve=a?.startDate&&Number(new Date)/1e3-a.startDate;return(0,i.vJ)(()=>{"discarded"===a?.state&&setTimeout(c,250)},[c,a?.reason,a?.state]),i.Ay.createElement(E.A,{isOpen:a&&"discarded"!==a?.state&&!n,onClose:L,className:(0,u.A)(k.A.root,B&&k.A.singleColumn),dialogRef:N},i.Ay.createElement(C.A,{peer:e,size:"jumbo",className:Y||Z?k.A.blurred:""}),"active"===a?.screencastState&&Q?.presentation&&i.Ay.createElement("video",{className:k.A.mainVideo,muted:!0,autoPlay:!0,playsInline:!0,srcObject:Q.presentation}),"active"===a?.videoState&&Q?.video&&i.Ay.createElement("video",{className:k.A.mainVideo,muted:!0,autoPlay:!0,playsInline:!0,srcObject:Q.video}),i.Ay.createElement("video",{className:(0,u.A)(k.A.secondVideo,!ae&&ee&&k.A.visible,M&&k.A.fullscreen),muted:!0,autoPlay:!0,playsInline:!0,srcObject:Q?.ownPresentation}),i.Ay.createElement("video",{className:(0,u.A)(k.A.secondVideo,!oe&&te&&k.A.visible,M&&k.A.fullscreen),muted:!0,autoPlay:!0,playsInline:!0,srcObject:Q?.ownVideo}),i.Ay.createElement("div",{className:k.A.header},d.SC&&i.Ay.createElement(w.A,{round:!0,size:"smaller",color:"translucent",onClick:U,ariaLabel:o(M?"AccExitFullscreen":"AccSwitchToFullscreen")},i.Ay.createElement(b.A,{name:M?"smallscreen":"fullscreen"})),i.Ay.createElement(w.A,{round:!0,size:"smaller",color:"translucent",onClick:L,className:k.A.closeButton},i.Ay.createElement(b.A,{name:"close"}))),i.Ay.createElement("div",{className:(0,u.A)(k.A.emojisBackdrop,ue&&k.A.open),onClick:ue?me:pe},i.Ay.createElement("div",{className:(0,u.A)(k.A.emojis,ue&&k.A.open)},a?.isConnected&&a?.emojis&&(0,A.A)(a.emojis,["emoji"])),i.Ay.createElement("div",{className:(0,u.A)(k.A.emojiTooltip,ue&&k.A.open)},o("CallEmojiKeyTooltip",e?.firstName).replace("%%","%"))),i.Ay.createElement("div",{className:k.A.userInfo},i.Ay.createElement("h1",null,e?.firstName),i.Ay.createElement("span",{className:k.A.status},W||(0,p.QO)(ve||0))),i.Ay.createElement("div",{className:k.A.buttons},i.Ay.createElement(S.A,{onClick:de,icon:"microphone",isDisabled:!J,isActive:X,label:o(X?"lng_call_mute_audio":"lng_call_unmute_audio")}),i.Ay.createElement(S.A,{onClick:le,icon:"video",isDisabled:!J,isActive:te,label:o(te?"lng_call_stop_video":"lng_call_start_video")}),te&&(d.Ni||d.pz)&&i.Ay.createElement(S.A,{onClick:fe,customIcon:i.Ay.createElement(V.A,{tgsUrl:m.w.CameraFlip,playSegment:Ae?[0,10]:[0,1],size:32}),isDisabled:!J,label:o("VoipFlip")}),r._2&&i.Ay.createElement(S.A,{onClick:ce,icon:"share-screen",isDisabled:!J,isActive:ee,label:o("lng_call_screencast")}),_&&i.Ay.createElement(S.A,{onClick:l,icon:"phone-discard",isDisabled:F,label:o("lng_call_accept"),className:k.A.accept,iconClassName:k.A.acceptIcon}),i.Ay.createElement(S.A,{onClick:K,icon:"phone-discard",isDisabled:F,label:o(_?"lng_call_decline":"lng_call_end_call"),className:k.A.leave})))},T=(0,i.ph)((0,s.EK)(e=>{const{phoneCall:t,currentUserId:a}=e,{isCallPanelVisible:n,isMasterTab:i}=(0,c.nTw)(e),o=(0,l.uu)(e);return{isCallPanelVisible:Boolean(n),user:o,isOutgoing:t?.adminId===a,phoneCall:i?t:void 0}})(P));n()}catch(e){n(e)}})},59545:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.d(t,{A:()=>m});var i=a(84051),o=a(13439),s=a(60919),r=a(71331),c=a(87357),l=a(59030),d=e([l]),u=d.then?(await d)():d;l=u[0];const p=({groupCall:e,phoneCallUser:t,isCallPanelVisible:a})=>{const{toggleGroupCallPanel:n}=(0,o.getActions)(),s=(0,l.A)();if((0,i.vJ)(()=>{document.body.classList.toggle("has-call-header",Boolean(a));const e=window.electron?.setWindowButtonsPosition||window.electron?.setTrafficLightPosition;return e?.(a?"lowered":"standard"),()=>{document.body.classList.toggle("has-call-header",!1),e?.("standard")}},[a]),e||t)return i.Ay.createElement("div",{className:(0,c.A)("ActiveCallHeader",a&&"open"),onClick:function(){n()}},i.Ay.createElement("span",{className:"title"},t?.firstName||e?.title||s("VoipGroupVoiceChat")))},m=(0,i.ph)((0,o.EK)(e=>{const t=(0,s.nTw)(e);return{groupCall:t.isMasterTab?(0,r.iT)(e):void 0,isCallPanelVisible:t.isCallPanelVisible,phoneCallUser:t.isMasterTab?(0,r.uu)(e):void 0}})(p));n()}catch(e){n(e)}})},61191:(e,t,a)=>{a.d(t,{g:()=>n});const n=()=>{navigator.vibrate?.(50)}},64292:(e,t,a)=>{a.d(t,{A:()=>i});var n=a(672);function i(e,t,a=[]){return(0,n.A)(e=>{e()},a,e,t)}},71066:(e,t,a)=>{a.d(t,{A:()=>n});const n={root:"lKdhQ5pw",spinner:"tyQNJC6B",spinnerVisible:"LowChABq",mutedByAdmin:"Ynow5UuE",canUnmute:"bjKqp3SI",icon:"Ea1XnQaX"}},77641:(e,t,a)=>{a.d(t,{A:()=>c});var n=a(84051),i=a(17538),o=a(58443),s=a(73767),r=a(4438);const c=(0,n.ph)(({participant:e,noColor:t,className:a})=>{const{isMuted:c,isMutedByMe:l}=e,d=(e.amplitude||0)>i.yW,u=Boolean(e.raiseHandRating),p=(0,s.A)(u),m=!Boolean(e?.canSelfUnmute)&&c,A=(0,s.A)(c),g=(0,n.Kr)(()=>c&&!A?[43,64]:!c&&A?[22,42]:u&&!p?[65,84]:!m&&p?[0,21]:c?[22,23]:[43,44],[c,m,u]),h=(0,n.Kr)(()=>t?"#ffffff":u?"#4da6e0":m||l?"#ff706f":d?"#57bc6c":"#aaaaaa",[t,u,m,l,d]);return n.Ay.createElement(r.A,{tgsUrl:o.w.VoiceOutlined,play:g.toString(),playSegment:g,size:28,color:h,className:a,forceAlways:!0,nonInteractive:!0})})},77791:(e,t,a)=>{a.d(t,{A:()=>n});const n={root:"lBO3RZUM",button:"ch2sqAKW",active:"OQxlsRp7","button-text":"aHguvLcL",buttonText:"aHguvLcL"}},82892:(e,t,a)=>{a.d(t,{A:()=>i});var n=a(31481);function i(e){return Math.floor((e.volume||n.iRY)/n.CH0).toString()}},83551:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.d(t,{A:()=>p});var i=a(84051),o=a(87357),s=a(54746),r=a(64493),c=a(77791),l=e([r]),d=l.then?(await l)():l;r=d[0];const u=({onClick:e,label:t,customIcon:a,icon:n,iconClassName:l,className:d,isDisabled:u,isActive:p})=>i.Ay.createElement("div",{className:c.A.root},i.Ay.createElement(r.A,{round:!0,className:(0,o.A)(d,c.A.button,p&&c.A.active),onClick:e,disabled:u},a||i.Ay.createElement(s.A,{name:n,className:l})),i.Ay.createElement("div",{className:c.A.buttonText},t)),p=(0,i.ph)(u);n()}catch(e){n(e)}})},85958:(e,t,a)=>{a.a(e,async(e,t)=>{try{var n=a(17599),i=a(1265),o=e([n,i]);[n,i]=o.then?(await o)():o,t()}catch(e){t(e)}})},86783:(e,t,a)=>{a.d(t,{A:()=>n});const n={root:"OsO5GKfn",panelWrapper:"cUVoePr_",panel:"Thuz79M3",panelScrollTrigger:"zoK6Y6IS",panelHeader:"DMBtCL9Z",scrolled:"GdEH1Agb",fullscreen:"JJx0QI2w",landscape:"wamCuzMB",headerButton:"gmyieSid",firstButton:"hVnn6KBp",lastButton:"iy78A5rG",panelHeaderText:"TwEEA77i",title:"pNZ9skLf",bigger:"NumT3v5i",subtitle:"gmfUKabx",participants:"iTeC_RxH",participantVideos:"PZmKIdTl",addParticipantButton:"clmu2oBt",videos:"ATwoMlAV",mainVideoContainer:"hqFon3dV",videosHeader:"KPHc659W",appFullscreen:"cl2sfoBF",videosHeaderLastButton:"_t50HVNJ",videosContent:"oEEQZilE",actions:"uGzi9s97",actionButton:"foXbVcnN",destructive:"YIR9Z9CZ",canRequestToSpeak:"ZoiZQu_O",muted:"wpvv1V6m",portrait:"R6HQcMwx",noVideoParticipants:"aepCFyJQ",noSidebar:"XjgP21E6"}},87900:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.d(t,{A:()=>v});var i=a(84051),o=a(13439),s=a(71331),r=a(87357),c=a(87894),l=a(96374),d=a(17712),u=a(46222),p=a(3992),m=a(13266),A=e([p]),g=A.then?(await A)():A;p=g[0];const h=({panelOffset:e,participants:t,participantsCount:a,isLandscape:n})=>{const{loadMoreGroupCallParticipants:s}=(0,o.getActions)(),c=(0,i.Kr)(()=>Object.values(t||{}).sort(f).map(e=>e.id),[t]),A=(0,d.A)(()=>{s()}),[g,h]=(0,l.A)(A,c,c.length>=a);return i.Ay.createElement(u.A,{items:g,onLoadMore:h,style:`transform: translateY(${e}px);`,className:(0,r.A)(m.A.root,!n&&m.A.portrait)},t&&g?.map(e=>t[e]&&i.Ay.createElement(p.A,{key:e,teactOrderKey:c.indexOf(e),participant:t[e]})))};function f(e,t){return(0,c.zV)(!e.isMuted,!t.isMuted)||(0,c.zV)(e.presentation,t.presentation)||(0,c.zV)(e.video,t.video)||(0,c.zV)(e.raiseHandRating,t.raiseHandRating)}const v=(0,i.ph)((0,o.EK)(e=>{const{participantsCount:t,participants:a}=(0,s.iT)(e)||{};return{participants:a,participantsCount:t||0}})(h));n()}catch(y){n(y)}})},90423:(e,t,a)=>{a.d(t,{Ay:()=>r,j9:()=>d,zk:()=>c});var n=a(84051),i=a(31791),o=a(96454);const s=l();function r(e,t,a){const[i,r]=(0,n.J0)(Boolean(s&&document[s]));return(0,n.Nf)(()=>{const n=e.current,i=()=>{const e=Boolean(s&&document[s]);r(e),e?a?.(!1):t?.(!1),n instanceof HTMLVideoElement&&(n.controls=e)},o=()=>{r(!0),a&&a(!0)},c=()=>{r(!1),t&&t(!1)};return document.addEventListener("fullscreenchange",i,!1),document.addEventListener("webkitfullscreenchange",i,!1),document.addEventListener("mozfullscreenchange",i,!1),n&&(n.addEventListener("webkitbeginfullscreen",o,!1),n.addEventListener("webkitendfullscreen",c,!1)),()=>{document.removeEventListener("fullscreenchange",i,!1),document.removeEventListener("webkitfullscreenchange",i,!1),document.removeEventListener("mozfullscreenchange",i,!1),n&&(n.removeEventListener("webkitbeginfullscreen",o,!1),n.removeEventListener("webkitendfullscreen",c,!1))}},[]),s||o.pz?[i,()=>{var t;e.current&&(s||o.pz)&&!i&&((t=e.current).requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.webkitEnterFullscreen?t.webkitEnterFullscreen():t.mozRequestFullScreen&&t.mozRequestFullScreen(),r(!0))},()=>{e.current&&(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen(),r(!1))}]:[!1]}const c=()=>{const[e,t]=(0,n.J0)(!1);return(0,n.vJ)(()=>{const e=()=>{t(d())},a=window.electron?.on(i.v.FULLSCREEN_CHANGE,t);return window.electron?.isFullscreen().then(t),document.addEventListener("fullscreenchange",e,!1),document.addEventListener("webkitfullscreenchange",e,!1),document.addEventListener("mozfullscreenchange",e,!1),()=>{a?.(),document.removeEventListener("fullscreenchange",e,!1),document.removeEventListener("webkitfullscreenchange",e,!1),document.removeEventListener("mozfullscreenchange",e,!1)}},[]),e};function l(){return void 0!==document.fullscreenElement?"fullscreenElement":void 0!==document.mozFullScreenElement?"mozFullScreenElement":void 0!==document.webkitFullscreenElement?"webkitFullscreenElement":""}function d(){const e=l();return Boolean(e&&document[e])}},98522:(e,t,a)=>{a.d(t,{A:()=>d});var n=a(84051),i=a(17712),o=a(73767),s=a(93545);const r=10,c=8,l=240;function d({primaryContainerRef:e,secondaryContainerRef:t,videoParticipants:a,isLandscapeLayout:d,pinnedVideo:u}){const[p,m]=(0,n.J0)([]),[A,g]=(0,n.J0)(0),h=a.length,f=(0,o.A)(h),v=(0,o.A)(a),y=(0,n.Kr)(()=>v?.filter(({id:e,type:t})=>!a.some(a=>a.id===e&&a.type===t)),[v,a]),V=(0,i.A)(()=>{const n=e.current,i=t.current;if(!i)return;const o=void 0!==f&&f>h?f-h:0,{x:s,y:p,width:A}=i.getBoundingClientRect(),v=[];if(void 0!==u||!n||!d){const e=!0;let t,i=!1,f=0,V=a;if(u&&n&&d&&(f=V.findIndex(({id:e,type:t})=>e===u.id&&t===u.type),-1!==f)){const{x:e,y:a,width:o,height:s}=n.getBoundingClientRect(),{id:r,type:c}=u;t={x:e,y:a,width:o,height:s,participantId:r,type:c,orderKey:f},i=!0,V=V.filter(({id:e,type:t})=>e!==r||t!==u.type)}const C=i?h-1:h,b=C%2==1,w=2,E=Math.ceil(C/w),S=(A-(w-1)*r)/w,k=Math.max(0,b?l+(E-1)*S+(E-1)*c:E*S+(E-1)*c);for(let t=0;t<C;t++){const a=b&&0===t,n=a?A:S,i=a?l:S,o=b&&0!==t?t+1:t,d=(e?0:s)+o%w*(n+r),u=(e?0:p)+(b&&0!==t?l+c+(Math.floor(o/w)-1)*(i+c):Math.floor(o/w)*(i+c));v.push({x:d,y:u,width:n,height:i,shouldRemount:!e,isRemounted:e,noAnimate:!0,participantId:V[t].id,type:V[t].type,orderKey:t>=f?t+1:t})}if(t&&v.splice(f,0,t),y)for(let t=0;t<o;t++)v.push({x:0,y:0,width:0,height:0,isRemounted:e,isRemoved:!0,participantId:y[t].id,type:y[t].type,orderKey:t+h});return g(k),void m(v)}const{x:V,y:C,width:b,height:w}=n.getBoundingClientRect(),E=function(e){return e>=25?5:e>=13?4:e>=7?3:e>=3?2:1}(h),S=Math.ceil(h/E),k=S*E>h,I=(b-(E-1)*r)/E,P=(w-(S-1)*c)/S,T=I*(h%E);for(let e=0;e<h;e++){const t=Math.floor(e/E),n=V+e%E*(I+r)+(k&&t===S-1?(b-T)/2:0),i=C+Math.floor(e/E)*(P+c);v.push({x:n,y:i,width:I,height:P,participantId:a[e].id,type:a[e].type,orderKey:e})}if(y)for(let e=0;e<o;e++)v.push({x:0,y:0,width:0,height:0,isRemoved:!0,participantId:y[e].id,type:y[e].type,orderKey:e+h});g(0),m(v)});return(0,n.vJ)(V,[V,a,d,u]),(0,s.A)(e,V,!e.current),(0,s.A)(t,V,!t.current),{videoLayout:p,panelOffset:A}}},99053:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.d(t,{A:()=>T});var i=a(84051),o=a(13439),s=a(31481),r=a(71331),c=a(87357),l=a(58443),d=a(37661),u=a(17712),p=a(59030),m=a(64292),A=a(4438),g=a(285),h=a(71429),f=a(24433),v=e([p,g,f]);function y(){return y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)({}).hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},y.apply(null,arguments)}[p,g,f]=v.then?(await v)():v;const V=[0,17],C=[17,34],b=0,w=50,E=100,S=150,k=500,I=24,P=({participant:e,onCloseAnimationEnd:t,onClose:a,isDropdownOpen:n,isAdmin:r,menuRef:v,...P})=>{const{toggleGroupCallMute:T,setGroupCallParticipantVolume:N,toggleGroupCallPanel:M,openChat:x,requestToSpeak:G}=(0,o.getActions)(),B=(0,p.A)(),[R,U,L]=(0,d.A)(),F=e?.id,{isMutedByMe:D,isMuted:_,isSelf:O,canSelfUnmute:J}=e||{},j=Boolean(e?.raiseHandRating),H=!J&&_,[$,z]=(0,i.J0)(D?b:(e?.volume||s.iRY)/s.CH0),[K,q]=(0,i.J0)(!1),W=$===b,Y=W?V:C;(0,i.vJ)(()=>{n||q(!1)},[n]);const Z=(0,u.A)(e=>{z(e),q(e===b!==W)});(0,i.vJ)(()=>{z(D?b:(e?.volume||s.iRY)/s.CH0)},[F]);const Q=(0,m.A)(k),X=(0,u.A)(e=>{e.stopPropagation(),U(),a()}),ee=(0,u.A)(e=>{e.stopPropagation(),G({value:!1}),a()}),te=(0,u.A)(t=>{t.stopPropagation(),a(),r?H&&Z((e?.volume??s.iRY)/s.CH0):Z(D?s.iRY/s.CH0:b),T({participantId:F,value:r?!H:!D})}),ae=(0,u.A)(e=>{e.stopPropagation(),M(),x({id:F}),a()});return i.Ay.createElement("div",null,i.Ay.createElement(h.A,y({isOpen:n,ref:v,withPortal:!0,onClose:a,onCloseAnimationEnd:t,className:"participant-menu with-menu-transitions"},P),!O&&!H&&i.Ay.createElement("div",{className:"group"},i.Ay.createElement("div",{className:(0,c.A)("volume-control",$<w&&"low",$>=w&&$<E&&"medium",$>=E&&$<S&&"normal",$>=S&&"high")},i.Ay.createElement("input",{type:"range",min:"0",max:"200",value:$,onChange:e=>{const t=Number(e.target.value);Z(t),Q(()=>{t===b?T({participantId:F,value:!0}):N({participantId:F,volume:Math.floor(t*s.CH0)})})}}),i.Ay.createElement("div",{className:"info"},i.Ay.createElement(A.A,{tgsUrl:l.w.Speaker,play:!!K&&Y.toString(),playSegment:Y,size:I}),i.Ay.createElement("span",null,$,"%")))),i.Ay.createElement("div",{className:"group"},j&&O&&i.Ay.createElement(f.A,{icon:"stop-raising-hand",onClick:ee},B("VoipGroupCancelRaiseHand")),!O&&i.Ay.createElement(f.A,{icon:"user",onClick:ae},B("VoipGroupOpenProfile")),!O&&i.Ay.createElement(f.A,{icon:_&&r&&H?"allow-speak":"microphone-alt",onClick:te},B(r?H?"VoipGroupAllowToSpeak":"VoipMute":D?"VoipGroupUnmuteForMe":"VoipGroupMuteForMe")),!O&&r&&i.Ay.createElement(f.A,{icon:"delete-user",destructive:!0,onClick:X},B("VoipGroupUserRemove")))),!O&&r&&i.Ay.createElement(g.A,{isOpen:R,userId:F,onClose:L}))},T=(0,i.ph)((0,o.EK)(e=>({isAdmin:(0,r.qI)(e)}))(P));n()}catch(N){n(N)}})}}]);
//# sourceMappingURL=2394.859f643b0b82365f9d71.js.map