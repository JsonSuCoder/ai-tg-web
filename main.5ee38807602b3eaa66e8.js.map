{"version":3,"file":"main.5ee38807602b3eaa66e8.js","mappings":"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O,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAA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","sources":["webpack://telegram-t/webpack/runtime/create fake namespace object","webpack://telegram-t/webpack/runtime/load script","webpack://telegram-t/./src/hooks/useCurrentOrPrev.ts","webpack://telegram-t/./src/util/searchWords.ts","webpack://telegram-t/./src/hooks/useThrottledCallback.ts","webpack://telegram-t/./src/global/selectors/stories.ts","webpack://telegram-t/./src/util/handleError.ts","webpack://telegram-t/./node_modules/lodash/lodash.js","webpack://telegram-t/./src/components/ui/Portal.ts","webpack://telegram-t/./src/global/helpers/messageSummary.ts","webpack://telegram-t/./src/util/installPrompt.ts","webpack://telegram-t/./src/components/middle/message/helpers/messageActions.tsx","webpack://telegram-t/./src/util/multiaccount.ts","webpack://telegram-t/./src/components/common/AnimatedIcon.tsx","webpack://telegram-t/./src/components/common/helpers/renderText.tsx","webpack://telegram-t/./src/global/actions/apiUpdaters/initial.ts","webpack://telegram-t/./src/global/selectors/tabs.ts","webpack://telegram-t/./src/util/notifications.tsx","webpack://telegram-t/./src/hooks/useSignalEffect.ts","webpack://telegram-t/./src/hooks/useIntersectionObserver.ts","webpack://telegram-t/./src/util/arePropsShallowEqual.ts","webpack://telegram-t/./src/util/element/jsxToHtml.ts","webpack://telegram-t/./src/lib/teact/heavyAnimation.ts","webpack://telegram-t/./src/components/chatAssistant/ai-task/chatai-task.ts","webpack://telegram-t/./src/api/gramjs/worker/connector.ts","webpack://telegram-t/./src/components/common/icons/StarIcon.module.scss?d424","webpack://telegram-t/./src/components/common/icons/StarIcon.tsx","webpack://telegram-t/./src/components/chatAssistant/ai-task/intelligent-reply-task.ts","webpack://telegram-t/./src/util/Deferred.ts","webpack://telegram-t/./src/lib/teact/dom-events.ts","webpack://telegram-t/./src/hooks/useKeyboardListNavigation.ts","webpack://telegram-t/./src/global/actions/ui/settings.ts","webpack://telegram-t/./src/util/username.ts","webpack://telegram-t/./src/util/captureEscKeyListener.ts","webpack://telegram-t/./src/global/index.ts","webpack://telegram-t/./src/util/generateUniqueId.ts","webpack://telegram-t/./src/util/textFormat.ts","webpack://telegram-t/./src/util/establishMultitabRole.ts","webpack://telegram-t/./src/hooks/useUniqueId.ts","webpack://telegram-t/./src/hooks/useEffectOnce.ts","webpack://telegram-t/./src/global/reducers/chats.ts","webpack://telegram-t/./node_modules/toggle-selection/index.js","webpack://telegram-t/./src/hooks/useDebouncedCallback.ts","webpack://telegram-t/./src/util/formatCurrency.tsx","webpack://telegram-t/./src/util/emoji/parseEmojiOnlyString.ts","webpack://telegram-t/./src/util/dates/dateFormat.ts","webpack://telegram-t/./src/hooks/useLastCallback.ts","webpack://telegram-t/./src/global/reducers/symbols.ts","webpack://telegram-t/./src/global/reducers/users.ts","webpack://telegram-t/./src/global/reducers/globalSearch.ts","webpack://telegram-t/./src/global/reducers/management.ts","webpack://telegram-t/./src/global/reducers/settings.ts","webpack://telegram-t/./src/global/reducers/sharedState.ts","webpack://telegram-t/./src/global/reducers/twoFaSettings.ts","webpack://telegram-t/./src/global/reducers/passcode.ts","webpack://telegram-t/./src/global/reducers/payments.ts","webpack://telegram-t/./src/global/reducers/statistics.ts","webpack://telegram-t/./src/global/reducers/peers.ts","webpack://telegram-t/./src/global/reducers/stories.ts","webpack://telegram-t/./src/global/reducers/topics.ts","webpack://telegram-t/./node_modules/copy-to-clipboard/index.js","webpack://telegram-t/./src/components/common/AnimatedSticker.tsx","webpack://telegram-t/./src/components/common/icons/Icon.tsx","webpack://telegram-t/./src/components/common/Blockquote.module.scss?d7ef","webpack://telegram-t/./src/components/common/Blockquote.tsx","webpack://telegram-t/./src/util/prettyCodeLanguageNames.ts","webpack://telegram-t/./src/components/common/code/CodeOverlay.module.scss?733a","webpack://telegram-t/./src/components/common/code/CodeOverlay.tsx","webpack://telegram-t/./src/components/common/code/CodeBlock.tsx","webpack://telegram-t/./src/components/common/spoiler/Spoiler.tsx","webpack://telegram-t/./src/components/common/helpers/renderTextWithEntities.tsx","webpack://telegram-t/./src/components/common/MessageSummary.tsx","webpack://telegram-t/./src/hooks/useDerivedState.ts","webpack://telegram-t/./src/util/withCache.ts","webpack://telegram-t/./src/global/selectors/messages.ts","webpack://telegram-t/./src/util/permanentWebVersion.ts","webpack://telegram-t/./src/components/ui/Checkbox.tsx","webpack://telegram-t/./src/util/animation.ts","webpack://telegram-t/./src/global/selectors/users.ts","webpack://telegram-t/./src/global/helpers/bots.ts","webpack://telegram-t/./src/global/initialState.ts","webpack://telegram-t/./src/components/chatAssistant/store/chatai-store.ts","webpack://telegram-t/./src/components/chatAssistant/store/chatai-summary-template-store.ts","webpack://telegram-t/./src/components/chatAssistant/store/ai-chatfolders-store.ts","webpack://telegram-t/./src/components/chatAssistant/store/contact-store.ts","webpack://telegram-t/./src/components/chatAssistant/store/folder-store.ts","webpack://telegram-t/./src/components/chatAssistant/store/knowledge-store.ts","webpack://telegram-t/./src/components/chatAssistant/store/urgent-topic-store.ts","webpack://telegram-t/./src/components/chatAssistant/store/user-store.ts","webpack://telegram-t/./src/components/chatAssistant/store/index.ts","webpack://telegram-t/./src/global/selectors/chats.ts","webpack://telegram-t/./src/util/dates/units.ts","webpack://telegram-t/./src/hooks/useSyncEffectWithPrevDeps.ts","webpack://telegram-t/./src/hooks/useShowTransition.ts","webpack://telegram-t/./src/util/perfomanceSettings.ts","webpack://telegram-t/./src/util/signals.ts","webpack://telegram-t/./src/components/chatAssistant/store/summary-store.ts","webpack://telegram-t/./src/components/ui/DropdownMenu.tsx","webpack://telegram-t/./src/hooks/useVirtualBackdrop.ts","webpack://telegram-t/./src/hooks/useThumbnail.ts","webpack://telegram-t/./src/util/areDeepEqual.ts","webpack://telegram-t/./src/util/emoji/fixNonStandardEmoji.ts","webpack://telegram-t/./src/components/ui/MenuItem.tsx","webpack://telegram-t/./src/global/helpers/middleSearch.ts","webpack://telegram-t/./src/util/imageResize.ts","webpack://telegram-t/./node_modules/uuid/dist/esm-browser/native.js","webpack://telegram-t/./node_modules/uuid/dist/esm-browser/rng.js","webpack://telegram-t/./node_modules/uuid/dist/esm-browser/stringify.js","webpack://telegram-t/./node_modules/uuid/dist/esm-browser/v4.js","webpack://telegram-t/./src/components/chatAssistant/ai-task/ai-chatfolders-task.ts","webpack://telegram-t/./src/util/cssAnimationEndListeners.ts","webpack://telegram-t/./src/hooks/useHistoryBack.ts","webpack://telegram-t/./src/util/appBadge.ts","webpack://telegram-t/./src/global/helpers/replies.ts","webpack://telegram-t/./src/global/actions/api/settings.ts","webpack://telegram-t/./src/global/helpers/notifications.ts","webpack://telegram-t/./src/util/svgController.ts","webpack://telegram-t/./src/global/selectors/management.ts","webpack://telegram-t/./src/global/selectors/statistics.ts","webpack://telegram-t/./src/global/selectors/ui.ts","webpack://telegram-t/./src/global/selectors/globalSearch.ts","webpack://telegram-t/./src/global/selectors/payments.ts","webpack://telegram-t/./src/global/selectors/settings.ts","webpack://telegram-t/./src/global/selectors/symbols.ts","webpack://telegram-t/./src/global/selectors/sharedState.ts","webpack://telegram-t/./src/hooks/useForceUpdate.ts","webpack://telegram-t/./src/config.ts","webpack://telegram-t/./src/hooks/schedulers/useInterval.ts","webpack://telegram-t/./src/global/reducers/tabs.ts","webpack://telegram-t/./src/util/requestActionTimeout.ts","webpack://telegram-t/./src/util/deepMerge.ts","webpack://telegram-t/./src/hooks/usePriorityPlaybackCheck.ts","webpack://telegram-t/./src/components/common/helpers/peerColor.ts","webpack://telegram-t/./src/hooks/useSyncEffect.ts","webpack://telegram-t/./src/api/types/media.ts","webpack://telegram-t/./src/hooks/stickers/useColorFilter.tsx","webpack://telegram-t/./src/hooks/useFlag.ts","webpack://telegram-t/./src/components/chatAssistant/store/general-store.ts","webpack://telegram-t/./src/util/schedulers.ts","webpack://telegram-t/./src/lib/teact/teactn.tsx","webpack://telegram-t/./src/hooks/useMediaTransition.ts","webpack://telegram-t/./src/hooks/window/useDevicePixelRatio.ts","webpack://telegram-t/./src/hooks/useLang.ts","webpack://telegram-t/./src/hooks/window/useWindowSize.ts","webpack://telegram-t/./src/util/browser/unloadVideo.ts","webpack://telegram-t/./src/components/common/embedded/EmojiIconBackground.module.scss?aa76","webpack://telegram-t/./src/components/common/embedded/EmojiIconBackground.tsx","webpack://telegram-t/./src/components/ui/InputText.tsx","webpack://telegram-t/./src/components/chatAssistant/variables.ts","webpack://telegram-t/./src/components/ui/Transition.tsx","webpack://telegram-t/./src/hooks/useStateRef.ts","webpack://telegram-t/./src/util/forceReflow.ts","webpack://telegram-t/./src/util/safePlay.ts","webpack://telegram-t/./src/global/cache.ts","webpack://telegram-t/./src/components/ui/RippleEffect.tsx","webpack://telegram-t/./src/util/data/readStrings.ts","webpack://telegram-t/./src/util/data/readFallbackStrings.ts","webpack://telegram-t/./src/assets/localization/initialStrings.ts","webpack://telegram-t/./src/util/localization/index.ts","webpack://telegram-t/./src/util/browser/intlListFormat.ts","webpack://telegram-t/./src/util/math.ts","webpack://telegram-t/./src/util/windowSize.ts","webpack://telegram-t/./src/hooks/useAppLayout.ts","webpack://telegram-t/./src/global/selectors/peers.ts","webpack://telegram-t/./src/util/deepLinkParser.ts","webpack://telegram-t/./src/util/callbacks.ts","webpack://telegram-t/./src/hooks/useSharedIntersectionObserver.ts","webpack://telegram-t/./src/hooks/useEnsureCustomEmoji.ts","webpack://telegram-t/./src/components/common/hooks/useCustomEmoji.ts","webpack://telegram-t/./src/global/actions/api/initial.ts","webpack://telegram-t/./src/util/localization/format.tsx","webpack://telegram-t/./src/util/colors.ts","webpack://telegram-t/./src/util/folderManager.ts","webpack://telegram-t/./src/util/safeExec.ts","webpack://telegram-t/./src/util/captureEvents.ts","webpack://telegram-t/./src/util/lethargy.ts","webpack://telegram-t/./src/hooks/useShowTransitionDeprecated.ts","webpack://telegram-t/./src/components/middle/message/ActionMessage.module.scss?5fb2","webpack://telegram-t/./src/components/chatAssistant/ai-chatfolders/tag-filter.ts","webpack://telegram-t/./src/util/emoji/emoji.ts","webpack://telegram-t/./src/util/captureKeyboardListeners.ts","webpack://telegram-t/./src/components/chatAssistant/utils/analytics.ts","webpack://telegram-t/./src/components/ui/Loading.tsx","webpack://telegram-t/./src/components/middle/helpers/preventMessageInputBlur.ts","webpack://telegram-t/./src/util/deeplink.ts","webpack://telegram-t/./src/global/shared/sharedStateConnector.ts","webpack://telegram-t/./src/util/swipeController.ts","webpack://telegram-t/./src/components/middle/message/MentionLink.tsx","webpack://telegram-t/./src/hooks/useAsync.ts","webpack://telegram-t/./src/util/keys/searchResultKey.ts","webpack://telegram-t/./src/components/chatAssistant/globalSummary/global-summary-badge.ts","webpack://telegram-t/./src/components/ui/Spinner.tsx","webpack://telegram-t/./src/hooks/element/useCollapsibleLines.ts","webpack://telegram-t/./src/util/sessions.ts","webpack://telegram-t/./src/util/oggToWav.ts","webpack://telegram-t/./src/util/mediaLoader.ts","webpack://telegram-t/./src/components/middle/composer/helpers/customEmoji.ts","webpack://telegram-t/./src/util/trimText.ts","webpack://telegram-t/./src/hooks/useOldLang.ts","webpack://telegram-t/./src/util/browser/multitab.ts","webpack://telegram-t/./src/util/themeStyle.ts","webpack://telegram-t/./src/components/chatAssistant/ai-task/global-summary-task.ts","webpack://telegram-t/./src/util/oldLangProvider.ts","webpack://telegram-t/./node_modules/idb/build/index.js","webpack://telegram-t/./src/components/chatAssistant/vector-storage/common/helpers.ts","webpack://telegram-t/./src/components/chatAssistant/vector-storage/VectorStorage.ts","webpack://telegram-t/./src/components/chatAssistant/vector-storage/common/constants.ts","webpack://telegram-t/./src/components/chatAssistant/vector-store.ts","webpack://telegram-t/./src/util/emoji/customEmojiManager.ts","webpack://telegram-t/./src/util/keys/messageKey.ts","webpack://telegram-t/./src/hooks/window/useBackgroundMode.ts","webpack://telegram-t/./src/util/debugConsole.ts","webpack://telegram-t/./src/lib/teact/teact-dom.ts","webpack://telegram-t/./src/global/helpers/chats.ts","webpack://telegram-t/./src/hooks/useMedia.ts","webpack://telegram-t/./src/util/browser/globalEnvironment.ts","webpack://telegram-t/./src/hooks/data/useSelector.ts","webpack://telegram-t/./src/components/ui/Button.tsx","webpack://telegram-t/./src/util/phoneNumber.ts","webpack://telegram-t/./src/components/middle/message/hooks/useVideoAutoPause.ts","webpack://telegram-t/./src/components/ui/OptimizedVideo.tsx","webpack://telegram-t/./src/util/routing.ts","webpack://telegram-t/./src/lib/fasterdom/fasterdom.ts","webpack://telegram-t/./src/components/chatAssistant/utils/fetch-messages.ts","webpack://telegram-t/./src/hooks/animations/useViewTransition.ts","webpack://telegram-t/./src/global/reducers/middleSearch.ts","webpack://telegram-t/./src/global/helpers/peers.ts","webpack://telegram-t/./node_modules/idb-keyval/dist/index.js","webpack://telegram-t/./src/util/browser/idb.ts","webpack://telegram-t/./src/util/dates/timestamp.ts","webpack://telegram-t/./src/util/passcode.ts","webpack://telegram-t/./src/util/switchTheme.ts","webpack://telegram-t/./src/hooks/useMenuPosition.ts","webpack://telegram-t/./src/components/ui/Menu.tsx","webpack://telegram-t/./src/hooks/useBuffering.ts","webpack://telegram-t/./src/components/chatAssistant/lib/EventEmitter.ts","webpack://telegram-t/./src/hooks/useVideoCleanup.ts","webpack://telegram-t/./src/hooks/usePreviousDeprecated.ts","webpack://telegram-t/./src/util/theme.ts","webpack://telegram-t/./src/util/cacheApi.ts","webpack://telegram-t/./src/components/common/MessageText.tsx","webpack://telegram-t/./src/lib/fasterdom/layoutCauses.ts","webpack://telegram-t/./src/lib/fasterdom/stricterdom.ts","webpack://telegram-t/./src/components/common/helpers/mediaDimensions.ts","webpack://telegram-t/./src/components/common/TopicDefaultIcon.module.scss?06b0","webpack://telegram-t/./src/components/common/TopicDefaultIcon.tsx","webpack://telegram-t/./src/global/helpers/messageMedia.ts","webpack://telegram-t/./src/hooks/useElectronDrag.ts","webpack://telegram-t/./src/components/common/helpers/animatedAssets.ts","webpack://telegram-t/./src/global/helpers/symbols.ts","webpack://telegram-t/./src/global/helpers/users.ts","webpack://telegram-t/./src/util/memo.ts","webpack://telegram-t/./src/util/moduleLoader.ts","webpack://telegram-t/./src/util/serverTime.ts","webpack://telegram-t/./src/hooks/useModuleLoader.ts","webpack://telegram-t/./src/util/patchSafariProgressiveAudio.ts","webpack://telegram-t/./src/components/chatAssistant/prompt.ts","webpack://telegram-t/./src/hooks/useEffectWithPrevDeps.ts","webpack://telegram-t/./src/global/helpers/getEmojiOnlyCountForMessage.ts","webpack://telegram-t/./src/global/reducers/messages.ts","webpack://telegram-t/./src/components/common/StickerView.module.scss?7ce5","webpack://telegram-t/./src/components/common/StickerView.tsx","webpack://telegram-t/./src/hooks/useMountAfterHeavyAnimation.ts","webpack://telegram-t/./src/hooks/useMediaTransitionDeprecated.ts","webpack://telegram-t/./src/hooks/useDerivedSignal.ts","webpack://telegram-t/./src/util/localization/types.ts","webpack://telegram-t/./src/util/stopEvent.ts","webpack://telegram-t/./src/util/debugOverlay.ts","webpack://telegram-t/./src/lib/teact/teact.ts","webpack://telegram-t/./src/hooks/useHeavyAnimation.ts","webpack://telegram-t/./src/util/systemTheme.ts","webpack://telegram-t/./src/api/types/messages.ts","webpack://telegram-t/./src/util/websync.ts","webpack://telegram-t/./src/components/common/SafeLink.tsx","webpack://telegram-t/./src/util/primitives/LimitedMap.ts","webpack://telegram-t/./src/components/common/Sparkles.module.scss?15c2","webpack://telegram-t/./src/components/common/Sparkles.tsx","webpack://telegram-t/./src/util/clipboard.ts","webpack://telegram-t/./src/components/common/PeerColorWrapper.tsx","webpack://telegram-t/./src/components/common/PeerColorWrapper.module.scss?b340","webpack://telegram-t/./src/global/helpers/messages.ts","webpack://telegram-t/./src/hooks/element/useStyleObserver.ts","webpack://telegram-t/./src/hooks/stickers/useDynamicColorListener.ts","webpack://telegram-t/./src/util/buildClassName.ts","webpack://telegram-t/./src/components/common/CustomEmoji.tsx","webpack://telegram-t/./src/components/common/CustomEmoji.module.scss?8f5a","webpack://telegram-t/./src/util/files.ts","webpack://telegram-t/./src/util/iteratees.ts","webpack://telegram-t/./src/global/selectors/topics.ts","webpack://telegram-t/./src/lib/rlottie/RLottie.async.ts","webpack://telegram-t/./src/global/actions/ui/initial.ts","webpack://telegram-t/./src/types/index.ts","webpack://telegram-t/./src/util/forumColors.ts","webpack://telegram-t/./src/global/helpers/reactions.ts","webpack://telegram-t/./src/global/helpers/media.ts","webpack://telegram-t/./src/global/helpers/misc.ts","webpack://telegram-t/./src/components/common/helpers/documentInfo.ts","webpack://telegram-t/./src/util/element/calcTextLineHeightAndCount.ts","webpack://telegram-t/./src/hooks/useResizeObserver.ts","webpack://telegram-t/./src/lib/punycode.js","webpack://telegram-t/./src/util/browser/url.ts","webpack://telegram-t/./src/hooks/useMultiaccountInfo.ts","webpack://telegram-t/./src/global/selectors/middleSearch.ts","webpack://telegram-t/./src/hooks/useCoordsInSharedCanvas.ts","webpack://telegram-t/./src/util/deepDiff.ts","webpack://telegram-t/./src/global/reducers/translations.ts","webpack://telegram-t/./src/util/buildStyle.ts","webpack://telegram-t/./src/components/chatAssistant/store/messages-store.ts","webpack://telegram-t/./src/components/chatAssistant/ai-chatfolders/util.ts","webpack://telegram-t/./src/util/browser/windowEnvironment.ts","webpack://telegram-t/./src/components/ui/Link.module.scss?2387","webpack://telegram-t/./src/components/ui/Link.tsx","webpack://telegram-t/./src/util/localization/utils.ts","webpack://telegram-t/./src/components/middle/message/ActionMessageText.tsx","webpack://telegram-t/./src/components/chatAssistant/ai-task/urgent-check-task.ts","webpack://telegram-t/./src/lib/twemojiRegex.js","webpack://telegram-t/./src/hooks/data/useSelectorSignal.ts","webpack://telegram-t/./src/util/replaceWithTeact.ts","webpack://telegram-t/./src/util/getReadableErrorText.ts","webpack://telegram-t/webpack/bootstrap","webpack://telegram-t/webpack/runtime/compat get default export","webpack://telegram-t/webpack/runtime/define property getters","webpack://telegram-t/webpack/runtime/ensure chunk","webpack://telegram-t/webpack/runtime/get javascript chunk filename","webpack://telegram-t/webpack/runtime/get mini-css chunk filename","webpack://telegram-t/webpack/runtime/global","webpack://telegram-t/webpack/runtime/hasOwnProperty shorthand","webpack://telegram-t/webpack/runtime/make namespace object","webpack://telegram-t/webpack/runtime/node module decorator","webpack://telegram-t/webpack/runtime/publicPath","webpack://telegram-t/webpack/runtime/css loading","webpack://telegram-t/webpack/runtime/jsonp chunk loading","webpack://telegram-t/webpack/runtime/nonce","webpack://telegram-t/./src/util/setupServiceWorker.ts","webpack://telegram-t/./src/global/intervals.ts","webpack://telegram-t/./src/util/init.ts","webpack://telegram-t/./src/global/init.ts","webpack://telegram-t/./src/util/betterView.ts","webpack://telegram-t/./src/components/auth/AuthCode.async.tsx","webpack://telegram-t/./src/components/auth/AuthPassword.async.tsx","webpack://telegram-t/./src/util/fonts.ts","webpack://telegram-t/./src/components/auth/helpers/backNavigation.ts","webpack://telegram-t/./src/components/auth/helpers/getSuggestedLanguage.ts","webpack://telegram-t/./src/hooks/useLangString.ts","webpack://telegram-t/./src/components/auth/CountryCodeInput.tsx","webpack://telegram-t/./src/components/auth/AuthPhoneNumber.tsx","webpack://telegram-t/./src/components/auth/AuthQrCode.tsx","webpack://telegram-t/./src/components/auth/AuthRegister.async.tsx","webpack://telegram-t/./src/components/auth/Auth.tsx","webpack://telegram-t/./src/components/App.module.scss?a9d3","webpack://telegram-t/./src/components/common/UiLoader.module.scss?03f6","webpack://telegram-t/./src/components/common/UiLoader.tsx","webpack://telegram-t/./src/components/main/AppInactive.tsx","webpack://telegram-t/./src/components/main/LockScreen.async.tsx","webpack://telegram-t/./src/components/main/Main.async.tsx","webpack://telegram-t/./src/components/App.tsx","webpack://telegram-t/./src/index.tsx","webpack://telegram-t/./src/components/chatAssistant/utils/init.ts","webpack://telegram-t/./src/util/updateWebmanifest.ts"],"sourcesContent":["var getProto = Object.getPrototypeOf ? (obj) => (Object.getPrototypeOf(obj)) : (obj) => (obj.__proto__);\nvar leafPrototypes;\n// create a fake namespace object\n// mode & 1: value is a module id, require it\n// mode & 2: merge all properties of value into the ns\n// mode & 4: return value when already ns object\n// mode & 16: return value when it's Promise-like\n// mode & 8|1: behave like require\n__webpack_require__.t = function(value, mode) {\n\tif(mode & 1) value = this(value);\n\tif(mode & 8) return value;\n\tif(typeof value === 'object' && value) {\n\t\tif((mode & 4) && value.__esModule) return value;\n\t\tif((mode & 16) && typeof value.then === 'function') return value;\n\t}\n\tvar ns = Object.create(null);\n\t__webpack_require__.r(ns);\n\tvar def = {};\n\tleafPrototypes = leafPrototypes || [null, getProto({}), getProto([]), getProto(getProto)];\n\tfor(var current = mode & 2 && value; typeof current == 'object' && !~leafPrototypes.indexOf(current); current = getProto(current)) {\n\t\tObject.getOwnPropertyNames(current).forEach((key) => (def[key] = () => (value[key])));\n\t}\n\tdef['default'] = () => (value);\n\t__webpack_require__.d(ns, def);\n\treturn ns;\n};","var inProgress = {};\nvar dataWebpackPrefix = \"telegram-t:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = (url, done, key, chunkId) => {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = (prev, event) => {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach((fn) => (fn(event)));\n\t\tif(prev) return prev(event);\n\t}\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","import usePreviousDeprecated from './usePreviousDeprecated';\n\nexport default function useCurrentOrPrev<T extends any>(\n  current: T, shouldSkipUndefined = false, shouldForceCurrent = false,\n): T | undefined {\n  const prev = usePreviousDeprecated(current, shouldSkipUndefined);\n\n  // eslint-disable-next-line no-null/no-null\n  return shouldForceCurrent || (current !== null && current !== undefined) ? current : prev;\n}\n","let RE_NOT_LETTER: RegExp;\n\ntry {\n  RE_NOT_LETTER = /[^\\p{L}\\p{M}]+/ui;\n} catch (e) {\n  // Support for older versions of firefox\n  RE_NOT_LETTER = /[^\\wа-яёґєії]+/i;\n}\n\nexport default function searchWords(haystack: string, needle: string | string[]) {\n  if (!haystack || !needle) {\n    return false;\n  }\n\n  const needleWords = typeof needle === 'string' ? needle.toLowerCase().split(RE_NOT_LETTER) : needle;\n  const haystackLower = haystack.toLowerCase();\n\n  // @optimization\n  if (needleWords.length === 1 && !haystackLower.includes(needleWords[0])) {\n    return false;\n  }\n\n  let haystackWords: string[];\n\n  return needleWords.every((needleWord) => {\n    if (!haystackLower.includes(needleWord)) {\n      return false;\n    }\n\n    if (!haystackWords) {\n      haystackWords = haystackLower.split(RE_NOT_LETTER);\n    }\n\n    return haystackWords.some((haystackWord) => haystackWord.startsWith(needleWord));\n  });\n}\n\nexport function prepareSearchWordsForNeedle(needle: string) {\n  const needleWords = needle.toLowerCase().split(RE_NOT_LETTER);\n\n  return (haystack: string) => searchWords(haystack, needleWords);\n}\n","import { useCallback, useMemo } from '../lib/teact/teact';\n\nimport type { Scheduler } from '../util/schedulers';\n\nimport { throttle, throttleWith } from '../util/schedulers';\n\nexport default function useThrottledCallback<T extends AnyToVoidFunction>(\n  fn: T,\n  deps: any[],\n  msOrSchedulerFn: number | Scheduler,\n  noFirst = false,\n) {\n  // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  const fnMemo = useCallback(fn, deps);\n\n  return useMemo(() => {\n    if (typeof msOrSchedulerFn === 'number') {\n      return throttle(fnMemo, msOrSchedulerFn, !noFirst);\n    } else {\n      return throttleWith(msOrSchedulerFn, fnMemo);\n    }\n  }, [fnMemo, msOrSchedulerFn, noFirst]);\n}\n","import type { ApiPeerStories, ApiTypeStory } from '../../api/types';\nimport type { GlobalState, TabArgs } from '../types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { selectPeer } from './peers';\nimport { selectTabState } from './tabs';\n\nexport function selectCurrentViewedStory<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { storyViewer: { peerId, storyId } } = selectTabState(global, tabId);\n\n  return { peerId, storyId };\n}\n\nexport function selectIsStoryViewerOpen<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { peerId, storyId } = selectCurrentViewedStory(global, tabId);\n\n  return Boolean(peerId) && Boolean(storyId);\n}\n\nexport function selectPeerStories<T extends GlobalState>(\n  global: T, peerId: string,\n): ApiPeerStories | undefined {\n  return global.stories.byPeerId[peerId];\n}\n\nexport function selectPeerStory<T extends GlobalState>(\n  global: T, peerId: string, storyId: number,\n): ApiTypeStory | undefined {\n  return selectPeerStories(global, peerId)?.byId[storyId];\n}\n\nexport function selectPinnedStories<T extends GlobalState>(\n  global: T, peerId: string,\n) {\n  const stories = selectPeerStories(global, peerId);\n  if (!stories?.pinnedIds?.length) return undefined;\n  return stories.pinnedIds.map((id) => stories.byId[id]).filter((s) => (\n    s && 'isInProfile' in s && s.isInProfile\n  ));\n}\n\nexport function selectPeerFirstUnreadStoryId<T extends GlobalState>(\n  global: T, peerId: string,\n) {\n  const peerStories = selectPeerStories(global, peerId);\n  if (!peerStories) {\n    return undefined;\n  }\n\n  if (!peerStories.lastReadId) {\n    return peerStories.orderedIds?.[0];\n  }\n\n  const lastReadIndex = peerStories.orderedIds.findIndex((id) => id === peerStories.lastReadId);\n\n  return peerStories.orderedIds?.[lastReadIndex + 1];\n}\n\nexport function selectPeerFirstStoryId<T extends GlobalState>(\n  global: T, peerId: string,\n) {\n  return selectPeerStories(global, peerId)?.orderedIds?.[0];\n}\n\nexport function selectStoryListForViewer<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  storyId?: number,\n  isSingleStory?: boolean,\n  isSinglePeer?: boolean,\n  isPrivate?: boolean,\n  isArchive?: boolean,\n): {\n    peerIds: string[];\n    storyIdsByPeerId: Record<string, number[]>;\n  } | undefined {\n  const currentStoryId = storyId\n    || selectPeerFirstUnreadStoryId(global, peerId)\n    || selectPeerFirstStoryId(global, peerId);\n  if (!currentStoryId) {\n    return undefined;\n  }\n\n  if (isSingleStory) {\n    return {\n      peerIds: [peerId],\n      storyIdsByPeerId: { [peerId]: [currentStoryId] },\n    };\n  }\n\n  const peer = selectPeer(global, peerId);\n  const story = selectPeerStory(global, peerId, currentStoryId);\n  if (!peer || !story) {\n    return undefined;\n  }\n\n  const isUnread = (global.stories.byPeerId[peerId].lastReadId || 0) < story.id;\n\n  if (isSinglePeer) {\n    const storyIds = getPeerStoryIdsForViewer(global, peerId, isUnread, isArchive, isPrivate);\n\n    return storyIds?.length\n      ? { peerIds: [peerId], storyIdsByPeerId: { [peerId]: storyIds } }\n      : undefined;\n  }\n\n  const { orderedPeerIds: { active, archived } } = global.stories;\n  const orderedPeerIds = (peer.areStoriesHidden ? archived : active) ?? [];\n  const peerIds: string[] = [];\n  const storyIdsByPeerId: Record<string, number[]> = {};\n\n  for (const currentPeerId of orderedPeerIds) {\n    const storyIds = getPeerStoryIdsForViewer(global, currentPeerId, isUnread, isArchive, isPrivate);\n    if (storyIds?.length) {\n      peerIds.push(currentPeerId);\n      storyIdsByPeerId[currentPeerId] = storyIds;\n    }\n  }\n\n  return peerIds.length ? { peerIds, storyIdsByPeerId } : undefined;\n}\n\nfunction getPeerStoryIdsForViewer<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  isUnread?: boolean,\n  isArchive?: boolean,\n  isPrivate?: boolean,\n): number[] | undefined {\n  const peerStories = selectPeerStories(global, peerId);\n  const storySourceProp = isArchive ? 'archiveIds' : isPrivate ? 'profileIds' : 'orderedIds';\n  const storyIds = peerStories?.[storySourceProp];\n\n  if (!peerStories || !storyIds?.length) {\n    return undefined;\n  }\n\n  if (!peerStories.lastReadId || !isUnread) {\n    return storyIds.slice();\n  }\n\n  const lastReadIndex = storyIds.indexOf(peerStories.lastReadId);\n  return (storyIds.length > lastReadIndex + 1)\n    ? storyIds.slice(lastReadIndex + 1)\n    : undefined;\n}\n","import { DEBUG, DEBUG_ALERT_MSG } from '../config';\nimport { isCurrentTabMaster } from './establishMultitabRole';\nimport { throttle } from './schedulers';\n\nlet showError = true;\nlet error: Error | undefined;\n\nwindow.addEventListener('error', handleErrorEvent);\nwindow.addEventListener('unhandledrejection', handleErrorEvent);\n\nif (DEBUG) {\n  window.addEventListener('focus', () => {\n    if (!isCurrentTabMaster()) {\n      return;\n    }\n    showError = true;\n    if (error) {\n      // eslint-disable-next-line no-alert\n      window.alert(getErrorMessage(error));\n      error = undefined;\n    }\n  });\n  window.addEventListener('blur', () => {\n    if (!isCurrentTabMaster()) {\n      return;\n    }\n    showError = false;\n  });\n}\n\nconst throttleError = throttle((err) => {\n  if (showError) {\n    // eslint-disable-next-line no-alert\n    window.alert(getErrorMessage(err));\n  } else {\n    error = err;\n  }\n}, 1500);\n\nexport function handleError(err: Error) {\n  // eslint-disable-next-line no-console\n  console.error(err);\n  if (DEBUG) {\n    throttleError(err);\n  }\n}\n\nfunction handleErrorEvent(e: ErrorEvent | PromiseRejectionEvent) {\n  // https://stackoverflow.com/questions/49384120/resizeobserver-loop-limit-exceeded\n  if (e instanceof ErrorEvent && e.message === 'ResizeObserver loop limit exceeded') {\n    return;\n  }\n\n  e.preventDefault();\n  handleError(e instanceof ErrorEvent ? (e.error || e.message) : e.reason);\n}\n\nfunction getErrorMessage(err: Error) {\n  return `${DEBUG_ALERT_MSG}\\n\\n${(err?.message) || err}\\n${err?.stack}`;\n}\n","/**\n * @license\n * Lodash <https://lodash.com/>\n * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n;(function() {\n\n  /** Used as a safe reference for `undefined` in pre-ES5 environments. */\n  var undefined;\n\n  /** Used as the semantic version number. */\n  var VERSION = '4.17.21';\n\n  /** Used as the size to enable large array optimizations. */\n  var LARGE_ARRAY_SIZE = 200;\n\n  /** Error message constants. */\n  var CORE_ERROR_TEXT = 'Unsupported core-js use. Try https://npms.io/search?q=ponyfill.',\n      FUNC_ERROR_TEXT = 'Expected a function',\n      INVALID_TEMPL_VAR_ERROR_TEXT = 'Invalid `variable` option passed into `_.template`';\n\n  /** Used to stand-in for `undefined` hash values. */\n  var HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n  /** Used as the maximum memoize cache size. */\n  var MAX_MEMOIZE_SIZE = 500;\n\n  /** Used as the internal argument placeholder. */\n  var PLACEHOLDER = '__lodash_placeholder__';\n\n  /** Used to compose bitmasks for cloning. */\n  var CLONE_DEEP_FLAG = 1,\n      CLONE_FLAT_FLAG = 2,\n      CLONE_SYMBOLS_FLAG = 4;\n\n  /** Used to compose bitmasks for value comparisons. */\n  var COMPARE_PARTIAL_FLAG = 1,\n      COMPARE_UNORDERED_FLAG = 2;\n\n  /** Used to compose bitmasks for function metadata. */\n  var WRAP_BIND_FLAG = 1,\n      WRAP_BIND_KEY_FLAG = 2,\n      WRAP_CURRY_BOUND_FLAG = 4,\n      WRAP_CURRY_FLAG = 8,\n      WRAP_CURRY_RIGHT_FLAG = 16,\n      WRAP_PARTIAL_FLAG = 32,\n      WRAP_PARTIAL_RIGHT_FLAG = 64,\n      WRAP_ARY_FLAG = 128,\n      WRAP_REARG_FLAG = 256,\n      WRAP_FLIP_FLAG = 512;\n\n  /** Used as default options for `_.truncate`. */\n  var DEFAULT_TRUNC_LENGTH = 30,\n      DEFAULT_TRUNC_OMISSION = '...';\n\n  /** Used to detect hot functions by number of calls within a span of milliseconds. */\n  var HOT_COUNT = 800,\n      HOT_SPAN = 16;\n\n  /** Used to indicate the type of lazy iteratees. */\n  var LAZY_FILTER_FLAG = 1,\n      LAZY_MAP_FLAG = 2,\n      LAZY_WHILE_FLAG = 3;\n\n  /** Used as references for various `Number` constants. */\n  var INFINITY = 1 / 0,\n      MAX_SAFE_INTEGER = 9007199254740991,\n      MAX_INTEGER = 1.7976931348623157e+308,\n      NAN = 0 / 0;\n\n  /** Used as references for the maximum length and index of an array. */\n  var MAX_ARRAY_LENGTH = 4294967295,\n      MAX_ARRAY_INDEX = MAX_ARRAY_LENGTH - 1,\n      HALF_MAX_ARRAY_LENGTH = MAX_ARRAY_LENGTH >>> 1;\n\n  /** Used to associate wrap methods with their bit flags. */\n  var wrapFlags = [\n    ['ary', WRAP_ARY_FLAG],\n    ['bind', WRAP_BIND_FLAG],\n    ['bindKey', WRAP_BIND_KEY_FLAG],\n    ['curry', WRAP_CURRY_FLAG],\n    ['curryRight', WRAP_CURRY_RIGHT_FLAG],\n    ['flip', WRAP_FLIP_FLAG],\n    ['partial', WRAP_PARTIAL_FLAG],\n    ['partialRight', WRAP_PARTIAL_RIGHT_FLAG],\n    ['rearg', WRAP_REARG_FLAG]\n  ];\n\n  /** `Object#toString` result references. */\n  var argsTag = '[object Arguments]',\n      arrayTag = '[object Array]',\n      asyncTag = '[object AsyncFunction]',\n      boolTag = '[object Boolean]',\n      dateTag = '[object Date]',\n      domExcTag = '[object DOMException]',\n      errorTag = '[object Error]',\n      funcTag = '[object Function]',\n      genTag = '[object GeneratorFunction]',\n      mapTag = '[object Map]',\n      numberTag = '[object Number]',\n      nullTag = '[object Null]',\n      objectTag = '[object Object]',\n      promiseTag = '[object Promise]',\n      proxyTag = '[object Proxy]',\n      regexpTag = '[object RegExp]',\n      setTag = '[object Set]',\n      stringTag = '[object String]',\n      symbolTag = '[object Symbol]',\n      undefinedTag = '[object Undefined]',\n      weakMapTag = '[object WeakMap]',\n      weakSetTag = '[object WeakSet]';\n\n  var arrayBufferTag = '[object ArrayBuffer]',\n      dataViewTag = '[object DataView]',\n      float32Tag = '[object Float32Array]',\n      float64Tag = '[object Float64Array]',\n      int8Tag = '[object Int8Array]',\n      int16Tag = '[object Int16Array]',\n      int32Tag = '[object Int32Array]',\n      uint8Tag = '[object Uint8Array]',\n      uint8ClampedTag = '[object Uint8ClampedArray]',\n      uint16Tag = '[object Uint16Array]',\n      uint32Tag = '[object Uint32Array]';\n\n  /** Used to match empty string literals in compiled template source. */\n  var reEmptyStringLeading = /\\b__p \\+= '';/g,\n      reEmptyStringMiddle = /\\b(__p \\+=) '' \\+/g,\n      reEmptyStringTrailing = /(__e\\(.*?\\)|\\b__t\\)) \\+\\n'';/g;\n\n  /** Used to match HTML entities and HTML characters. */\n  var reEscapedHtml = /&(?:amp|lt|gt|quot|#39);/g,\n      reUnescapedHtml = /[&<>\"']/g,\n      reHasEscapedHtml = RegExp(reEscapedHtml.source),\n      reHasUnescapedHtml = RegExp(reUnescapedHtml.source);\n\n  /** Used to match template delimiters. */\n  var reEscape = /<%-([\\s\\S]+?)%>/g,\n      reEvaluate = /<%([\\s\\S]+?)%>/g,\n      reInterpolate = /<%=([\\s\\S]+?)%>/g;\n\n  /** Used to match property names within property paths. */\n  var reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n      reIsPlainProp = /^\\w*$/,\n      rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n  /**\n   * Used to match `RegExp`\n   * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n   */\n  var reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g,\n      reHasRegExpChar = RegExp(reRegExpChar.source);\n\n  /** Used to match leading whitespace. */\n  var reTrimStart = /^\\s+/;\n\n  /** Used to match a single whitespace character. */\n  var reWhitespace = /\\s/;\n\n  /** Used to match wrap detail comments. */\n  var reWrapComment = /\\{(?:\\n\\/\\* \\[wrapped with .+\\] \\*\\/)?\\n?/,\n      reWrapDetails = /\\{\\n\\/\\* \\[wrapped with (.+)\\] \\*/,\n      reSplitDetails = /,? & /;\n\n  /** Used to match words composed of alphanumeric characters. */\n  var reAsciiWord = /[^\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\x7f]+/g;\n\n  /**\n   * Used to validate the `validate` option in `_.template` variable.\n   *\n   * Forbids characters which could potentially change the meaning of the function argument definition:\n   * - \"(),\" (modification of function parameters)\n   * - \"=\" (default value)\n   * - \"[]{}\" (destructuring of function parameters)\n   * - \"/\" (beginning of a comment)\n   * - whitespace\n   */\n  var reForbiddenIdentifierChars = /[()=,{}\\[\\]\\/\\s]/;\n\n  /** Used to match backslashes in property paths. */\n  var reEscapeChar = /\\\\(\\\\)?/g;\n\n  /**\n   * Used to match\n   * [ES template delimiters](http://ecma-international.org/ecma-262/7.0/#sec-template-literal-lexical-components).\n   */\n  var reEsTemplate = /\\$\\{([^\\\\}]*(?:\\\\.[^\\\\}]*)*)\\}/g;\n\n  /** Used to match `RegExp` flags from their coerced string values. */\n  var reFlags = /\\w*$/;\n\n  /** Used to detect bad signed hexadecimal string values. */\n  var reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n  /** Used to detect binary string values. */\n  var reIsBinary = /^0b[01]+$/i;\n\n  /** Used to detect host constructors (Safari). */\n  var reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n  /** Used to detect octal string values. */\n  var reIsOctal = /^0o[0-7]+$/i;\n\n  /** Used to detect unsigned integer values. */\n  var reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n  /** Used to match Latin Unicode letters (excluding mathematical operators). */\n  var reLatin = /[\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\xff\\u0100-\\u017f]/g;\n\n  /** Used to ensure capturing order of template delimiters. */\n  var reNoMatch = /($^)/;\n\n  /** Used to match unescaped characters in compiled string literals. */\n  var reUnescapedString = /['\\n\\r\\u2028\\u2029\\\\]/g;\n\n  /** Used to compose unicode character classes. */\n  var rsAstralRange = '\\\\ud800-\\\\udfff',\n      rsComboMarksRange = '\\\\u0300-\\\\u036f',\n      reComboHalfMarksRange = '\\\\ufe20-\\\\ufe2f',\n      rsComboSymbolsRange = '\\\\u20d0-\\\\u20ff',\n      rsComboRange = rsComboMarksRange + reComboHalfMarksRange + rsComboSymbolsRange,\n      rsDingbatRange = '\\\\u2700-\\\\u27bf',\n      rsLowerRange = 'a-z\\\\xdf-\\\\xf6\\\\xf8-\\\\xff',\n      rsMathOpRange = '\\\\xac\\\\xb1\\\\xd7\\\\xf7',\n      rsNonCharRange = '\\\\x00-\\\\x2f\\\\x3a-\\\\x40\\\\x5b-\\\\x60\\\\x7b-\\\\xbf',\n      rsPunctuationRange = '\\\\u2000-\\\\u206f',\n      rsSpaceRange = ' \\\\t\\\\x0b\\\\f\\\\xa0\\\\ufeff\\\\n\\\\r\\\\u2028\\\\u2029\\\\u1680\\\\u180e\\\\u2000\\\\u2001\\\\u2002\\\\u2003\\\\u2004\\\\u2005\\\\u2006\\\\u2007\\\\u2008\\\\u2009\\\\u200a\\\\u202f\\\\u205f\\\\u3000',\n      rsUpperRange = 'A-Z\\\\xc0-\\\\xd6\\\\xd8-\\\\xde',\n      rsVarRange = '\\\\ufe0e\\\\ufe0f',\n      rsBreakRange = rsMathOpRange + rsNonCharRange + rsPunctuationRange + rsSpaceRange;\n\n  /** Used to compose unicode capture groups. */\n  var rsApos = \"['\\u2019]\",\n      rsAstral = '[' + rsAstralRange + ']',\n      rsBreak = '[' + rsBreakRange + ']',\n      rsCombo = '[' + rsComboRange + ']',\n      rsDigits = '\\\\d+',\n      rsDingbat = '[' + rsDingbatRange + ']',\n      rsLower = '[' + rsLowerRange + ']',\n      rsMisc = '[^' + rsAstralRange + rsBreakRange + rsDigits + rsDingbatRange + rsLowerRange + rsUpperRange + ']',\n      rsFitz = '\\\\ud83c[\\\\udffb-\\\\udfff]',\n      rsModifier = '(?:' + rsCombo + '|' + rsFitz + ')',\n      rsNonAstral = '[^' + rsAstralRange + ']',\n      rsRegional = '(?:\\\\ud83c[\\\\udde6-\\\\uddff]){2}',\n      rsSurrPair = '[\\\\ud800-\\\\udbff][\\\\udc00-\\\\udfff]',\n      rsUpper = '[' + rsUpperRange + ']',\n      rsZWJ = '\\\\u200d';\n\n  /** Used to compose unicode regexes. */\n  var rsMiscLower = '(?:' + rsLower + '|' + rsMisc + ')',\n      rsMiscUpper = '(?:' + rsUpper + '|' + rsMisc + ')',\n      rsOptContrLower = '(?:' + rsApos + '(?:d|ll|m|re|s|t|ve))?',\n      rsOptContrUpper = '(?:' + rsApos + '(?:D|LL|M|RE|S|T|VE))?',\n      reOptMod = rsModifier + '?',\n      rsOptVar = '[' + rsVarRange + ']?',\n      rsOptJoin = '(?:' + rsZWJ + '(?:' + [rsNonAstral, rsRegional, rsSurrPair].join('|') + ')' + rsOptVar + reOptMod + ')*',\n      rsOrdLower = '\\\\d*(?:1st|2nd|3rd|(?![123])\\\\dth)(?=\\\\b|[A-Z_])',\n      rsOrdUpper = '\\\\d*(?:1ST|2ND|3RD|(?![123])\\\\dTH)(?=\\\\b|[a-z_])',\n      rsSeq = rsOptVar + reOptMod + rsOptJoin,\n      rsEmoji = '(?:' + [rsDingbat, rsRegional, rsSurrPair].join('|') + ')' + rsSeq,\n      rsSymbol = '(?:' + [rsNonAstral + rsCombo + '?', rsCombo, rsRegional, rsSurrPair, rsAstral].join('|') + ')';\n\n  /** Used to match apostrophes. */\n  var reApos = RegExp(rsApos, 'g');\n\n  /**\n   * Used to match [combining diacritical marks](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks) and\n   * [combining diacritical marks for symbols](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks_for_Symbols).\n   */\n  var reComboMark = RegExp(rsCombo, 'g');\n\n  /** Used to match [string symbols](https://mathiasbynens.be/notes/javascript-unicode). */\n  var reUnicode = RegExp(rsFitz + '(?=' + rsFitz + ')|' + rsSymbol + rsSeq, 'g');\n\n  /** Used to match complex or compound words. */\n  var reUnicodeWord = RegExp([\n    rsUpper + '?' + rsLower + '+' + rsOptContrLower + '(?=' + [rsBreak, rsUpper, '$'].join('|') + ')',\n    rsMiscUpper + '+' + rsOptContrUpper + '(?=' + [rsBreak, rsUpper + rsMiscLower, '$'].join('|') + ')',\n    rsUpper + '?' + rsMiscLower + '+' + rsOptContrLower,\n    rsUpper + '+' + rsOptContrUpper,\n    rsOrdUpper,\n    rsOrdLower,\n    rsDigits,\n    rsEmoji\n  ].join('|'), 'g');\n\n  /** Used to detect strings with [zero-width joiners or code points from the astral planes](http://eev.ee/blog/2015/09/12/dark-corners-of-unicode/). */\n  var reHasUnicode = RegExp('[' + rsZWJ + rsAstralRange  + rsComboRange + rsVarRange + ']');\n\n  /** Used to detect strings that need a more robust regexp to match words. */\n  var reHasUnicodeWord = /[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;\n\n  /** Used to assign default `context` object properties. */\n  var contextProps = [\n    'Array', 'Buffer', 'DataView', 'Date', 'Error', 'Float32Array', 'Float64Array',\n    'Function', 'Int8Array', 'Int16Array', 'Int32Array', 'Map', 'Math', 'Object',\n    'Promise', 'RegExp', 'Set', 'String', 'Symbol', 'TypeError', 'Uint8Array',\n    'Uint8ClampedArray', 'Uint16Array', 'Uint32Array', 'WeakMap',\n    '_', 'clearTimeout', 'isFinite', 'parseInt', 'setTimeout'\n  ];\n\n  /** Used to make template sourceURLs easier to identify. */\n  var templateCounter = -1;\n\n  /** Used to identify `toStringTag` values of typed arrays. */\n  var typedArrayTags = {};\n  typedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\n  typedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\n  typedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\n  typedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\n  typedArrayTags[uint32Tag] = true;\n  typedArrayTags[argsTag] = typedArrayTags[arrayTag] =\n  typedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\n  typedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\n  typedArrayTags[errorTag] = typedArrayTags[funcTag] =\n  typedArrayTags[mapTag] = typedArrayTags[numberTag] =\n  typedArrayTags[objectTag] = typedArrayTags[regexpTag] =\n  typedArrayTags[setTag] = typedArrayTags[stringTag] =\n  typedArrayTags[weakMapTag] = false;\n\n  /** Used to identify `toStringTag` values supported by `_.clone`. */\n  var cloneableTags = {};\n  cloneableTags[argsTag] = cloneableTags[arrayTag] =\n  cloneableTags[arrayBufferTag] = cloneableTags[dataViewTag] =\n  cloneableTags[boolTag] = cloneableTags[dateTag] =\n  cloneableTags[float32Tag] = cloneableTags[float64Tag] =\n  cloneableTags[int8Tag] = cloneableTags[int16Tag] =\n  cloneableTags[int32Tag] = cloneableTags[mapTag] =\n  cloneableTags[numberTag] = cloneableTags[objectTag] =\n  cloneableTags[regexpTag] = cloneableTags[setTag] =\n  cloneableTags[stringTag] = cloneableTags[symbolTag] =\n  cloneableTags[uint8Tag] = cloneableTags[uint8ClampedTag] =\n  cloneableTags[uint16Tag] = cloneableTags[uint32Tag] = true;\n  cloneableTags[errorTag] = cloneableTags[funcTag] =\n  cloneableTags[weakMapTag] = false;\n\n  /** Used to map Latin Unicode letters to basic Latin letters. */\n  var deburredLetters = {\n    // Latin-1 Supplement block.\n    '\\xc0': 'A',  '\\xc1': 'A', '\\xc2': 'A', '\\xc3': 'A', '\\xc4': 'A', '\\xc5': 'A',\n    '\\xe0': 'a',  '\\xe1': 'a', '\\xe2': 'a', '\\xe3': 'a', '\\xe4': 'a', '\\xe5': 'a',\n    '\\xc7': 'C',  '\\xe7': 'c',\n    '\\xd0': 'D',  '\\xf0': 'd',\n    '\\xc8': 'E',  '\\xc9': 'E', '\\xca': 'E', '\\xcb': 'E',\n    '\\xe8': 'e',  '\\xe9': 'e', '\\xea': 'e', '\\xeb': 'e',\n    '\\xcc': 'I',  '\\xcd': 'I', '\\xce': 'I', '\\xcf': 'I',\n    '\\xec': 'i',  '\\xed': 'i', '\\xee': 'i', '\\xef': 'i',\n    '\\xd1': 'N',  '\\xf1': 'n',\n    '\\xd2': 'O',  '\\xd3': 'O', '\\xd4': 'O', '\\xd5': 'O', '\\xd6': 'O', '\\xd8': 'O',\n    '\\xf2': 'o',  '\\xf3': 'o', '\\xf4': 'o', '\\xf5': 'o', '\\xf6': 'o', '\\xf8': 'o',\n    '\\xd9': 'U',  '\\xda': 'U', '\\xdb': 'U', '\\xdc': 'U',\n    '\\xf9': 'u',  '\\xfa': 'u', '\\xfb': 'u', '\\xfc': 'u',\n    '\\xdd': 'Y',  '\\xfd': 'y', '\\xff': 'y',\n    '\\xc6': 'Ae', '\\xe6': 'ae',\n    '\\xde': 'Th', '\\xfe': 'th',\n    '\\xdf': 'ss',\n    // Latin Extended-A block.\n    '\\u0100': 'A',  '\\u0102': 'A', '\\u0104': 'A',\n    '\\u0101': 'a',  '\\u0103': 'a', '\\u0105': 'a',\n    '\\u0106': 'C',  '\\u0108': 'C', '\\u010a': 'C', '\\u010c': 'C',\n    '\\u0107': 'c',  '\\u0109': 'c', '\\u010b': 'c', '\\u010d': 'c',\n    '\\u010e': 'D',  '\\u0110': 'D', '\\u010f': 'd', '\\u0111': 'd',\n    '\\u0112': 'E',  '\\u0114': 'E', '\\u0116': 'E', '\\u0118': 'E', '\\u011a': 'E',\n    '\\u0113': 'e',  '\\u0115': 'e', '\\u0117': 'e', '\\u0119': 'e', '\\u011b': 'e',\n    '\\u011c': 'G',  '\\u011e': 'G', '\\u0120': 'G', '\\u0122': 'G',\n    '\\u011d': 'g',  '\\u011f': 'g', '\\u0121': 'g', '\\u0123': 'g',\n    '\\u0124': 'H',  '\\u0126': 'H', '\\u0125': 'h', '\\u0127': 'h',\n    '\\u0128': 'I',  '\\u012a': 'I', '\\u012c': 'I', '\\u012e': 'I', '\\u0130': 'I',\n    '\\u0129': 'i',  '\\u012b': 'i', '\\u012d': 'i', '\\u012f': 'i', '\\u0131': 'i',\n    '\\u0134': 'J',  '\\u0135': 'j',\n    '\\u0136': 'K',  '\\u0137': 'k', '\\u0138': 'k',\n    '\\u0139': 'L',  '\\u013b': 'L', '\\u013d': 'L', '\\u013f': 'L', '\\u0141': 'L',\n    '\\u013a': 'l',  '\\u013c': 'l', '\\u013e': 'l', '\\u0140': 'l', '\\u0142': 'l',\n    '\\u0143': 'N',  '\\u0145': 'N', '\\u0147': 'N', '\\u014a': 'N',\n    '\\u0144': 'n',  '\\u0146': 'n', '\\u0148': 'n', '\\u014b': 'n',\n    '\\u014c': 'O',  '\\u014e': 'O', '\\u0150': 'O',\n    '\\u014d': 'o',  '\\u014f': 'o', '\\u0151': 'o',\n    '\\u0154': 'R',  '\\u0156': 'R', '\\u0158': 'R',\n    '\\u0155': 'r',  '\\u0157': 'r', '\\u0159': 'r',\n    '\\u015a': 'S',  '\\u015c': 'S', '\\u015e': 'S', '\\u0160': 'S',\n    '\\u015b': 's',  '\\u015d': 's', '\\u015f': 's', '\\u0161': 's',\n    '\\u0162': 'T',  '\\u0164': 'T', '\\u0166': 'T',\n    '\\u0163': 't',  '\\u0165': 't', '\\u0167': 't',\n    '\\u0168': 'U',  '\\u016a': 'U', '\\u016c': 'U', '\\u016e': 'U', '\\u0170': 'U', '\\u0172': 'U',\n    '\\u0169': 'u',  '\\u016b': 'u', '\\u016d': 'u', '\\u016f': 'u', '\\u0171': 'u', '\\u0173': 'u',\n    '\\u0174': 'W',  '\\u0175': 'w',\n    '\\u0176': 'Y',  '\\u0177': 'y', '\\u0178': 'Y',\n    '\\u0179': 'Z',  '\\u017b': 'Z', '\\u017d': 'Z',\n    '\\u017a': 'z',  '\\u017c': 'z', '\\u017e': 'z',\n    '\\u0132': 'IJ', '\\u0133': 'ij',\n    '\\u0152': 'Oe', '\\u0153': 'oe',\n    '\\u0149': \"'n\", '\\u017f': 's'\n  };\n\n  /** Used to map characters to HTML entities. */\n  var htmlEscapes = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#39;'\n  };\n\n  /** Used to map HTML entities to characters. */\n  var htmlUnescapes = {\n    '&amp;': '&',\n    '&lt;': '<',\n    '&gt;': '>',\n    '&quot;': '\"',\n    '&#39;': \"'\"\n  };\n\n  /** Used to escape characters for inclusion in compiled string literals. */\n  var stringEscapes = {\n    '\\\\': '\\\\',\n    \"'\": \"'\",\n    '\\n': 'n',\n    '\\r': 'r',\n    '\\u2028': 'u2028',\n    '\\u2029': 'u2029'\n  };\n\n  /** Built-in method references without a dependency on `root`. */\n  var freeParseFloat = parseFloat,\n      freeParseInt = parseInt;\n\n  /** Detect free variable `global` from Node.js. */\n  var freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n  /** Detect free variable `self`. */\n  var freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n  /** Used as a reference to the global object. */\n  var root = freeGlobal || freeSelf || Function('return this')();\n\n  /** Detect free variable `exports`. */\n  var freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n  /** Detect free variable `module`. */\n  var freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n  /** Detect the popular CommonJS extension `module.exports`. */\n  var moduleExports = freeModule && freeModule.exports === freeExports;\n\n  /** Detect free variable `process` from Node.js. */\n  var freeProcess = moduleExports && freeGlobal.process;\n\n  /** Used to access faster Node.js helpers. */\n  var nodeUtil = (function() {\n    try {\n      // Use `util.types` for Node.js 10+.\n      var types = freeModule && freeModule.require && freeModule.require('util').types;\n\n      if (types) {\n        return types;\n      }\n\n      // Legacy `process.binding('util')` for Node.js < 10.\n      return freeProcess && freeProcess.binding && freeProcess.binding('util');\n    } catch (e) {}\n  }());\n\n  /* Node.js helper references. */\n  var nodeIsArrayBuffer = nodeUtil && nodeUtil.isArrayBuffer,\n      nodeIsDate = nodeUtil && nodeUtil.isDate,\n      nodeIsMap = nodeUtil && nodeUtil.isMap,\n      nodeIsRegExp = nodeUtil && nodeUtil.isRegExp,\n      nodeIsSet = nodeUtil && nodeUtil.isSet,\n      nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * A faster alternative to `Function#apply`, this function invokes `func`\n   * with the `this` binding of `thisArg` and the arguments of `args`.\n   *\n   * @private\n   * @param {Function} func The function to invoke.\n   * @param {*} thisArg The `this` binding of `func`.\n   * @param {Array} args The arguments to invoke `func` with.\n   * @returns {*} Returns the result of `func`.\n   */\n  function apply(func, thisArg, args) {\n    switch (args.length) {\n      case 0: return func.call(thisArg);\n      case 1: return func.call(thisArg, args[0]);\n      case 2: return func.call(thisArg, args[0], args[1]);\n      case 3: return func.call(thisArg, args[0], args[1], args[2]);\n    }\n    return func.apply(thisArg, args);\n  }\n\n  /**\n   * A specialized version of `baseAggregator` for arrays.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} setter The function to set `accumulator` values.\n   * @param {Function} iteratee The iteratee to transform keys.\n   * @param {Object} accumulator The initial aggregated object.\n   * @returns {Function} Returns `accumulator`.\n   */\n  function arrayAggregator(array, setter, iteratee, accumulator) {\n    var index = -1,\n        length = array == null ? 0 : array.length;\n\n    while (++index < length) {\n      var value = array[index];\n      setter(accumulator, value, iteratee(value), array);\n    }\n    return accumulator;\n  }\n\n  /**\n   * A specialized version of `_.forEach` for arrays without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @returns {Array} Returns `array`.\n   */\n  function arrayEach(array, iteratee) {\n    var index = -1,\n        length = array == null ? 0 : array.length;\n\n    while (++index < length) {\n      if (iteratee(array[index], index, array) === false) {\n        break;\n      }\n    }\n    return array;\n  }\n\n  /**\n   * A specialized version of `_.forEachRight` for arrays without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @returns {Array} Returns `array`.\n   */\n  function arrayEachRight(array, iteratee) {\n    var length = array == null ? 0 : array.length;\n\n    while (length--) {\n      if (iteratee(array[length], length, array) === false) {\n        break;\n      }\n    }\n    return array;\n  }\n\n  /**\n   * A specialized version of `_.every` for arrays without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} predicate The function invoked per iteration.\n   * @returns {boolean} Returns `true` if all elements pass the predicate check,\n   *  else `false`.\n   */\n  function arrayEvery(array, predicate) {\n    var index = -1,\n        length = array == null ? 0 : array.length;\n\n    while (++index < length) {\n      if (!predicate(array[index], index, array)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  /**\n   * A specialized version of `_.filter` for arrays without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} predicate The function invoked per iteration.\n   * @returns {Array} Returns the new filtered array.\n   */\n  function arrayFilter(array, predicate) {\n    var index = -1,\n        length = array == null ? 0 : array.length,\n        resIndex = 0,\n        result = [];\n\n    while (++index < length) {\n      var value = array[index];\n      if (predicate(value, index, array)) {\n        result[resIndex++] = value;\n      }\n    }\n    return result;\n  }\n\n  /**\n   * A specialized version of `_.includes` for arrays without support for\n   * specifying an index to search from.\n   *\n   * @private\n   * @param {Array} [array] The array to inspect.\n   * @param {*} target The value to search for.\n   * @returns {boolean} Returns `true` if `target` is found, else `false`.\n   */\n  function arrayIncludes(array, value) {\n    var length = array == null ? 0 : array.length;\n    return !!length && baseIndexOf(array, value, 0) > -1;\n  }\n\n  /**\n   * This function is like `arrayIncludes` except that it accepts a comparator.\n   *\n   * @private\n   * @param {Array} [array] The array to inspect.\n   * @param {*} target The value to search for.\n   * @param {Function} comparator The comparator invoked per element.\n   * @returns {boolean} Returns `true` if `target` is found, else `false`.\n   */\n  function arrayIncludesWith(array, value, comparator) {\n    var index = -1,\n        length = array == null ? 0 : array.length;\n\n    while (++index < length) {\n      if (comparator(value, array[index])) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * A specialized version of `_.map` for arrays without support for iteratee\n   * shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @returns {Array} Returns the new mapped array.\n   */\n  function arrayMap(array, iteratee) {\n    var index = -1,\n        length = array == null ? 0 : array.length,\n        result = Array(length);\n\n    while (++index < length) {\n      result[index] = iteratee(array[index], index, array);\n    }\n    return result;\n  }\n\n  /**\n   * Appends the elements of `values` to `array`.\n   *\n   * @private\n   * @param {Array} array The array to modify.\n   * @param {Array} values The values to append.\n   * @returns {Array} Returns `array`.\n   */\n  function arrayPush(array, values) {\n    var index = -1,\n        length = values.length,\n        offset = array.length;\n\n    while (++index < length) {\n      array[offset + index] = values[index];\n    }\n    return array;\n  }\n\n  /**\n   * A specialized version of `_.reduce` for arrays without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @param {*} [accumulator] The initial value.\n   * @param {boolean} [initAccum] Specify using the first element of `array` as\n   *  the initial value.\n   * @returns {*} Returns the accumulated value.\n   */\n  function arrayReduce(array, iteratee, accumulator, initAccum) {\n    var index = -1,\n        length = array == null ? 0 : array.length;\n\n    if (initAccum && length) {\n      accumulator = array[++index];\n    }\n    while (++index < length) {\n      accumulator = iteratee(accumulator, array[index], index, array);\n    }\n    return accumulator;\n  }\n\n  /**\n   * A specialized version of `_.reduceRight` for arrays without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @param {*} [accumulator] The initial value.\n   * @param {boolean} [initAccum] Specify using the last element of `array` as\n   *  the initial value.\n   * @returns {*} Returns the accumulated value.\n   */\n  function arrayReduceRight(array, iteratee, accumulator, initAccum) {\n    var length = array == null ? 0 : array.length;\n    if (initAccum && length) {\n      accumulator = array[--length];\n    }\n    while (length--) {\n      accumulator = iteratee(accumulator, array[length], length, array);\n    }\n    return accumulator;\n  }\n\n  /**\n   * A specialized version of `_.some` for arrays without support for iteratee\n   * shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} predicate The function invoked per iteration.\n   * @returns {boolean} Returns `true` if any element passes the predicate check,\n   *  else `false`.\n   */\n  function arraySome(array, predicate) {\n    var index = -1,\n        length = array == null ? 0 : array.length;\n\n    while (++index < length) {\n      if (predicate(array[index], index, array)) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Gets the size of an ASCII `string`.\n   *\n   * @private\n   * @param {string} string The string inspect.\n   * @returns {number} Returns the string size.\n   */\n  var asciiSize = baseProperty('length');\n\n  /**\n   * Converts an ASCII `string` to an array.\n   *\n   * @private\n   * @param {string} string The string to convert.\n   * @returns {Array} Returns the converted array.\n   */\n  function asciiToArray(string) {\n    return string.split('');\n  }\n\n  /**\n   * Splits an ASCII `string` into an array of its words.\n   *\n   * @private\n   * @param {string} The string to inspect.\n   * @returns {Array} Returns the words of `string`.\n   */\n  function asciiWords(string) {\n    return string.match(reAsciiWord) || [];\n  }\n\n  /**\n   * The base implementation of methods like `_.findKey` and `_.findLastKey`,\n   * without support for iteratee shorthands, which iterates over `collection`\n   * using `eachFunc`.\n   *\n   * @private\n   * @param {Array|Object} collection The collection to inspect.\n   * @param {Function} predicate The function invoked per iteration.\n   * @param {Function} eachFunc The function to iterate over `collection`.\n   * @returns {*} Returns the found element or its key, else `undefined`.\n   */\n  function baseFindKey(collection, predicate, eachFunc) {\n    var result;\n    eachFunc(collection, function(value, key, collection) {\n      if (predicate(value, key, collection)) {\n        result = key;\n        return false;\n      }\n    });\n    return result;\n  }\n\n  /**\n   * The base implementation of `_.findIndex` and `_.findLastIndex` without\n   * support for iteratee shorthands.\n   *\n   * @private\n   * @param {Array} array The array to inspect.\n   * @param {Function} predicate The function invoked per iteration.\n   * @param {number} fromIndex The index to search from.\n   * @param {boolean} [fromRight] Specify iterating from right to left.\n   * @returns {number} Returns the index of the matched value, else `-1`.\n   */\n  function baseFindIndex(array, predicate, fromIndex, fromRight) {\n    var length = array.length,\n        index = fromIndex + (fromRight ? 1 : -1);\n\n    while ((fromRight ? index-- : ++index < length)) {\n      if (predicate(array[index], index, array)) {\n        return index;\n      }\n    }\n    return -1;\n  }\n\n  /**\n   * The base implementation of `_.indexOf` without `fromIndex` bounds checks.\n   *\n   * @private\n   * @param {Array} array The array to inspect.\n   * @param {*} value The value to search for.\n   * @param {number} fromIndex The index to search from.\n   * @returns {number} Returns the index of the matched value, else `-1`.\n   */\n  function baseIndexOf(array, value, fromIndex) {\n    return value === value\n      ? strictIndexOf(array, value, fromIndex)\n      : baseFindIndex(array, baseIsNaN, fromIndex);\n  }\n\n  /**\n   * This function is like `baseIndexOf` except that it accepts a comparator.\n   *\n   * @private\n   * @param {Array} array The array to inspect.\n   * @param {*} value The value to search for.\n   * @param {number} fromIndex The index to search from.\n   * @param {Function} comparator The comparator invoked per element.\n   * @returns {number} Returns the index of the matched value, else `-1`.\n   */\n  function baseIndexOfWith(array, value, fromIndex, comparator) {\n    var index = fromIndex - 1,\n        length = array.length;\n\n    while (++index < length) {\n      if (comparator(array[index], value)) {\n        return index;\n      }\n    }\n    return -1;\n  }\n\n  /**\n   * The base implementation of `_.isNaN` without support for number objects.\n   *\n   * @private\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n   */\n  function baseIsNaN(value) {\n    return value !== value;\n  }\n\n  /**\n   * The base implementation of `_.mean` and `_.meanBy` without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} array The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @returns {number} Returns the mean.\n   */\n  function baseMean(array, iteratee) {\n    var length = array == null ? 0 : array.length;\n    return length ? (baseSum(array, iteratee) / length) : NAN;\n  }\n\n  /**\n   * The base implementation of `_.property` without support for deep paths.\n   *\n   * @private\n   * @param {string} key The key of the property to get.\n   * @returns {Function} Returns the new accessor function.\n   */\n  function baseProperty(key) {\n    return function(object) {\n      return object == null ? undefined : object[key];\n    };\n  }\n\n  /**\n   * The base implementation of `_.propertyOf` without support for deep paths.\n   *\n   * @private\n   * @param {Object} object The object to query.\n   * @returns {Function} Returns the new accessor function.\n   */\n  function basePropertyOf(object) {\n    return function(key) {\n      return object == null ? undefined : object[key];\n    };\n  }\n\n  /**\n   * The base implementation of `_.reduce` and `_.reduceRight`, without support\n   * for iteratee shorthands, which iterates over `collection` using `eachFunc`.\n   *\n   * @private\n   * @param {Array|Object} collection The collection to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @param {*} accumulator The initial value.\n   * @param {boolean} initAccum Specify using the first or last element of\n   *  `collection` as the initial value.\n   * @param {Function} eachFunc The function to iterate over `collection`.\n   * @returns {*} Returns the accumulated value.\n   */\n  function baseReduce(collection, iteratee, accumulator, initAccum, eachFunc) {\n    eachFunc(collection, function(value, index, collection) {\n      accumulator = initAccum\n        ? (initAccum = false, value)\n        : iteratee(accumulator, value, index, collection);\n    });\n    return accumulator;\n  }\n\n  /**\n   * The base implementation of `_.sortBy` which uses `comparer` to define the\n   * sort order of `array` and replaces criteria objects with their corresponding\n   * values.\n   *\n   * @private\n   * @param {Array} array The array to sort.\n   * @param {Function} comparer The function to define sort order.\n   * @returns {Array} Returns `array`.\n   */\n  function baseSortBy(array, comparer) {\n    var length = array.length;\n\n    array.sort(comparer);\n    while (length--) {\n      array[length] = array[length].value;\n    }\n    return array;\n  }\n\n  /**\n   * The base implementation of `_.sum` and `_.sumBy` without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} array The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @returns {number} Returns the sum.\n   */\n  function baseSum(array, iteratee) {\n    var result,\n        index = -1,\n        length = array.length;\n\n    while (++index < length) {\n      var current = iteratee(array[index]);\n      if (current !== undefined) {\n        result = result === undefined ? current : (result + current);\n      }\n    }\n    return result;\n  }\n\n  /**\n   * The base implementation of `_.times` without support for iteratee shorthands\n   * or max array length checks.\n   *\n   * @private\n   * @param {number} n The number of times to invoke `iteratee`.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @returns {Array} Returns the array of results.\n   */\n  function baseTimes(n, iteratee) {\n    var index = -1,\n        result = Array(n);\n\n    while (++index < n) {\n      result[index] = iteratee(index);\n    }\n    return result;\n  }\n\n  /**\n   * The base implementation of `_.toPairs` and `_.toPairsIn` which creates an array\n   * of key-value pairs for `object` corresponding to the property names of `props`.\n   *\n   * @private\n   * @param {Object} object The object to query.\n   * @param {Array} props The property names to get values for.\n   * @returns {Object} Returns the key-value pairs.\n   */\n  function baseToPairs(object, props) {\n    return arrayMap(props, function(key) {\n      return [key, object[key]];\n    });\n  }\n\n  /**\n   * The base implementation of `_.trim`.\n   *\n   * @private\n   * @param {string} string The string to trim.\n   * @returns {string} Returns the trimmed string.\n   */\n  function baseTrim(string) {\n    return string\n      ? string.slice(0, trimmedEndIndex(string) + 1).replace(reTrimStart, '')\n      : string;\n  }\n\n  /**\n   * The base implementation of `_.unary` without support for storing metadata.\n   *\n   * @private\n   * @param {Function} func The function to cap arguments for.\n   * @returns {Function} Returns the new capped function.\n   */\n  function baseUnary(func) {\n    return function(value) {\n      return func(value);\n    };\n  }\n\n  /**\n   * The base implementation of `_.values` and `_.valuesIn` which creates an\n   * array of `object` property values corresponding to the property names\n   * of `props`.\n   *\n   * @private\n   * @param {Object} object The object to query.\n   * @param {Array} props The property names to get values for.\n   * @returns {Object} Returns the array of property values.\n   */\n  function baseValues(object, props) {\n    return arrayMap(props, function(key) {\n      return object[key];\n    });\n  }\n\n  /**\n   * Checks if a `cache` value for `key` exists.\n   *\n   * @private\n   * @param {Object} cache The cache to query.\n   * @param {string} key The key of the entry to check.\n   * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n   */\n  function cacheHas(cache, key) {\n    return cache.has(key);\n  }\n\n  /**\n   * Used by `_.trim` and `_.trimStart` to get the index of the first string symbol\n   * that is not found in the character symbols.\n   *\n   * @private\n   * @param {Array} strSymbols The string symbols to inspect.\n   * @param {Array} chrSymbols The character symbols to find.\n   * @returns {number} Returns the index of the first unmatched string symbol.\n   */\n  function charsStartIndex(strSymbols, chrSymbols) {\n    var index = -1,\n        length = strSymbols.length;\n\n    while (++index < length && baseIndexOf(chrSymbols, strSymbols[index], 0) > -1) {}\n    return index;\n  }\n\n  /**\n   * Used by `_.trim` and `_.trimEnd` to get the index of the last string symbol\n   * that is not found in the character symbols.\n   *\n   * @private\n   * @param {Array} strSymbols The string symbols to inspect.\n   * @param {Array} chrSymbols The character symbols to find.\n   * @returns {number} Returns the index of the last unmatched string symbol.\n   */\n  function charsEndIndex(strSymbols, chrSymbols) {\n    var index = strSymbols.length;\n\n    while (index-- && baseIndexOf(chrSymbols, strSymbols[index], 0) > -1) {}\n    return index;\n  }\n\n  /**\n   * Gets the number of `placeholder` occurrences in `array`.\n   *\n   * @private\n   * @param {Array} array The array to inspect.\n   * @param {*} placeholder The placeholder to search for.\n   * @returns {number} Returns the placeholder count.\n   */\n  function countHolders(array, placeholder) {\n    var length = array.length,\n        result = 0;\n\n    while (length--) {\n      if (array[length] === placeholder) {\n        ++result;\n      }\n    }\n    return result;\n  }\n\n  /**\n   * Used by `_.deburr` to convert Latin-1 Supplement and Latin Extended-A\n   * letters to basic Latin letters.\n   *\n   * @private\n   * @param {string} letter The matched letter to deburr.\n   * @returns {string} Returns the deburred letter.\n   */\n  var deburrLetter = basePropertyOf(deburredLetters);\n\n  /**\n   * Used by `_.escape` to convert characters to HTML entities.\n   *\n   * @private\n   * @param {string} chr The matched character to escape.\n   * @returns {string} Returns the escaped character.\n   */\n  var escapeHtmlChar = basePropertyOf(htmlEscapes);\n\n  /**\n   * Used by `_.template` to escape characters for inclusion in compiled string literals.\n   *\n   * @private\n   * @param {string} chr The matched character to escape.\n   * @returns {string} Returns the escaped character.\n   */\n  function escapeStringChar(chr) {\n    return '\\\\' + stringEscapes[chr];\n  }\n\n  /**\n   * Gets the value at `key` of `object`.\n   *\n   * @private\n   * @param {Object} [object] The object to query.\n   * @param {string} key The key of the property to get.\n   * @returns {*} Returns the property value.\n   */\n  function getValue(object, key) {\n    return object == null ? undefined : object[key];\n  }\n\n  /**\n   * Checks if `string` contains Unicode symbols.\n   *\n   * @private\n   * @param {string} string The string to inspect.\n   * @returns {boolean} Returns `true` if a symbol is found, else `false`.\n   */\n  function hasUnicode(string) {\n    return reHasUnicode.test(string);\n  }\n\n  /**\n   * Checks if `string` contains a word composed of Unicode symbols.\n   *\n   * @private\n   * @param {string} string The string to inspect.\n   * @returns {boolean} Returns `true` if a word is found, else `false`.\n   */\n  function hasUnicodeWord(string) {\n    return reHasUnicodeWord.test(string);\n  }\n\n  /**\n   * Converts `iterator` to an array.\n   *\n   * @private\n   * @param {Object} iterator The iterator to convert.\n   * @returns {Array} Returns the converted array.\n   */\n  function iteratorToArray(iterator) {\n    var data,\n        result = [];\n\n    while (!(data = iterator.next()).done) {\n      result.push(data.value);\n    }\n    return result;\n  }\n\n  /**\n   * Converts `map` to its key-value pairs.\n   *\n   * @private\n   * @param {Object} map The map to convert.\n   * @returns {Array} Returns the key-value pairs.\n   */\n  function mapToArray(map) {\n    var index = -1,\n        result = Array(map.size);\n\n    map.forEach(function(value, key) {\n      result[++index] = [key, value];\n    });\n    return result;\n  }\n\n  /**\n   * Creates a unary function that invokes `func` with its argument transformed.\n   *\n   * @private\n   * @param {Function} func The function to wrap.\n   * @param {Function} transform The argument transform.\n   * @returns {Function} Returns the new function.\n   */\n  function overArg(func, transform) {\n    return function(arg) {\n      return func(transform(arg));\n    };\n  }\n\n  /**\n   * Replaces all `placeholder` elements in `array` with an internal placeholder\n   * and returns an array of their indexes.\n   *\n   * @private\n   * @param {Array} array The array to modify.\n   * @param {*} placeholder The placeholder to replace.\n   * @returns {Array} Returns the new array of placeholder indexes.\n   */\n  function replaceHolders(array, placeholder) {\n    var index = -1,\n        length = array.length,\n        resIndex = 0,\n        result = [];\n\n    while (++index < length) {\n      var value = array[index];\n      if (value === placeholder || value === PLACEHOLDER) {\n        array[index] = PLACEHOLDER;\n        result[resIndex++] = index;\n      }\n    }\n    return result;\n  }\n\n  /**\n   * Converts `set` to an array of its values.\n   *\n   * @private\n   * @param {Object} set The set to convert.\n   * @returns {Array} Returns the values.\n   */\n  function setToArray(set) {\n    var index = -1,\n        result = Array(set.size);\n\n    set.forEach(function(value) {\n      result[++index] = value;\n    });\n    return result;\n  }\n\n  /**\n   * Converts `set` to its value-value pairs.\n   *\n   * @private\n   * @param {Object} set The set to convert.\n   * @returns {Array} Returns the value-value pairs.\n   */\n  function setToPairs(set) {\n    var index = -1,\n        result = Array(set.size);\n\n    set.forEach(function(value) {\n      result[++index] = [value, value];\n    });\n    return result;\n  }\n\n  /**\n   * A specialized version of `_.indexOf` which performs strict equality\n   * comparisons of values, i.e. `===`.\n   *\n   * @private\n   * @param {Array} array The array to inspect.\n   * @param {*} value The value to search for.\n   * @param {number} fromIndex The index to search from.\n   * @returns {number} Returns the index of the matched value, else `-1`.\n   */\n  function strictIndexOf(array, value, fromIndex) {\n    var index = fromIndex - 1,\n        length = array.length;\n\n    while (++index < length) {\n      if (array[index] === value) {\n        return index;\n      }\n    }\n    return -1;\n  }\n\n  /**\n   * A specialized version of `_.lastIndexOf` which performs strict equality\n   * comparisons of values, i.e. `===`.\n   *\n   * @private\n   * @param {Array} array The array to inspect.\n   * @param {*} value The value to search for.\n   * @param {number} fromIndex The index to search from.\n   * @returns {number} Returns the index of the matched value, else `-1`.\n   */\n  function strictLastIndexOf(array, value, fromIndex) {\n    var index = fromIndex + 1;\n    while (index--) {\n      if (array[index] === value) {\n        return index;\n      }\n    }\n    return index;\n  }\n\n  /**\n   * Gets the number of symbols in `string`.\n   *\n   * @private\n   * @param {string} string The string to inspect.\n   * @returns {number} Returns the string size.\n   */\n  function stringSize(string) {\n    return hasUnicode(string)\n      ? unicodeSize(string)\n      : asciiSize(string);\n  }\n\n  /**\n   * Converts `string` to an array.\n   *\n   * @private\n   * @param {string} string The string to convert.\n   * @returns {Array} Returns the converted array.\n   */\n  function stringToArray(string) {\n    return hasUnicode(string)\n      ? unicodeToArray(string)\n      : asciiToArray(string);\n  }\n\n  /**\n   * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace\n   * character of `string`.\n   *\n   * @private\n   * @param {string} string The string to inspect.\n   * @returns {number} Returns the index of the last non-whitespace character.\n   */\n  function trimmedEndIndex(string) {\n    var index = string.length;\n\n    while (index-- && reWhitespace.test(string.charAt(index))) {}\n    return index;\n  }\n\n  /**\n   * Used by `_.unescape` to convert HTML entities to characters.\n   *\n   * @private\n   * @param {string} chr The matched character to unescape.\n   * @returns {string} Returns the unescaped character.\n   */\n  var unescapeHtmlChar = basePropertyOf(htmlUnescapes);\n\n  /**\n   * Gets the size of a Unicode `string`.\n   *\n   * @private\n   * @param {string} string The string inspect.\n   * @returns {number} Returns the string size.\n   */\n  function unicodeSize(string) {\n    var result = reUnicode.lastIndex = 0;\n    while (reUnicode.test(string)) {\n      ++result;\n    }\n    return result;\n  }\n\n  /**\n   * Converts a Unicode `string` to an array.\n   *\n   * @private\n   * @param {string} string The string to convert.\n   * @returns {Array} Returns the converted array.\n   */\n  function unicodeToArray(string) {\n    return string.match(reUnicode) || [];\n  }\n\n  /**\n   * Splits a Unicode `string` into an array of its words.\n   *\n   * @private\n   * @param {string} The string to inspect.\n   * @returns {Array} Returns the words of `string`.\n   */\n  function unicodeWords(string) {\n    return string.match(reUnicodeWord) || [];\n  }\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * Create a new pristine `lodash` function using the `context` object.\n   *\n   * @static\n   * @memberOf _\n   * @since 1.1.0\n   * @category Util\n   * @param {Object} [context=root] The context object.\n   * @returns {Function} Returns a new `lodash` function.\n   * @example\n   *\n   * _.mixin({ 'foo': _.constant('foo') });\n   *\n   * var lodash = _.runInContext();\n   * lodash.mixin({ 'bar': lodash.constant('bar') });\n   *\n   * _.isFunction(_.foo);\n   * // => true\n   * _.isFunction(_.bar);\n   * // => false\n   *\n   * lodash.isFunction(lodash.foo);\n   * // => false\n   * lodash.isFunction(lodash.bar);\n   * // => true\n   *\n   * // Create a suped-up `defer` in Node.js.\n   * var defer = _.runInContext({ 'setTimeout': setImmediate }).defer;\n   */\n  var runInContext = (function runInContext(context) {\n    context = context == null ? root : _.defaults(root.Object(), context, _.pick(root, contextProps));\n\n    /** Built-in constructor references. */\n    var Array = context.Array,\n        Date = context.Date,\n        Error = context.Error,\n        Function = context.Function,\n        Math = context.Math,\n        Object = context.Object,\n        RegExp = context.RegExp,\n        String = context.String,\n        TypeError = context.TypeError;\n\n    /** Used for built-in method references. */\n    var arrayProto = Array.prototype,\n        funcProto = Function.prototype,\n        objectProto = Object.prototype;\n\n    /** Used to detect overreaching core-js shims. */\n    var coreJsData = context['__core-js_shared__'];\n\n    /** Used to resolve the decompiled source of functions. */\n    var funcToString = funcProto.toString;\n\n    /** Used to check objects for own properties. */\n    var hasOwnProperty = objectProto.hasOwnProperty;\n\n    /** Used to generate unique IDs. */\n    var idCounter = 0;\n\n    /** Used to detect methods masquerading as native. */\n    var maskSrcKey = (function() {\n      var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n      return uid ? ('Symbol(src)_1.' + uid) : '';\n    }());\n\n    /**\n     * Used to resolve the\n     * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n     * of values.\n     */\n    var nativeObjectToString = objectProto.toString;\n\n    /** Used to infer the `Object` constructor. */\n    var objectCtorString = funcToString.call(Object);\n\n    /** Used to restore the original `_` reference in `_.noConflict`. */\n    var oldDash = root._;\n\n    /** Used to detect if a method is native. */\n    var reIsNative = RegExp('^' +\n      funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n      .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n    );\n\n    /** Built-in value references. */\n    var Buffer = moduleExports ? context.Buffer : undefined,\n        Symbol = context.Symbol,\n        Uint8Array = context.Uint8Array,\n        allocUnsafe = Buffer ? Buffer.allocUnsafe : undefined,\n        getPrototype = overArg(Object.getPrototypeOf, Object),\n        objectCreate = Object.create,\n        propertyIsEnumerable = objectProto.propertyIsEnumerable,\n        splice = arrayProto.splice,\n        spreadableSymbol = Symbol ? Symbol.isConcatSpreadable : undefined,\n        symIterator = Symbol ? Symbol.iterator : undefined,\n        symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n    var defineProperty = (function() {\n      try {\n        var func = getNative(Object, 'defineProperty');\n        func({}, '', {});\n        return func;\n      } catch (e) {}\n    }());\n\n    /** Mocked built-ins. */\n    var ctxClearTimeout = context.clearTimeout !== root.clearTimeout && context.clearTimeout,\n        ctxNow = Date && Date.now !== root.Date.now && Date.now,\n        ctxSetTimeout = context.setTimeout !== root.setTimeout && context.setTimeout;\n\n    /* Built-in method references for those with the same name as other `lodash` methods. */\n    var nativeCeil = Math.ceil,\n        nativeFloor = Math.floor,\n        nativeGetSymbols = Object.getOwnPropertySymbols,\n        nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined,\n        nativeIsFinite = context.isFinite,\n        nativeJoin = arrayProto.join,\n        nativeKeys = overArg(Object.keys, Object),\n        nativeMax = Math.max,\n        nativeMin = Math.min,\n        nativeNow = Date.now,\n        nativeParseInt = context.parseInt,\n        nativeRandom = Math.random,\n        nativeReverse = arrayProto.reverse;\n\n    /* Built-in method references that are verified to be native. */\n    var DataView = getNative(context, 'DataView'),\n        Map = getNative(context, 'Map'),\n        Promise = getNative(context, 'Promise'),\n        Set = getNative(context, 'Set'),\n        WeakMap = getNative(context, 'WeakMap'),\n        nativeCreate = getNative(Object, 'create');\n\n    /** Used to store function metadata. */\n    var metaMap = WeakMap && new WeakMap;\n\n    /** Used to lookup unminified function names. */\n    var realNames = {};\n\n    /** Used to detect maps, sets, and weakmaps. */\n    var dataViewCtorString = toSource(DataView),\n        mapCtorString = toSource(Map),\n        promiseCtorString = toSource(Promise),\n        setCtorString = toSource(Set),\n        weakMapCtorString = toSource(WeakMap);\n\n    /** Used to convert symbols to primitives and strings. */\n    var symbolProto = Symbol ? Symbol.prototype : undefined,\n        symbolValueOf = symbolProto ? symbolProto.valueOf : undefined,\n        symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates a `lodash` object which wraps `value` to enable implicit method\n     * chain sequences. Methods that operate on and return arrays, collections,\n     * and functions can be chained together. Methods that retrieve a single value\n     * or may return a primitive value will automatically end the chain sequence\n     * and return the unwrapped value. Otherwise, the value must be unwrapped\n     * with `_#value`.\n     *\n     * Explicit chain sequences, which must be unwrapped with `_#value`, may be\n     * enabled using `_.chain`.\n     *\n     * The execution of chained methods is lazy, that is, it's deferred until\n     * `_#value` is implicitly or explicitly called.\n     *\n     * Lazy evaluation allows several methods to support shortcut fusion.\n     * Shortcut fusion is an optimization to merge iteratee calls; this avoids\n     * the creation of intermediate arrays and can greatly reduce the number of\n     * iteratee executions. Sections of a chain sequence qualify for shortcut\n     * fusion if the section is applied to an array and iteratees accept only\n     * one argument. The heuristic for whether a section qualifies for shortcut\n     * fusion is subject to change.\n     *\n     * Chaining is supported in custom builds as long as the `_#value` method is\n     * directly or indirectly included in the build.\n     *\n     * In addition to lodash methods, wrappers have `Array` and `String` methods.\n     *\n     * The wrapper `Array` methods are:\n     * `concat`, `join`, `pop`, `push`, `shift`, `sort`, `splice`, and `unshift`\n     *\n     * The wrapper `String` methods are:\n     * `replace` and `split`\n     *\n     * The wrapper methods that support shortcut fusion are:\n     * `at`, `compact`, `drop`, `dropRight`, `dropWhile`, `filter`, `find`,\n     * `findLast`, `head`, `initial`, `last`, `map`, `reject`, `reverse`, `slice`,\n     * `tail`, `take`, `takeRight`, `takeRightWhile`, `takeWhile`, and `toArray`\n     *\n     * The chainable wrapper methods are:\n     * `after`, `ary`, `assign`, `assignIn`, `assignInWith`, `assignWith`, `at`,\n     * `before`, `bind`, `bindAll`, `bindKey`, `castArray`, `chain`, `chunk`,\n     * `commit`, `compact`, `concat`, `conforms`, `constant`, `countBy`, `create`,\n     * `curry`, `debounce`, `defaults`, `defaultsDeep`, `defer`, `delay`,\n     * `difference`, `differenceBy`, `differenceWith`, `drop`, `dropRight`,\n     * `dropRightWhile`, `dropWhile`, `extend`, `extendWith`, `fill`, `filter`,\n     * `flatMap`, `flatMapDeep`, `flatMapDepth`, `flatten`, `flattenDeep`,\n     * `flattenDepth`, `flip`, `flow`, `flowRight`, `fromPairs`, `functions`,\n     * `functionsIn`, `groupBy`, `initial`, `intersection`, `intersectionBy`,\n     * `intersectionWith`, `invert`, `invertBy`, `invokeMap`, `iteratee`, `keyBy`,\n     * `keys`, `keysIn`, `map`, `mapKeys`, `mapValues`, `matches`, `matchesProperty`,\n     * `memoize`, `merge`, `mergeWith`, `method`, `methodOf`, `mixin`, `negate`,\n     * `nthArg`, `omit`, `omitBy`, `once`, `orderBy`, `over`, `overArgs`,\n     * `overEvery`, `overSome`, `partial`, `partialRight`, `partition`, `pick`,\n     * `pickBy`, `plant`, `property`, `propertyOf`, `pull`, `pullAll`, `pullAllBy`,\n     * `pullAllWith`, `pullAt`, `push`, `range`, `rangeRight`, `rearg`, `reject`,\n     * `remove`, `rest`, `reverse`, `sampleSize`, `set`, `setWith`, `shuffle`,\n     * `slice`, `sort`, `sortBy`, `splice`, `spread`, `tail`, `take`, `takeRight`,\n     * `takeRightWhile`, `takeWhile`, `tap`, `throttle`, `thru`, `toArray`,\n     * `toPairs`, `toPairsIn`, `toPath`, `toPlainObject`, `transform`, `unary`,\n     * `union`, `unionBy`, `unionWith`, `uniq`, `uniqBy`, `uniqWith`, `unset`,\n     * `unshift`, `unzip`, `unzipWith`, `update`, `updateWith`, `values`,\n     * `valuesIn`, `without`, `wrap`, `xor`, `xorBy`, `xorWith`, `zip`,\n     * `zipObject`, `zipObjectDeep`, and `zipWith`\n     *\n     * The wrapper methods that are **not** chainable by default are:\n     * `add`, `attempt`, `camelCase`, `capitalize`, `ceil`, `clamp`, `clone`,\n     * `cloneDeep`, `cloneDeepWith`, `cloneWith`, `conformsTo`, `deburr`,\n     * `defaultTo`, `divide`, `each`, `eachRight`, `endsWith`, `eq`, `escape`,\n     * `escapeRegExp`, `every`, `find`, `findIndex`, `findKey`, `findLast`,\n     * `findLastIndex`, `findLastKey`, `first`, `floor`, `forEach`, `forEachRight`,\n     * `forIn`, `forInRight`, `forOwn`, `forOwnRight`, `get`, `gt`, `gte`, `has`,\n     * `hasIn`, `head`, `identity`, `includes`, `indexOf`, `inRange`, `invoke`,\n     * `isArguments`, `isArray`, `isArrayBuffer`, `isArrayLike`, `isArrayLikeObject`,\n     * `isBoolean`, `isBuffer`, `isDate`, `isElement`, `isEmpty`, `isEqual`,\n     * `isEqualWith`, `isError`, `isFinite`, `isFunction`, `isInteger`, `isLength`,\n     * `isMap`, `isMatch`, `isMatchWith`, `isNaN`, `isNative`, `isNil`, `isNull`,\n     * `isNumber`, `isObject`, `isObjectLike`, `isPlainObject`, `isRegExp`,\n     * `isSafeInteger`, `isSet`, `isString`, `isUndefined`, `isTypedArray`,\n     * `isWeakMap`, `isWeakSet`, `join`, `kebabCase`, `last`, `lastIndexOf`,\n     * `lowerCase`, `lowerFirst`, `lt`, `lte`, `max`, `maxBy`, `mean`, `meanBy`,\n     * `min`, `minBy`, `multiply`, `noConflict`, `noop`, `now`, `nth`, `pad`,\n     * `padEnd`, `padStart`, `parseInt`, `pop`, `random`, `reduce`, `reduceRight`,\n     * `repeat`, `result`, `round`, `runInContext`, `sample`, `shift`, `size`,\n     * `snakeCase`, `some`, `sortedIndex`, `sortedIndexBy`, `sortedLastIndex`,\n     * `sortedLastIndexBy`, `startCase`, `startsWith`, `stubArray`, `stubFalse`,\n     * `stubObject`, `stubString`, `stubTrue`, `subtract`, `sum`, `sumBy`,\n     * `template`, `times`, `toFinite`, `toInteger`, `toJSON`, `toLength`,\n     * `toLower`, `toNumber`, `toSafeInteger`, `toString`, `toUpper`, `trim`,\n     * `trimEnd`, `trimStart`, `truncate`, `unescape`, `uniqueId`, `upperCase`,\n     * `upperFirst`, `value`, and `words`\n     *\n     * @name _\n     * @constructor\n     * @category Seq\n     * @param {*} value The value to wrap in a `lodash` instance.\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * function square(n) {\n     *   return n * n;\n     * }\n     *\n     * var wrapped = _([1, 2, 3]);\n     *\n     * // Returns an unwrapped value.\n     * wrapped.reduce(_.add);\n     * // => 6\n     *\n     * // Returns a wrapped value.\n     * var squares = wrapped.map(square);\n     *\n     * _.isArray(squares);\n     * // => false\n     *\n     * _.isArray(squares.value());\n     * // => true\n     */\n    function lodash(value) {\n      if (isObjectLike(value) && !isArray(value) && !(value instanceof LazyWrapper)) {\n        if (value instanceof LodashWrapper) {\n          return value;\n        }\n        if (hasOwnProperty.call(value, '__wrapped__')) {\n          return wrapperClone(value);\n        }\n      }\n      return new LodashWrapper(value);\n    }\n\n    /**\n     * The base implementation of `_.create` without support for assigning\n     * properties to the created object.\n     *\n     * @private\n     * @param {Object} proto The object to inherit from.\n     * @returns {Object} Returns the new object.\n     */\n    var baseCreate = (function() {\n      function object() {}\n      return function(proto) {\n        if (!isObject(proto)) {\n          return {};\n        }\n        if (objectCreate) {\n          return objectCreate(proto);\n        }\n        object.prototype = proto;\n        var result = new object;\n        object.prototype = undefined;\n        return result;\n      };\n    }());\n\n    /**\n     * The function whose prototype chain sequence wrappers inherit from.\n     *\n     * @private\n     */\n    function baseLodash() {\n      // No operation performed.\n    }\n\n    /**\n     * The base constructor for creating `lodash` wrapper objects.\n     *\n     * @private\n     * @param {*} value The value to wrap.\n     * @param {boolean} [chainAll] Enable explicit method chain sequences.\n     */\n    function LodashWrapper(value, chainAll) {\n      this.__wrapped__ = value;\n      this.__actions__ = [];\n      this.__chain__ = !!chainAll;\n      this.__index__ = 0;\n      this.__values__ = undefined;\n    }\n\n    /**\n     * By default, the template delimiters used by lodash are like those in\n     * embedded Ruby (ERB) as well as ES2015 template strings. Change the\n     * following template settings to use alternative delimiters.\n     *\n     * @static\n     * @memberOf _\n     * @type {Object}\n     */\n    lodash.templateSettings = {\n\n      /**\n       * Used to detect `data` property values to be HTML-escaped.\n       *\n       * @memberOf _.templateSettings\n       * @type {RegExp}\n       */\n      'escape': reEscape,\n\n      /**\n       * Used to detect code to be evaluated.\n       *\n       * @memberOf _.templateSettings\n       * @type {RegExp}\n       */\n      'evaluate': reEvaluate,\n\n      /**\n       * Used to detect `data` property values to inject.\n       *\n       * @memberOf _.templateSettings\n       * @type {RegExp}\n       */\n      'interpolate': reInterpolate,\n\n      /**\n       * Used to reference the data object in the template text.\n       *\n       * @memberOf _.templateSettings\n       * @type {string}\n       */\n      'variable': '',\n\n      /**\n       * Used to import variables into the compiled template.\n       *\n       * @memberOf _.templateSettings\n       * @type {Object}\n       */\n      'imports': {\n\n        /**\n         * A reference to the `lodash` function.\n         *\n         * @memberOf _.templateSettings.imports\n         * @type {Function}\n         */\n        '_': lodash\n      }\n    };\n\n    // Ensure wrappers are instances of `baseLodash`.\n    lodash.prototype = baseLodash.prototype;\n    lodash.prototype.constructor = lodash;\n\n    LodashWrapper.prototype = baseCreate(baseLodash.prototype);\n    LodashWrapper.prototype.constructor = LodashWrapper;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates a lazy wrapper object which wraps `value` to enable lazy evaluation.\n     *\n     * @private\n     * @constructor\n     * @param {*} value The value to wrap.\n     */\n    function LazyWrapper(value) {\n      this.__wrapped__ = value;\n      this.__actions__ = [];\n      this.__dir__ = 1;\n      this.__filtered__ = false;\n      this.__iteratees__ = [];\n      this.__takeCount__ = MAX_ARRAY_LENGTH;\n      this.__views__ = [];\n    }\n\n    /**\n     * Creates a clone of the lazy wrapper object.\n     *\n     * @private\n     * @name clone\n     * @memberOf LazyWrapper\n     * @returns {Object} Returns the cloned `LazyWrapper` object.\n     */\n    function lazyClone() {\n      var result = new LazyWrapper(this.__wrapped__);\n      result.__actions__ = copyArray(this.__actions__);\n      result.__dir__ = this.__dir__;\n      result.__filtered__ = this.__filtered__;\n      result.__iteratees__ = copyArray(this.__iteratees__);\n      result.__takeCount__ = this.__takeCount__;\n      result.__views__ = copyArray(this.__views__);\n      return result;\n    }\n\n    /**\n     * Reverses the direction of lazy iteration.\n     *\n     * @private\n     * @name reverse\n     * @memberOf LazyWrapper\n     * @returns {Object} Returns the new reversed `LazyWrapper` object.\n     */\n    function lazyReverse() {\n      if (this.__filtered__) {\n        var result = new LazyWrapper(this);\n        result.__dir__ = -1;\n        result.__filtered__ = true;\n      } else {\n        result = this.clone();\n        result.__dir__ *= -1;\n      }\n      return result;\n    }\n\n    /**\n     * Extracts the unwrapped value from its lazy wrapper.\n     *\n     * @private\n     * @name value\n     * @memberOf LazyWrapper\n     * @returns {*} Returns the unwrapped value.\n     */\n    function lazyValue() {\n      var array = this.__wrapped__.value(),\n          dir = this.__dir__,\n          isArr = isArray(array),\n          isRight = dir < 0,\n          arrLength = isArr ? array.length : 0,\n          view = getView(0, arrLength, this.__views__),\n          start = view.start,\n          end = view.end,\n          length = end - start,\n          index = isRight ? end : (start - 1),\n          iteratees = this.__iteratees__,\n          iterLength = iteratees.length,\n          resIndex = 0,\n          takeCount = nativeMin(length, this.__takeCount__);\n\n      if (!isArr || (!isRight && arrLength == length && takeCount == length)) {\n        return baseWrapperValue(array, this.__actions__);\n      }\n      var result = [];\n\n      outer:\n      while (length-- && resIndex < takeCount) {\n        index += dir;\n\n        var iterIndex = -1,\n            value = array[index];\n\n        while (++iterIndex < iterLength) {\n          var data = iteratees[iterIndex],\n              iteratee = data.iteratee,\n              type = data.type,\n              computed = iteratee(value);\n\n          if (type == LAZY_MAP_FLAG) {\n            value = computed;\n          } else if (!computed) {\n            if (type == LAZY_FILTER_FLAG) {\n              continue outer;\n            } else {\n              break outer;\n            }\n          }\n        }\n        result[resIndex++] = value;\n      }\n      return result;\n    }\n\n    // Ensure `LazyWrapper` is an instance of `baseLodash`.\n    LazyWrapper.prototype = baseCreate(baseLodash.prototype);\n    LazyWrapper.prototype.constructor = LazyWrapper;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates a hash object.\n     *\n     * @private\n     * @constructor\n     * @param {Array} [entries] The key-value pairs to cache.\n     */\n    function Hash(entries) {\n      var index = -1,\n          length = entries == null ? 0 : entries.length;\n\n      this.clear();\n      while (++index < length) {\n        var entry = entries[index];\n        this.set(entry[0], entry[1]);\n      }\n    }\n\n    /**\n     * Removes all key-value entries from the hash.\n     *\n     * @private\n     * @name clear\n     * @memberOf Hash\n     */\n    function hashClear() {\n      this.__data__ = nativeCreate ? nativeCreate(null) : {};\n      this.size = 0;\n    }\n\n    /**\n     * Removes `key` and its value from the hash.\n     *\n     * @private\n     * @name delete\n     * @memberOf Hash\n     * @param {Object} hash The hash to modify.\n     * @param {string} key The key of the value to remove.\n     * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n     */\n    function hashDelete(key) {\n      var result = this.has(key) && delete this.__data__[key];\n      this.size -= result ? 1 : 0;\n      return result;\n    }\n\n    /**\n     * Gets the hash value for `key`.\n     *\n     * @private\n     * @name get\n     * @memberOf Hash\n     * @param {string} key The key of the value to get.\n     * @returns {*} Returns the entry value.\n     */\n    function hashGet(key) {\n      var data = this.__data__;\n      if (nativeCreate) {\n        var result = data[key];\n        return result === HASH_UNDEFINED ? undefined : result;\n      }\n      return hasOwnProperty.call(data, key) ? data[key] : undefined;\n    }\n\n    /**\n     * Checks if a hash value for `key` exists.\n     *\n     * @private\n     * @name has\n     * @memberOf Hash\n     * @param {string} key The key of the entry to check.\n     * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n     */\n    function hashHas(key) {\n      var data = this.__data__;\n      return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n    }\n\n    /**\n     * Sets the hash `key` to `value`.\n     *\n     * @private\n     * @name set\n     * @memberOf Hash\n     * @param {string} key The key of the value to set.\n     * @param {*} value The value to set.\n     * @returns {Object} Returns the hash instance.\n     */\n    function hashSet(key, value) {\n      var data = this.__data__;\n      this.size += this.has(key) ? 0 : 1;\n      data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n      return this;\n    }\n\n    // Add methods to `Hash`.\n    Hash.prototype.clear = hashClear;\n    Hash.prototype['delete'] = hashDelete;\n    Hash.prototype.get = hashGet;\n    Hash.prototype.has = hashHas;\n    Hash.prototype.set = hashSet;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates an list cache object.\n     *\n     * @private\n     * @constructor\n     * @param {Array} [entries] The key-value pairs to cache.\n     */\n    function ListCache(entries) {\n      var index = -1,\n          length = entries == null ? 0 : entries.length;\n\n      this.clear();\n      while (++index < length) {\n        var entry = entries[index];\n        this.set(entry[0], entry[1]);\n      }\n    }\n\n    /**\n     * Removes all key-value entries from the list cache.\n     *\n     * @private\n     * @name clear\n     * @memberOf ListCache\n     */\n    function listCacheClear() {\n      this.__data__ = [];\n      this.size = 0;\n    }\n\n    /**\n     * Removes `key` and its value from the list cache.\n     *\n     * @private\n     * @name delete\n     * @memberOf ListCache\n     * @param {string} key The key of the value to remove.\n     * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n     */\n    function listCacheDelete(key) {\n      var data = this.__data__,\n          index = assocIndexOf(data, key);\n\n      if (index < 0) {\n        return false;\n      }\n      var lastIndex = data.length - 1;\n      if (index == lastIndex) {\n        data.pop();\n      } else {\n        splice.call(data, index, 1);\n      }\n      --this.size;\n      return true;\n    }\n\n    /**\n     * Gets the list cache value for `key`.\n     *\n     * @private\n     * @name get\n     * @memberOf ListCache\n     * @param {string} key The key of the value to get.\n     * @returns {*} Returns the entry value.\n     */\n    function listCacheGet(key) {\n      var data = this.__data__,\n          index = assocIndexOf(data, key);\n\n      return index < 0 ? undefined : data[index][1];\n    }\n\n    /**\n     * Checks if a list cache value for `key` exists.\n     *\n     * @private\n     * @name has\n     * @memberOf ListCache\n     * @param {string} key The key of the entry to check.\n     * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n     */\n    function listCacheHas(key) {\n      return assocIndexOf(this.__data__, key) > -1;\n    }\n\n    /**\n     * Sets the list cache `key` to `value`.\n     *\n     * @private\n     * @name set\n     * @memberOf ListCache\n     * @param {string} key The key of the value to set.\n     * @param {*} value The value to set.\n     * @returns {Object} Returns the list cache instance.\n     */\n    function listCacheSet(key, value) {\n      var data = this.__data__,\n          index = assocIndexOf(data, key);\n\n      if (index < 0) {\n        ++this.size;\n        data.push([key, value]);\n      } else {\n        data[index][1] = value;\n      }\n      return this;\n    }\n\n    // Add methods to `ListCache`.\n    ListCache.prototype.clear = listCacheClear;\n    ListCache.prototype['delete'] = listCacheDelete;\n    ListCache.prototype.get = listCacheGet;\n    ListCache.prototype.has = listCacheHas;\n    ListCache.prototype.set = listCacheSet;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates a map cache object to store key-value pairs.\n     *\n     * @private\n     * @constructor\n     * @param {Array} [entries] The key-value pairs to cache.\n     */\n    function MapCache(entries) {\n      var index = -1,\n          length = entries == null ? 0 : entries.length;\n\n      this.clear();\n      while (++index < length) {\n        var entry = entries[index];\n        this.set(entry[0], entry[1]);\n      }\n    }\n\n    /**\n     * Removes all key-value entries from the map.\n     *\n     * @private\n     * @name clear\n     * @memberOf MapCache\n     */\n    function mapCacheClear() {\n      this.size = 0;\n      this.__data__ = {\n        'hash': new Hash,\n        'map': new (Map || ListCache),\n        'string': new Hash\n      };\n    }\n\n    /**\n     * Removes `key` and its value from the map.\n     *\n     * @private\n     * @name delete\n     * @memberOf MapCache\n     * @param {string} key The key of the value to remove.\n     * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n     */\n    function mapCacheDelete(key) {\n      var result = getMapData(this, key)['delete'](key);\n      this.size -= result ? 1 : 0;\n      return result;\n    }\n\n    /**\n     * Gets the map value for `key`.\n     *\n     * @private\n     * @name get\n     * @memberOf MapCache\n     * @param {string} key The key of the value to get.\n     * @returns {*} Returns the entry value.\n     */\n    function mapCacheGet(key) {\n      return getMapData(this, key).get(key);\n    }\n\n    /**\n     * Checks if a map value for `key` exists.\n     *\n     * @private\n     * @name has\n     * @memberOf MapCache\n     * @param {string} key The key of the entry to check.\n     * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n     */\n    function mapCacheHas(key) {\n      return getMapData(this, key).has(key);\n    }\n\n    /**\n     * Sets the map `key` to `value`.\n     *\n     * @private\n     * @name set\n     * @memberOf MapCache\n     * @param {string} key The key of the value to set.\n     * @param {*} value The value to set.\n     * @returns {Object} Returns the map cache instance.\n     */\n    function mapCacheSet(key, value) {\n      var data = getMapData(this, key),\n          size = data.size;\n\n      data.set(key, value);\n      this.size += data.size == size ? 0 : 1;\n      return this;\n    }\n\n    // Add methods to `MapCache`.\n    MapCache.prototype.clear = mapCacheClear;\n    MapCache.prototype['delete'] = mapCacheDelete;\n    MapCache.prototype.get = mapCacheGet;\n    MapCache.prototype.has = mapCacheHas;\n    MapCache.prototype.set = mapCacheSet;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     *\n     * Creates an array cache object to store unique values.\n     *\n     * @private\n     * @constructor\n     * @param {Array} [values] The values to cache.\n     */\n    function SetCache(values) {\n      var index = -1,\n          length = values == null ? 0 : values.length;\n\n      this.__data__ = new MapCache;\n      while (++index < length) {\n        this.add(values[index]);\n      }\n    }\n\n    /**\n     * Adds `value` to the array cache.\n     *\n     * @private\n     * @name add\n     * @memberOf SetCache\n     * @alias push\n     * @param {*} value The value to cache.\n     * @returns {Object} Returns the cache instance.\n     */\n    function setCacheAdd(value) {\n      this.__data__.set(value, HASH_UNDEFINED);\n      return this;\n    }\n\n    /**\n     * Checks if `value` is in the array cache.\n     *\n     * @private\n     * @name has\n     * @memberOf SetCache\n     * @param {*} value The value to search for.\n     * @returns {number} Returns `true` if `value` is found, else `false`.\n     */\n    function setCacheHas(value) {\n      return this.__data__.has(value);\n    }\n\n    // Add methods to `SetCache`.\n    SetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\n    SetCache.prototype.has = setCacheHas;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates a stack cache object to store key-value pairs.\n     *\n     * @private\n     * @constructor\n     * @param {Array} [entries] The key-value pairs to cache.\n     */\n    function Stack(entries) {\n      var data = this.__data__ = new ListCache(entries);\n      this.size = data.size;\n    }\n\n    /**\n     * Removes all key-value entries from the stack.\n     *\n     * @private\n     * @name clear\n     * @memberOf Stack\n     */\n    function stackClear() {\n      this.__data__ = new ListCache;\n      this.size = 0;\n    }\n\n    /**\n     * Removes `key` and its value from the stack.\n     *\n     * @private\n     * @name delete\n     * @memberOf Stack\n     * @param {string} key The key of the value to remove.\n     * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n     */\n    function stackDelete(key) {\n      var data = this.__data__,\n          result = data['delete'](key);\n\n      this.size = data.size;\n      return result;\n    }\n\n    /**\n     * Gets the stack value for `key`.\n     *\n     * @private\n     * @name get\n     * @memberOf Stack\n     * @param {string} key The key of the value to get.\n     * @returns {*} Returns the entry value.\n     */\n    function stackGet(key) {\n      return this.__data__.get(key);\n    }\n\n    /**\n     * Checks if a stack value for `key` exists.\n     *\n     * @private\n     * @name has\n     * @memberOf Stack\n     * @param {string} key The key of the entry to check.\n     * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n     */\n    function stackHas(key) {\n      return this.__data__.has(key);\n    }\n\n    /**\n     * Sets the stack `key` to `value`.\n     *\n     * @private\n     * @name set\n     * @memberOf Stack\n     * @param {string} key The key of the value to set.\n     * @param {*} value The value to set.\n     * @returns {Object} Returns the stack cache instance.\n     */\n    function stackSet(key, value) {\n      var data = this.__data__;\n      if (data instanceof ListCache) {\n        var pairs = data.__data__;\n        if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n          pairs.push([key, value]);\n          this.size = ++data.size;\n          return this;\n        }\n        data = this.__data__ = new MapCache(pairs);\n      }\n      data.set(key, value);\n      this.size = data.size;\n      return this;\n    }\n\n    // Add methods to `Stack`.\n    Stack.prototype.clear = stackClear;\n    Stack.prototype['delete'] = stackDelete;\n    Stack.prototype.get = stackGet;\n    Stack.prototype.has = stackHas;\n    Stack.prototype.set = stackSet;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates an array of the enumerable property names of the array-like `value`.\n     *\n     * @private\n     * @param {*} value The value to query.\n     * @param {boolean} inherited Specify returning inherited property names.\n     * @returns {Array} Returns the array of property names.\n     */\n    function arrayLikeKeys(value, inherited) {\n      var isArr = isArray(value),\n          isArg = !isArr && isArguments(value),\n          isBuff = !isArr && !isArg && isBuffer(value),\n          isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n          skipIndexes = isArr || isArg || isBuff || isType,\n          result = skipIndexes ? baseTimes(value.length, String) : [],\n          length = result.length;\n\n      for (var key in value) {\n        if ((inherited || hasOwnProperty.call(value, key)) &&\n            !(skipIndexes && (\n               // Safari 9 has enumerable `arguments.length` in strict mode.\n               key == 'length' ||\n               // Node.js 0.10 has enumerable non-index properties on buffers.\n               (isBuff && (key == 'offset' || key == 'parent')) ||\n               // PhantomJS 2 has enumerable non-index properties on typed arrays.\n               (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n               // Skip index properties.\n               isIndex(key, length)\n            ))) {\n          result.push(key);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * A specialized version of `_.sample` for arrays.\n     *\n     * @private\n     * @param {Array} array The array to sample.\n     * @returns {*} Returns the random element.\n     */\n    function arraySample(array) {\n      var length = array.length;\n      return length ? array[baseRandom(0, length - 1)] : undefined;\n    }\n\n    /**\n     * A specialized version of `_.sampleSize` for arrays.\n     *\n     * @private\n     * @param {Array} array The array to sample.\n     * @param {number} n The number of elements to sample.\n     * @returns {Array} Returns the random elements.\n     */\n    function arraySampleSize(array, n) {\n      return shuffleSelf(copyArray(array), baseClamp(n, 0, array.length));\n    }\n\n    /**\n     * A specialized version of `_.shuffle` for arrays.\n     *\n     * @private\n     * @param {Array} array The array to shuffle.\n     * @returns {Array} Returns the new shuffled array.\n     */\n    function arrayShuffle(array) {\n      return shuffleSelf(copyArray(array));\n    }\n\n    /**\n     * This function is like `assignValue` except that it doesn't assign\n     * `undefined` values.\n     *\n     * @private\n     * @param {Object} object The object to modify.\n     * @param {string} key The key of the property to assign.\n     * @param {*} value The value to assign.\n     */\n    function assignMergeValue(object, key, value) {\n      if ((value !== undefined && !eq(object[key], value)) ||\n          (value === undefined && !(key in object))) {\n        baseAssignValue(object, key, value);\n      }\n    }\n\n    /**\n     * Assigns `value` to `key` of `object` if the existing value is not equivalent\n     * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons.\n     *\n     * @private\n     * @param {Object} object The object to modify.\n     * @param {string} key The key of the property to assign.\n     * @param {*} value The value to assign.\n     */\n    function assignValue(object, key, value) {\n      var objValue = object[key];\n      if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n          (value === undefined && !(key in object))) {\n        baseAssignValue(object, key, value);\n      }\n    }\n\n    /**\n     * Gets the index at which the `key` is found in `array` of key-value pairs.\n     *\n     * @private\n     * @param {Array} array The array to inspect.\n     * @param {*} key The key to search for.\n     * @returns {number} Returns the index of the matched value, else `-1`.\n     */\n    function assocIndexOf(array, key) {\n      var length = array.length;\n      while (length--) {\n        if (eq(array[length][0], key)) {\n          return length;\n        }\n      }\n      return -1;\n    }\n\n    /**\n     * Aggregates elements of `collection` on `accumulator` with keys transformed\n     * by `iteratee` and values set by `setter`.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} setter The function to set `accumulator` values.\n     * @param {Function} iteratee The iteratee to transform keys.\n     * @param {Object} accumulator The initial aggregated object.\n     * @returns {Function} Returns `accumulator`.\n     */\n    function baseAggregator(collection, setter, iteratee, accumulator) {\n      baseEach(collection, function(value, key, collection) {\n        setter(accumulator, value, iteratee(value), collection);\n      });\n      return accumulator;\n    }\n\n    /**\n     * The base implementation of `_.assign` without support for multiple sources\n     * or `customizer` functions.\n     *\n     * @private\n     * @param {Object} object The destination object.\n     * @param {Object} source The source object.\n     * @returns {Object} Returns `object`.\n     */\n    function baseAssign(object, source) {\n      return object && copyObject(source, keys(source), object);\n    }\n\n    /**\n     * The base implementation of `_.assignIn` without support for multiple sources\n     * or `customizer` functions.\n     *\n     * @private\n     * @param {Object} object The destination object.\n     * @param {Object} source The source object.\n     * @returns {Object} Returns `object`.\n     */\n    function baseAssignIn(object, source) {\n      return object && copyObject(source, keysIn(source), object);\n    }\n\n    /**\n     * The base implementation of `assignValue` and `assignMergeValue` without\n     * value checks.\n     *\n     * @private\n     * @param {Object} object The object to modify.\n     * @param {string} key The key of the property to assign.\n     * @param {*} value The value to assign.\n     */\n    function baseAssignValue(object, key, value) {\n      if (key == '__proto__' && defineProperty) {\n        defineProperty(object, key, {\n          'configurable': true,\n          'enumerable': true,\n          'value': value,\n          'writable': true\n        });\n      } else {\n        object[key] = value;\n      }\n    }\n\n    /**\n     * The base implementation of `_.at` without support for individual paths.\n     *\n     * @private\n     * @param {Object} object The object to iterate over.\n     * @param {string[]} paths The property paths to pick.\n     * @returns {Array} Returns the picked elements.\n     */\n    function baseAt(object, paths) {\n      var index = -1,\n          length = paths.length,\n          result = Array(length),\n          skip = object == null;\n\n      while (++index < length) {\n        result[index] = skip ? undefined : get(object, paths[index]);\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.clamp` which doesn't coerce arguments.\n     *\n     * @private\n     * @param {number} number The number to clamp.\n     * @param {number} [lower] The lower bound.\n     * @param {number} upper The upper bound.\n     * @returns {number} Returns the clamped number.\n     */\n    function baseClamp(number, lower, upper) {\n      if (number === number) {\n        if (upper !== undefined) {\n          number = number <= upper ? number : upper;\n        }\n        if (lower !== undefined) {\n          number = number >= lower ? number : lower;\n        }\n      }\n      return number;\n    }\n\n    /**\n     * The base implementation of `_.clone` and `_.cloneDeep` which tracks\n     * traversed objects.\n     *\n     * @private\n     * @param {*} value The value to clone.\n     * @param {boolean} bitmask The bitmask flags.\n     *  1 - Deep clone\n     *  2 - Flatten inherited properties\n     *  4 - Clone symbols\n     * @param {Function} [customizer] The function to customize cloning.\n     * @param {string} [key] The key of `value`.\n     * @param {Object} [object] The parent object of `value`.\n     * @param {Object} [stack] Tracks traversed objects and their clone counterparts.\n     * @returns {*} Returns the cloned value.\n     */\n    function baseClone(value, bitmask, customizer, key, object, stack) {\n      var result,\n          isDeep = bitmask & CLONE_DEEP_FLAG,\n          isFlat = bitmask & CLONE_FLAT_FLAG,\n          isFull = bitmask & CLONE_SYMBOLS_FLAG;\n\n      if (customizer) {\n        result = object ? customizer(value, key, object, stack) : customizer(value);\n      }\n      if (result !== undefined) {\n        return result;\n      }\n      if (!isObject(value)) {\n        return value;\n      }\n      var isArr = isArray(value);\n      if (isArr) {\n        result = initCloneArray(value);\n        if (!isDeep) {\n          return copyArray(value, result);\n        }\n      } else {\n        var tag = getTag(value),\n            isFunc = tag == funcTag || tag == genTag;\n\n        if (isBuffer(value)) {\n          return cloneBuffer(value, isDeep);\n        }\n        if (tag == objectTag || tag == argsTag || (isFunc && !object)) {\n          result = (isFlat || isFunc) ? {} : initCloneObject(value);\n          if (!isDeep) {\n            return isFlat\n              ? copySymbolsIn(value, baseAssignIn(result, value))\n              : copySymbols(value, baseAssign(result, value));\n          }\n        } else {\n          if (!cloneableTags[tag]) {\n            return object ? value : {};\n          }\n          result = initCloneByTag(value, tag, isDeep);\n        }\n      }\n      // Check for circular references and return its corresponding clone.\n      stack || (stack = new Stack);\n      var stacked = stack.get(value);\n      if (stacked) {\n        return stacked;\n      }\n      stack.set(value, result);\n\n      if (isSet(value)) {\n        value.forEach(function(subValue) {\n          result.add(baseClone(subValue, bitmask, customizer, subValue, value, stack));\n        });\n      } else if (isMap(value)) {\n        value.forEach(function(subValue, key) {\n          result.set(key, baseClone(subValue, bitmask, customizer, key, value, stack));\n        });\n      }\n\n      var keysFunc = isFull\n        ? (isFlat ? getAllKeysIn : getAllKeys)\n        : (isFlat ? keysIn : keys);\n\n      var props = isArr ? undefined : keysFunc(value);\n      arrayEach(props || value, function(subValue, key) {\n        if (props) {\n          key = subValue;\n          subValue = value[key];\n        }\n        // Recursively populate clone (susceptible to call stack limits).\n        assignValue(result, key, baseClone(subValue, bitmask, customizer, key, value, stack));\n      });\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.conforms` which doesn't clone `source`.\n     *\n     * @private\n     * @param {Object} source The object of property predicates to conform to.\n     * @returns {Function} Returns the new spec function.\n     */\n    function baseConforms(source) {\n      var props = keys(source);\n      return function(object) {\n        return baseConformsTo(object, source, props);\n      };\n    }\n\n    /**\n     * The base implementation of `_.conformsTo` which accepts `props` to check.\n     *\n     * @private\n     * @param {Object} object The object to inspect.\n     * @param {Object} source The object of property predicates to conform to.\n     * @returns {boolean} Returns `true` if `object` conforms, else `false`.\n     */\n    function baseConformsTo(object, source, props) {\n      var length = props.length;\n      if (object == null) {\n        return !length;\n      }\n      object = Object(object);\n      while (length--) {\n        var key = props[length],\n            predicate = source[key],\n            value = object[key];\n\n        if ((value === undefined && !(key in object)) || !predicate(value)) {\n          return false;\n        }\n      }\n      return true;\n    }\n\n    /**\n     * The base implementation of `_.delay` and `_.defer` which accepts `args`\n     * to provide to `func`.\n     *\n     * @private\n     * @param {Function} func The function to delay.\n     * @param {number} wait The number of milliseconds to delay invocation.\n     * @param {Array} args The arguments to provide to `func`.\n     * @returns {number|Object} Returns the timer id or timeout object.\n     */\n    function baseDelay(func, wait, args) {\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      return setTimeout(function() { func.apply(undefined, args); }, wait);\n    }\n\n    /**\n     * The base implementation of methods like `_.difference` without support\n     * for excluding multiple arrays or iteratee shorthands.\n     *\n     * @private\n     * @param {Array} array The array to inspect.\n     * @param {Array} values The values to exclude.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of filtered values.\n     */\n    function baseDifference(array, values, iteratee, comparator) {\n      var index = -1,\n          includes = arrayIncludes,\n          isCommon = true,\n          length = array.length,\n          result = [],\n          valuesLength = values.length;\n\n      if (!length) {\n        return result;\n      }\n      if (iteratee) {\n        values = arrayMap(values, baseUnary(iteratee));\n      }\n      if (comparator) {\n        includes = arrayIncludesWith;\n        isCommon = false;\n      }\n      else if (values.length >= LARGE_ARRAY_SIZE) {\n        includes = cacheHas;\n        isCommon = false;\n        values = new SetCache(values);\n      }\n      outer:\n      while (++index < length) {\n        var value = array[index],\n            computed = iteratee == null ? value : iteratee(value);\n\n        value = (comparator || value !== 0) ? value : 0;\n        if (isCommon && computed === computed) {\n          var valuesIndex = valuesLength;\n          while (valuesIndex--) {\n            if (values[valuesIndex] === computed) {\n              continue outer;\n            }\n          }\n          result.push(value);\n        }\n        else if (!includes(values, computed, comparator)) {\n          result.push(value);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.forEach` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @returns {Array|Object} Returns `collection`.\n     */\n    var baseEach = createBaseEach(baseForOwn);\n\n    /**\n     * The base implementation of `_.forEachRight` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @returns {Array|Object} Returns `collection`.\n     */\n    var baseEachRight = createBaseEach(baseForOwnRight, true);\n\n    /**\n     * The base implementation of `_.every` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} predicate The function invoked per iteration.\n     * @returns {boolean} Returns `true` if all elements pass the predicate check,\n     *  else `false`\n     */\n    function baseEvery(collection, predicate) {\n      var result = true;\n      baseEach(collection, function(value, index, collection) {\n        result = !!predicate(value, index, collection);\n        return result;\n      });\n      return result;\n    }\n\n    /**\n     * The base implementation of methods like `_.max` and `_.min` which accepts a\n     * `comparator` to determine the extremum value.\n     *\n     * @private\n     * @param {Array} array The array to iterate over.\n     * @param {Function} iteratee The iteratee invoked per iteration.\n     * @param {Function} comparator The comparator used to compare values.\n     * @returns {*} Returns the extremum value.\n     */\n    function baseExtremum(array, iteratee, comparator) {\n      var index = -1,\n          length = array.length;\n\n      while (++index < length) {\n        var value = array[index],\n            current = iteratee(value);\n\n        if (current != null && (computed === undefined\n              ? (current === current && !isSymbol(current))\n              : comparator(current, computed)\n            )) {\n          var computed = current,\n              result = value;\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.fill` without an iteratee call guard.\n     *\n     * @private\n     * @param {Array} array The array to fill.\n     * @param {*} value The value to fill `array` with.\n     * @param {number} [start=0] The start position.\n     * @param {number} [end=array.length] The end position.\n     * @returns {Array} Returns `array`.\n     */\n    function baseFill(array, value, start, end) {\n      var length = array.length;\n\n      start = toInteger(start);\n      if (start < 0) {\n        start = -start > length ? 0 : (length + start);\n      }\n      end = (end === undefined || end > length) ? length : toInteger(end);\n      if (end < 0) {\n        end += length;\n      }\n      end = start > end ? 0 : toLength(end);\n      while (start < end) {\n        array[start++] = value;\n      }\n      return array;\n    }\n\n    /**\n     * The base implementation of `_.filter` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} predicate The function invoked per iteration.\n     * @returns {Array} Returns the new filtered array.\n     */\n    function baseFilter(collection, predicate) {\n      var result = [];\n      baseEach(collection, function(value, index, collection) {\n        if (predicate(value, index, collection)) {\n          result.push(value);\n        }\n      });\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.flatten` with support for restricting flattening.\n     *\n     * @private\n     * @param {Array} array The array to flatten.\n     * @param {number} depth The maximum recursion depth.\n     * @param {boolean} [predicate=isFlattenable] The function invoked per iteration.\n     * @param {boolean} [isStrict] Restrict to values that pass `predicate` checks.\n     * @param {Array} [result=[]] The initial result value.\n     * @returns {Array} Returns the new flattened array.\n     */\n    function baseFlatten(array, depth, predicate, isStrict, result) {\n      var index = -1,\n          length = array.length;\n\n      predicate || (predicate = isFlattenable);\n      result || (result = []);\n\n      while (++index < length) {\n        var value = array[index];\n        if (depth > 0 && predicate(value)) {\n          if (depth > 1) {\n            // Recursively flatten arrays (susceptible to call stack limits).\n            baseFlatten(value, depth - 1, predicate, isStrict, result);\n          } else {\n            arrayPush(result, value);\n          }\n        } else if (!isStrict) {\n          result[result.length] = value;\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `baseForOwn` which iterates over `object`\n     * properties returned by `keysFunc` and invokes `iteratee` for each property.\n     * Iteratee functions may exit iteration early by explicitly returning `false`.\n     *\n     * @private\n     * @param {Object} object The object to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @param {Function} keysFunc The function to get the keys of `object`.\n     * @returns {Object} Returns `object`.\n     */\n    var baseFor = createBaseFor();\n\n    /**\n     * This function is like `baseFor` except that it iterates over properties\n     * in the opposite order.\n     *\n     * @private\n     * @param {Object} object The object to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @param {Function} keysFunc The function to get the keys of `object`.\n     * @returns {Object} Returns `object`.\n     */\n    var baseForRight = createBaseFor(true);\n\n    /**\n     * The base implementation of `_.forOwn` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Object} object The object to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @returns {Object} Returns `object`.\n     */\n    function baseForOwn(object, iteratee) {\n      return object && baseFor(object, iteratee, keys);\n    }\n\n    /**\n     * The base implementation of `_.forOwnRight` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Object} object The object to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @returns {Object} Returns `object`.\n     */\n    function baseForOwnRight(object, iteratee) {\n      return object && baseForRight(object, iteratee, keys);\n    }\n\n    /**\n     * The base implementation of `_.functions` which creates an array of\n     * `object` function property names filtered from `props`.\n     *\n     * @private\n     * @param {Object} object The object to inspect.\n     * @param {Array} props The property names to filter.\n     * @returns {Array} Returns the function names.\n     */\n    function baseFunctions(object, props) {\n      return arrayFilter(props, function(key) {\n        return isFunction(object[key]);\n      });\n    }\n\n    /**\n     * The base implementation of `_.get` without support for default values.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path of the property to get.\n     * @returns {*} Returns the resolved value.\n     */\n    function baseGet(object, path) {\n      path = castPath(path, object);\n\n      var index = 0,\n          length = path.length;\n\n      while (object != null && index < length) {\n        object = object[toKey(path[index++])];\n      }\n      return (index && index == length) ? object : undefined;\n    }\n\n    /**\n     * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n     * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n     * symbols of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {Function} keysFunc The function to get the keys of `object`.\n     * @param {Function} symbolsFunc The function to get the symbols of `object`.\n     * @returns {Array} Returns the array of property names and symbols.\n     */\n    function baseGetAllKeys(object, keysFunc, symbolsFunc) {\n      var result = keysFunc(object);\n      return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n    }\n\n    /**\n     * The base implementation of `getTag` without fallbacks for buggy environments.\n     *\n     * @private\n     * @param {*} value The value to query.\n     * @returns {string} Returns the `toStringTag`.\n     */\n    function baseGetTag(value) {\n      if (value == null) {\n        return value === undefined ? undefinedTag : nullTag;\n      }\n      return (symToStringTag && symToStringTag in Object(value))\n        ? getRawTag(value)\n        : objectToString(value);\n    }\n\n    /**\n     * The base implementation of `_.gt` which doesn't coerce arguments.\n     *\n     * @private\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if `value` is greater than `other`,\n     *  else `false`.\n     */\n    function baseGt(value, other) {\n      return value > other;\n    }\n\n    /**\n     * The base implementation of `_.has` without support for deep paths.\n     *\n     * @private\n     * @param {Object} [object] The object to query.\n     * @param {Array|string} key The key to check.\n     * @returns {boolean} Returns `true` if `key` exists, else `false`.\n     */\n    function baseHas(object, key) {\n      return object != null && hasOwnProperty.call(object, key);\n    }\n\n    /**\n     * The base implementation of `_.hasIn` without support for deep paths.\n     *\n     * @private\n     * @param {Object} [object] The object to query.\n     * @param {Array|string} key The key to check.\n     * @returns {boolean} Returns `true` if `key` exists, else `false`.\n     */\n    function baseHasIn(object, key) {\n      return object != null && key in Object(object);\n    }\n\n    /**\n     * The base implementation of `_.inRange` which doesn't coerce arguments.\n     *\n     * @private\n     * @param {number} number The number to check.\n     * @param {number} start The start of the range.\n     * @param {number} end The end of the range.\n     * @returns {boolean} Returns `true` if `number` is in the range, else `false`.\n     */\n    function baseInRange(number, start, end) {\n      return number >= nativeMin(start, end) && number < nativeMax(start, end);\n    }\n\n    /**\n     * The base implementation of methods like `_.intersection`, without support\n     * for iteratee shorthands, that accepts an array of arrays to inspect.\n     *\n     * @private\n     * @param {Array} arrays The arrays to inspect.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of shared values.\n     */\n    function baseIntersection(arrays, iteratee, comparator) {\n      var includes = comparator ? arrayIncludesWith : arrayIncludes,\n          length = arrays[0].length,\n          othLength = arrays.length,\n          othIndex = othLength,\n          caches = Array(othLength),\n          maxLength = Infinity,\n          result = [];\n\n      while (othIndex--) {\n        var array = arrays[othIndex];\n        if (othIndex && iteratee) {\n          array = arrayMap(array, baseUnary(iteratee));\n        }\n        maxLength = nativeMin(array.length, maxLength);\n        caches[othIndex] = !comparator && (iteratee || (length >= 120 && array.length >= 120))\n          ? new SetCache(othIndex && array)\n          : undefined;\n      }\n      array = arrays[0];\n\n      var index = -1,\n          seen = caches[0];\n\n      outer:\n      while (++index < length && result.length < maxLength) {\n        var value = array[index],\n            computed = iteratee ? iteratee(value) : value;\n\n        value = (comparator || value !== 0) ? value : 0;\n        if (!(seen\n              ? cacheHas(seen, computed)\n              : includes(result, computed, comparator)\n            )) {\n          othIndex = othLength;\n          while (--othIndex) {\n            var cache = caches[othIndex];\n            if (!(cache\n                  ? cacheHas(cache, computed)\n                  : includes(arrays[othIndex], computed, comparator))\n                ) {\n              continue outer;\n            }\n          }\n          if (seen) {\n            seen.push(computed);\n          }\n          result.push(value);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.invert` and `_.invertBy` which inverts\n     * `object` with values transformed by `iteratee` and set by `setter`.\n     *\n     * @private\n     * @param {Object} object The object to iterate over.\n     * @param {Function} setter The function to set `accumulator` values.\n     * @param {Function} iteratee The iteratee to transform values.\n     * @param {Object} accumulator The initial inverted object.\n     * @returns {Function} Returns `accumulator`.\n     */\n    function baseInverter(object, setter, iteratee, accumulator) {\n      baseForOwn(object, function(value, key, object) {\n        setter(accumulator, iteratee(value), key, object);\n      });\n      return accumulator;\n    }\n\n    /**\n     * The base implementation of `_.invoke` without support for individual\n     * method arguments.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path of the method to invoke.\n     * @param {Array} args The arguments to invoke the method with.\n     * @returns {*} Returns the result of the invoked method.\n     */\n    function baseInvoke(object, path, args) {\n      path = castPath(path, object);\n      object = parent(object, path);\n      var func = object == null ? object : object[toKey(last(path))];\n      return func == null ? undefined : apply(func, object, args);\n    }\n\n    /**\n     * The base implementation of `_.isArguments`.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n     */\n    function baseIsArguments(value) {\n      return isObjectLike(value) && baseGetTag(value) == argsTag;\n    }\n\n    /**\n     * The base implementation of `_.isArrayBuffer` without Node.js optimizations.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an array buffer, else `false`.\n     */\n    function baseIsArrayBuffer(value) {\n      return isObjectLike(value) && baseGetTag(value) == arrayBufferTag;\n    }\n\n    /**\n     * The base implementation of `_.isDate` without Node.js optimizations.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a date object, else `false`.\n     */\n    function baseIsDate(value) {\n      return isObjectLike(value) && baseGetTag(value) == dateTag;\n    }\n\n    /**\n     * The base implementation of `_.isEqual` which supports partial comparisons\n     * and tracks traversed objects.\n     *\n     * @private\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @param {boolean} bitmask The bitmask flags.\n     *  1 - Unordered comparison\n     *  2 - Partial comparison\n     * @param {Function} [customizer] The function to customize comparisons.\n     * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n     * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n     */\n    function baseIsEqual(value, other, bitmask, customizer, stack) {\n      if (value === other) {\n        return true;\n      }\n      if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n        return value !== value && other !== other;\n      }\n      return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n    }\n\n    /**\n     * A specialized version of `baseIsEqual` for arrays and objects which performs\n     * deep comparisons and tracks traversed objects enabling objects with circular\n     * references to be compared.\n     *\n     * @private\n     * @param {Object} object The object to compare.\n     * @param {Object} other The other object to compare.\n     * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n     * @param {Function} customizer The function to customize comparisons.\n     * @param {Function} equalFunc The function to determine equivalents of values.\n     * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n     * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n     */\n    function baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {\n      var objIsArr = isArray(object),\n          othIsArr = isArray(other),\n          objTag = objIsArr ? arrayTag : getTag(object),\n          othTag = othIsArr ? arrayTag : getTag(other);\n\n      objTag = objTag == argsTag ? objectTag : objTag;\n      othTag = othTag == argsTag ? objectTag : othTag;\n\n      var objIsObj = objTag == objectTag,\n          othIsObj = othTag == objectTag,\n          isSameTag = objTag == othTag;\n\n      if (isSameTag && isBuffer(object)) {\n        if (!isBuffer(other)) {\n          return false;\n        }\n        objIsArr = true;\n        objIsObj = false;\n      }\n      if (isSameTag && !objIsObj) {\n        stack || (stack = new Stack);\n        return (objIsArr || isTypedArray(object))\n          ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n          : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n      }\n      if (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n        var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n            othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n        if (objIsWrapped || othIsWrapped) {\n          var objUnwrapped = objIsWrapped ? object.value() : object,\n              othUnwrapped = othIsWrapped ? other.value() : other;\n\n          stack || (stack = new Stack);\n          return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n        }\n      }\n      if (!isSameTag) {\n        return false;\n      }\n      stack || (stack = new Stack);\n      return equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n    }\n\n    /**\n     * The base implementation of `_.isMap` without Node.js optimizations.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a map, else `false`.\n     */\n    function baseIsMap(value) {\n      return isObjectLike(value) && getTag(value) == mapTag;\n    }\n\n    /**\n     * The base implementation of `_.isMatch` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Object} object The object to inspect.\n     * @param {Object} source The object of property values to match.\n     * @param {Array} matchData The property names, values, and compare flags to match.\n     * @param {Function} [customizer] The function to customize comparisons.\n     * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n     */\n    function baseIsMatch(object, source, matchData, customizer) {\n      var index = matchData.length,\n          length = index,\n          noCustomizer = !customizer;\n\n      if (object == null) {\n        return !length;\n      }\n      object = Object(object);\n      while (index--) {\n        var data = matchData[index];\n        if ((noCustomizer && data[2])\n              ? data[1] !== object[data[0]]\n              : !(data[0] in object)\n            ) {\n          return false;\n        }\n      }\n      while (++index < length) {\n        data = matchData[index];\n        var key = data[0],\n            objValue = object[key],\n            srcValue = data[1];\n\n        if (noCustomizer && data[2]) {\n          if (objValue === undefined && !(key in object)) {\n            return false;\n          }\n        } else {\n          var stack = new Stack;\n          if (customizer) {\n            var result = customizer(objValue, srcValue, key, object, source, stack);\n          }\n          if (!(result === undefined\n                ? baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG, customizer, stack)\n                : result\n              )) {\n            return false;\n          }\n        }\n      }\n      return true;\n    }\n\n    /**\n     * The base implementation of `_.isNative` without bad shim checks.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a native function,\n     *  else `false`.\n     */\n    function baseIsNative(value) {\n      if (!isObject(value) || isMasked(value)) {\n        return false;\n      }\n      var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n      return pattern.test(toSource(value));\n    }\n\n    /**\n     * The base implementation of `_.isRegExp` without Node.js optimizations.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a regexp, else `false`.\n     */\n    function baseIsRegExp(value) {\n      return isObjectLike(value) && baseGetTag(value) == regexpTag;\n    }\n\n    /**\n     * The base implementation of `_.isSet` without Node.js optimizations.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a set, else `false`.\n     */\n    function baseIsSet(value) {\n      return isObjectLike(value) && getTag(value) == setTag;\n    }\n\n    /**\n     * The base implementation of `_.isTypedArray` without Node.js optimizations.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n     */\n    function baseIsTypedArray(value) {\n      return isObjectLike(value) &&\n        isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n    }\n\n    /**\n     * The base implementation of `_.iteratee`.\n     *\n     * @private\n     * @param {*} [value=_.identity] The value to convert to an iteratee.\n     * @returns {Function} Returns the iteratee.\n     */\n    function baseIteratee(value) {\n      // Don't store the `typeof` result in a variable to avoid a JIT bug in Safari 9.\n      // See https://bugs.webkit.org/show_bug.cgi?id=156034 for more details.\n      if (typeof value == 'function') {\n        return value;\n      }\n      if (value == null) {\n        return identity;\n      }\n      if (typeof value == 'object') {\n        return isArray(value)\n          ? baseMatchesProperty(value[0], value[1])\n          : baseMatches(value);\n      }\n      return property(value);\n    }\n\n    /**\n     * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names.\n     */\n    function baseKeys(object) {\n      if (!isPrototype(object)) {\n        return nativeKeys(object);\n      }\n      var result = [];\n      for (var key in Object(object)) {\n        if (hasOwnProperty.call(object, key) && key != 'constructor') {\n          result.push(key);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.keysIn` which doesn't treat sparse arrays as dense.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names.\n     */\n    function baseKeysIn(object) {\n      if (!isObject(object)) {\n        return nativeKeysIn(object);\n      }\n      var isProto = isPrototype(object),\n          result = [];\n\n      for (var key in object) {\n        if (!(key == 'constructor' && (isProto || !hasOwnProperty.call(object, key)))) {\n          result.push(key);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.lt` which doesn't coerce arguments.\n     *\n     * @private\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if `value` is less than `other`,\n     *  else `false`.\n     */\n    function baseLt(value, other) {\n      return value < other;\n    }\n\n    /**\n     * The base implementation of `_.map` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @returns {Array} Returns the new mapped array.\n     */\n    function baseMap(collection, iteratee) {\n      var index = -1,\n          result = isArrayLike(collection) ? Array(collection.length) : [];\n\n      baseEach(collection, function(value, key, collection) {\n        result[++index] = iteratee(value, key, collection);\n      });\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.matches` which doesn't clone `source`.\n     *\n     * @private\n     * @param {Object} source The object of property values to match.\n     * @returns {Function} Returns the new spec function.\n     */\n    function baseMatches(source) {\n      var matchData = getMatchData(source);\n      if (matchData.length == 1 && matchData[0][2]) {\n        return matchesStrictComparable(matchData[0][0], matchData[0][1]);\n      }\n      return function(object) {\n        return object === source || baseIsMatch(object, source, matchData);\n      };\n    }\n\n    /**\n     * The base implementation of `_.matchesProperty` which doesn't clone `srcValue`.\n     *\n     * @private\n     * @param {string} path The path of the property to get.\n     * @param {*} srcValue The value to match.\n     * @returns {Function} Returns the new spec function.\n     */\n    function baseMatchesProperty(path, srcValue) {\n      if (isKey(path) && isStrictComparable(srcValue)) {\n        return matchesStrictComparable(toKey(path), srcValue);\n      }\n      return function(object) {\n        var objValue = get(object, path);\n        return (objValue === undefined && objValue === srcValue)\n          ? hasIn(object, path)\n          : baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG);\n      };\n    }\n\n    /**\n     * The base implementation of `_.merge` without support for multiple sources.\n     *\n     * @private\n     * @param {Object} object The destination object.\n     * @param {Object} source The source object.\n     * @param {number} srcIndex The index of `source`.\n     * @param {Function} [customizer] The function to customize merged values.\n     * @param {Object} [stack] Tracks traversed source values and their merged\n     *  counterparts.\n     */\n    function baseMerge(object, source, srcIndex, customizer, stack) {\n      if (object === source) {\n        return;\n      }\n      baseFor(source, function(srcValue, key) {\n        stack || (stack = new Stack);\n        if (isObject(srcValue)) {\n          baseMergeDeep(object, source, key, srcIndex, baseMerge, customizer, stack);\n        }\n        else {\n          var newValue = customizer\n            ? customizer(safeGet(object, key), srcValue, (key + ''), object, source, stack)\n            : undefined;\n\n          if (newValue === undefined) {\n            newValue = srcValue;\n          }\n          assignMergeValue(object, key, newValue);\n        }\n      }, keysIn);\n    }\n\n    /**\n     * A specialized version of `baseMerge` for arrays and objects which performs\n     * deep merges and tracks traversed objects enabling objects with circular\n     * references to be merged.\n     *\n     * @private\n     * @param {Object} object The destination object.\n     * @param {Object} source The source object.\n     * @param {string} key The key of the value to merge.\n     * @param {number} srcIndex The index of `source`.\n     * @param {Function} mergeFunc The function to merge values.\n     * @param {Function} [customizer] The function to customize assigned values.\n     * @param {Object} [stack] Tracks traversed source values and their merged\n     *  counterparts.\n     */\n    function baseMergeDeep(object, source, key, srcIndex, mergeFunc, customizer, stack) {\n      var objValue = safeGet(object, key),\n          srcValue = safeGet(source, key),\n          stacked = stack.get(srcValue);\n\n      if (stacked) {\n        assignMergeValue(object, key, stacked);\n        return;\n      }\n      var newValue = customizer\n        ? customizer(objValue, srcValue, (key + ''), object, source, stack)\n        : undefined;\n\n      var isCommon = newValue === undefined;\n\n      if (isCommon) {\n        var isArr = isArray(srcValue),\n            isBuff = !isArr && isBuffer(srcValue),\n            isTyped = !isArr && !isBuff && isTypedArray(srcValue);\n\n        newValue = srcValue;\n        if (isArr || isBuff || isTyped) {\n          if (isArray(objValue)) {\n            newValue = objValue;\n          }\n          else if (isArrayLikeObject(objValue)) {\n            newValue = copyArray(objValue);\n          }\n          else if (isBuff) {\n            isCommon = false;\n            newValue = cloneBuffer(srcValue, true);\n          }\n          else if (isTyped) {\n            isCommon = false;\n            newValue = cloneTypedArray(srcValue, true);\n          }\n          else {\n            newValue = [];\n          }\n        }\n        else if (isPlainObject(srcValue) || isArguments(srcValue)) {\n          newValue = objValue;\n          if (isArguments(objValue)) {\n            newValue = toPlainObject(objValue);\n          }\n          else if (!isObject(objValue) || isFunction(objValue)) {\n            newValue = initCloneObject(srcValue);\n          }\n        }\n        else {\n          isCommon = false;\n        }\n      }\n      if (isCommon) {\n        // Recursively merge objects and arrays (susceptible to call stack limits).\n        stack.set(srcValue, newValue);\n        mergeFunc(newValue, srcValue, srcIndex, customizer, stack);\n        stack['delete'](srcValue);\n      }\n      assignMergeValue(object, key, newValue);\n    }\n\n    /**\n     * The base implementation of `_.nth` which doesn't coerce arguments.\n     *\n     * @private\n     * @param {Array} array The array to query.\n     * @param {number} n The index of the element to return.\n     * @returns {*} Returns the nth element of `array`.\n     */\n    function baseNth(array, n) {\n      var length = array.length;\n      if (!length) {\n        return;\n      }\n      n += n < 0 ? length : 0;\n      return isIndex(n, length) ? array[n] : undefined;\n    }\n\n    /**\n     * The base implementation of `_.orderBy` without param guards.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function[]|Object[]|string[]} iteratees The iteratees to sort by.\n     * @param {string[]} orders The sort orders of `iteratees`.\n     * @returns {Array} Returns the new sorted array.\n     */\n    function baseOrderBy(collection, iteratees, orders) {\n      if (iteratees.length) {\n        iteratees = arrayMap(iteratees, function(iteratee) {\n          if (isArray(iteratee)) {\n            return function(value) {\n              return baseGet(value, iteratee.length === 1 ? iteratee[0] : iteratee);\n            }\n          }\n          return iteratee;\n        });\n      } else {\n        iteratees = [identity];\n      }\n\n      var index = -1;\n      iteratees = arrayMap(iteratees, baseUnary(getIteratee()));\n\n      var result = baseMap(collection, function(value, key, collection) {\n        var criteria = arrayMap(iteratees, function(iteratee) {\n          return iteratee(value);\n        });\n        return { 'criteria': criteria, 'index': ++index, 'value': value };\n      });\n\n      return baseSortBy(result, function(object, other) {\n        return compareMultiple(object, other, orders);\n      });\n    }\n\n    /**\n     * The base implementation of `_.pick` without support for individual\n     * property identifiers.\n     *\n     * @private\n     * @param {Object} object The source object.\n     * @param {string[]} paths The property paths to pick.\n     * @returns {Object} Returns the new object.\n     */\n    function basePick(object, paths) {\n      return basePickBy(object, paths, function(value, path) {\n        return hasIn(object, path);\n      });\n    }\n\n    /**\n     * The base implementation of  `_.pickBy` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Object} object The source object.\n     * @param {string[]} paths The property paths to pick.\n     * @param {Function} predicate The function invoked per property.\n     * @returns {Object} Returns the new object.\n     */\n    function basePickBy(object, paths, predicate) {\n      var index = -1,\n          length = paths.length,\n          result = {};\n\n      while (++index < length) {\n        var path = paths[index],\n            value = baseGet(object, path);\n\n        if (predicate(value, path)) {\n          baseSet(result, castPath(path, object), value);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * A specialized version of `baseProperty` which supports deep paths.\n     *\n     * @private\n     * @param {Array|string} path The path of the property to get.\n     * @returns {Function} Returns the new accessor function.\n     */\n    function basePropertyDeep(path) {\n      return function(object) {\n        return baseGet(object, path);\n      };\n    }\n\n    /**\n     * The base implementation of `_.pullAllBy` without support for iteratee\n     * shorthands.\n     *\n     * @private\n     * @param {Array} array The array to modify.\n     * @param {Array} values The values to remove.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns `array`.\n     */\n    function basePullAll(array, values, iteratee, comparator) {\n      var indexOf = comparator ? baseIndexOfWith : baseIndexOf,\n          index = -1,\n          length = values.length,\n          seen = array;\n\n      if (array === values) {\n        values = copyArray(values);\n      }\n      if (iteratee) {\n        seen = arrayMap(array, baseUnary(iteratee));\n      }\n      while (++index < length) {\n        var fromIndex = 0,\n            value = values[index],\n            computed = iteratee ? iteratee(value) : value;\n\n        while ((fromIndex = indexOf(seen, computed, fromIndex, comparator)) > -1) {\n          if (seen !== array) {\n            splice.call(seen, fromIndex, 1);\n          }\n          splice.call(array, fromIndex, 1);\n        }\n      }\n      return array;\n    }\n\n    /**\n     * The base implementation of `_.pullAt` without support for individual\n     * indexes or capturing the removed elements.\n     *\n     * @private\n     * @param {Array} array The array to modify.\n     * @param {number[]} indexes The indexes of elements to remove.\n     * @returns {Array} Returns `array`.\n     */\n    function basePullAt(array, indexes) {\n      var length = array ? indexes.length : 0,\n          lastIndex = length - 1;\n\n      while (length--) {\n        var index = indexes[length];\n        if (length == lastIndex || index !== previous) {\n          var previous = index;\n          if (isIndex(index)) {\n            splice.call(array, index, 1);\n          } else {\n            baseUnset(array, index);\n          }\n        }\n      }\n      return array;\n    }\n\n    /**\n     * The base implementation of `_.random` without support for returning\n     * floating-point numbers.\n     *\n     * @private\n     * @param {number} lower The lower bound.\n     * @param {number} upper The upper bound.\n     * @returns {number} Returns the random number.\n     */\n    function baseRandom(lower, upper) {\n      return lower + nativeFloor(nativeRandom() * (upper - lower + 1));\n    }\n\n    /**\n     * The base implementation of `_.range` and `_.rangeRight` which doesn't\n     * coerce arguments.\n     *\n     * @private\n     * @param {number} start The start of the range.\n     * @param {number} end The end of the range.\n     * @param {number} step The value to increment or decrement by.\n     * @param {boolean} [fromRight] Specify iterating from right to left.\n     * @returns {Array} Returns the range of numbers.\n     */\n    function baseRange(start, end, step, fromRight) {\n      var index = -1,\n          length = nativeMax(nativeCeil((end - start) / (step || 1)), 0),\n          result = Array(length);\n\n      while (length--) {\n        result[fromRight ? length : ++index] = start;\n        start += step;\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.repeat` which doesn't coerce arguments.\n     *\n     * @private\n     * @param {string} string The string to repeat.\n     * @param {number} n The number of times to repeat the string.\n     * @returns {string} Returns the repeated string.\n     */\n    function baseRepeat(string, n) {\n      var result = '';\n      if (!string || n < 1 || n > MAX_SAFE_INTEGER) {\n        return result;\n      }\n      // Leverage the exponentiation by squaring algorithm for a faster repeat.\n      // See https://en.wikipedia.org/wiki/Exponentiation_by_squaring for more details.\n      do {\n        if (n % 2) {\n          result += string;\n        }\n        n = nativeFloor(n / 2);\n        if (n) {\n          string += string;\n        }\n      } while (n);\n\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n     *\n     * @private\n     * @param {Function} func The function to apply a rest parameter to.\n     * @param {number} [start=func.length-1] The start position of the rest parameter.\n     * @returns {Function} Returns the new function.\n     */\n    function baseRest(func, start) {\n      return setToString(overRest(func, start, identity), func + '');\n    }\n\n    /**\n     * The base implementation of `_.sample`.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to sample.\n     * @returns {*} Returns the random element.\n     */\n    function baseSample(collection) {\n      return arraySample(values(collection));\n    }\n\n    /**\n     * The base implementation of `_.sampleSize` without param guards.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to sample.\n     * @param {number} n The number of elements to sample.\n     * @returns {Array} Returns the random elements.\n     */\n    function baseSampleSize(collection, n) {\n      var array = values(collection);\n      return shuffleSelf(array, baseClamp(n, 0, array.length));\n    }\n\n    /**\n     * The base implementation of `_.set`.\n     *\n     * @private\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to set.\n     * @param {*} value The value to set.\n     * @param {Function} [customizer] The function to customize path creation.\n     * @returns {Object} Returns `object`.\n     */\n    function baseSet(object, path, value, customizer) {\n      if (!isObject(object)) {\n        return object;\n      }\n      path = castPath(path, object);\n\n      var index = -1,\n          length = path.length,\n          lastIndex = length - 1,\n          nested = object;\n\n      while (nested != null && ++index < length) {\n        var key = toKey(path[index]),\n            newValue = value;\n\n        if (key === '__proto__' || key === 'constructor' || key === 'prototype') {\n          return object;\n        }\n\n        if (index != lastIndex) {\n          var objValue = nested[key];\n          newValue = customizer ? customizer(objValue, key, nested) : undefined;\n          if (newValue === undefined) {\n            newValue = isObject(objValue)\n              ? objValue\n              : (isIndex(path[index + 1]) ? [] : {});\n          }\n        }\n        assignValue(nested, key, newValue);\n        nested = nested[key];\n      }\n      return object;\n    }\n\n    /**\n     * The base implementation of `setData` without support for hot loop shorting.\n     *\n     * @private\n     * @param {Function} func The function to associate metadata with.\n     * @param {*} data The metadata.\n     * @returns {Function} Returns `func`.\n     */\n    var baseSetData = !metaMap ? identity : function(func, data) {\n      metaMap.set(func, data);\n      return func;\n    };\n\n    /**\n     * The base implementation of `setToString` without support for hot loop shorting.\n     *\n     * @private\n     * @param {Function} func The function to modify.\n     * @param {Function} string The `toString` result.\n     * @returns {Function} Returns `func`.\n     */\n    var baseSetToString = !defineProperty ? identity : function(func, string) {\n      return defineProperty(func, 'toString', {\n        'configurable': true,\n        'enumerable': false,\n        'value': constant(string),\n        'writable': true\n      });\n    };\n\n    /**\n     * The base implementation of `_.shuffle`.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to shuffle.\n     * @returns {Array} Returns the new shuffled array.\n     */\n    function baseShuffle(collection) {\n      return shuffleSelf(values(collection));\n    }\n\n    /**\n     * The base implementation of `_.slice` without an iteratee call guard.\n     *\n     * @private\n     * @param {Array} array The array to slice.\n     * @param {number} [start=0] The start position.\n     * @param {number} [end=array.length] The end position.\n     * @returns {Array} Returns the slice of `array`.\n     */\n    function baseSlice(array, start, end) {\n      var index = -1,\n          length = array.length;\n\n      if (start < 0) {\n        start = -start > length ? 0 : (length + start);\n      }\n      end = end > length ? length : end;\n      if (end < 0) {\n        end += length;\n      }\n      length = start > end ? 0 : ((end - start) >>> 0);\n      start >>>= 0;\n\n      var result = Array(length);\n      while (++index < length) {\n        result[index] = array[index + start];\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.some` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} predicate The function invoked per iteration.\n     * @returns {boolean} Returns `true` if any element passes the predicate check,\n     *  else `false`.\n     */\n    function baseSome(collection, predicate) {\n      var result;\n\n      baseEach(collection, function(value, index, collection) {\n        result = predicate(value, index, collection);\n        return !result;\n      });\n      return !!result;\n    }\n\n    /**\n     * The base implementation of `_.sortedIndex` and `_.sortedLastIndex` which\n     * performs a binary search of `array` to determine the index at which `value`\n     * should be inserted into `array` in order to maintain its sort order.\n     *\n     * @private\n     * @param {Array} array The sorted array to inspect.\n     * @param {*} value The value to evaluate.\n     * @param {boolean} [retHighest] Specify returning the highest qualified index.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     */\n    function baseSortedIndex(array, value, retHighest) {\n      var low = 0,\n          high = array == null ? low : array.length;\n\n      if (typeof value == 'number' && value === value && high <= HALF_MAX_ARRAY_LENGTH) {\n        while (low < high) {\n          var mid = (low + high) >>> 1,\n              computed = array[mid];\n\n          if (computed !== null && !isSymbol(computed) &&\n              (retHighest ? (computed <= value) : (computed < value))) {\n            low = mid + 1;\n          } else {\n            high = mid;\n          }\n        }\n        return high;\n      }\n      return baseSortedIndexBy(array, value, identity, retHighest);\n    }\n\n    /**\n     * The base implementation of `_.sortedIndexBy` and `_.sortedLastIndexBy`\n     * which invokes `iteratee` for `value` and each element of `array` to compute\n     * their sort ranking. The iteratee is invoked with one argument; (value).\n     *\n     * @private\n     * @param {Array} array The sorted array to inspect.\n     * @param {*} value The value to evaluate.\n     * @param {Function} iteratee The iteratee invoked per element.\n     * @param {boolean} [retHighest] Specify returning the highest qualified index.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     */\n    function baseSortedIndexBy(array, value, iteratee, retHighest) {\n      var low = 0,\n          high = array == null ? 0 : array.length;\n      if (high === 0) {\n        return 0;\n      }\n\n      value = iteratee(value);\n      var valIsNaN = value !== value,\n          valIsNull = value === null,\n          valIsSymbol = isSymbol(value),\n          valIsUndefined = value === undefined;\n\n      while (low < high) {\n        var mid = nativeFloor((low + high) / 2),\n            computed = iteratee(array[mid]),\n            othIsDefined = computed !== undefined,\n            othIsNull = computed === null,\n            othIsReflexive = computed === computed,\n            othIsSymbol = isSymbol(computed);\n\n        if (valIsNaN) {\n          var setLow = retHighest || othIsReflexive;\n        } else if (valIsUndefined) {\n          setLow = othIsReflexive && (retHighest || othIsDefined);\n        } else if (valIsNull) {\n          setLow = othIsReflexive && othIsDefined && (retHighest || !othIsNull);\n        } else if (valIsSymbol) {\n          setLow = othIsReflexive && othIsDefined && !othIsNull && (retHighest || !othIsSymbol);\n        } else if (othIsNull || othIsSymbol) {\n          setLow = false;\n        } else {\n          setLow = retHighest ? (computed <= value) : (computed < value);\n        }\n        if (setLow) {\n          low = mid + 1;\n        } else {\n          high = mid;\n        }\n      }\n      return nativeMin(high, MAX_ARRAY_INDEX);\n    }\n\n    /**\n     * The base implementation of `_.sortedUniq` and `_.sortedUniqBy` without\n     * support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array} array The array to inspect.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @returns {Array} Returns the new duplicate free array.\n     */\n    function baseSortedUniq(array, iteratee) {\n      var index = -1,\n          length = array.length,\n          resIndex = 0,\n          result = [];\n\n      while (++index < length) {\n        var value = array[index],\n            computed = iteratee ? iteratee(value) : value;\n\n        if (!index || !eq(computed, seen)) {\n          var seen = computed;\n          result[resIndex++] = value === 0 ? 0 : value;\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.toNumber` which doesn't ensure correct\n     * conversions of binary, hexadecimal, or octal string values.\n     *\n     * @private\n     * @param {*} value The value to process.\n     * @returns {number} Returns the number.\n     */\n    function baseToNumber(value) {\n      if (typeof value == 'number') {\n        return value;\n      }\n      if (isSymbol(value)) {\n        return NAN;\n      }\n      return +value;\n    }\n\n    /**\n     * The base implementation of `_.toString` which doesn't convert nullish\n     * values to empty strings.\n     *\n     * @private\n     * @param {*} value The value to process.\n     * @returns {string} Returns the string.\n     */\n    function baseToString(value) {\n      // Exit early for strings to avoid a performance hit in some environments.\n      if (typeof value == 'string') {\n        return value;\n      }\n      if (isArray(value)) {\n        // Recursively convert values (susceptible to call stack limits).\n        return arrayMap(value, baseToString) + '';\n      }\n      if (isSymbol(value)) {\n        return symbolToString ? symbolToString.call(value) : '';\n      }\n      var result = (value + '');\n      return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n    }\n\n    /**\n     * The base implementation of `_.uniqBy` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array} array The array to inspect.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new duplicate free array.\n     */\n    function baseUniq(array, iteratee, comparator) {\n      var index = -1,\n          includes = arrayIncludes,\n          length = array.length,\n          isCommon = true,\n          result = [],\n          seen = result;\n\n      if (comparator) {\n        isCommon = false;\n        includes = arrayIncludesWith;\n      }\n      else if (length >= LARGE_ARRAY_SIZE) {\n        var set = iteratee ? null : createSet(array);\n        if (set) {\n          return setToArray(set);\n        }\n        isCommon = false;\n        includes = cacheHas;\n        seen = new SetCache;\n      }\n      else {\n        seen = iteratee ? [] : result;\n      }\n      outer:\n      while (++index < length) {\n        var value = array[index],\n            computed = iteratee ? iteratee(value) : value;\n\n        value = (comparator || value !== 0) ? value : 0;\n        if (isCommon && computed === computed) {\n          var seenIndex = seen.length;\n          while (seenIndex--) {\n            if (seen[seenIndex] === computed) {\n              continue outer;\n            }\n          }\n          if (iteratee) {\n            seen.push(computed);\n          }\n          result.push(value);\n        }\n        else if (!includes(seen, computed, comparator)) {\n          if (seen !== result) {\n            seen.push(computed);\n          }\n          result.push(value);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.unset`.\n     *\n     * @private\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The property path to unset.\n     * @returns {boolean} Returns `true` if the property is deleted, else `false`.\n     */\n    function baseUnset(object, path) {\n      path = castPath(path, object);\n      object = parent(object, path);\n      return object == null || delete object[toKey(last(path))];\n    }\n\n    /**\n     * The base implementation of `_.update`.\n     *\n     * @private\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to update.\n     * @param {Function} updater The function to produce the updated value.\n     * @param {Function} [customizer] The function to customize path creation.\n     * @returns {Object} Returns `object`.\n     */\n    function baseUpdate(object, path, updater, customizer) {\n      return baseSet(object, path, updater(baseGet(object, path)), customizer);\n    }\n\n    /**\n     * The base implementation of methods like `_.dropWhile` and `_.takeWhile`\n     * without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array} array The array to query.\n     * @param {Function} predicate The function invoked per iteration.\n     * @param {boolean} [isDrop] Specify dropping elements instead of taking them.\n     * @param {boolean} [fromRight] Specify iterating from right to left.\n     * @returns {Array} Returns the slice of `array`.\n     */\n    function baseWhile(array, predicate, isDrop, fromRight) {\n      var length = array.length,\n          index = fromRight ? length : -1;\n\n      while ((fromRight ? index-- : ++index < length) &&\n        predicate(array[index], index, array)) {}\n\n      return isDrop\n        ? baseSlice(array, (fromRight ? 0 : index), (fromRight ? index + 1 : length))\n        : baseSlice(array, (fromRight ? index + 1 : 0), (fromRight ? length : index));\n    }\n\n    /**\n     * The base implementation of `wrapperValue` which returns the result of\n     * performing a sequence of actions on the unwrapped `value`, where each\n     * successive action is supplied the return value of the previous.\n     *\n     * @private\n     * @param {*} value The unwrapped value.\n     * @param {Array} actions Actions to perform to resolve the unwrapped value.\n     * @returns {*} Returns the resolved value.\n     */\n    function baseWrapperValue(value, actions) {\n      var result = value;\n      if (result instanceof LazyWrapper) {\n        result = result.value();\n      }\n      return arrayReduce(actions, function(result, action) {\n        return action.func.apply(action.thisArg, arrayPush([result], action.args));\n      }, result);\n    }\n\n    /**\n     * The base implementation of methods like `_.xor`, without support for\n     * iteratee shorthands, that accepts an array of arrays to inspect.\n     *\n     * @private\n     * @param {Array} arrays The arrays to inspect.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of values.\n     */\n    function baseXor(arrays, iteratee, comparator) {\n      var length = arrays.length;\n      if (length < 2) {\n        return length ? baseUniq(arrays[0]) : [];\n      }\n      var index = -1,\n          result = Array(length);\n\n      while (++index < length) {\n        var array = arrays[index],\n            othIndex = -1;\n\n        while (++othIndex < length) {\n          if (othIndex != index) {\n            result[index] = baseDifference(result[index] || array, arrays[othIndex], iteratee, comparator);\n          }\n        }\n      }\n      return baseUniq(baseFlatten(result, 1), iteratee, comparator);\n    }\n\n    /**\n     * This base implementation of `_.zipObject` which assigns values using `assignFunc`.\n     *\n     * @private\n     * @param {Array} props The property identifiers.\n     * @param {Array} values The property values.\n     * @param {Function} assignFunc The function to assign values.\n     * @returns {Object} Returns the new object.\n     */\n    function baseZipObject(props, values, assignFunc) {\n      var index = -1,\n          length = props.length,\n          valsLength = values.length,\n          result = {};\n\n      while (++index < length) {\n        var value = index < valsLength ? values[index] : undefined;\n        assignFunc(result, props[index], value);\n      }\n      return result;\n    }\n\n    /**\n     * Casts `value` to an empty array if it's not an array like object.\n     *\n     * @private\n     * @param {*} value The value to inspect.\n     * @returns {Array|Object} Returns the cast array-like object.\n     */\n    function castArrayLikeObject(value) {\n      return isArrayLikeObject(value) ? value : [];\n    }\n\n    /**\n     * Casts `value` to `identity` if it's not a function.\n     *\n     * @private\n     * @param {*} value The value to inspect.\n     * @returns {Function} Returns cast function.\n     */\n    function castFunction(value) {\n      return typeof value == 'function' ? value : identity;\n    }\n\n    /**\n     * Casts `value` to a path array if it's not one.\n     *\n     * @private\n     * @param {*} value The value to inspect.\n     * @param {Object} [object] The object to query keys on.\n     * @returns {Array} Returns the cast property path array.\n     */\n    function castPath(value, object) {\n      if (isArray(value)) {\n        return value;\n      }\n      return isKey(value, object) ? [value] : stringToPath(toString(value));\n    }\n\n    /**\n     * A `baseRest` alias which can be replaced with `identity` by module\n     * replacement plugins.\n     *\n     * @private\n     * @type {Function}\n     * @param {Function} func The function to apply a rest parameter to.\n     * @returns {Function} Returns the new function.\n     */\n    var castRest = baseRest;\n\n    /**\n     * Casts `array` to a slice if it's needed.\n     *\n     * @private\n     * @param {Array} array The array to inspect.\n     * @param {number} start The start position.\n     * @param {number} [end=array.length] The end position.\n     * @returns {Array} Returns the cast slice.\n     */\n    function castSlice(array, start, end) {\n      var length = array.length;\n      end = end === undefined ? length : end;\n      return (!start && end >= length) ? array : baseSlice(array, start, end);\n    }\n\n    /**\n     * A simple wrapper around the global [`clearTimeout`](https://mdn.io/clearTimeout).\n     *\n     * @private\n     * @param {number|Object} id The timer id or timeout object of the timer to clear.\n     */\n    var clearTimeout = ctxClearTimeout || function(id) {\n      return root.clearTimeout(id);\n    };\n\n    /**\n     * Creates a clone of  `buffer`.\n     *\n     * @private\n     * @param {Buffer} buffer The buffer to clone.\n     * @param {boolean} [isDeep] Specify a deep clone.\n     * @returns {Buffer} Returns the cloned buffer.\n     */\n    function cloneBuffer(buffer, isDeep) {\n      if (isDeep) {\n        return buffer.slice();\n      }\n      var length = buffer.length,\n          result = allocUnsafe ? allocUnsafe(length) : new buffer.constructor(length);\n\n      buffer.copy(result);\n      return result;\n    }\n\n    /**\n     * Creates a clone of `arrayBuffer`.\n     *\n     * @private\n     * @param {ArrayBuffer} arrayBuffer The array buffer to clone.\n     * @returns {ArrayBuffer} Returns the cloned array buffer.\n     */\n    function cloneArrayBuffer(arrayBuffer) {\n      var result = new arrayBuffer.constructor(arrayBuffer.byteLength);\n      new Uint8Array(result).set(new Uint8Array(arrayBuffer));\n      return result;\n    }\n\n    /**\n     * Creates a clone of `dataView`.\n     *\n     * @private\n     * @param {Object} dataView The data view to clone.\n     * @param {boolean} [isDeep] Specify a deep clone.\n     * @returns {Object} Returns the cloned data view.\n     */\n    function cloneDataView(dataView, isDeep) {\n      var buffer = isDeep ? cloneArrayBuffer(dataView.buffer) : dataView.buffer;\n      return new dataView.constructor(buffer, dataView.byteOffset, dataView.byteLength);\n    }\n\n    /**\n     * Creates a clone of `regexp`.\n     *\n     * @private\n     * @param {Object} regexp The regexp to clone.\n     * @returns {Object} Returns the cloned regexp.\n     */\n    function cloneRegExp(regexp) {\n      var result = new regexp.constructor(regexp.source, reFlags.exec(regexp));\n      result.lastIndex = regexp.lastIndex;\n      return result;\n    }\n\n    /**\n     * Creates a clone of the `symbol` object.\n     *\n     * @private\n     * @param {Object} symbol The symbol object to clone.\n     * @returns {Object} Returns the cloned symbol object.\n     */\n    function cloneSymbol(symbol) {\n      return symbolValueOf ? Object(symbolValueOf.call(symbol)) : {};\n    }\n\n    /**\n     * Creates a clone of `typedArray`.\n     *\n     * @private\n     * @param {Object} typedArray The typed array to clone.\n     * @param {boolean} [isDeep] Specify a deep clone.\n     * @returns {Object} Returns the cloned typed array.\n     */\n    function cloneTypedArray(typedArray, isDeep) {\n      var buffer = isDeep ? cloneArrayBuffer(typedArray.buffer) : typedArray.buffer;\n      return new typedArray.constructor(buffer, typedArray.byteOffset, typedArray.length);\n    }\n\n    /**\n     * Compares values to sort them in ascending order.\n     *\n     * @private\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {number} Returns the sort order indicator for `value`.\n     */\n    function compareAscending(value, other) {\n      if (value !== other) {\n        var valIsDefined = value !== undefined,\n            valIsNull = value === null,\n            valIsReflexive = value === value,\n            valIsSymbol = isSymbol(value);\n\n        var othIsDefined = other !== undefined,\n            othIsNull = other === null,\n            othIsReflexive = other === other,\n            othIsSymbol = isSymbol(other);\n\n        if ((!othIsNull && !othIsSymbol && !valIsSymbol && value > other) ||\n            (valIsSymbol && othIsDefined && othIsReflexive && !othIsNull && !othIsSymbol) ||\n            (valIsNull && othIsDefined && othIsReflexive) ||\n            (!valIsDefined && othIsReflexive) ||\n            !valIsReflexive) {\n          return 1;\n        }\n        if ((!valIsNull && !valIsSymbol && !othIsSymbol && value < other) ||\n            (othIsSymbol && valIsDefined && valIsReflexive && !valIsNull && !valIsSymbol) ||\n            (othIsNull && valIsDefined && valIsReflexive) ||\n            (!othIsDefined && valIsReflexive) ||\n            !othIsReflexive) {\n          return -1;\n        }\n      }\n      return 0;\n    }\n\n    /**\n     * Used by `_.orderBy` to compare multiple properties of a value to another\n     * and stable sort them.\n     *\n     * If `orders` is unspecified, all values are sorted in ascending order. Otherwise,\n     * specify an order of \"desc\" for descending or \"asc\" for ascending sort order\n     * of corresponding values.\n     *\n     * @private\n     * @param {Object} object The object to compare.\n     * @param {Object} other The other object to compare.\n     * @param {boolean[]|string[]} orders The order to sort by for each property.\n     * @returns {number} Returns the sort order indicator for `object`.\n     */\n    function compareMultiple(object, other, orders) {\n      var index = -1,\n          objCriteria = object.criteria,\n          othCriteria = other.criteria,\n          length = objCriteria.length,\n          ordersLength = orders.length;\n\n      while (++index < length) {\n        var result = compareAscending(objCriteria[index], othCriteria[index]);\n        if (result) {\n          if (index >= ordersLength) {\n            return result;\n          }\n          var order = orders[index];\n          return result * (order == 'desc' ? -1 : 1);\n        }\n      }\n      // Fixes an `Array#sort` bug in the JS engine embedded in Adobe applications\n      // that causes it, under certain circumstances, to provide the same value for\n      // `object` and `other`. See https://github.com/jashkenas/underscore/pull/1247\n      // for more details.\n      //\n      // This also ensures a stable sort in V8 and other engines.\n      // See https://bugs.chromium.org/p/v8/issues/detail?id=90 for more details.\n      return object.index - other.index;\n    }\n\n    /**\n     * Creates an array that is the composition of partially applied arguments,\n     * placeholders, and provided arguments into a single array of arguments.\n     *\n     * @private\n     * @param {Array} args The provided arguments.\n     * @param {Array} partials The arguments to prepend to those provided.\n     * @param {Array} holders The `partials` placeholder indexes.\n     * @params {boolean} [isCurried] Specify composing for a curried function.\n     * @returns {Array} Returns the new array of composed arguments.\n     */\n    function composeArgs(args, partials, holders, isCurried) {\n      var argsIndex = -1,\n          argsLength = args.length,\n          holdersLength = holders.length,\n          leftIndex = -1,\n          leftLength = partials.length,\n          rangeLength = nativeMax(argsLength - holdersLength, 0),\n          result = Array(leftLength + rangeLength),\n          isUncurried = !isCurried;\n\n      while (++leftIndex < leftLength) {\n        result[leftIndex] = partials[leftIndex];\n      }\n      while (++argsIndex < holdersLength) {\n        if (isUncurried || argsIndex < argsLength) {\n          result[holders[argsIndex]] = args[argsIndex];\n        }\n      }\n      while (rangeLength--) {\n        result[leftIndex++] = args[argsIndex++];\n      }\n      return result;\n    }\n\n    /**\n     * This function is like `composeArgs` except that the arguments composition\n     * is tailored for `_.partialRight`.\n     *\n     * @private\n     * @param {Array} args The provided arguments.\n     * @param {Array} partials The arguments to append to those provided.\n     * @param {Array} holders The `partials` placeholder indexes.\n     * @params {boolean} [isCurried] Specify composing for a curried function.\n     * @returns {Array} Returns the new array of composed arguments.\n     */\n    function composeArgsRight(args, partials, holders, isCurried) {\n      var argsIndex = -1,\n          argsLength = args.length,\n          holdersIndex = -1,\n          holdersLength = holders.length,\n          rightIndex = -1,\n          rightLength = partials.length,\n          rangeLength = nativeMax(argsLength - holdersLength, 0),\n          result = Array(rangeLength + rightLength),\n          isUncurried = !isCurried;\n\n      while (++argsIndex < rangeLength) {\n        result[argsIndex] = args[argsIndex];\n      }\n      var offset = argsIndex;\n      while (++rightIndex < rightLength) {\n        result[offset + rightIndex] = partials[rightIndex];\n      }\n      while (++holdersIndex < holdersLength) {\n        if (isUncurried || argsIndex < argsLength) {\n          result[offset + holders[holdersIndex]] = args[argsIndex++];\n        }\n      }\n      return result;\n    }\n\n    /**\n     * Copies the values of `source` to `array`.\n     *\n     * @private\n     * @param {Array} source The array to copy values from.\n     * @param {Array} [array=[]] The array to copy values to.\n     * @returns {Array} Returns `array`.\n     */\n    function copyArray(source, array) {\n      var index = -1,\n          length = source.length;\n\n      array || (array = Array(length));\n      while (++index < length) {\n        array[index] = source[index];\n      }\n      return array;\n    }\n\n    /**\n     * Copies properties of `source` to `object`.\n     *\n     * @private\n     * @param {Object} source The object to copy properties from.\n     * @param {Array} props The property identifiers to copy.\n     * @param {Object} [object={}] The object to copy properties to.\n     * @param {Function} [customizer] The function to customize copied values.\n     * @returns {Object} Returns `object`.\n     */\n    function copyObject(source, props, object, customizer) {\n      var isNew = !object;\n      object || (object = {});\n\n      var index = -1,\n          length = props.length;\n\n      while (++index < length) {\n        var key = props[index];\n\n        var newValue = customizer\n          ? customizer(object[key], source[key], key, object, source)\n          : undefined;\n\n        if (newValue === undefined) {\n          newValue = source[key];\n        }\n        if (isNew) {\n          baseAssignValue(object, key, newValue);\n        } else {\n          assignValue(object, key, newValue);\n        }\n      }\n      return object;\n    }\n\n    /**\n     * Copies own symbols of `source` to `object`.\n     *\n     * @private\n     * @param {Object} source The object to copy symbols from.\n     * @param {Object} [object={}] The object to copy symbols to.\n     * @returns {Object} Returns `object`.\n     */\n    function copySymbols(source, object) {\n      return copyObject(source, getSymbols(source), object);\n    }\n\n    /**\n     * Copies own and inherited symbols of `source` to `object`.\n     *\n     * @private\n     * @param {Object} source The object to copy symbols from.\n     * @param {Object} [object={}] The object to copy symbols to.\n     * @returns {Object} Returns `object`.\n     */\n    function copySymbolsIn(source, object) {\n      return copyObject(source, getSymbolsIn(source), object);\n    }\n\n    /**\n     * Creates a function like `_.groupBy`.\n     *\n     * @private\n     * @param {Function} setter The function to set accumulator values.\n     * @param {Function} [initializer] The accumulator object initializer.\n     * @returns {Function} Returns the new aggregator function.\n     */\n    function createAggregator(setter, initializer) {\n      return function(collection, iteratee) {\n        var func = isArray(collection) ? arrayAggregator : baseAggregator,\n            accumulator = initializer ? initializer() : {};\n\n        return func(collection, setter, getIteratee(iteratee, 2), accumulator);\n      };\n    }\n\n    /**\n     * Creates a function like `_.assign`.\n     *\n     * @private\n     * @param {Function} assigner The function to assign values.\n     * @returns {Function} Returns the new assigner function.\n     */\n    function createAssigner(assigner) {\n      return baseRest(function(object, sources) {\n        var index = -1,\n            length = sources.length,\n            customizer = length > 1 ? sources[length - 1] : undefined,\n            guard = length > 2 ? sources[2] : undefined;\n\n        customizer = (assigner.length > 3 && typeof customizer == 'function')\n          ? (length--, customizer)\n          : undefined;\n\n        if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n          customizer = length < 3 ? undefined : customizer;\n          length = 1;\n        }\n        object = Object(object);\n        while (++index < length) {\n          var source = sources[index];\n          if (source) {\n            assigner(object, source, index, customizer);\n          }\n        }\n        return object;\n      });\n    }\n\n    /**\n     * Creates a `baseEach` or `baseEachRight` function.\n     *\n     * @private\n     * @param {Function} eachFunc The function to iterate over a collection.\n     * @param {boolean} [fromRight] Specify iterating from right to left.\n     * @returns {Function} Returns the new base function.\n     */\n    function createBaseEach(eachFunc, fromRight) {\n      return function(collection, iteratee) {\n        if (collection == null) {\n          return collection;\n        }\n        if (!isArrayLike(collection)) {\n          return eachFunc(collection, iteratee);\n        }\n        var length = collection.length,\n            index = fromRight ? length : -1,\n            iterable = Object(collection);\n\n        while ((fromRight ? index-- : ++index < length)) {\n          if (iteratee(iterable[index], index, iterable) === false) {\n            break;\n          }\n        }\n        return collection;\n      };\n    }\n\n    /**\n     * Creates a base function for methods like `_.forIn` and `_.forOwn`.\n     *\n     * @private\n     * @param {boolean} [fromRight] Specify iterating from right to left.\n     * @returns {Function} Returns the new base function.\n     */\n    function createBaseFor(fromRight) {\n      return function(object, iteratee, keysFunc) {\n        var index = -1,\n            iterable = Object(object),\n            props = keysFunc(object),\n            length = props.length;\n\n        while (length--) {\n          var key = props[fromRight ? length : ++index];\n          if (iteratee(iterable[key], key, iterable) === false) {\n            break;\n          }\n        }\n        return object;\n      };\n    }\n\n    /**\n     * Creates a function that wraps `func` to invoke it with the optional `this`\n     * binding of `thisArg`.\n     *\n     * @private\n     * @param {Function} func The function to wrap.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @param {*} [thisArg] The `this` binding of `func`.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createBind(func, bitmask, thisArg) {\n      var isBind = bitmask & WRAP_BIND_FLAG,\n          Ctor = createCtor(func);\n\n      function wrapper() {\n        var fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;\n        return fn.apply(isBind ? thisArg : this, arguments);\n      }\n      return wrapper;\n    }\n\n    /**\n     * Creates a function like `_.lowerFirst`.\n     *\n     * @private\n     * @param {string} methodName The name of the `String` case method to use.\n     * @returns {Function} Returns the new case function.\n     */\n    function createCaseFirst(methodName) {\n      return function(string) {\n        string = toString(string);\n\n        var strSymbols = hasUnicode(string)\n          ? stringToArray(string)\n          : undefined;\n\n        var chr = strSymbols\n          ? strSymbols[0]\n          : string.charAt(0);\n\n        var trailing = strSymbols\n          ? castSlice(strSymbols, 1).join('')\n          : string.slice(1);\n\n        return chr[methodName]() + trailing;\n      };\n    }\n\n    /**\n     * Creates a function like `_.camelCase`.\n     *\n     * @private\n     * @param {Function} callback The function to combine each word.\n     * @returns {Function} Returns the new compounder function.\n     */\n    function createCompounder(callback) {\n      return function(string) {\n        return arrayReduce(words(deburr(string).replace(reApos, '')), callback, '');\n      };\n    }\n\n    /**\n     * Creates a function that produces an instance of `Ctor` regardless of\n     * whether it was invoked as part of a `new` expression or by `call` or `apply`.\n     *\n     * @private\n     * @param {Function} Ctor The constructor to wrap.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createCtor(Ctor) {\n      return function() {\n        // Use a `switch` statement to work with class constructors. See\n        // http://ecma-international.org/ecma-262/7.0/#sec-ecmascript-function-objects-call-thisargument-argumentslist\n        // for more details.\n        var args = arguments;\n        switch (args.length) {\n          case 0: return new Ctor;\n          case 1: return new Ctor(args[0]);\n          case 2: return new Ctor(args[0], args[1]);\n          case 3: return new Ctor(args[0], args[1], args[2]);\n          case 4: return new Ctor(args[0], args[1], args[2], args[3]);\n          case 5: return new Ctor(args[0], args[1], args[2], args[3], args[4]);\n          case 6: return new Ctor(args[0], args[1], args[2], args[3], args[4], args[5]);\n          case 7: return new Ctor(args[0], args[1], args[2], args[3], args[4], args[5], args[6]);\n        }\n        var thisBinding = baseCreate(Ctor.prototype),\n            result = Ctor.apply(thisBinding, args);\n\n        // Mimic the constructor's `return` behavior.\n        // See https://es5.github.io/#x13.2.2 for more details.\n        return isObject(result) ? result : thisBinding;\n      };\n    }\n\n    /**\n     * Creates a function that wraps `func` to enable currying.\n     *\n     * @private\n     * @param {Function} func The function to wrap.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @param {number} arity The arity of `func`.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createCurry(func, bitmask, arity) {\n      var Ctor = createCtor(func);\n\n      function wrapper() {\n        var length = arguments.length,\n            args = Array(length),\n            index = length,\n            placeholder = getHolder(wrapper);\n\n        while (index--) {\n          args[index] = arguments[index];\n        }\n        var holders = (length < 3 && args[0] !== placeholder && args[length - 1] !== placeholder)\n          ? []\n          : replaceHolders(args, placeholder);\n\n        length -= holders.length;\n        if (length < arity) {\n          return createRecurry(\n            func, bitmask, createHybrid, wrapper.placeholder, undefined,\n            args, holders, undefined, undefined, arity - length);\n        }\n        var fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;\n        return apply(fn, this, args);\n      }\n      return wrapper;\n    }\n\n    /**\n     * Creates a `_.find` or `_.findLast` function.\n     *\n     * @private\n     * @param {Function} findIndexFunc The function to find the collection index.\n     * @returns {Function} Returns the new find function.\n     */\n    function createFind(findIndexFunc) {\n      return function(collection, predicate, fromIndex) {\n        var iterable = Object(collection);\n        if (!isArrayLike(collection)) {\n          var iteratee = getIteratee(predicate, 3);\n          collection = keys(collection);\n          predicate = function(key) { return iteratee(iterable[key], key, iterable); };\n        }\n        var index = findIndexFunc(collection, predicate, fromIndex);\n        return index > -1 ? iterable[iteratee ? collection[index] : index] : undefined;\n      };\n    }\n\n    /**\n     * Creates a `_.flow` or `_.flowRight` function.\n     *\n     * @private\n     * @param {boolean} [fromRight] Specify iterating from right to left.\n     * @returns {Function} Returns the new flow function.\n     */\n    function createFlow(fromRight) {\n      return flatRest(function(funcs) {\n        var length = funcs.length,\n            index = length,\n            prereq = LodashWrapper.prototype.thru;\n\n        if (fromRight) {\n          funcs.reverse();\n        }\n        while (index--) {\n          var func = funcs[index];\n          if (typeof func != 'function') {\n            throw new TypeError(FUNC_ERROR_TEXT);\n          }\n          if (prereq && !wrapper && getFuncName(func) == 'wrapper') {\n            var wrapper = new LodashWrapper([], true);\n          }\n        }\n        index = wrapper ? index : length;\n        while (++index < length) {\n          func = funcs[index];\n\n          var funcName = getFuncName(func),\n              data = funcName == 'wrapper' ? getData(func) : undefined;\n\n          if (data && isLaziable(data[0]) &&\n                data[1] == (WRAP_ARY_FLAG | WRAP_CURRY_FLAG | WRAP_PARTIAL_FLAG | WRAP_REARG_FLAG) &&\n                !data[4].length && data[9] == 1\n              ) {\n            wrapper = wrapper[getFuncName(data[0])].apply(wrapper, data[3]);\n          } else {\n            wrapper = (func.length == 1 && isLaziable(func))\n              ? wrapper[funcName]()\n              : wrapper.thru(func);\n          }\n        }\n        return function() {\n          var args = arguments,\n              value = args[0];\n\n          if (wrapper && args.length == 1 && isArray(value)) {\n            return wrapper.plant(value).value();\n          }\n          var index = 0,\n              result = length ? funcs[index].apply(this, args) : value;\n\n          while (++index < length) {\n            result = funcs[index].call(this, result);\n          }\n          return result;\n        };\n      });\n    }\n\n    /**\n     * Creates a function that wraps `func` to invoke it with optional `this`\n     * binding of `thisArg`, partial application, and currying.\n     *\n     * @private\n     * @param {Function|string} func The function or method name to wrap.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @param {*} [thisArg] The `this` binding of `func`.\n     * @param {Array} [partials] The arguments to prepend to those provided to\n     *  the new function.\n     * @param {Array} [holders] The `partials` placeholder indexes.\n     * @param {Array} [partialsRight] The arguments to append to those provided\n     *  to the new function.\n     * @param {Array} [holdersRight] The `partialsRight` placeholder indexes.\n     * @param {Array} [argPos] The argument positions of the new function.\n     * @param {number} [ary] The arity cap of `func`.\n     * @param {number} [arity] The arity of `func`.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createHybrid(func, bitmask, thisArg, partials, holders, partialsRight, holdersRight, argPos, ary, arity) {\n      var isAry = bitmask & WRAP_ARY_FLAG,\n          isBind = bitmask & WRAP_BIND_FLAG,\n          isBindKey = bitmask & WRAP_BIND_KEY_FLAG,\n          isCurried = bitmask & (WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG),\n          isFlip = bitmask & WRAP_FLIP_FLAG,\n          Ctor = isBindKey ? undefined : createCtor(func);\n\n      function wrapper() {\n        var length = arguments.length,\n            args = Array(length),\n            index = length;\n\n        while (index--) {\n          args[index] = arguments[index];\n        }\n        if (isCurried) {\n          var placeholder = getHolder(wrapper),\n              holdersCount = countHolders(args, placeholder);\n        }\n        if (partials) {\n          args = composeArgs(args, partials, holders, isCurried);\n        }\n        if (partialsRight) {\n          args = composeArgsRight(args, partialsRight, holdersRight, isCurried);\n        }\n        length -= holdersCount;\n        if (isCurried && length < arity) {\n          var newHolders = replaceHolders(args, placeholder);\n          return createRecurry(\n            func, bitmask, createHybrid, wrapper.placeholder, thisArg,\n            args, newHolders, argPos, ary, arity - length\n          );\n        }\n        var thisBinding = isBind ? thisArg : this,\n            fn = isBindKey ? thisBinding[func] : func;\n\n        length = args.length;\n        if (argPos) {\n          args = reorder(args, argPos);\n        } else if (isFlip && length > 1) {\n          args.reverse();\n        }\n        if (isAry && ary < length) {\n          args.length = ary;\n        }\n        if (this && this !== root && this instanceof wrapper) {\n          fn = Ctor || createCtor(fn);\n        }\n        return fn.apply(thisBinding, args);\n      }\n      return wrapper;\n    }\n\n    /**\n     * Creates a function like `_.invertBy`.\n     *\n     * @private\n     * @param {Function} setter The function to set accumulator values.\n     * @param {Function} toIteratee The function to resolve iteratees.\n     * @returns {Function} Returns the new inverter function.\n     */\n    function createInverter(setter, toIteratee) {\n      return function(object, iteratee) {\n        return baseInverter(object, setter, toIteratee(iteratee), {});\n      };\n    }\n\n    /**\n     * Creates a function that performs a mathematical operation on two values.\n     *\n     * @private\n     * @param {Function} operator The function to perform the operation.\n     * @param {number} [defaultValue] The value used for `undefined` arguments.\n     * @returns {Function} Returns the new mathematical operation function.\n     */\n    function createMathOperation(operator, defaultValue) {\n      return function(value, other) {\n        var result;\n        if (value === undefined && other === undefined) {\n          return defaultValue;\n        }\n        if (value !== undefined) {\n          result = value;\n        }\n        if (other !== undefined) {\n          if (result === undefined) {\n            return other;\n          }\n          if (typeof value == 'string' || typeof other == 'string') {\n            value = baseToString(value);\n            other = baseToString(other);\n          } else {\n            value = baseToNumber(value);\n            other = baseToNumber(other);\n          }\n          result = operator(value, other);\n        }\n        return result;\n      };\n    }\n\n    /**\n     * Creates a function like `_.over`.\n     *\n     * @private\n     * @param {Function} arrayFunc The function to iterate over iteratees.\n     * @returns {Function} Returns the new over function.\n     */\n    function createOver(arrayFunc) {\n      return flatRest(function(iteratees) {\n        iteratees = arrayMap(iteratees, baseUnary(getIteratee()));\n        return baseRest(function(args) {\n          var thisArg = this;\n          return arrayFunc(iteratees, function(iteratee) {\n            return apply(iteratee, thisArg, args);\n          });\n        });\n      });\n    }\n\n    /**\n     * Creates the padding for `string` based on `length`. The `chars` string\n     * is truncated if the number of characters exceeds `length`.\n     *\n     * @private\n     * @param {number} length The padding length.\n     * @param {string} [chars=' '] The string used as padding.\n     * @returns {string} Returns the padding for `string`.\n     */\n    function createPadding(length, chars) {\n      chars = chars === undefined ? ' ' : baseToString(chars);\n\n      var charsLength = chars.length;\n      if (charsLength < 2) {\n        return charsLength ? baseRepeat(chars, length) : chars;\n      }\n      var result = baseRepeat(chars, nativeCeil(length / stringSize(chars)));\n      return hasUnicode(chars)\n        ? castSlice(stringToArray(result), 0, length).join('')\n        : result.slice(0, length);\n    }\n\n    /**\n     * Creates a function that wraps `func` to invoke it with the `this` binding\n     * of `thisArg` and `partials` prepended to the arguments it receives.\n     *\n     * @private\n     * @param {Function} func The function to wrap.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @param {*} thisArg The `this` binding of `func`.\n     * @param {Array} partials The arguments to prepend to those provided to\n     *  the new function.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createPartial(func, bitmask, thisArg, partials) {\n      var isBind = bitmask & WRAP_BIND_FLAG,\n          Ctor = createCtor(func);\n\n      function wrapper() {\n        var argsIndex = -1,\n            argsLength = arguments.length,\n            leftIndex = -1,\n            leftLength = partials.length,\n            args = Array(leftLength + argsLength),\n            fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;\n\n        while (++leftIndex < leftLength) {\n          args[leftIndex] = partials[leftIndex];\n        }\n        while (argsLength--) {\n          args[leftIndex++] = arguments[++argsIndex];\n        }\n        return apply(fn, isBind ? thisArg : this, args);\n      }\n      return wrapper;\n    }\n\n    /**\n     * Creates a `_.range` or `_.rangeRight` function.\n     *\n     * @private\n     * @param {boolean} [fromRight] Specify iterating from right to left.\n     * @returns {Function} Returns the new range function.\n     */\n    function createRange(fromRight) {\n      return function(start, end, step) {\n        if (step && typeof step != 'number' && isIterateeCall(start, end, step)) {\n          end = step = undefined;\n        }\n        // Ensure the sign of `-0` is preserved.\n        start = toFinite(start);\n        if (end === undefined) {\n          end = start;\n          start = 0;\n        } else {\n          end = toFinite(end);\n        }\n        step = step === undefined ? (start < end ? 1 : -1) : toFinite(step);\n        return baseRange(start, end, step, fromRight);\n      };\n    }\n\n    /**\n     * Creates a function that performs a relational operation on two values.\n     *\n     * @private\n     * @param {Function} operator The function to perform the operation.\n     * @returns {Function} Returns the new relational operation function.\n     */\n    function createRelationalOperation(operator) {\n      return function(value, other) {\n        if (!(typeof value == 'string' && typeof other == 'string')) {\n          value = toNumber(value);\n          other = toNumber(other);\n        }\n        return operator(value, other);\n      };\n    }\n\n    /**\n     * Creates a function that wraps `func` to continue currying.\n     *\n     * @private\n     * @param {Function} func The function to wrap.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @param {Function} wrapFunc The function to create the `func` wrapper.\n     * @param {*} placeholder The placeholder value.\n     * @param {*} [thisArg] The `this` binding of `func`.\n     * @param {Array} [partials] The arguments to prepend to those provided to\n     *  the new function.\n     * @param {Array} [holders] The `partials` placeholder indexes.\n     * @param {Array} [argPos] The argument positions of the new function.\n     * @param {number} [ary] The arity cap of `func`.\n     * @param {number} [arity] The arity of `func`.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createRecurry(func, bitmask, wrapFunc, placeholder, thisArg, partials, holders, argPos, ary, arity) {\n      var isCurry = bitmask & WRAP_CURRY_FLAG,\n          newHolders = isCurry ? holders : undefined,\n          newHoldersRight = isCurry ? undefined : holders,\n          newPartials = isCurry ? partials : undefined,\n          newPartialsRight = isCurry ? undefined : partials;\n\n      bitmask |= (isCurry ? WRAP_PARTIAL_FLAG : WRAP_PARTIAL_RIGHT_FLAG);\n      bitmask &= ~(isCurry ? WRAP_PARTIAL_RIGHT_FLAG : WRAP_PARTIAL_FLAG);\n\n      if (!(bitmask & WRAP_CURRY_BOUND_FLAG)) {\n        bitmask &= ~(WRAP_BIND_FLAG | WRAP_BIND_KEY_FLAG);\n      }\n      var newData = [\n        func, bitmask, thisArg, newPartials, newHolders, newPartialsRight,\n        newHoldersRight, argPos, ary, arity\n      ];\n\n      var result = wrapFunc.apply(undefined, newData);\n      if (isLaziable(func)) {\n        setData(result, newData);\n      }\n      result.placeholder = placeholder;\n      return setWrapToString(result, func, bitmask);\n    }\n\n    /**\n     * Creates a function like `_.round`.\n     *\n     * @private\n     * @param {string} methodName The name of the `Math` method to use when rounding.\n     * @returns {Function} Returns the new round function.\n     */\n    function createRound(methodName) {\n      var func = Math[methodName];\n      return function(number, precision) {\n        number = toNumber(number);\n        precision = precision == null ? 0 : nativeMin(toInteger(precision), 292);\n        if (precision && nativeIsFinite(number)) {\n          // Shift with exponential notation to avoid floating-point issues.\n          // See [MDN](https://mdn.io/round#Examples) for more details.\n          var pair = (toString(number) + 'e').split('e'),\n              value = func(pair[0] + 'e' + (+pair[1] + precision));\n\n          pair = (toString(value) + 'e').split('e');\n          return +(pair[0] + 'e' + (+pair[1] - precision));\n        }\n        return func(number);\n      };\n    }\n\n    /**\n     * Creates a set object of `values`.\n     *\n     * @private\n     * @param {Array} values The values to add to the set.\n     * @returns {Object} Returns the new set.\n     */\n    var createSet = !(Set && (1 / setToArray(new Set([,-0]))[1]) == INFINITY) ? noop : function(values) {\n      return new Set(values);\n    };\n\n    /**\n     * Creates a `_.toPairs` or `_.toPairsIn` function.\n     *\n     * @private\n     * @param {Function} keysFunc The function to get the keys of a given object.\n     * @returns {Function} Returns the new pairs function.\n     */\n    function createToPairs(keysFunc) {\n      return function(object) {\n        var tag = getTag(object);\n        if (tag == mapTag) {\n          return mapToArray(object);\n        }\n        if (tag == setTag) {\n          return setToPairs(object);\n        }\n        return baseToPairs(object, keysFunc(object));\n      };\n    }\n\n    /**\n     * Creates a function that either curries or invokes `func` with optional\n     * `this` binding and partially applied arguments.\n     *\n     * @private\n     * @param {Function|string} func The function or method name to wrap.\n     * @param {number} bitmask The bitmask flags.\n     *    1 - `_.bind`\n     *    2 - `_.bindKey`\n     *    4 - `_.curry` or `_.curryRight` of a bound function\n     *    8 - `_.curry`\n     *   16 - `_.curryRight`\n     *   32 - `_.partial`\n     *   64 - `_.partialRight`\n     *  128 - `_.rearg`\n     *  256 - `_.ary`\n     *  512 - `_.flip`\n     * @param {*} [thisArg] The `this` binding of `func`.\n     * @param {Array} [partials] The arguments to be partially applied.\n     * @param {Array} [holders] The `partials` placeholder indexes.\n     * @param {Array} [argPos] The argument positions of the new function.\n     * @param {number} [ary] The arity cap of `func`.\n     * @param {number} [arity] The arity of `func`.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createWrap(func, bitmask, thisArg, partials, holders, argPos, ary, arity) {\n      var isBindKey = bitmask & WRAP_BIND_KEY_FLAG;\n      if (!isBindKey && typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      var length = partials ? partials.length : 0;\n      if (!length) {\n        bitmask &= ~(WRAP_PARTIAL_FLAG | WRAP_PARTIAL_RIGHT_FLAG);\n        partials = holders = undefined;\n      }\n      ary = ary === undefined ? ary : nativeMax(toInteger(ary), 0);\n      arity = arity === undefined ? arity : toInteger(arity);\n      length -= holders ? holders.length : 0;\n\n      if (bitmask & WRAP_PARTIAL_RIGHT_FLAG) {\n        var partialsRight = partials,\n            holdersRight = holders;\n\n        partials = holders = undefined;\n      }\n      var data = isBindKey ? undefined : getData(func);\n\n      var newData = [\n        func, bitmask, thisArg, partials, holders, partialsRight, holdersRight,\n        argPos, ary, arity\n      ];\n\n      if (data) {\n        mergeData(newData, data);\n      }\n      func = newData[0];\n      bitmask = newData[1];\n      thisArg = newData[2];\n      partials = newData[3];\n      holders = newData[4];\n      arity = newData[9] = newData[9] === undefined\n        ? (isBindKey ? 0 : func.length)\n        : nativeMax(newData[9] - length, 0);\n\n      if (!arity && bitmask & (WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG)) {\n        bitmask &= ~(WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG);\n      }\n      if (!bitmask || bitmask == WRAP_BIND_FLAG) {\n        var result = createBind(func, bitmask, thisArg);\n      } else if (bitmask == WRAP_CURRY_FLAG || bitmask == WRAP_CURRY_RIGHT_FLAG) {\n        result = createCurry(func, bitmask, arity);\n      } else if ((bitmask == WRAP_PARTIAL_FLAG || bitmask == (WRAP_BIND_FLAG | WRAP_PARTIAL_FLAG)) && !holders.length) {\n        result = createPartial(func, bitmask, thisArg, partials);\n      } else {\n        result = createHybrid.apply(undefined, newData);\n      }\n      var setter = data ? baseSetData : setData;\n      return setWrapToString(setter(result, newData), func, bitmask);\n    }\n\n    /**\n     * Used by `_.defaults` to customize its `_.assignIn` use to assign properties\n     * of source objects to the destination object for all destination properties\n     * that resolve to `undefined`.\n     *\n     * @private\n     * @param {*} objValue The destination value.\n     * @param {*} srcValue The source value.\n     * @param {string} key The key of the property to assign.\n     * @param {Object} object The parent object of `objValue`.\n     * @returns {*} Returns the value to assign.\n     */\n    function customDefaultsAssignIn(objValue, srcValue, key, object) {\n      if (objValue === undefined ||\n          (eq(objValue, objectProto[key]) && !hasOwnProperty.call(object, key))) {\n        return srcValue;\n      }\n      return objValue;\n    }\n\n    /**\n     * Used by `_.defaultsDeep` to customize its `_.merge` use to merge source\n     * objects into destination objects that are passed thru.\n     *\n     * @private\n     * @param {*} objValue The destination value.\n     * @param {*} srcValue The source value.\n     * @param {string} key The key of the property to merge.\n     * @param {Object} object The parent object of `objValue`.\n     * @param {Object} source The parent object of `srcValue`.\n     * @param {Object} [stack] Tracks traversed source values and their merged\n     *  counterparts.\n     * @returns {*} Returns the value to assign.\n     */\n    function customDefaultsMerge(objValue, srcValue, key, object, source, stack) {\n      if (isObject(objValue) && isObject(srcValue)) {\n        // Recursively merge objects and arrays (susceptible to call stack limits).\n        stack.set(srcValue, objValue);\n        baseMerge(objValue, srcValue, undefined, customDefaultsMerge, stack);\n        stack['delete'](srcValue);\n      }\n      return objValue;\n    }\n\n    /**\n     * Used by `_.omit` to customize its `_.cloneDeep` use to only clone plain\n     * objects.\n     *\n     * @private\n     * @param {*} value The value to inspect.\n     * @param {string} key The key of the property to inspect.\n     * @returns {*} Returns the uncloned value or `undefined` to defer cloning to `_.cloneDeep`.\n     */\n    function customOmitClone(value) {\n      return isPlainObject(value) ? undefined : value;\n    }\n\n    /**\n     * A specialized version of `baseIsEqualDeep` for arrays with support for\n     * partial deep comparisons.\n     *\n     * @private\n     * @param {Array} array The array to compare.\n     * @param {Array} other The other array to compare.\n     * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n     * @param {Function} customizer The function to customize comparisons.\n     * @param {Function} equalFunc The function to determine equivalents of values.\n     * @param {Object} stack Tracks traversed `array` and `other` objects.\n     * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n     */\n    function equalArrays(array, other, bitmask, customizer, equalFunc, stack) {\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n          arrLength = array.length,\n          othLength = other.length;\n\n      if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n        return false;\n      }\n      // Check that cyclic values are equal.\n      var arrStacked = stack.get(array);\n      var othStacked = stack.get(other);\n      if (arrStacked && othStacked) {\n        return arrStacked == other && othStacked == array;\n      }\n      var index = -1,\n          result = true,\n          seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined;\n\n      stack.set(array, other);\n      stack.set(other, array);\n\n      // Ignore non-index properties.\n      while (++index < arrLength) {\n        var arrValue = array[index],\n            othValue = other[index];\n\n        if (customizer) {\n          var compared = isPartial\n            ? customizer(othValue, arrValue, index, other, array, stack)\n            : customizer(arrValue, othValue, index, array, other, stack);\n        }\n        if (compared !== undefined) {\n          if (compared) {\n            continue;\n          }\n          result = false;\n          break;\n        }\n        // Recursively compare arrays (susceptible to call stack limits).\n        if (seen) {\n          if (!arraySome(other, function(othValue, othIndex) {\n                if (!cacheHas(seen, othIndex) &&\n                    (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n                  return seen.push(othIndex);\n                }\n              })) {\n            result = false;\n            break;\n          }\n        } else if (!(\n              arrValue === othValue ||\n                equalFunc(arrValue, othValue, bitmask, customizer, stack)\n            )) {\n          result = false;\n          break;\n        }\n      }\n      stack['delete'](array);\n      stack['delete'](other);\n      return result;\n    }\n\n    /**\n     * A specialized version of `baseIsEqualDeep` for comparing objects of\n     * the same `toStringTag`.\n     *\n     * **Note:** This function only supports comparing values with tags of\n     * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n     *\n     * @private\n     * @param {Object} object The object to compare.\n     * @param {Object} other The other object to compare.\n     * @param {string} tag The `toStringTag` of the objects to compare.\n     * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n     * @param {Function} customizer The function to customize comparisons.\n     * @param {Function} equalFunc The function to determine equivalents of values.\n     * @param {Object} stack Tracks traversed `object` and `other` objects.\n     * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n     */\n    function equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {\n      switch (tag) {\n        case dataViewTag:\n          if ((object.byteLength != other.byteLength) ||\n              (object.byteOffset != other.byteOffset)) {\n            return false;\n          }\n          object = object.buffer;\n          other = other.buffer;\n\n        case arrayBufferTag:\n          if ((object.byteLength != other.byteLength) ||\n              !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n            return false;\n          }\n          return true;\n\n        case boolTag:\n        case dateTag:\n        case numberTag:\n          // Coerce booleans to `1` or `0` and dates to milliseconds.\n          // Invalid dates are coerced to `NaN`.\n          return eq(+object, +other);\n\n        case errorTag:\n          return object.name == other.name && object.message == other.message;\n\n        case regexpTag:\n        case stringTag:\n          // Coerce regexes to strings and treat strings, primitives and objects,\n          // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n          // for more details.\n          return object == (other + '');\n\n        case mapTag:\n          var convert = mapToArray;\n\n        case setTag:\n          var isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n          convert || (convert = setToArray);\n\n          if (object.size != other.size && !isPartial) {\n            return false;\n          }\n          // Assume cyclic values are equal.\n          var stacked = stack.get(object);\n          if (stacked) {\n            return stacked == other;\n          }\n          bitmask |= COMPARE_UNORDERED_FLAG;\n\n          // Recursively compare objects (susceptible to call stack limits).\n          stack.set(object, other);\n          var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n          stack['delete'](object);\n          return result;\n\n        case symbolTag:\n          if (symbolValueOf) {\n            return symbolValueOf.call(object) == symbolValueOf.call(other);\n          }\n      }\n      return false;\n    }\n\n    /**\n     * A specialized version of `baseIsEqualDeep` for objects with support for\n     * partial deep comparisons.\n     *\n     * @private\n     * @param {Object} object The object to compare.\n     * @param {Object} other The other object to compare.\n     * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n     * @param {Function} customizer The function to customize comparisons.\n     * @param {Function} equalFunc The function to determine equivalents of values.\n     * @param {Object} stack Tracks traversed `object` and `other` objects.\n     * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n     */\n    function equalObjects(object, other, bitmask, customizer, equalFunc, stack) {\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n          objProps = getAllKeys(object),\n          objLength = objProps.length,\n          othProps = getAllKeys(other),\n          othLength = othProps.length;\n\n      if (objLength != othLength && !isPartial) {\n        return false;\n      }\n      var index = objLength;\n      while (index--) {\n        var key = objProps[index];\n        if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n          return false;\n        }\n      }\n      // Check that cyclic values are equal.\n      var objStacked = stack.get(object);\n      var othStacked = stack.get(other);\n      if (objStacked && othStacked) {\n        return objStacked == other && othStacked == object;\n      }\n      var result = true;\n      stack.set(object, other);\n      stack.set(other, object);\n\n      var skipCtor = isPartial;\n      while (++index < objLength) {\n        key = objProps[index];\n        var objValue = object[key],\n            othValue = other[key];\n\n        if (customizer) {\n          var compared = isPartial\n            ? customizer(othValue, objValue, key, other, object, stack)\n            : customizer(objValue, othValue, key, object, other, stack);\n        }\n        // Recursively compare objects (susceptible to call stack limits).\n        if (!(compared === undefined\n              ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n              : compared\n            )) {\n          result = false;\n          break;\n        }\n        skipCtor || (skipCtor = key == 'constructor');\n      }\n      if (result && !skipCtor) {\n        var objCtor = object.constructor,\n            othCtor = other.constructor;\n\n        // Non `Object` object instances with different constructors are not equal.\n        if (objCtor != othCtor &&\n            ('constructor' in object && 'constructor' in other) &&\n            !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n              typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n          result = false;\n        }\n      }\n      stack['delete'](object);\n      stack['delete'](other);\n      return result;\n    }\n\n    /**\n     * A specialized version of `baseRest` which flattens the rest array.\n     *\n     * @private\n     * @param {Function} func The function to apply a rest parameter to.\n     * @returns {Function} Returns the new function.\n     */\n    function flatRest(func) {\n      return setToString(overRest(func, undefined, flatten), func + '');\n    }\n\n    /**\n     * Creates an array of own enumerable property names and symbols of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names and symbols.\n     */\n    function getAllKeys(object) {\n      return baseGetAllKeys(object, keys, getSymbols);\n    }\n\n    /**\n     * Creates an array of own and inherited enumerable property names and\n     * symbols of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names and symbols.\n     */\n    function getAllKeysIn(object) {\n      return baseGetAllKeys(object, keysIn, getSymbolsIn);\n    }\n\n    /**\n     * Gets metadata for `func`.\n     *\n     * @private\n     * @param {Function} func The function to query.\n     * @returns {*} Returns the metadata for `func`.\n     */\n    var getData = !metaMap ? noop : function(func) {\n      return metaMap.get(func);\n    };\n\n    /**\n     * Gets the name of `func`.\n     *\n     * @private\n     * @param {Function} func The function to query.\n     * @returns {string} Returns the function name.\n     */\n    function getFuncName(func) {\n      var result = (func.name + ''),\n          array = realNames[result],\n          length = hasOwnProperty.call(realNames, result) ? array.length : 0;\n\n      while (length--) {\n        var data = array[length],\n            otherFunc = data.func;\n        if (otherFunc == null || otherFunc == func) {\n          return data.name;\n        }\n      }\n      return result;\n    }\n\n    /**\n     * Gets the argument placeholder value for `func`.\n     *\n     * @private\n     * @param {Function} func The function to inspect.\n     * @returns {*} Returns the placeholder value.\n     */\n    function getHolder(func) {\n      var object = hasOwnProperty.call(lodash, 'placeholder') ? lodash : func;\n      return object.placeholder;\n    }\n\n    /**\n     * Gets the appropriate \"iteratee\" function. If `_.iteratee` is customized,\n     * this function returns the custom method, otherwise it returns `baseIteratee`.\n     * If arguments are provided, the chosen function is invoked with them and\n     * its result is returned.\n     *\n     * @private\n     * @param {*} [value] The value to convert to an iteratee.\n     * @param {number} [arity] The arity of the created iteratee.\n     * @returns {Function} Returns the chosen function or its result.\n     */\n    function getIteratee() {\n      var result = lodash.iteratee || iteratee;\n      result = result === iteratee ? baseIteratee : result;\n      return arguments.length ? result(arguments[0], arguments[1]) : result;\n    }\n\n    /**\n     * Gets the data for `map`.\n     *\n     * @private\n     * @param {Object} map The map to query.\n     * @param {string} key The reference key.\n     * @returns {*} Returns the map data.\n     */\n    function getMapData(map, key) {\n      var data = map.__data__;\n      return isKeyable(key)\n        ? data[typeof key == 'string' ? 'string' : 'hash']\n        : data.map;\n    }\n\n    /**\n     * Gets the property names, values, and compare flags of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the match data of `object`.\n     */\n    function getMatchData(object) {\n      var result = keys(object),\n          length = result.length;\n\n      while (length--) {\n        var key = result[length],\n            value = object[key];\n\n        result[length] = [key, value, isStrictComparable(value)];\n      }\n      return result;\n    }\n\n    /**\n     * Gets the native function at `key` of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {string} key The key of the method to get.\n     * @returns {*} Returns the function if it's native, else `undefined`.\n     */\n    function getNative(object, key) {\n      var value = getValue(object, key);\n      return baseIsNative(value) ? value : undefined;\n    }\n\n    /**\n     * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n     *\n     * @private\n     * @param {*} value The value to query.\n     * @returns {string} Returns the raw `toStringTag`.\n     */\n    function getRawTag(value) {\n      var isOwn = hasOwnProperty.call(value, symToStringTag),\n          tag = value[symToStringTag];\n\n      try {\n        value[symToStringTag] = undefined;\n        var unmasked = true;\n      } catch (e) {}\n\n      var result = nativeObjectToString.call(value);\n      if (unmasked) {\n        if (isOwn) {\n          value[symToStringTag] = tag;\n        } else {\n          delete value[symToStringTag];\n        }\n      }\n      return result;\n    }\n\n    /**\n     * Creates an array of the own enumerable symbols of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of symbols.\n     */\n    var getSymbols = !nativeGetSymbols ? stubArray : function(object) {\n      if (object == null) {\n        return [];\n      }\n      object = Object(object);\n      return arrayFilter(nativeGetSymbols(object), function(symbol) {\n        return propertyIsEnumerable.call(object, symbol);\n      });\n    };\n\n    /**\n     * Creates an array of the own and inherited enumerable symbols of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of symbols.\n     */\n    var getSymbolsIn = !nativeGetSymbols ? stubArray : function(object) {\n      var result = [];\n      while (object) {\n        arrayPush(result, getSymbols(object));\n        object = getPrototype(object);\n      }\n      return result;\n    };\n\n    /**\n     * Gets the `toStringTag` of `value`.\n     *\n     * @private\n     * @param {*} value The value to query.\n     * @returns {string} Returns the `toStringTag`.\n     */\n    var getTag = baseGetTag;\n\n    // Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\n    if ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n        (Map && getTag(new Map) != mapTag) ||\n        (Promise && getTag(Promise.resolve()) != promiseTag) ||\n        (Set && getTag(new Set) != setTag) ||\n        (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n      getTag = function(value) {\n        var result = baseGetTag(value),\n            Ctor = result == objectTag ? value.constructor : undefined,\n            ctorString = Ctor ? toSource(Ctor) : '';\n\n        if (ctorString) {\n          switch (ctorString) {\n            case dataViewCtorString: return dataViewTag;\n            case mapCtorString: return mapTag;\n            case promiseCtorString: return promiseTag;\n            case setCtorString: return setTag;\n            case weakMapCtorString: return weakMapTag;\n          }\n        }\n        return result;\n      };\n    }\n\n    /**\n     * Gets the view, applying any `transforms` to the `start` and `end` positions.\n     *\n     * @private\n     * @param {number} start The start of the view.\n     * @param {number} end The end of the view.\n     * @param {Array} transforms The transformations to apply to the view.\n     * @returns {Object} Returns an object containing the `start` and `end`\n     *  positions of the view.\n     */\n    function getView(start, end, transforms) {\n      var index = -1,\n          length = transforms.length;\n\n      while (++index < length) {\n        var data = transforms[index],\n            size = data.size;\n\n        switch (data.type) {\n          case 'drop':      start += size; break;\n          case 'dropRight': end -= size; break;\n          case 'take':      end = nativeMin(end, start + size); break;\n          case 'takeRight': start = nativeMax(start, end - size); break;\n        }\n      }\n      return { 'start': start, 'end': end };\n    }\n\n    /**\n     * Extracts wrapper details from the `source` body comment.\n     *\n     * @private\n     * @param {string} source The source to inspect.\n     * @returns {Array} Returns the wrapper details.\n     */\n    function getWrapDetails(source) {\n      var match = source.match(reWrapDetails);\n      return match ? match[1].split(reSplitDetails) : [];\n    }\n\n    /**\n     * Checks if `path` exists on `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path to check.\n     * @param {Function} hasFunc The function to check properties.\n     * @returns {boolean} Returns `true` if `path` exists, else `false`.\n     */\n    function hasPath(object, path, hasFunc) {\n      path = castPath(path, object);\n\n      var index = -1,\n          length = path.length,\n          result = false;\n\n      while (++index < length) {\n        var key = toKey(path[index]);\n        if (!(result = object != null && hasFunc(object, key))) {\n          break;\n        }\n        object = object[key];\n      }\n      if (result || ++index != length) {\n        return result;\n      }\n      length = object == null ? 0 : object.length;\n      return !!length && isLength(length) && isIndex(key, length) &&\n        (isArray(object) || isArguments(object));\n    }\n\n    /**\n     * Initializes an array clone.\n     *\n     * @private\n     * @param {Array} array The array to clone.\n     * @returns {Array} Returns the initialized clone.\n     */\n    function initCloneArray(array) {\n      var length = array.length,\n          result = new array.constructor(length);\n\n      // Add properties assigned by `RegExp#exec`.\n      if (length && typeof array[0] == 'string' && hasOwnProperty.call(array, 'index')) {\n        result.index = array.index;\n        result.input = array.input;\n      }\n      return result;\n    }\n\n    /**\n     * Initializes an object clone.\n     *\n     * @private\n     * @param {Object} object The object to clone.\n     * @returns {Object} Returns the initialized clone.\n     */\n    function initCloneObject(object) {\n      return (typeof object.constructor == 'function' && !isPrototype(object))\n        ? baseCreate(getPrototype(object))\n        : {};\n    }\n\n    /**\n     * Initializes an object clone based on its `toStringTag`.\n     *\n     * **Note:** This function only supports cloning values with tags of\n     * `Boolean`, `Date`, `Error`, `Map`, `Number`, `RegExp`, `Set`, or `String`.\n     *\n     * @private\n     * @param {Object} object The object to clone.\n     * @param {string} tag The `toStringTag` of the object to clone.\n     * @param {boolean} [isDeep] Specify a deep clone.\n     * @returns {Object} Returns the initialized clone.\n     */\n    function initCloneByTag(object, tag, isDeep) {\n      var Ctor = object.constructor;\n      switch (tag) {\n        case arrayBufferTag:\n          return cloneArrayBuffer(object);\n\n        case boolTag:\n        case dateTag:\n          return new Ctor(+object);\n\n        case dataViewTag:\n          return cloneDataView(object, isDeep);\n\n        case float32Tag: case float64Tag:\n        case int8Tag: case int16Tag: case int32Tag:\n        case uint8Tag: case uint8ClampedTag: case uint16Tag: case uint32Tag:\n          return cloneTypedArray(object, isDeep);\n\n        case mapTag:\n          return new Ctor;\n\n        case numberTag:\n        case stringTag:\n          return new Ctor(object);\n\n        case regexpTag:\n          return cloneRegExp(object);\n\n        case setTag:\n          return new Ctor;\n\n        case symbolTag:\n          return cloneSymbol(object);\n      }\n    }\n\n    /**\n     * Inserts wrapper `details` in a comment at the top of the `source` body.\n     *\n     * @private\n     * @param {string} source The source to modify.\n     * @returns {Array} details The details to insert.\n     * @returns {string} Returns the modified source.\n     */\n    function insertWrapDetails(source, details) {\n      var length = details.length;\n      if (!length) {\n        return source;\n      }\n      var lastIndex = length - 1;\n      details[lastIndex] = (length > 1 ? '& ' : '') + details[lastIndex];\n      details = details.join(length > 2 ? ', ' : ' ');\n      return source.replace(reWrapComment, '{\\n/* [wrapped with ' + details + '] */\\n');\n    }\n\n    /**\n     * Checks if `value` is a flattenable `arguments` object or array.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is flattenable, else `false`.\n     */\n    function isFlattenable(value) {\n      return isArray(value) || isArguments(value) ||\n        !!(spreadableSymbol && value && value[spreadableSymbol]);\n    }\n\n    /**\n     * Checks if `value` is a valid array-like index.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n     * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n     */\n    function isIndex(value, length) {\n      var type = typeof value;\n      length = length == null ? MAX_SAFE_INTEGER : length;\n\n      return !!length &&\n        (type == 'number' ||\n          (type != 'symbol' && reIsUint.test(value))) &&\n            (value > -1 && value % 1 == 0 && value < length);\n    }\n\n    /**\n     * Checks if the given arguments are from an iteratee call.\n     *\n     * @private\n     * @param {*} value The potential iteratee value argument.\n     * @param {*} index The potential iteratee index or key argument.\n     * @param {*} object The potential iteratee object argument.\n     * @returns {boolean} Returns `true` if the arguments are from an iteratee call,\n     *  else `false`.\n     */\n    function isIterateeCall(value, index, object) {\n      if (!isObject(object)) {\n        return false;\n      }\n      var type = typeof index;\n      if (type == 'number'\n            ? (isArrayLike(object) && isIndex(index, object.length))\n            : (type == 'string' && index in object)\n          ) {\n        return eq(object[index], value);\n      }\n      return false;\n    }\n\n    /**\n     * Checks if `value` is a property name and not a property path.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @param {Object} [object] The object to query keys on.\n     * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n     */\n    function isKey(value, object) {\n      if (isArray(value)) {\n        return false;\n      }\n      var type = typeof value;\n      if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n          value == null || isSymbol(value)) {\n        return true;\n      }\n      return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n        (object != null && value in Object(object));\n    }\n\n    /**\n     * Checks if `value` is suitable for use as unique object key.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n     */\n    function isKeyable(value) {\n      var type = typeof value;\n      return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n        ? (value !== '__proto__')\n        : (value === null);\n    }\n\n    /**\n     * Checks if `func` has a lazy counterpart.\n     *\n     * @private\n     * @param {Function} func The function to check.\n     * @returns {boolean} Returns `true` if `func` has a lazy counterpart,\n     *  else `false`.\n     */\n    function isLaziable(func) {\n      var funcName = getFuncName(func),\n          other = lodash[funcName];\n\n      if (typeof other != 'function' || !(funcName in LazyWrapper.prototype)) {\n        return false;\n      }\n      if (func === other) {\n        return true;\n      }\n      var data = getData(other);\n      return !!data && func === data[0];\n    }\n\n    /**\n     * Checks if `func` has its source masked.\n     *\n     * @private\n     * @param {Function} func The function to check.\n     * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n     */\n    function isMasked(func) {\n      return !!maskSrcKey && (maskSrcKey in func);\n    }\n\n    /**\n     * Checks if `func` is capable of being masked.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `func` is maskable, else `false`.\n     */\n    var isMaskable = coreJsData ? isFunction : stubFalse;\n\n    /**\n     * Checks if `value` is likely a prototype object.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n     */\n    function isPrototype(value) {\n      var Ctor = value && value.constructor,\n          proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n      return value === proto;\n    }\n\n    /**\n     * Checks if `value` is suitable for strict equality comparisons, i.e. `===`.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` if suitable for strict\n     *  equality comparisons, else `false`.\n     */\n    function isStrictComparable(value) {\n      return value === value && !isObject(value);\n    }\n\n    /**\n     * A specialized version of `matchesProperty` for source values suitable\n     * for strict equality comparisons, i.e. `===`.\n     *\n     * @private\n     * @param {string} key The key of the property to get.\n     * @param {*} srcValue The value to match.\n     * @returns {Function} Returns the new spec function.\n     */\n    function matchesStrictComparable(key, srcValue) {\n      return function(object) {\n        if (object == null) {\n          return false;\n        }\n        return object[key] === srcValue &&\n          (srcValue !== undefined || (key in Object(object)));\n      };\n    }\n\n    /**\n     * A specialized version of `_.memoize` which clears the memoized function's\n     * cache when it exceeds `MAX_MEMOIZE_SIZE`.\n     *\n     * @private\n     * @param {Function} func The function to have its output memoized.\n     * @returns {Function} Returns the new memoized function.\n     */\n    function memoizeCapped(func) {\n      var result = memoize(func, function(key) {\n        if (cache.size === MAX_MEMOIZE_SIZE) {\n          cache.clear();\n        }\n        return key;\n      });\n\n      var cache = result.cache;\n      return result;\n    }\n\n    /**\n     * Merges the function metadata of `source` into `data`.\n     *\n     * Merging metadata reduces the number of wrappers used to invoke a function.\n     * This is possible because methods like `_.bind`, `_.curry`, and `_.partial`\n     * may be applied regardless of execution order. Methods like `_.ary` and\n     * `_.rearg` modify function arguments, making the order in which they are\n     * executed important, preventing the merging of metadata. However, we make\n     * an exception for a safe combined case where curried functions have `_.ary`\n     * and or `_.rearg` applied.\n     *\n     * @private\n     * @param {Array} data The destination metadata.\n     * @param {Array} source The source metadata.\n     * @returns {Array} Returns `data`.\n     */\n    function mergeData(data, source) {\n      var bitmask = data[1],\n          srcBitmask = source[1],\n          newBitmask = bitmask | srcBitmask,\n          isCommon = newBitmask < (WRAP_BIND_FLAG | WRAP_BIND_KEY_FLAG | WRAP_ARY_FLAG);\n\n      var isCombo =\n        ((srcBitmask == WRAP_ARY_FLAG) && (bitmask == WRAP_CURRY_FLAG)) ||\n        ((srcBitmask == WRAP_ARY_FLAG) && (bitmask == WRAP_REARG_FLAG) && (data[7].length <= source[8])) ||\n        ((srcBitmask == (WRAP_ARY_FLAG | WRAP_REARG_FLAG)) && (source[7].length <= source[8]) && (bitmask == WRAP_CURRY_FLAG));\n\n      // Exit early if metadata can't be merged.\n      if (!(isCommon || isCombo)) {\n        return data;\n      }\n      // Use source `thisArg` if available.\n      if (srcBitmask & WRAP_BIND_FLAG) {\n        data[2] = source[2];\n        // Set when currying a bound function.\n        newBitmask |= bitmask & WRAP_BIND_FLAG ? 0 : WRAP_CURRY_BOUND_FLAG;\n      }\n      // Compose partial arguments.\n      var value = source[3];\n      if (value) {\n        var partials = data[3];\n        data[3] = partials ? composeArgs(partials, value, source[4]) : value;\n        data[4] = partials ? replaceHolders(data[3], PLACEHOLDER) : source[4];\n      }\n      // Compose partial right arguments.\n      value = source[5];\n      if (value) {\n        partials = data[5];\n        data[5] = partials ? composeArgsRight(partials, value, source[6]) : value;\n        data[6] = partials ? replaceHolders(data[5], PLACEHOLDER) : source[6];\n      }\n      // Use source `argPos` if available.\n      value = source[7];\n      if (value) {\n        data[7] = value;\n      }\n      // Use source `ary` if it's smaller.\n      if (srcBitmask & WRAP_ARY_FLAG) {\n        data[8] = data[8] == null ? source[8] : nativeMin(data[8], source[8]);\n      }\n      // Use source `arity` if one is not provided.\n      if (data[9] == null) {\n        data[9] = source[9];\n      }\n      // Use source `func` and merge bitmasks.\n      data[0] = source[0];\n      data[1] = newBitmask;\n\n      return data;\n    }\n\n    /**\n     * This function is like\n     * [`Object.keys`](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n     * except that it includes inherited enumerable properties.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names.\n     */\n    function nativeKeysIn(object) {\n      var result = [];\n      if (object != null) {\n        for (var key in Object(object)) {\n          result.push(key);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * Converts `value` to a string using `Object.prototype.toString`.\n     *\n     * @private\n     * @param {*} value The value to convert.\n     * @returns {string} Returns the converted string.\n     */\n    function objectToString(value) {\n      return nativeObjectToString.call(value);\n    }\n\n    /**\n     * A specialized version of `baseRest` which transforms the rest array.\n     *\n     * @private\n     * @param {Function} func The function to apply a rest parameter to.\n     * @param {number} [start=func.length-1] The start position of the rest parameter.\n     * @param {Function} transform The rest array transform.\n     * @returns {Function} Returns the new function.\n     */\n    function overRest(func, start, transform) {\n      start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n      return function() {\n        var args = arguments,\n            index = -1,\n            length = nativeMax(args.length - start, 0),\n            array = Array(length);\n\n        while (++index < length) {\n          array[index] = args[start + index];\n        }\n        index = -1;\n        var otherArgs = Array(start + 1);\n        while (++index < start) {\n          otherArgs[index] = args[index];\n        }\n        otherArgs[start] = transform(array);\n        return apply(func, this, otherArgs);\n      };\n    }\n\n    /**\n     * Gets the parent value at `path` of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {Array} path The path to get the parent value of.\n     * @returns {*} Returns the parent value.\n     */\n    function parent(object, path) {\n      return path.length < 2 ? object : baseGet(object, baseSlice(path, 0, -1));\n    }\n\n    /**\n     * Reorder `array` according to the specified indexes where the element at\n     * the first index is assigned as the first element, the element at\n     * the second index is assigned as the second element, and so on.\n     *\n     * @private\n     * @param {Array} array The array to reorder.\n     * @param {Array} indexes The arranged array indexes.\n     * @returns {Array} Returns `array`.\n     */\n    function reorder(array, indexes) {\n      var arrLength = array.length,\n          length = nativeMin(indexes.length, arrLength),\n          oldArray = copyArray(array);\n\n      while (length--) {\n        var index = indexes[length];\n        array[length] = isIndex(index, arrLength) ? oldArray[index] : undefined;\n      }\n      return array;\n    }\n\n    /**\n     * Gets the value at `key`, unless `key` is \"__proto__\" or \"constructor\".\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {string} key The key of the property to get.\n     * @returns {*} Returns the property value.\n     */\n    function safeGet(object, key) {\n      if (key === 'constructor' && typeof object[key] === 'function') {\n        return;\n      }\n\n      if (key == '__proto__') {\n        return;\n      }\n\n      return object[key];\n    }\n\n    /**\n     * Sets metadata for `func`.\n     *\n     * **Note:** If this function becomes hot, i.e. is invoked a lot in a short\n     * period of time, it will trip its breaker and transition to an identity\n     * function to avoid garbage collection pauses in V8. See\n     * [V8 issue 2070](https://bugs.chromium.org/p/v8/issues/detail?id=2070)\n     * for more details.\n     *\n     * @private\n     * @param {Function} func The function to associate metadata with.\n     * @param {*} data The metadata.\n     * @returns {Function} Returns `func`.\n     */\n    var setData = shortOut(baseSetData);\n\n    /**\n     * A simple wrapper around the global [`setTimeout`](https://mdn.io/setTimeout).\n     *\n     * @private\n     * @param {Function} func The function to delay.\n     * @param {number} wait The number of milliseconds to delay invocation.\n     * @returns {number|Object} Returns the timer id or timeout object.\n     */\n    var setTimeout = ctxSetTimeout || function(func, wait) {\n      return root.setTimeout(func, wait);\n    };\n\n    /**\n     * Sets the `toString` method of `func` to return `string`.\n     *\n     * @private\n     * @param {Function} func The function to modify.\n     * @param {Function} string The `toString` result.\n     * @returns {Function} Returns `func`.\n     */\n    var setToString = shortOut(baseSetToString);\n\n    /**\n     * Sets the `toString` method of `wrapper` to mimic the source of `reference`\n     * with wrapper details in a comment at the top of the source body.\n     *\n     * @private\n     * @param {Function} wrapper The function to modify.\n     * @param {Function} reference The reference function.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @returns {Function} Returns `wrapper`.\n     */\n    function setWrapToString(wrapper, reference, bitmask) {\n      var source = (reference + '');\n      return setToString(wrapper, insertWrapDetails(source, updateWrapDetails(getWrapDetails(source), bitmask)));\n    }\n\n    /**\n     * Creates a function that'll short out and invoke `identity` instead\n     * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`\n     * milliseconds.\n     *\n     * @private\n     * @param {Function} func The function to restrict.\n     * @returns {Function} Returns the new shortable function.\n     */\n    function shortOut(func) {\n      var count = 0,\n          lastCalled = 0;\n\n      return function() {\n        var stamp = nativeNow(),\n            remaining = HOT_SPAN - (stamp - lastCalled);\n\n        lastCalled = stamp;\n        if (remaining > 0) {\n          if (++count >= HOT_COUNT) {\n            return arguments[0];\n          }\n        } else {\n          count = 0;\n        }\n        return func.apply(undefined, arguments);\n      };\n    }\n\n    /**\n     * A specialized version of `_.shuffle` which mutates and sets the size of `array`.\n     *\n     * @private\n     * @param {Array} array The array to shuffle.\n     * @param {number} [size=array.length] The size of `array`.\n     * @returns {Array} Returns `array`.\n     */\n    function shuffleSelf(array, size) {\n      var index = -1,\n          length = array.length,\n          lastIndex = length - 1;\n\n      size = size === undefined ? length : size;\n      while (++index < size) {\n        var rand = baseRandom(index, lastIndex),\n            value = array[rand];\n\n        array[rand] = array[index];\n        array[index] = value;\n      }\n      array.length = size;\n      return array;\n    }\n\n    /**\n     * Converts `string` to a property path array.\n     *\n     * @private\n     * @param {string} string The string to convert.\n     * @returns {Array} Returns the property path array.\n     */\n    var stringToPath = memoizeCapped(function(string) {\n      var result = [];\n      if (string.charCodeAt(0) === 46 /* . */) {\n        result.push('');\n      }\n      string.replace(rePropName, function(match, number, quote, subString) {\n        result.push(quote ? subString.replace(reEscapeChar, '$1') : (number || match));\n      });\n      return result;\n    });\n\n    /**\n     * Converts `value` to a string key if it's not a string or symbol.\n     *\n     * @private\n     * @param {*} value The value to inspect.\n     * @returns {string|symbol} Returns the key.\n     */\n    function toKey(value) {\n      if (typeof value == 'string' || isSymbol(value)) {\n        return value;\n      }\n      var result = (value + '');\n      return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n    }\n\n    /**\n     * Converts `func` to its source code.\n     *\n     * @private\n     * @param {Function} func The function to convert.\n     * @returns {string} Returns the source code.\n     */\n    function toSource(func) {\n      if (func != null) {\n        try {\n          return funcToString.call(func);\n        } catch (e) {}\n        try {\n          return (func + '');\n        } catch (e) {}\n      }\n      return '';\n    }\n\n    /**\n     * Updates wrapper `details` based on `bitmask` flags.\n     *\n     * @private\n     * @returns {Array} details The details to modify.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @returns {Array} Returns `details`.\n     */\n    function updateWrapDetails(details, bitmask) {\n      arrayEach(wrapFlags, function(pair) {\n        var value = '_.' + pair[0];\n        if ((bitmask & pair[1]) && !arrayIncludes(details, value)) {\n          details.push(value);\n        }\n      });\n      return details.sort();\n    }\n\n    /**\n     * Creates a clone of `wrapper`.\n     *\n     * @private\n     * @param {Object} wrapper The wrapper to clone.\n     * @returns {Object} Returns the cloned wrapper.\n     */\n    function wrapperClone(wrapper) {\n      if (wrapper instanceof LazyWrapper) {\n        return wrapper.clone();\n      }\n      var result = new LodashWrapper(wrapper.__wrapped__, wrapper.__chain__);\n      result.__actions__ = copyArray(wrapper.__actions__);\n      result.__index__  = wrapper.__index__;\n      result.__values__ = wrapper.__values__;\n      return result;\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates an array of elements split into groups the length of `size`.\n     * If `array` can't be split evenly, the final chunk will be the remaining\n     * elements.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to process.\n     * @param {number} [size=1] The length of each chunk\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the new array of chunks.\n     * @example\n     *\n     * _.chunk(['a', 'b', 'c', 'd'], 2);\n     * // => [['a', 'b'], ['c', 'd']]\n     *\n     * _.chunk(['a', 'b', 'c', 'd'], 3);\n     * // => [['a', 'b', 'c'], ['d']]\n     */\n    function chunk(array, size, guard) {\n      if ((guard ? isIterateeCall(array, size, guard) : size === undefined)) {\n        size = 1;\n      } else {\n        size = nativeMax(toInteger(size), 0);\n      }\n      var length = array == null ? 0 : array.length;\n      if (!length || size < 1) {\n        return [];\n      }\n      var index = 0,\n          resIndex = 0,\n          result = Array(nativeCeil(length / size));\n\n      while (index < length) {\n        result[resIndex++] = baseSlice(array, index, (index += size));\n      }\n      return result;\n    }\n\n    /**\n     * Creates an array with all falsey values removed. The values `false`, `null`,\n     * `0`, `\"\"`, `undefined`, and `NaN` are falsey.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to compact.\n     * @returns {Array} Returns the new array of filtered values.\n     * @example\n     *\n     * _.compact([0, 1, false, 2, '', 3]);\n     * // => [1, 2, 3]\n     */\n    function compact(array) {\n      var index = -1,\n          length = array == null ? 0 : array.length,\n          resIndex = 0,\n          result = [];\n\n      while (++index < length) {\n        var value = array[index];\n        if (value) {\n          result[resIndex++] = value;\n        }\n      }\n      return result;\n    }\n\n    /**\n     * Creates a new array concatenating `array` with any additional arrays\n     * and/or values.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to concatenate.\n     * @param {...*} [values] The values to concatenate.\n     * @returns {Array} Returns the new concatenated array.\n     * @example\n     *\n     * var array = [1];\n     * var other = _.concat(array, 2, [3], [[4]]);\n     *\n     * console.log(other);\n     * // => [1, 2, 3, [4]]\n     *\n     * console.log(array);\n     * // => [1]\n     */\n    function concat() {\n      var length = arguments.length;\n      if (!length) {\n        return [];\n      }\n      var args = Array(length - 1),\n          array = arguments[0],\n          index = length;\n\n      while (index--) {\n        args[index - 1] = arguments[index];\n      }\n      return arrayPush(isArray(array) ? copyArray(array) : [array], baseFlatten(args, 1));\n    }\n\n    /**\n     * Creates an array of `array` values not included in the other given arrays\n     * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons. The order and references of result values are\n     * determined by the first array.\n     *\n     * **Note:** Unlike `_.pullAll`, this method returns a new array.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {...Array} [values] The values to exclude.\n     * @returns {Array} Returns the new array of filtered values.\n     * @see _.without, _.xor\n     * @example\n     *\n     * _.difference([2, 1], [2, 3]);\n     * // => [1]\n     */\n    var difference = baseRest(function(array, values) {\n      return isArrayLikeObject(array)\n        ? baseDifference(array, baseFlatten(values, 1, isArrayLikeObject, true))\n        : [];\n    });\n\n    /**\n     * This method is like `_.difference` except that it accepts `iteratee` which\n     * is invoked for each element of `array` and `values` to generate the criterion\n     * by which they're compared. The order and references of result values are\n     * determined by the first array. The iteratee is invoked with one argument:\n     * (value).\n     *\n     * **Note:** Unlike `_.pullAllBy`, this method returns a new array.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {...Array} [values] The values to exclude.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Array} Returns the new array of filtered values.\n     * @example\n     *\n     * _.differenceBy([2.1, 1.2], [2.3, 3.4], Math.floor);\n     * // => [1.2]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.differenceBy([{ 'x': 2 }, { 'x': 1 }], [{ 'x': 1 }], 'x');\n     * // => [{ 'x': 2 }]\n     */\n    var differenceBy = baseRest(function(array, values) {\n      var iteratee = last(values);\n      if (isArrayLikeObject(iteratee)) {\n        iteratee = undefined;\n      }\n      return isArrayLikeObject(array)\n        ? baseDifference(array, baseFlatten(values, 1, isArrayLikeObject, true), getIteratee(iteratee, 2))\n        : [];\n    });\n\n    /**\n     * This method is like `_.difference` except that it accepts `comparator`\n     * which is invoked to compare elements of `array` to `values`. The order and\n     * references of result values are determined by the first array. The comparator\n     * is invoked with two arguments: (arrVal, othVal).\n     *\n     * **Note:** Unlike `_.pullAllWith`, this method returns a new array.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {...Array} [values] The values to exclude.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of filtered values.\n     * @example\n     *\n     * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }];\n     *\n     * _.differenceWith(objects, [{ 'x': 1, 'y': 2 }], _.isEqual);\n     * // => [{ 'x': 2, 'y': 1 }]\n     */\n    var differenceWith = baseRest(function(array, values) {\n      var comparator = last(values);\n      if (isArrayLikeObject(comparator)) {\n        comparator = undefined;\n      }\n      return isArrayLikeObject(array)\n        ? baseDifference(array, baseFlatten(values, 1, isArrayLikeObject, true), undefined, comparator)\n        : [];\n    });\n\n    /**\n     * Creates a slice of `array` with `n` elements dropped from the beginning.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.5.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {number} [n=1] The number of elements to drop.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * _.drop([1, 2, 3]);\n     * // => [2, 3]\n     *\n     * _.drop([1, 2, 3], 2);\n     * // => [3]\n     *\n     * _.drop([1, 2, 3], 5);\n     * // => []\n     *\n     * _.drop([1, 2, 3], 0);\n     * // => [1, 2, 3]\n     */\n    function drop(array, n, guard) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return [];\n      }\n      n = (guard || n === undefined) ? 1 : toInteger(n);\n      return baseSlice(array, n < 0 ? 0 : n, length);\n    }\n\n    /**\n     * Creates a slice of `array` with `n` elements dropped from the end.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {number} [n=1] The number of elements to drop.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * _.dropRight([1, 2, 3]);\n     * // => [1, 2]\n     *\n     * _.dropRight([1, 2, 3], 2);\n     * // => [1]\n     *\n     * _.dropRight([1, 2, 3], 5);\n     * // => []\n     *\n     * _.dropRight([1, 2, 3], 0);\n     * // => [1, 2, 3]\n     */\n    function dropRight(array, n, guard) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return [];\n      }\n      n = (guard || n === undefined) ? 1 : toInteger(n);\n      n = length - n;\n      return baseSlice(array, 0, n < 0 ? 0 : n);\n    }\n\n    /**\n     * Creates a slice of `array` excluding elements dropped from the end.\n     * Elements are dropped until `predicate` returns falsey. The predicate is\n     * invoked with three arguments: (value, index, array).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'active': true },\n     *   { 'user': 'fred',    'active': false },\n     *   { 'user': 'pebbles', 'active': false }\n     * ];\n     *\n     * _.dropRightWhile(users, function(o) { return !o.active; });\n     * // => objects for ['barney']\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.dropRightWhile(users, { 'user': 'pebbles', 'active': false });\n     * // => objects for ['barney', 'fred']\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.dropRightWhile(users, ['active', false]);\n     * // => objects for ['barney']\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.dropRightWhile(users, 'active');\n     * // => objects for ['barney', 'fred', 'pebbles']\n     */\n    function dropRightWhile(array, predicate) {\n      return (array && array.length)\n        ? baseWhile(array, getIteratee(predicate, 3), true, true)\n        : [];\n    }\n\n    /**\n     * Creates a slice of `array` excluding elements dropped from the beginning.\n     * Elements are dropped until `predicate` returns falsey. The predicate is\n     * invoked with three arguments: (value, index, array).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'active': false },\n     *   { 'user': 'fred',    'active': false },\n     *   { 'user': 'pebbles', 'active': true }\n     * ];\n     *\n     * _.dropWhile(users, function(o) { return !o.active; });\n     * // => objects for ['pebbles']\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.dropWhile(users, { 'user': 'barney', 'active': false });\n     * // => objects for ['fred', 'pebbles']\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.dropWhile(users, ['active', false]);\n     * // => objects for ['pebbles']\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.dropWhile(users, 'active');\n     * // => objects for ['barney', 'fred', 'pebbles']\n     */\n    function dropWhile(array, predicate) {\n      return (array && array.length)\n        ? baseWhile(array, getIteratee(predicate, 3), true)\n        : [];\n    }\n\n    /**\n     * Fills elements of `array` with `value` from `start` up to, but not\n     * including, `end`.\n     *\n     * **Note:** This method mutates `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.2.0\n     * @category Array\n     * @param {Array} array The array to fill.\n     * @param {*} value The value to fill `array` with.\n     * @param {number} [start=0] The start position.\n     * @param {number} [end=array.length] The end position.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = [1, 2, 3];\n     *\n     * _.fill(array, 'a');\n     * console.log(array);\n     * // => ['a', 'a', 'a']\n     *\n     * _.fill(Array(3), 2);\n     * // => [2, 2, 2]\n     *\n     * _.fill([4, 6, 8, 10], '*', 1, 3);\n     * // => [4, '*', '*', 10]\n     */\n    function fill(array, value, start, end) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return [];\n      }\n      if (start && typeof start != 'number' && isIterateeCall(array, value, start)) {\n        start = 0;\n        end = length;\n      }\n      return baseFill(array, value, start, end);\n    }\n\n    /**\n     * This method is like `_.find` except that it returns the index of the first\n     * element `predicate` returns truthy for instead of the element itself.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.1.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @param {number} [fromIndex=0] The index to search from.\n     * @returns {number} Returns the index of the found element, else `-1`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'active': false },\n     *   { 'user': 'fred',    'active': false },\n     *   { 'user': 'pebbles', 'active': true }\n     * ];\n     *\n     * _.findIndex(users, function(o) { return o.user == 'barney'; });\n     * // => 0\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.findIndex(users, { 'user': 'fred', 'active': false });\n     * // => 1\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.findIndex(users, ['active', false]);\n     * // => 0\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.findIndex(users, 'active');\n     * // => 2\n     */\n    function findIndex(array, predicate, fromIndex) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return -1;\n      }\n      var index = fromIndex == null ? 0 : toInteger(fromIndex);\n      if (index < 0) {\n        index = nativeMax(length + index, 0);\n      }\n      return baseFindIndex(array, getIteratee(predicate, 3), index);\n    }\n\n    /**\n     * This method is like `_.findIndex` except that it iterates over elements\n     * of `collection` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @param {number} [fromIndex=array.length-1] The index to search from.\n     * @returns {number} Returns the index of the found element, else `-1`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'active': true },\n     *   { 'user': 'fred',    'active': false },\n     *   { 'user': 'pebbles', 'active': false }\n     * ];\n     *\n     * _.findLastIndex(users, function(o) { return o.user == 'pebbles'; });\n     * // => 2\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.findLastIndex(users, { 'user': 'barney', 'active': true });\n     * // => 0\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.findLastIndex(users, ['active', false]);\n     * // => 2\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.findLastIndex(users, 'active');\n     * // => 0\n     */\n    function findLastIndex(array, predicate, fromIndex) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return -1;\n      }\n      var index = length - 1;\n      if (fromIndex !== undefined) {\n        index = toInteger(fromIndex);\n        index = fromIndex < 0\n          ? nativeMax(length + index, 0)\n          : nativeMin(index, length - 1);\n      }\n      return baseFindIndex(array, getIteratee(predicate, 3), index, true);\n    }\n\n    /**\n     * Flattens `array` a single level deep.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to flatten.\n     * @returns {Array} Returns the new flattened array.\n     * @example\n     *\n     * _.flatten([1, [2, [3, [4]], 5]]);\n     * // => [1, 2, [3, [4]], 5]\n     */\n    function flatten(array) {\n      var length = array == null ? 0 : array.length;\n      return length ? baseFlatten(array, 1) : [];\n    }\n\n    /**\n     * Recursively flattens `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to flatten.\n     * @returns {Array} Returns the new flattened array.\n     * @example\n     *\n     * _.flattenDeep([1, [2, [3, [4]], 5]]);\n     * // => [1, 2, 3, 4, 5]\n     */\n    function flattenDeep(array) {\n      var length = array == null ? 0 : array.length;\n      return length ? baseFlatten(array, INFINITY) : [];\n    }\n\n    /**\n     * Recursively flatten `array` up to `depth` times.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.4.0\n     * @category Array\n     * @param {Array} array The array to flatten.\n     * @param {number} [depth=1] The maximum recursion depth.\n     * @returns {Array} Returns the new flattened array.\n     * @example\n     *\n     * var array = [1, [2, [3, [4]], 5]];\n     *\n     * _.flattenDepth(array, 1);\n     * // => [1, 2, [3, [4]], 5]\n     *\n     * _.flattenDepth(array, 2);\n     * // => [1, 2, 3, [4], 5]\n     */\n    function flattenDepth(array, depth) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return [];\n      }\n      depth = depth === undefined ? 1 : toInteger(depth);\n      return baseFlatten(array, depth);\n    }\n\n    /**\n     * The inverse of `_.toPairs`; this method returns an object composed\n     * from key-value `pairs`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} pairs The key-value pairs.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * _.fromPairs([['a', 1], ['b', 2]]);\n     * // => { 'a': 1, 'b': 2 }\n     */\n    function fromPairs(pairs) {\n      var index = -1,\n          length = pairs == null ? 0 : pairs.length,\n          result = {};\n\n      while (++index < length) {\n        var pair = pairs[index];\n        result[pair[0]] = pair[1];\n      }\n      return result;\n    }\n\n    /**\n     * Gets the first element of `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @alias first\n     * @category Array\n     * @param {Array} array The array to query.\n     * @returns {*} Returns the first element of `array`.\n     * @example\n     *\n     * _.head([1, 2, 3]);\n     * // => 1\n     *\n     * _.head([]);\n     * // => undefined\n     */\n    function head(array) {\n      return (array && array.length) ? array[0] : undefined;\n    }\n\n    /**\n     * Gets the index at which the first occurrence of `value` is found in `array`\n     * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons. If `fromIndex` is negative, it's used as the\n     * offset from the end of `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {*} value The value to search for.\n     * @param {number} [fromIndex=0] The index to search from.\n     * @returns {number} Returns the index of the matched value, else `-1`.\n     * @example\n     *\n     * _.indexOf([1, 2, 1, 2], 2);\n     * // => 1\n     *\n     * // Search from the `fromIndex`.\n     * _.indexOf([1, 2, 1, 2], 2, 2);\n     * // => 3\n     */\n    function indexOf(array, value, fromIndex) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return -1;\n      }\n      var index = fromIndex == null ? 0 : toInteger(fromIndex);\n      if (index < 0) {\n        index = nativeMax(length + index, 0);\n      }\n      return baseIndexOf(array, value, index);\n    }\n\n    /**\n     * Gets all but the last element of `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * _.initial([1, 2, 3]);\n     * // => [1, 2]\n     */\n    function initial(array) {\n      var length = array == null ? 0 : array.length;\n      return length ? baseSlice(array, 0, -1) : [];\n    }\n\n    /**\n     * Creates an array of unique values that are included in all given arrays\n     * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons. The order and references of result values are\n     * determined by the first array.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @returns {Array} Returns the new array of intersecting values.\n     * @example\n     *\n     * _.intersection([2, 1], [2, 3]);\n     * // => [2]\n     */\n    var intersection = baseRest(function(arrays) {\n      var mapped = arrayMap(arrays, castArrayLikeObject);\n      return (mapped.length && mapped[0] === arrays[0])\n        ? baseIntersection(mapped)\n        : [];\n    });\n\n    /**\n     * This method is like `_.intersection` except that it accepts `iteratee`\n     * which is invoked for each element of each `arrays` to generate the criterion\n     * by which they're compared. The order and references of result values are\n     * determined by the first array. The iteratee is invoked with one argument:\n     * (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Array} Returns the new array of intersecting values.\n     * @example\n     *\n     * _.intersectionBy([2.1, 1.2], [2.3, 3.4], Math.floor);\n     * // => [2.1]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.intersectionBy([{ 'x': 1 }], [{ 'x': 2 }, { 'x': 1 }], 'x');\n     * // => [{ 'x': 1 }]\n     */\n    var intersectionBy = baseRest(function(arrays) {\n      var iteratee = last(arrays),\n          mapped = arrayMap(arrays, castArrayLikeObject);\n\n      if (iteratee === last(mapped)) {\n        iteratee = undefined;\n      } else {\n        mapped.pop();\n      }\n      return (mapped.length && mapped[0] === arrays[0])\n        ? baseIntersection(mapped, getIteratee(iteratee, 2))\n        : [];\n    });\n\n    /**\n     * This method is like `_.intersection` except that it accepts `comparator`\n     * which is invoked to compare elements of `arrays`. The order and references\n     * of result values are determined by the first array. The comparator is\n     * invoked with two arguments: (arrVal, othVal).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of intersecting values.\n     * @example\n     *\n     * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }];\n     * var others = [{ 'x': 1, 'y': 1 }, { 'x': 1, 'y': 2 }];\n     *\n     * _.intersectionWith(objects, others, _.isEqual);\n     * // => [{ 'x': 1, 'y': 2 }]\n     */\n    var intersectionWith = baseRest(function(arrays) {\n      var comparator = last(arrays),\n          mapped = arrayMap(arrays, castArrayLikeObject);\n\n      comparator = typeof comparator == 'function' ? comparator : undefined;\n      if (comparator) {\n        mapped.pop();\n      }\n      return (mapped.length && mapped[0] === arrays[0])\n        ? baseIntersection(mapped, undefined, comparator)\n        : [];\n    });\n\n    /**\n     * Converts all elements in `array` into a string separated by `separator`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to convert.\n     * @param {string} [separator=','] The element separator.\n     * @returns {string} Returns the joined string.\n     * @example\n     *\n     * _.join(['a', 'b', 'c'], '~');\n     * // => 'a~b~c'\n     */\n    function join(array, separator) {\n      return array == null ? '' : nativeJoin.call(array, separator);\n    }\n\n    /**\n     * Gets the last element of `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @returns {*} Returns the last element of `array`.\n     * @example\n     *\n     * _.last([1, 2, 3]);\n     * // => 3\n     */\n    function last(array) {\n      var length = array == null ? 0 : array.length;\n      return length ? array[length - 1] : undefined;\n    }\n\n    /**\n     * This method is like `_.indexOf` except that it iterates over elements of\n     * `array` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {*} value The value to search for.\n     * @param {number} [fromIndex=array.length-1] The index to search from.\n     * @returns {number} Returns the index of the matched value, else `-1`.\n     * @example\n     *\n     * _.lastIndexOf([1, 2, 1, 2], 2);\n     * // => 3\n     *\n     * // Search from the `fromIndex`.\n     * _.lastIndexOf([1, 2, 1, 2], 2, 2);\n     * // => 1\n     */\n    function lastIndexOf(array, value, fromIndex) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return -1;\n      }\n      var index = length;\n      if (fromIndex !== undefined) {\n        index = toInteger(fromIndex);\n        index = index < 0 ? nativeMax(length + index, 0) : nativeMin(index, length - 1);\n      }\n      return value === value\n        ? strictLastIndexOf(array, value, index)\n        : baseFindIndex(array, baseIsNaN, index, true);\n    }\n\n    /**\n     * Gets the element at index `n` of `array`. If `n` is negative, the nth\n     * element from the end is returned.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.11.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {number} [n=0] The index of the element to return.\n     * @returns {*} Returns the nth element of `array`.\n     * @example\n     *\n     * var array = ['a', 'b', 'c', 'd'];\n     *\n     * _.nth(array, 1);\n     * // => 'b'\n     *\n     * _.nth(array, -2);\n     * // => 'c';\n     */\n    function nth(array, n) {\n      return (array && array.length) ? baseNth(array, toInteger(n)) : undefined;\n    }\n\n    /**\n     * Removes all given values from `array` using\n     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons.\n     *\n     * **Note:** Unlike `_.without`, this method mutates `array`. Use `_.remove`\n     * to remove elements from an array by predicate.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @param {...*} [values] The values to remove.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = ['a', 'b', 'c', 'a', 'b', 'c'];\n     *\n     * _.pull(array, 'a', 'c');\n     * console.log(array);\n     * // => ['b', 'b']\n     */\n    var pull = baseRest(pullAll);\n\n    /**\n     * This method is like `_.pull` except that it accepts an array of values to remove.\n     *\n     * **Note:** Unlike `_.difference`, this method mutates `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @param {Array} values The values to remove.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = ['a', 'b', 'c', 'a', 'b', 'c'];\n     *\n     * _.pullAll(array, ['a', 'c']);\n     * console.log(array);\n     * // => ['b', 'b']\n     */\n    function pullAll(array, values) {\n      return (array && array.length && values && values.length)\n        ? basePullAll(array, values)\n        : array;\n    }\n\n    /**\n     * This method is like `_.pullAll` except that it accepts `iteratee` which is\n     * invoked for each element of `array` and `values` to generate the criterion\n     * by which they're compared. The iteratee is invoked with one argument: (value).\n     *\n     * **Note:** Unlike `_.differenceBy`, this method mutates `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @param {Array} values The values to remove.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = [{ 'x': 1 }, { 'x': 2 }, { 'x': 3 }, { 'x': 1 }];\n     *\n     * _.pullAllBy(array, [{ 'x': 1 }, { 'x': 3 }], 'x');\n     * console.log(array);\n     * // => [{ 'x': 2 }]\n     */\n    function pullAllBy(array, values, iteratee) {\n      return (array && array.length && values && values.length)\n        ? basePullAll(array, values, getIteratee(iteratee, 2))\n        : array;\n    }\n\n    /**\n     * This method is like `_.pullAll` except that it accepts `comparator` which\n     * is invoked to compare elements of `array` to `values`. The comparator is\n     * invoked with two arguments: (arrVal, othVal).\n     *\n     * **Note:** Unlike `_.differenceWith`, this method mutates `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.6.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @param {Array} values The values to remove.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = [{ 'x': 1, 'y': 2 }, { 'x': 3, 'y': 4 }, { 'x': 5, 'y': 6 }];\n     *\n     * _.pullAllWith(array, [{ 'x': 3, 'y': 4 }], _.isEqual);\n     * console.log(array);\n     * // => [{ 'x': 1, 'y': 2 }, { 'x': 5, 'y': 6 }]\n     */\n    function pullAllWith(array, values, comparator) {\n      return (array && array.length && values && values.length)\n        ? basePullAll(array, values, undefined, comparator)\n        : array;\n    }\n\n    /**\n     * Removes elements from `array` corresponding to `indexes` and returns an\n     * array of removed elements.\n     *\n     * **Note:** Unlike `_.at`, this method mutates `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @param {...(number|number[])} [indexes] The indexes of elements to remove.\n     * @returns {Array} Returns the new array of removed elements.\n     * @example\n     *\n     * var array = ['a', 'b', 'c', 'd'];\n     * var pulled = _.pullAt(array, [1, 3]);\n     *\n     * console.log(array);\n     * // => ['a', 'c']\n     *\n     * console.log(pulled);\n     * // => ['b', 'd']\n     */\n    var pullAt = flatRest(function(array, indexes) {\n      var length = array == null ? 0 : array.length,\n          result = baseAt(array, indexes);\n\n      basePullAt(array, arrayMap(indexes, function(index) {\n        return isIndex(index, length) ? +index : index;\n      }).sort(compareAscending));\n\n      return result;\n    });\n\n    /**\n     * Removes all elements from `array` that `predicate` returns truthy for\n     * and returns an array of the removed elements. The predicate is invoked\n     * with three arguments: (value, index, array).\n     *\n     * **Note:** Unlike `_.filter`, this method mutates `array`. Use `_.pull`\n     * to pull elements from an array by value.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the new array of removed elements.\n     * @example\n     *\n     * var array = [1, 2, 3, 4];\n     * var evens = _.remove(array, function(n) {\n     *   return n % 2 == 0;\n     * });\n     *\n     * console.log(array);\n     * // => [1, 3]\n     *\n     * console.log(evens);\n     * // => [2, 4]\n     */\n    function remove(array, predicate) {\n      var result = [];\n      if (!(array && array.length)) {\n        return result;\n      }\n      var index = -1,\n          indexes = [],\n          length = array.length;\n\n      predicate = getIteratee(predicate, 3);\n      while (++index < length) {\n        var value = array[index];\n        if (predicate(value, index, array)) {\n          result.push(value);\n          indexes.push(index);\n        }\n      }\n      basePullAt(array, indexes);\n      return result;\n    }\n\n    /**\n     * Reverses `array` so that the first element becomes the last, the second\n     * element becomes the second to last, and so on.\n     *\n     * **Note:** This method mutates `array` and is based on\n     * [`Array#reverse`](https://mdn.io/Array/reverse).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = [1, 2, 3];\n     *\n     * _.reverse(array);\n     * // => [3, 2, 1]\n     *\n     * console.log(array);\n     * // => [3, 2, 1]\n     */\n    function reverse(array) {\n      return array == null ? array : nativeReverse.call(array);\n    }\n\n    /**\n     * Creates a slice of `array` from `start` up to, but not including, `end`.\n     *\n     * **Note:** This method is used instead of\n     * [`Array#slice`](https://mdn.io/Array/slice) to ensure dense arrays are\n     * returned.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to slice.\n     * @param {number} [start=0] The start position.\n     * @param {number} [end=array.length] The end position.\n     * @returns {Array} Returns the slice of `array`.\n     */\n    function slice(array, start, end) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return [];\n      }\n      if (end && typeof end != 'number' && isIterateeCall(array, start, end)) {\n        start = 0;\n        end = length;\n      }\n      else {\n        start = start == null ? 0 : toInteger(start);\n        end = end === undefined ? length : toInteger(end);\n      }\n      return baseSlice(array, start, end);\n    }\n\n    /**\n     * Uses a binary search to determine the lowest index at which `value`\n     * should be inserted into `array` in order to maintain its sort order.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The sorted array to inspect.\n     * @param {*} value The value to evaluate.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     * @example\n     *\n     * _.sortedIndex([30, 50], 40);\n     * // => 1\n     */\n    function sortedIndex(array, value) {\n      return baseSortedIndex(array, value);\n    }\n\n    /**\n     * This method is like `_.sortedIndex` except that it accepts `iteratee`\n     * which is invoked for `value` and each element of `array` to compute their\n     * sort ranking. The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The sorted array to inspect.\n     * @param {*} value The value to evaluate.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     * @example\n     *\n     * var objects = [{ 'x': 4 }, { 'x': 5 }];\n     *\n     * _.sortedIndexBy(objects, { 'x': 4 }, function(o) { return o.x; });\n     * // => 0\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.sortedIndexBy(objects, { 'x': 4 }, 'x');\n     * // => 0\n     */\n    function sortedIndexBy(array, value, iteratee) {\n      return baseSortedIndexBy(array, value, getIteratee(iteratee, 2));\n    }\n\n    /**\n     * This method is like `_.indexOf` except that it performs a binary\n     * search on a sorted `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {*} value The value to search for.\n     * @returns {number} Returns the index of the matched value, else `-1`.\n     * @example\n     *\n     * _.sortedIndexOf([4, 5, 5, 5, 6], 5);\n     * // => 1\n     */\n    function sortedIndexOf(array, value) {\n      var length = array == null ? 0 : array.length;\n      if (length) {\n        var index = baseSortedIndex(array, value);\n        if (index < length && eq(array[index], value)) {\n          return index;\n        }\n      }\n      return -1;\n    }\n\n    /**\n     * This method is like `_.sortedIndex` except that it returns the highest\n     * index at which `value` should be inserted into `array` in order to\n     * maintain its sort order.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The sorted array to inspect.\n     * @param {*} value The value to evaluate.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     * @example\n     *\n     * _.sortedLastIndex([4, 5, 5, 5, 6], 5);\n     * // => 4\n     */\n    function sortedLastIndex(array, value) {\n      return baseSortedIndex(array, value, true);\n    }\n\n    /**\n     * This method is like `_.sortedLastIndex` except that it accepts `iteratee`\n     * which is invoked for `value` and each element of `array` to compute their\n     * sort ranking. The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The sorted array to inspect.\n     * @param {*} value The value to evaluate.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     * @example\n     *\n     * var objects = [{ 'x': 4 }, { 'x': 5 }];\n     *\n     * _.sortedLastIndexBy(objects, { 'x': 4 }, function(o) { return o.x; });\n     * // => 1\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.sortedLastIndexBy(objects, { 'x': 4 }, 'x');\n     * // => 1\n     */\n    function sortedLastIndexBy(array, value, iteratee) {\n      return baseSortedIndexBy(array, value, getIteratee(iteratee, 2), true);\n    }\n\n    /**\n     * This method is like `_.lastIndexOf` except that it performs a binary\n     * search on a sorted `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {*} value The value to search for.\n     * @returns {number} Returns the index of the matched value, else `-1`.\n     * @example\n     *\n     * _.sortedLastIndexOf([4, 5, 5, 5, 6], 5);\n     * // => 3\n     */\n    function sortedLastIndexOf(array, value) {\n      var length = array == null ? 0 : array.length;\n      if (length) {\n        var index = baseSortedIndex(array, value, true) - 1;\n        if (eq(array[index], value)) {\n          return index;\n        }\n      }\n      return -1;\n    }\n\n    /**\n     * This method is like `_.uniq` except that it's designed and optimized\n     * for sorted arrays.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @returns {Array} Returns the new duplicate free array.\n     * @example\n     *\n     * _.sortedUniq([1, 1, 2]);\n     * // => [1, 2]\n     */\n    function sortedUniq(array) {\n      return (array && array.length)\n        ? baseSortedUniq(array)\n        : [];\n    }\n\n    /**\n     * This method is like `_.uniqBy` except that it's designed and optimized\n     * for sorted arrays.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @returns {Array} Returns the new duplicate free array.\n     * @example\n     *\n     * _.sortedUniqBy([1.1, 1.2, 2.3, 2.4], Math.floor);\n     * // => [1.1, 2.3]\n     */\n    function sortedUniqBy(array, iteratee) {\n      return (array && array.length)\n        ? baseSortedUniq(array, getIteratee(iteratee, 2))\n        : [];\n    }\n\n    /**\n     * Gets all but the first element of `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * _.tail([1, 2, 3]);\n     * // => [2, 3]\n     */\n    function tail(array) {\n      var length = array == null ? 0 : array.length;\n      return length ? baseSlice(array, 1, length) : [];\n    }\n\n    /**\n     * Creates a slice of `array` with `n` elements taken from the beginning.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {number} [n=1] The number of elements to take.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * _.take([1, 2, 3]);\n     * // => [1]\n     *\n     * _.take([1, 2, 3], 2);\n     * // => [1, 2]\n     *\n     * _.take([1, 2, 3], 5);\n     * // => [1, 2, 3]\n     *\n     * _.take([1, 2, 3], 0);\n     * // => []\n     */\n    function take(array, n, guard) {\n      if (!(array && array.length)) {\n        return [];\n      }\n      n = (guard || n === undefined) ? 1 : toInteger(n);\n      return baseSlice(array, 0, n < 0 ? 0 : n);\n    }\n\n    /**\n     * Creates a slice of `array` with `n` elements taken from the end.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {number} [n=1] The number of elements to take.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * _.takeRight([1, 2, 3]);\n     * // => [3]\n     *\n     * _.takeRight([1, 2, 3], 2);\n     * // => [2, 3]\n     *\n     * _.takeRight([1, 2, 3], 5);\n     * // => [1, 2, 3]\n     *\n     * _.takeRight([1, 2, 3], 0);\n     * // => []\n     */\n    function takeRight(array, n, guard) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return [];\n      }\n      n = (guard || n === undefined) ? 1 : toInteger(n);\n      n = length - n;\n      return baseSlice(array, n < 0 ? 0 : n, length);\n    }\n\n    /**\n     * Creates a slice of `array` with elements taken from the end. Elements are\n     * taken until `predicate` returns falsey. The predicate is invoked with\n     * three arguments: (value, index, array).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'active': true },\n     *   { 'user': 'fred',    'active': false },\n     *   { 'user': 'pebbles', 'active': false }\n     * ];\n     *\n     * _.takeRightWhile(users, function(o) { return !o.active; });\n     * // => objects for ['fred', 'pebbles']\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.takeRightWhile(users, { 'user': 'pebbles', 'active': false });\n     * // => objects for ['pebbles']\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.takeRightWhile(users, ['active', false]);\n     * // => objects for ['fred', 'pebbles']\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.takeRightWhile(users, 'active');\n     * // => []\n     */\n    function takeRightWhile(array, predicate) {\n      return (array && array.length)\n        ? baseWhile(array, getIteratee(predicate, 3), false, true)\n        : [];\n    }\n\n    /**\n     * Creates a slice of `array` with elements taken from the beginning. Elements\n     * are taken until `predicate` returns falsey. The predicate is invoked with\n     * three arguments: (value, index, array).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'active': false },\n     *   { 'user': 'fred',    'active': false },\n     *   { 'user': 'pebbles', 'active': true }\n     * ];\n     *\n     * _.takeWhile(users, function(o) { return !o.active; });\n     * // => objects for ['barney', 'fred']\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.takeWhile(users, { 'user': 'barney', 'active': false });\n     * // => objects for ['barney']\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.takeWhile(users, ['active', false]);\n     * // => objects for ['barney', 'fred']\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.takeWhile(users, 'active');\n     * // => []\n     */\n    function takeWhile(array, predicate) {\n      return (array && array.length)\n        ? baseWhile(array, getIteratee(predicate, 3))\n        : [];\n    }\n\n    /**\n     * Creates an array of unique values, in order, from all given arrays using\n     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @returns {Array} Returns the new array of combined values.\n     * @example\n     *\n     * _.union([2], [1, 2]);\n     * // => [2, 1]\n     */\n    var union = baseRest(function(arrays) {\n      return baseUniq(baseFlatten(arrays, 1, isArrayLikeObject, true));\n    });\n\n    /**\n     * This method is like `_.union` except that it accepts `iteratee` which is\n     * invoked for each element of each `arrays` to generate the criterion by\n     * which uniqueness is computed. Result values are chosen from the first\n     * array in which the value occurs. The iteratee is invoked with one argument:\n     * (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Array} Returns the new array of combined values.\n     * @example\n     *\n     * _.unionBy([2.1], [1.2, 2.3], Math.floor);\n     * // => [2.1, 1.2]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.unionBy([{ 'x': 1 }], [{ 'x': 2 }, { 'x': 1 }], 'x');\n     * // => [{ 'x': 1 }, { 'x': 2 }]\n     */\n    var unionBy = baseRest(function(arrays) {\n      var iteratee = last(arrays);\n      if (isArrayLikeObject(iteratee)) {\n        iteratee = undefined;\n      }\n      return baseUniq(baseFlatten(arrays, 1, isArrayLikeObject, true), getIteratee(iteratee, 2));\n    });\n\n    /**\n     * This method is like `_.union` except that it accepts `comparator` which\n     * is invoked to compare elements of `arrays`. Result values are chosen from\n     * the first array in which the value occurs. The comparator is invoked\n     * with two arguments: (arrVal, othVal).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of combined values.\n     * @example\n     *\n     * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }];\n     * var others = [{ 'x': 1, 'y': 1 }, { 'x': 1, 'y': 2 }];\n     *\n     * _.unionWith(objects, others, _.isEqual);\n     * // => [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }, { 'x': 1, 'y': 1 }]\n     */\n    var unionWith = baseRest(function(arrays) {\n      var comparator = last(arrays);\n      comparator = typeof comparator == 'function' ? comparator : undefined;\n      return baseUniq(baseFlatten(arrays, 1, isArrayLikeObject, true), undefined, comparator);\n    });\n\n    /**\n     * Creates a duplicate-free version of an array, using\n     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons, in which only the first occurrence of each element\n     * is kept. The order of result values is determined by the order they occur\n     * in the array.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @returns {Array} Returns the new duplicate free array.\n     * @example\n     *\n     * _.uniq([2, 1, 2]);\n     * // => [2, 1]\n     */\n    function uniq(array) {\n      return (array && array.length) ? baseUniq(array) : [];\n    }\n\n    /**\n     * This method is like `_.uniq` except that it accepts `iteratee` which is\n     * invoked for each element in `array` to generate the criterion by which\n     * uniqueness is computed. The order of result values is determined by the\n     * order they occur in the array. The iteratee is invoked with one argument:\n     * (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Array} Returns the new duplicate free array.\n     * @example\n     *\n     * _.uniqBy([2.1, 1.2, 2.3], Math.floor);\n     * // => [2.1, 1.2]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.uniqBy([{ 'x': 1 }, { 'x': 2 }, { 'x': 1 }], 'x');\n     * // => [{ 'x': 1 }, { 'x': 2 }]\n     */\n    function uniqBy(array, iteratee) {\n      return (array && array.length) ? baseUniq(array, getIteratee(iteratee, 2)) : [];\n    }\n\n    /**\n     * This method is like `_.uniq` except that it accepts `comparator` which\n     * is invoked to compare elements of `array`. The order of result values is\n     * determined by the order they occur in the array.The comparator is invoked\n     * with two arguments: (arrVal, othVal).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new duplicate free array.\n     * @example\n     *\n     * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }, { 'x': 1, 'y': 2 }];\n     *\n     * _.uniqWith(objects, _.isEqual);\n     * // => [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }]\n     */\n    function uniqWith(array, comparator) {\n      comparator = typeof comparator == 'function' ? comparator : undefined;\n      return (array && array.length) ? baseUniq(array, undefined, comparator) : [];\n    }\n\n    /**\n     * This method is like `_.zip` except that it accepts an array of grouped\n     * elements and creates an array regrouping the elements to their pre-zip\n     * configuration.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.2.0\n     * @category Array\n     * @param {Array} array The array of grouped elements to process.\n     * @returns {Array} Returns the new array of regrouped elements.\n     * @example\n     *\n     * var zipped = _.zip(['a', 'b'], [1, 2], [true, false]);\n     * // => [['a', 1, true], ['b', 2, false]]\n     *\n     * _.unzip(zipped);\n     * // => [['a', 'b'], [1, 2], [true, false]]\n     */\n    function unzip(array) {\n      if (!(array && array.length)) {\n        return [];\n      }\n      var length = 0;\n      array = arrayFilter(array, function(group) {\n        if (isArrayLikeObject(group)) {\n          length = nativeMax(group.length, length);\n          return true;\n        }\n      });\n      return baseTimes(length, function(index) {\n        return arrayMap(array, baseProperty(index));\n      });\n    }\n\n    /**\n     * This method is like `_.unzip` except that it accepts `iteratee` to specify\n     * how regrouped values should be combined. The iteratee is invoked with the\n     * elements of each group: (...group).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.8.0\n     * @category Array\n     * @param {Array} array The array of grouped elements to process.\n     * @param {Function} [iteratee=_.identity] The function to combine\n     *  regrouped values.\n     * @returns {Array} Returns the new array of regrouped elements.\n     * @example\n     *\n     * var zipped = _.zip([1, 2], [10, 20], [100, 200]);\n     * // => [[1, 10, 100], [2, 20, 200]]\n     *\n     * _.unzipWith(zipped, _.add);\n     * // => [3, 30, 300]\n     */\n    function unzipWith(array, iteratee) {\n      if (!(array && array.length)) {\n        return [];\n      }\n      var result = unzip(array);\n      if (iteratee == null) {\n        return result;\n      }\n      return arrayMap(result, function(group) {\n        return apply(iteratee, undefined, group);\n      });\n    }\n\n    /**\n     * Creates an array excluding all given values using\n     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons.\n     *\n     * **Note:** Unlike `_.pull`, this method returns a new array.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {...*} [values] The values to exclude.\n     * @returns {Array} Returns the new array of filtered values.\n     * @see _.difference, _.xor\n     * @example\n     *\n     * _.without([2, 1, 2, 3], 1, 2);\n     * // => [3]\n     */\n    var without = baseRest(function(array, values) {\n      return isArrayLikeObject(array)\n        ? baseDifference(array, values)\n        : [];\n    });\n\n    /**\n     * Creates an array of unique values that is the\n     * [symmetric difference](https://en.wikipedia.org/wiki/Symmetric_difference)\n     * of the given arrays. The order of result values is determined by the order\n     * they occur in the arrays.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.4.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @returns {Array} Returns the new array of filtered values.\n     * @see _.difference, _.without\n     * @example\n     *\n     * _.xor([2, 1], [2, 3]);\n     * // => [1, 3]\n     */\n    var xor = baseRest(function(arrays) {\n      return baseXor(arrayFilter(arrays, isArrayLikeObject));\n    });\n\n    /**\n     * This method is like `_.xor` except that it accepts `iteratee` which is\n     * invoked for each element of each `arrays` to generate the criterion by\n     * which by which they're compared. The order of result values is determined\n     * by the order they occur in the arrays. The iteratee is invoked with one\n     * argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Array} Returns the new array of filtered values.\n     * @example\n     *\n     * _.xorBy([2.1, 1.2], [2.3, 3.4], Math.floor);\n     * // => [1.2, 3.4]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.xorBy([{ 'x': 1 }], [{ 'x': 2 }, { 'x': 1 }], 'x');\n     * // => [{ 'x': 2 }]\n     */\n    var xorBy = baseRest(function(arrays) {\n      var iteratee = last(arrays);\n      if (isArrayLikeObject(iteratee)) {\n        iteratee = undefined;\n      }\n      return baseXor(arrayFilter(arrays, isArrayLikeObject), getIteratee(iteratee, 2));\n    });\n\n    /**\n     * This method is like `_.xor` except that it accepts `comparator` which is\n     * invoked to compare elements of `arrays`. The order of result values is\n     * determined by the order they occur in the arrays. The comparator is invoked\n     * with two arguments: (arrVal, othVal).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of filtered values.\n     * @example\n     *\n     * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }];\n     * var others = [{ 'x': 1, 'y': 1 }, { 'x': 1, 'y': 2 }];\n     *\n     * _.xorWith(objects, others, _.isEqual);\n     * // => [{ 'x': 2, 'y': 1 }, { 'x': 1, 'y': 1 }]\n     */\n    var xorWith = baseRest(function(arrays) {\n      var comparator = last(arrays);\n      comparator = typeof comparator == 'function' ? comparator : undefined;\n      return baseXor(arrayFilter(arrays, isArrayLikeObject), undefined, comparator);\n    });\n\n    /**\n     * Creates an array of grouped elements, the first of which contains the\n     * first elements of the given arrays, the second of which contains the\n     * second elements of the given arrays, and so on.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to process.\n     * @returns {Array} Returns the new array of grouped elements.\n     * @example\n     *\n     * _.zip(['a', 'b'], [1, 2], [true, false]);\n     * // => [['a', 1, true], ['b', 2, false]]\n     */\n    var zip = baseRest(unzip);\n\n    /**\n     * This method is like `_.fromPairs` except that it accepts two arrays,\n     * one of property identifiers and one of corresponding values.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.4.0\n     * @category Array\n     * @param {Array} [props=[]] The property identifiers.\n     * @param {Array} [values=[]] The property values.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * _.zipObject(['a', 'b'], [1, 2]);\n     * // => { 'a': 1, 'b': 2 }\n     */\n    function zipObject(props, values) {\n      return baseZipObject(props || [], values || [], assignValue);\n    }\n\n    /**\n     * This method is like `_.zipObject` except that it supports property paths.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.1.0\n     * @category Array\n     * @param {Array} [props=[]] The property identifiers.\n     * @param {Array} [values=[]] The property values.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * _.zipObjectDeep(['a.b[0].c', 'a.b[1].d'], [1, 2]);\n     * // => { 'a': { 'b': [{ 'c': 1 }, { 'd': 2 }] } }\n     */\n    function zipObjectDeep(props, values) {\n      return baseZipObject(props || [], values || [], baseSet);\n    }\n\n    /**\n     * This method is like `_.zip` except that it accepts `iteratee` to specify\n     * how grouped values should be combined. The iteratee is invoked with the\n     * elements of each group: (...group).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.8.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to process.\n     * @param {Function} [iteratee=_.identity] The function to combine\n     *  grouped values.\n     * @returns {Array} Returns the new array of grouped elements.\n     * @example\n     *\n     * _.zipWith([1, 2], [10, 20], [100, 200], function(a, b, c) {\n     *   return a + b + c;\n     * });\n     * // => [111, 222]\n     */\n    var zipWith = baseRest(function(arrays) {\n      var length = arrays.length,\n          iteratee = length > 1 ? arrays[length - 1] : undefined;\n\n      iteratee = typeof iteratee == 'function' ? (arrays.pop(), iteratee) : undefined;\n      return unzipWith(arrays, iteratee);\n    });\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates a `lodash` wrapper instance that wraps `value` with explicit method\n     * chain sequences enabled. The result of such sequences must be unwrapped\n     * with `_#value`.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.3.0\n     * @category Seq\n     * @param {*} value The value to wrap.\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'age': 36 },\n     *   { 'user': 'fred',    'age': 40 },\n     *   { 'user': 'pebbles', 'age': 1 }\n     * ];\n     *\n     * var youngest = _\n     *   .chain(users)\n     *   .sortBy('age')\n     *   .map(function(o) {\n     *     return o.user + ' is ' + o.age;\n     *   })\n     *   .head()\n     *   .value();\n     * // => 'pebbles is 1'\n     */\n    function chain(value) {\n      var result = lodash(value);\n      result.__chain__ = true;\n      return result;\n    }\n\n    /**\n     * This method invokes `interceptor` and returns `value`. The interceptor\n     * is invoked with one argument; (value). The purpose of this method is to\n     * \"tap into\" a method chain sequence in order to modify intermediate results.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Seq\n     * @param {*} value The value to provide to `interceptor`.\n     * @param {Function} interceptor The function to invoke.\n     * @returns {*} Returns `value`.\n     * @example\n     *\n     * _([1, 2, 3])\n     *  .tap(function(array) {\n     *    // Mutate input array.\n     *    array.pop();\n     *  })\n     *  .reverse()\n     *  .value();\n     * // => [2, 1]\n     */\n    function tap(value, interceptor) {\n      interceptor(value);\n      return value;\n    }\n\n    /**\n     * This method is like `_.tap` except that it returns the result of `interceptor`.\n     * The purpose of this method is to \"pass thru\" values replacing intermediate\n     * results in a method chain sequence.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Seq\n     * @param {*} value The value to provide to `interceptor`.\n     * @param {Function} interceptor The function to invoke.\n     * @returns {*} Returns the result of `interceptor`.\n     * @example\n     *\n     * _('  abc  ')\n     *  .chain()\n     *  .trim()\n     *  .thru(function(value) {\n     *    return [value];\n     *  })\n     *  .value();\n     * // => ['abc']\n     */\n    function thru(value, interceptor) {\n      return interceptor(value);\n    }\n\n    /**\n     * This method is the wrapper version of `_.at`.\n     *\n     * @name at\n     * @memberOf _\n     * @since 1.0.0\n     * @category Seq\n     * @param {...(string|string[])} [paths] The property paths to pick.\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': 3 } }, 4] };\n     *\n     * _(object).at(['a[0].b.c', 'a[1]']).value();\n     * // => [3, 4]\n     */\n    var wrapperAt = flatRest(function(paths) {\n      var length = paths.length,\n          start = length ? paths[0] : 0,\n          value = this.__wrapped__,\n          interceptor = function(object) { return baseAt(object, paths); };\n\n      if (length > 1 || this.__actions__.length ||\n          !(value instanceof LazyWrapper) || !isIndex(start)) {\n        return this.thru(interceptor);\n      }\n      value = value.slice(start, +start + (length ? 1 : 0));\n      value.__actions__.push({\n        'func': thru,\n        'args': [interceptor],\n        'thisArg': undefined\n      });\n      return new LodashWrapper(value, this.__chain__).thru(function(array) {\n        if (length && !array.length) {\n          array.push(undefined);\n        }\n        return array;\n      });\n    });\n\n    /**\n     * Creates a `lodash` wrapper instance with explicit method chain sequences enabled.\n     *\n     * @name chain\n     * @memberOf _\n     * @since 0.1.0\n     * @category Seq\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney', 'age': 36 },\n     *   { 'user': 'fred',   'age': 40 }\n     * ];\n     *\n     * // A sequence without explicit chaining.\n     * _(users).head();\n     * // => { 'user': 'barney', 'age': 36 }\n     *\n     * // A sequence with explicit chaining.\n     * _(users)\n     *   .chain()\n     *   .head()\n     *   .pick('user')\n     *   .value();\n     * // => { 'user': 'barney' }\n     */\n    function wrapperChain() {\n      return chain(this);\n    }\n\n    /**\n     * Executes the chain sequence and returns the wrapped result.\n     *\n     * @name commit\n     * @memberOf _\n     * @since 3.2.0\n     * @category Seq\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * var array = [1, 2];\n     * var wrapped = _(array).push(3);\n     *\n     * console.log(array);\n     * // => [1, 2]\n     *\n     * wrapped = wrapped.commit();\n     * console.log(array);\n     * // => [1, 2, 3]\n     *\n     * wrapped.last();\n     * // => 3\n     *\n     * console.log(array);\n     * // => [1, 2, 3]\n     */\n    function wrapperCommit() {\n      return new LodashWrapper(this.value(), this.__chain__);\n    }\n\n    /**\n     * Gets the next value on a wrapped object following the\n     * [iterator protocol](https://mdn.io/iteration_protocols#iterator).\n     *\n     * @name next\n     * @memberOf _\n     * @since 4.0.0\n     * @category Seq\n     * @returns {Object} Returns the next iterator value.\n     * @example\n     *\n     * var wrapped = _([1, 2]);\n     *\n     * wrapped.next();\n     * // => { 'done': false, 'value': 1 }\n     *\n     * wrapped.next();\n     * // => { 'done': false, 'value': 2 }\n     *\n     * wrapped.next();\n     * // => { 'done': true, 'value': undefined }\n     */\n    function wrapperNext() {\n      if (this.__values__ === undefined) {\n        this.__values__ = toArray(this.value());\n      }\n      var done = this.__index__ >= this.__values__.length,\n          value = done ? undefined : this.__values__[this.__index__++];\n\n      return { 'done': done, 'value': value };\n    }\n\n    /**\n     * Enables the wrapper to be iterable.\n     *\n     * @name Symbol.iterator\n     * @memberOf _\n     * @since 4.0.0\n     * @category Seq\n     * @returns {Object} Returns the wrapper object.\n     * @example\n     *\n     * var wrapped = _([1, 2]);\n     *\n     * wrapped[Symbol.iterator]() === wrapped;\n     * // => true\n     *\n     * Array.from(wrapped);\n     * // => [1, 2]\n     */\n    function wrapperToIterator() {\n      return this;\n    }\n\n    /**\n     * Creates a clone of the chain sequence planting `value` as the wrapped value.\n     *\n     * @name plant\n     * @memberOf _\n     * @since 3.2.0\n     * @category Seq\n     * @param {*} value The value to plant.\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * function square(n) {\n     *   return n * n;\n     * }\n     *\n     * var wrapped = _([1, 2]).map(square);\n     * var other = wrapped.plant([3, 4]);\n     *\n     * other.value();\n     * // => [9, 16]\n     *\n     * wrapped.value();\n     * // => [1, 4]\n     */\n    function wrapperPlant(value) {\n      var result,\n          parent = this;\n\n      while (parent instanceof baseLodash) {\n        var clone = wrapperClone(parent);\n        clone.__index__ = 0;\n        clone.__values__ = undefined;\n        if (result) {\n          previous.__wrapped__ = clone;\n        } else {\n          result = clone;\n        }\n        var previous = clone;\n        parent = parent.__wrapped__;\n      }\n      previous.__wrapped__ = value;\n      return result;\n    }\n\n    /**\n     * This method is the wrapper version of `_.reverse`.\n     *\n     * **Note:** This method mutates the wrapped array.\n     *\n     * @name reverse\n     * @memberOf _\n     * @since 0.1.0\n     * @category Seq\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * var array = [1, 2, 3];\n     *\n     * _(array).reverse().value()\n     * // => [3, 2, 1]\n     *\n     * console.log(array);\n     * // => [3, 2, 1]\n     */\n    function wrapperReverse() {\n      var value = this.__wrapped__;\n      if (value instanceof LazyWrapper) {\n        var wrapped = value;\n        if (this.__actions__.length) {\n          wrapped = new LazyWrapper(this);\n        }\n        wrapped = wrapped.reverse();\n        wrapped.__actions__.push({\n          'func': thru,\n          'args': [reverse],\n          'thisArg': undefined\n        });\n        return new LodashWrapper(wrapped, this.__chain__);\n      }\n      return this.thru(reverse);\n    }\n\n    /**\n     * Executes the chain sequence to resolve the unwrapped value.\n     *\n     * @name value\n     * @memberOf _\n     * @since 0.1.0\n     * @alias toJSON, valueOf\n     * @category Seq\n     * @returns {*} Returns the resolved unwrapped value.\n     * @example\n     *\n     * _([1, 2, 3]).value();\n     * // => [1, 2, 3]\n     */\n    function wrapperValue() {\n      return baseWrapperValue(this.__wrapped__, this.__actions__);\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates an object composed of keys generated from the results of running\n     * each element of `collection` thru `iteratee`. The corresponding value of\n     * each key is the number of times the key was returned by `iteratee`. The\n     * iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.5.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee to transform keys.\n     * @returns {Object} Returns the composed aggregate object.\n     * @example\n     *\n     * _.countBy([6.1, 4.2, 6.3], Math.floor);\n     * // => { '4': 1, '6': 2 }\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.countBy(['one', 'two', 'three'], 'length');\n     * // => { '3': 2, '5': 1 }\n     */\n    var countBy = createAggregator(function(result, value, key) {\n      if (hasOwnProperty.call(result, key)) {\n        ++result[key];\n      } else {\n        baseAssignValue(result, key, 1);\n      }\n    });\n\n    /**\n     * Checks if `predicate` returns truthy for **all** elements of `collection`.\n     * Iteration is stopped once `predicate` returns falsey. The predicate is\n     * invoked with three arguments: (value, index|key, collection).\n     *\n     * **Note:** This method returns `true` for\n     * [empty collections](https://en.wikipedia.org/wiki/Empty_set) because\n     * [everything is true](https://en.wikipedia.org/wiki/Vacuous_truth) of\n     * elements of empty collections.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {boolean} Returns `true` if all elements pass the predicate check,\n     *  else `false`.\n     * @example\n     *\n     * _.every([true, 1, null, 'yes'], Boolean);\n     * // => false\n     *\n     * var users = [\n     *   { 'user': 'barney', 'age': 36, 'active': false },\n     *   { 'user': 'fred',   'age': 40, 'active': false }\n     * ];\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.every(users, { 'user': 'barney', 'active': false });\n     * // => false\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.every(users, ['active', false]);\n     * // => true\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.every(users, 'active');\n     * // => false\n     */\n    function every(collection, predicate, guard) {\n      var func = isArray(collection) ? arrayEvery : baseEvery;\n      if (guard && isIterateeCall(collection, predicate, guard)) {\n        predicate = undefined;\n      }\n      return func(collection, getIteratee(predicate, 3));\n    }\n\n    /**\n     * Iterates over elements of `collection`, returning an array of all elements\n     * `predicate` returns truthy for. The predicate is invoked with three\n     * arguments: (value, index|key, collection).\n     *\n     * **Note:** Unlike `_.remove`, this method returns a new array.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the new filtered array.\n     * @see _.reject\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney', 'age': 36, 'active': true },\n     *   { 'user': 'fred',   'age': 40, 'active': false }\n     * ];\n     *\n     * _.filter(users, function(o) { return !o.active; });\n     * // => objects for ['fred']\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.filter(users, { 'age': 36, 'active': true });\n     * // => objects for ['barney']\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.filter(users, ['active', false]);\n     * // => objects for ['fred']\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.filter(users, 'active');\n     * // => objects for ['barney']\n     *\n     * // Combining several predicates using `_.overEvery` or `_.overSome`.\n     * _.filter(users, _.overSome([{ 'age': 36 }, ['age', 40]]));\n     * // => objects for ['fred', 'barney']\n     */\n    function filter(collection, predicate) {\n      var func = isArray(collection) ? arrayFilter : baseFilter;\n      return func(collection, getIteratee(predicate, 3));\n    }\n\n    /**\n     * Iterates over elements of `collection`, returning the first element\n     * `predicate` returns truthy for. The predicate is invoked with three\n     * arguments: (value, index|key, collection).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to inspect.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @param {number} [fromIndex=0] The index to search from.\n     * @returns {*} Returns the matched element, else `undefined`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'age': 36, 'active': true },\n     *   { 'user': 'fred',    'age': 40, 'active': false },\n     *   { 'user': 'pebbles', 'age': 1,  'active': true }\n     * ];\n     *\n     * _.find(users, function(o) { return o.age < 40; });\n     * // => object for 'barney'\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.find(users, { 'age': 1, 'active': true });\n     * // => object for 'pebbles'\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.find(users, ['active', false]);\n     * // => object for 'fred'\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.find(users, 'active');\n     * // => object for 'barney'\n     */\n    var find = createFind(findIndex);\n\n    /**\n     * This method is like `_.find` except that it iterates over elements of\n     * `collection` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to inspect.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @param {number} [fromIndex=collection.length-1] The index to search from.\n     * @returns {*} Returns the matched element, else `undefined`.\n     * @example\n     *\n     * _.findLast([1, 2, 3, 4], function(n) {\n     *   return n % 2 == 1;\n     * });\n     * // => 3\n     */\n    var findLast = createFind(findLastIndex);\n\n    /**\n     * Creates a flattened array of values by running each element in `collection`\n     * thru `iteratee` and flattening the mapped results. The iteratee is invoked\n     * with three arguments: (value, index|key, collection).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the new flattened array.\n     * @example\n     *\n     * function duplicate(n) {\n     *   return [n, n];\n     * }\n     *\n     * _.flatMap([1, 2], duplicate);\n     * // => [1, 1, 2, 2]\n     */\n    function flatMap(collection, iteratee) {\n      return baseFlatten(map(collection, iteratee), 1);\n    }\n\n    /**\n     * This method is like `_.flatMap` except that it recursively flattens the\n     * mapped results.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.7.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the new flattened array.\n     * @example\n     *\n     * function duplicate(n) {\n     *   return [[[n, n]]];\n     * }\n     *\n     * _.flatMapDeep([1, 2], duplicate);\n     * // => [1, 1, 2, 2]\n     */\n    function flatMapDeep(collection, iteratee) {\n      return baseFlatten(map(collection, iteratee), INFINITY);\n    }\n\n    /**\n     * This method is like `_.flatMap` except that it recursively flattens the\n     * mapped results up to `depth` times.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.7.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @param {number} [depth=1] The maximum recursion depth.\n     * @returns {Array} Returns the new flattened array.\n     * @example\n     *\n     * function duplicate(n) {\n     *   return [[[n, n]]];\n     * }\n     *\n     * _.flatMapDepth([1, 2], duplicate, 2);\n     * // => [[1, 1], [2, 2]]\n     */\n    function flatMapDepth(collection, iteratee, depth) {\n      depth = depth === undefined ? 1 : toInteger(depth);\n      return baseFlatten(map(collection, iteratee), depth);\n    }\n\n    /**\n     * Iterates over elements of `collection` and invokes `iteratee` for each element.\n     * The iteratee is invoked with three arguments: (value, index|key, collection).\n     * Iteratee functions may exit iteration early by explicitly returning `false`.\n     *\n     * **Note:** As with other \"Collections\" methods, objects with a \"length\"\n     * property are iterated like arrays. To avoid this behavior use `_.forIn`\n     * or `_.forOwn` for object iteration.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @alias each\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Array|Object} Returns `collection`.\n     * @see _.forEachRight\n     * @example\n     *\n     * _.forEach([1, 2], function(value) {\n     *   console.log(value);\n     * });\n     * // => Logs `1` then `2`.\n     *\n     * _.forEach({ 'a': 1, 'b': 2 }, function(value, key) {\n     *   console.log(key);\n     * });\n     * // => Logs 'a' then 'b' (iteration order is not guaranteed).\n     */\n    function forEach(collection, iteratee) {\n      var func = isArray(collection) ? arrayEach : baseEach;\n      return func(collection, getIteratee(iteratee, 3));\n    }\n\n    /**\n     * This method is like `_.forEach` except that it iterates over elements of\n     * `collection` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @alias eachRight\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Array|Object} Returns `collection`.\n     * @see _.forEach\n     * @example\n     *\n     * _.forEachRight([1, 2], function(value) {\n     *   console.log(value);\n     * });\n     * // => Logs `2` then `1`.\n     */\n    function forEachRight(collection, iteratee) {\n      var func = isArray(collection) ? arrayEachRight : baseEachRight;\n      return func(collection, getIteratee(iteratee, 3));\n    }\n\n    /**\n     * Creates an object composed of keys generated from the results of running\n     * each element of `collection` thru `iteratee`. The order of grouped values\n     * is determined by the order they occur in `collection`. The corresponding\n     * value of each key is an array of elements responsible for generating the\n     * key. The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee to transform keys.\n     * @returns {Object} Returns the composed aggregate object.\n     * @example\n     *\n     * _.groupBy([6.1, 4.2, 6.3], Math.floor);\n     * // => { '4': [4.2], '6': [6.1, 6.3] }\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.groupBy(['one', 'two', 'three'], 'length');\n     * // => { '3': ['one', 'two'], '5': ['three'] }\n     */\n    var groupBy = createAggregator(function(result, value, key) {\n      if (hasOwnProperty.call(result, key)) {\n        result[key].push(value);\n      } else {\n        baseAssignValue(result, key, [value]);\n      }\n    });\n\n    /**\n     * Checks if `value` is in `collection`. If `collection` is a string, it's\n     * checked for a substring of `value`, otherwise\n     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * is used for equality comparisons. If `fromIndex` is negative, it's used as\n     * the offset from the end of `collection`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object|string} collection The collection to inspect.\n     * @param {*} value The value to search for.\n     * @param {number} [fromIndex=0] The index to search from.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.reduce`.\n     * @returns {boolean} Returns `true` if `value` is found, else `false`.\n     * @example\n     *\n     * _.includes([1, 2, 3], 1);\n     * // => true\n     *\n     * _.includes([1, 2, 3], 1, 2);\n     * // => false\n     *\n     * _.includes({ 'a': 1, 'b': 2 }, 1);\n     * // => true\n     *\n     * _.includes('abcd', 'bc');\n     * // => true\n     */\n    function includes(collection, value, fromIndex, guard) {\n      collection = isArrayLike(collection) ? collection : values(collection);\n      fromIndex = (fromIndex && !guard) ? toInteger(fromIndex) : 0;\n\n      var length = collection.length;\n      if (fromIndex < 0) {\n        fromIndex = nativeMax(length + fromIndex, 0);\n      }\n      return isString(collection)\n        ? (fromIndex <= length && collection.indexOf(value, fromIndex) > -1)\n        : (!!length && baseIndexOf(collection, value, fromIndex) > -1);\n    }\n\n    /**\n     * Invokes the method at `path` of each element in `collection`, returning\n     * an array of the results of each invoked method. Any additional arguments\n     * are provided to each invoked method. If `path` is a function, it's invoked\n     * for, and `this` bound to, each element in `collection`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Array|Function|string} path The path of the method to invoke or\n     *  the function invoked per iteration.\n     * @param {...*} [args] The arguments to invoke each method with.\n     * @returns {Array} Returns the array of results.\n     * @example\n     *\n     * _.invokeMap([[5, 1, 7], [3, 2, 1]], 'sort');\n     * // => [[1, 5, 7], [1, 2, 3]]\n     *\n     * _.invokeMap([123, 456], String.prototype.split, '');\n     * // => [['1', '2', '3'], ['4', '5', '6']]\n     */\n    var invokeMap = baseRest(function(collection, path, args) {\n      var index = -1,\n          isFunc = typeof path == 'function',\n          result = isArrayLike(collection) ? Array(collection.length) : [];\n\n      baseEach(collection, function(value) {\n        result[++index] = isFunc ? apply(path, value, args) : baseInvoke(value, path, args);\n      });\n      return result;\n    });\n\n    /**\n     * Creates an object composed of keys generated from the results of running\n     * each element of `collection` thru `iteratee`. The corresponding value of\n     * each key is the last element responsible for generating the key. The\n     * iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee to transform keys.\n     * @returns {Object} Returns the composed aggregate object.\n     * @example\n     *\n     * var array = [\n     *   { 'dir': 'left', 'code': 97 },\n     *   { 'dir': 'right', 'code': 100 }\n     * ];\n     *\n     * _.keyBy(array, function(o) {\n     *   return String.fromCharCode(o.code);\n     * });\n     * // => { 'a': { 'dir': 'left', 'code': 97 }, 'd': { 'dir': 'right', 'code': 100 } }\n     *\n     * _.keyBy(array, 'dir');\n     * // => { 'left': { 'dir': 'left', 'code': 97 }, 'right': { 'dir': 'right', 'code': 100 } }\n     */\n    var keyBy = createAggregator(function(result, value, key) {\n      baseAssignValue(result, key, value);\n    });\n\n    /**\n     * Creates an array of values by running each element in `collection` thru\n     * `iteratee`. The iteratee is invoked with three arguments:\n     * (value, index|key, collection).\n     *\n     * Many lodash methods are guarded to work as iteratees for methods like\n     * `_.every`, `_.filter`, `_.map`, `_.mapValues`, `_.reject`, and `_.some`.\n     *\n     * The guarded methods are:\n     * `ary`, `chunk`, `curry`, `curryRight`, `drop`, `dropRight`, `every`,\n     * `fill`, `invert`, `parseInt`, `random`, `range`, `rangeRight`, `repeat`,\n     * `sampleSize`, `slice`, `some`, `sortBy`, `split`, `take`, `takeRight`,\n     * `template`, `trim`, `trimEnd`, `trimStart`, and `words`\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the new mapped array.\n     * @example\n     *\n     * function square(n) {\n     *   return n * n;\n     * }\n     *\n     * _.map([4, 8], square);\n     * // => [16, 64]\n     *\n     * _.map({ 'a': 4, 'b': 8 }, square);\n     * // => [16, 64] (iteration order is not guaranteed)\n     *\n     * var users = [\n     *   { 'user': 'barney' },\n     *   { 'user': 'fred' }\n     * ];\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.map(users, 'user');\n     * // => ['barney', 'fred']\n     */\n    function map(collection, iteratee) {\n      var func = isArray(collection) ? arrayMap : baseMap;\n      return func(collection, getIteratee(iteratee, 3));\n    }\n\n    /**\n     * This method is like `_.sortBy` except that it allows specifying the sort\n     * orders of the iteratees to sort by. If `orders` is unspecified, all values\n     * are sorted in ascending order. Otherwise, specify an order of \"desc\" for\n     * descending or \"asc\" for ascending sort order of corresponding values.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Array[]|Function[]|Object[]|string[]} [iteratees=[_.identity]]\n     *  The iteratees to sort by.\n     * @param {string[]} [orders] The sort orders of `iteratees`.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.reduce`.\n     * @returns {Array} Returns the new sorted array.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'fred',   'age': 48 },\n     *   { 'user': 'barney', 'age': 34 },\n     *   { 'user': 'fred',   'age': 40 },\n     *   { 'user': 'barney', 'age': 36 }\n     * ];\n     *\n     * // Sort by `user` in ascending order and by `age` in descending order.\n     * _.orderBy(users, ['user', 'age'], ['asc', 'desc']);\n     * // => objects for [['barney', 36], ['barney', 34], ['fred', 48], ['fred', 40]]\n     */\n    function orderBy(collection, iteratees, orders, guard) {\n      if (collection == null) {\n        return [];\n      }\n      if (!isArray(iteratees)) {\n        iteratees = iteratees == null ? [] : [iteratees];\n      }\n      orders = guard ? undefined : orders;\n      if (!isArray(orders)) {\n        orders = orders == null ? [] : [orders];\n      }\n      return baseOrderBy(collection, iteratees, orders);\n    }\n\n    /**\n     * Creates an array of elements split into two groups, the first of which\n     * contains elements `predicate` returns truthy for, the second of which\n     * contains elements `predicate` returns falsey for. The predicate is\n     * invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the array of grouped elements.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'age': 36, 'active': false },\n     *   { 'user': 'fred',    'age': 40, 'active': true },\n     *   { 'user': 'pebbles', 'age': 1,  'active': false }\n     * ];\n     *\n     * _.partition(users, function(o) { return o.active; });\n     * // => objects for [['fred'], ['barney', 'pebbles']]\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.partition(users, { 'age': 1, 'active': false });\n     * // => objects for [['pebbles'], ['barney', 'fred']]\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.partition(users, ['active', false]);\n     * // => objects for [['barney', 'pebbles'], ['fred']]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.partition(users, 'active');\n     * // => objects for [['fred'], ['barney', 'pebbles']]\n     */\n    var partition = createAggregator(function(result, value, key) {\n      result[key ? 0 : 1].push(value);\n    }, function() { return [[], []]; });\n\n    /**\n     * Reduces `collection` to a value which is the accumulated result of running\n     * each element in `collection` thru `iteratee`, where each successive\n     * invocation is supplied the return value of the previous. If `accumulator`\n     * is not given, the first element of `collection` is used as the initial\n     * value. The iteratee is invoked with four arguments:\n     * (accumulator, value, index|key, collection).\n     *\n     * Many lodash methods are guarded to work as iteratees for methods like\n     * `_.reduce`, `_.reduceRight`, and `_.transform`.\n     *\n     * The guarded methods are:\n     * `assign`, `defaults`, `defaultsDeep`, `includes`, `merge`, `orderBy`,\n     * and `sortBy`\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @param {*} [accumulator] The initial value.\n     * @returns {*} Returns the accumulated value.\n     * @see _.reduceRight\n     * @example\n     *\n     * _.reduce([1, 2], function(sum, n) {\n     *   return sum + n;\n     * }, 0);\n     * // => 3\n     *\n     * _.reduce({ 'a': 1, 'b': 2, 'c': 1 }, function(result, value, key) {\n     *   (result[value] || (result[value] = [])).push(key);\n     *   return result;\n     * }, {});\n     * // => { '1': ['a', 'c'], '2': ['b'] } (iteration order is not guaranteed)\n     */\n    function reduce(collection, iteratee, accumulator) {\n      var func = isArray(collection) ? arrayReduce : baseReduce,\n          initAccum = arguments.length < 3;\n\n      return func(collection, getIteratee(iteratee, 4), accumulator, initAccum, baseEach);\n    }\n\n    /**\n     * This method is like `_.reduce` except that it iterates over elements of\n     * `collection` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @param {*} [accumulator] The initial value.\n     * @returns {*} Returns the accumulated value.\n     * @see _.reduce\n     * @example\n     *\n     * var array = [[0, 1], [2, 3], [4, 5]];\n     *\n     * _.reduceRight(array, function(flattened, other) {\n     *   return flattened.concat(other);\n     * }, []);\n     * // => [4, 5, 2, 3, 0, 1]\n     */\n    function reduceRight(collection, iteratee, accumulator) {\n      var func = isArray(collection) ? arrayReduceRight : baseReduce,\n          initAccum = arguments.length < 3;\n\n      return func(collection, getIteratee(iteratee, 4), accumulator, initAccum, baseEachRight);\n    }\n\n    /**\n     * The opposite of `_.filter`; this method returns the elements of `collection`\n     * that `predicate` does **not** return truthy for.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the new filtered array.\n     * @see _.filter\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney', 'age': 36, 'active': false },\n     *   { 'user': 'fred',   'age': 40, 'active': true }\n     * ];\n     *\n     * _.reject(users, function(o) { return !o.active; });\n     * // => objects for ['fred']\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.reject(users, { 'age': 40, 'active': true });\n     * // => objects for ['barney']\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.reject(users, ['active', false]);\n     * // => objects for ['fred']\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.reject(users, 'active');\n     * // => objects for ['barney']\n     */\n    function reject(collection, predicate) {\n      var func = isArray(collection) ? arrayFilter : baseFilter;\n      return func(collection, negate(getIteratee(predicate, 3)));\n    }\n\n    /**\n     * Gets a random element from `collection`.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to sample.\n     * @returns {*} Returns the random element.\n     * @example\n     *\n     * _.sample([1, 2, 3, 4]);\n     * // => 2\n     */\n    function sample(collection) {\n      var func = isArray(collection) ? arraySample : baseSample;\n      return func(collection);\n    }\n\n    /**\n     * Gets `n` random elements at unique keys from `collection` up to the\n     * size of `collection`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to sample.\n     * @param {number} [n=1] The number of elements to sample.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the random elements.\n     * @example\n     *\n     * _.sampleSize([1, 2, 3], 2);\n     * // => [3, 1]\n     *\n     * _.sampleSize([1, 2, 3], 4);\n     * // => [2, 3, 1]\n     */\n    function sampleSize(collection, n, guard) {\n      if ((guard ? isIterateeCall(collection, n, guard) : n === undefined)) {\n        n = 1;\n      } else {\n        n = toInteger(n);\n      }\n      var func = isArray(collection) ? arraySampleSize : baseSampleSize;\n      return func(collection, n);\n    }\n\n    /**\n     * Creates an array of shuffled values, using a version of the\n     * [Fisher-Yates shuffle](https://en.wikipedia.org/wiki/Fisher-Yates_shuffle).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to shuffle.\n     * @returns {Array} Returns the new shuffled array.\n     * @example\n     *\n     * _.shuffle([1, 2, 3, 4]);\n     * // => [4, 1, 3, 2]\n     */\n    function shuffle(collection) {\n      var func = isArray(collection) ? arrayShuffle : baseShuffle;\n      return func(collection);\n    }\n\n    /**\n     * Gets the size of `collection` by returning its length for array-like\n     * values or the number of own enumerable string keyed properties for objects.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object|string} collection The collection to inspect.\n     * @returns {number} Returns the collection size.\n     * @example\n     *\n     * _.size([1, 2, 3]);\n     * // => 3\n     *\n     * _.size({ 'a': 1, 'b': 2 });\n     * // => 2\n     *\n     * _.size('pebbles');\n     * // => 7\n     */\n    function size(collection) {\n      if (collection == null) {\n        return 0;\n      }\n      if (isArrayLike(collection)) {\n        return isString(collection) ? stringSize(collection) : collection.length;\n      }\n      var tag = getTag(collection);\n      if (tag == mapTag || tag == setTag) {\n        return collection.size;\n      }\n      return baseKeys(collection).length;\n    }\n\n    /**\n     * Checks if `predicate` returns truthy for **any** element of `collection`.\n     * Iteration is stopped once `predicate` returns truthy. The predicate is\n     * invoked with three arguments: (value, index|key, collection).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {boolean} Returns `true` if any element passes the predicate check,\n     *  else `false`.\n     * @example\n     *\n     * _.some([null, 0, 'yes', false], Boolean);\n     * // => true\n     *\n     * var users = [\n     *   { 'user': 'barney', 'active': true },\n     *   { 'user': 'fred',   'active': false }\n     * ];\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.some(users, { 'user': 'barney', 'active': false });\n     * // => false\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.some(users, ['active', false]);\n     * // => true\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.some(users, 'active');\n     * // => true\n     */\n    function some(collection, predicate, guard) {\n      var func = isArray(collection) ? arraySome : baseSome;\n      if (guard && isIterateeCall(collection, predicate, guard)) {\n        predicate = undefined;\n      }\n      return func(collection, getIteratee(predicate, 3));\n    }\n\n    /**\n     * Creates an array of elements, sorted in ascending order by the results of\n     * running each element in a collection thru each iteratee. This method\n     * performs a stable sort, that is, it preserves the original sort order of\n     * equal elements. The iteratees are invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {...(Function|Function[])} [iteratees=[_.identity]]\n     *  The iteratees to sort by.\n     * @returns {Array} Returns the new sorted array.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'fred',   'age': 48 },\n     *   { 'user': 'barney', 'age': 36 },\n     *   { 'user': 'fred',   'age': 30 },\n     *   { 'user': 'barney', 'age': 34 }\n     * ];\n     *\n     * _.sortBy(users, [function(o) { return o.user; }]);\n     * // => objects for [['barney', 36], ['barney', 34], ['fred', 48], ['fred', 30]]\n     *\n     * _.sortBy(users, ['user', 'age']);\n     * // => objects for [['barney', 34], ['barney', 36], ['fred', 30], ['fred', 48]]\n     */\n    var sortBy = baseRest(function(collection, iteratees) {\n      if (collection == null) {\n        return [];\n      }\n      var length = iteratees.length;\n      if (length > 1 && isIterateeCall(collection, iteratees[0], iteratees[1])) {\n        iteratees = [];\n      } else if (length > 2 && isIterateeCall(iteratees[0], iteratees[1], iteratees[2])) {\n        iteratees = [iteratees[0]];\n      }\n      return baseOrderBy(collection, baseFlatten(iteratees, 1), []);\n    });\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Gets the timestamp of the number of milliseconds that have elapsed since\n     * the Unix epoch (1 January 1970 00:00:00 UTC).\n     *\n     * @static\n     * @memberOf _\n     * @since 2.4.0\n     * @category Date\n     * @returns {number} Returns the timestamp.\n     * @example\n     *\n     * _.defer(function(stamp) {\n     *   console.log(_.now() - stamp);\n     * }, _.now());\n     * // => Logs the number of milliseconds it took for the deferred invocation.\n     */\n    var now = ctxNow || function() {\n      return root.Date.now();\n    };\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * The opposite of `_.before`; this method creates a function that invokes\n     * `func` once it's called `n` or more times.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {number} n The number of calls before `func` is invoked.\n     * @param {Function} func The function to restrict.\n     * @returns {Function} Returns the new restricted function.\n     * @example\n     *\n     * var saves = ['profile', 'settings'];\n     *\n     * var done = _.after(saves.length, function() {\n     *   console.log('done saving!');\n     * });\n     *\n     * _.forEach(saves, function(type) {\n     *   asyncSave({ 'type': type, 'complete': done });\n     * });\n     * // => Logs 'done saving!' after the two async saves have completed.\n     */\n    function after(n, func) {\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      n = toInteger(n);\n      return function() {\n        if (--n < 1) {\n          return func.apply(this, arguments);\n        }\n      };\n    }\n\n    /**\n     * Creates a function that invokes `func`, with up to `n` arguments,\n     * ignoring any additional arguments.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Function\n     * @param {Function} func The function to cap arguments for.\n     * @param {number} [n=func.length] The arity cap.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Function} Returns the new capped function.\n     * @example\n     *\n     * _.map(['6', '8', '10'], _.ary(parseInt, 1));\n     * // => [6, 8, 10]\n     */\n    function ary(func, n, guard) {\n      n = guard ? undefined : n;\n      n = (func && n == null) ? func.length : n;\n      return createWrap(func, WRAP_ARY_FLAG, undefined, undefined, undefined, undefined, n);\n    }\n\n    /**\n     * Creates a function that invokes `func`, with the `this` binding and arguments\n     * of the created function, while it's called less than `n` times. Subsequent\n     * calls to the created function return the result of the last `func` invocation.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Function\n     * @param {number} n The number of calls at which `func` is no longer invoked.\n     * @param {Function} func The function to restrict.\n     * @returns {Function} Returns the new restricted function.\n     * @example\n     *\n     * jQuery(element).on('click', _.before(5, addContactToList));\n     * // => Allows adding up to 4 contacts to the list.\n     */\n    function before(n, func) {\n      var result;\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      n = toInteger(n);\n      return function() {\n        if (--n > 0) {\n          result = func.apply(this, arguments);\n        }\n        if (n <= 1) {\n          func = undefined;\n        }\n        return result;\n      };\n    }\n\n    /**\n     * Creates a function that invokes `func` with the `this` binding of `thisArg`\n     * and `partials` prepended to the arguments it receives.\n     *\n     * The `_.bind.placeholder` value, which defaults to `_` in monolithic builds,\n     * may be used as a placeholder for partially applied arguments.\n     *\n     * **Note:** Unlike native `Function#bind`, this method doesn't set the \"length\"\n     * property of bound functions.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to bind.\n     * @param {*} thisArg The `this` binding of `func`.\n     * @param {...*} [partials] The arguments to be partially applied.\n     * @returns {Function} Returns the new bound function.\n     * @example\n     *\n     * function greet(greeting, punctuation) {\n     *   return greeting + ' ' + this.user + punctuation;\n     * }\n     *\n     * var object = { 'user': 'fred' };\n     *\n     * var bound = _.bind(greet, object, 'hi');\n     * bound('!');\n     * // => 'hi fred!'\n     *\n     * // Bound with placeholders.\n     * var bound = _.bind(greet, object, _, '!');\n     * bound('hi');\n     * // => 'hi fred!'\n     */\n    var bind = baseRest(function(func, thisArg, partials) {\n      var bitmask = WRAP_BIND_FLAG;\n      if (partials.length) {\n        var holders = replaceHolders(partials, getHolder(bind));\n        bitmask |= WRAP_PARTIAL_FLAG;\n      }\n      return createWrap(func, bitmask, thisArg, partials, holders);\n    });\n\n    /**\n     * Creates a function that invokes the method at `object[key]` with `partials`\n     * prepended to the arguments it receives.\n     *\n     * This method differs from `_.bind` by allowing bound functions to reference\n     * methods that may be redefined or don't yet exist. See\n     * [Peter Michaux's article](http://peter.michaux.ca/articles/lazy-function-definition-pattern)\n     * for more details.\n     *\n     * The `_.bindKey.placeholder` value, which defaults to `_` in monolithic\n     * builds, may be used as a placeholder for partially applied arguments.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.10.0\n     * @category Function\n     * @param {Object} object The object to invoke the method on.\n     * @param {string} key The key of the method.\n     * @param {...*} [partials] The arguments to be partially applied.\n     * @returns {Function} Returns the new bound function.\n     * @example\n     *\n     * var object = {\n     *   'user': 'fred',\n     *   'greet': function(greeting, punctuation) {\n     *     return greeting + ' ' + this.user + punctuation;\n     *   }\n     * };\n     *\n     * var bound = _.bindKey(object, 'greet', 'hi');\n     * bound('!');\n     * // => 'hi fred!'\n     *\n     * object.greet = function(greeting, punctuation) {\n     *   return greeting + 'ya ' + this.user + punctuation;\n     * };\n     *\n     * bound('!');\n     * // => 'hiya fred!'\n     *\n     * // Bound with placeholders.\n     * var bound = _.bindKey(object, 'greet', _, '!');\n     * bound('hi');\n     * // => 'hiya fred!'\n     */\n    var bindKey = baseRest(function(object, key, partials) {\n      var bitmask = WRAP_BIND_FLAG | WRAP_BIND_KEY_FLAG;\n      if (partials.length) {\n        var holders = replaceHolders(partials, getHolder(bindKey));\n        bitmask |= WRAP_PARTIAL_FLAG;\n      }\n      return createWrap(key, bitmask, object, partials, holders);\n    });\n\n    /**\n     * Creates a function that accepts arguments of `func` and either invokes\n     * `func` returning its result, if at least `arity` number of arguments have\n     * been provided, or returns a function that accepts the remaining `func`\n     * arguments, and so on. The arity of `func` may be specified if `func.length`\n     * is not sufficient.\n     *\n     * The `_.curry.placeholder` value, which defaults to `_` in monolithic builds,\n     * may be used as a placeholder for provided arguments.\n     *\n     * **Note:** This method doesn't set the \"length\" property of curried functions.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Function\n     * @param {Function} func The function to curry.\n     * @param {number} [arity=func.length] The arity of `func`.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Function} Returns the new curried function.\n     * @example\n     *\n     * var abc = function(a, b, c) {\n     *   return [a, b, c];\n     * };\n     *\n     * var curried = _.curry(abc);\n     *\n     * curried(1)(2)(3);\n     * // => [1, 2, 3]\n     *\n     * curried(1, 2)(3);\n     * // => [1, 2, 3]\n     *\n     * curried(1, 2, 3);\n     * // => [1, 2, 3]\n     *\n     * // Curried with placeholders.\n     * curried(1)(_, 3)(2);\n     * // => [1, 2, 3]\n     */\n    function curry(func, arity, guard) {\n      arity = guard ? undefined : arity;\n      var result = createWrap(func, WRAP_CURRY_FLAG, undefined, undefined, undefined, undefined, undefined, arity);\n      result.placeholder = curry.placeholder;\n      return result;\n    }\n\n    /**\n     * This method is like `_.curry` except that arguments are applied to `func`\n     * in the manner of `_.partialRight` instead of `_.partial`.\n     *\n     * The `_.curryRight.placeholder` value, which defaults to `_` in monolithic\n     * builds, may be used as a placeholder for provided arguments.\n     *\n     * **Note:** This method doesn't set the \"length\" property of curried functions.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Function\n     * @param {Function} func The function to curry.\n     * @param {number} [arity=func.length] The arity of `func`.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Function} Returns the new curried function.\n     * @example\n     *\n     * var abc = function(a, b, c) {\n     *   return [a, b, c];\n     * };\n     *\n     * var curried = _.curryRight(abc);\n     *\n     * curried(3)(2)(1);\n     * // => [1, 2, 3]\n     *\n     * curried(2, 3)(1);\n     * // => [1, 2, 3]\n     *\n     * curried(1, 2, 3);\n     * // => [1, 2, 3]\n     *\n     * // Curried with placeholders.\n     * curried(3)(1, _)(2);\n     * // => [1, 2, 3]\n     */\n    function curryRight(func, arity, guard) {\n      arity = guard ? undefined : arity;\n      var result = createWrap(func, WRAP_CURRY_RIGHT_FLAG, undefined, undefined, undefined, undefined, undefined, arity);\n      result.placeholder = curryRight.placeholder;\n      return result;\n    }\n\n    /**\n     * Creates a debounced function that delays invoking `func` until after `wait`\n     * milliseconds have elapsed since the last time the debounced function was\n     * invoked. The debounced function comes with a `cancel` method to cancel\n     * delayed `func` invocations and a `flush` method to immediately invoke them.\n     * Provide `options` to indicate whether `func` should be invoked on the\n     * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n     * with the last arguments provided to the debounced function. Subsequent\n     * calls to the debounced function return the result of the last `func`\n     * invocation.\n     *\n     * **Note:** If `leading` and `trailing` options are `true`, `func` is\n     * invoked on the trailing edge of the timeout only if the debounced function\n     * is invoked more than once during the `wait` timeout.\n     *\n     * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n     * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n     *\n     * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n     * for details over the differences between `_.debounce` and `_.throttle`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to debounce.\n     * @param {number} [wait=0] The number of milliseconds to delay.\n     * @param {Object} [options={}] The options object.\n     * @param {boolean} [options.leading=false]\n     *  Specify invoking on the leading edge of the timeout.\n     * @param {number} [options.maxWait]\n     *  The maximum time `func` is allowed to be delayed before it's invoked.\n     * @param {boolean} [options.trailing=true]\n     *  Specify invoking on the trailing edge of the timeout.\n     * @returns {Function} Returns the new debounced function.\n     * @example\n     *\n     * // Avoid costly calculations while the window size is in flux.\n     * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n     *\n     * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n     * jQuery(element).on('click', _.debounce(sendMail, 300, {\n     *   'leading': true,\n     *   'trailing': false\n     * }));\n     *\n     * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n     * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n     * var source = new EventSource('/stream');\n     * jQuery(source).on('message', debounced);\n     *\n     * // Cancel the trailing debounced invocation.\n     * jQuery(window).on('popstate', debounced.cancel);\n     */\n    function debounce(func, wait, options) {\n      var lastArgs,\n          lastThis,\n          maxWait,\n          result,\n          timerId,\n          lastCallTime,\n          lastInvokeTime = 0,\n          leading = false,\n          maxing = false,\n          trailing = true;\n\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      wait = toNumber(wait) || 0;\n      if (isObject(options)) {\n        leading = !!options.leading;\n        maxing = 'maxWait' in options;\n        maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n        trailing = 'trailing' in options ? !!options.trailing : trailing;\n      }\n\n      function invokeFunc(time) {\n        var args = lastArgs,\n            thisArg = lastThis;\n\n        lastArgs = lastThis = undefined;\n        lastInvokeTime = time;\n        result = func.apply(thisArg, args);\n        return result;\n      }\n\n      function leadingEdge(time) {\n        // Reset any `maxWait` timer.\n        lastInvokeTime = time;\n        // Start the timer for the trailing edge.\n        timerId = setTimeout(timerExpired, wait);\n        // Invoke the leading edge.\n        return leading ? invokeFunc(time) : result;\n      }\n\n      function remainingWait(time) {\n        var timeSinceLastCall = time - lastCallTime,\n            timeSinceLastInvoke = time - lastInvokeTime,\n            timeWaiting = wait - timeSinceLastCall;\n\n        return maxing\n          ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n          : timeWaiting;\n      }\n\n      function shouldInvoke(time) {\n        var timeSinceLastCall = time - lastCallTime,\n            timeSinceLastInvoke = time - lastInvokeTime;\n\n        // Either this is the first call, activity has stopped and we're at the\n        // trailing edge, the system time has gone backwards and we're treating\n        // it as the trailing edge, or we've hit the `maxWait` limit.\n        return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n          (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n      }\n\n      function timerExpired() {\n        var time = now();\n        if (shouldInvoke(time)) {\n          return trailingEdge(time);\n        }\n        // Restart the timer.\n        timerId = setTimeout(timerExpired, remainingWait(time));\n      }\n\n      function trailingEdge(time) {\n        timerId = undefined;\n\n        // Only invoke if we have `lastArgs` which means `func` has been\n        // debounced at least once.\n        if (trailing && lastArgs) {\n          return invokeFunc(time);\n        }\n        lastArgs = lastThis = undefined;\n        return result;\n      }\n\n      function cancel() {\n        if (timerId !== undefined) {\n          clearTimeout(timerId);\n        }\n        lastInvokeTime = 0;\n        lastArgs = lastCallTime = lastThis = timerId = undefined;\n      }\n\n      function flush() {\n        return timerId === undefined ? result : trailingEdge(now());\n      }\n\n      function debounced() {\n        var time = now(),\n            isInvoking = shouldInvoke(time);\n\n        lastArgs = arguments;\n        lastThis = this;\n        lastCallTime = time;\n\n        if (isInvoking) {\n          if (timerId === undefined) {\n            return leadingEdge(lastCallTime);\n          }\n          if (maxing) {\n            // Handle invocations in a tight loop.\n            clearTimeout(timerId);\n            timerId = setTimeout(timerExpired, wait);\n            return invokeFunc(lastCallTime);\n          }\n        }\n        if (timerId === undefined) {\n          timerId = setTimeout(timerExpired, wait);\n        }\n        return result;\n      }\n      debounced.cancel = cancel;\n      debounced.flush = flush;\n      return debounced;\n    }\n\n    /**\n     * Defers invoking the `func` until the current call stack has cleared. Any\n     * additional arguments are provided to `func` when it's invoked.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to defer.\n     * @param {...*} [args] The arguments to invoke `func` with.\n     * @returns {number} Returns the timer id.\n     * @example\n     *\n     * _.defer(function(text) {\n     *   console.log(text);\n     * }, 'deferred');\n     * // => Logs 'deferred' after one millisecond.\n     */\n    var defer = baseRest(function(func, args) {\n      return baseDelay(func, 1, args);\n    });\n\n    /**\n     * Invokes `func` after `wait` milliseconds. Any additional arguments are\n     * provided to `func` when it's invoked.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to delay.\n     * @param {number} wait The number of milliseconds to delay invocation.\n     * @param {...*} [args] The arguments to invoke `func` with.\n     * @returns {number} Returns the timer id.\n     * @example\n     *\n     * _.delay(function(text) {\n     *   console.log(text);\n     * }, 1000, 'later');\n     * // => Logs 'later' after one second.\n     */\n    var delay = baseRest(function(func, wait, args) {\n      return baseDelay(func, toNumber(wait) || 0, args);\n    });\n\n    /**\n     * Creates a function that invokes `func` with arguments reversed.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Function\n     * @param {Function} func The function to flip arguments for.\n     * @returns {Function} Returns the new flipped function.\n     * @example\n     *\n     * var flipped = _.flip(function() {\n     *   return _.toArray(arguments);\n     * });\n     *\n     * flipped('a', 'b', 'c', 'd');\n     * // => ['d', 'c', 'b', 'a']\n     */\n    function flip(func) {\n      return createWrap(func, WRAP_FLIP_FLAG);\n    }\n\n    /**\n     * Creates a function that memoizes the result of `func`. If `resolver` is\n     * provided, it determines the cache key for storing the result based on the\n     * arguments provided to the memoized function. By default, the first argument\n     * provided to the memoized function is used as the map cache key. The `func`\n     * is invoked with the `this` binding of the memoized function.\n     *\n     * **Note:** The cache is exposed as the `cache` property on the memoized\n     * function. Its creation may be customized by replacing the `_.memoize.Cache`\n     * constructor with one whose instances implement the\n     * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n     * method interface of `clear`, `delete`, `get`, `has`, and `set`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to have its output memoized.\n     * @param {Function} [resolver] The function to resolve the cache key.\n     * @returns {Function} Returns the new memoized function.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': 2 };\n     * var other = { 'c': 3, 'd': 4 };\n     *\n     * var values = _.memoize(_.values);\n     * values(object);\n     * // => [1, 2]\n     *\n     * values(other);\n     * // => [3, 4]\n     *\n     * object.a = 2;\n     * values(object);\n     * // => [1, 2]\n     *\n     * // Modify the result cache.\n     * values.cache.set(object, ['a', 'b']);\n     * values(object);\n     * // => ['a', 'b']\n     *\n     * // Replace `_.memoize.Cache`.\n     * _.memoize.Cache = WeakMap;\n     */\n    function memoize(func, resolver) {\n      if (typeof func != 'function' || (resolver != null && typeof resolver != 'function')) {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      var memoized = function() {\n        var args = arguments,\n            key = resolver ? resolver.apply(this, args) : args[0],\n            cache = memoized.cache;\n\n        if (cache.has(key)) {\n          return cache.get(key);\n        }\n        var result = func.apply(this, args);\n        memoized.cache = cache.set(key, result) || cache;\n        return result;\n      };\n      memoized.cache = new (memoize.Cache || MapCache);\n      return memoized;\n    }\n\n    // Expose `MapCache`.\n    memoize.Cache = MapCache;\n\n    /**\n     * Creates a function that negates the result of the predicate `func`. The\n     * `func` predicate is invoked with the `this` binding and arguments of the\n     * created function.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Function\n     * @param {Function} predicate The predicate to negate.\n     * @returns {Function} Returns the new negated function.\n     * @example\n     *\n     * function isEven(n) {\n     *   return n % 2 == 0;\n     * }\n     *\n     * _.filter([1, 2, 3, 4, 5, 6], _.negate(isEven));\n     * // => [1, 3, 5]\n     */\n    function negate(predicate) {\n      if (typeof predicate != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      return function() {\n        var args = arguments;\n        switch (args.length) {\n          case 0: return !predicate.call(this);\n          case 1: return !predicate.call(this, args[0]);\n          case 2: return !predicate.call(this, args[0], args[1]);\n          case 3: return !predicate.call(this, args[0], args[1], args[2]);\n        }\n        return !predicate.apply(this, args);\n      };\n    }\n\n    /**\n     * Creates a function that is restricted to invoking `func` once. Repeat calls\n     * to the function return the value of the first invocation. The `func` is\n     * invoked with the `this` binding and arguments of the created function.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to restrict.\n     * @returns {Function} Returns the new restricted function.\n     * @example\n     *\n     * var initialize = _.once(createApplication);\n     * initialize();\n     * initialize();\n     * // => `createApplication` is invoked once\n     */\n    function once(func) {\n      return before(2, func);\n    }\n\n    /**\n     * Creates a function that invokes `func` with its arguments transformed.\n     *\n     * @static\n     * @since 4.0.0\n     * @memberOf _\n     * @category Function\n     * @param {Function} func The function to wrap.\n     * @param {...(Function|Function[])} [transforms=[_.identity]]\n     *  The argument transforms.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * function doubled(n) {\n     *   return n * 2;\n     * }\n     *\n     * function square(n) {\n     *   return n * n;\n     * }\n     *\n     * var func = _.overArgs(function(x, y) {\n     *   return [x, y];\n     * }, [square, doubled]);\n     *\n     * func(9, 3);\n     * // => [81, 6]\n     *\n     * func(10, 5);\n     * // => [100, 10]\n     */\n    var overArgs = castRest(function(func, transforms) {\n      transforms = (transforms.length == 1 && isArray(transforms[0]))\n        ? arrayMap(transforms[0], baseUnary(getIteratee()))\n        : arrayMap(baseFlatten(transforms, 1), baseUnary(getIteratee()));\n\n      var funcsLength = transforms.length;\n      return baseRest(function(args) {\n        var index = -1,\n            length = nativeMin(args.length, funcsLength);\n\n        while (++index < length) {\n          args[index] = transforms[index].call(this, args[index]);\n        }\n        return apply(func, this, args);\n      });\n    });\n\n    /**\n     * Creates a function that invokes `func` with `partials` prepended to the\n     * arguments it receives. This method is like `_.bind` except it does **not**\n     * alter the `this` binding.\n     *\n     * The `_.partial.placeholder` value, which defaults to `_` in monolithic\n     * builds, may be used as a placeholder for partially applied arguments.\n     *\n     * **Note:** This method doesn't set the \"length\" property of partially\n     * applied functions.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.2.0\n     * @category Function\n     * @param {Function} func The function to partially apply arguments to.\n     * @param {...*} [partials] The arguments to be partially applied.\n     * @returns {Function} Returns the new partially applied function.\n     * @example\n     *\n     * function greet(greeting, name) {\n     *   return greeting + ' ' + name;\n     * }\n     *\n     * var sayHelloTo = _.partial(greet, 'hello');\n     * sayHelloTo('fred');\n     * // => 'hello fred'\n     *\n     * // Partially applied with placeholders.\n     * var greetFred = _.partial(greet, _, 'fred');\n     * greetFred('hi');\n     * // => 'hi fred'\n     */\n    var partial = baseRest(function(func, partials) {\n      var holders = replaceHolders(partials, getHolder(partial));\n      return createWrap(func, WRAP_PARTIAL_FLAG, undefined, partials, holders);\n    });\n\n    /**\n     * This method is like `_.partial` except that partially applied arguments\n     * are appended to the arguments it receives.\n     *\n     * The `_.partialRight.placeholder` value, which defaults to `_` in monolithic\n     * builds, may be used as a placeholder for partially applied arguments.\n     *\n     * **Note:** This method doesn't set the \"length\" property of partially\n     * applied functions.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.0.0\n     * @category Function\n     * @param {Function} func The function to partially apply arguments to.\n     * @param {...*} [partials] The arguments to be partially applied.\n     * @returns {Function} Returns the new partially applied function.\n     * @example\n     *\n     * function greet(greeting, name) {\n     *   return greeting + ' ' + name;\n     * }\n     *\n     * var greetFred = _.partialRight(greet, 'fred');\n     * greetFred('hi');\n     * // => 'hi fred'\n     *\n     * // Partially applied with placeholders.\n     * var sayHelloTo = _.partialRight(greet, 'hello', _);\n     * sayHelloTo('fred');\n     * // => 'hello fred'\n     */\n    var partialRight = baseRest(function(func, partials) {\n      var holders = replaceHolders(partials, getHolder(partialRight));\n      return createWrap(func, WRAP_PARTIAL_RIGHT_FLAG, undefined, partials, holders);\n    });\n\n    /**\n     * Creates a function that invokes `func` with arguments arranged according\n     * to the specified `indexes` where the argument value at the first index is\n     * provided as the first argument, the argument value at the second index is\n     * provided as the second argument, and so on.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Function\n     * @param {Function} func The function to rearrange arguments for.\n     * @param {...(number|number[])} indexes The arranged argument indexes.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var rearged = _.rearg(function(a, b, c) {\n     *   return [a, b, c];\n     * }, [2, 0, 1]);\n     *\n     * rearged('b', 'c', 'a')\n     * // => ['a', 'b', 'c']\n     */\n    var rearg = flatRest(function(func, indexes) {\n      return createWrap(func, WRAP_REARG_FLAG, undefined, undefined, undefined, indexes);\n    });\n\n    /**\n     * Creates a function that invokes `func` with the `this` binding of the\n     * created function and arguments from `start` and beyond provided as\n     * an array.\n     *\n     * **Note:** This method is based on the\n     * [rest parameter](https://mdn.io/rest_parameters).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Function\n     * @param {Function} func The function to apply a rest parameter to.\n     * @param {number} [start=func.length-1] The start position of the rest parameter.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var say = _.rest(function(what, names) {\n     *   return what + ' ' + _.initial(names).join(', ') +\n     *     (_.size(names) > 1 ? ', & ' : '') + _.last(names);\n     * });\n     *\n     * say('hello', 'fred', 'barney', 'pebbles');\n     * // => 'hello fred, barney, & pebbles'\n     */\n    function rest(func, start) {\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      start = start === undefined ? start : toInteger(start);\n      return baseRest(func, start);\n    }\n\n    /**\n     * Creates a function that invokes `func` with the `this` binding of the\n     * create function and an array of arguments much like\n     * [`Function#apply`](http://www.ecma-international.org/ecma-262/7.0/#sec-function.prototype.apply).\n     *\n     * **Note:** This method is based on the\n     * [spread operator](https://mdn.io/spread_operator).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.2.0\n     * @category Function\n     * @param {Function} func The function to spread arguments over.\n     * @param {number} [start=0] The start position of the spread.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var say = _.spread(function(who, what) {\n     *   return who + ' says ' + what;\n     * });\n     *\n     * say(['fred', 'hello']);\n     * // => 'fred says hello'\n     *\n     * var numbers = Promise.all([\n     *   Promise.resolve(40),\n     *   Promise.resolve(36)\n     * ]);\n     *\n     * numbers.then(_.spread(function(x, y) {\n     *   return x + y;\n     * }));\n     * // => a Promise of 76\n     */\n    function spread(func, start) {\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      start = start == null ? 0 : nativeMax(toInteger(start), 0);\n      return baseRest(function(args) {\n        var array = args[start],\n            otherArgs = castSlice(args, 0, start);\n\n        if (array) {\n          arrayPush(otherArgs, array);\n        }\n        return apply(func, this, otherArgs);\n      });\n    }\n\n    /**\n     * Creates a throttled function that only invokes `func` at most once per\n     * every `wait` milliseconds. The throttled function comes with a `cancel`\n     * method to cancel delayed `func` invocations and a `flush` method to\n     * immediately invoke them. Provide `options` to indicate whether `func`\n     * should be invoked on the leading and/or trailing edge of the `wait`\n     * timeout. The `func` is invoked with the last arguments provided to the\n     * throttled function. Subsequent calls to the throttled function return the\n     * result of the last `func` invocation.\n     *\n     * **Note:** If `leading` and `trailing` options are `true`, `func` is\n     * invoked on the trailing edge of the timeout only if the throttled function\n     * is invoked more than once during the `wait` timeout.\n     *\n     * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n     * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n     *\n     * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n     * for details over the differences between `_.throttle` and `_.debounce`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to throttle.\n     * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n     * @param {Object} [options={}] The options object.\n     * @param {boolean} [options.leading=true]\n     *  Specify invoking on the leading edge of the timeout.\n     * @param {boolean} [options.trailing=true]\n     *  Specify invoking on the trailing edge of the timeout.\n     * @returns {Function} Returns the new throttled function.\n     * @example\n     *\n     * // Avoid excessively updating the position while scrolling.\n     * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n     *\n     * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n     * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n     * jQuery(element).on('click', throttled);\n     *\n     * // Cancel the trailing throttled invocation.\n     * jQuery(window).on('popstate', throttled.cancel);\n     */\n    function throttle(func, wait, options) {\n      var leading = true,\n          trailing = true;\n\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      if (isObject(options)) {\n        leading = 'leading' in options ? !!options.leading : leading;\n        trailing = 'trailing' in options ? !!options.trailing : trailing;\n      }\n      return debounce(func, wait, {\n        'leading': leading,\n        'maxWait': wait,\n        'trailing': trailing\n      });\n    }\n\n    /**\n     * Creates a function that accepts up to one argument, ignoring any\n     * additional arguments.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Function\n     * @param {Function} func The function to cap arguments for.\n     * @returns {Function} Returns the new capped function.\n     * @example\n     *\n     * _.map(['6', '8', '10'], _.unary(parseInt));\n     * // => [6, 8, 10]\n     */\n    function unary(func) {\n      return ary(func, 1);\n    }\n\n    /**\n     * Creates a function that provides `value` to `wrapper` as its first\n     * argument. Any additional arguments provided to the function are appended\n     * to those provided to the `wrapper`. The wrapper is invoked with the `this`\n     * binding of the created function.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {*} value The value to wrap.\n     * @param {Function} [wrapper=identity] The wrapper function.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var p = _.wrap(_.escape, function(func, text) {\n     *   return '<p>' + func(text) + '</p>';\n     * });\n     *\n     * p('fred, barney, & pebbles');\n     * // => '<p>fred, barney, &amp; pebbles</p>'\n     */\n    function wrap(value, wrapper) {\n      return partial(castFunction(wrapper), value);\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Casts `value` as an array if it's not one.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.4.0\n     * @category Lang\n     * @param {*} value The value to inspect.\n     * @returns {Array} Returns the cast array.\n     * @example\n     *\n     * _.castArray(1);\n     * // => [1]\n     *\n     * _.castArray({ 'a': 1 });\n     * // => [{ 'a': 1 }]\n     *\n     * _.castArray('abc');\n     * // => ['abc']\n     *\n     * _.castArray(null);\n     * // => [null]\n     *\n     * _.castArray(undefined);\n     * // => [undefined]\n     *\n     * _.castArray();\n     * // => []\n     *\n     * var array = [1, 2, 3];\n     * console.log(_.castArray(array) === array);\n     * // => true\n     */\n    function castArray() {\n      if (!arguments.length) {\n        return [];\n      }\n      var value = arguments[0];\n      return isArray(value) ? value : [value];\n    }\n\n    /**\n     * Creates a shallow clone of `value`.\n     *\n     * **Note:** This method is loosely based on the\n     * [structured clone algorithm](https://mdn.io/Structured_clone_algorithm)\n     * and supports cloning arrays, array buffers, booleans, date objects, maps,\n     * numbers, `Object` objects, regexes, sets, strings, symbols, and typed\n     * arrays. The own enumerable properties of `arguments` objects are cloned\n     * as plain objects. An empty object is returned for uncloneable values such\n     * as error objects, functions, DOM nodes, and WeakMaps.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to clone.\n     * @returns {*} Returns the cloned value.\n     * @see _.cloneDeep\n     * @example\n     *\n     * var objects = [{ 'a': 1 }, { 'b': 2 }];\n     *\n     * var shallow = _.clone(objects);\n     * console.log(shallow[0] === objects[0]);\n     * // => true\n     */\n    function clone(value) {\n      return baseClone(value, CLONE_SYMBOLS_FLAG);\n    }\n\n    /**\n     * This method is like `_.clone` except that it accepts `customizer` which\n     * is invoked to produce the cloned value. If `customizer` returns `undefined`,\n     * cloning is handled by the method instead. The `customizer` is invoked with\n     * up to four arguments; (value [, index|key, object, stack]).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to clone.\n     * @param {Function} [customizer] The function to customize cloning.\n     * @returns {*} Returns the cloned value.\n     * @see _.cloneDeepWith\n     * @example\n     *\n     * function customizer(value) {\n     *   if (_.isElement(value)) {\n     *     return value.cloneNode(false);\n     *   }\n     * }\n     *\n     * var el = _.cloneWith(document.body, customizer);\n     *\n     * console.log(el === document.body);\n     * // => false\n     * console.log(el.nodeName);\n     * // => 'BODY'\n     * console.log(el.childNodes.length);\n     * // => 0\n     */\n    function cloneWith(value, customizer) {\n      customizer = typeof customizer == 'function' ? customizer : undefined;\n      return baseClone(value, CLONE_SYMBOLS_FLAG, customizer);\n    }\n\n    /**\n     * This method is like `_.clone` except that it recursively clones `value`.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.0.0\n     * @category Lang\n     * @param {*} value The value to recursively clone.\n     * @returns {*} Returns the deep cloned value.\n     * @see _.clone\n     * @example\n     *\n     * var objects = [{ 'a': 1 }, { 'b': 2 }];\n     *\n     * var deep = _.cloneDeep(objects);\n     * console.log(deep[0] === objects[0]);\n     * // => false\n     */\n    function cloneDeep(value) {\n      return baseClone(value, CLONE_DEEP_FLAG | CLONE_SYMBOLS_FLAG);\n    }\n\n    /**\n     * This method is like `_.cloneWith` except that it recursively clones `value`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to recursively clone.\n     * @param {Function} [customizer] The function to customize cloning.\n     * @returns {*} Returns the deep cloned value.\n     * @see _.cloneWith\n     * @example\n     *\n     * function customizer(value) {\n     *   if (_.isElement(value)) {\n     *     return value.cloneNode(true);\n     *   }\n     * }\n     *\n     * var el = _.cloneDeepWith(document.body, customizer);\n     *\n     * console.log(el === document.body);\n     * // => false\n     * console.log(el.nodeName);\n     * // => 'BODY'\n     * console.log(el.childNodes.length);\n     * // => 20\n     */\n    function cloneDeepWith(value, customizer) {\n      customizer = typeof customizer == 'function' ? customizer : undefined;\n      return baseClone(value, CLONE_DEEP_FLAG | CLONE_SYMBOLS_FLAG, customizer);\n    }\n\n    /**\n     * Checks if `object` conforms to `source` by invoking the predicate\n     * properties of `source` with the corresponding property values of `object`.\n     *\n     * **Note:** This method is equivalent to `_.conforms` when `source` is\n     * partially applied.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.14.0\n     * @category Lang\n     * @param {Object} object The object to inspect.\n     * @param {Object} source The object of property predicates to conform to.\n     * @returns {boolean} Returns `true` if `object` conforms, else `false`.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': 2 };\n     *\n     * _.conformsTo(object, { 'b': function(n) { return n > 1; } });\n     * // => true\n     *\n     * _.conformsTo(object, { 'b': function(n) { return n > 2; } });\n     * // => false\n     */\n    function conformsTo(object, source) {\n      return source == null || baseConformsTo(object, source, keys(source));\n    }\n\n    /**\n     * Performs a\n     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * comparison between two values to determine if they are equivalent.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n     * @example\n     *\n     * var object = { 'a': 1 };\n     * var other = { 'a': 1 };\n     *\n     * _.eq(object, object);\n     * // => true\n     *\n     * _.eq(object, other);\n     * // => false\n     *\n     * _.eq('a', 'a');\n     * // => true\n     *\n     * _.eq('a', Object('a'));\n     * // => false\n     *\n     * _.eq(NaN, NaN);\n     * // => true\n     */\n    function eq(value, other) {\n      return value === other || (value !== value && other !== other);\n    }\n\n    /**\n     * Checks if `value` is greater than `other`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.9.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if `value` is greater than `other`,\n     *  else `false`.\n     * @see _.lt\n     * @example\n     *\n     * _.gt(3, 1);\n     * // => true\n     *\n     * _.gt(3, 3);\n     * // => false\n     *\n     * _.gt(1, 3);\n     * // => false\n     */\n    var gt = createRelationalOperation(baseGt);\n\n    /**\n     * Checks if `value` is greater than or equal to `other`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.9.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if `value` is greater than or equal to\n     *  `other`, else `false`.\n     * @see _.lte\n     * @example\n     *\n     * _.gte(3, 1);\n     * // => true\n     *\n     * _.gte(3, 3);\n     * // => true\n     *\n     * _.gte(1, 3);\n     * // => false\n     */\n    var gte = createRelationalOperation(function(value, other) {\n      return value >= other;\n    });\n\n    /**\n     * Checks if `value` is likely an `arguments` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n     *  else `false`.\n     * @example\n     *\n     * _.isArguments(function() { return arguments; }());\n     * // => true\n     *\n     * _.isArguments([1, 2, 3]);\n     * // => false\n     */\n    var isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n      return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n        !propertyIsEnumerable.call(value, 'callee');\n    };\n\n    /**\n     * Checks if `value` is classified as an `Array` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n     * @example\n     *\n     * _.isArray([1, 2, 3]);\n     * // => true\n     *\n     * _.isArray(document.body.children);\n     * // => false\n     *\n     * _.isArray('abc');\n     * // => false\n     *\n     * _.isArray(_.noop);\n     * // => false\n     */\n    var isArray = Array.isArray;\n\n    /**\n     * Checks if `value` is classified as an `ArrayBuffer` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.3.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an array buffer, else `false`.\n     * @example\n     *\n     * _.isArrayBuffer(new ArrayBuffer(2));\n     * // => true\n     *\n     * _.isArrayBuffer(new Array(2));\n     * // => false\n     */\n    var isArrayBuffer = nodeIsArrayBuffer ? baseUnary(nodeIsArrayBuffer) : baseIsArrayBuffer;\n\n    /**\n     * Checks if `value` is array-like. A value is considered array-like if it's\n     * not a function and has a `value.length` that's an integer greater than or\n     * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n     * @example\n     *\n     * _.isArrayLike([1, 2, 3]);\n     * // => true\n     *\n     * _.isArrayLike(document.body.children);\n     * // => true\n     *\n     * _.isArrayLike('abc');\n     * // => true\n     *\n     * _.isArrayLike(_.noop);\n     * // => false\n     */\n    function isArrayLike(value) {\n      return value != null && isLength(value.length) && !isFunction(value);\n    }\n\n    /**\n     * This method is like `_.isArrayLike` except that it also checks if `value`\n     * is an object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an array-like object,\n     *  else `false`.\n     * @example\n     *\n     * _.isArrayLikeObject([1, 2, 3]);\n     * // => true\n     *\n     * _.isArrayLikeObject(document.body.children);\n     * // => true\n     *\n     * _.isArrayLikeObject('abc');\n     * // => false\n     *\n     * _.isArrayLikeObject(_.noop);\n     * // => false\n     */\n    function isArrayLikeObject(value) {\n      return isObjectLike(value) && isArrayLike(value);\n    }\n\n    /**\n     * Checks if `value` is classified as a boolean primitive or object.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a boolean, else `false`.\n     * @example\n     *\n     * _.isBoolean(false);\n     * // => true\n     *\n     * _.isBoolean(null);\n     * // => false\n     */\n    function isBoolean(value) {\n      return value === true || value === false ||\n        (isObjectLike(value) && baseGetTag(value) == boolTag);\n    }\n\n    /**\n     * Checks if `value` is a buffer.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.3.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n     * @example\n     *\n     * _.isBuffer(new Buffer(2));\n     * // => true\n     *\n     * _.isBuffer(new Uint8Array(2));\n     * // => false\n     */\n    var isBuffer = nativeIsBuffer || stubFalse;\n\n    /**\n     * Checks if `value` is classified as a `Date` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a date object, else `false`.\n     * @example\n     *\n     * _.isDate(new Date);\n     * // => true\n     *\n     * _.isDate('Mon April 23 2012');\n     * // => false\n     */\n    var isDate = nodeIsDate ? baseUnary(nodeIsDate) : baseIsDate;\n\n    /**\n     * Checks if `value` is likely a DOM element.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a DOM element, else `false`.\n     * @example\n     *\n     * _.isElement(document.body);\n     * // => true\n     *\n     * _.isElement('<body>');\n     * // => false\n     */\n    function isElement(value) {\n      return isObjectLike(value) && value.nodeType === 1 && !isPlainObject(value);\n    }\n\n    /**\n     * Checks if `value` is an empty object, collection, map, or set.\n     *\n     * Objects are considered empty if they have no own enumerable string keyed\n     * properties.\n     *\n     * Array-like values such as `arguments` objects, arrays, buffers, strings, or\n     * jQuery-like collections are considered empty if they have a `length` of `0`.\n     * Similarly, maps and sets are considered empty if they have a `size` of `0`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is empty, else `false`.\n     * @example\n     *\n     * _.isEmpty(null);\n     * // => true\n     *\n     * _.isEmpty(true);\n     * // => true\n     *\n     * _.isEmpty(1);\n     * // => true\n     *\n     * _.isEmpty([1, 2, 3]);\n     * // => false\n     *\n     * _.isEmpty({ 'a': 1 });\n     * // => false\n     */\n    function isEmpty(value) {\n      if (value == null) {\n        return true;\n      }\n      if (isArrayLike(value) &&\n          (isArray(value) || typeof value == 'string' || typeof value.splice == 'function' ||\n            isBuffer(value) || isTypedArray(value) || isArguments(value))) {\n        return !value.length;\n      }\n      var tag = getTag(value);\n      if (tag == mapTag || tag == setTag) {\n        return !value.size;\n      }\n      if (isPrototype(value)) {\n        return !baseKeys(value).length;\n      }\n      for (var key in value) {\n        if (hasOwnProperty.call(value, key)) {\n          return false;\n        }\n      }\n      return true;\n    }\n\n    /**\n     * Performs a deep comparison between two values to determine if they are\n     * equivalent.\n     *\n     * **Note:** This method supports comparing arrays, array buffers, booleans,\n     * date objects, error objects, maps, numbers, `Object` objects, regexes,\n     * sets, strings, symbols, and typed arrays. `Object` objects are compared\n     * by their own, not inherited, enumerable properties. Functions and DOM\n     * nodes are compared by strict equality, i.e. `===`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n     * @example\n     *\n     * var object = { 'a': 1 };\n     * var other = { 'a': 1 };\n     *\n     * _.isEqual(object, other);\n     * // => true\n     *\n     * object === other;\n     * // => false\n     */\n    function isEqual(value, other) {\n      return baseIsEqual(value, other);\n    }\n\n    /**\n     * This method is like `_.isEqual` except that it accepts `customizer` which\n     * is invoked to compare values. If `customizer` returns `undefined`, comparisons\n     * are handled by the method instead. The `customizer` is invoked with up to\n     * six arguments: (objValue, othValue [, index|key, object, other, stack]).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @param {Function} [customizer] The function to customize comparisons.\n     * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n     * @example\n     *\n     * function isGreeting(value) {\n     *   return /^h(?:i|ello)$/.test(value);\n     * }\n     *\n     * function customizer(objValue, othValue) {\n     *   if (isGreeting(objValue) && isGreeting(othValue)) {\n     *     return true;\n     *   }\n     * }\n     *\n     * var array = ['hello', 'goodbye'];\n     * var other = ['hi', 'goodbye'];\n     *\n     * _.isEqualWith(array, other, customizer);\n     * // => true\n     */\n    function isEqualWith(value, other, customizer) {\n      customizer = typeof customizer == 'function' ? customizer : undefined;\n      var result = customizer ? customizer(value, other) : undefined;\n      return result === undefined ? baseIsEqual(value, other, undefined, customizer) : !!result;\n    }\n\n    /**\n     * Checks if `value` is an `Error`, `EvalError`, `RangeError`, `ReferenceError`,\n     * `SyntaxError`, `TypeError`, or `URIError` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an error object, else `false`.\n     * @example\n     *\n     * _.isError(new Error);\n     * // => true\n     *\n     * _.isError(Error);\n     * // => false\n     */\n    function isError(value) {\n      if (!isObjectLike(value)) {\n        return false;\n      }\n      var tag = baseGetTag(value);\n      return tag == errorTag || tag == domExcTag ||\n        (typeof value.message == 'string' && typeof value.name == 'string' && !isPlainObject(value));\n    }\n\n    /**\n     * Checks if `value` is a finite primitive number.\n     *\n     * **Note:** This method is based on\n     * [`Number.isFinite`](https://mdn.io/Number/isFinite).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a finite number, else `false`.\n     * @example\n     *\n     * _.isFinite(3);\n     * // => true\n     *\n     * _.isFinite(Number.MIN_VALUE);\n     * // => true\n     *\n     * _.isFinite(Infinity);\n     * // => false\n     *\n     * _.isFinite('3');\n     * // => false\n     */\n    function isFinite(value) {\n      return typeof value == 'number' && nativeIsFinite(value);\n    }\n\n    /**\n     * Checks if `value` is classified as a `Function` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n     * @example\n     *\n     * _.isFunction(_);\n     * // => true\n     *\n     * _.isFunction(/abc/);\n     * // => false\n     */\n    function isFunction(value) {\n      if (!isObject(value)) {\n        return false;\n      }\n      // The use of `Object#toString` avoids issues with the `typeof` operator\n      // in Safari 9 which returns 'object' for typed arrays and other constructors.\n      var tag = baseGetTag(value);\n      return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n    }\n\n    /**\n     * Checks if `value` is an integer.\n     *\n     * **Note:** This method is based on\n     * [`Number.isInteger`](https://mdn.io/Number/isInteger).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an integer, else `false`.\n     * @example\n     *\n     * _.isInteger(3);\n     * // => true\n     *\n     * _.isInteger(Number.MIN_VALUE);\n     * // => false\n     *\n     * _.isInteger(Infinity);\n     * // => false\n     *\n     * _.isInteger('3');\n     * // => false\n     */\n    function isInteger(value) {\n      return typeof value == 'number' && value == toInteger(value);\n    }\n\n    /**\n     * Checks if `value` is a valid array-like length.\n     *\n     * **Note:** This method is loosely based on\n     * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n     * @example\n     *\n     * _.isLength(3);\n     * // => true\n     *\n     * _.isLength(Number.MIN_VALUE);\n     * // => false\n     *\n     * _.isLength(Infinity);\n     * // => false\n     *\n     * _.isLength('3');\n     * // => false\n     */\n    function isLength(value) {\n      return typeof value == 'number' &&\n        value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n    }\n\n    /**\n     * Checks if `value` is the\n     * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n     * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n     * @example\n     *\n     * _.isObject({});\n     * // => true\n     *\n     * _.isObject([1, 2, 3]);\n     * // => true\n     *\n     * _.isObject(_.noop);\n     * // => true\n     *\n     * _.isObject(null);\n     * // => false\n     */\n    function isObject(value) {\n      var type = typeof value;\n      return value != null && (type == 'object' || type == 'function');\n    }\n\n    /**\n     * Checks if `value` is object-like. A value is object-like if it's not `null`\n     * and has a `typeof` result of \"object\".\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n     * @example\n     *\n     * _.isObjectLike({});\n     * // => true\n     *\n     * _.isObjectLike([1, 2, 3]);\n     * // => true\n     *\n     * _.isObjectLike(_.noop);\n     * // => false\n     *\n     * _.isObjectLike(null);\n     * // => false\n     */\n    function isObjectLike(value) {\n      return value != null && typeof value == 'object';\n    }\n\n    /**\n     * Checks if `value` is classified as a `Map` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.3.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a map, else `false`.\n     * @example\n     *\n     * _.isMap(new Map);\n     * // => true\n     *\n     * _.isMap(new WeakMap);\n     * // => false\n     */\n    var isMap = nodeIsMap ? baseUnary(nodeIsMap) : baseIsMap;\n\n    /**\n     * Performs a partial deep comparison between `object` and `source` to\n     * determine if `object` contains equivalent property values.\n     *\n     * **Note:** This method is equivalent to `_.matches` when `source` is\n     * partially applied.\n     *\n     * Partial comparisons will match empty array and empty object `source`\n     * values against any array or object value, respectively. See `_.isEqual`\n     * for a list of supported value comparisons.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Lang\n     * @param {Object} object The object to inspect.\n     * @param {Object} source The object of property values to match.\n     * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': 2 };\n     *\n     * _.isMatch(object, { 'b': 2 });\n     * // => true\n     *\n     * _.isMatch(object, { 'b': 1 });\n     * // => false\n     */\n    function isMatch(object, source) {\n      return object === source || baseIsMatch(object, source, getMatchData(source));\n    }\n\n    /**\n     * This method is like `_.isMatch` except that it accepts `customizer` which\n     * is invoked to compare values. If `customizer` returns `undefined`, comparisons\n     * are handled by the method instead. The `customizer` is invoked with five\n     * arguments: (objValue, srcValue, index|key, object, source).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {Object} object The object to inspect.\n     * @param {Object} source The object of property values to match.\n     * @param {Function} [customizer] The function to customize comparisons.\n     * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n     * @example\n     *\n     * function isGreeting(value) {\n     *   return /^h(?:i|ello)$/.test(value);\n     * }\n     *\n     * function customizer(objValue, srcValue) {\n     *   if (isGreeting(objValue) && isGreeting(srcValue)) {\n     *     return true;\n     *   }\n     * }\n     *\n     * var object = { 'greeting': 'hello' };\n     * var source = { 'greeting': 'hi' };\n     *\n     * _.isMatchWith(object, source, customizer);\n     * // => true\n     */\n    function isMatchWith(object, source, customizer) {\n      customizer = typeof customizer == 'function' ? customizer : undefined;\n      return baseIsMatch(object, source, getMatchData(source), customizer);\n    }\n\n    /**\n     * Checks if `value` is `NaN`.\n     *\n     * **Note:** This method is based on\n     * [`Number.isNaN`](https://mdn.io/Number/isNaN) and is not the same as\n     * global [`isNaN`](https://mdn.io/isNaN) which returns `true` for\n     * `undefined` and other non-number values.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n     * @example\n     *\n     * _.isNaN(NaN);\n     * // => true\n     *\n     * _.isNaN(new Number(NaN));\n     * // => true\n     *\n     * isNaN(undefined);\n     * // => true\n     *\n     * _.isNaN(undefined);\n     * // => false\n     */\n    function isNaN(value) {\n      // An `NaN` primitive is the only value that is not equal to itself.\n      // Perform the `toStringTag` check first to avoid errors with some\n      // ActiveX objects in IE.\n      return isNumber(value) && value != +value;\n    }\n\n    /**\n     * Checks if `value` is a pristine native function.\n     *\n     * **Note:** This method can't reliably detect native functions in the presence\n     * of the core-js package because core-js circumvents this kind of detection.\n     * Despite multiple requests, the core-js maintainer has made it clear: any\n     * attempt to fix the detection will be obstructed. As a result, we're left\n     * with little choice but to throw an error. Unfortunately, this also affects\n     * packages, like [babel-polyfill](https://www.npmjs.com/package/babel-polyfill),\n     * which rely on core-js.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a native function,\n     *  else `false`.\n     * @example\n     *\n     * _.isNative(Array.prototype.push);\n     * // => true\n     *\n     * _.isNative(_);\n     * // => false\n     */\n    function isNative(value) {\n      if (isMaskable(value)) {\n        throw new Error(CORE_ERROR_TEXT);\n      }\n      return baseIsNative(value);\n    }\n\n    /**\n     * Checks if `value` is `null`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is `null`, else `false`.\n     * @example\n     *\n     * _.isNull(null);\n     * // => true\n     *\n     * _.isNull(void 0);\n     * // => false\n     */\n    function isNull(value) {\n      return value === null;\n    }\n\n    /**\n     * Checks if `value` is `null` or `undefined`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is nullish, else `false`.\n     * @example\n     *\n     * _.isNil(null);\n     * // => true\n     *\n     * _.isNil(void 0);\n     * // => true\n     *\n     * _.isNil(NaN);\n     * // => false\n     */\n    function isNil(value) {\n      return value == null;\n    }\n\n    /**\n     * Checks if `value` is classified as a `Number` primitive or object.\n     *\n     * **Note:** To exclude `Infinity`, `-Infinity`, and `NaN`, which are\n     * classified as numbers, use the `_.isFinite` method.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a number, else `false`.\n     * @example\n     *\n     * _.isNumber(3);\n     * // => true\n     *\n     * _.isNumber(Number.MIN_VALUE);\n     * // => true\n     *\n     * _.isNumber(Infinity);\n     * // => true\n     *\n     * _.isNumber('3');\n     * // => false\n     */\n    function isNumber(value) {\n      return typeof value == 'number' ||\n        (isObjectLike(value) && baseGetTag(value) == numberTag);\n    }\n\n    /**\n     * Checks if `value` is a plain object, that is, an object created by the\n     * `Object` constructor or one with a `[[Prototype]]` of `null`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.8.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     * }\n     *\n     * _.isPlainObject(new Foo);\n     * // => false\n     *\n     * _.isPlainObject([1, 2, 3]);\n     * // => false\n     *\n     * _.isPlainObject({ 'x': 0, 'y': 0 });\n     * // => true\n     *\n     * _.isPlainObject(Object.create(null));\n     * // => true\n     */\n    function isPlainObject(value) {\n      if (!isObjectLike(value) || baseGetTag(value) != objectTag) {\n        return false;\n      }\n      var proto = getPrototype(value);\n      if (proto === null) {\n        return true;\n      }\n      var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;\n      return typeof Ctor == 'function' && Ctor instanceof Ctor &&\n        funcToString.call(Ctor) == objectCtorString;\n    }\n\n    /**\n     * Checks if `value` is classified as a `RegExp` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a regexp, else `false`.\n     * @example\n     *\n     * _.isRegExp(/abc/);\n     * // => true\n     *\n     * _.isRegExp('/abc/');\n     * // => false\n     */\n    var isRegExp = nodeIsRegExp ? baseUnary(nodeIsRegExp) : baseIsRegExp;\n\n    /**\n     * Checks if `value` is a safe integer. An integer is safe if it's an IEEE-754\n     * double precision number which isn't the result of a rounded unsafe integer.\n     *\n     * **Note:** This method is based on\n     * [`Number.isSafeInteger`](https://mdn.io/Number/isSafeInteger).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a safe integer, else `false`.\n     * @example\n     *\n     * _.isSafeInteger(3);\n     * // => true\n     *\n     * _.isSafeInteger(Number.MIN_VALUE);\n     * // => false\n     *\n     * _.isSafeInteger(Infinity);\n     * // => false\n     *\n     * _.isSafeInteger('3');\n     * // => false\n     */\n    function isSafeInteger(value) {\n      return isInteger(value) && value >= -MAX_SAFE_INTEGER && value <= MAX_SAFE_INTEGER;\n    }\n\n    /**\n     * Checks if `value` is classified as a `Set` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.3.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a set, else `false`.\n     * @example\n     *\n     * _.isSet(new Set);\n     * // => true\n     *\n     * _.isSet(new WeakSet);\n     * // => false\n     */\n    var isSet = nodeIsSet ? baseUnary(nodeIsSet) : baseIsSet;\n\n    /**\n     * Checks if `value` is classified as a `String` primitive or object.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a string, else `false`.\n     * @example\n     *\n     * _.isString('abc');\n     * // => true\n     *\n     * _.isString(1);\n     * // => false\n     */\n    function isString(value) {\n      return typeof value == 'string' ||\n        (!isArray(value) && isObjectLike(value) && baseGetTag(value) == stringTag);\n    }\n\n    /**\n     * Checks if `value` is classified as a `Symbol` primitive or object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n     * @example\n     *\n     * _.isSymbol(Symbol.iterator);\n     * // => true\n     *\n     * _.isSymbol('abc');\n     * // => false\n     */\n    function isSymbol(value) {\n      return typeof value == 'symbol' ||\n        (isObjectLike(value) && baseGetTag(value) == symbolTag);\n    }\n\n    /**\n     * Checks if `value` is classified as a typed array.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n     * @example\n     *\n     * _.isTypedArray(new Uint8Array);\n     * // => true\n     *\n     * _.isTypedArray([]);\n     * // => false\n     */\n    var isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\n    /**\n     * Checks if `value` is `undefined`.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is `undefined`, else `false`.\n     * @example\n     *\n     * _.isUndefined(void 0);\n     * // => true\n     *\n     * _.isUndefined(null);\n     * // => false\n     */\n    function isUndefined(value) {\n      return value === undefined;\n    }\n\n    /**\n     * Checks if `value` is classified as a `WeakMap` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.3.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a weak map, else `false`.\n     * @example\n     *\n     * _.isWeakMap(new WeakMap);\n     * // => true\n     *\n     * _.isWeakMap(new Map);\n     * // => false\n     */\n    function isWeakMap(value) {\n      return isObjectLike(value) && getTag(value) == weakMapTag;\n    }\n\n    /**\n     * Checks if `value` is classified as a `WeakSet` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.3.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a weak set, else `false`.\n     * @example\n     *\n     * _.isWeakSet(new WeakSet);\n     * // => true\n     *\n     * _.isWeakSet(new Set);\n     * // => false\n     */\n    function isWeakSet(value) {\n      return isObjectLike(value) && baseGetTag(value) == weakSetTag;\n    }\n\n    /**\n     * Checks if `value` is less than `other`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.9.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if `value` is less than `other`,\n     *  else `false`.\n     * @see _.gt\n     * @example\n     *\n     * _.lt(1, 3);\n     * // => true\n     *\n     * _.lt(3, 3);\n     * // => false\n     *\n     * _.lt(3, 1);\n     * // => false\n     */\n    var lt = createRelationalOperation(baseLt);\n\n    /**\n     * Checks if `value` is less than or equal to `other`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.9.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if `value` is less than or equal to\n     *  `other`, else `false`.\n     * @see _.gte\n     * @example\n     *\n     * _.lte(1, 3);\n     * // => true\n     *\n     * _.lte(3, 3);\n     * // => true\n     *\n     * _.lte(3, 1);\n     * // => false\n     */\n    var lte = createRelationalOperation(function(value, other) {\n      return value <= other;\n    });\n\n    /**\n     * Converts `value` to an array.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {Array} Returns the converted array.\n     * @example\n     *\n     * _.toArray({ 'a': 1, 'b': 2 });\n     * // => [1, 2]\n     *\n     * _.toArray('abc');\n     * // => ['a', 'b', 'c']\n     *\n     * _.toArray(1);\n     * // => []\n     *\n     * _.toArray(null);\n     * // => []\n     */\n    function toArray(value) {\n      if (!value) {\n        return [];\n      }\n      if (isArrayLike(value)) {\n        return isString(value) ? stringToArray(value) : copyArray(value);\n      }\n      if (symIterator && value[symIterator]) {\n        return iteratorToArray(value[symIterator]());\n      }\n      var tag = getTag(value),\n          func = tag == mapTag ? mapToArray : (tag == setTag ? setToArray : values);\n\n      return func(value);\n    }\n\n    /**\n     * Converts `value` to a finite number.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.12.0\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {number} Returns the converted number.\n     * @example\n     *\n     * _.toFinite(3.2);\n     * // => 3.2\n     *\n     * _.toFinite(Number.MIN_VALUE);\n     * // => 5e-324\n     *\n     * _.toFinite(Infinity);\n     * // => 1.7976931348623157e+308\n     *\n     * _.toFinite('3.2');\n     * // => 3.2\n     */\n    function toFinite(value) {\n      if (!value) {\n        return value === 0 ? value : 0;\n      }\n      value = toNumber(value);\n      if (value === INFINITY || value === -INFINITY) {\n        var sign = (value < 0 ? -1 : 1);\n        return sign * MAX_INTEGER;\n      }\n      return value === value ? value : 0;\n    }\n\n    /**\n     * Converts `value` to an integer.\n     *\n     * **Note:** This method is loosely based on\n     * [`ToInteger`](http://www.ecma-international.org/ecma-262/7.0/#sec-tointeger).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {number} Returns the converted integer.\n     * @example\n     *\n     * _.toInteger(3.2);\n     * // => 3\n     *\n     * _.toInteger(Number.MIN_VALUE);\n     * // => 0\n     *\n     * _.toInteger(Infinity);\n     * // => 1.7976931348623157e+308\n     *\n     * _.toInteger('3.2');\n     * // => 3\n     */\n    function toInteger(value) {\n      var result = toFinite(value),\n          remainder = result % 1;\n\n      return result === result ? (remainder ? result - remainder : result) : 0;\n    }\n\n    /**\n     * Converts `value` to an integer suitable for use as the length of an\n     * array-like object.\n     *\n     * **Note:** This method is based on\n     * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {number} Returns the converted integer.\n     * @example\n     *\n     * _.toLength(3.2);\n     * // => 3\n     *\n     * _.toLength(Number.MIN_VALUE);\n     * // => 0\n     *\n     * _.toLength(Infinity);\n     * // => 4294967295\n     *\n     * _.toLength('3.2');\n     * // => 3\n     */\n    function toLength(value) {\n      return value ? baseClamp(toInteger(value), 0, MAX_ARRAY_LENGTH) : 0;\n    }\n\n    /**\n     * Converts `value` to a number.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to process.\n     * @returns {number} Returns the number.\n     * @example\n     *\n     * _.toNumber(3.2);\n     * // => 3.2\n     *\n     * _.toNumber(Number.MIN_VALUE);\n     * // => 5e-324\n     *\n     * _.toNumber(Infinity);\n     * // => Infinity\n     *\n     * _.toNumber('3.2');\n     * // => 3.2\n     */\n    function toNumber(value) {\n      if (typeof value == 'number') {\n        return value;\n      }\n      if (isSymbol(value)) {\n        return NAN;\n      }\n      if (isObject(value)) {\n        var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n        value = isObject(other) ? (other + '') : other;\n      }\n      if (typeof value != 'string') {\n        return value === 0 ? value : +value;\n      }\n      value = baseTrim(value);\n      var isBinary = reIsBinary.test(value);\n      return (isBinary || reIsOctal.test(value))\n        ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n        : (reIsBadHex.test(value) ? NAN : +value);\n    }\n\n    /**\n     * Converts `value` to a plain object flattening inherited enumerable string\n     * keyed properties of `value` to own properties of the plain object.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {Object} Returns the converted plain object.\n     * @example\n     *\n     * function Foo() {\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.assign({ 'a': 1 }, new Foo);\n     * // => { 'a': 1, 'b': 2 }\n     *\n     * _.assign({ 'a': 1 }, _.toPlainObject(new Foo));\n     * // => { 'a': 1, 'b': 2, 'c': 3 }\n     */\n    function toPlainObject(value) {\n      return copyObject(value, keysIn(value));\n    }\n\n    /**\n     * Converts `value` to a safe integer. A safe integer can be compared and\n     * represented correctly.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {number} Returns the converted integer.\n     * @example\n     *\n     * _.toSafeInteger(3.2);\n     * // => 3\n     *\n     * _.toSafeInteger(Number.MIN_VALUE);\n     * // => 0\n     *\n     * _.toSafeInteger(Infinity);\n     * // => 9007199254740991\n     *\n     * _.toSafeInteger('3.2');\n     * // => 3\n     */\n    function toSafeInteger(value) {\n      return value\n        ? baseClamp(toInteger(value), -MAX_SAFE_INTEGER, MAX_SAFE_INTEGER)\n        : (value === 0 ? value : 0);\n    }\n\n    /**\n     * Converts `value` to a string. An empty string is returned for `null`\n     * and `undefined` values. The sign of `-0` is preserved.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {string} Returns the converted string.\n     * @example\n     *\n     * _.toString(null);\n     * // => ''\n     *\n     * _.toString(-0);\n     * // => '-0'\n     *\n     * _.toString([1, 2, 3]);\n     * // => '1,2,3'\n     */\n    function toString(value) {\n      return value == null ? '' : baseToString(value);\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Assigns own enumerable string keyed properties of source objects to the\n     * destination object. Source objects are applied from left to right.\n     * Subsequent sources overwrite property assignments of previous sources.\n     *\n     * **Note:** This method mutates `object` and is loosely based on\n     * [`Object.assign`](https://mdn.io/Object/assign).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.10.0\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} [sources] The source objects.\n     * @returns {Object} Returns `object`.\n     * @see _.assignIn\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     * }\n     *\n     * function Bar() {\n     *   this.c = 3;\n     * }\n     *\n     * Foo.prototype.b = 2;\n     * Bar.prototype.d = 4;\n     *\n     * _.assign({ 'a': 0 }, new Foo, new Bar);\n     * // => { 'a': 1, 'c': 3 }\n     */\n    var assign = createAssigner(function(object, source) {\n      if (isPrototype(source) || isArrayLike(source)) {\n        copyObject(source, keys(source), object);\n        return;\n      }\n      for (var key in source) {\n        if (hasOwnProperty.call(source, key)) {\n          assignValue(object, key, source[key]);\n        }\n      }\n    });\n\n    /**\n     * This method is like `_.assign` except that it iterates over own and\n     * inherited source properties.\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @alias extend\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} [sources] The source objects.\n     * @returns {Object} Returns `object`.\n     * @see _.assign\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     * }\n     *\n     * function Bar() {\n     *   this.c = 3;\n     * }\n     *\n     * Foo.prototype.b = 2;\n     * Bar.prototype.d = 4;\n     *\n     * _.assignIn({ 'a': 0 }, new Foo, new Bar);\n     * // => { 'a': 1, 'b': 2, 'c': 3, 'd': 4 }\n     */\n    var assignIn = createAssigner(function(object, source) {\n      copyObject(source, keysIn(source), object);\n    });\n\n    /**\n     * This method is like `_.assignIn` except that it accepts `customizer`\n     * which is invoked to produce the assigned values. If `customizer` returns\n     * `undefined`, assignment is handled by the method instead. The `customizer`\n     * is invoked with five arguments: (objValue, srcValue, key, object, source).\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @alias extendWith\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} sources The source objects.\n     * @param {Function} [customizer] The function to customize assigned values.\n     * @returns {Object} Returns `object`.\n     * @see _.assignWith\n     * @example\n     *\n     * function customizer(objValue, srcValue) {\n     *   return _.isUndefined(objValue) ? srcValue : objValue;\n     * }\n     *\n     * var defaults = _.partialRight(_.assignInWith, customizer);\n     *\n     * defaults({ 'a': 1 }, { 'b': 2 }, { 'a': 3 });\n     * // => { 'a': 1, 'b': 2 }\n     */\n    var assignInWith = createAssigner(function(object, source, srcIndex, customizer) {\n      copyObject(source, keysIn(source), object, customizer);\n    });\n\n    /**\n     * This method is like `_.assign` except that it accepts `customizer`\n     * which is invoked to produce the assigned values. If `customizer` returns\n     * `undefined`, assignment is handled by the method instead. The `customizer`\n     * is invoked with five arguments: (objValue, srcValue, key, object, source).\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} sources The source objects.\n     * @param {Function} [customizer] The function to customize assigned values.\n     * @returns {Object} Returns `object`.\n     * @see _.assignInWith\n     * @example\n     *\n     * function customizer(objValue, srcValue) {\n     *   return _.isUndefined(objValue) ? srcValue : objValue;\n     * }\n     *\n     * var defaults = _.partialRight(_.assignWith, customizer);\n     *\n     * defaults({ 'a': 1 }, { 'b': 2 }, { 'a': 3 });\n     * // => { 'a': 1, 'b': 2 }\n     */\n    var assignWith = createAssigner(function(object, source, srcIndex, customizer) {\n      copyObject(source, keys(source), object, customizer);\n    });\n\n    /**\n     * Creates an array of values corresponding to `paths` of `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.0.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {...(string|string[])} [paths] The property paths to pick.\n     * @returns {Array} Returns the picked values.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': 3 } }, 4] };\n     *\n     * _.at(object, ['a[0].b.c', 'a[1]']);\n     * // => [3, 4]\n     */\n    var at = flatRest(baseAt);\n\n    /**\n     * Creates an object that inherits from the `prototype` object. If a\n     * `properties` object is given, its own enumerable string keyed properties\n     * are assigned to the created object.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.3.0\n     * @category Object\n     * @param {Object} prototype The object to inherit from.\n     * @param {Object} [properties] The properties to assign to the object.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * function Shape() {\n     *   this.x = 0;\n     *   this.y = 0;\n     * }\n     *\n     * function Circle() {\n     *   Shape.call(this);\n     * }\n     *\n     * Circle.prototype = _.create(Shape.prototype, {\n     *   'constructor': Circle\n     * });\n     *\n     * var circle = new Circle;\n     * circle instanceof Circle;\n     * // => true\n     *\n     * circle instanceof Shape;\n     * // => true\n     */\n    function create(prototype, properties) {\n      var result = baseCreate(prototype);\n      return properties == null ? result : baseAssign(result, properties);\n    }\n\n    /**\n     * Assigns own and inherited enumerable string keyed properties of source\n     * objects to the destination object for all destination properties that\n     * resolve to `undefined`. Source objects are applied from left to right.\n     * Once a property is set, additional values of the same property are ignored.\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} [sources] The source objects.\n     * @returns {Object} Returns `object`.\n     * @see _.defaultsDeep\n     * @example\n     *\n     * _.defaults({ 'a': 1 }, { 'b': 2 }, { 'a': 3 });\n     * // => { 'a': 1, 'b': 2 }\n     */\n    var defaults = baseRest(function(object, sources) {\n      object = Object(object);\n\n      var index = -1;\n      var length = sources.length;\n      var guard = length > 2 ? sources[2] : undefined;\n\n      if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n        length = 1;\n      }\n\n      while (++index < length) {\n        var source = sources[index];\n        var props = keysIn(source);\n        var propsIndex = -1;\n        var propsLength = props.length;\n\n        while (++propsIndex < propsLength) {\n          var key = props[propsIndex];\n          var value = object[key];\n\n          if (value === undefined ||\n              (eq(value, objectProto[key]) && !hasOwnProperty.call(object, key))) {\n            object[key] = source[key];\n          }\n        }\n      }\n\n      return object;\n    });\n\n    /**\n     * This method is like `_.defaults` except that it recursively assigns\n     * default properties.\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.10.0\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} [sources] The source objects.\n     * @returns {Object} Returns `object`.\n     * @see _.defaults\n     * @example\n     *\n     * _.defaultsDeep({ 'a': { 'b': 2 } }, { 'a': { 'b': 1, 'c': 3 } });\n     * // => { 'a': { 'b': 2, 'c': 3 } }\n     */\n    var defaultsDeep = baseRest(function(args) {\n      args.push(undefined, customDefaultsMerge);\n      return apply(mergeWith, undefined, args);\n    });\n\n    /**\n     * This method is like `_.find` except that it returns the key of the first\n     * element `predicate` returns truthy for instead of the element itself.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.1.0\n     * @category Object\n     * @param {Object} object The object to inspect.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {string|undefined} Returns the key of the matched element,\n     *  else `undefined`.\n     * @example\n     *\n     * var users = {\n     *   'barney':  { 'age': 36, 'active': true },\n     *   'fred':    { 'age': 40, 'active': false },\n     *   'pebbles': { 'age': 1,  'active': true }\n     * };\n     *\n     * _.findKey(users, function(o) { return o.age < 40; });\n     * // => 'barney' (iteration order is not guaranteed)\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.findKey(users, { 'age': 1, 'active': true });\n     * // => 'pebbles'\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.findKey(users, ['active', false]);\n     * // => 'fred'\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.findKey(users, 'active');\n     * // => 'barney'\n     */\n    function findKey(object, predicate) {\n      return baseFindKey(object, getIteratee(predicate, 3), baseForOwn);\n    }\n\n    /**\n     * This method is like `_.findKey` except that it iterates over elements of\n     * a collection in the opposite order.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Object\n     * @param {Object} object The object to inspect.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {string|undefined} Returns the key of the matched element,\n     *  else `undefined`.\n     * @example\n     *\n     * var users = {\n     *   'barney':  { 'age': 36, 'active': true },\n     *   'fred':    { 'age': 40, 'active': false },\n     *   'pebbles': { 'age': 1,  'active': true }\n     * };\n     *\n     * _.findLastKey(users, function(o) { return o.age < 40; });\n     * // => returns 'pebbles' assuming `_.findKey` returns 'barney'\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.findLastKey(users, { 'age': 36, 'active': true });\n     * // => 'barney'\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.findLastKey(users, ['active', false]);\n     * // => 'fred'\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.findLastKey(users, 'active');\n     * // => 'pebbles'\n     */\n    function findLastKey(object, predicate) {\n      return baseFindKey(object, getIteratee(predicate, 3), baseForOwnRight);\n    }\n\n    /**\n     * Iterates over own and inherited enumerable string keyed properties of an\n     * object and invokes `iteratee` for each property. The iteratee is invoked\n     * with three arguments: (value, key, object). Iteratee functions may exit\n     * iteration early by explicitly returning `false`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.3.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Object} Returns `object`.\n     * @see _.forInRight\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.forIn(new Foo, function(value, key) {\n     *   console.log(key);\n     * });\n     * // => Logs 'a', 'b', then 'c' (iteration order is not guaranteed).\n     */\n    function forIn(object, iteratee) {\n      return object == null\n        ? object\n        : baseFor(object, getIteratee(iteratee, 3), keysIn);\n    }\n\n    /**\n     * This method is like `_.forIn` except that it iterates over properties of\n     * `object` in the opposite order.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Object} Returns `object`.\n     * @see _.forIn\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.forInRight(new Foo, function(value, key) {\n     *   console.log(key);\n     * });\n     * // => Logs 'c', 'b', then 'a' assuming `_.forIn` logs 'a', 'b', then 'c'.\n     */\n    function forInRight(object, iteratee) {\n      return object == null\n        ? object\n        : baseForRight(object, getIteratee(iteratee, 3), keysIn);\n    }\n\n    /**\n     * Iterates over own enumerable string keyed properties of an object and\n     * invokes `iteratee` for each property. The iteratee is invoked with three\n     * arguments: (value, key, object). Iteratee functions may exit iteration\n     * early by explicitly returning `false`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.3.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Object} Returns `object`.\n     * @see _.forOwnRight\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.forOwn(new Foo, function(value, key) {\n     *   console.log(key);\n     * });\n     * // => Logs 'a' then 'b' (iteration order is not guaranteed).\n     */\n    function forOwn(object, iteratee) {\n      return object && baseForOwn(object, getIteratee(iteratee, 3));\n    }\n\n    /**\n     * This method is like `_.forOwn` except that it iterates over properties of\n     * `object` in the opposite order.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Object} Returns `object`.\n     * @see _.forOwn\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.forOwnRight(new Foo, function(value, key) {\n     *   console.log(key);\n     * });\n     * // => Logs 'b' then 'a' assuming `_.forOwn` logs 'a' then 'b'.\n     */\n    function forOwnRight(object, iteratee) {\n      return object && baseForOwnRight(object, getIteratee(iteratee, 3));\n    }\n\n    /**\n     * Creates an array of function property names from own enumerable properties\n     * of `object`.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The object to inspect.\n     * @returns {Array} Returns the function names.\n     * @see _.functionsIn\n     * @example\n     *\n     * function Foo() {\n     *   this.a = _.constant('a');\n     *   this.b = _.constant('b');\n     * }\n     *\n     * Foo.prototype.c = _.constant('c');\n     *\n     * _.functions(new Foo);\n     * // => ['a', 'b']\n     */\n    function functions(object) {\n      return object == null ? [] : baseFunctions(object, keys(object));\n    }\n\n    /**\n     * Creates an array of function property names from own and inherited\n     * enumerable properties of `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The object to inspect.\n     * @returns {Array} Returns the function names.\n     * @see _.functions\n     * @example\n     *\n     * function Foo() {\n     *   this.a = _.constant('a');\n     *   this.b = _.constant('b');\n     * }\n     *\n     * Foo.prototype.c = _.constant('c');\n     *\n     * _.functionsIn(new Foo);\n     * // => ['a', 'b', 'c']\n     */\n    function functionsIn(object) {\n      return object == null ? [] : baseFunctions(object, keysIn(object));\n    }\n\n    /**\n     * Gets the value at `path` of `object`. If the resolved value is\n     * `undefined`, the `defaultValue` is returned in its place.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.7.0\n     * @category Object\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path of the property to get.\n     * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n     * @returns {*} Returns the resolved value.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n     *\n     * _.get(object, 'a[0].b.c');\n     * // => 3\n     *\n     * _.get(object, ['a', '0', 'b', 'c']);\n     * // => 3\n     *\n     * _.get(object, 'a.b.c', 'default');\n     * // => 'default'\n     */\n    function get(object, path, defaultValue) {\n      var result = object == null ? undefined : baseGet(object, path);\n      return result === undefined ? defaultValue : result;\n    }\n\n    /**\n     * Checks if `path` is a direct property of `object`.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path to check.\n     * @returns {boolean} Returns `true` if `path` exists, else `false`.\n     * @example\n     *\n     * var object = { 'a': { 'b': 2 } };\n     * var other = _.create({ 'a': _.create({ 'b': 2 }) });\n     *\n     * _.has(object, 'a');\n     * // => true\n     *\n     * _.has(object, 'a.b');\n     * // => true\n     *\n     * _.has(object, ['a', 'b']);\n     * // => true\n     *\n     * _.has(other, 'a');\n     * // => false\n     */\n    function has(object, path) {\n      return object != null && hasPath(object, path, baseHas);\n    }\n\n    /**\n     * Checks if `path` is a direct or inherited property of `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path to check.\n     * @returns {boolean} Returns `true` if `path` exists, else `false`.\n     * @example\n     *\n     * var object = _.create({ 'a': _.create({ 'b': 2 }) });\n     *\n     * _.hasIn(object, 'a');\n     * // => true\n     *\n     * _.hasIn(object, 'a.b');\n     * // => true\n     *\n     * _.hasIn(object, ['a', 'b']);\n     * // => true\n     *\n     * _.hasIn(object, 'b');\n     * // => false\n     */\n    function hasIn(object, path) {\n      return object != null && hasPath(object, path, baseHasIn);\n    }\n\n    /**\n     * Creates an object composed of the inverted keys and values of `object`.\n     * If `object` contains duplicate values, subsequent values overwrite\n     * property assignments of previous values.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.7.0\n     * @category Object\n     * @param {Object} object The object to invert.\n     * @returns {Object} Returns the new inverted object.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': 2, 'c': 1 };\n     *\n     * _.invert(object);\n     * // => { '1': 'c', '2': 'b' }\n     */\n    var invert = createInverter(function(result, value, key) {\n      if (value != null &&\n          typeof value.toString != 'function') {\n        value = nativeObjectToString.call(value);\n      }\n\n      result[value] = key;\n    }, constant(identity));\n\n    /**\n     * This method is like `_.invert` except that the inverted object is generated\n     * from the results of running each element of `object` thru `iteratee`. The\n     * corresponding inverted value of each inverted key is an array of keys\n     * responsible for generating the inverted value. The iteratee is invoked\n     * with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.1.0\n     * @category Object\n     * @param {Object} object The object to invert.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Object} Returns the new inverted object.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': 2, 'c': 1 };\n     *\n     * _.invertBy(object);\n     * // => { '1': ['a', 'c'], '2': ['b'] }\n     *\n     * _.invertBy(object, function(value) {\n     *   return 'group' + value;\n     * });\n     * // => { 'group1': ['a', 'c'], 'group2': ['b'] }\n     */\n    var invertBy = createInverter(function(result, value, key) {\n      if (value != null &&\n          typeof value.toString != 'function') {\n        value = nativeObjectToString.call(value);\n      }\n\n      if (hasOwnProperty.call(result, value)) {\n        result[value].push(key);\n      } else {\n        result[value] = [key];\n      }\n    }, getIteratee);\n\n    /**\n     * Invokes the method at `path` of `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path of the method to invoke.\n     * @param {...*} [args] The arguments to invoke the method with.\n     * @returns {*} Returns the result of the invoked method.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': [1, 2, 3, 4] } }] };\n     *\n     * _.invoke(object, 'a[0].b.c.slice', 1, 3);\n     * // => [2, 3]\n     */\n    var invoke = baseRest(baseInvoke);\n\n    /**\n     * Creates an array of the own enumerable property names of `object`.\n     *\n     * **Note:** Non-object values are coerced to objects. See the\n     * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n     * for more details.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.keys(new Foo);\n     * // => ['a', 'b'] (iteration order is not guaranteed)\n     *\n     * _.keys('hi');\n     * // => ['0', '1']\n     */\n    function keys(object) {\n      return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n    }\n\n    /**\n     * Creates an array of the own and inherited enumerable property names of `object`.\n     *\n     * **Note:** Non-object values are coerced to objects.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Object\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.keysIn(new Foo);\n     * // => ['a', 'b', 'c'] (iteration order is not guaranteed)\n     */\n    function keysIn(object) {\n      return isArrayLike(object) ? arrayLikeKeys(object, true) : baseKeysIn(object);\n    }\n\n    /**\n     * The opposite of `_.mapValues`; this method creates an object with the\n     * same values as `object` and keys generated by running each own enumerable\n     * string keyed property of `object` thru `iteratee`. The iteratee is invoked\n     * with three arguments: (value, key, object).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.8.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Object} Returns the new mapped object.\n     * @see _.mapValues\n     * @example\n     *\n     * _.mapKeys({ 'a': 1, 'b': 2 }, function(value, key) {\n     *   return key + value;\n     * });\n     * // => { 'a1': 1, 'b2': 2 }\n     */\n    function mapKeys(object, iteratee) {\n      var result = {};\n      iteratee = getIteratee(iteratee, 3);\n\n      baseForOwn(object, function(value, key, object) {\n        baseAssignValue(result, iteratee(value, key, object), value);\n      });\n      return result;\n    }\n\n    /**\n     * Creates an object with the same keys as `object` and values generated\n     * by running each own enumerable string keyed property of `object` thru\n     * `iteratee`. The iteratee is invoked with three arguments:\n     * (value, key, object).\n     *\n     * @static\n     * @memberOf _\n     * @since 2.4.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Object} Returns the new mapped object.\n     * @see _.mapKeys\n     * @example\n     *\n     * var users = {\n     *   'fred':    { 'user': 'fred',    'age': 40 },\n     *   'pebbles': { 'user': 'pebbles', 'age': 1 }\n     * };\n     *\n     * _.mapValues(users, function(o) { return o.age; });\n     * // => { 'fred': 40, 'pebbles': 1 } (iteration order is not guaranteed)\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.mapValues(users, 'age');\n     * // => { 'fred': 40, 'pebbles': 1 } (iteration order is not guaranteed)\n     */\n    function mapValues(object, iteratee) {\n      var result = {};\n      iteratee = getIteratee(iteratee, 3);\n\n      baseForOwn(object, function(value, key, object) {\n        baseAssignValue(result, key, iteratee(value, key, object));\n      });\n      return result;\n    }\n\n    /**\n     * This method is like `_.assign` except that it recursively merges own and\n     * inherited enumerable string keyed properties of source objects into the\n     * destination object. Source properties that resolve to `undefined` are\n     * skipped if a destination value exists. Array and plain object properties\n     * are merged recursively. Other objects and value types are overridden by\n     * assignment. Source objects are applied from left to right. Subsequent\n     * sources overwrite property assignments of previous sources.\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.5.0\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} [sources] The source objects.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var object = {\n     *   'a': [{ 'b': 2 }, { 'd': 4 }]\n     * };\n     *\n     * var other = {\n     *   'a': [{ 'c': 3 }, { 'e': 5 }]\n     * };\n     *\n     * _.merge(object, other);\n     * // => { 'a': [{ 'b': 2, 'c': 3 }, { 'd': 4, 'e': 5 }] }\n     */\n    var merge = createAssigner(function(object, source, srcIndex) {\n      baseMerge(object, source, srcIndex);\n    });\n\n    /**\n     * This method is like `_.merge` except that it accepts `customizer` which\n     * is invoked to produce the merged values of the destination and source\n     * properties. If `customizer` returns `undefined`, merging is handled by the\n     * method instead. The `customizer` is invoked with six arguments:\n     * (objValue, srcValue, key, object, source, stack).\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} sources The source objects.\n     * @param {Function} customizer The function to customize assigned values.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * function customizer(objValue, srcValue) {\n     *   if (_.isArray(objValue)) {\n     *     return objValue.concat(srcValue);\n     *   }\n     * }\n     *\n     * var object = { 'a': [1], 'b': [2] };\n     * var other = { 'a': [3], 'b': [4] };\n     *\n     * _.mergeWith(object, other, customizer);\n     * // => { 'a': [1, 3], 'b': [2, 4] }\n     */\n    var mergeWith = createAssigner(function(object, source, srcIndex, customizer) {\n      baseMerge(object, source, srcIndex, customizer);\n    });\n\n    /**\n     * The opposite of `_.pick`; this method creates an object composed of the\n     * own and inherited enumerable property paths of `object` that are not omitted.\n     *\n     * **Note:** This method is considerably slower than `_.pick`.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The source object.\n     * @param {...(string|string[])} [paths] The property paths to omit.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': '2', 'c': 3 };\n     *\n     * _.omit(object, ['a', 'c']);\n     * // => { 'b': '2' }\n     */\n    var omit = flatRest(function(object, paths) {\n      var result = {};\n      if (object == null) {\n        return result;\n      }\n      var isDeep = false;\n      paths = arrayMap(paths, function(path) {\n        path = castPath(path, object);\n        isDeep || (isDeep = path.length > 1);\n        return path;\n      });\n      copyObject(object, getAllKeysIn(object), result);\n      if (isDeep) {\n        result = baseClone(result, CLONE_DEEP_FLAG | CLONE_FLAT_FLAG | CLONE_SYMBOLS_FLAG, customOmitClone);\n      }\n      var length = paths.length;\n      while (length--) {\n        baseUnset(result, paths[length]);\n      }\n      return result;\n    });\n\n    /**\n     * The opposite of `_.pickBy`; this method creates an object composed of\n     * the own and inherited enumerable string keyed properties of `object` that\n     * `predicate` doesn't return truthy for. The predicate is invoked with two\n     * arguments: (value, key).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The source object.\n     * @param {Function} [predicate=_.identity] The function invoked per property.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': '2', 'c': 3 };\n     *\n     * _.omitBy(object, _.isNumber);\n     * // => { 'b': '2' }\n     */\n    function omitBy(object, predicate) {\n      return pickBy(object, negate(getIteratee(predicate)));\n    }\n\n    /**\n     * Creates an object composed of the picked `object` properties.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The source object.\n     * @param {...(string|string[])} [paths] The property paths to pick.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': '2', 'c': 3 };\n     *\n     * _.pick(object, ['a', 'c']);\n     * // => { 'a': 1, 'c': 3 }\n     */\n    var pick = flatRest(function(object, paths) {\n      return object == null ? {} : basePick(object, paths);\n    });\n\n    /**\n     * Creates an object composed of the `object` properties `predicate` returns\n     * truthy for. The predicate is invoked with two arguments: (value, key).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The source object.\n     * @param {Function} [predicate=_.identity] The function invoked per property.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': '2', 'c': 3 };\n     *\n     * _.pickBy(object, _.isNumber);\n     * // => { 'a': 1, 'c': 3 }\n     */\n    function pickBy(object, predicate) {\n      if (object == null) {\n        return {};\n      }\n      var props = arrayMap(getAllKeysIn(object), function(prop) {\n        return [prop];\n      });\n      predicate = getIteratee(predicate);\n      return basePickBy(object, props, function(value, path) {\n        return predicate(value, path[0]);\n      });\n    }\n\n    /**\n     * This method is like `_.get` except that if the resolved value is a\n     * function it's invoked with the `this` binding of its parent object and\n     * its result is returned.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path of the property to resolve.\n     * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n     * @returns {*} Returns the resolved value.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c1': 3, 'c2': _.constant(4) } }] };\n     *\n     * _.result(object, 'a[0].b.c1');\n     * // => 3\n     *\n     * _.result(object, 'a[0].b.c2');\n     * // => 4\n     *\n     * _.result(object, 'a[0].b.c3', 'default');\n     * // => 'default'\n     *\n     * _.result(object, 'a[0].b.c3', _.constant('default'));\n     * // => 'default'\n     */\n    function result(object, path, defaultValue) {\n      path = castPath(path, object);\n\n      var index = -1,\n          length = path.length;\n\n      // Ensure the loop is entered when path is empty.\n      if (!length) {\n        length = 1;\n        object = undefined;\n      }\n      while (++index < length) {\n        var value = object == null ? undefined : object[toKey(path[index])];\n        if (value === undefined) {\n          index = length;\n          value = defaultValue;\n        }\n        object = isFunction(value) ? value.call(object) : value;\n      }\n      return object;\n    }\n\n    /**\n     * Sets the value at `path` of `object`. If a portion of `path` doesn't exist,\n     * it's created. Arrays are created for missing index properties while objects\n     * are created for all other missing properties. Use `_.setWith` to customize\n     * `path` creation.\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.7.0\n     * @category Object\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to set.\n     * @param {*} value The value to set.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n     *\n     * _.set(object, 'a[0].b.c', 4);\n     * console.log(object.a[0].b.c);\n     * // => 4\n     *\n     * _.set(object, ['x', '0', 'y', 'z'], 5);\n     * console.log(object.x[0].y.z);\n     * // => 5\n     */\n    function set(object, path, value) {\n      return object == null ? object : baseSet(object, path, value);\n    }\n\n    /**\n     * This method is like `_.set` except that it accepts `customizer` which is\n     * invoked to produce the objects of `path`.  If `customizer` returns `undefined`\n     * path creation is handled by the method instead. The `customizer` is invoked\n     * with three arguments: (nsValue, key, nsObject).\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to set.\n     * @param {*} value The value to set.\n     * @param {Function} [customizer] The function to customize assigned values.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var object = {};\n     *\n     * _.setWith(object, '[0][1]', 'a', Object);\n     * // => { '0': { '1': 'a' } }\n     */\n    function setWith(object, path, value, customizer) {\n      customizer = typeof customizer == 'function' ? customizer : undefined;\n      return object == null ? object : baseSet(object, path, value, customizer);\n    }\n\n    /**\n     * Creates an array of own enumerable string keyed-value pairs for `object`\n     * which can be consumed by `_.fromPairs`. If `object` is a map or set, its\n     * entries are returned.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @alias entries\n     * @category Object\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the key-value pairs.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.toPairs(new Foo);\n     * // => [['a', 1], ['b', 2]] (iteration order is not guaranteed)\n     */\n    var toPairs = createToPairs(keys);\n\n    /**\n     * Creates an array of own and inherited enumerable string keyed-value pairs\n     * for `object` which can be consumed by `_.fromPairs`. If `object` is a map\n     * or set, its entries are returned.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @alias entriesIn\n     * @category Object\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the key-value pairs.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.toPairsIn(new Foo);\n     * // => [['a', 1], ['b', 2], ['c', 3]] (iteration order is not guaranteed)\n     */\n    var toPairsIn = createToPairs(keysIn);\n\n    /**\n     * An alternative to `_.reduce`; this method transforms `object` to a new\n     * `accumulator` object which is the result of running each of its own\n     * enumerable string keyed properties thru `iteratee`, with each invocation\n     * potentially mutating the `accumulator` object. If `accumulator` is not\n     * provided, a new object with the same `[[Prototype]]` will be used. The\n     * iteratee is invoked with four arguments: (accumulator, value, key, object).\n     * Iteratee functions may exit iteration early by explicitly returning `false`.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.3.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @param {*} [accumulator] The custom accumulator value.\n     * @returns {*} Returns the accumulated value.\n     * @example\n     *\n     * _.transform([2, 3, 4], function(result, n) {\n     *   result.push(n *= n);\n     *   return n % 2 == 0;\n     * }, []);\n     * // => [4, 9]\n     *\n     * _.transform({ 'a': 1, 'b': 2, 'c': 1 }, function(result, value, key) {\n     *   (result[value] || (result[value] = [])).push(key);\n     * }, {});\n     * // => { '1': ['a', 'c'], '2': ['b'] }\n     */\n    function transform(object, iteratee, accumulator) {\n      var isArr = isArray(object),\n          isArrLike = isArr || isBuffer(object) || isTypedArray(object);\n\n      iteratee = getIteratee(iteratee, 4);\n      if (accumulator == null) {\n        var Ctor = object && object.constructor;\n        if (isArrLike) {\n          accumulator = isArr ? new Ctor : [];\n        }\n        else if (isObject(object)) {\n          accumulator = isFunction(Ctor) ? baseCreate(getPrototype(object)) : {};\n        }\n        else {\n          accumulator = {};\n        }\n      }\n      (isArrLike ? arrayEach : baseForOwn)(object, function(value, index, object) {\n        return iteratee(accumulator, value, index, object);\n      });\n      return accumulator;\n    }\n\n    /**\n     * Removes the property at `path` of `object`.\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to unset.\n     * @returns {boolean} Returns `true` if the property is deleted, else `false`.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': 7 } }] };\n     * _.unset(object, 'a[0].b.c');\n     * // => true\n     *\n     * console.log(object);\n     * // => { 'a': [{ 'b': {} }] };\n     *\n     * _.unset(object, ['a', '0', 'b', 'c']);\n     * // => true\n     *\n     * console.log(object);\n     * // => { 'a': [{ 'b': {} }] };\n     */\n    function unset(object, path) {\n      return object == null ? true : baseUnset(object, path);\n    }\n\n    /**\n     * This method is like `_.set` except that accepts `updater` to produce the\n     * value to set. Use `_.updateWith` to customize `path` creation. The `updater`\n     * is invoked with one argument: (value).\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.6.0\n     * @category Object\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to set.\n     * @param {Function} updater The function to produce the updated value.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n     *\n     * _.update(object, 'a[0].b.c', function(n) { return n * n; });\n     * console.log(object.a[0].b.c);\n     * // => 9\n     *\n     * _.update(object, 'x[0].y.z', function(n) { return n ? n + 1 : 0; });\n     * console.log(object.x[0].y.z);\n     * // => 0\n     */\n    function update(object, path, updater) {\n      return object == null ? object : baseUpdate(object, path, castFunction(updater));\n    }\n\n    /**\n     * This method is like `_.update` except that it accepts `customizer` which is\n     * invoked to produce the objects of `path`.  If `customizer` returns `undefined`\n     * path creation is handled by the method instead. The `customizer` is invoked\n     * with three arguments: (nsValue, key, nsObject).\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.6.0\n     * @category Object\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to set.\n     * @param {Function} updater The function to produce the updated value.\n     * @param {Function} [customizer] The function to customize assigned values.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var object = {};\n     *\n     * _.updateWith(object, '[0][1]', _.constant('a'), Object);\n     * // => { '0': { '1': 'a' } }\n     */\n    function updateWith(object, path, updater, customizer) {\n      customizer = typeof customizer == 'function' ? customizer : undefined;\n      return object == null ? object : baseUpdate(object, path, castFunction(updater), customizer);\n    }\n\n    /**\n     * Creates an array of the own enumerable string keyed property values of `object`.\n     *\n     * **Note:** Non-object values are coerced to objects.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property values.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.values(new Foo);\n     * // => [1, 2] (iteration order is not guaranteed)\n     *\n     * _.values('hi');\n     * // => ['h', 'i']\n     */\n    function values(object) {\n      return object == null ? [] : baseValues(object, keys(object));\n    }\n\n    /**\n     * Creates an array of the own and inherited enumerable string keyed property\n     * values of `object`.\n     *\n     * **Note:** Non-object values are coerced to objects.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Object\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property values.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.valuesIn(new Foo);\n     * // => [1, 2, 3] (iteration order is not guaranteed)\n     */\n    function valuesIn(object) {\n      return object == null ? [] : baseValues(object, keysIn(object));\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Clamps `number` within the inclusive `lower` and `upper` bounds.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Number\n     * @param {number} number The number to clamp.\n     * @param {number} [lower] The lower bound.\n     * @param {number} upper The upper bound.\n     * @returns {number} Returns the clamped number.\n     * @example\n     *\n     * _.clamp(-10, -5, 5);\n     * // => -5\n     *\n     * _.clamp(10, -5, 5);\n     * // => 5\n     */\n    function clamp(number, lower, upper) {\n      if (upper === undefined) {\n        upper = lower;\n        lower = undefined;\n      }\n      if (upper !== undefined) {\n        upper = toNumber(upper);\n        upper = upper === upper ? upper : 0;\n      }\n      if (lower !== undefined) {\n        lower = toNumber(lower);\n        lower = lower === lower ? lower : 0;\n      }\n      return baseClamp(toNumber(number), lower, upper);\n    }\n\n    /**\n     * Checks if `n` is between `start` and up to, but not including, `end`. If\n     * `end` is not specified, it's set to `start` with `start` then set to `0`.\n     * If `start` is greater than `end` the params are swapped to support\n     * negative ranges.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.3.0\n     * @category Number\n     * @param {number} number The number to check.\n     * @param {number} [start=0] The start of the range.\n     * @param {number} end The end of the range.\n     * @returns {boolean} Returns `true` if `number` is in the range, else `false`.\n     * @see _.range, _.rangeRight\n     * @example\n     *\n     * _.inRange(3, 2, 4);\n     * // => true\n     *\n     * _.inRange(4, 8);\n     * // => true\n     *\n     * _.inRange(4, 2);\n     * // => false\n     *\n     * _.inRange(2, 2);\n     * // => false\n     *\n     * _.inRange(1.2, 2);\n     * // => true\n     *\n     * _.inRange(5.2, 4);\n     * // => false\n     *\n     * _.inRange(-3, -2, -6);\n     * // => true\n     */\n    function inRange(number, start, end) {\n      start = toFinite(start);\n      if (end === undefined) {\n        end = start;\n        start = 0;\n      } else {\n        end = toFinite(end);\n      }\n      number = toNumber(number);\n      return baseInRange(number, start, end);\n    }\n\n    /**\n     * Produces a random number between the inclusive `lower` and `upper` bounds.\n     * If only one argument is provided a number between `0` and the given number\n     * is returned. If `floating` is `true`, or either `lower` or `upper` are\n     * floats, a floating-point number is returned instead of an integer.\n     *\n     * **Note:** JavaScript follows the IEEE-754 standard for resolving\n     * floating-point values which can produce unexpected results.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.7.0\n     * @category Number\n     * @param {number} [lower=0] The lower bound.\n     * @param {number} [upper=1] The upper bound.\n     * @param {boolean} [floating] Specify returning a floating-point number.\n     * @returns {number} Returns the random number.\n     * @example\n     *\n     * _.random(0, 5);\n     * // => an integer between 0 and 5\n     *\n     * _.random(5);\n     * // => also an integer between 0 and 5\n     *\n     * _.random(5, true);\n     * // => a floating-point number between 0 and 5\n     *\n     * _.random(1.2, 5.2);\n     * // => a floating-point number between 1.2 and 5.2\n     */\n    function random(lower, upper, floating) {\n      if (floating && typeof floating != 'boolean' && isIterateeCall(lower, upper, floating)) {\n        upper = floating = undefined;\n      }\n      if (floating === undefined) {\n        if (typeof upper == 'boolean') {\n          floating = upper;\n          upper = undefined;\n        }\n        else if (typeof lower == 'boolean') {\n          floating = lower;\n          lower = undefined;\n        }\n      }\n      if (lower === undefined && upper === undefined) {\n        lower = 0;\n        upper = 1;\n      }\n      else {\n        lower = toFinite(lower);\n        if (upper === undefined) {\n          upper = lower;\n          lower = 0;\n        } else {\n          upper = toFinite(upper);\n        }\n      }\n      if (lower > upper) {\n        var temp = lower;\n        lower = upper;\n        upper = temp;\n      }\n      if (floating || lower % 1 || upper % 1) {\n        var rand = nativeRandom();\n        return nativeMin(lower + (rand * (upper - lower + freeParseFloat('1e-' + ((rand + '').length - 1)))), upper);\n      }\n      return baseRandom(lower, upper);\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Converts `string` to [camel case](https://en.wikipedia.org/wiki/CamelCase).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the camel cased string.\n     * @example\n     *\n     * _.camelCase('Foo Bar');\n     * // => 'fooBar'\n     *\n     * _.camelCase('--foo-bar--');\n     * // => 'fooBar'\n     *\n     * _.camelCase('__FOO_BAR__');\n     * // => 'fooBar'\n     */\n    var camelCase = createCompounder(function(result, word, index) {\n      word = word.toLowerCase();\n      return result + (index ? capitalize(word) : word);\n    });\n\n    /**\n     * Converts the first character of `string` to upper case and the remaining\n     * to lower case.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to capitalize.\n     * @returns {string} Returns the capitalized string.\n     * @example\n     *\n     * _.capitalize('FRED');\n     * // => 'Fred'\n     */\n    function capitalize(string) {\n      return upperFirst(toString(string).toLowerCase());\n    }\n\n    /**\n     * Deburrs `string` by converting\n     * [Latin-1 Supplement](https://en.wikipedia.org/wiki/Latin-1_Supplement_(Unicode_block)#Character_table)\n     * and [Latin Extended-A](https://en.wikipedia.org/wiki/Latin_Extended-A)\n     * letters to basic Latin letters and removing\n     * [combining diacritical marks](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to deburr.\n     * @returns {string} Returns the deburred string.\n     * @example\n     *\n     * _.deburr('déjà vu');\n     * // => 'deja vu'\n     */\n    function deburr(string) {\n      string = toString(string);\n      return string && string.replace(reLatin, deburrLetter).replace(reComboMark, '');\n    }\n\n    /**\n     * Checks if `string` ends with the given target string.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to inspect.\n     * @param {string} [target] The string to search for.\n     * @param {number} [position=string.length] The position to search up to.\n     * @returns {boolean} Returns `true` if `string` ends with `target`,\n     *  else `false`.\n     * @example\n     *\n     * _.endsWith('abc', 'c');\n     * // => true\n     *\n     * _.endsWith('abc', 'b');\n     * // => false\n     *\n     * _.endsWith('abc', 'b', 2);\n     * // => true\n     */\n    function endsWith(string, target, position) {\n      string = toString(string);\n      target = baseToString(target);\n\n      var length = string.length;\n      position = position === undefined\n        ? length\n        : baseClamp(toInteger(position), 0, length);\n\n      var end = position;\n      position -= target.length;\n      return position >= 0 && string.slice(position, end) == target;\n    }\n\n    /**\n     * Converts the characters \"&\", \"<\", \">\", '\"', and \"'\" in `string` to their\n     * corresponding HTML entities.\n     *\n     * **Note:** No other characters are escaped. To escape additional\n     * characters use a third-party library like [_he_](https://mths.be/he).\n     *\n     * Though the \">\" character is escaped for symmetry, characters like\n     * \">\" and \"/\" don't need escaping in HTML and have no special meaning\n     * unless they're part of a tag or unquoted attribute value. See\n     * [Mathias Bynens's article](https://mathiasbynens.be/notes/ambiguous-ampersands)\n     * (under \"semi-related fun fact\") for more details.\n     *\n     * When working with HTML you should always\n     * [quote attribute values](http://wonko.com/post/html-escaping) to reduce\n     * XSS vectors.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category String\n     * @param {string} [string=''] The string to escape.\n     * @returns {string} Returns the escaped string.\n     * @example\n     *\n     * _.escape('fred, barney, & pebbles');\n     * // => 'fred, barney, &amp; pebbles'\n     */\n    function escape(string) {\n      string = toString(string);\n      return (string && reHasUnescapedHtml.test(string))\n        ? string.replace(reUnescapedHtml, escapeHtmlChar)\n        : string;\n    }\n\n    /**\n     * Escapes the `RegExp` special characters \"^\", \"$\", \"\\\", \".\", \"*\", \"+\",\n     * \"?\", \"(\", \")\", \"[\", \"]\", \"{\", \"}\", and \"|\" in `string`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to escape.\n     * @returns {string} Returns the escaped string.\n     * @example\n     *\n     * _.escapeRegExp('[lodash](https://lodash.com/)');\n     * // => '\\[lodash\\]\\(https://lodash\\.com/\\)'\n     */\n    function escapeRegExp(string) {\n      string = toString(string);\n      return (string && reHasRegExpChar.test(string))\n        ? string.replace(reRegExpChar, '\\\\$&')\n        : string;\n    }\n\n    /**\n     * Converts `string` to\n     * [kebab case](https://en.wikipedia.org/wiki/Letter_case#Special_case_styles).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the kebab cased string.\n     * @example\n     *\n     * _.kebabCase('Foo Bar');\n     * // => 'foo-bar'\n     *\n     * _.kebabCase('fooBar');\n     * // => 'foo-bar'\n     *\n     * _.kebabCase('__FOO_BAR__');\n     * // => 'foo-bar'\n     */\n    var kebabCase = createCompounder(function(result, word, index) {\n      return result + (index ? '-' : '') + word.toLowerCase();\n    });\n\n    /**\n     * Converts `string`, as space separated words, to lower case.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the lower cased string.\n     * @example\n     *\n     * _.lowerCase('--Foo-Bar--');\n     * // => 'foo bar'\n     *\n     * _.lowerCase('fooBar');\n     * // => 'foo bar'\n     *\n     * _.lowerCase('__FOO_BAR__');\n     * // => 'foo bar'\n     */\n    var lowerCase = createCompounder(function(result, word, index) {\n      return result + (index ? ' ' : '') + word.toLowerCase();\n    });\n\n    /**\n     * Converts the first character of `string` to lower case.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the converted string.\n     * @example\n     *\n     * _.lowerFirst('Fred');\n     * // => 'fred'\n     *\n     * _.lowerFirst('FRED');\n     * // => 'fRED'\n     */\n    var lowerFirst = createCaseFirst('toLowerCase');\n\n    /**\n     * Pads `string` on the left and right sides if it's shorter than `length`.\n     * Padding characters are truncated if they can't be evenly divided by `length`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to pad.\n     * @param {number} [length=0] The padding length.\n     * @param {string} [chars=' '] The string used as padding.\n     * @returns {string} Returns the padded string.\n     * @example\n     *\n     * _.pad('abc', 8);\n     * // => '  abc   '\n     *\n     * _.pad('abc', 8, '_-');\n     * // => '_-abc_-_'\n     *\n     * _.pad('abc', 3);\n     * // => 'abc'\n     */\n    function pad(string, length, chars) {\n      string = toString(string);\n      length = toInteger(length);\n\n      var strLength = length ? stringSize(string) : 0;\n      if (!length || strLength >= length) {\n        return string;\n      }\n      var mid = (length - strLength) / 2;\n      return (\n        createPadding(nativeFloor(mid), chars) +\n        string +\n        createPadding(nativeCeil(mid), chars)\n      );\n    }\n\n    /**\n     * Pads `string` on the right side if it's shorter than `length`. Padding\n     * characters are truncated if they exceed `length`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to pad.\n     * @param {number} [length=0] The padding length.\n     * @param {string} [chars=' '] The string used as padding.\n     * @returns {string} Returns the padded string.\n     * @example\n     *\n     * _.padEnd('abc', 6);\n     * // => 'abc   '\n     *\n     * _.padEnd('abc', 6, '_-');\n     * // => 'abc_-_'\n     *\n     * _.padEnd('abc', 3);\n     * // => 'abc'\n     */\n    function padEnd(string, length, chars) {\n      string = toString(string);\n      length = toInteger(length);\n\n      var strLength = length ? stringSize(string) : 0;\n      return (length && strLength < length)\n        ? (string + createPadding(length - strLength, chars))\n        : string;\n    }\n\n    /**\n     * Pads `string` on the left side if it's shorter than `length`. Padding\n     * characters are truncated if they exceed `length`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to pad.\n     * @param {number} [length=0] The padding length.\n     * @param {string} [chars=' '] The string used as padding.\n     * @returns {string} Returns the padded string.\n     * @example\n     *\n     * _.padStart('abc', 6);\n     * // => '   abc'\n     *\n     * _.padStart('abc', 6, '_-');\n     * // => '_-_abc'\n     *\n     * _.padStart('abc', 3);\n     * // => 'abc'\n     */\n    function padStart(string, length, chars) {\n      string = toString(string);\n      length = toInteger(length);\n\n      var strLength = length ? stringSize(string) : 0;\n      return (length && strLength < length)\n        ? (createPadding(length - strLength, chars) + string)\n        : string;\n    }\n\n    /**\n     * Converts `string` to an integer of the specified radix. If `radix` is\n     * `undefined` or `0`, a `radix` of `10` is used unless `value` is a\n     * hexadecimal, in which case a `radix` of `16` is used.\n     *\n     * **Note:** This method aligns with the\n     * [ES5 implementation](https://es5.github.io/#x15.1.2.2) of `parseInt`.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.1.0\n     * @category String\n     * @param {string} string The string to convert.\n     * @param {number} [radix=10] The radix to interpret `value` by.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {number} Returns the converted integer.\n     * @example\n     *\n     * _.parseInt('08');\n     * // => 8\n     *\n     * _.map(['6', '08', '10'], _.parseInt);\n     * // => [6, 8, 10]\n     */\n    function parseInt(string, radix, guard) {\n      if (guard || radix == null) {\n        radix = 0;\n      } else if (radix) {\n        radix = +radix;\n      }\n      return nativeParseInt(toString(string).replace(reTrimStart, ''), radix || 0);\n    }\n\n    /**\n     * Repeats the given string `n` times.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to repeat.\n     * @param {number} [n=1] The number of times to repeat the string.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {string} Returns the repeated string.\n     * @example\n     *\n     * _.repeat('*', 3);\n     * // => '***'\n     *\n     * _.repeat('abc', 2);\n     * // => 'abcabc'\n     *\n     * _.repeat('abc', 0);\n     * // => ''\n     */\n    function repeat(string, n, guard) {\n      if ((guard ? isIterateeCall(string, n, guard) : n === undefined)) {\n        n = 1;\n      } else {\n        n = toInteger(n);\n      }\n      return baseRepeat(toString(string), n);\n    }\n\n    /**\n     * Replaces matches for `pattern` in `string` with `replacement`.\n     *\n     * **Note:** This method is based on\n     * [`String#replace`](https://mdn.io/String/replace).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to modify.\n     * @param {RegExp|string} pattern The pattern to replace.\n     * @param {Function|string} replacement The match replacement.\n     * @returns {string} Returns the modified string.\n     * @example\n     *\n     * _.replace('Hi Fred', 'Fred', 'Barney');\n     * // => 'Hi Barney'\n     */\n    function replace() {\n      var args = arguments,\n          string = toString(args[0]);\n\n      return args.length < 3 ? string : string.replace(args[1], args[2]);\n    }\n\n    /**\n     * Converts `string` to\n     * [snake case](https://en.wikipedia.org/wiki/Snake_case).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the snake cased string.\n     * @example\n     *\n     * _.snakeCase('Foo Bar');\n     * // => 'foo_bar'\n     *\n     * _.snakeCase('fooBar');\n     * // => 'foo_bar'\n     *\n     * _.snakeCase('--FOO-BAR--');\n     * // => 'foo_bar'\n     */\n    var snakeCase = createCompounder(function(result, word, index) {\n      return result + (index ? '_' : '') + word.toLowerCase();\n    });\n\n    /**\n     * Splits `string` by `separator`.\n     *\n     * **Note:** This method is based on\n     * [`String#split`](https://mdn.io/String/split).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to split.\n     * @param {RegExp|string} separator The separator pattern to split by.\n     * @param {number} [limit] The length to truncate results to.\n     * @returns {Array} Returns the string segments.\n     * @example\n     *\n     * _.split('a-b-c', '-', 2);\n     * // => ['a', 'b']\n     */\n    function split(string, separator, limit) {\n      if (limit && typeof limit != 'number' && isIterateeCall(string, separator, limit)) {\n        separator = limit = undefined;\n      }\n      limit = limit === undefined ? MAX_ARRAY_LENGTH : limit >>> 0;\n      if (!limit) {\n        return [];\n      }\n      string = toString(string);\n      if (string && (\n            typeof separator == 'string' ||\n            (separator != null && !isRegExp(separator))\n          )) {\n        separator = baseToString(separator);\n        if (!separator && hasUnicode(string)) {\n          return castSlice(stringToArray(string), 0, limit);\n        }\n      }\n      return string.split(separator, limit);\n    }\n\n    /**\n     * Converts `string` to\n     * [start case](https://en.wikipedia.org/wiki/Letter_case#Stylistic_or_specialised_usage).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.1.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the start cased string.\n     * @example\n     *\n     * _.startCase('--foo-bar--');\n     * // => 'Foo Bar'\n     *\n     * _.startCase('fooBar');\n     * // => 'Foo Bar'\n     *\n     * _.startCase('__FOO_BAR__');\n     * // => 'FOO BAR'\n     */\n    var startCase = createCompounder(function(result, word, index) {\n      return result + (index ? ' ' : '') + upperFirst(word);\n    });\n\n    /**\n     * Checks if `string` starts with the given target string.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to inspect.\n     * @param {string} [target] The string to search for.\n     * @param {number} [position=0] The position to search from.\n     * @returns {boolean} Returns `true` if `string` starts with `target`,\n     *  else `false`.\n     * @example\n     *\n     * _.startsWith('abc', 'a');\n     * // => true\n     *\n     * _.startsWith('abc', 'b');\n     * // => false\n     *\n     * _.startsWith('abc', 'b', 1);\n     * // => true\n     */\n    function startsWith(string, target, position) {\n      string = toString(string);\n      position = position == null\n        ? 0\n        : baseClamp(toInteger(position), 0, string.length);\n\n      target = baseToString(target);\n      return string.slice(position, position + target.length) == target;\n    }\n\n    /**\n     * Creates a compiled template function that can interpolate data properties\n     * in \"interpolate\" delimiters, HTML-escape interpolated data properties in\n     * \"escape\" delimiters, and execute JavaScript in \"evaluate\" delimiters. Data\n     * properties may be accessed as free variables in the template. If a setting\n     * object is given, it takes precedence over `_.templateSettings` values.\n     *\n     * **Note:** In the development build `_.template` utilizes\n     * [sourceURLs](http://www.html5rocks.com/en/tutorials/developertools/sourcemaps/#toc-sourceurl)\n     * for easier debugging.\n     *\n     * For more information on precompiling templates see\n     * [lodash's custom builds documentation](https://lodash.com/custom-builds).\n     *\n     * For more information on Chrome extension sandboxes see\n     * [Chrome's extensions documentation](https://developer.chrome.com/extensions/sandboxingEval).\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category String\n     * @param {string} [string=''] The template string.\n     * @param {Object} [options={}] The options object.\n     * @param {RegExp} [options.escape=_.templateSettings.escape]\n     *  The HTML \"escape\" delimiter.\n     * @param {RegExp} [options.evaluate=_.templateSettings.evaluate]\n     *  The \"evaluate\" delimiter.\n     * @param {Object} [options.imports=_.templateSettings.imports]\n     *  An object to import into the template as free variables.\n     * @param {RegExp} [options.interpolate=_.templateSettings.interpolate]\n     *  The \"interpolate\" delimiter.\n     * @param {string} [options.sourceURL='lodash.templateSources[n]']\n     *  The sourceURL of the compiled template.\n     * @param {string} [options.variable='obj']\n     *  The data object variable name.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Function} Returns the compiled template function.\n     * @example\n     *\n     * // Use the \"interpolate\" delimiter to create a compiled template.\n     * var compiled = _.template('hello <%= user %>!');\n     * compiled({ 'user': 'fred' });\n     * // => 'hello fred!'\n     *\n     * // Use the HTML \"escape\" delimiter to escape data property values.\n     * var compiled = _.template('<b><%- value %></b>');\n     * compiled({ 'value': '<script>' });\n     * // => '<b>&lt;script&gt;</b>'\n     *\n     * // Use the \"evaluate\" delimiter to execute JavaScript and generate HTML.\n     * var compiled = _.template('<% _.forEach(users, function(user) { %><li><%- user %></li><% }); %>');\n     * compiled({ 'users': ['fred', 'barney'] });\n     * // => '<li>fred</li><li>barney</li>'\n     *\n     * // Use the internal `print` function in \"evaluate\" delimiters.\n     * var compiled = _.template('<% print(\"hello \" + user); %>!');\n     * compiled({ 'user': 'barney' });\n     * // => 'hello barney!'\n     *\n     * // Use the ES template literal delimiter as an \"interpolate\" delimiter.\n     * // Disable support by replacing the \"interpolate\" delimiter.\n     * var compiled = _.template('hello ${ user }!');\n     * compiled({ 'user': 'pebbles' });\n     * // => 'hello pebbles!'\n     *\n     * // Use backslashes to treat delimiters as plain text.\n     * var compiled = _.template('<%= \"\\\\<%- value %\\\\>\" %>');\n     * compiled({ 'value': 'ignored' });\n     * // => '<%- value %>'\n     *\n     * // Use the `imports` option to import `jQuery` as `jq`.\n     * var text = '<% jq.each(users, function(user) { %><li><%- user %></li><% }); %>';\n     * var compiled = _.template(text, { 'imports': { 'jq': jQuery } });\n     * compiled({ 'users': ['fred', 'barney'] });\n     * // => '<li>fred</li><li>barney</li>'\n     *\n     * // Use the `sourceURL` option to specify a custom sourceURL for the template.\n     * var compiled = _.template('hello <%= user %>!', { 'sourceURL': '/basic/greeting.jst' });\n     * compiled(data);\n     * // => Find the source of \"greeting.jst\" under the Sources tab or Resources panel of the web inspector.\n     *\n     * // Use the `variable` option to ensure a with-statement isn't used in the compiled template.\n     * var compiled = _.template('hi <%= data.user %>!', { 'variable': 'data' });\n     * compiled.source;\n     * // => function(data) {\n     * //   var __t, __p = '';\n     * //   __p += 'hi ' + ((__t = ( data.user )) == null ? '' : __t) + '!';\n     * //   return __p;\n     * // }\n     *\n     * // Use custom template delimiters.\n     * _.templateSettings.interpolate = /{{([\\s\\S]+?)}}/g;\n     * var compiled = _.template('hello {{ user }}!');\n     * compiled({ 'user': 'mustache' });\n     * // => 'hello mustache!'\n     *\n     * // Use the `source` property to inline compiled templates for meaningful\n     * // line numbers in error messages and stack traces.\n     * fs.writeFileSync(path.join(process.cwd(), 'jst.js'), '\\\n     *   var JST = {\\\n     *     \"main\": ' + _.template(mainText).source + '\\\n     *   };\\\n     * ');\n     */\n    function template(string, options, guard) {\n      // Based on John Resig's `tmpl` implementation\n      // (http://ejohn.org/blog/javascript-micro-templating/)\n      // and Laura Doktorova's doT.js (https://github.com/olado/doT).\n      var settings = lodash.templateSettings;\n\n      if (guard && isIterateeCall(string, options, guard)) {\n        options = undefined;\n      }\n      string = toString(string);\n      options = assignInWith({}, options, settings, customDefaultsAssignIn);\n\n      var imports = assignInWith({}, options.imports, settings.imports, customDefaultsAssignIn),\n          importsKeys = keys(imports),\n          importsValues = baseValues(imports, importsKeys);\n\n      var isEscaping,\n          isEvaluating,\n          index = 0,\n          interpolate = options.interpolate || reNoMatch,\n          source = \"__p += '\";\n\n      // Compile the regexp to match each delimiter.\n      var reDelimiters = RegExp(\n        (options.escape || reNoMatch).source + '|' +\n        interpolate.source + '|' +\n        (interpolate === reInterpolate ? reEsTemplate : reNoMatch).source + '|' +\n        (options.evaluate || reNoMatch).source + '|$'\n      , 'g');\n\n      // Use a sourceURL for easier debugging.\n      // The sourceURL gets injected into the source that's eval-ed, so be careful\n      // to normalize all kinds of whitespace, so e.g. newlines (and unicode versions of it) can't sneak in\n      // and escape the comment, thus injecting code that gets evaled.\n      var sourceURL = '//# sourceURL=' +\n        (hasOwnProperty.call(options, 'sourceURL')\n          ? (options.sourceURL + '').replace(/\\s/g, ' ')\n          : ('lodash.templateSources[' + (++templateCounter) + ']')\n        ) + '\\n';\n\n      string.replace(reDelimiters, function(match, escapeValue, interpolateValue, esTemplateValue, evaluateValue, offset) {\n        interpolateValue || (interpolateValue = esTemplateValue);\n\n        // Escape characters that can't be included in string literals.\n        source += string.slice(index, offset).replace(reUnescapedString, escapeStringChar);\n\n        // Replace delimiters with snippets.\n        if (escapeValue) {\n          isEscaping = true;\n          source += \"' +\\n__e(\" + escapeValue + \") +\\n'\";\n        }\n        if (evaluateValue) {\n          isEvaluating = true;\n          source += \"';\\n\" + evaluateValue + \";\\n__p += '\";\n        }\n        if (interpolateValue) {\n          source += \"' +\\n((__t = (\" + interpolateValue + \")) == null ? '' : __t) +\\n'\";\n        }\n        index = offset + match.length;\n\n        // The JS engine embedded in Adobe products needs `match` returned in\n        // order to produce the correct `offset` value.\n        return match;\n      });\n\n      source += \"';\\n\";\n\n      // If `variable` is not specified wrap a with-statement around the generated\n      // code to add the data object to the top of the scope chain.\n      var variable = hasOwnProperty.call(options, 'variable') && options.variable;\n      if (!variable) {\n        source = 'with (obj) {\\n' + source + '\\n}\\n';\n      }\n      // Throw an error if a forbidden character was found in `variable`, to prevent\n      // potential command injection attacks.\n      else if (reForbiddenIdentifierChars.test(variable)) {\n        throw new Error(INVALID_TEMPL_VAR_ERROR_TEXT);\n      }\n\n      // Cleanup code by stripping empty strings.\n      source = (isEvaluating ? source.replace(reEmptyStringLeading, '') : source)\n        .replace(reEmptyStringMiddle, '$1')\n        .replace(reEmptyStringTrailing, '$1;');\n\n      // Frame code as the function body.\n      source = 'function(' + (variable || 'obj') + ') {\\n' +\n        (variable\n          ? ''\n          : 'obj || (obj = {});\\n'\n        ) +\n        \"var __t, __p = ''\" +\n        (isEscaping\n           ? ', __e = _.escape'\n           : ''\n        ) +\n        (isEvaluating\n          ? ', __j = Array.prototype.join;\\n' +\n            \"function print() { __p += __j.call(arguments, '') }\\n\"\n          : ';\\n'\n        ) +\n        source +\n        'return __p\\n}';\n\n      var result = attempt(function() {\n        return Function(importsKeys, sourceURL + 'return ' + source)\n          .apply(undefined, importsValues);\n      });\n\n      // Provide the compiled function's source by its `toString` method or\n      // the `source` property as a convenience for inlining compiled templates.\n      result.source = source;\n      if (isError(result)) {\n        throw result;\n      }\n      return result;\n    }\n\n    /**\n     * Converts `string`, as a whole, to lower case just like\n     * [String#toLowerCase](https://mdn.io/toLowerCase).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the lower cased string.\n     * @example\n     *\n     * _.toLower('--Foo-Bar--');\n     * // => '--foo-bar--'\n     *\n     * _.toLower('fooBar');\n     * // => 'foobar'\n     *\n     * _.toLower('__FOO_BAR__');\n     * // => '__foo_bar__'\n     */\n    function toLower(value) {\n      return toString(value).toLowerCase();\n    }\n\n    /**\n     * Converts `string`, as a whole, to upper case just like\n     * [String#toUpperCase](https://mdn.io/toUpperCase).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the upper cased string.\n     * @example\n     *\n     * _.toUpper('--foo-bar--');\n     * // => '--FOO-BAR--'\n     *\n     * _.toUpper('fooBar');\n     * // => 'FOOBAR'\n     *\n     * _.toUpper('__foo_bar__');\n     * // => '__FOO_BAR__'\n     */\n    function toUpper(value) {\n      return toString(value).toUpperCase();\n    }\n\n    /**\n     * Removes leading and trailing whitespace or specified characters from `string`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to trim.\n     * @param {string} [chars=whitespace] The characters to trim.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {string} Returns the trimmed string.\n     * @example\n     *\n     * _.trim('  abc  ');\n     * // => 'abc'\n     *\n     * _.trim('-_-abc-_-', '_-');\n     * // => 'abc'\n     *\n     * _.map(['  foo  ', '  bar  '], _.trim);\n     * // => ['foo', 'bar']\n     */\n    function trim(string, chars, guard) {\n      string = toString(string);\n      if (string && (guard || chars === undefined)) {\n        return baseTrim(string);\n      }\n      if (!string || !(chars = baseToString(chars))) {\n        return string;\n      }\n      var strSymbols = stringToArray(string),\n          chrSymbols = stringToArray(chars),\n          start = charsStartIndex(strSymbols, chrSymbols),\n          end = charsEndIndex(strSymbols, chrSymbols) + 1;\n\n      return castSlice(strSymbols, start, end).join('');\n    }\n\n    /**\n     * Removes trailing whitespace or specified characters from `string`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to trim.\n     * @param {string} [chars=whitespace] The characters to trim.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {string} Returns the trimmed string.\n     * @example\n     *\n     * _.trimEnd('  abc  ');\n     * // => '  abc'\n     *\n     * _.trimEnd('-_-abc-_-', '_-');\n     * // => '-_-abc'\n     */\n    function trimEnd(string, chars, guard) {\n      string = toString(string);\n      if (string && (guard || chars === undefined)) {\n        return string.slice(0, trimmedEndIndex(string) + 1);\n      }\n      if (!string || !(chars = baseToString(chars))) {\n        return string;\n      }\n      var strSymbols = stringToArray(string),\n          end = charsEndIndex(strSymbols, stringToArray(chars)) + 1;\n\n      return castSlice(strSymbols, 0, end).join('');\n    }\n\n    /**\n     * Removes leading whitespace or specified characters from `string`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to trim.\n     * @param {string} [chars=whitespace] The characters to trim.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {string} Returns the trimmed string.\n     * @example\n     *\n     * _.trimStart('  abc  ');\n     * // => 'abc  '\n     *\n     * _.trimStart('-_-abc-_-', '_-');\n     * // => 'abc-_-'\n     */\n    function trimStart(string, chars, guard) {\n      string = toString(string);\n      if (string && (guard || chars === undefined)) {\n        return string.replace(reTrimStart, '');\n      }\n      if (!string || !(chars = baseToString(chars))) {\n        return string;\n      }\n      var strSymbols = stringToArray(string),\n          start = charsStartIndex(strSymbols, stringToArray(chars));\n\n      return castSlice(strSymbols, start).join('');\n    }\n\n    /**\n     * Truncates `string` if it's longer than the given maximum string length.\n     * The last characters of the truncated string are replaced with the omission\n     * string which defaults to \"...\".\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to truncate.\n     * @param {Object} [options={}] The options object.\n     * @param {number} [options.length=30] The maximum string length.\n     * @param {string} [options.omission='...'] The string to indicate text is omitted.\n     * @param {RegExp|string} [options.separator] The separator pattern to truncate to.\n     * @returns {string} Returns the truncated string.\n     * @example\n     *\n     * _.truncate('hi-diddly-ho there, neighborino');\n     * // => 'hi-diddly-ho there, neighbo...'\n     *\n     * _.truncate('hi-diddly-ho there, neighborino', {\n     *   'length': 24,\n     *   'separator': ' '\n     * });\n     * // => 'hi-diddly-ho there,...'\n     *\n     * _.truncate('hi-diddly-ho there, neighborino', {\n     *   'length': 24,\n     *   'separator': /,? +/\n     * });\n     * // => 'hi-diddly-ho there...'\n     *\n     * _.truncate('hi-diddly-ho there, neighborino', {\n     *   'omission': ' [...]'\n     * });\n     * // => 'hi-diddly-ho there, neig [...]'\n     */\n    function truncate(string, options) {\n      var length = DEFAULT_TRUNC_LENGTH,\n          omission = DEFAULT_TRUNC_OMISSION;\n\n      if (isObject(options)) {\n        var separator = 'separator' in options ? options.separator : separator;\n        length = 'length' in options ? toInteger(options.length) : length;\n        omission = 'omission' in options ? baseToString(options.omission) : omission;\n      }\n      string = toString(string);\n\n      var strLength = string.length;\n      if (hasUnicode(string)) {\n        var strSymbols = stringToArray(string);\n        strLength = strSymbols.length;\n      }\n      if (length >= strLength) {\n        return string;\n      }\n      var end = length - stringSize(omission);\n      if (end < 1) {\n        return omission;\n      }\n      var result = strSymbols\n        ? castSlice(strSymbols, 0, end).join('')\n        : string.slice(0, end);\n\n      if (separator === undefined) {\n        return result + omission;\n      }\n      if (strSymbols) {\n        end += (result.length - end);\n      }\n      if (isRegExp(separator)) {\n        if (string.slice(end).search(separator)) {\n          var match,\n              substring = result;\n\n          if (!separator.global) {\n            separator = RegExp(separator.source, toString(reFlags.exec(separator)) + 'g');\n          }\n          separator.lastIndex = 0;\n          while ((match = separator.exec(substring))) {\n            var newEnd = match.index;\n          }\n          result = result.slice(0, newEnd === undefined ? end : newEnd);\n        }\n      } else if (string.indexOf(baseToString(separator), end) != end) {\n        var index = result.lastIndexOf(separator);\n        if (index > -1) {\n          result = result.slice(0, index);\n        }\n      }\n      return result + omission;\n    }\n\n    /**\n     * The inverse of `_.escape`; this method converts the HTML entities\n     * `&amp;`, `&lt;`, `&gt;`, `&quot;`, and `&#39;` in `string` to\n     * their corresponding characters.\n     *\n     * **Note:** No other HTML entities are unescaped. To unescape additional\n     * HTML entities use a third-party library like [_he_](https://mths.be/he).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.6.0\n     * @category String\n     * @param {string} [string=''] The string to unescape.\n     * @returns {string} Returns the unescaped string.\n     * @example\n     *\n     * _.unescape('fred, barney, &amp; pebbles');\n     * // => 'fred, barney, & pebbles'\n     */\n    function unescape(string) {\n      string = toString(string);\n      return (string && reHasEscapedHtml.test(string))\n        ? string.replace(reEscapedHtml, unescapeHtmlChar)\n        : string;\n    }\n\n    /**\n     * Converts `string`, as space separated words, to upper case.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the upper cased string.\n     * @example\n     *\n     * _.upperCase('--foo-bar');\n     * // => 'FOO BAR'\n     *\n     * _.upperCase('fooBar');\n     * // => 'FOO BAR'\n     *\n     * _.upperCase('__foo_bar__');\n     * // => 'FOO BAR'\n     */\n    var upperCase = createCompounder(function(result, word, index) {\n      return result + (index ? ' ' : '') + word.toUpperCase();\n    });\n\n    /**\n     * Converts the first character of `string` to upper case.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the converted string.\n     * @example\n     *\n     * _.upperFirst('fred');\n     * // => 'Fred'\n     *\n     * _.upperFirst('FRED');\n     * // => 'FRED'\n     */\n    var upperFirst = createCaseFirst('toUpperCase');\n\n    /**\n     * Splits `string` into an array of its words.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to inspect.\n     * @param {RegExp|string} [pattern] The pattern to match words.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the words of `string`.\n     * @example\n     *\n     * _.words('fred, barney, & pebbles');\n     * // => ['fred', 'barney', 'pebbles']\n     *\n     * _.words('fred, barney, & pebbles', /[^, ]+/g);\n     * // => ['fred', 'barney', '&', 'pebbles']\n     */\n    function words(string, pattern, guard) {\n      string = toString(string);\n      pattern = guard ? undefined : pattern;\n\n      if (pattern === undefined) {\n        return hasUnicodeWord(string) ? unicodeWords(string) : asciiWords(string);\n      }\n      return string.match(pattern) || [];\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Attempts to invoke `func`, returning either the result or the caught error\n     * object. Any additional arguments are provided to `func` when it's invoked.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Util\n     * @param {Function} func The function to attempt.\n     * @param {...*} [args] The arguments to invoke `func` with.\n     * @returns {*} Returns the `func` result or error object.\n     * @example\n     *\n     * // Avoid throwing errors for invalid selectors.\n     * var elements = _.attempt(function(selector) {\n     *   return document.querySelectorAll(selector);\n     * }, '>_>');\n     *\n     * if (_.isError(elements)) {\n     *   elements = [];\n     * }\n     */\n    var attempt = baseRest(function(func, args) {\n      try {\n        return apply(func, undefined, args);\n      } catch (e) {\n        return isError(e) ? e : new Error(e);\n      }\n    });\n\n    /**\n     * Binds methods of an object to the object itself, overwriting the existing\n     * method.\n     *\n     * **Note:** This method doesn't set the \"length\" property of bound functions.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @param {Object} object The object to bind and assign the bound methods to.\n     * @param {...(string|string[])} methodNames The object method names to bind.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var view = {\n     *   'label': 'docs',\n     *   'click': function() {\n     *     console.log('clicked ' + this.label);\n     *   }\n     * };\n     *\n     * _.bindAll(view, ['click']);\n     * jQuery(element).on('click', view.click);\n     * // => Logs 'clicked docs' when clicked.\n     */\n    var bindAll = flatRest(function(object, methodNames) {\n      arrayEach(methodNames, function(key) {\n        key = toKey(key);\n        baseAssignValue(object, key, bind(object[key], object));\n      });\n      return object;\n    });\n\n    /**\n     * Creates a function that iterates over `pairs` and invokes the corresponding\n     * function of the first predicate to return truthy. The predicate-function\n     * pairs are invoked with the `this` binding and arguments of the created\n     * function.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {Array} pairs The predicate-function pairs.\n     * @returns {Function} Returns the new composite function.\n     * @example\n     *\n     * var func = _.cond([\n     *   [_.matches({ 'a': 1 }),           _.constant('matches A')],\n     *   [_.conforms({ 'b': _.isNumber }), _.constant('matches B')],\n     *   [_.stubTrue,                      _.constant('no match')]\n     * ]);\n     *\n     * func({ 'a': 1, 'b': 2 });\n     * // => 'matches A'\n     *\n     * func({ 'a': 0, 'b': 1 });\n     * // => 'matches B'\n     *\n     * func({ 'a': '1', 'b': '2' });\n     * // => 'no match'\n     */\n    function cond(pairs) {\n      var length = pairs == null ? 0 : pairs.length,\n          toIteratee = getIteratee();\n\n      pairs = !length ? [] : arrayMap(pairs, function(pair) {\n        if (typeof pair[1] != 'function') {\n          throw new TypeError(FUNC_ERROR_TEXT);\n        }\n        return [toIteratee(pair[0]), pair[1]];\n      });\n\n      return baseRest(function(args) {\n        var index = -1;\n        while (++index < length) {\n          var pair = pairs[index];\n          if (apply(pair[0], this, args)) {\n            return apply(pair[1], this, args);\n          }\n        }\n      });\n    }\n\n    /**\n     * Creates a function that invokes the predicate properties of `source` with\n     * the corresponding property values of a given object, returning `true` if\n     * all predicates return truthy, else `false`.\n     *\n     * **Note:** The created function is equivalent to `_.conformsTo` with\n     * `source` partially applied.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {Object} source The object of property predicates to conform to.\n     * @returns {Function} Returns the new spec function.\n     * @example\n     *\n     * var objects = [\n     *   { 'a': 2, 'b': 1 },\n     *   { 'a': 1, 'b': 2 }\n     * ];\n     *\n     * _.filter(objects, _.conforms({ 'b': function(n) { return n > 1; } }));\n     * // => [{ 'a': 1, 'b': 2 }]\n     */\n    function conforms(source) {\n      return baseConforms(baseClone(source, CLONE_DEEP_FLAG));\n    }\n\n    /**\n     * Creates a function that returns `value`.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.4.0\n     * @category Util\n     * @param {*} value The value to return from the new function.\n     * @returns {Function} Returns the new constant function.\n     * @example\n     *\n     * var objects = _.times(2, _.constant({ 'a': 1 }));\n     *\n     * console.log(objects);\n     * // => [{ 'a': 1 }, { 'a': 1 }]\n     *\n     * console.log(objects[0] === objects[1]);\n     * // => true\n     */\n    function constant(value) {\n      return function() {\n        return value;\n      };\n    }\n\n    /**\n     * Checks `value` to determine whether a default value should be returned in\n     * its place. The `defaultValue` is returned if `value` is `NaN`, `null`,\n     * or `undefined`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.14.0\n     * @category Util\n     * @param {*} value The value to check.\n     * @param {*} defaultValue The default value.\n     * @returns {*} Returns the resolved value.\n     * @example\n     *\n     * _.defaultTo(1, 10);\n     * // => 1\n     *\n     * _.defaultTo(undefined, 10);\n     * // => 10\n     */\n    function defaultTo(value, defaultValue) {\n      return (value == null || value !== value) ? defaultValue : value;\n    }\n\n    /**\n     * Creates a function that returns the result of invoking the given functions\n     * with the `this` binding of the created function, where each successive\n     * invocation is supplied the return value of the previous.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Util\n     * @param {...(Function|Function[])} [funcs] The functions to invoke.\n     * @returns {Function} Returns the new composite function.\n     * @see _.flowRight\n     * @example\n     *\n     * function square(n) {\n     *   return n * n;\n     * }\n     *\n     * var addSquare = _.flow([_.add, square]);\n     * addSquare(1, 2);\n     * // => 9\n     */\n    var flow = createFlow();\n\n    /**\n     * This method is like `_.flow` except that it creates a function that\n     * invokes the given functions from right to left.\n     *\n     * @static\n     * @since 3.0.0\n     * @memberOf _\n     * @category Util\n     * @param {...(Function|Function[])} [funcs] The functions to invoke.\n     * @returns {Function} Returns the new composite function.\n     * @see _.flow\n     * @example\n     *\n     * function square(n) {\n     *   return n * n;\n     * }\n     *\n     * var addSquare = _.flowRight([square, _.add]);\n     * addSquare(1, 2);\n     * // => 9\n     */\n    var flowRight = createFlow(true);\n\n    /**\n     * This method returns the first argument it receives.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @param {*} value Any value.\n     * @returns {*} Returns `value`.\n     * @example\n     *\n     * var object = { 'a': 1 };\n     *\n     * console.log(_.identity(object) === object);\n     * // => true\n     */\n    function identity(value) {\n      return value;\n    }\n\n    /**\n     * Creates a function that invokes `func` with the arguments of the created\n     * function. If `func` is a property name, the created function returns the\n     * property value for a given element. If `func` is an array or object, the\n     * created function returns `true` for elements that contain the equivalent\n     * source properties, otherwise it returns `false`.\n     *\n     * @static\n     * @since 4.0.0\n     * @memberOf _\n     * @category Util\n     * @param {*} [func=_.identity] The value to convert to a callback.\n     * @returns {Function} Returns the callback.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney', 'age': 36, 'active': true },\n     *   { 'user': 'fred',   'age': 40, 'active': false }\n     * ];\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.filter(users, _.iteratee({ 'user': 'barney', 'active': true }));\n     * // => [{ 'user': 'barney', 'age': 36, 'active': true }]\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.filter(users, _.iteratee(['user', 'fred']));\n     * // => [{ 'user': 'fred', 'age': 40 }]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.map(users, _.iteratee('user'));\n     * // => ['barney', 'fred']\n     *\n     * // Create custom iteratee shorthands.\n     * _.iteratee = _.wrap(_.iteratee, function(iteratee, func) {\n     *   return !_.isRegExp(func) ? iteratee(func) : function(string) {\n     *     return func.test(string);\n     *   };\n     * });\n     *\n     * _.filter(['abc', 'def'], /ef/);\n     * // => ['def']\n     */\n    function iteratee(func) {\n      return baseIteratee(typeof func == 'function' ? func : baseClone(func, CLONE_DEEP_FLAG));\n    }\n\n    /**\n     * Creates a function that performs a partial deep comparison between a given\n     * object and `source`, returning `true` if the given object has equivalent\n     * property values, else `false`.\n     *\n     * **Note:** The created function is equivalent to `_.isMatch` with `source`\n     * partially applied.\n     *\n     * Partial comparisons will match empty array and empty object `source`\n     * values against any array or object value, respectively. See `_.isEqual`\n     * for a list of supported value comparisons.\n     *\n     * **Note:** Multiple values can be checked by combining several matchers\n     * using `_.overSome`\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Util\n     * @param {Object} source The object of property values to match.\n     * @returns {Function} Returns the new spec function.\n     * @example\n     *\n     * var objects = [\n     *   { 'a': 1, 'b': 2, 'c': 3 },\n     *   { 'a': 4, 'b': 5, 'c': 6 }\n     * ];\n     *\n     * _.filter(objects, _.matches({ 'a': 4, 'c': 6 }));\n     * // => [{ 'a': 4, 'b': 5, 'c': 6 }]\n     *\n     * // Checking for several possible values\n     * _.filter(objects, _.overSome([_.matches({ 'a': 1 }), _.matches({ 'a': 4 })]));\n     * // => [{ 'a': 1, 'b': 2, 'c': 3 }, { 'a': 4, 'b': 5, 'c': 6 }]\n     */\n    function matches(source) {\n      return baseMatches(baseClone(source, CLONE_DEEP_FLAG));\n    }\n\n    /**\n     * Creates a function that performs a partial deep comparison between the\n     * value at `path` of a given object to `srcValue`, returning `true` if the\n     * object value is equivalent, else `false`.\n     *\n     * **Note:** Partial comparisons will match empty array and empty object\n     * `srcValue` values against any array or object value, respectively. See\n     * `_.isEqual` for a list of supported value comparisons.\n     *\n     * **Note:** Multiple values can be checked by combining several matchers\n     * using `_.overSome`\n     *\n     * @static\n     * @memberOf _\n     * @since 3.2.0\n     * @category Util\n     * @param {Array|string} path The path of the property to get.\n     * @param {*} srcValue The value to match.\n     * @returns {Function} Returns the new spec function.\n     * @example\n     *\n     * var objects = [\n     *   { 'a': 1, 'b': 2, 'c': 3 },\n     *   { 'a': 4, 'b': 5, 'c': 6 }\n     * ];\n     *\n     * _.find(objects, _.matchesProperty('a', 4));\n     * // => { 'a': 4, 'b': 5, 'c': 6 }\n     *\n     * // Checking for several possible values\n     * _.filter(objects, _.overSome([_.matchesProperty('a', 1), _.matchesProperty('a', 4)]));\n     * // => [{ 'a': 1, 'b': 2, 'c': 3 }, { 'a': 4, 'b': 5, 'c': 6 }]\n     */\n    function matchesProperty(path, srcValue) {\n      return baseMatchesProperty(path, baseClone(srcValue, CLONE_DEEP_FLAG));\n    }\n\n    /**\n     * Creates a function that invokes the method at `path` of a given object.\n     * Any additional arguments are provided to the invoked method.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.7.0\n     * @category Util\n     * @param {Array|string} path The path of the method to invoke.\n     * @param {...*} [args] The arguments to invoke the method with.\n     * @returns {Function} Returns the new invoker function.\n     * @example\n     *\n     * var objects = [\n     *   { 'a': { 'b': _.constant(2) } },\n     *   { 'a': { 'b': _.constant(1) } }\n     * ];\n     *\n     * _.map(objects, _.method('a.b'));\n     * // => [2, 1]\n     *\n     * _.map(objects, _.method(['a', 'b']));\n     * // => [2, 1]\n     */\n    var method = baseRest(function(path, args) {\n      return function(object) {\n        return baseInvoke(object, path, args);\n      };\n    });\n\n    /**\n     * The opposite of `_.method`; this method creates a function that invokes\n     * the method at a given path of `object`. Any additional arguments are\n     * provided to the invoked method.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.7.0\n     * @category Util\n     * @param {Object} object The object to query.\n     * @param {...*} [args] The arguments to invoke the method with.\n     * @returns {Function} Returns the new invoker function.\n     * @example\n     *\n     * var array = _.times(3, _.constant),\n     *     object = { 'a': array, 'b': array, 'c': array };\n     *\n     * _.map(['a[2]', 'c[0]'], _.methodOf(object));\n     * // => [2, 0]\n     *\n     * _.map([['a', '2'], ['c', '0']], _.methodOf(object));\n     * // => [2, 0]\n     */\n    var methodOf = baseRest(function(object, args) {\n      return function(path) {\n        return baseInvoke(object, path, args);\n      };\n    });\n\n    /**\n     * Adds all own enumerable string keyed function properties of a source\n     * object to the destination object. If `object` is a function, then methods\n     * are added to its prototype as well.\n     *\n     * **Note:** Use `_.runInContext` to create a pristine `lodash` function to\n     * avoid conflicts caused by modifying the original.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @param {Function|Object} [object=lodash] The destination object.\n     * @param {Object} source The object of functions to add.\n     * @param {Object} [options={}] The options object.\n     * @param {boolean} [options.chain=true] Specify whether mixins are chainable.\n     * @returns {Function|Object} Returns `object`.\n     * @example\n     *\n     * function vowels(string) {\n     *   return _.filter(string, function(v) {\n     *     return /[aeiou]/i.test(v);\n     *   });\n     * }\n     *\n     * _.mixin({ 'vowels': vowels });\n     * _.vowels('fred');\n     * // => ['e']\n     *\n     * _('fred').vowels().value();\n     * // => ['e']\n     *\n     * _.mixin({ 'vowels': vowels }, { 'chain': false });\n     * _('fred').vowels();\n     * // => ['e']\n     */\n    function mixin(object, source, options) {\n      var props = keys(source),\n          methodNames = baseFunctions(source, props);\n\n      if (options == null &&\n          !(isObject(source) && (methodNames.length || !props.length))) {\n        options = source;\n        source = object;\n        object = this;\n        methodNames = baseFunctions(source, keys(source));\n      }\n      var chain = !(isObject(options) && 'chain' in options) || !!options.chain,\n          isFunc = isFunction(object);\n\n      arrayEach(methodNames, function(methodName) {\n        var func = source[methodName];\n        object[methodName] = func;\n        if (isFunc) {\n          object.prototype[methodName] = function() {\n            var chainAll = this.__chain__;\n            if (chain || chainAll) {\n              var result = object(this.__wrapped__),\n                  actions = result.__actions__ = copyArray(this.__actions__);\n\n              actions.push({ 'func': func, 'args': arguments, 'thisArg': object });\n              result.__chain__ = chainAll;\n              return result;\n            }\n            return func.apply(object, arrayPush([this.value()], arguments));\n          };\n        }\n      });\n\n      return object;\n    }\n\n    /**\n     * Reverts the `_` variable to its previous value and returns a reference to\n     * the `lodash` function.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @returns {Function} Returns the `lodash` function.\n     * @example\n     *\n     * var lodash = _.noConflict();\n     */\n    function noConflict() {\n      if (root._ === this) {\n        root._ = oldDash;\n      }\n      return this;\n    }\n\n    /**\n     * This method returns `undefined`.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.3.0\n     * @category Util\n     * @example\n     *\n     * _.times(2, _.noop);\n     * // => [undefined, undefined]\n     */\n    function noop() {\n      // No operation performed.\n    }\n\n    /**\n     * Creates a function that gets the argument at index `n`. If `n` is negative,\n     * the nth argument from the end is returned.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {number} [n=0] The index of the argument to return.\n     * @returns {Function} Returns the new pass-thru function.\n     * @example\n     *\n     * var func = _.nthArg(1);\n     * func('a', 'b', 'c', 'd');\n     * // => 'b'\n     *\n     * var func = _.nthArg(-2);\n     * func('a', 'b', 'c', 'd');\n     * // => 'c'\n     */\n    function nthArg(n) {\n      n = toInteger(n);\n      return baseRest(function(args) {\n        return baseNth(args, n);\n      });\n    }\n\n    /**\n     * Creates a function that invokes `iteratees` with the arguments it receives\n     * and returns their results.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {...(Function|Function[])} [iteratees=[_.identity]]\n     *  The iteratees to invoke.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var func = _.over([Math.max, Math.min]);\n     *\n     * func(1, 2, 3, 4);\n     * // => [4, 1]\n     */\n    var over = createOver(arrayMap);\n\n    /**\n     * Creates a function that checks if **all** of the `predicates` return\n     * truthy when invoked with the arguments it receives.\n     *\n     * Following shorthands are possible for providing predicates.\n     * Pass an `Object` and it will be used as an parameter for `_.matches` to create the predicate.\n     * Pass an `Array` of parameters for `_.matchesProperty` and the predicate will be created using them.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {...(Function|Function[])} [predicates=[_.identity]]\n     *  The predicates to check.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var func = _.overEvery([Boolean, isFinite]);\n     *\n     * func('1');\n     * // => true\n     *\n     * func(null);\n     * // => false\n     *\n     * func(NaN);\n     * // => false\n     */\n    var overEvery = createOver(arrayEvery);\n\n    /**\n     * Creates a function that checks if **any** of the `predicates` return\n     * truthy when invoked with the arguments it receives.\n     *\n     * Following shorthands are possible for providing predicates.\n     * Pass an `Object` and it will be used as an parameter for `_.matches` to create the predicate.\n     * Pass an `Array` of parameters for `_.matchesProperty` and the predicate will be created using them.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {...(Function|Function[])} [predicates=[_.identity]]\n     *  The predicates to check.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var func = _.overSome([Boolean, isFinite]);\n     *\n     * func('1');\n     * // => true\n     *\n     * func(null);\n     * // => true\n     *\n     * func(NaN);\n     * // => false\n     *\n     * var matchesFunc = _.overSome([{ 'a': 1 }, { 'a': 2 }])\n     * var matchesPropertyFunc = _.overSome([['a', 1], ['a', 2]])\n     */\n    var overSome = createOver(arraySome);\n\n    /**\n     * Creates a function that returns the value at `path` of a given object.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.4.0\n     * @category Util\n     * @param {Array|string} path The path of the property to get.\n     * @returns {Function} Returns the new accessor function.\n     * @example\n     *\n     * var objects = [\n     *   { 'a': { 'b': 2 } },\n     *   { 'a': { 'b': 1 } }\n     * ];\n     *\n     * _.map(objects, _.property('a.b'));\n     * // => [2, 1]\n     *\n     * _.map(_.sortBy(objects, _.property(['a', 'b'])), 'a.b');\n     * // => [1, 2]\n     */\n    function property(path) {\n      return isKey(path) ? baseProperty(toKey(path)) : basePropertyDeep(path);\n    }\n\n    /**\n     * The opposite of `_.property`; this method creates a function that returns\n     * the value at a given path of `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Util\n     * @param {Object} object The object to query.\n     * @returns {Function} Returns the new accessor function.\n     * @example\n     *\n     * var array = [0, 1, 2],\n     *     object = { 'a': array, 'b': array, 'c': array };\n     *\n     * _.map(['a[2]', 'c[0]'], _.propertyOf(object));\n     * // => [2, 0]\n     *\n     * _.map([['a', '2'], ['c', '0']], _.propertyOf(object));\n     * // => [2, 0]\n     */\n    function propertyOf(object) {\n      return function(path) {\n        return object == null ? undefined : baseGet(object, path);\n      };\n    }\n\n    /**\n     * Creates an array of numbers (positive and/or negative) progressing from\n     * `start` up to, but not including, `end`. A step of `-1` is used if a negative\n     * `start` is specified without an `end` or `step`. If `end` is not specified,\n     * it's set to `start` with `start` then set to `0`.\n     *\n     * **Note:** JavaScript follows the IEEE-754 standard for resolving\n     * floating-point values which can produce unexpected results.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @param {number} [start=0] The start of the range.\n     * @param {number} end The end of the range.\n     * @param {number} [step=1] The value to increment or decrement by.\n     * @returns {Array} Returns the range of numbers.\n     * @see _.inRange, _.rangeRight\n     * @example\n     *\n     * _.range(4);\n     * // => [0, 1, 2, 3]\n     *\n     * _.range(-4);\n     * // => [0, -1, -2, -3]\n     *\n     * _.range(1, 5);\n     * // => [1, 2, 3, 4]\n     *\n     * _.range(0, 20, 5);\n     * // => [0, 5, 10, 15]\n     *\n     * _.range(0, -4, -1);\n     * // => [0, -1, -2, -3]\n     *\n     * _.range(1, 4, 0);\n     * // => [1, 1, 1]\n     *\n     * _.range(0);\n     * // => []\n     */\n    var range = createRange();\n\n    /**\n     * This method is like `_.range` except that it populates values in\n     * descending order.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {number} [start=0] The start of the range.\n     * @param {number} end The end of the range.\n     * @param {number} [step=1] The value to increment or decrement by.\n     * @returns {Array} Returns the range of numbers.\n     * @see _.inRange, _.range\n     * @example\n     *\n     * _.rangeRight(4);\n     * // => [3, 2, 1, 0]\n     *\n     * _.rangeRight(-4);\n     * // => [-3, -2, -1, 0]\n     *\n     * _.rangeRight(1, 5);\n     * // => [4, 3, 2, 1]\n     *\n     * _.rangeRight(0, 20, 5);\n     * // => [15, 10, 5, 0]\n     *\n     * _.rangeRight(0, -4, -1);\n     * // => [-3, -2, -1, 0]\n     *\n     * _.rangeRight(1, 4, 0);\n     * // => [1, 1, 1]\n     *\n     * _.rangeRight(0);\n     * // => []\n     */\n    var rangeRight = createRange(true);\n\n    /**\n     * This method returns a new empty array.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.13.0\n     * @category Util\n     * @returns {Array} Returns the new empty array.\n     * @example\n     *\n     * var arrays = _.times(2, _.stubArray);\n     *\n     * console.log(arrays);\n     * // => [[], []]\n     *\n     * console.log(arrays[0] === arrays[1]);\n     * // => false\n     */\n    function stubArray() {\n      return [];\n    }\n\n    /**\n     * This method returns `false`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.13.0\n     * @category Util\n     * @returns {boolean} Returns `false`.\n     * @example\n     *\n     * _.times(2, _.stubFalse);\n     * // => [false, false]\n     */\n    function stubFalse() {\n      return false;\n    }\n\n    /**\n     * This method returns a new empty object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.13.0\n     * @category Util\n     * @returns {Object} Returns the new empty object.\n     * @example\n     *\n     * var objects = _.times(2, _.stubObject);\n     *\n     * console.log(objects);\n     * // => [{}, {}]\n     *\n     * console.log(objects[0] === objects[1]);\n     * // => false\n     */\n    function stubObject() {\n      return {};\n    }\n\n    /**\n     * This method returns an empty string.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.13.0\n     * @category Util\n     * @returns {string} Returns the empty string.\n     * @example\n     *\n     * _.times(2, _.stubString);\n     * // => ['', '']\n     */\n    function stubString() {\n      return '';\n    }\n\n    /**\n     * This method returns `true`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.13.0\n     * @category Util\n     * @returns {boolean} Returns `true`.\n     * @example\n     *\n     * _.times(2, _.stubTrue);\n     * // => [true, true]\n     */\n    function stubTrue() {\n      return true;\n    }\n\n    /**\n     * Invokes the iteratee `n` times, returning an array of the results of\n     * each invocation. The iteratee is invoked with one argument; (index).\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @param {number} n The number of times to invoke `iteratee`.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the array of results.\n     * @example\n     *\n     * _.times(3, String);\n     * // => ['0', '1', '2']\n     *\n     *  _.times(4, _.constant(0));\n     * // => [0, 0, 0, 0]\n     */\n    function times(n, iteratee) {\n      n = toInteger(n);\n      if (n < 1 || n > MAX_SAFE_INTEGER) {\n        return [];\n      }\n      var index = MAX_ARRAY_LENGTH,\n          length = nativeMin(n, MAX_ARRAY_LENGTH);\n\n      iteratee = getIteratee(iteratee);\n      n -= MAX_ARRAY_LENGTH;\n\n      var result = baseTimes(length, iteratee);\n      while (++index < n) {\n        iteratee(index);\n      }\n      return result;\n    }\n\n    /**\n     * Converts `value` to a property path array.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {*} value The value to convert.\n     * @returns {Array} Returns the new property path array.\n     * @example\n     *\n     * _.toPath('a.b.c');\n     * // => ['a', 'b', 'c']\n     *\n     * _.toPath('a[0].b.c');\n     * // => ['a', '0', 'b', 'c']\n     */\n    function toPath(value) {\n      if (isArray(value)) {\n        return arrayMap(value, toKey);\n      }\n      return isSymbol(value) ? [value] : copyArray(stringToPath(toString(value)));\n    }\n\n    /**\n     * Generates a unique ID. If `prefix` is given, the ID is appended to it.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @param {string} [prefix=''] The value to prefix the ID with.\n     * @returns {string} Returns the unique ID.\n     * @example\n     *\n     * _.uniqueId('contact_');\n     * // => 'contact_104'\n     *\n     * _.uniqueId();\n     * // => '105'\n     */\n    function uniqueId(prefix) {\n      var id = ++idCounter;\n      return toString(prefix) + id;\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Adds two numbers.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.4.0\n     * @category Math\n     * @param {number} augend The first number in an addition.\n     * @param {number} addend The second number in an addition.\n     * @returns {number} Returns the total.\n     * @example\n     *\n     * _.add(6, 4);\n     * // => 10\n     */\n    var add = createMathOperation(function(augend, addend) {\n      return augend + addend;\n    }, 0);\n\n    /**\n     * Computes `number` rounded up to `precision`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.10.0\n     * @category Math\n     * @param {number} number The number to round up.\n     * @param {number} [precision=0] The precision to round up to.\n     * @returns {number} Returns the rounded up number.\n     * @example\n     *\n     * _.ceil(4.006);\n     * // => 5\n     *\n     * _.ceil(6.004, 2);\n     * // => 6.01\n     *\n     * _.ceil(6040, -2);\n     * // => 6100\n     */\n    var ceil = createRound('ceil');\n\n    /**\n     * Divide two numbers.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.7.0\n     * @category Math\n     * @param {number} dividend The first number in a division.\n     * @param {number} divisor The second number in a division.\n     * @returns {number} Returns the quotient.\n     * @example\n     *\n     * _.divide(6, 4);\n     * // => 1.5\n     */\n    var divide = createMathOperation(function(dividend, divisor) {\n      return dividend / divisor;\n    }, 1);\n\n    /**\n     * Computes `number` rounded down to `precision`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.10.0\n     * @category Math\n     * @param {number} number The number to round down.\n     * @param {number} [precision=0] The precision to round down to.\n     * @returns {number} Returns the rounded down number.\n     * @example\n     *\n     * _.floor(4.006);\n     * // => 4\n     *\n     * _.floor(0.046, 2);\n     * // => 0.04\n     *\n     * _.floor(4060, -2);\n     * // => 4000\n     */\n    var floor = createRound('floor');\n\n    /**\n     * Computes the maximum value of `array`. If `array` is empty or falsey,\n     * `undefined` is returned.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @returns {*} Returns the maximum value.\n     * @example\n     *\n     * _.max([4, 2, 8, 6]);\n     * // => 8\n     *\n     * _.max([]);\n     * // => undefined\n     */\n    function max(array) {\n      return (array && array.length)\n        ? baseExtremum(array, identity, baseGt)\n        : undefined;\n    }\n\n    /**\n     * This method is like `_.max` except that it accepts `iteratee` which is\n     * invoked for each element in `array` to generate the criterion by which\n     * the value is ranked. The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {*} Returns the maximum value.\n     * @example\n     *\n     * var objects = [{ 'n': 1 }, { 'n': 2 }];\n     *\n     * _.maxBy(objects, function(o) { return o.n; });\n     * // => { 'n': 2 }\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.maxBy(objects, 'n');\n     * // => { 'n': 2 }\n     */\n    function maxBy(array, iteratee) {\n      return (array && array.length)\n        ? baseExtremum(array, getIteratee(iteratee, 2), baseGt)\n        : undefined;\n    }\n\n    /**\n     * Computes the mean of the values in `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @returns {number} Returns the mean.\n     * @example\n     *\n     * _.mean([4, 2, 8, 6]);\n     * // => 5\n     */\n    function mean(array) {\n      return baseMean(array, identity);\n    }\n\n    /**\n     * This method is like `_.mean` except that it accepts `iteratee` which is\n     * invoked for each element in `array` to generate the value to be averaged.\n     * The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.7.0\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {number} Returns the mean.\n     * @example\n     *\n     * var objects = [{ 'n': 4 }, { 'n': 2 }, { 'n': 8 }, { 'n': 6 }];\n     *\n     * _.meanBy(objects, function(o) { return o.n; });\n     * // => 5\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.meanBy(objects, 'n');\n     * // => 5\n     */\n    function meanBy(array, iteratee) {\n      return baseMean(array, getIteratee(iteratee, 2));\n    }\n\n    /**\n     * Computes the minimum value of `array`. If `array` is empty or falsey,\n     * `undefined` is returned.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @returns {*} Returns the minimum value.\n     * @example\n     *\n     * _.min([4, 2, 8, 6]);\n     * // => 2\n     *\n     * _.min([]);\n     * // => undefined\n     */\n    function min(array) {\n      return (array && array.length)\n        ? baseExtremum(array, identity, baseLt)\n        : undefined;\n    }\n\n    /**\n     * This method is like `_.min` except that it accepts `iteratee` which is\n     * invoked for each element in `array` to generate the criterion by which\n     * the value is ranked. The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {*} Returns the minimum value.\n     * @example\n     *\n     * var objects = [{ 'n': 1 }, { 'n': 2 }];\n     *\n     * _.minBy(objects, function(o) { return o.n; });\n     * // => { 'n': 1 }\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.minBy(objects, 'n');\n     * // => { 'n': 1 }\n     */\n    function minBy(array, iteratee) {\n      return (array && array.length)\n        ? baseExtremum(array, getIteratee(iteratee, 2), baseLt)\n        : undefined;\n    }\n\n    /**\n     * Multiply two numbers.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.7.0\n     * @category Math\n     * @param {number} multiplier The first number in a multiplication.\n     * @param {number} multiplicand The second number in a multiplication.\n     * @returns {number} Returns the product.\n     * @example\n     *\n     * _.multiply(6, 4);\n     * // => 24\n     */\n    var multiply = createMathOperation(function(multiplier, multiplicand) {\n      return multiplier * multiplicand;\n    }, 1);\n\n    /**\n     * Computes `number` rounded to `precision`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.10.0\n     * @category Math\n     * @param {number} number The number to round.\n     * @param {number} [precision=0] The precision to round to.\n     * @returns {number} Returns the rounded number.\n     * @example\n     *\n     * _.round(4.006);\n     * // => 4\n     *\n     * _.round(4.006, 2);\n     * // => 4.01\n     *\n     * _.round(4060, -2);\n     * // => 4100\n     */\n    var round = createRound('round');\n\n    /**\n     * Subtract two numbers.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Math\n     * @param {number} minuend The first number in a subtraction.\n     * @param {number} subtrahend The second number in a subtraction.\n     * @returns {number} Returns the difference.\n     * @example\n     *\n     * _.subtract(6, 4);\n     * // => 2\n     */\n    var subtract = createMathOperation(function(minuend, subtrahend) {\n      return minuend - subtrahend;\n    }, 0);\n\n    /**\n     * Computes the sum of the values in `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.4.0\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @returns {number} Returns the sum.\n     * @example\n     *\n     * _.sum([4, 2, 8, 6]);\n     * // => 20\n     */\n    function sum(array) {\n      return (array && array.length)\n        ? baseSum(array, identity)\n        : 0;\n    }\n\n    /**\n     * This method is like `_.sum` except that it accepts `iteratee` which is\n     * invoked for each element in `array` to generate the value to be summed.\n     * The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {number} Returns the sum.\n     * @example\n     *\n     * var objects = [{ 'n': 4 }, { 'n': 2 }, { 'n': 8 }, { 'n': 6 }];\n     *\n     * _.sumBy(objects, function(o) { return o.n; });\n     * // => 20\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.sumBy(objects, 'n');\n     * // => 20\n     */\n    function sumBy(array, iteratee) {\n      return (array && array.length)\n        ? baseSum(array, getIteratee(iteratee, 2))\n        : 0;\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    // Add methods that return wrapped values in chain sequences.\n    lodash.after = after;\n    lodash.ary = ary;\n    lodash.assign = assign;\n    lodash.assignIn = assignIn;\n    lodash.assignInWith = assignInWith;\n    lodash.assignWith = assignWith;\n    lodash.at = at;\n    lodash.before = before;\n    lodash.bind = bind;\n    lodash.bindAll = bindAll;\n    lodash.bindKey = bindKey;\n    lodash.castArray = castArray;\n    lodash.chain = chain;\n    lodash.chunk = chunk;\n    lodash.compact = compact;\n    lodash.concat = concat;\n    lodash.cond = cond;\n    lodash.conforms = conforms;\n    lodash.constant = constant;\n    lodash.countBy = countBy;\n    lodash.create = create;\n    lodash.curry = curry;\n    lodash.curryRight = curryRight;\n    lodash.debounce = debounce;\n    lodash.defaults = defaults;\n    lodash.defaultsDeep = defaultsDeep;\n    lodash.defer = defer;\n    lodash.delay = delay;\n    lodash.difference = difference;\n    lodash.differenceBy = differenceBy;\n    lodash.differenceWith = differenceWith;\n    lodash.drop = drop;\n    lodash.dropRight = dropRight;\n    lodash.dropRightWhile = dropRightWhile;\n    lodash.dropWhile = dropWhile;\n    lodash.fill = fill;\n    lodash.filter = filter;\n    lodash.flatMap = flatMap;\n    lodash.flatMapDeep = flatMapDeep;\n    lodash.flatMapDepth = flatMapDepth;\n    lodash.flatten = flatten;\n    lodash.flattenDeep = flattenDeep;\n    lodash.flattenDepth = flattenDepth;\n    lodash.flip = flip;\n    lodash.flow = flow;\n    lodash.flowRight = flowRight;\n    lodash.fromPairs = fromPairs;\n    lodash.functions = functions;\n    lodash.functionsIn = functionsIn;\n    lodash.groupBy = groupBy;\n    lodash.initial = initial;\n    lodash.intersection = intersection;\n    lodash.intersectionBy = intersectionBy;\n    lodash.intersectionWith = intersectionWith;\n    lodash.invert = invert;\n    lodash.invertBy = invertBy;\n    lodash.invokeMap = invokeMap;\n    lodash.iteratee = iteratee;\n    lodash.keyBy = keyBy;\n    lodash.keys = keys;\n    lodash.keysIn = keysIn;\n    lodash.map = map;\n    lodash.mapKeys = mapKeys;\n    lodash.mapValues = mapValues;\n    lodash.matches = matches;\n    lodash.matchesProperty = matchesProperty;\n    lodash.memoize = memoize;\n    lodash.merge = merge;\n    lodash.mergeWith = mergeWith;\n    lodash.method = method;\n    lodash.methodOf = methodOf;\n    lodash.mixin = mixin;\n    lodash.negate = negate;\n    lodash.nthArg = nthArg;\n    lodash.omit = omit;\n    lodash.omitBy = omitBy;\n    lodash.once = once;\n    lodash.orderBy = orderBy;\n    lodash.over = over;\n    lodash.overArgs = overArgs;\n    lodash.overEvery = overEvery;\n    lodash.overSome = overSome;\n    lodash.partial = partial;\n    lodash.partialRight = partialRight;\n    lodash.partition = partition;\n    lodash.pick = pick;\n    lodash.pickBy = pickBy;\n    lodash.property = property;\n    lodash.propertyOf = propertyOf;\n    lodash.pull = pull;\n    lodash.pullAll = pullAll;\n    lodash.pullAllBy = pullAllBy;\n    lodash.pullAllWith = pullAllWith;\n    lodash.pullAt = pullAt;\n    lodash.range = range;\n    lodash.rangeRight = rangeRight;\n    lodash.rearg = rearg;\n    lodash.reject = reject;\n    lodash.remove = remove;\n    lodash.rest = rest;\n    lodash.reverse = reverse;\n    lodash.sampleSize = sampleSize;\n    lodash.set = set;\n    lodash.setWith = setWith;\n    lodash.shuffle = shuffle;\n    lodash.slice = slice;\n    lodash.sortBy = sortBy;\n    lodash.sortedUniq = sortedUniq;\n    lodash.sortedUniqBy = sortedUniqBy;\n    lodash.split = split;\n    lodash.spread = spread;\n    lodash.tail = tail;\n    lodash.take = take;\n    lodash.takeRight = takeRight;\n    lodash.takeRightWhile = takeRightWhile;\n    lodash.takeWhile = takeWhile;\n    lodash.tap = tap;\n    lodash.throttle = throttle;\n    lodash.thru = thru;\n    lodash.toArray = toArray;\n    lodash.toPairs = toPairs;\n    lodash.toPairsIn = toPairsIn;\n    lodash.toPath = toPath;\n    lodash.toPlainObject = toPlainObject;\n    lodash.transform = transform;\n    lodash.unary = unary;\n    lodash.union = union;\n    lodash.unionBy = unionBy;\n    lodash.unionWith = unionWith;\n    lodash.uniq = uniq;\n    lodash.uniqBy = uniqBy;\n    lodash.uniqWith = uniqWith;\n    lodash.unset = unset;\n    lodash.unzip = unzip;\n    lodash.unzipWith = unzipWith;\n    lodash.update = update;\n    lodash.updateWith = updateWith;\n    lodash.values = values;\n    lodash.valuesIn = valuesIn;\n    lodash.without = without;\n    lodash.words = words;\n    lodash.wrap = wrap;\n    lodash.xor = xor;\n    lodash.xorBy = xorBy;\n    lodash.xorWith = xorWith;\n    lodash.zip = zip;\n    lodash.zipObject = zipObject;\n    lodash.zipObjectDeep = zipObjectDeep;\n    lodash.zipWith = zipWith;\n\n    // Add aliases.\n    lodash.entries = toPairs;\n    lodash.entriesIn = toPairsIn;\n    lodash.extend = assignIn;\n    lodash.extendWith = assignInWith;\n\n    // Add methods to `lodash.prototype`.\n    mixin(lodash, lodash);\n\n    /*------------------------------------------------------------------------*/\n\n    // Add methods that return unwrapped values in chain sequences.\n    lodash.add = add;\n    lodash.attempt = attempt;\n    lodash.camelCase = camelCase;\n    lodash.capitalize = capitalize;\n    lodash.ceil = ceil;\n    lodash.clamp = clamp;\n    lodash.clone = clone;\n    lodash.cloneDeep = cloneDeep;\n    lodash.cloneDeepWith = cloneDeepWith;\n    lodash.cloneWith = cloneWith;\n    lodash.conformsTo = conformsTo;\n    lodash.deburr = deburr;\n    lodash.defaultTo = defaultTo;\n    lodash.divide = divide;\n    lodash.endsWith = endsWith;\n    lodash.eq = eq;\n    lodash.escape = escape;\n    lodash.escapeRegExp = escapeRegExp;\n    lodash.every = every;\n    lodash.find = find;\n    lodash.findIndex = findIndex;\n    lodash.findKey = findKey;\n    lodash.findLast = findLast;\n    lodash.findLastIndex = findLastIndex;\n    lodash.findLastKey = findLastKey;\n    lodash.floor = floor;\n    lodash.forEach = forEach;\n    lodash.forEachRight = forEachRight;\n    lodash.forIn = forIn;\n    lodash.forInRight = forInRight;\n    lodash.forOwn = forOwn;\n    lodash.forOwnRight = forOwnRight;\n    lodash.get = get;\n    lodash.gt = gt;\n    lodash.gte = gte;\n    lodash.has = has;\n    lodash.hasIn = hasIn;\n    lodash.head = head;\n    lodash.identity = identity;\n    lodash.includes = includes;\n    lodash.indexOf = indexOf;\n    lodash.inRange = inRange;\n    lodash.invoke = invoke;\n    lodash.isArguments = isArguments;\n    lodash.isArray = isArray;\n    lodash.isArrayBuffer = isArrayBuffer;\n    lodash.isArrayLike = isArrayLike;\n    lodash.isArrayLikeObject = isArrayLikeObject;\n    lodash.isBoolean = isBoolean;\n    lodash.isBuffer = isBuffer;\n    lodash.isDate = isDate;\n    lodash.isElement = isElement;\n    lodash.isEmpty = isEmpty;\n    lodash.isEqual = isEqual;\n    lodash.isEqualWith = isEqualWith;\n    lodash.isError = isError;\n    lodash.isFinite = isFinite;\n    lodash.isFunction = isFunction;\n    lodash.isInteger = isInteger;\n    lodash.isLength = isLength;\n    lodash.isMap = isMap;\n    lodash.isMatch = isMatch;\n    lodash.isMatchWith = isMatchWith;\n    lodash.isNaN = isNaN;\n    lodash.isNative = isNative;\n    lodash.isNil = isNil;\n    lodash.isNull = isNull;\n    lodash.isNumber = isNumber;\n    lodash.isObject = isObject;\n    lodash.isObjectLike = isObjectLike;\n    lodash.isPlainObject = isPlainObject;\n    lodash.isRegExp = isRegExp;\n    lodash.isSafeInteger = isSafeInteger;\n    lodash.isSet = isSet;\n    lodash.isString = isString;\n    lodash.isSymbol = isSymbol;\n    lodash.isTypedArray = isTypedArray;\n    lodash.isUndefined = isUndefined;\n    lodash.isWeakMap = isWeakMap;\n    lodash.isWeakSet = isWeakSet;\n    lodash.join = join;\n    lodash.kebabCase = kebabCase;\n    lodash.last = last;\n    lodash.lastIndexOf = lastIndexOf;\n    lodash.lowerCase = lowerCase;\n    lodash.lowerFirst = lowerFirst;\n    lodash.lt = lt;\n    lodash.lte = lte;\n    lodash.max = max;\n    lodash.maxBy = maxBy;\n    lodash.mean = mean;\n    lodash.meanBy = meanBy;\n    lodash.min = min;\n    lodash.minBy = minBy;\n    lodash.stubArray = stubArray;\n    lodash.stubFalse = stubFalse;\n    lodash.stubObject = stubObject;\n    lodash.stubString = stubString;\n    lodash.stubTrue = stubTrue;\n    lodash.multiply = multiply;\n    lodash.nth = nth;\n    lodash.noConflict = noConflict;\n    lodash.noop = noop;\n    lodash.now = now;\n    lodash.pad = pad;\n    lodash.padEnd = padEnd;\n    lodash.padStart = padStart;\n    lodash.parseInt = parseInt;\n    lodash.random = random;\n    lodash.reduce = reduce;\n    lodash.reduceRight = reduceRight;\n    lodash.repeat = repeat;\n    lodash.replace = replace;\n    lodash.result = result;\n    lodash.round = round;\n    lodash.runInContext = runInContext;\n    lodash.sample = sample;\n    lodash.size = size;\n    lodash.snakeCase = snakeCase;\n    lodash.some = some;\n    lodash.sortedIndex = sortedIndex;\n    lodash.sortedIndexBy = sortedIndexBy;\n    lodash.sortedIndexOf = sortedIndexOf;\n    lodash.sortedLastIndex = sortedLastIndex;\n    lodash.sortedLastIndexBy = sortedLastIndexBy;\n    lodash.sortedLastIndexOf = sortedLastIndexOf;\n    lodash.startCase = startCase;\n    lodash.startsWith = startsWith;\n    lodash.subtract = subtract;\n    lodash.sum = sum;\n    lodash.sumBy = sumBy;\n    lodash.template = template;\n    lodash.times = times;\n    lodash.toFinite = toFinite;\n    lodash.toInteger = toInteger;\n    lodash.toLength = toLength;\n    lodash.toLower = toLower;\n    lodash.toNumber = toNumber;\n    lodash.toSafeInteger = toSafeInteger;\n    lodash.toString = toString;\n    lodash.toUpper = toUpper;\n    lodash.trim = trim;\n    lodash.trimEnd = trimEnd;\n    lodash.trimStart = trimStart;\n    lodash.truncate = truncate;\n    lodash.unescape = unescape;\n    lodash.uniqueId = uniqueId;\n    lodash.upperCase = upperCase;\n    lodash.upperFirst = upperFirst;\n\n    // Add aliases.\n    lodash.each = forEach;\n    lodash.eachRight = forEachRight;\n    lodash.first = head;\n\n    mixin(lodash, (function() {\n      var source = {};\n      baseForOwn(lodash, function(func, methodName) {\n        if (!hasOwnProperty.call(lodash.prototype, methodName)) {\n          source[methodName] = func;\n        }\n      });\n      return source;\n    }()), { 'chain': false });\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * The semantic version number.\n     *\n     * @static\n     * @memberOf _\n     * @type {string}\n     */\n    lodash.VERSION = VERSION;\n\n    // Assign default placeholders.\n    arrayEach(['bind', 'bindKey', 'curry', 'curryRight', 'partial', 'partialRight'], function(methodName) {\n      lodash[methodName].placeholder = lodash;\n    });\n\n    // Add `LazyWrapper` methods for `_.drop` and `_.take` variants.\n    arrayEach(['drop', 'take'], function(methodName, index) {\n      LazyWrapper.prototype[methodName] = function(n) {\n        n = n === undefined ? 1 : nativeMax(toInteger(n), 0);\n\n        var result = (this.__filtered__ && !index)\n          ? new LazyWrapper(this)\n          : this.clone();\n\n        if (result.__filtered__) {\n          result.__takeCount__ = nativeMin(n, result.__takeCount__);\n        } else {\n          result.__views__.push({\n            'size': nativeMin(n, MAX_ARRAY_LENGTH),\n            'type': methodName + (result.__dir__ < 0 ? 'Right' : '')\n          });\n        }\n        return result;\n      };\n\n      LazyWrapper.prototype[methodName + 'Right'] = function(n) {\n        return this.reverse()[methodName](n).reverse();\n      };\n    });\n\n    // Add `LazyWrapper` methods that accept an `iteratee` value.\n    arrayEach(['filter', 'map', 'takeWhile'], function(methodName, index) {\n      var type = index + 1,\n          isFilter = type == LAZY_FILTER_FLAG || type == LAZY_WHILE_FLAG;\n\n      LazyWrapper.prototype[methodName] = function(iteratee) {\n        var result = this.clone();\n        result.__iteratees__.push({\n          'iteratee': getIteratee(iteratee, 3),\n          'type': type\n        });\n        result.__filtered__ = result.__filtered__ || isFilter;\n        return result;\n      };\n    });\n\n    // Add `LazyWrapper` methods for `_.head` and `_.last`.\n    arrayEach(['head', 'last'], function(methodName, index) {\n      var takeName = 'take' + (index ? 'Right' : '');\n\n      LazyWrapper.prototype[methodName] = function() {\n        return this[takeName](1).value()[0];\n      };\n    });\n\n    // Add `LazyWrapper` methods for `_.initial` and `_.tail`.\n    arrayEach(['initial', 'tail'], function(methodName, index) {\n      var dropName = 'drop' + (index ? '' : 'Right');\n\n      LazyWrapper.prototype[methodName] = function() {\n        return this.__filtered__ ? new LazyWrapper(this) : this[dropName](1);\n      };\n    });\n\n    LazyWrapper.prototype.compact = function() {\n      return this.filter(identity);\n    };\n\n    LazyWrapper.prototype.find = function(predicate) {\n      return this.filter(predicate).head();\n    };\n\n    LazyWrapper.prototype.findLast = function(predicate) {\n      return this.reverse().find(predicate);\n    };\n\n    LazyWrapper.prototype.invokeMap = baseRest(function(path, args) {\n      if (typeof path == 'function') {\n        return new LazyWrapper(this);\n      }\n      return this.map(function(value) {\n        return baseInvoke(value, path, args);\n      });\n    });\n\n    LazyWrapper.prototype.reject = function(predicate) {\n      return this.filter(negate(getIteratee(predicate)));\n    };\n\n    LazyWrapper.prototype.slice = function(start, end) {\n      start = toInteger(start);\n\n      var result = this;\n      if (result.__filtered__ && (start > 0 || end < 0)) {\n        return new LazyWrapper(result);\n      }\n      if (start < 0) {\n        result = result.takeRight(-start);\n      } else if (start) {\n        result = result.drop(start);\n      }\n      if (end !== undefined) {\n        end = toInteger(end);\n        result = end < 0 ? result.dropRight(-end) : result.take(end - start);\n      }\n      return result;\n    };\n\n    LazyWrapper.prototype.takeRightWhile = function(predicate) {\n      return this.reverse().takeWhile(predicate).reverse();\n    };\n\n    LazyWrapper.prototype.toArray = function() {\n      return this.take(MAX_ARRAY_LENGTH);\n    };\n\n    // Add `LazyWrapper` methods to `lodash.prototype`.\n    baseForOwn(LazyWrapper.prototype, function(func, methodName) {\n      var checkIteratee = /^(?:filter|find|map|reject)|While$/.test(methodName),\n          isTaker = /^(?:head|last)$/.test(methodName),\n          lodashFunc = lodash[isTaker ? ('take' + (methodName == 'last' ? 'Right' : '')) : methodName],\n          retUnwrapped = isTaker || /^find/.test(methodName);\n\n      if (!lodashFunc) {\n        return;\n      }\n      lodash.prototype[methodName] = function() {\n        var value = this.__wrapped__,\n            args = isTaker ? [1] : arguments,\n            isLazy = value instanceof LazyWrapper,\n            iteratee = args[0],\n            useLazy = isLazy || isArray(value);\n\n        var interceptor = function(value) {\n          var result = lodashFunc.apply(lodash, arrayPush([value], args));\n          return (isTaker && chainAll) ? result[0] : result;\n        };\n\n        if (useLazy && checkIteratee && typeof iteratee == 'function' && iteratee.length != 1) {\n          // Avoid lazy use if the iteratee has a \"length\" value other than `1`.\n          isLazy = useLazy = false;\n        }\n        var chainAll = this.__chain__,\n            isHybrid = !!this.__actions__.length,\n            isUnwrapped = retUnwrapped && !chainAll,\n            onlyLazy = isLazy && !isHybrid;\n\n        if (!retUnwrapped && useLazy) {\n          value = onlyLazy ? value : new LazyWrapper(this);\n          var result = func.apply(value, args);\n          result.__actions__.push({ 'func': thru, 'args': [interceptor], 'thisArg': undefined });\n          return new LodashWrapper(result, chainAll);\n        }\n        if (isUnwrapped && onlyLazy) {\n          return func.apply(this, args);\n        }\n        result = this.thru(interceptor);\n        return isUnwrapped ? (isTaker ? result.value()[0] : result.value()) : result;\n      };\n    });\n\n    // Add `Array` methods to `lodash.prototype`.\n    arrayEach(['pop', 'push', 'shift', 'sort', 'splice', 'unshift'], function(methodName) {\n      var func = arrayProto[methodName],\n          chainName = /^(?:push|sort|unshift)$/.test(methodName) ? 'tap' : 'thru',\n          retUnwrapped = /^(?:pop|shift)$/.test(methodName);\n\n      lodash.prototype[methodName] = function() {\n        var args = arguments;\n        if (retUnwrapped && !this.__chain__) {\n          var value = this.value();\n          return func.apply(isArray(value) ? value : [], args);\n        }\n        return this[chainName](function(value) {\n          return func.apply(isArray(value) ? value : [], args);\n        });\n      };\n    });\n\n    // Map minified method names to their real names.\n    baseForOwn(LazyWrapper.prototype, function(func, methodName) {\n      var lodashFunc = lodash[methodName];\n      if (lodashFunc) {\n        var key = lodashFunc.name + '';\n        if (!hasOwnProperty.call(realNames, key)) {\n          realNames[key] = [];\n        }\n        realNames[key].push({ 'name': methodName, 'func': lodashFunc });\n      }\n    });\n\n    realNames[createHybrid(undefined, WRAP_BIND_KEY_FLAG).name] = [{\n      'name': 'wrapper',\n      'func': undefined\n    }];\n\n    // Add methods to `LazyWrapper`.\n    LazyWrapper.prototype.clone = lazyClone;\n    LazyWrapper.prototype.reverse = lazyReverse;\n    LazyWrapper.prototype.value = lazyValue;\n\n    // Add chain sequence methods to the `lodash` wrapper.\n    lodash.prototype.at = wrapperAt;\n    lodash.prototype.chain = wrapperChain;\n    lodash.prototype.commit = wrapperCommit;\n    lodash.prototype.next = wrapperNext;\n    lodash.prototype.plant = wrapperPlant;\n    lodash.prototype.reverse = wrapperReverse;\n    lodash.prototype.toJSON = lodash.prototype.valueOf = lodash.prototype.value = wrapperValue;\n\n    // Add lazy aliases.\n    lodash.prototype.first = lodash.prototype.head;\n\n    if (symIterator) {\n      lodash.prototype[symIterator] = wrapperToIterator;\n    }\n    return lodash;\n  });\n\n  /*--------------------------------------------------------------------------*/\n\n  // Export lodash.\n  var _ = runInContext();\n\n  // Some AMD build optimizers, like r.js, check for condition patterns like:\n  if (typeof define == 'function' && typeof define.amd == 'object' && define.amd) {\n    // Expose Lodash on the global object to prevent errors when Lodash is\n    // loaded by a script tag in the presence of an AMD loader.\n    // See http://requirejs.org/docs/errors.html#mismatch for more details.\n    // Use `_.noConflict` to remove Lodash from the global object.\n    root._ = _;\n\n    // Define as an anonymous module so, through path mapping, it can be\n    // referenced as the \"underscore\" module.\n    define(function() {\n      return _;\n    });\n  }\n  // Check for `exports` after `define` in case a build optimizer adds it.\n  else if (freeModule) {\n    // Export for Node.js.\n    (freeModule.exports = _)._ = _;\n    // Export for CommonJS support.\n    freeExports._ = _;\n  }\n  else {\n    // Export to the global object.\n    root._ = _;\n  }\n}.call(this));\n","import type { FC, VirtualElement } from '../../lib/teact/teact';\nimport { useLayoutEffect, useRef } from '../../lib/teact/teact';\nimport TeactDOM from '../../lib/teact/teact-dom';\n\ntype OwnProps = {\n  containerSelector?: string;\n  className?: string;\n  children: VirtualElement;\n};\n\nconst Portal: FC<OwnProps> = ({ containerSelector, className, children }) => {\n  const elementRef = useRef<HTMLDivElement>();\n  if (!elementRef.current) {\n    elementRef.current = document.createElement('div');\n  }\n\n  useLayoutEffect(() => {\n    const container = document.querySelector<HTMLDivElement>(containerSelector || '#portals');\n    if (!container) {\n      return undefined;\n    }\n\n    const element = elementRef.current!;\n    if (className) {\n      element.classList.add(className);\n    }\n\n    container.appendChild(element);\n\n    return () => {\n      TeactDOM.render(undefined, element);\n      container.removeChild(element);\n    };\n  }, [className, containerSelector]);\n\n  return TeactDOM.render(children, elementRef.current);\n};\n\nexport default Portal;\n","import type { TeactNode } from '../../lib/teact/teact';\n\nimport type {\n  ApiMediaExtendedPreview, ApiMessage, MediaContent, StatefulMediaContent,\n} from '../../api/types';\nimport type { OldLangFn } from '../../hooks/useOldLang';\nimport { ApiMessageEntityTypes } from '../../api/types';\n\nimport { CONTENT_NOT_SUPPORTED } from '../../config';\nimport trimText from '../../util/trimText';\nimport { renderTextWithEntities } from '../../components/common/helpers/renderTextWithEntities';\nimport {\n  getMessageText, getMessageTranscription,\n} from './messages';\n\nconst SPOILER_CHARS = ['⠺', '⠵', '⠞', '⠟'];\nexport const TRUNCATED_SUMMARY_LENGTH = 80;\n\nexport function getMessageSummaryText(\n  lang: OldLangFn,\n  message: ApiMessage,\n  statefulContent: StatefulMediaContent | undefined,\n  noEmoji = false,\n  truncateLength = TRUNCATED_SUMMARY_LENGTH,\n  isExtended = false,\n) {\n  const emoji = !noEmoji && getMessageSummaryEmoji(message);\n  const emojiWithSpace = emoji ? `${emoji} ` : '';\n  const text = trimText(getMessageTextWithSpoilers(message, statefulContent), truncateLength);\n  const description = getMessageSummaryDescription(lang, message, statefulContent, text, isExtended);\n\n  return `${emojiWithSpace}${description}`;\n}\n\nexport function getMessageTextWithSpoilers(message: ApiMessage, statefulContent: StatefulMediaContent | undefined) {\n  const transcription = getMessageTranscription(message);\n\n  const textWithoutTranscription = getMessageText(statefulContent?.story || message)?.text;\n  if (!textWithoutTranscription) {\n    return transcription;\n  }\n\n  const { entities } = message.content.text || {};\n  if (!entities?.length) {\n    return transcription ? `${transcription}\\n${textWithoutTranscription}` : textWithoutTranscription;\n  }\n\n  const text = entities.reduce((accText, {\n    type,\n    offset,\n    length,\n  }) => {\n    if (type !== ApiMessageEntityTypes.Spoiler) {\n      return accText;\n    }\n\n    const spoiler = generateBrailleSpoiler(length);\n\n    return `${accText.substr(0, offset)}${spoiler}${accText.substr(offset + length, accText.length)}`;\n  }, textWithoutTranscription);\n\n  return transcription ? `${transcription}\\n${text}` : text;\n}\n\nexport function getMessageSummaryEmoji(message: ApiMessage) {\n  const {\n    photo,\n    video,\n    audio,\n    voice,\n    document,\n    sticker,\n    pollId,\n    paidMedia,\n  } = message.content;\n\n  if (message.groupedId || photo || paidMedia) {\n    return '🖼';\n  }\n\n  if (video) {\n    return '📹';\n  }\n\n  if (sticker) {\n    return sticker.emoji;\n  }\n\n  if (audio) {\n    return '🎧';\n  }\n\n  if (voice) {\n    return '🎤';\n  }\n\n  if (document) {\n    return '📎';\n  }\n\n  if (pollId) {\n    return '📊';\n  }\n\n  return undefined;\n}\n\nexport function getMediaContentTypeDescription(\n  lang: OldLangFn, content: MediaContent, statefulContent: StatefulMediaContent | undefined,\n) {\n  return getSummaryDescription(lang, content, statefulContent);\n}\nexport function getMessageSummaryDescription(\n  lang: OldLangFn,\n  message: ApiMessage,\n  statefulContent: StatefulMediaContent | undefined,\n  truncatedText?: string | TeactNode,\n  isExtended = false,\n) {\n  return getSummaryDescription(lang, message.content, statefulContent, message, truncatedText, isExtended);\n}\nfunction getSummaryDescription(\n  lang: OldLangFn,\n  mediaContent: MediaContent,\n  statefulContent: StatefulMediaContent | undefined,\n  message?: ApiMessage,\n  truncatedText?: string | TeactNode,\n  isExtended = false,\n) {\n  const {\n    text,\n    photo,\n    video,\n    audio,\n    voice,\n    document,\n    sticker,\n    contact,\n    invoice,\n    location,\n    game,\n    storyData,\n    giveaway,\n    giveawayResults,\n    paidMedia,\n  } = mediaContent;\n  const { poll } = statefulContent || {};\n\n  let hasUsedTruncatedText = false;\n  let summary: TeactNode | undefined;\n\n  const boughtExtendedMedia = paidMedia?.isBought && paidMedia.extendedMedia;\n  const previewExtendedMedia = paidMedia && !paidMedia.isBought\n    ? paidMedia.extendedMedia as ApiMediaExtendedPreview[] : undefined;\n\n  const isPaidMediaAlbum = paidMedia && paidMedia.extendedMedia.length > 1;\n  const isPaidMediaSingleVideo = !isPaidMediaAlbum\n    && (boughtExtendedMedia?.[0].video || previewExtendedMedia?.[0].duration);\n  const isPaidMediaSinglePhoto = !isPaidMediaAlbum && !isPaidMediaSingleVideo;\n\n  if (message?.groupedId || isPaidMediaAlbum) {\n    hasUsedTruncatedText = true;\n    summary = truncatedText || lang('lng_in_dlg_album');\n  }\n\n  if (photo || isPaidMediaSinglePhoto) {\n    hasUsedTruncatedText = true;\n    summary = truncatedText || lang('AttachPhoto');\n  }\n\n  if (video || isPaidMediaSingleVideo) {\n    hasUsedTruncatedText = true;\n    summary = truncatedText || lang(video?.isGif ? 'AttachGif' : 'AttachVideo');\n  }\n\n  if (sticker) {\n    summary = lang('AttachSticker').trim();\n  }\n\n  if (audio) {\n    summary = getMessageAudioCaption(mediaContent) || lang('AttachMusic');\n  }\n\n  if (voice) {\n    hasUsedTruncatedText = true;\n    summary = truncatedText || lang('AttachAudio');\n  }\n\n  if (document) {\n    hasUsedTruncatedText = !isExtended;\n    summary = isExtended ? document.fileName : (truncatedText || document.fileName);\n  }\n\n  if (contact) {\n    summary = lang('AttachContact');\n  }\n\n  if (poll) {\n    summary = renderTextWithEntities({\n      text: poll.summary.question.text,\n      entities: poll.summary.question.entities,\n      asPreview: true,\n    });\n  }\n\n  if (invoice) {\n    summary = invoice.extendedMedia ? invoice.title : `${lang('PaymentInvoice')}: ${invoice.description}`;\n  }\n\n  if (text) {\n    if (isExtended && summary && !hasUsedTruncatedText) {\n      summary += `\\n${truncatedText}`;\n    } else {\n      summary = truncatedText;\n    }\n  }\n\n  if (location?.mediaType === 'geo' || location?.mediaType === 'venue') {\n    summary = lang('Message.Location');\n  }\n\n  if (location?.mediaType === 'geoLive') {\n    summary = lang('Message.LiveLocation');\n  }\n\n  if (game) {\n    summary = `🎮 ${game.title}`;\n  }\n\n  if (giveaway) {\n    summary = lang('BoostingGiveawayChannelStarted');\n  }\n\n  if (giveawayResults) {\n    summary = lang('Message.GiveawayEndedWinners', giveawayResults.winnersCount);\n  }\n\n  if (storyData) {\n    summary = truncatedText || (message ? lang('ForwardedStory') : lang('Chat.ReplyStory'));\n  }\n\n  return summary || CONTENT_NOT_SUPPORTED;\n}\n\nexport function generateBrailleSpoiler(length: number) {\n  return new Array(length)\n    .fill(undefined)\n    .map(() => SPOILER_CHARS[Math.floor(Math.random() * SPOILER_CHARS.length)])\n    .join('');\n}\n\nfunction getMessageAudioCaption(mediaContent: MediaContent) {\n  const {\n    audio,\n    text,\n  } = mediaContent;\n\n  return (audio && [audio.title, audio.performer].filter(Boolean)\n    .join(' — ')) || (text?.text);\n}\n","import { getActions } from '../global';\n\nlet promptInstall: () => Promise<void>;\n\nexport function setupBeforeInstallPrompt() {\n  window.addEventListener('beforeinstallprompt', (e: any) => {\n    promptInstall = async () => {\n      e.prompt();\n      const userChoice = await e.userChoice;\n      const isInstalled = userChoice.outcome === 'accepted';\n\n      if (!isInstalled) return;\n      getActions().setInstallPrompt({ canInstall: false });\n    };\n    getActions().setInstallPrompt({ canInstall: true });\n  });\n}\n\nexport function getPromptInstall() {\n  return promptInstall;\n}\n","import React, { type TeactNode } from '../../../../lib/teact/teact';\nimport { getActions } from '../../../../global';\n\nimport type { ApiMessage } from '../../../../api/types';\nimport type { ApiMessageActionPhoneCall } from '../../../../api/types/messageActions';\nimport type {\n  LangKey,\n  LangPairPluralWithVariables,\n  LangPairWithVariables,\n  PluralLangKeyWithVariables,\n  RegularLangKey,\n  RegularLangKeyWithVariables,\n} from '../../../../types/language';\nimport type { LangFn } from '../../../../util/localization';\n\nimport { getMessageContent } from '../../../../global/helpers';\nimport { IS_SAFARI } from '../../../../util/browser/windowEnvironment';\nimport buildClassName from '../../../../util/buildClassName';\nimport renderText from '../../../common/helpers/renderText';\n\nimport Link from '../../../ui/Link';\n\nimport styles from '../ActionMessage.module.scss';\n\ntype SuffixKey<T, K extends keyof T> = `${K & string}You` extends keyof T ? T[`${K & string}You`] : never;\ntype VariablesForKey<K extends LangKey> =\n  K extends RegularLangKeyWithVariables\n    ? LangPairWithVariables<TeactNode | undefined>[K] | SuffixKey<LangPairWithVariables, K>\n    : K extends PluralLangKeyWithVariables\n      ? LangPairPluralWithVariables<TeactNode | undefined>[K] | SuffixKey<LangPairPluralWithVariables, K>\n      : undefined;\n\nexport function translateWithYou<K extends LangKey>(\n  lang: LangFn,\n  key: K,\n  isYou: boolean,\n  variables: VariablesForKey<K>,\n  options?: { pluralValue?: number; asText?: boolean; isMarkdown?: boolean },\n): TeactNode {\n  const { pluralValue, asText, isMarkdown } = options || {};\n  const translationKey = isYou ? (`${key}You` as LangKey) : key;\n\n  return lang(\n    // @ts-ignore -- I have no idea if this even possible to type correctly\n    translationKey,\n    variables,\n    { withNodes: !asText, isMarkdown, pluralValue },\n  );\n}\n\nexport function getPinnedMediaValue(lang: LangFn, message: ApiMessage) {\n  const {\n    audio, contact, document, game, giveaway, giveawayResults, paidMedia, storyData,\n    invoice, location, photo, pollId, sticker, video, voice,\n  } = getMessageContent(message);\n\n  if (message.groupedId || paidMedia) return lang('ActionPinnedMediaAlbum');\n  if (photo) return lang('ActionPinnedMediaPhoto');\n  if (audio) return lang('ActionPinnedMediaAudio');\n  if (voice) return lang('ActionPinnedMediaVoice');\n  if (video?.isRound) return lang('ActionPinnedMediaVideoMessage');\n  if (video?.isGif) return lang('ActionPinnedMediaGif');\n  if (video) return lang('ActionPinnedMediaVideo');\n  if (sticker) return lang('ActionPinnedMediaSticker');\n  if (document) return lang('ActionPinnedMediaFile');\n  if (contact) return lang('ActionPinnedMediaContact');\n  if (location) return lang('ActionPinnedMediaLocation');\n  if (storyData) return lang('ActionPinnedMediaStory');\n  if (invoice) return lang('ActionPinnedMediaInvoice');\n  if (game) return lang('ActionPinnedMediaGame', { game: game.title });\n  if (pollId) return lang('ActionPinnedMediaPoll');\n  if (giveaway) return lang('ActionPinnedMediaGiveaway');\n  if (giveawayResults) return lang('ActionPinnedMediaGiveawayResults');\n\n  return undefined;\n}\n\nexport function renderPeerLink(peerId: string | undefined, text: string, asPreview?: boolean) {\n  if (!peerId || asPreview) {\n    return renderText(text);\n  }\n\n  return (\n    <Link\n      className={buildClassName(styles.peerLink, styles.strong)}\n      // eslint-disable-next-line react/jsx-no-bind\n      onClick={(e) => {\n        e.stopPropagation();\n        getActions().openChat({ id: peerId });\n      }}\n      // box-decoration-break: clone; is broken when child has `dir` attribute\n      withMultilineFix={IS_SAFARI}\n    >\n      {renderText(text)}\n    </Link>\n  );\n}\n\nexport function renderMessageLink(targetMessage: ApiMessage, text: TeactNode, asPreview?: boolean) {\n  if (asPreview) return text;\n  return (\n    <Link\n      className={styles.messageLink}\n      // eslint-disable-next-line react/jsx-no-bind\n      onClick={(e) => {\n        e.stopPropagation();\n        getActions().focusMessage({ chatId: targetMessage.chatId, messageId: targetMessage.id });\n      }}\n      withMultilineFix={IS_SAFARI}\n    >\n      {text}\n    </Link>\n  );\n}\n\nexport function getCallMessageKey(action: ApiMessageActionPhoneCall, isOutgoing: boolean): RegularLangKey {\n  const isMissed = action.reason === 'missed';\n  const isCancelled = action.reason === 'busy' || action.duration === undefined;\n  if (action.isVideo) {\n    if (isMissed) return isOutgoing ? 'CallMessageVideoOutgoingMissed' : 'CallMessageVideoIncomingMissed';\n    if (isCancelled) return 'CallMessageVideoIncomingDeclined';\n\n    return isOutgoing ? 'CallMessageVideoOutgoing' : 'CallMessageVideoIncoming';\n  } else {\n    if (isMissed) return isOutgoing ? 'CallMessageOutgoingMissed' : 'CallMessageIncomingMissed';\n    if (isCancelled) return 'CallMessageIncomingDeclined';\n\n    return isOutgoing ? 'CallMessageOutgoing' : 'CallMessageIncoming';\n  }\n}\n","import type { AccountInfo, SessionUserInfo, SharedSessionData } from '../types';\n\nimport {\n  ACCOUNT_QUERY,\n  DATA_BROADCAST_CHANNEL_PREFIX,\n  ESTABLISH_BROADCAST_CHANNEL_PREFIX,\n  GLOBAL_STATE_CACHE_PREFIX,\n  MULTIACCOUNT_MAX_SLOTS,\n  MULTITAB_LOCALSTORAGE_KEY_PREFIX,\n  SESSION_ACCOUNT_PREFIX,\n} from '../config';\nimport { IS_MULTIACCOUNT_SUPPORTED } from './browser/globalEnvironment';\n\nconst WORKER_NAME = typeof WorkerGlobalScope !== 'undefined' && globalThis.self instanceof WorkerGlobalScope\n  ? globalThis.self.name : undefined;\nconst WORKER_ACCOUNT_SLOT = WORKER_NAME ? Number(new URLSearchParams(WORKER_NAME).get(ACCOUNT_QUERY)) : undefined;\n\nexport const ACCOUNT_SLOT = WORKER_ACCOUNT_SLOT || (\n  IS_MULTIACCOUNT_SUPPORTED ? getAccountSlot(globalThis.location.href) : undefined\n);\n\nexport const DATA_BROADCAST_CHANNEL_NAME = `${DATA_BROADCAST_CHANNEL_PREFIX}_${ACCOUNT_SLOT || 1}`;\nexport const ESTABLISH_BROADCAST_CHANNEL_NAME = `${ESTABLISH_BROADCAST_CHANNEL_PREFIX}_${ACCOUNT_SLOT || 1}`;\nexport const MULTITAB_STORAGE_KEY = `${MULTITAB_LOCALSTORAGE_KEY_PREFIX}_${ACCOUNT_SLOT || 1}`;\nexport const GLOBAL_STATE_CACHE_KEY = ACCOUNT_SLOT\n  ? `${GLOBAL_STATE_CACHE_PREFIX}_${ACCOUNT_SLOT}` : GLOBAL_STATE_CACHE_PREFIX;\n\nexport function getAccountSlot(url: string) {\n  const params = new URL(url).searchParams;\n  const slot = params.get(ACCOUNT_QUERY);\n  const slotNumber = slot ? Number(slot) : 1;\n  if (!slotNumber || Number.isNaN(slotNumber) || slotNumber === 1) return undefined;\n  return slotNumber;\n}\n\nexport function getAccountsInfo() {\n  if (!IS_MULTIACCOUNT_SUPPORTED) return {};\n  const accountInfo: Record<number, AccountInfo> = {};\n  for (let i = 1; i <= MULTIACCOUNT_MAX_SLOTS; i++) {\n    const info = getAccountInfo(i);\n    if (info) {\n      accountInfo[i] = info;\n    }\n  }\n  return accountInfo;\n}\n\nfunction getAccountInfo(slot: number): AccountInfo | undefined {\n  const sessionData = loadSlotSession(slot);\n  const {\n    userId, avatarUri, color, emojiStatusId, firstName, lastName, isPremium, isTest, phone,\n  } = sessionData || {};\n\n  if (!userId) return undefined;\n\n  return {\n    userId,\n    avatarUri,\n    color,\n    emojiStatusId,\n    firstName,\n    lastName,\n    isPremium,\n    isTest,\n    phone,\n  };\n}\n\nexport function loadSlotSession(slot: number | undefined): SharedSessionData | undefined {\n  try {\n    const data = JSON.parse(localStorage.getItem(`${SESSION_ACCOUNT_PREFIX}${slot || 1}`) || '{}') as SharedSessionData;\n    if (!data.dcId) return undefined;\n    return data;\n  } catch (e) {\n    return undefined;\n  }\n}\n\nexport function storeAccountData(slot: number | undefined, data: Partial<SessionUserInfo>) {\n  const currentSlotData = loadSlotSession(slot);\n\n  if (!currentSlotData) return;\n\n  const updatedSharedData: SharedSessionData = {\n    ...currentSlotData,\n    ...data,\n  };\n\n  if (!updatedSharedData.userId) return;\n\n  writeSlotSession(slot, updatedSharedData);\n}\n\nexport function writeSlotSession(slot: number | undefined, data: SharedSessionData) {\n  localStorage.setItem(`${SESSION_ACCOUNT_PREFIX}${slot || 1}`, JSON.stringify(data));\n}\n\nexport function getAccountSlotUrl(slot: number, forLogin?: boolean) {\n  const url = new URL(globalThis.location.href);\n  if (slot !== 1) {\n    url.searchParams.set(ACCOUNT_QUERY, String(slot));\n  } else {\n    url.searchParams.delete(ACCOUNT_QUERY);\n  }\n  url.hash = forLogin ? 'login' : '';\n  return url.toString();\n}\n\n// Validate current version across all tabs to avoid conflicts\nif (typeof window === 'object') {\n  const versionChannel = new BroadcastChannel('tt-version');\n  versionChannel.postMessage({ version: APP_VERSION });\n\n  versionChannel.addEventListener('message', (event) => {\n    const { version } = event.data;\n    if (!version) return;\n    if (semverCompare(APP_VERSION, version) === -1) {\n      window.location.reload();\n    }\n\n    // If incoming version is older, send back the current version\n    if (semverCompare(APP_VERSION, version) === 1) {\n      versionChannel.postMessage({ version: APP_VERSION });\n    }\n  });\n}\n\nfunction semverCompare(a: string, b: string) {\n  if (a.startsWith(`${b}-`)) return -1;\n  if (b.startsWith(`${a}-`)) return 1;\n  return a.localeCompare(b, undefined, { numeric: true, sensitivity: 'case', caseFirst: 'upper' });\n}\n","import React, { memo, useState } from '../../lib/teact/teact';\n\nimport type { OwnProps as AnimatedStickerProps } from './AnimatedSticker';\n\nimport buildClassName from '../../util/buildClassName';\n\nimport useFlag from '../../hooks/useFlag';\nimport useLastCallback from '../../hooks/useLastCallback';\nimport useMediaTransitionDeprecated from '../../hooks/useMediaTransitionDeprecated';\n\nimport AnimatedSticker from './AnimatedSticker';\n\nconst DEFAULT_SIZE = 150;\n\nexport type OwnProps =\n  Partial<AnimatedStickerProps>\n  & { noTransition?: boolean; nonInteractive?: boolean };\n\nfunction AnimatedIcon(props: OwnProps) {\n  const {\n    size = DEFAULT_SIZE,\n    play = true,\n    noLoop = true,\n    className,\n    noTransition,\n    nonInteractive,\n    onLoad,\n    onClick,\n    ...otherProps\n  } = props;\n  const [isAnimationLoaded, markAnimationLoaded] = useFlag(false);\n  const transitionClassNames = useMediaTransitionDeprecated(noTransition || isAnimationLoaded);\n\n  const handleLoad = useLastCallback(() => {\n    markAnimationLoaded();\n    onLoad?.();\n  });\n\n  const [playKey, setPlayKey] = useState(String(Math.random()));\n\n  const handleClick = useLastCallback(() => {\n    if (play === true) {\n      setPlayKey(String(Math.random()));\n    }\n\n    onClick?.();\n  });\n\n  return (\n    <AnimatedSticker\n      className={buildClassName(className, transitionClassNames)}\n      size={size}\n      play={play === true ? playKey : play}\n      noLoop={noLoop}\n      onClick={!nonInteractive ? handleClick : undefined}\n      onLoad={handleLoad}\n      /* eslint-disable-next-line react/jsx-props-no-spreading */\n      {...otherProps}\n    />\n  );\n}\n\nexport default memo(AnimatedIcon);\n","import type { TeactNode } from '../../../lib/teact/teact';\nimport React from '../../../lib/teact/teact';\n\nimport type { TextPart } from '../../../types';\n\nimport {\n  BASE_URL, IS_PACKAGED_ELECTRON, RE_LINK_TEMPLATE, RE_MENTION_TEMPLATE,\n} from '../../../config';\nimport EMOJI_REGEX from '../../../lib/twemojiRegex';\nimport { IS_EMOJI_SUPPORTED } from '../../../util/browser/windowEnvironment';\nimport buildClassName from '../../../util/buildClassName';\nimport { isDeepLink } from '../../../util/deepLinkParser';\nimport {\n  handleEmojiLoad,\n  LOADED_EMOJIS,\n  nativeToUnifiedExtendedWithCache,\n} from '../../../util/emoji/emoji';\nimport fixNonStandardEmoji from '../../../util/emoji/fixNonStandardEmoji';\nimport { compact } from '../../../util/iteratees';\n\nimport MentionLink from '../../middle/message/MentionLink';\nimport SafeLink from '../SafeLink';\n\nexport type TextFilter = (\n  'escape_html' | 'hq_emoji' | 'emoji' | 'emoji_html' | 'br' | 'br_html' | 'highlight' | 'links' |\n  'simple_markdown' | 'simple_markdown_html' | 'tg_links'\n  );\n\nconst SIMPLE_MARKDOWN_REGEX = /(\\*\\*|__).+?\\1/g;\n\nexport default function renderText(\n  part: TextPart,\n  filters: Array<TextFilter> = ['emoji'],\n  params?: {\n    highlight?: string;\n    markdownPostProcessor?: (part: string) => TeactNode;\n  },\n): TeactNode[] {\n  if (typeof part !== 'string') {\n    return [part];\n  }\n\n  return compact(filters.reduce((text, filter) => {\n    switch (filter) {\n      case 'escape_html':\n        return escapeHtml(text);\n\n      case 'hq_emoji':\n        EMOJI_REGEX.lastIndex = 0;\n        return replaceEmojis(text, 'big', 'jsx');\n\n      case 'emoji':\n        EMOJI_REGEX.lastIndex = 0;\n        return replaceEmojis(text, 'small', 'jsx');\n\n      case 'emoji_html':\n        EMOJI_REGEX.lastIndex = 0;\n        return replaceEmojis(text, 'small', 'html');\n\n      case 'br':\n        return addLineBreaks(text, 'jsx');\n\n      case 'br_html':\n        return addLineBreaks(text, 'html');\n\n      case 'highlight':\n        return addHighlight(text, params!.highlight);\n\n      case 'links':\n        return addLinks(text);\n\n      case 'tg_links':\n        return addLinks(text, true);\n\n      case 'simple_markdown':\n        return replaceSimpleMarkdown(text, 'jsx', params?.markdownPostProcessor);\n\n      case 'simple_markdown_html':\n        return replaceSimpleMarkdown(text, 'html');\n    }\n\n    return text;\n  }, [part] as TextPart[]));\n}\n\nfunction escapeHtml(textParts: TextPart[]): TextPart[] {\n  const divEl = document.createElement('div');\n  return textParts.reduce((result: TextPart[], part) => {\n    if (typeof part !== 'string') {\n      result.push(part);\n      return result;\n    }\n\n    divEl.innerText = part;\n    result.push(divEl.innerHTML);\n\n    return result;\n  }, []);\n}\n\nfunction replaceEmojis(textParts: TextPart[], size: 'big' | 'small', type: 'jsx' | 'html'): TextPart[] {\n  if (IS_EMOJI_SUPPORTED) {\n    return textParts;\n  }\n\n  return textParts.reduce((result: TextPart[], part: TextPart) => {\n    if (typeof part !== 'string') {\n      result.push(part);\n      return result;\n    }\n\n    part = fixNonStandardEmoji(part);\n    const parts = part.split(EMOJI_REGEX);\n    const emojis: string[] = part.match(EMOJI_REGEX) || [];\n    result.push(parts[0]);\n\n    return emojis.reduce((emojiResult: TextPart[], emoji, i) => {\n      const code = nativeToUnifiedExtendedWithCache(emoji);\n      if (!code) {\n        emojiResult.push(emoji);\n      } else {\n        const baseSrcUrl = IS_PACKAGED_ELECTRON ? BASE_URL : '.';\n        const src = `${baseSrcUrl}/img-apple-${size === 'big' ? '160' : '64'}/${code}.png`;\n        const className = buildClassName(\n          'emoji',\n          size === 'small' && 'emoji-small',\n        );\n\n        if (type === 'jsx') {\n          const isLoaded = LOADED_EMOJIS.has(src);\n\n          emojiResult.push(\n            <img\n              src={src}\n              className={`${className}${!isLoaded ? ' opacity-transition slow shown' : ''}`}\n              alt={emoji}\n              data-path={src}\n              draggable={false}\n              onLoad={!isLoaded ? handleEmojiLoad : undefined}\n            />,\n          );\n        }\n        if (type === 'html') {\n          emojiResult.push(\n            `<img\\\n            draggable=\"false\"\\\n            class=\"${className}\"\\\n            src=\"${src}\"\\\n            alt=\"${emoji}\"\\\n          />`,\n          );\n        }\n      }\n\n      const index = i * 2 + 2;\n      if (parts[index]) {\n        emojiResult.push(parts[index]);\n      }\n\n      return emojiResult;\n    }, result);\n  }, [] as TextPart[]);\n}\n\nfunction addLineBreaks(textParts: TextPart[], type: 'jsx' | 'html'): TextPart[] {\n  return textParts.reduce((result: TextPart[], part) => {\n    if (typeof part !== 'string') {\n      result.push(part);\n      return result;\n    }\n\n    const splittenParts = part\n      .split(/\\r\\n|\\r|\\n/g)\n      .reduce((parts: TextPart[], line: string, i, source) => {\n        // This adds non-breaking space if line was indented with spaces, to preserve the indentation\n        const trimmedLine = line.trimLeft();\n        const indentLength = line.length - trimmedLine.length;\n        parts.push(String.fromCharCode(160).repeat(indentLength) + trimmedLine);\n\n        if (i !== source.length - 1) {\n          parts.push(\n            type === 'jsx' ? <br /> : '<br />',\n          );\n        }\n\n        return parts;\n      }, []);\n\n    return [...result, ...splittenParts];\n  }, []);\n}\n\nfunction addHighlight(textParts: TextPart[], highlight: string | undefined): TextPart[] {\n  return textParts.reduce<TextPart[]>((result, part) => {\n    if (typeof part !== 'string' || !highlight) {\n      result.push(part);\n      return result;\n    }\n\n    const lowerCaseText = part.toLowerCase();\n    const queryPosition = lowerCaseText.indexOf(highlight.toLowerCase());\n    if (queryPosition < 0) {\n      result.push(part);\n      return result;\n    }\n\n    const newParts: TextPart[] = [];\n    newParts.push(part.substring(0, queryPosition));\n    newParts.push(\n      <span className=\"matching-text-highlight\">\n        {part.substring(queryPosition, queryPosition + highlight.length)}\n      </span>,\n    );\n    newParts.push(part.substring(queryPosition + highlight.length));\n    return [...result, ...newParts];\n  }, []);\n}\n\nconst RE_LINK = new RegExp(`${RE_LINK_TEMPLATE}|${RE_MENTION_TEMPLATE}`, 'ig');\n\nfunction addLinks(textParts: TextPart[], allowOnlyTgLinks?: boolean): TextPart[] {\n  return textParts.reduce<TextPart[]>((result, part) => {\n    if (typeof part !== 'string') {\n      result.push(part);\n      return result;\n    }\n\n    const links = part.match(RE_LINK);\n    if (!links || !links.length) {\n      result.push(part);\n      return result;\n    }\n\n    const content: TextPart[] = [];\n\n    let nextLink = links.shift();\n    let lastIndex = 0;\n    while (nextLink) {\n      const index = part.indexOf(nextLink, lastIndex);\n      content.push(part.substring(lastIndex, index));\n      if (nextLink.startsWith('@')) {\n        content.push(\n          <MentionLink username={nextLink}>\n            {nextLink}\n          </MentionLink>,\n        );\n      } else {\n        if (nextLink.endsWith('?')) {\n          nextLink = nextLink.slice(0, nextLink.length - 1);\n        }\n\n        if (!allowOnlyTgLinks || isDeepLink(nextLink)) {\n          content.push(\n            <SafeLink text={nextLink} url={nextLink} />,\n          );\n        } else {\n          content.push(nextLink);\n        }\n      }\n      lastIndex = index + nextLink.length;\n      nextLink = links.shift();\n    }\n    content.push(part.substring(lastIndex));\n\n    return [...result, ...content];\n  }, []);\n}\n\nfunction replaceSimpleMarkdown(\n  textParts: TextPart[], type: 'jsx' | 'html', postProcessor?: (part: string) => TeactNode,\n): TextPart[] {\n  // Currently supported only for JSX. If needed, add typings to support HTML as well.\n  const postProcess = postProcessor || ((part: string) => part);\n\n  return textParts.reduce<TextPart[]>((result, part) => {\n    if (typeof part !== 'string') {\n      result.push(part);\n      return result;\n    }\n\n    const parts = part.split(SIMPLE_MARKDOWN_REGEX);\n    const entities: string[] = part.match(SIMPLE_MARKDOWN_REGEX) || [];\n    result.push(postProcess(parts[0]));\n\n    return entities.reduce((entityResult: TextPart[], entity, i) => {\n      if (type === 'jsx') {\n        entityResult.push(\n          entity.startsWith('**')\n            ? <b>{postProcess(entity.replace(/\\*\\*/g, ''))}</b>\n            : <i>{postProcess(entity.replace(/__/g, ''))}</i>,\n        );\n      } else {\n        entityResult.push(\n          entity.startsWith('**')\n            ? `<b>${entity.replace(/\\*\\*/g, '')}</b>`\n            : `<i>${entity.replace(/__/g, '')}</i>`,\n        );\n      }\n\n      const index = i * 2 + 2;\n      if (parts[index]) {\n        entityResult.push(postProcess(parts[index]));\n      }\n\n      return entityResult;\n    }, result);\n  }, []);\n}\n\nexport function areLinesWrapping(text: string, element: HTMLElement) {\n  const lines = (text.trim().match(/\\n/g) || '').length + 1;\n  const { lineHeight } = getComputedStyle(element);\n  const lineHeightParsed = parseFloat(lineHeight.split('px')[0]);\n\n  return element.clientHeight >= (lines + 1) * lineHeightParsed;\n}\n","import type {\n  ApiUpdateAuthorizationError,\n  ApiUpdateAuthorizationState,\n  ApiUpdateConnectionState,\n  ApiUpdateCurrentUser,\n  ApiUpdateServerTimeOffset,\n  ApiUpdateSession,\n} from '../../../api/types';\nimport type { LangCode } from '../../../types';\nimport type { RequiredGlobalActions } from '../../index';\nimport type { ActionReturnType, GlobalState } from '../../types';\n\nimport { getCurrentTabId } from '../../../util/establishMultitabRole';\nimport { getShippingError, shouldClosePaymentModal } from '../../../util/getReadableErrorText';\nimport { unique } from '../../../util/iteratees';\nimport { oldSetLanguage } from '../../../util/oldLangProvider';\nimport { clearWebTokenAuth } from '../../../util/routing';\nimport { setServerTimeOffset } from '../../../util/serverTime';\nimport { updateSessionUserId } from '../../../util/sessions';\nimport { forceWebsync } from '../../../util/websync';\nimport { setChataiStoreBuilderCurrentUserId } from '../../../components/chatAssistant/store';\nimport { isChatChannel, isChatSuperGroup } from '../../helpers';\nimport {\n  addActionHandler, getGlobal, setGlobal,\n} from '../../index';\nimport { updateUser, updateUserFullInfo } from '../../reducers';\nimport { updateTabState } from '../../reducers/tabs';\nimport { selectTabState } from '../../selectors';\nimport { selectSharedSettings } from '../../selectors/sharedState';\n\naddActionHandler('apiUpdate', (global, actions, update): ActionReturnType => {\n  switch (update['@type']) {\n    case 'updateApiReady':\n      onUpdateApiReady(global);\n      break;\n\n    case 'updateAuthorizationState':\n      onUpdateAuthorizationState(global, update);\n      break;\n\n    case 'updateAuthorizationError':\n      onUpdateAuthorizationError(global, update);\n      break;\n\n    case 'updateWebAuthTokenFailed':\n      onUpdateWebAuthTokenFailed(global);\n      break;\n\n    case 'updateConnectionState':\n      onUpdateConnectionState(global, actions, update);\n      break;\n\n    case 'updateSession':\n      onUpdateSession(global, actions, update);\n      break;\n\n    case 'updateServerTimeOffset':\n      onUpdateServerTimeOffset(update);\n      break;\n\n    case 'updateCurrentUser':\n      setChataiStoreBuilderCurrentUserId(update.currentUser.id);\n      onUpdateCurrentUser(global, update);\n      break;\n\n    case 'requestReconnectApi':\n      global = { ...global, isSynced: false };\n      setGlobal(global);\n\n      onUpdateConnectionState(global, actions, {\n        '@type': 'updateConnectionState',\n        connectionState: 'connectionStateConnecting',\n      });\n      actions.initApi();\n      break;\n\n    case 'requestSync':\n      actions.sync();\n      break;\n\n    case 'updateFetchingDifference':\n      global = { ...global, isFetchingDifference: update.isFetching };\n      setGlobal(global);\n      break;\n\n    case 'error': {\n      Object.values(global.byTabId).forEach(({ id: tabId }) => {\n        const paymentShippingError = getShippingError(update.error);\n        if (paymentShippingError) {\n          actions.addPaymentError({ error: paymentShippingError, tabId });\n        } else if (shouldClosePaymentModal(update.error)) {\n          actions.closePaymentModal({ tabId });\n        } else if (actions.showDialog) {\n          actions.showDialog({ data: update.error, tabId });\n        }\n      });\n\n      break;\n    }\n\n    case 'notSupportedInFrozenAccount': {\n      actions.showNotification({\n        title: {\n          key: 'NotificationTitleNotSupportedInFrozenAccount',\n        },\n        message: {\n          key: 'NotificationMessageNotSupportedInFrozenAccount',\n        },\n        tabId: getCurrentTabId(),\n      });\n      break;\n    }\n  }\n});\n\nfunction onUpdateApiReady<T extends GlobalState>(global: T) {\n  void oldSetLanguage(selectSharedSettings(global).language as LangCode);\n}\n\nfunction onUpdateAuthorizationState<T extends GlobalState>(global: T, update: ApiUpdateAuthorizationState) {\n  global = getGlobal();\n\n  const wasAuthReady = global.authState === 'authorizationStateReady';\n  const authState = update.authorizationState;\n\n  global = {\n    ...global,\n    authState,\n    authIsLoading: false,\n  };\n  setGlobal(global);\n\n  global = getGlobal();\n\n  switch (authState) {\n    case 'authorizationStateLoggingOut':\n      void forceWebsync(false);\n\n      global = {\n        ...global,\n        isLoggingOut: true,\n      };\n      setGlobal(global);\n      break;\n    case 'authorizationStateWaitCode':\n      global = {\n        ...global,\n        authIsCodeViaApp: update.isCodeViaApp,\n      };\n      setGlobal(global);\n      break;\n    case 'authorizationStateWaitPassword':\n      global = {\n        ...global,\n        authHint: update.hint,\n      };\n\n      if (update.noReset) {\n        global = {\n          ...global,\n          hasWebAuthTokenPasswordRequired: true,\n        };\n      }\n\n      setGlobal(global);\n      break;\n    case 'authorizationStateWaitQrCode':\n      global = {\n        ...global,\n        authIsLoadingQrCode: false,\n        authQrCode: update.qrCode,\n      };\n      setGlobal(global);\n      break;\n    case 'authorizationStateReady': {\n      if (wasAuthReady) {\n        break;\n      }\n\n      void forceWebsync(true);\n\n      global = {\n        ...global,\n        isLoggingOut: false,\n      };\n      Object.values(global.byTabId).forEach(({ id: tabId }) => {\n        global = updateTabState(global, {\n          isInactive: false,\n        }, tabId);\n      });\n      setGlobal(global);\n\n      break;\n    }\n  }\n}\n\nfunction onUpdateAuthorizationError<T extends GlobalState>(global: T, update: ApiUpdateAuthorizationError) {\n  // TODO: Investigate why TS is not happy with spread for lang related types\n  global = {\n    ...global,\n  };\n  global.authErrorKey = update.errorKey;\n  setGlobal(global);\n}\n\nfunction onUpdateWebAuthTokenFailed<T extends GlobalState>(global: T) {\n  clearWebTokenAuth();\n  global = getGlobal();\n\n  global = {\n    ...global,\n    hasWebAuthTokenFailed: true,\n  };\n  setGlobal(global);\n}\n\nfunction onUpdateConnectionState<T extends GlobalState>(\n  global: T, actions: RequiredGlobalActions, update: ApiUpdateConnectionState,\n) {\n  const { connectionState } = update;\n\n  global = getGlobal();\n  const tabState = selectTabState(global, getCurrentTabId());\n  if (connectionState === 'connectionStateReady' && tabState.isMasterTab && tabState.multitabNextAction) {\n    // @ts-ignore\n    actions[tabState.multitabNextAction.action](tabState.multitabNextAction.payload);\n    actions.clearMultitabNextAction({ tabId: tabState.id });\n  }\n\n  if (connectionState === global.connectionState) {\n    return;\n  }\n\n  global = {\n    ...global,\n    connectionState,\n  };\n  setGlobal(global);\n\n  if (global.isSynced) {\n    const channelStackIds = Object.values(global.byTabId)\n      .flatMap((tab) => tab.messageLists)\n      .map((messageList) => messageList.chatId)\n      .filter((chatId) => {\n        const chat = global.chats.byId[chatId];\n        return chat && (isChatChannel(chat) || isChatSuperGroup(chat));\n      });\n    if (connectionState === 'connectionStateReady' && channelStackIds.length) {\n      unique(channelStackIds).forEach((chatId) => {\n        actions.requestChannelDifference({ chatId });\n      });\n    }\n  }\n\n  if (connectionState === 'connectionStateBroken') {\n    actions.signOut({ forceInitApi: true });\n  }\n}\n\nfunction onUpdateSession<T extends GlobalState>(global: T, actions: RequiredGlobalActions, update: ApiUpdateSession) {\n  const { sessionData } = update;\n  const { authRememberMe, authState } = global;\n  const isEmpty = !sessionData || !sessionData.mainDcId;\n\n  const isTest = sessionData?.isTest;\n  if (isTest) {\n    global = {\n      ...global,\n      config: {\n        ...global.config,\n        isTestServer: isTest,\n      },\n    };\n    setGlobal(global);\n  }\n\n  if (!authRememberMe || authState !== 'authorizationStateReady' || isEmpty) {\n    return;\n  }\n\n  actions.saveSession({ sessionData });\n}\n\nfunction onUpdateServerTimeOffset(update: ApiUpdateServerTimeOffset) {\n  setServerTimeOffset(update.serverTimeOffset);\n}\n\nfunction onUpdateCurrentUser<T extends GlobalState>(global: T, update: ApiUpdateCurrentUser) {\n  const { currentUser, currentUserFullInfo } = update;\n\n  global = {\n    ...updateUser(global, currentUser.id, currentUser),\n    currentUserId: currentUser.id,\n  };\n  global = updateUserFullInfo(global, currentUser.id, currentUserFullInfo);\n  setGlobal(global);\n\n  updateSessionUserId(currentUser.id);\n}\n","import type {\n  GlobalState, TabArgs,\n  TabState,\n} from '../types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\n\nexport function selectTabState<T extends GlobalState>(\n  global: T, ...[tabId = getCurrentTabId()]: TabArgs<T>\n): TabState {\n  return global.byTabId[tabId];\n}\n","import React from '../lib/teact/teact';\nimport { getActions, getGlobal, setGlobal } from '../global';\n\nimport type {\n  ApiChat, ApiMessage, ApiPeer, ApiPeerReaction,\n  ApiPhoneCall, ApiUser,\n} from '../api/types';\nimport { ApiMediaFormat } from '../api/types';\n\nimport { APP_NAME, DEBUG, IS_TEST } from '../config';\nimport {\n  getChatAvatarHash,\n  getChatTitle,\n  getMessageRecentReaction,\n  getPrivateChatUserId,\n  getUserFullName,\n  isChatChannel,\n} from '../global/helpers';\nimport { getIsChatMuted, getIsChatSilent, getShouldShowMessagePreview } from '../global/helpers/notifications';\nimport { getMessageSenderName } from '../global/helpers/peers';\nimport {\n  selectChat,\n  selectCurrentMessageList,\n  selectIsChatWithSelf,\n  selectNotifyDefaults,\n  selectNotifyException,\n  selectSettingsKeys,\n  selectTopicFromMessage,\n  selectUser,\n} from '../global/selectors';\nimport { callApi } from '../api/gramjs';\nimport { IS_ELECTRON, IS_SERVICE_WORKER_SUPPORTED, IS_TOUCH_ENV } from './browser/windowEnvironment';\nimport jsxToHtml from './element/jsxToHtml';\nimport { buildCollectionByKey } from './iteratees';\nimport * as mediaLoader from './mediaLoader';\nimport { oldTranslate } from './oldLangProvider';\nimport { debounce } from './schedulers';\nimport { getServerTime } from './serverTime';\n\nimport MessageSummary from '../components/common/MessageSummary';\n\nfunction getDeviceToken(subscription: PushSubscription) {\n  const data = subscription.toJSON();\n  return JSON.stringify({\n    endpoint: data.endpoint,\n    keys: data.keys,\n  });\n}\n\nfunction checkIfPushSupported() {\n  if (!IS_SERVICE_WORKER_SUPPORTED || IS_ELECTRON) return false;\n\n  if (!('showNotification' in ServiceWorkerRegistration.prototype)) {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.warn('[PUSH] Push notifications aren\\'t supported.');\n    }\n    return false;\n  }\n\n  // If permission is denied, it is blocked until the user manually changes their settings\n  if (Notification.permission === 'denied') {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.warn('[PUSH] The user has blocked push notifications.');\n    }\n    return false;\n  }\n\n  // Check if push messaging is supported\n  if (!('PushManager' in window)) {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.warn('[PUSH] Push messaging isn\\'t supported.');\n    }\n    return false;\n  }\n\n  return true;\n}\n\nexport function checkIfNotificationsSupported() {\n  // Let's check if the browser supports notifications\n  if (!('Notification' in window)) {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.warn('[PUSH] This browser does not support desktop notification');\n    }\n    return false;\n  }\n\n  if (Notification.permission === 'denied' as NotificationPermission) {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.warn('[PUSH] The user has blocked push notifications.');\n    }\n    return false;\n  }\n  return true;\n}\n\nconst expirationTime = 12 * 60 * 60 * 1000; // 12 hours\n// Notification id is removed from soundPlayed cache after 3 seconds\nconst soundPlayedDelay = 3 * 1000;\nconst soundPlayedIds = new Set<string>();\nconst notificationSound = new Audio('./notification.mp3');\nnotificationSound.setAttribute('mozaudiochannel', 'notification');\n\nexport async function playNotifySound(id?: string, volume?: number) {\n  if (id !== undefined && soundPlayedIds.has(id)) return;\n  const { notificationSoundVolume } = selectSettingsKeys(getGlobal());\n  const currentVolume = volume ? volume / 10 : notificationSoundVolume / 10;\n  if (currentVolume === 0) return;\n  notificationSound.volume = currentVolume;\n  if (id !== undefined) {\n    notificationSound.addEventListener('ended', () => {\n      soundPlayedIds.add(id);\n    }, { once: true });\n\n    setTimeout(() => {\n      soundPlayedIds.delete(id);\n    }, soundPlayedDelay);\n  }\n\n  try {\n    await notificationSound.play();\n  } catch (error) {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.warn('[PUSH] Unable to play notification sound');\n    }\n  }\n}\n\nexport const playNotifySoundDebounced = debounce(playNotifySound, 1000, true, false);\n\nfunction checkIfShouldResubscribe(subscription: PushSubscription | null) {\n  const global = getGlobal();\n  if (!global.push || !subscription) return true;\n  if (getDeviceToken(subscription) !== global.push.deviceToken) return true;\n  return Date.now() - global.push.subscribedAt > expirationTime;\n}\n\nexport async function requestPermission() {\n  if (!('Notification' in window)) {\n    return false;\n  }\n  let permission = Notification.permission;\n  if (!['granted', 'denied'].includes(permission)) {\n    permission = await Notification.requestPermission();\n  }\n  return permission === 'granted';\n}\n\nasync function unsubscribeFromPush(subscription: PushSubscription | null) {\n  const global = getGlobal();\n  const { deleteDeviceToken } = getActions();\n  if (subscription) {\n    try {\n      const deviceToken = getDeviceToken(subscription);\n      await callApi('unregisterDevice', deviceToken);\n      await subscription.unsubscribe();\n      deleteDeviceToken();\n      return;\n    } catch (error) {\n      if (DEBUG) {\n        // eslint-disable-next-line no-console\n        console.log('[PUSH] Unable to unsubscribe from push.', error);\n      }\n    }\n  }\n  if (global.push) {\n    await callApi('unregisterDevice', global.push.deviceToken);\n    deleteDeviceToken();\n  }\n}\n\nexport async function unsubscribe() {\n  if (!checkIfPushSupported()) return;\n  const serviceWorkerRegistration = await navigator.serviceWorker.ready;\n  const subscription = await serviceWorkerRegistration.pushManager.getSubscription();\n  await unsubscribeFromPush(subscription);\n}\n\n// Load custom emoji from the api if it's not cached already\nasync function loadCustomEmoji(id: string) {\n  let global = getGlobal();\n  if (global.customEmojis.byId[id]) return;\n  const customEmoji = await callApi('fetchCustomEmoji', {\n    documentId: [id],\n  });\n  if (!customEmoji) return;\n  global = getGlobal();\n  global = {\n    ...global,\n    customEmojis: {\n      ...global.customEmojis,\n      byId: {\n        ...global.customEmojis.byId,\n        ...buildCollectionByKey(customEmoji, 'id'),\n      },\n    },\n  };\n  setGlobal(global);\n}\n\nlet isSubscriptionFailed = false;\nexport function checkIfOfflinePushFailed() {\n  return isSubscriptionFailed;\n}\n\nexport async function subscribe() {\n  const { setDeviceToken, updateWebNotificationSettings } = getActions();\n  let hasWebNotifications = false;\n  let hasPushNotifications = false;\n  if (!checkIfPushSupported()) {\n    // Ask for notification permissions only if service worker notifications are not supported\n    // As pushManager.subscribe automatically triggers permission popup\n    hasWebNotifications = await requestPermission();\n    updateWebNotificationSettings({\n      hasWebNotifications,\n      hasPushNotifications,\n    });\n    return;\n  }\n  const serviceWorkerRegistration = await navigator.serviceWorker.ready;\n  let subscription = await serviceWorkerRegistration.pushManager.getSubscription();\n  if (!checkIfShouldResubscribe(subscription)) return;\n  await unsubscribeFromPush(subscription);\n  try {\n    subscription = await serviceWorkerRegistration.pushManager.subscribe({\n      userVisibleOnly: true,\n    });\n    const deviceToken = getDeviceToken(subscription);\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.log('[PUSH] Received push subscription: ', deviceToken);\n    }\n    await callApi('registerDevice', deviceToken);\n    setDeviceToken(deviceToken);\n    hasPushNotifications = true;\n    hasWebNotifications = true;\n  } catch (error: any) {\n    if (Notification.permission === 'denied') {\n      // The user denied the notification permission which\n      // means we failed to subscribe and the user will need\n      // to manually change the notification permission to\n      // subscribe to push messages\n      if (DEBUG) {\n        // eslint-disable-next-line no-console\n        console.warn('[PUSH] The user has blocked push notifications.');\n      }\n    } else {\n      // A problem occurred with the subscription, this can\n      // often be down to an issue or lack of the gcm_sender_id\n      // and / or gcm_user_visible_only\n      if (DEBUG) {\n        // eslint-disable-next-line no-console\n        console.log('[PUSH] Unable to subscribe to push.', error);\n      }\n      // Request permissions and fall back to local notifications\n      // if pushManager.subscribe was aborted due to invalid VAPID key.\n      if ([DOMException.ABORT_ERR, DOMException.NOT_SUPPORTED_ERR].includes(error.code)) {\n        isSubscriptionFailed = true;\n        hasWebNotifications = await requestPermission();\n      }\n    }\n  }\n  updateWebNotificationSettings({\n    hasWebNotifications,\n    hasPushNotifications,\n  });\n}\n\nfunction checkIfShouldNotify(chat: ApiChat, message: Partial<ApiMessage>) {\n  const global = getGlobal();\n  const isChatMuted = getIsChatMuted(chat, selectNotifyDefaults(global), selectNotifyException(global, chat.id));\n  const topic = selectTopicFromMessage(global, message as ApiMessage);\n  const topicMutedUntil = topic?.notifySettings.mutedUntil;\n  const isMuted = topicMutedUntil === undefined ? isChatMuted : topicMutedUntil > getServerTime();\n  const shouldIgnoreMute = message.isMentioned;\n\n  const shouldNotifyAboutMessage = message.content?.action?.type !== 'phoneCall';\n  if ((isMuted && !shouldIgnoreMute) || !shouldNotifyAboutMessage\n     || chat.isNotJoined || !chat.isListed || selectIsChatWithSelf(global, chat.id)) {\n    return false;\n  }\n  // On touch devices show notifications when chat is not active\n  if (IS_TOUCH_ENV) {\n    const {\n      chatId,\n      type,\n    } = selectCurrentMessageList(global) || {};\n    return !(chatId === chat.id && type === 'thread');\n  }\n  // On desktop show notifications when window is not focused\n  return !document.hasFocus();\n}\n\nfunction getNotificationContent(chat: ApiChat, message: ApiMessage, reaction?: ApiPeerReaction) {\n  const global = getGlobal();\n  let {\n    senderId,\n  } = message;\n  const hasReaction = Boolean(reaction);\n  if (hasReaction) senderId = reaction.peerId;\n\n  const { isScreenLocked } = global.passcode;\n  const messageSenderChat = senderId ? selectChat(global, senderId) : undefined;\n  const messageSenderUser = senderId ? selectUser(global, senderId) : undefined;\n  const privateChatUserId = getPrivateChatUserId(chat);\n  const isSelf = privateChatUserId === global.currentUserId;\n\n  let body: string;\n  if (\n    !isScreenLocked\n    && getShouldShowMessagePreview(chat, selectNotifyDefaults(global), selectNotifyException(global, chat.id))\n  ) {\n    const isChat = chat && (isChatChannel(chat) || message.senderId === message.chatId);\n\n    // TODO[forums] Support ApiChat\n    const senderName = getMessageSenderName(oldTranslate, chat.id, isChat ? messageSenderChat : messageSenderUser);\n    let summary = jsxToHtml(<span><MessageSummary message={message} /></span>)[0].textContent || '';\n\n    if (hasReaction) {\n      const emoji = getReactionEmoji(reaction);\n      summary = oldTranslate('PushReactText', [emoji, summary]);\n    }\n\n    body = senderName ? `${senderName}: ${summary}` : summary;\n  } else {\n    body = 'New message';\n  }\n\n  let title = isScreenLocked ? APP_NAME : getChatTitle(oldTranslate, chat, isSelf);\n\n  if (message.isSilent) {\n    title += ' 🔕';\n  }\n\n  return { title, body };\n}\n\nasync function getAvatar(chat: ApiPeer) {\n  const imageHash = getChatAvatarHash(chat);\n  if (!imageHash) return undefined;\n  let mediaData = mediaLoader.getFromMemory(imageHash);\n  if (!mediaData) {\n    await mediaLoader.fetch(imageHash, ApiMediaFormat.BlobUrl);\n    mediaData = mediaLoader.getFromMemory(imageHash);\n  }\n  return mediaData;\n}\n\nfunction getReactionEmoji(reaction: ApiPeerReaction) {\n  let emoji;\n  if (reaction.reaction.type === 'emoji') {\n    emoji = reaction.reaction.emoticon;\n  }\n\n  if (reaction.reaction.type === 'custom') {\n    // eslint-disable-next-line eslint-multitab-tt/no-immediate-global\n    emoji = getGlobal().customEmojis.byId[reaction.reaction.documentId]?.emoji;\n  }\n  return emoji || '❤️';\n}\n\nexport async function notifyAboutCall({\n  call, user,\n}: {\n  call: ApiPhoneCall; user: ApiUser;\n}) {\n  const { hasWebNotifications } = selectSettingsKeys(getGlobal());\n  if (document.hasFocus() || !hasWebNotifications) return;\n  const areNotificationsSupported = checkIfNotificationsSupported();\n  if (!areNotificationsSupported) return;\n\n  const icon = await getAvatar(user);\n\n  const options: NotificationOptions = {\n    body: getUserFullName(user),\n    icon,\n    badge: icon,\n    tag: `call_${call.id}`,\n  };\n\n  if ('vibrate' in navigator) {\n    // @ts-ignore\n    options.vibrate = [200, 100, 200];\n  }\n\n  const notification = new Notification(oldTranslate('VoipIncoming'), options);\n\n  notification.onclick = () => {\n    notification.close();\n    if (window.focus) {\n      window.focus();\n    }\n  };\n}\n\nexport async function notifyAboutMessage({\n  chat,\n  message,\n  isReaction = false,\n}: { chat: ApiChat; message: Partial<ApiMessage>; isReaction?: boolean }) {\n  const global = getGlobal();\n  const { hasWebNotifications } = selectSettingsKeys(global);\n  if (!checkIfShouldNotify(chat, message)) return;\n  const isChatSilent = getIsChatSilent(\n    chat, selectNotifyDefaults(getGlobal()), selectNotifyException(getGlobal(), chat.id),\n  );\n  const topic = selectTopicFromMessage(global, message as ApiMessage);\n  const isSilent = topic?.notifySettings.hasSound === undefined ? isChatSilent : !topic.notifySettings.hasSound;\n\n  const areNotificationsSupported = checkIfNotificationsSupported();\n  if (!hasWebNotifications || !areNotificationsSupported) {\n    if (!isSilent && !message.isSilent && !isReaction && !IS_ELECTRON) {\n      // Only play sound if web notifications are disabled\n      playNotifySoundDebounced(String(message.id) || chat.id);\n    }\n\n    return;\n  }\n  if (!areNotificationsSupported) return;\n\n  if (!message.id) return;\n\n  const activeReaction = getMessageRecentReaction(message);\n  // Do not notify about reactions on messages that are not outgoing\n  if (isReaction && !activeReaction) return;\n\n  // If this is a custom emoji reaction we need to make sure it is loaded\n  if (isReaction && activeReaction && activeReaction.reaction.type === 'custom') {\n    await loadCustomEmoji(activeReaction.reaction.documentId);\n  }\n\n  const icon = await getAvatar(chat);\n\n  const {\n    title,\n    body,\n  } = getNotificationContent(chat, message as ApiMessage, activeReaction);\n\n  if (checkIfPushSupported()) {\n    if (navigator.serviceWorker?.controller) {\n      // notify service worker about new message notification\n      navigator.serviceWorker.controller.postMessage({\n        type: 'showMessageNotification',\n        payload: {\n          title,\n          body,\n          icon,\n          chatId: chat.id,\n          messageId: message.id,\n          shouldReplaceHistory: true,\n          isSilent: isSilent || message.isSilent,\n          reaction: activeReaction?.reaction,\n        },\n      });\n    }\n  } else {\n    const dispatch = getActions();\n    const options: NotificationOptions = {\n      body,\n      icon,\n      badge: icon,\n      tag: String(message.id),\n    };\n\n    if ('vibrate' in navigator) {\n      // @ts-ignore\n      options.vibrate = [200, 100, 200];\n    }\n\n    const notification = new Notification(title, options);\n\n    notification.onclick = () => {\n      notification.close();\n      dispatch.focusMessage({\n        chatId: chat.id,\n        messageId: message.id!,\n        shouldReplaceHistory: true,\n      });\n      if (window.focus) {\n        window.focus();\n      }\n    };\n\n    // Play sound when notification is displayed\n    notification.onshow = () => {\n      // TODO Update when reaction badges are implemented\n      if (isReaction || message.isSilent || IS_ELECTRON) return;\n      playNotifySoundDebounced(String(message.id) || chat.id);\n    };\n  }\n}\n\nexport function closeMessageNotifications(payload: { chatId: string; lastReadInboxMessageId?: number }) {\n  if (IS_TEST || !navigator.serviceWorker?.controller) return;\n  navigator.serviceWorker.controller.postMessage({\n    type: 'closeMessageNotifications',\n    payload,\n  });\n}\n\n// Notify service worker that client is fully loaded\nexport function notifyClientReady() {\n  if (!navigator.serviceWorker?.controller) return;\n  navigator.serviceWorker.controller.postMessage({\n    type: 'clientReady',\n  });\n}","import { useRef, useUnmountCleanup } from '../lib/teact/teact';\n\nimport { cleanupEffect, isSignal } from '../util/signals';\n\nexport function useSignalEffect(effect: NoneToVoidFunction, dependencies: readonly any[]) {\n  // The is extracted from `useEffectOnce` to run before all effects\n  const isFirstRun = useRef(true);\n  if (isFirstRun.current) {\n    isFirstRun.current = false;\n\n    dependencies?.forEach((dependency) => {\n      if (isSignal(dependency)) {\n        dependency.subscribe(effect);\n      }\n    });\n  }\n\n  useUnmountCleanup(() => {\n    cleanupEffect(effect);\n  });\n}\n","import type { RefObject } from 'react';\nimport { useEffect, useRef, useState } from '../lib/teact/teact';\n\nimport type { Scheduler } from '../util/schedulers';\n\nimport { type CallbackManager, createCallbackManager } from '../util/callbacks';\nimport {\n  debounce, throttle, throttleWith,\n} from '../util/schedulers';\nimport useHeavyAnimation from './useHeavyAnimation';\nimport useLastCallback from './useLastCallback';\n\ntype TargetCallback = (entry: IntersectionObserverEntry) => void;\ntype RootCallback = (entries: IntersectionObserverEntry[]) => void;\ntype ObserveCleanup = NoneToVoidFunction;\nexport type ObserveFn = (target: HTMLElement, targetCallback?: TargetCallback) => ObserveCleanup;\n\ninterface IntersectionController {\n  observer: IntersectionObserver;\n  addCallback: (element: HTMLElement, callback: TargetCallback) => void;\n  removeCallback: (element: HTMLElement, callback: TargetCallback) => void;\n  destroy: NoneToVoidFunction;\n}\n\ninterface Response {\n  observe: ObserveFn;\n  freeze: NoneToVoidFunction;\n  unfreeze: NoneToVoidFunction;\n}\n\nexport function useIntersectionObserver({\n  rootRef,\n  throttleMs,\n  throttleScheduler,\n  debounceMs,\n  shouldSkipFirst,\n  margin,\n  threshold,\n  isDisabled,\n}: {\n  rootRef: RefObject<HTMLDivElement>;\n  throttleMs?: number;\n  throttleScheduler?: Scheduler;\n  debounceMs?: number;\n  shouldSkipFirst?: boolean;\n  margin?: number;\n  threshold?: number | number[];\n  isDisabled?: boolean;\n}, rootCallback?: RootCallback): Response {\n  const controllerRef = useRef<IntersectionController>();\n  const rootCallbackRef = useRef<RootCallback>();\n  const freezeFlagsRef = useRef(0);\n  const onUnfreezeRef = useRef<NoneToVoidFunction>();\n\n  rootCallbackRef.current = rootCallback;\n\n  const freeze = useLastCallback(() => {\n    freezeFlagsRef.current++;\n  });\n\n  const unfreeze = useLastCallback(() => {\n    if (!freezeFlagsRef.current) {\n      return;\n    }\n\n    freezeFlagsRef.current--;\n\n    if (!freezeFlagsRef.current && onUnfreezeRef.current) {\n      onUnfreezeRef.current();\n      onUnfreezeRef.current = undefined;\n    }\n  });\n\n  useHeavyAnimation(freeze, unfreeze);\n\n  useEffect(() => {\n    if (isDisabled) {\n      return undefined;\n    }\n\n    return () => {\n      if (controllerRef.current) {\n        controllerRef.current.observer.disconnect();\n        controllerRef.current.destroy();\n        controllerRef.current = undefined;\n      }\n    };\n  }, [isDisabled]);\n\n  function initController() {\n    const callbacks = new Map<HTMLElement, CallbackManager<TargetCallback>>();\n    const entriesAccumulator = new Map<Element, IntersectionObserverEntry>();\n\n    let observerCallback: typeof observerCallbackSync;\n    if (typeof throttleScheduler === 'function') {\n      observerCallback = throttleWith(throttleScheduler, observerCallbackSync);\n    } else if (throttleMs) {\n      observerCallback = throttle(observerCallbackSync, throttleMs, !shouldSkipFirst);\n    } else if (debounceMs) {\n      observerCallback = debounce(observerCallbackSync, debounceMs, !shouldSkipFirst);\n    } else {\n      observerCallback = observerCallbackSync;\n    }\n\n    function observerCallbackSync() {\n      if (freezeFlagsRef.current) {\n        onUnfreezeRef.current = observerCallback;\n        return;\n      }\n\n      const entries = Array.from(entriesAccumulator.values());\n\n      entries.forEach((entry: IntersectionObserverEntry) => {\n        const callbackManager = callbacks.get(entry.target as HTMLElement);\n        callbackManager?.runCallbacks(entry);\n      });\n\n      if (rootCallbackRef.current) {\n        rootCallbackRef.current(entries);\n      }\n\n      entriesAccumulator.clear();\n    }\n\n    function addCallback(element: HTMLElement, callback: TargetCallback) {\n      if (!callbacks.get(element)) {\n        callbacks.set(element, createCallbackManager<TargetCallback>());\n      }\n\n      const callbackManager = callbacks.get(element)!;\n      callbackManager.addCallback(callback);\n    }\n\n    function removeCallback(element: HTMLElement, callback: TargetCallback) {\n      const callbackManager = callbacks.get(element);\n      if (!callbackManager) return;\n      callbackManager.removeCallback(callback);\n\n      if (!callbackManager.hasCallbacks()) {\n        callbacks.delete(element);\n      }\n    }\n\n    const observer = new IntersectionObserver(\n      (entries) => {\n        entries.forEach((entry) => {\n          entriesAccumulator.set(entry.target, entry);\n        });\n\n        if (freezeFlagsRef.current) {\n          onUnfreezeRef.current = observerCallback;\n        } else {\n          observerCallback();\n        }\n      },\n      {\n        root: rootRef.current,\n        rootMargin: margin ? `${margin}px` : undefined,\n        threshold,\n      },\n    );\n\n    function destroy() {\n      callbacks.clear();\n      observer.disconnect();\n      entriesAccumulator.clear();\n    }\n\n    controllerRef.current = {\n      observer,\n      addCallback,\n      removeCallback,\n      destroy,\n    };\n  }\n\n  const observe = useLastCallback((target, targetCallback) => {\n    if (!controllerRef.current) {\n      initController();\n    }\n\n    const controller = controllerRef.current!;\n    controller.observer.observe(target);\n\n    if (targetCallback) {\n      controller.addCallback(target, targetCallback);\n    }\n\n    return () => {\n      if (targetCallback) {\n        controller.removeCallback(target, targetCallback);\n      }\n\n      controller.observer.unobserve(target);\n    };\n  });\n\n  return { observe, freeze, unfreeze };\n}\n\nexport function useOnIntersect(\n  targetRef: RefObject<HTMLDivElement>, observe?: ObserveFn, callback?: TargetCallback,\n) {\n  const lastCallback = useLastCallback(callback);\n\n  useEffect(() => {\n    return observe ? observe(targetRef.current!, lastCallback) : undefined;\n  }, [lastCallback, observe, targetRef]);\n}\n\nexport function useIsIntersecting(\n  targetRef: RefObject<HTMLDivElement>, observe?: ObserveFn, callback?: TargetCallback,\n) {\n  const [isIntersecting, setIsIntersecting] = useState(!observe);\n\n  useOnIntersect(targetRef, observe, (entry) => {\n    setIsIntersecting(entry.isIntersecting);\n\n    if (callback) {\n      callback(entry);\n    }\n  });\n\n  return isIntersecting;\n}\n","export default function arePropsShallowEqual(currentProps: AnyLiteral, newProps: AnyLiteral) {\n  if (currentProps === newProps) {\n    return true;\n  }\n\n  const currentKeys = Object.keys(currentProps);\n  const currentKeysLength = currentKeys.length;\n  const newKeysLength = Object.keys(newProps).length;\n\n  if (currentKeysLength !== newKeysLength) {\n    return false;\n  }\n\n  if (currentKeysLength === 0) {\n    return true;\n  }\n\n  for (let i = 0; i < currentKeysLength; i++) {\n    const prop = currentKeys[i];\n    if (currentProps[prop] !== newProps[prop]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nexport function logUnequalProps(currentProps: AnyLiteral, newProps: AnyLiteral, msg: string, debugKey = '') {\n  const currentKeys = Object.keys(currentProps);\n  const currentKeysLength = currentKeys.length;\n  const newKeysLength = Object.keys(newProps).length;\n\n  if (currentKeysLength !== newKeysLength) {\n    // eslint-disable-next-line no-console\n    console.log(`${msg} LENGTH`);\n    return;\n  }\n\n  // eslint-disable-next-line no-console\n  console.log(msg);\n  currentKeys.forEach((prop) => {\n    if (currentProps[prop] !== newProps[prop]) {\n      // eslint-disable-next-line no-console\n      console.log(debugKey, prop, ':', currentProps[prop], '=>', newProps[prop]);\n    }\n  });\n}\n","import type { VirtualElement } from '../../lib/teact/teact';\nimport TeactDOM from '../../lib/teact/teact-dom';\n\nexport default function jsxToHtml(jsx: VirtualElement) {\n  const fragment = document.createElement('div');\n  TeactDOM.render(jsx, fragment);\n\n  const children = Array.from(fragment.children);\n  TeactDOM.render(undefined, fragment);\n\n  return children;\n}\n","import { onIdle, throttleWith } from '../../util/schedulers';\nimport { createSignal } from '../../util/signals';\nimport { requestMeasure } from '../fasterdom/fasterdom';\n\nconst AUTO_END_TIMEOUT = 1000;\n\nlet counter = 0;\nlet counterBlocking = 0;\n\nconst [getIsAnimating, setIsAnimating] = createSignal(false);\nconst [getIsBlockingAnimating, setIsBlockingAnimating] = createSignal(false);\n\nexport const getIsHeavyAnimating = getIsAnimating;\nexport { getIsBlockingAnimating };\n\nexport function beginHeavyAnimation(duration = AUTO_END_TIMEOUT, isBlocking = false) {\n  counter++;\n\n  if (counter === 1) {\n    setIsAnimating(true);\n  }\n\n  if (isBlocking) {\n    counterBlocking++;\n\n    if (counterBlocking === 1) {\n      setIsBlockingAnimating(true);\n    }\n  }\n\n  const timeout = window.setTimeout(onEnd, duration);\n\n  let hasEnded = false;\n\n  function onEnd() {\n    if (hasEnded) return;\n    hasEnded = true;\n\n    clearTimeout(timeout);\n\n    counter--;\n\n    if (counter === 0) {\n      setIsAnimating(false);\n    }\n\n    if (isBlocking) {\n      counterBlocking--;\n\n      if (counterBlocking === 0) {\n        setIsBlockingAnimating(false);\n      }\n    }\n  }\n\n  return onEnd;\n}\n\nexport function onFullyIdle(cb: NoneToVoidFunction) {\n  onIdle(() => {\n    if (getIsAnimating()) {\n      requestMeasure(() => {\n        onFullyIdle(cb);\n      });\n    } else {\n      cb();\n    }\n  });\n}\n\nexport function throttleWithFullyIdle<F extends AnyToVoidFunction>(fn: F) {\n  return throttleWith(onFullyIdle, fn);\n}\n","import { getGlobal } from '../../../global';\n\nimport type { ApiMessage } from '../../../api/types';\n\nimport { isChatGroup, isSystemBot } from '../../../global/helpers';\nimport { selectBot, selectChat } from '../../../global/selectors';\nimport { intelligentReplyTask } from './intelligent-reply-task';\nimport { urgentCheckTask } from './urgent-check-task';\n\nclass ChatAIMessageQuene {\n  static add(message: ApiMessage) {\n    // eslint-disable-next-line no-console\n    console.log('[ChatAIMessageQuene] add', message.id);\n    const global = getGlobal();\n    if (message.content.text) {\n      const chatId = message.chatId;\n      const chat = selectChat(global, chatId);\n      const chatBot = !isSystemBot(chatId) ? selectBot(global, chatId) : undefined;\n      if (chat && !chatBot) {\n        // TODO 这里需要判断是否是紧急消息/知识库自动回复\n        const { isRestricted } = chat;\n        if (!message.isOutgoing && !isRestricted) {\n          if (!isChatGroup(chat) || message.isMentioned) {\n            intelligentReplyTask.addNewMessage(message);\n          }\n          urgentCheckTask.addNewMessage(message);\n        }\n      }\n    }\n  }\n}\n\nexport default ChatAIMessageQuene;\n","import { getActions, getGlobal } from '../../../global';\n\nimport type { Api } from '../../../lib/gramjs';\nimport type { TypedBroadcastChannel } from '../../../util/browser/multitab';\nimport type {\n  ApiInitialArgs,\n  ApiMessage,\n  ApiOnProgress,\n  ApiUpdate,\n  OnApiUpdate,\n} from '../../types';\nimport type { LocalDb } from '../localDb';\nimport type { MethodArgs, MethodResponse, Methods } from '../methods/types';\nimport type { OriginPayload, ThenArg, WorkerMessageEvent } from './types';\n\nimport { DEBUG, IGNORE_UNHANDLED_ERRORS } from '../../../config';\nimport { hasMessageText, isUserId } from '../../../global/helpers';\nimport { logDebugMessage } from '../../../util/debugConsole';\nimport Deferred from '../../../util/Deferred';\nimport {\n  getCurrentTabId,\n  subscribeToMasterChange,\n} from '../../../util/establishMultitabRole';\nimport generateUniqueId from '../../../util/generateUniqueId';\nimport {\n  ACCOUNT_SLOT,\n  DATA_BROADCAST_CHANNEL_NAME,\n} from '../../../util/multiaccount';\nimport { pause, throttleWithTickEnd } from '../../../util/schedulers';\nimport ChatAIMessageQuene from '../../../components/chatAssistant/ai-task/chatai-task';\nimport { messageEmbeddingStore } from '../../../components/chatAssistant/vector-store';\n\nimport eventEmitter, {\n  Actions,\n} from '../../../components/chatAssistant/lib/EventEmitter';\n\ntype RequestState = {\n  messageId: string;\n  resolve: Function;\n  reject: Function;\n  callback?: AnyToVoidFunction;\n  DEBUG_payload?: any;\n};\n\nconst HEALTH_CHECK_TIMEOUT = 150;\nconst HEALTH_CHECK_MIN_DELAY = 5 * 1000; // 5 sec\nconst NO_QUEUE_BEFORE_INIT = new Set(['destroy']);\n\nlet worker: Worker | undefined;\n\nconst requestStates = new Map<string, RequestState>();\nconst requestStatesByCallback = new Map<AnyToVoidFunction, RequestState>();\n\nlet pendingPayloads: OriginPayload[] = [];\n\nconst savedLocalDb: LocalDb = {\n  chats: {},\n  users: {},\n  documents: {},\n  stickerSets: {},\n  photos: {},\n  webDocuments: {},\n  commonBoxState: {},\n  channelPtsById: {},\n};\n\nlet isMasterTab = true;\nsubscribeToMasterChange((isMasterTabNew) => {\n  isMasterTab = isMasterTabNew;\n});\n\nconst channel = new BroadcastChannel(\n  DATA_BROADCAST_CHANNEL_NAME,\n) as TypedBroadcastChannel;\n\nconst postMessagesOnTickEnd = throttleWithTickEnd(() => {\n  const payloads = pendingPayloads;\n  pendingPayloads = [];\n  worker?.postMessage({ payloads });\n});\n\nfunction postMessageOnTickEnd(payload: OriginPayload) {\n  pendingPayloads.push(payload);\n  postMessagesOnTickEnd();\n}\n\nexport function initApiOnMasterTab(initialArgs: ApiInitialArgs) {\n  channel.postMessage({\n    type: 'initApi',\n    token: getCurrentTabId(),\n    initialArgs,\n  });\n}\n\nlet updateCallback: OnApiUpdate;\n\nlet localApiRequestsQueue: {\n  fnName: any;\n  args: any;\n  deferred: Deferred<any>;\n}[] = [];\nlet apiRequestsQueue: { fnName: any; args: any; deferred: Deferred<any> }[] = [];\nlet isInited = false;\n\nexport function initApi(onUpdate: OnApiUpdate, initialArgs: ApiInitialArgs) {\n  updateCallback = onUpdate;\n\n  if (!isMasterTab) {\n    initApiOnMasterTab(initialArgs);\n    return Promise.resolve();\n  }\n\n  if (!worker) {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.log('>>> START LOAD WORKER');\n    }\n\n    const params = new URLSearchParams();\n    if (ACCOUNT_SLOT) {\n      params.set('account', String(ACCOUNT_SLOT));\n    }\n\n    worker = new Worker(new URL('./worker.ts', import.meta.url), {\n      name: params.toString(),\n    });\n    subscribeToWorker(onUpdate);\n\n    if (initialArgs.platform === 'iOS') {\n      setupIosHealthCheck();\n    }\n  }\n\n  return makeRequest({\n    type: 'initApi',\n    args: [initialArgs, savedLocalDb],\n  }).then(() => {\n    isInited = true;\n\n    apiRequestsQueue.forEach((request) => {\n      callApi(request.fnName, ...request.args)\n        .then(request.deferred.resolve)\n        .catch(request.deferred.reject);\n    });\n    apiRequestsQueue = [];\n\n    localApiRequestsQueue.forEach((request) => {\n      callApiLocal(request.fnName, ...request.args)\n        .then(request.deferred.resolve)\n        .catch(request.deferred.reject);\n    });\n    localApiRequestsQueue = [];\n  });\n}\n\nexport function updateLocalDb(name: keyof LocalDb, prop: string, value: any) {\n  savedLocalDb[name][prop] = value;\n}\n\nexport function updateFullLocalDb(initial: LocalDb) {\n  Object.assign(savedLocalDb, initial);\n}\n\nexport function callApiOnMasterTab(payload: any) {\n  channel.postMessage({\n    type: 'callApi',\n    token: getCurrentTabId(),\n    ...payload,\n  });\n}\n\nexport function setShouldEnableDebugLog(value: boolean) {\n  return makeRequest({\n    type: 'toggleDebugMode',\n    isEnabled: value,\n  });\n}\n\n/*\n * Call a worker method on this tab's worker, without transferring to master tab\n * Mostly needed to disconnect worker when re-electing master\n */\nexport function callApiLocal<T extends keyof Methods>(\n  fnName: T,\n  ...args: MethodArgs<T>\n) {\n  if (!isInited) {\n    if (NO_QUEUE_BEFORE_INIT.has(fnName)) {\n      return Promise.resolve(undefined) as MethodResponse<T>;\n    }\n\n    const deferred = new Deferred();\n    localApiRequestsQueue.push({ fnName, args, deferred });\n\n    return deferred.promise as MethodResponse<T>;\n  }\n\n  const promise = makeRequest({\n    type: 'callMethod',\n    name: fnName,\n    args,\n  });\n\n  // Some TypeScript magic to make sure `VirtualClass` is never returned from any method\n  if (DEBUG) {\n    (async () => {\n      try {\n        type ForbiddenTypes =\n          | Api.VirtualClass<any>\n          | (Api.VirtualClass<any> | undefined)[];\n        type ForbiddenResponses =\n          | ForbiddenTypes\n          | (AnyLiteral & { [k: string]: ForbiddenTypes });\n\n        // Unwrap all chained promises\n        const response = await promise;\n        // Make sure responses do not include `VirtualClass` instances\n        const allowedResponse: Exclude<typeof response, ForbiddenResponses> = response;\n        // Suppress \"unused variable\" constraint\n        void allowedResponse;\n      } catch (err) {\n        // Do noting\n      }\n    })();\n  }\n\n  return promise as MethodResponse<T>;\n}\n\nexport function callApi<T extends keyof Methods>(\n  fnName: T,\n  ...args: MethodArgs<T>\n) {\n  if (!isInited && isMasterTab) {\n    if (NO_QUEUE_BEFORE_INIT.has(fnName)) {\n      return Promise.resolve(undefined) as MethodResponse<T>;\n    }\n\n    const deferred = new Deferred();\n    apiRequestsQueue.push({ fnName, args, deferred });\n\n    return deferred.promise as MethodResponse<T>;\n  }\n\n  const promise = isMasterTab\n    ? makeRequest({\n      type: 'callMethod',\n      name: fnName,\n      args,\n    })\n    : makeRequestToMaster({\n      name: fnName,\n      args,\n    });\n\n  // Some TypeScript magic to make sure `VirtualClass` is never returned from any method\n  if (DEBUG) {\n    (async () => {\n      try {\n        type ForbiddenTypes =\n          | Api.VirtualClass<any>\n          | (Api.VirtualClass<any> | undefined)[];\n        type ForbiddenResponses =\n          | ForbiddenTypes\n          | (AnyLiteral & { [k: string]: ForbiddenTypes });\n\n        // Unwrap all chained promises\n        const response = await promise;\n        // Make sure responses do not include `VirtualClass` instances\n        const allowedResponse: Exclude<typeof response, ForbiddenResponses> = response;\n        // Suppress \"unused variable\" constraint\n        void allowedResponse;\n      } catch (err) {\n        // Do noting\n      }\n    })();\n  }\n\n  return promise as MethodResponse<T>;\n}\n\nexport function cancelApiProgress(progressCallback: ApiOnProgress) {\n  progressCallback.isCanceled = true;\n\n  const { messageId } = requestStatesByCallback.get(progressCallback) || {};\n  if (!messageId) {\n    return;\n  }\n\n  if (isMasterTab) {\n    cancelApiProgressMaster(messageId);\n  } else {\n    channel.postMessage({\n      type: 'cancelApiProgress',\n      token: getCurrentTabId(),\n      messageId,\n    });\n  }\n}\n\nexport function cancelApiProgressMaster(messageId: string) {\n  postMessageOnTickEnd({\n    type: 'cancelProgress',\n    messageId,\n  });\n}\n\nfunction sendToAIAgent(data: ApiUpdate) {\n  if (data['@type'] === 'newMessage') {\n    const hasTextContent = data.message && hasMessageText(data.message as ApiMessage);\n    if (hasTextContent) {\n      eventEmitter.emit(Actions.NewTextMessage, {\n        message: data.message,\n      });\n      ChatAIMessageQuene.add(data.message as ApiMessage);\n      const {\n        date, id, senderId, chatId,\n      } = data.message;\n      const messageContent = data.message?.content?.text?.text;\n      if (chatId && messageContent) {\n        const chatType = isUserId(chatId) ? 'private' : 'group';\n        messageEmbeddingStore.addText(messageContent, String(id), {\n          chatId,\n          senderId,\n          messageId: id,\n          timestamp: date,\n          chatType,\n          date: date ? new Date(date * 1000).toISOString().split('T')[0] : '0',\n        });\n      }\n      // const { autoTranslate } = getGlobal().settings.byKey;\n      // if (chatId && id && autoTranslate) {\n      //   getActions().requestMessageTranslation({\n      //     chatId,\n      //     id,\n      //   });\n      // }\n    }\n  }\n}\n\nfunction subscribeToWorker(onUpdate: OnApiUpdate) {\n  worker?.addEventListener('message', ({ data }: WorkerMessageEvent) => {\n    data?.payloads.forEach((payload) => {\n      if (payload.type === 'updates') {\n        // eslint-disable-next-line @typescript-eslint/naming-convention\n        let DEBUG_startAt: number | undefined;\n        if (DEBUG) {\n          DEBUG_startAt = performance.now();\n        }\n        payload.updates.forEach(sendToAIAgent);\n        payload.updates.forEach(onUpdate);\n\n        if (DEBUG) {\n          const duration = performance.now() - DEBUG_startAt!;\n          if (duration > 5) {\n            // eslint-disable-next-line no-console\n            console.warn(\n              `[API] Slow updates processing: ${payload.updates.length} updates in ${duration} ms`,\n            );\n          }\n        }\n      } else if (payload.type === 'methodResponse') {\n        handleMethodResponse(payload);\n      } else if (payload.type === 'methodCallback') {\n        handleMethodCallback(payload);\n      } else if (payload.type === 'unhandledError') {\n        const message = payload.error?.message;\n        if (message && IGNORE_UNHANDLED_ERRORS.has(message)) return;\n        throw new Error(message);\n      } else if (payload.type === 'sendBeacon') {\n        navigator.sendBeacon(payload.url, payload.data);\n      } else if (payload.type === 'debugLog') {\n        logDebugMessage(payload.level, ...payload.args);\n      }\n    });\n  });\n}\n\nexport function handleMethodResponse(data: {\n  messageId: string;\n  response?: ThenArg<MethodResponse<keyof Methods>>;\n  error?: { message: string };\n}) {\n  const requestState = requestStates.get(data.messageId);\n  if (requestState) {\n    if (data.error) {\n      requestState.reject(data.error);\n    } else {\n      requestState.resolve(data.response);\n    }\n  }\n}\n\nexport function handleMethodCallback(data: {\n  messageId: string;\n  callbackArgs: any[];\n}) {\n  requestStates.get(data.messageId)?.callback?.(...data.callbackArgs);\n}\n\nfunction makeRequestToMaster(message: {\n  messageId?: string;\n  name: keyof Methods;\n  args: MethodArgs<keyof Methods>;\n  withCallback?: boolean;\n}) {\n  const messageId = generateUniqueId();\n  const payload = {\n    messageId,\n    ...message,\n  };\n\n  const requestState = { messageId } as RequestState;\n\n  // Re-wrap type because of `postMessage`\n  const promise: Promise<MethodResponse<keyof Methods>> = new Promise(\n    (resolve, reject) => {\n      Object.assign(requestState, { resolve, reject });\n    },\n  );\n\n  if (\n    'args' in payload\n    && 'name' in payload\n    && typeof payload.args[1] === 'function'\n  ) {\n    payload.withCallback = true;\n\n    const callback = payload.args.pop() as AnyToVoidFunction;\n    requestState.callback = callback;\n    requestStatesByCallback.set(callback, requestState);\n  }\n\n  requestStates.set(messageId, requestState);\n\n  promise\n    .catch(() => undefined)\n    .finally(() => {\n      requestStates.delete(messageId);\n\n      if (requestState.callback) {\n        requestStatesByCallback.delete(requestState.callback);\n      }\n    });\n\n  callApiOnMasterTab(payload);\n\n  return promise;\n}\n\nfunction makeRequest(message: OriginPayload) {\n  const messageId = generateUniqueId();\n  const payload: OriginPayload = {\n    messageId,\n    ...message,\n  };\n\n  const requestState = { messageId } as RequestState;\n\n  // Re-wrap type because of `postMessage`\n  const promise: Promise<MethodResponse<keyof Methods>> = new Promise(\n    (resolve, reject) => {\n      Object.assign(requestState, { resolve, reject });\n    },\n  );\n\n  if (\n    'args' in payload\n    && 'name' in payload\n    && typeof payload.args[1] === 'function'\n  ) {\n    payload.withCallback = true;\n\n    const callback = payload.args.pop() as AnyToVoidFunction;\n    requestState.callback = callback;\n    requestStatesByCallback.set(callback, requestState);\n  }\n\n  requestState.DEBUG_payload = payload;\n\n  requestStates.set(messageId, requestState);\n\n  promise\n    .catch(() => undefined)\n    .finally(() => {\n      requestStates.delete(messageId);\n\n      if (requestState.callback) {\n        requestStatesByCallback.delete(requestState.callback);\n      }\n    });\n\n  postMessageOnTickEnd(payload);\n\n  return promise;\n}\n\nconst startedAt = Date.now();\n\n// Workaround for iOS sometimes stops interacting with worker\nfunction setupIosHealthCheck() {\n  window.addEventListener('focus', () => {\n    void ensureWorkerPing();\n    // Sometimes a single check is not enough\n    setTimeout(() => ensureWorkerPing(), 1000);\n  });\n}\n\nasync function ensureWorkerPing() {\n  let isResolved = false;\n\n  try {\n    await Promise.race([\n      makeRequest({ type: 'ping' }),\n      pause(HEALTH_CHECK_TIMEOUT).then(() => (isResolved\n        ? undefined\n        : Promise.reject(new Error('HEALTH_CHECK_TIMEOUT')))),\n    ]);\n  } catch (err) {\n    // eslint-disable-next-line no-console\n    console.error(err);\n\n    if (Date.now() - startedAt >= HEALTH_CHECK_MIN_DELAY) {\n      worker?.terminate();\n      worker = undefined;\n      updateCallback({ '@type': 'requestReconnectApi' });\n    }\n  } finally {\n    isResolved = true;\n  }\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"qEhgJEpm\",\"middle\":\"GjxPnwZR\",\"big\":\"HRLrnZvQ\",\"adaptive\":\"ebO2WJkv\",\"svg\":\"lbK6aMGA\",\"clickable\":\"hqg1cKl7\"};","import type { FC } from '../../../lib/teact/teact';\nimport React, { memo } from '../../../lib/teact/teact';\n\nimport buildClassName from '../../../util/buildClassName';\n\nimport useUniqueId from '../../../hooks/useUniqueId';\n\nimport styles from './StarIcon.module.scss';\n\ntype OwnProps = {\n  type?: 'gold' | 'premium' | 'regular';\n  size?: 'small' | 'middle' | 'big' | 'adaptive';\n  className?: string;\n  style?: string;\n  onClick?: VoidFunction;\n};\n\n/* eslint-disable max-len */\nconst STAR_PATH = 'M6.63869 12.1902L3.50621 14.1092C3.18049 14.3087 2.75468 14.2064 2.55515 13.8807C2.45769 13.7216 2.42864 13.5299 2.47457 13.3491L2.95948 11.4405C3.13452 10.7515 3.60599 10.1756 4.24682 9.86791L7.6642 8.22716C7.82352 8.15067 7.89067 7.95951 7.81418 7.80019C7.75223 7.67116 7.61214 7.59896 7.47111 7.62338L3.66713 8.28194C2.89387 8.41581 2.1009 8.20228 1.49941 7.69823L0.297703 6.69116C0.00493565 6.44581 -0.0335059 6.00958 0.211842 5.71682C0.33117 5.57442 0.502766 5.48602 0.687982 5.47153L4.35956 5.18419C4.61895 5.16389 4.845 4.99974 4.94458 4.75937L6.36101 1.3402C6.5072 0.987302 6.91179 0.819734 7.26469 0.965925C7.43413 1.03612 7.56876 1.17075 7.63896 1.3402L9.05539 4.75937C9.15496 4.99974 9.38101 5.16389 9.6404 5.18419L13.3322 5.47311C13.713 5.50291 13.9975 5.83578 13.9677 6.2166C13.9534 6.39979 13.8667 6.56975 13.7269 6.68896L10.9114 9.08928C10.7131 9.25826 10.6267 9.52425 10.6876 9.77748L11.5532 13.3733C11.6426 13.7447 11.414 14.1182 11.0427 14.2076C10.8642 14.2506 10.676 14.2208 10.5195 14.1249L7.36128 12.1902C7.13956 12.0544 6.8604 12.0544 6.63869 12.1902Z';\n/* eslint-enable max-len */\n\nconst StarIcon: FC<OwnProps> = ({\n  type = 'regular',\n  size = 'small',\n  className,\n  style,\n  onClick,\n}) => {\n  const randomId = useUniqueId();\n  const validSvgRandomId = `svg-${randomId}`; // ID must start with a letter\n\n  const renderIcon = () => {\n    switch (type) {\n      case 'gold':\n        return <GoldStarIcon randomId={validSvgRandomId} />;\n      case 'premium':\n        return <PremiumStarIcon randomId={validSvgRandomId} />;\n      default:\n        return <RegularStarIcon />;\n    }\n  };\n\n  return (\n    <i\n      onClick={onClick}\n      className={buildClassName(\n        'StarIcon',\n        styles.root,\n        className,\n        onClick && styles.clickable,\n        styles[size],\n      )}\n      style={style}\n    >\n      {renderIcon()}\n    </i>\n  );\n};\n\nfunction GoldStarIcon({ randomId }: { randomId: string }) {\n  const mask1Id = `${randomId}-mask1`;\n  const mask2Id = `${randomId}-mask2`;\n  const gradient1Id = `${randomId}-gradient1`;\n  const gradient2Id = `${randomId}-gradient2`;\n  const gradient3Id = `${randomId}-gradient3`;\n\n  return (\n    <svg className={styles.svg} width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n      <g clip-path=\"url(#clip0_4913_7387)\">\n        <mask id={mask1Id} style=\"mask-type:luminance\" maskUnits=\"userSpaceOnUse\" x=\"-2\" y=\"-2\" width=\"24\" height=\"24\">\n          <path d=\"M21.416 -1.42493H-1.08398V21.0751H21.416V-1.42493Z\" fill=\"white\" />\n        </mask>\n        <g mask={`url(#${mask1Id})`}>\n          <mask\n            id={mask2Id}\n            style=\"mask-type:luminance\"\n            maskUnits=\"userSpaceOnUse\"\n            x=\"-2\"\n            y=\"-2\"\n            width=\"24\"\n            height=\"24\"\n          >\n            <path d=\"M-1.08398 -1.42493H21.416V21.0751H-1.08398V-1.42493Z\" fill=\"white\" />\n          </mask>\n          <g mask={`url(#${mask2Id})`}>\n            <path d=\"M7.26843 6.25162L9.28943 2.22541C9.52311 1.76121 10.0884 1.5749 10.5494 1.80857C10.7294 1.90015 10.8747 2.04857 10.9662 2.23172L12.8767 6.11583C13.0314 6.43477 13.3378 6.64951 13.6883 6.69056L17.6829 7.17055C18.2261 7.23686 18.6145 7.73264 18.5513 8.27894C18.5229 8.50314 18.4218 8.71156 18.2608 8.86945L15.0998 11.9862C14.9703 12.1125 14.9103 12.2894 14.9324 12.4694L15.4598 16.6756C15.5356 17.2787 15.1093 17.8282 14.5093 17.904C14.2819 17.9324 14.0546 17.8913 13.8525 17.7808L10.5147 15.9556C10.2715 15.823 9.98099 15.8198 9.73784 15.9461L6.27687 17.7208C5.79057 17.9703 5.1969 17.7745 4.94743 17.285C4.8527 17.1019 4.82112 16.8966 4.84954 16.6945L5.12427 14.7619C5.26006 13.8177 5.84425 12.9967 6.69055 12.5641L10.5305 10.6031C10.6315 10.5526 10.6726 10.4263 10.622 10.322C10.581 10.2431 10.4957 10.1957 10.4073 10.2084L5.70847 10.8841C4.99164 10.9852 4.26535 10.7831 3.7001 10.322L2.13698 9.04629C1.69173 8.68314 1.6191 8.02 1.98225 7.57159C2.15277 7.36317 2.39592 7.22739 2.66118 7.19265L6.6716 6.67793C6.92739 6.64319 7.15159 6.4853 7.26843 6.25162Z\" fill={`url(#${gradient1Id})`} />\n            <path d=\"M10.8242 2.9422C10.4168 2.85062 9.98417 3.0464 9.78839 3.43797L7.76423 7.46419C7.64739 7.69787 7.42634 7.85576 7.1674 7.89049L3.15698 8.40837C2.89804 8.44311 2.6612 8.56942 2.49384 8.76837L3.97801 9.98097C4.44537 10.3631 5.05167 10.5304 5.64849 10.4452L10.3442 9.77255C10.6221 9.73466 10.8936 9.8736 11.0168 10.1231C11.1778 10.442 11.0515 10.8336 10.7326 10.9978L9.50734 11.623L10.9031 11.4209C10.9915 11.4083 11.0799 11.4557 11.1178 11.5346C11.1715 11.6388 11.1273 11.7651 11.0263 11.8157L7.18635 13.7767C6.34006 14.2093 5.75586 15.0303 5.62007 15.9745L5.44008 17.2282C5.60428 17.3924 5.86322 17.4366 6.07796 17.326L9.53261 15.5514C9.90839 15.3587 10.3536 15.365 10.7231 15.5671L14.0609 17.3924C14.1809 17.4587 14.3199 17.4839 14.4556 17.4682C14.8093 17.4239 15.0651 17.0955 15.0209 16.7324L14.4967 12.523C14.4588 12.2072 14.5662 11.8946 14.7904 11.6736L17.9513 8.55679C18.005 8.50311 18.0461 8.43995 18.0745 8.37048L14.1841 7.90312C13.8336 7.86207 13.5304 7.64418 13.3725 7.3284L13.2209 7.01578C12.902 6.87683 12.6399 6.63052 12.482 6.31159L10.8242 2.9422Z\" fill={`url(#${gradient2Id})`} />\n            <path d=\"M10.7484 1.41397C10.0663 1.06977 9.23893 1.3445 8.89789 2.02659L6.87373 6.05596C6.8232 6.15701 6.72531 6.22649 6.61478 6.23912L2.60436 6.757C2.22542 6.80437 1.87806 7.00015 1.63807 7.29699C1.12334 7.93486 1.22124 8.86958 1.85596 9.38746L3.42223 10.6664C4.08222 11.2032 4.93167 11.44 5.77165 11.32L9.09051 10.8432L6.48847 12.1727C5.51271 12.6716 4.84325 13.6126 4.68852 14.6989L4.41063 16.6315C4.36958 16.9252 4.41695 17.222 4.55273 17.4873C4.90956 18.1915 5.77481 18.4725 6.479 18.1125L9.93681 16.3378C10.0505 16.2778 10.1863 16.281 10.3 16.3441L13.6378 18.1662C13.9188 18.3209 14.2441 18.3841 14.563 18.343C15.4061 18.2357 15.9998 17.462 15.8956 16.622L15.3714 12.4126C15.3651 12.3716 15.3809 12.3274 15.4093 12.299L18.5703 9.1822C18.8008 8.95168 18.9492 8.65169 18.9871 8.32959C19.0787 7.5433 18.5229 6.82963 17.7366 6.73489L13.7388 6.25491C13.5399 6.2328 13.363 6.10649 13.2715 5.92334L11.3641 2.03606C11.2315 1.76765 11.0136 1.54976 10.7484 1.41397ZM9.68418 2.42132C9.80734 2.17501 10.1073 2.07712 10.3505 2.20027C10.4452 2.24764 10.5242 2.32974 10.5715 2.42763L12.482 6.31175C12.7031 6.76332 13.1357 7.06962 13.6346 7.12962L17.6324 7.60961C17.9324 7.64435 18.1471 7.91908 18.1124 8.22538C18.0966 8.3517 18.0398 8.46854 17.9513 8.55695L14.7904 11.6737C14.5662 11.8948 14.4588 12.2074 14.4967 12.5232L15.0209 16.7325C15.0651 17.0957 14.8093 17.4241 14.4556 17.4683C14.3199 17.4841 14.1809 17.4588 14.0609 17.3925L10.7231 15.5673C10.3536 15.3652 9.90839 15.362 9.53261 15.5547L6.0748 17.3294C5.80638 17.4652 5.47797 17.3578 5.33903 17.0862C5.2885 16.9852 5.26956 16.8683 5.28534 16.7546L5.56007 14.8252C5.67376 14.0231 6.17269 13.3253 6.88952 12.959L10.7294 10.9979C11.0515 10.8337 11.1778 10.4422 11.0168 10.1232C10.8905 9.87376 10.6221 9.73482 10.3442 9.77271L5.64534 10.4453C5.04851 10.5306 4.44537 10.3632 3.97801 9.98113L2.41489 8.70221C2.15595 8.49064 2.1149 8.10854 2.32647 7.8496C2.42436 7.72961 2.56331 7.65066 2.71488 7.63171L6.72531 7.11383C7.12951 7.06331 7.48003 6.81384 7.66318 6.45069L9.68418 2.42132Z\" fill={`url(#${gradient3Id})`} />\n          </g>\n        </g>\n      </g>\n      <defs>\n        <linearGradient\n          id={gradient1Id}\n          x1=\"10.1547\"\n          y1=\"1.70752\"\n          x2=\"10.1547\"\n          y2=\"17.9134\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stop-color=\"#FFF0C2\" />\n          <stop offset=\"1\" stop-color=\"#FFEBBA\" />\n        </linearGradient>\n        <linearGradient\n          id={gradient2Id}\n          x1=\"10.2842\"\n          y1=\"2.92009\"\n          x2=\"14.7304\"\n          y2=\"17.4713\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stop-color=\"#FFD147\" />\n          <stop offset=\"1\" stop-color=\"#FFB526\" />\n        </linearGradient>\n        <linearGradient\n          id={gradient3Id}\n          x1=\"10.1547\"\n          y1=\"1.26556\"\n          x2=\"14.0546\"\n          y2=\"18.3525\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stop-color=\"#E58F0D\" />\n          <stop offset=\"1\" stop-color=\"#EB7814\" />\n        </linearGradient>\n        <clipPath id=\"clip0_4913_7387\">\n          <rect width=\"20\" height=\"20\" fill=\"white\" />\n        </clipPath>\n      </defs>\n    </svg>\n  );\n}\n\nfunction PremiumStarIcon({ randomId }: { randomId: string }) {\n  return (\n    <svg className={styles.svg} width=\"14\" height=\"15\" viewBox=\"0 0 14 15\" fill=\"none\">\n      <defs>\n        <linearGradient id={randomId} x1=\"3\" y1=\"63.5001\" x2=\"84.1475\" y2=\"-1.32262\" gradientUnits=\"userSpaceOnUse\">\n          <stop stop-color=\"#6B93FF\" />\n          <stop offset=\"0.439058\" stop-color=\"#976FFF\" />\n          <stop offset=\"1\" stop-color=\"#E46ACE\" />\n        </linearGradient>\n      </defs>\n      <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d={STAR_PATH} fill={`url(#${randomId})`} />\n    </svg>\n  );\n}\n\nfunction RegularStarIcon() {\n  return (\n    <svg className={styles.svg} width=\"14\" height=\"15\" viewBox=\"0 0 14 15\" fill=\"none\">\n      <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d={STAR_PATH} fill=\"var(--color-fill)\" />\n    </svg>\n  );\n}\n\nexport default memo(StarIcon);\n","/* eslint-disable no-null/no-null */\nimport { getActions } from '../../../global';\n\nimport type { ApiDraft } from '../../../api/types';\nimport type { ApiMessage } from '../../../api/types/messages';\n\nimport { sendGAEvent } from '../utils/analytics';\nimport { knowledgeEmbeddingStore } from '../vector-store';\n\nclass IntelligentReplyTask {\n  private static instance: IntelligentReplyTask | undefined;\n\n  private pendingMessages: ApiMessage[] = [];\n\n  private timmer: NodeJS.Timeout | undefined;\n\n  initTask() {\n    if (this.timmer) {\n      clearInterval(this.timmer);\n    }\n    this.timmer = setInterval(() => {\n      this.intelligentResponse();\n    }, 1000 * 10);\n  }\n\n  static getTextWithoutEntities(text: string, entities: any[]): string {\n    const ranges = entities.map((entity) => ({ start: entity.offset, length: entity.length }));\n    const sortedRanges = ranges.sort((a, b) => b.start - a.start);\n\n    // eslint-disable-next-line @typescript-eslint/no-shadow\n    for (const { start, length } of sortedRanges) {\n      text = text.slice(0, start) + text.slice(start + length);\n    }\n    return text;\n  }\n\n  intelligentResponse() {\n    if (!this.pendingMessages) return;\n    const messages = this.pendingMessages.map((item) => {\n      return {\n        chatId: item.chatId,\n        senderId: item.senderId,\n        messageId: item.id,\n        content: item.content.text?.text,\n        entities: item.content.text?.entities,\n      };\n    });\n    messages.map(async (item) => {\n      const {\n        chatId, messageId, entities,\n      } = item;\n      let content = item.content || '';\n      if (content) {\n        if (entities && entities?.length > 0) {\n          content = IntelligentReplyTask.getTextWithoutEntities(content, entities);\n        }\n        const vectorSearchResults = await knowledgeEmbeddingStore.similaritySearch({\n          query: content,\n        });\n        if (vectorSearchResults.similarItems) {\n          const result:any = vectorSearchResults.similarItems[0];\n          if (result && result.score > 0.8) {\n            const threadId = -1; // Default to -1 for non-threaded messages\n            const replyInfo = {\n              type: 'message',\n              replyToMsgId: messageId,\n              replyToPeerId: undefined,\n            };\n            getActions().saveReplyDraft({\n              chatId,\n              threadId,\n              draft: { replyInfo } as ApiDraft,\n              isLocalOnly: true,\n            });\n            getActions().sendMessage({\n              messageList: {\n                chatId,\n                threadId,\n                type: 'thread',\n              },\n              text: result.metadata.answer,\n            });\n            getActions().clearDraft({ chatId, isLocalOnly: true });\n            sendGAEvent('intelligent_reply');\n          }\n        }\n      }\n    });\n    this.clearPendingMessages();\n  }\n\n  addNewMessage(message: ApiMessage) {\n    this.pendingMessages.push(message);\n  }\n\n  clearPendingMessages() {\n    this.pendingMessages = [];\n  }\n\n  getPendingMessages() {\n    return this.pendingMessages;\n  }\n\n  public static getInstance() {\n    if (!IntelligentReplyTask.instance) {\n      IntelligentReplyTask.instance = new IntelligentReplyTask();\n    }\n    return IntelligentReplyTask.instance;\n  }\n}\n\nexport const intelligentReplyTask = IntelligentReplyTask.getInstance();\n","export default class Deferred<T = void> {\n  promise: Promise<T>;\n\n  reject!: (reason?: any) => void;\n\n  resolve!: (value: T | PromiseLike<T>) => void;\n\n  constructor() {\n    this.promise = new Promise((resolve, reject) => {\n      this.reject = reject;\n      this.resolve = resolve;\n    });\n  }\n\n  static resolved(): Deferred<void>;\n  static resolved<T>(value: T): Deferred<T>;\n  static resolved<T>(value?: T): Deferred<T | void> {\n    const deferred = new Deferred<T | void>();\n    deferred.resolve(value);\n    return deferred;\n  }\n}\n","import { DEBUG } from '../../config';\n\ntype Handler = (e: Event) => void;\ntype DelegationRegistry = Map<Element, Handler>;\n\nconst NON_BUBBLEABLE_EVENTS = new Set(['scroll', 'mouseenter', 'mouseleave', 'load', 'error']);\n\nconst documentEventCounters: Record<string, number> = {};\nconst delegationRegistryByEventType: Record<string, DelegationRegistry> = {};\nconst delegatedEventTypesByElement = new Map<Element, Set<string>>();\n\nexport function addEventListener(element: Element, propName: string, handler: Handler, asCapture = false) {\n  const eventType = resolveEventType(propName, element);\n  if (canUseEventDelegation(eventType, element, asCapture)) {\n    addDelegatedListener(eventType, element, handler);\n  } else {\n    element.addEventListener(eventType, handler, asCapture);\n  }\n}\n\nexport function removeEventListener(element: Element, propName: string, handler: Handler, asCapture = false) {\n  const eventType = resolveEventType(propName, element);\n  if (canUseEventDelegation(eventType, element, asCapture)) {\n    removeDelegatedListener(eventType, element);\n  } else {\n    element.removeEventListener(eventType, handler, asCapture);\n  }\n}\n\nexport function resolveEventType(propName: string, element: Element) {\n  const eventType = propName\n    .replace(/^on/, '')\n    .replace(/Capture$/, '').toLowerCase();\n\n  if (eventType === 'change' && element.tagName !== 'SELECT') {\n    // React behavior repeated here.\n    // https://stackoverflow.com/questions/38256332/in-react-whats-the-difference-between-onchange-and-oninput\n    return 'input';\n  }\n\n  if (eventType === 'doubleclick') {\n    return 'dblclick';\n  }\n\n  // Replace focus/blur by their \"bubbleable\" versions\n  if (eventType === 'focus') {\n    return 'focusin';\n  }\n\n  if (eventType === 'blur') {\n    return 'focusout';\n  }\n\n  return eventType;\n}\n\nfunction canUseEventDelegation(realEventType: string, element: Element, asCapture: boolean) {\n  return (\n    !asCapture\n    && !NON_BUBBLEABLE_EVENTS.has(realEventType)\n    && element.tagName !== 'VIDEO'\n    && element.tagName !== 'IFRAME'\n  );\n}\n\nfunction addDelegatedListener(eventType: string, element: Element, handler: Handler) {\n  if (!documentEventCounters[eventType]) {\n    documentEventCounters[eventType] = 0;\n    document.addEventListener(eventType, handleEvent);\n  }\n\n  resolveDelegationRegistry(eventType).set(element, handler);\n  resolveDelegatedEventTypes(element).add(eventType);\n  documentEventCounters[eventType]++;\n}\n\nfunction removeDelegatedListener(eventType: string, element: Element) {\n  documentEventCounters[eventType]--;\n  if (!documentEventCounters[eventType]) {\n    // Synchronous deletion on 0 will cause perf degradation in the case of 1 element\n    // which is not a real case, so it's ok to do it this way\n    document.removeEventListener(eventType, handleEvent);\n  }\n\n  delegationRegistryByEventType[eventType].delete(element);\n  delegatedEventTypesByElement.get(element)!.delete(eventType);\n}\n\nexport function removeAllDelegatedListeners(element: Element) {\n  const eventTypes = delegatedEventTypesByElement.get(element);\n  if (!eventTypes) {\n    return;\n  }\n\n  eventTypes.forEach((eventType) => removeDelegatedListener(eventType, element));\n  delegatedEventTypesByElement.delete(element);\n}\n\nfunction handleEvent(realEvent: Event) {\n  const events = delegationRegistryByEventType[realEvent.type];\n\n  if (events) {\n    let furtherCallsPrevented = false;\n    let current: Element = realEvent.target as Element;\n\n    const stopPropagation = () => {\n      furtherCallsPrevented = true;\n    };\n\n    const preventDefault = () => {\n      realEvent.preventDefault();\n    };\n\n    // Proxy is a simplest way to provide an access to the event property\n    const event = new Proxy(realEvent, {\n      get(target, p) {\n        if (p === 'currentTarget') {\n          return current;\n        }\n        if (p === 'stopPropagation' || p === 'stopImmediatePropagation') {\n          return stopPropagation;\n        }\n        if (p === 'preventDefault') {\n          // \"this\" is changed to proxy and one can't call methods via it\n          return preventDefault;\n        }\n        return Reflect.get(target, p);\n      },\n    });\n\n    // This can also be limited by teact root\n    while (current && current !== document.body) {\n      const handler = events.get(current);\n      if (handler) {\n        handler(event);\n        if (furtherCallsPrevented) {\n          return;\n        }\n      }\n\n      current = current.parentNode as Element;\n    }\n  }\n}\n\nfunction resolveDelegationRegistry(eventType: string) {\n  if (!delegationRegistryByEventType[eventType]) {\n    delegationRegistryByEventType[eventType] = new Map();\n  }\n\n  return delegationRegistryByEventType[eventType];\n}\n\nfunction resolveDelegatedEventTypes(element: Element) {\n  const existing = delegatedEventTypesByElement.get(element);\n  if (existing) {\n    return existing;\n  }\n\n  const newSet = new Set<string>();\n  delegatedEventTypesByElement.set(element, newSet);\n\n  return newSet;\n}\n\nif (DEBUG) {\n  document.addEventListener('dblclick', () => {\n    const documentListenersCount = Object.keys(documentEventCounters).length;\n    const delegatedHandlersCount1 = Object.values(documentEventCounters)\n      .reduce((acc, counter) => acc + counter, 0);\n    const delegationRegistriesCount = Object.keys(delegationRegistryByEventType).length;\n    const delegatedHandlersCount2 = Object.values(delegationRegistryByEventType)\n      .reduce((acc, delegationRegistry) => acc + delegationRegistry.size, 0);\n    const delegationElementsCount = delegatedEventTypesByElement.size;\n    const delegatedEventTypesCount = Array.from(delegatedEventTypesByElement.values())\n      .reduce((acc, eventTypes) => acc + eventTypes.size, 0);\n\n    // eslint-disable-next-line no-console\n    console.warn('DELEGATED EVENTS STATS', {\n      delegatedHandlersCount1,\n      delegatedHandlersCount2,\n      delegatedEventTypesCount,\n      delegationRegistriesCount,\n      delegationElementsCount,\n      documentListenersCount,\n    });\n  });\n}\n","import type { RefObject } from 'react';\nimport { useEffect, useState } from '../lib/teact/teact';\n\nimport { requestMeasure, requestMutation } from '../lib/fasterdom/fasterdom';\nimport useLastCallback from './useLastCallback';\n\nconst useKeyboardListNavigation = (\n  elementRef: RefObject<HTMLElement>,\n  isOpen: boolean,\n  onSelectWithEnter?: (index: number) => void,\n  itemSelector?: string,\n  noCaptureFocus?: boolean,\n) => {\n  const [focusedIndex, setFocusedIndex] = useState(-1);\n\n  useEffect(() => {\n    setFocusedIndex(-1);\n\n    const element = elementRef.current;\n    if (isOpen && element && !noCaptureFocus) {\n      requestMutation(() => { element.tabIndex = -1; });\n      requestMeasure(() => element.focus());\n    }\n  }, [elementRef, isOpen, noCaptureFocus]);\n\n  return useLastCallback((e: React.KeyboardEvent<any>) => {\n    const element = elementRef.current;\n\n    if (!element) {\n      return;\n    }\n\n    if (e.keyCode === 13 && onSelectWithEnter) {\n      onSelectWithEnter(focusedIndex);\n      return;\n    }\n\n    if (e.keyCode !== 38 && e.keyCode !== 40) {\n      return;\n    }\n\n    const focusedElement = document.activeElement;\n    const elementChildren = Array.from(itemSelector ? element.querySelectorAll(itemSelector) : element.children);\n\n    let newIndex = (focusedElement && elementChildren.indexOf(focusedElement)) || focusedIndex;\n\n    if (e.keyCode === 38 && newIndex > 0) {\n      newIndex--;\n    } else if (e.keyCode === 40 && newIndex < elementChildren.length - 1) {\n      newIndex++;\n    } else if (elementChildren.length === 1) {\n      newIndex = 0;\n    } else {\n      return;\n    }\n\n    const item = elementChildren[newIndex] as HTMLElement;\n    if (item) {\n      setFocusedIndex(newIndex);\n      item.focus();\n    }\n  });\n};\n\nexport default useKeyboardListNavigation;\n","import { addCallback } from '../../../lib/teact/teactn';\n\nimport type { ActionReturnType, GlobalState } from '../../types';\nimport { type LangCode, SettingsScreens } from '../../../types';\n\nimport { requestMutation } from '../../../lib/fasterdom/fasterdom';\nimport { IS_IOS } from '../../../util/browser/windowEnvironment';\nimport { disableDebugConsole, initDebugConsole } from '../../../util/debugConsole';\nimport { getCurrentTabId } from '../../../util/establishMultitabRole';\nimport { oldSetLanguage, setTimeFormat } from '../../../util/oldLangProvider';\nimport { applyPerformanceSettings } from '../../../util/perfomanceSettings';\nimport switchTheme from '../../../util/switchTheme';\nimport { updatePeerColors } from '../../../util/theme';\nimport { callApi, setShouldEnableDebugLog } from '../../../api/gramjs';\nimport {\n  addActionHandler, getActions, setGlobal,\n} from '../../index';\nimport { replaceSettings, updateSharedSettings, updateThemeSettings } from '../../reducers';\nimport { updateTabState } from '../../reducers/tabs';\nimport { selectCanAnimateInterface, selectChatFolder } from '../../selectors';\nimport { selectSharedSettings } from '../../selectors/sharedState';\n\nlet prevGlobal: GlobalState | undefined;\n\naddCallback((global: GlobalState) => {\n  // eslint-disable-next-line eslint-multitab-tt/no-getactions-in-actions\n  const { updatePageTitle, updateShouldDebugExportedSenders, updateShouldEnableDebugLog } = getActions();\n\n  const oldGlobal = prevGlobal;\n  prevGlobal = global;\n\n  if (!oldGlobal) return;\n\n  const oldSharedSettings = selectSharedSettings(oldGlobal);\n  const sharedSettings = selectSharedSettings(global);\n\n  const performance = sharedSettings.performance;\n  const prevPerformance = oldSharedSettings.performance;\n  const peerColors = global.peerColors;\n  const prevPeerColors = oldGlobal.peerColors;\n\n  if (peerColors && peerColors !== prevPeerColors) {\n    updatePeerColors(peerColors.general);\n  }\n\n  if (performance !== prevPerformance) {\n    requestMutation(() => {\n      applyPerformanceSettings(performance);\n    });\n  }\n\n  if (sharedSettings.theme !== oldSharedSettings.theme) {\n    const withAnimation = document.hasFocus() ? selectCanAnimateInterface(global) : false;\n    switchTheme(sharedSettings.theme, withAnimation);\n  }\n\n  if (sharedSettings.language !== oldSharedSettings.language) {\n    oldSetLanguage(sharedSettings.language as LangCode);\n  }\n\n  if (sharedSettings.timeFormat !== oldSharedSettings.timeFormat) {\n    setTimeFormat(sharedSettings.timeFormat);\n  }\n\n  if (sharedSettings.messageTextSize !== oldSharedSettings.messageTextSize) {\n    document.documentElement.style.setProperty(\n      '--composer-text-size', `${Math.max(sharedSettings.messageTextSize, IS_IOS ? 16 : 15)}px`,\n    );\n    document.documentElement.style.setProperty('--message-meta-height',\n      `${Math.floor(sharedSettings.messageTextSize * 1.3125)}px`);\n    document.documentElement.style.setProperty('--message-text-size', `${sharedSettings.messageTextSize}px`);\n    document.documentElement.setAttribute('data-message-text-size', sharedSettings.messageTextSize.toString());\n  }\n\n  if (sharedSettings.canDisplayChatInTitle !== oldSharedSettings.canDisplayChatInTitle) {\n    updatePageTitle();\n  }\n\n  if (sharedSettings.shouldForceHttpTransport !== oldSharedSettings.shouldForceHttpTransport) {\n    callApi('setForceHttpTransport', Boolean(sharedSettings.shouldForceHttpTransport));\n  }\n\n  if (sharedSettings.shouldAllowHttpTransport !== oldSharedSettings.shouldAllowHttpTransport) {\n    callApi('setAllowHttpTransport', Boolean(sharedSettings.shouldAllowHttpTransport));\n    if (!sharedSettings.shouldAllowHttpTransport && sharedSettings.shouldForceHttpTransport) {\n      global = updateSharedSettings(global, {\n        shouldForceHttpTransport: false,\n      });\n      setGlobal(global);\n    }\n  }\n\n  if (sharedSettings.shouldDebugExportedSenders !== oldSharedSettings.shouldDebugExportedSenders) {\n    updateShouldDebugExportedSenders();\n  }\n\n  if (sharedSettings.shouldCollectDebugLogs !== oldSharedSettings.shouldCollectDebugLogs) {\n    updateShouldEnableDebugLog();\n  }\n});\n\naddActionHandler('updateShouldEnableDebugLog', (global): ActionReturnType => {\n  const settings = selectSharedSettings(global);\n\n  if (settings.shouldCollectDebugLogs) {\n    setShouldEnableDebugLog(true);\n    initDebugConsole();\n  } else {\n    setShouldEnableDebugLog(false);\n    disableDebugConsole();\n  }\n});\n\naddActionHandler('updateShouldDebugExportedSenders', (global): ActionReturnType => {\n  const settings = selectSharedSettings(global);\n  callApi('setShouldDebugExportedSenders', Boolean(settings.shouldDebugExportedSenders));\n});\n\naddActionHandler('setSettingOption', (global, actions, payload): ActionReturnType => {\n  return replaceSettings(global, payload);\n});\n\naddActionHandler('setSharedSettingOption', (global, actions, payload): ActionReturnType => {\n  return updateSharedSettings(global, payload);\n});\n\naddActionHandler('updatePerformanceSettings', (global, actions, payload): ActionReturnType => {\n  const settings = selectSharedSettings(global);\n  global = updateSharedSettings(global, {\n    performance: {\n      ...settings.performance,\n      ...payload,\n    },\n  });\n\n  return global;\n});\n\naddActionHandler('setThemeSettings', (global, actions, payload): ActionReturnType => {\n  const { theme, ...settings } = payload;\n\n  return updateThemeSettings(global, theme, settings);\n});\n\naddActionHandler('requestNextSettingsScreen', (global, actions, payload): ActionReturnType => {\n  const { screen, foldersAction, tabId = getCurrentTabId() } = payload;\n  return updateTabState(global, {\n    nextSettingsScreen: screen,\n    nextFoldersAction: foldersAction,\n  }, tabId);\n});\n\naddActionHandler('openEditChatFolder', (global, actions, payload): ActionReturnType => {\n  const { folderId, isOnlyInvites, tabId = getCurrentTabId() } = payload;\n\n  const chatFolder = selectChatFolder(global, folderId);\n  if (!chatFolder) return;\n\n  actions.requestNextSettingsScreen({\n    screen: isOnlyInvites ? SettingsScreens.FoldersEditFolderInvites : SettingsScreens.FoldersEditFolderFromChatList,\n    foldersAction: {\n      type: 'editFolder',\n      payload: chatFolder,\n    },\n    tabId,\n  });\n});\n\naddActionHandler('openShareChatFolderModal', (global, actions, payload): ActionReturnType => {\n  const {\n    folderId, url, noRequestNextScreen, tabId = getCurrentTabId(),\n  } = payload;\n\n  const chatFolder = selectChatFolder(global, folderId);\n  const isChatList = chatFolder?.isChatList;\n  if (isChatList && !noRequestNextScreen) {\n    actions.openEditChatFolder({ folderId, isOnlyInvites: true, tabId });\n    return undefined;\n  }\n\n  if (!noRequestNextScreen) actions.requestNextSettingsScreen({ screen: SettingsScreens.FoldersShare, tabId });\n\n  return updateTabState(global, {\n    shareFolderScreen: {\n      folderId,\n      isFromSettings: Boolean(noRequestNextScreen),\n      url,\n    },\n  }, tabId);\n});\n\naddActionHandler('closeShareChatFolderModal', (global, actions, payload): ActionReturnType => {\n  const { tabId = getCurrentTabId() } = payload || {};\n\n  actions.requestNextSettingsScreen({ screen: undefined, tabId });\n\n  return updateTabState(global, {\n    shareFolderScreen: undefined,\n  }, tabId);\n});","export const MIN_USERNAME_LENGTH = 3; // Some bots have 3-letter usernames\nexport const MIN_UPDATE_USERNAME_LENGTH = 5; // 4 letter usernames are only available on Fragment\nexport const MAX_USERNAME_LENGTH = 32;\nexport const USERNAME_REGEX = /^[a-zA-Z]\\w+$/;\n\nexport function isUsernameValid(username: string, isUpdating?: boolean) {\n  const minUsernameLength = isUpdating ? MIN_UPDATE_USERNAME_LENGTH : MIN_USERNAME_LENGTH;\n  return username.length >= minUsernameLength\n    && username.length <= MAX_USERNAME_LENGTH\n    && USERNAME_REGEX.test(username);\n}\n","import captureKeyboardListener from './captureKeyboardListeners';\n\ntype IHandlerFunction = () => void;\n\nexport default function captureEscKeyListener(handler: IHandlerFunction) {\n  return captureKeyboardListener({ onEsc: handler });\n}\n","import type { ActionOptions } from '../lib/teact/teactn';\nimport { typify } from '../lib/teact/teactn';\n\nimport type {\n  ActionPayloads, GlobalState, RequiredActionPayloads, RequiredGlobalState,\n} from './types';\n\nconst typed = typify<GlobalState, ActionPayloads & RequiredActionPayloads>();\n\ntype ProjectActionTypes =\n  ActionPayloads\n  & RequiredActionPayloads;\n\ntype ProjectActionNames = keyof ProjectActionTypes;\n\ntype Helper<T, E> = Exclude<T, E> extends never ? {} : Exclude<T, E>;\n\nexport type TabStateActionNames = {\n  [ActionName in ProjectActionNames]:\n  'tabId' extends keyof Helper<ProjectActionTypes[ActionName], undefined> ? ActionName : never\n}[ProjectActionNames];\n// `Required` actions are called from actions to ensure the `tabId` is always provided if needed.\n// There are three types of actions:\n// 1. With tabId, which is made required when calling action from another action handler\n// 2. Without payload (= undefined), hence made the payload not required\n// 3. With payload, hence made the payload required\nexport type RequiredGlobalActions = {\n  [ActionName in ProjectActionNames]: ActionName extends TabStateActionNames ? ((\n    payload: ProjectActionTypes[ActionName] & { tabId: number },\n    options?: ActionOptions,\n  ) => void) :\n    (undefined extends ProjectActionTypes[ActionName] ? (\n      (payload?: ProjectActionTypes[ActionName], options?: ActionOptions) => void\n    ) : (\n      (payload: ProjectActionTypes[ActionName], options?: ActionOptions) => void\n    ))\n} & { _: never };\n\ntype ActionHandlers = {\n  [ActionName in keyof ProjectActionTypes]: (\n    global: RequiredGlobalState,\n    actions: RequiredGlobalActions,\n    payload: ProjectActionTypes[ActionName],\n  ) => GlobalState | void | Promise<void>;\n};\n\nexport const getGlobal = typed.getGlobal;\nexport const setGlobal = typed.setGlobal;\nexport const getActions = typed.getActions;\nexport const addActionHandler = typed.addActionHandler as <ActionName extends ProjectActionNames>(\n  name: ActionName,\n  handler: ActionHandlers[ActionName],\n) => void;\nexport const withGlobal = typed.withGlobal;\nexport type GlobalActions = ReturnType<typeof getActions>;\n","export default function generateUniqueId() {\n  return Date.now().toString(36) + Math.random().toString(36).slice(2);\n}\n","import type { OldLangFn } from '../hooks/useOldLang';\nimport type { LangFn } from './localization';\n\nimport EMOJI_REGEX from '../lib/twemojiRegex';\nimport fixNonStandardEmoji from './emoji/fixNonStandardEmoji';\nimport { floor } from './math';\nimport withCache from './withCache';\n\nexport function formatInteger(value: number) {\n  return String(value).replace(/\\d(?=(\\d{3})+$)/g, '$& ');\n}\n\nexport function formatIntegerCompact(lang: LangFn, views: number) {\n  if (views < 1e3) {\n    return lang.number(views);\n  }\n\n  if (views < 1e6) {\n    return `${lang.number(floor(views / 1e3, 1))}K`;\n  }\n\n  return `${lang.number(floor(views / 1e6, 1))}M`;\n}\n\nexport function formatPercent(value: number, fractionDigits = 1) {\n  return `${Number.isInteger(value) ? value : value.toFixed(fractionDigits)}%`;\n}\n\nexport const getFirstLetters = withCache((phrase: string, count = 2) => {\n  return phrase\n    .replace(/[.,!@#$%^&*()_+=\\-`~[\\]/\\\\{}:\"|<>?]+/gi, '')\n    .trim()\n    .split(/\\s+/)\n    .slice(0, count)\n    .map((word: string) => {\n      if (!word.length) return '';\n      word = fixNonStandardEmoji(word);\n      const emojis = word.match(EMOJI_REGEX);\n      if (emojis && word.startsWith(emojis[0])) {\n        return emojis[0];\n      }\n      return word.match(/./u)![0].toUpperCase();\n    })\n    .join('');\n});\n\nconst FILE_SIZE_UNITS = ['B', 'KB', 'MB', 'GB'];\nexport function formatFileSize(lang: OldLangFn, bytes: number, decimals = 1): string {\n  if (bytes === 0) {\n    return lang('FileSize.B', 0);\n  }\n\n  const k = 1024;\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n  const value = (bytes / (k ** i)).toFixed(Math.max(decimals, 0));\n\n  return lang(`FileSize.${FILE_SIZE_UNITS[i]}`, value);\n}\n","import { createCallbackManager } from './callbacks';\nimport { ESTABLISH_BROADCAST_CHANNEL_NAME } from './multiaccount';\nimport { getPasscodeHash, setPasscodeHash } from './passcode';\n\nimport Deferred from './Deferred';\n\nconst ESTABLISH_TIMEOUT = 100;\n\nconst { addCallback, runCallbacks } = createCallbackManager();\nconst { addCallback: addCallbackTokenDied, runCallbacks: runCallbacksTokenDied } = createCallbackManager();\nconst token = Number(Math.random().toString().substring(2));\nconst collectedTokens = new Set([token]);\nconst channel = new BroadcastChannel(ESTABLISH_BROADCAST_CHANNEL_NAME);\n\nlet isEstablished = false;\nconst initialEstablishment = new Deferred();\nlet masterToken: number | undefined;\nlet isWaitingForMaster = false;\nlet reestablishToken: number | undefined;\n\ntype EstablishMessage = {\n  collectedTokens: Set<number>;\n  masterToken?: number;\n  tokenDied?: number;\n  currentPasscodeHash?: ArrayBuffer;\n  reestablishToken?: number;\n  shouldGiveUpMaster?: boolean;\n  hasGaveUpMaster?: boolean;\n};\n\nconst handleMessage = ({ data }: { data: EstablishMessage }) => {\n  if (!data) return;\n\n  if (data.currentPasscodeHash) {\n    setPasscodeHash(data.currentPasscodeHash);\n  }\n\n  if (data.hasGaveUpMaster && isWaitingForMaster) {\n    masterToken = token;\n    isWaitingForMaster = false;\n    initialEstablishment.resolve();\n    runCallbacks(true);\n    return;\n  }\n\n  if (data.shouldGiveUpMaster) {\n    if (masterToken === token) {\n      runCallbacks(false);\n      channel.postMessage({ currentPasscodeHash: getPasscodeHash(), hasGaveUpMaster: true });\n    }\n    masterToken = data.masterToken;\n    return;\n  }\n\n  if (data.tokenDied) {\n    runCallbacksTokenDied(data.tokenDied);\n    collectedTokens.delete(data.tokenDied);\n    if (data.tokenDied === masterToken) {\n      collectedTokens.delete(data.tokenDied);\n      masterToken = undefined;\n      isEstablished = false;\n      reestablishToken = data.tokenDied;\n\n      channel.postMessage({\n        collectedTokens,\n        masterToken,\n        reestablishToken,\n      });\n      if (collectedTokens.size === 1) {\n        isEstablished = true;\n        masterToken = token;\n        reestablishToken = undefined;\n        initialEstablishment.resolve();\n        runCallbacks(true);\n      }\n    }\n  }\n\n  if (data.collectedTokens) {\n    if (!data.reestablishToken && reestablishToken) {\n      return;\n    }\n    if (data.reestablishToken && reestablishToken !== data.reestablishToken) {\n      data.collectedTokens.delete(data.reestablishToken);\n\n      reestablishToken = data.reestablishToken;\n    }\n    const prevLength = collectedTokens.size;\n    data.collectedTokens.forEach((l) => collectedTokens.add(l));\n    if (reestablishToken) data.collectedTokens.delete(reestablishToken);\n\n    if (!isEstablished) {\n      if (data.masterToken) {\n        reestablishToken = undefined;\n        masterToken = data.masterToken;\n        runCallbacks(masterToken === token);\n\n        if (!isEstablished) {\n          channel.postMessage({\n            collectedTokens,\n            masterToken,\n            reestablishToken,\n          });\n        }\n        initialEstablishment.resolve();\n        isEstablished = true;\n      } else if (prevLength !== collectedTokens.size) {\n        channel.postMessage({\n          collectedTokens,\n          masterToken,\n          reestablishToken,\n        });\n      } else {\n        reestablishToken = undefined;\n        masterToken = Math.max(...Array.from(collectedTokens));\n        runCallbacks(masterToken === token);\n\n        if (!isEstablished) {\n          channel.postMessage({\n            collectedTokens,\n            masterToken,\n            reestablishToken,\n          });\n        }\n        initialEstablishment.resolve();\n        isEstablished = true;\n      }\n    } else if (!data.masterToken) {\n      channel.postMessage({\n        collectedTokens,\n        masterToken,\n        reestablishToken,\n      });\n    }\n  }\n};\n\nexport function establishMultitabRole(shouldReestablishMasterToSelf?: boolean) {\n  channel.addEventListener('message', handleMessage);\n\n  channel.postMessage({ collectedTokens });\n\n  // To make the connection faster, we can ignore the waiting and connect right away,\n  // and then if we realize we're not master, drop the connection\n  setTimeout(() => {\n    if (masterToken === undefined) {\n      masterToken = token;\n      initialEstablishment.resolve();\n      runCallbacks(true);\n    } else if (shouldReestablishMasterToSelf) {\n      reestablishMasterToSelf();\n    }\n  }, ESTABLISH_TIMEOUT);\n\n  window.addEventListener('beforeunload', signalTokenDead);\n}\n\nexport function signalTokenDead() {\n  runCallbacksTokenDied(token);\n  channel.removeEventListener('message', handleMessage);\n  channel.postMessage({ tokenDied: token, currentPasscodeHash: getPasscodeHash() });\n  channel.close();\n}\n\nexport function signalPasscodeHash() {\n  channel.postMessage({ currentPasscodeHash: getPasscodeHash() });\n}\n\nexport function getCurrentTabId() {\n  return token;\n}\n\nexport function getAllMultitabTokens() {\n  return Array.from(collectedTokens);\n}\n\nexport function reestablishMasterToSelf() {\n  isWaitingForMaster = true;\n  channel.postMessage({\n    collectedTokens, masterToken: token, shouldGiveUpMaster: true,\n  });\n}\n\nexport const subscribeToTokenDied = addCallbackTokenDied;\nexport const subscribeToMasterChange = addCallback;\n\nexport const initialEstablishmentPromise = initialEstablishment.promise;\n\nexport function isCurrentTabMaster() {\n  return masterToken === token;\n}","import { useRef } from '../lib/teact/teact';\n\nimport generateUniqueId from '../util/generateUniqueId';\n\nexport default function useUniqueId() {\n  const idRef = useRef<string>();\n\n  if (!idRef.current) {\n    idRef.current = generateUniqueId();\n  }\n\n  return idRef.current;\n}\n","import { useEffect } from '../lib/teact/teact';\n\nfunction useEffectOnce(effect: React.EffectCallback) {\n  // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  useEffect(effect, []);\n}\n\nexport default useEffectOnce;\n","import type {\n  ApiChat, ApiChatFullInfo, ApiChatMember,\n} from '../../api/types';\nimport type { ChatListType } from '../../types';\nimport type { GlobalState } from '../types';\n\nimport { ARCHIVED_FOLDER_ID } from '../../config';\nimport { areDeepEqual } from '../../util/areDeepEqual';\nimport {\n  areSortedArraysEqual, buildCollectionByKey, omit, omitUndefined, pick, unique,\n} from '../../util/iteratees';\nimport { selectChatFullInfo } from '../selectors';\n\nconst DEFAULT_CHAT_LISTS: ChatListType[] = ['active', 'archived'];\n\nexport function replaceChatListIds<T extends GlobalState>(\n  global: T,\n  type: ChatListType,\n  newIds: string[] | undefined,\n): T {\n  return {\n    ...global,\n    chats: {\n      ...global.chats,\n      listIds: {\n        ...global.chats.listIds,\n        [type]: newIds,\n      },\n    },\n  };\n}\n\nexport function replaceChatListLoadingParameters<T extends GlobalState>(\n  global: T, type: ChatListType, nextOffsetId?: number, nextOffsetPeerId?: string, nextOffsetDate?: number,\n): T {\n  return {\n    ...global,\n    chats: {\n      ...global.chats,\n      loadingParameters: {\n        ...global.chats.loadingParameters,\n        [type]: {\n          nextOffsetId,\n          nextOffsetPeerId,\n          nextOffsetDate,\n        },\n      },\n    },\n  };\n}\n\nexport function updateChatLastMessageId<T extends GlobalState>(\n  global: T, chatId: string, lastMessageId: number, listType?: ChatListType,\n): T {\n  const key = listType === 'saved' ? 'saved' : 'all';\n  return {\n    ...global,\n    chats: {\n      ...global.chats,\n      lastMessageIds: {\n        ...global.chats.lastMessageIds,\n        [key]: {\n          ...global.chats.lastMessageIds[key],\n          [chatId]: lastMessageId,\n        },\n      },\n    },\n  };\n}\n\nexport function updateChatsLastMessageId<T extends GlobalState>(\n  global: T, messageIds: Record<string, number>, listType?: ChatListType,\n): T {\n  const key = listType === 'saved' ? 'saved' : 'all';\n  return {\n    ...global,\n    chats: {\n      ...global.chats,\n      lastMessageIds: {\n        ...global.chats.lastMessageIds,\n        [key]: {\n          ...global.chats.lastMessageIds[key],\n          ...messageIds,\n        },\n      },\n    },\n  };\n}\n\nexport function addChatListIds<T extends GlobalState>(\n  global: T, type: ChatListType, idsUpdate: string[],\n): T {\n  const { [type]: listIds } = global.chats.listIds;\n  const newIds = listIds?.length\n    ? idsUpdate.filter((id) => !listIds.includes(id))\n    : idsUpdate;\n\n  if (listIds && !newIds.length) {\n    return global;\n  }\n\n  return replaceChatListIds(global, type, [\n    ...(listIds || []),\n    ...newIds,\n  ]);\n}\n\nexport function replaceChats<T extends GlobalState>(global: T, newById: Record<string, ApiChat>): T {\n  return {\n    ...global,\n    chats: {\n      ...global.chats,\n      byId: newById,\n    },\n  };\n}\n\nexport function addUnreadMentions<T extends GlobalState>(\n  global: T, chatId: string, chat: ApiChat, ids: number[], shouldUpdateCount: boolean = false,\n): T {\n  const prevChatUnreadMentions = (chat.unreadMentions || []);\n  const updatedUnreadMentions = unique([...prevChatUnreadMentions, ...ids]).sort((a, b) => b - a);\n  global = updateChat(global, chatId, {\n    unreadMentions: updatedUnreadMentions,\n  });\n\n  if (shouldUpdateCount) {\n    const updatedUnreadMentionsCount = (chat.unreadMentionsCount || 0)\n    + Math.max(0, updatedUnreadMentions.length - prevChatUnreadMentions.length);\n\n    global = updateChat(global, chatId, {\n      unreadMentionsCount: updatedUnreadMentionsCount,\n    });\n  }\n  return global;\n}\n\nexport function removeUnreadMentions<T extends GlobalState>(\n  global: T, chatId: string, chat: ApiChat, ids: number[], shouldUpdateCount: boolean = false,\n): T {\n  const prevChatUnreadMentions = (chat.unreadMentions || []);\n  const updatedUnreadMentions = prevChatUnreadMentions?.filter((id) => !ids.includes(id));\n\n  global = updateChat(global, chatId, {\n    unreadMentions: updatedUnreadMentions,\n  });\n\n  if (shouldUpdateCount && chat.unreadMentionsCount) {\n    const removedCount = prevChatUnreadMentions.length - updatedUnreadMentions.length;\n    const updatedUnreadMentionsCount = Math.max(chat.unreadMentionsCount - removedCount, 0) || undefined;\n\n    global = updateChat(global, chatId, {\n      unreadMentionsCount: updatedUnreadMentionsCount,\n    });\n  }\n  return global;\n}\n\nexport function updateChat<T extends GlobalState>(\n  global: T, chatId: string, chatUpdate: Partial<ApiChat>, noOmitUnreadReactionCount = false, withDeepCheck = false,\n): T {\n  const { byId } = global.chats;\n\n  const chat = byId[chatId];\n  if (withDeepCheck && chat) {\n    const updateKeys = Object.keys(chatUpdate) as (keyof ApiChat)[];\n    if (areDeepEqual(pick(chat, updateKeys), chatUpdate)) {\n      return global;\n    }\n  }\n\n  const updatedChat = getUpdatedChat(global, chatId, chatUpdate, noOmitUnreadReactionCount);\n  if (!updatedChat) {\n    return global;\n  }\n\n  return replaceChats(global, {\n    ...byId,\n    [chatId]: updatedChat,\n  });\n}\n\nexport function updateChatFullInfo<T extends GlobalState>(\n  global: T, chatId: string, fullInfoUpdate: Partial<ApiChatFullInfo>,\n): T {\n  const currentFullInfo = selectChatFullInfo(global, chatId);\n  const updatedFullInfo = {\n    ...currentFullInfo,\n    ...fullInfoUpdate,\n  };\n\n  if (areDeepEqual(currentFullInfo, updatedFullInfo)) {\n    return global;\n  }\n\n  return {\n    ...global,\n    chats: {\n      ...global.chats,\n      fullInfoById: {\n        ...global.chats.fullInfoById,\n        [chatId]: updatedFullInfo,\n      },\n    },\n  };\n}\n\nexport function replaceChatFullInfo<T extends GlobalState>(global: T, chatId: string, fullInfo: ApiChatFullInfo): T {\n  const currentFullInfo = selectChatFullInfo(global, chatId);\n\n  if (areDeepEqual(currentFullInfo, fullInfo)) {\n    return global;\n  }\n\n  return {\n    ...global,\n    chats: {\n      ...global.chats,\n      fullInfoById: {\n        ...global.chats.fullInfoById,\n        [chatId]: fullInfo,\n      },\n    },\n  };\n}\n\nexport function updateChats<T extends GlobalState>(global: T, newById: Record<string, ApiChat>): T {\n  const updatedById = Object.keys(newById).reduce((acc: Record<string, ApiChat>, id) => {\n    const updatedChat = getUpdatedChat(global, id, newById[id]);\n    if (updatedChat) {\n      acc[id] = updatedChat;\n    }\n\n    return acc;\n  }, {});\n\n  global = replaceChats(global, {\n    ...global.chats.byId,\n    ...updatedById,\n  });\n\n  return global;\n}\n\n// @optimization Allows to avoid redundant updates which cause a lot of renders\nexport function addChats<T extends GlobalState>(global: T, newById: Record<string, ApiChat>): T {\n  const { byId } = global.chats;\n  let isUpdated = false;\n\n  const addedById = Object.keys(newById).reduce<Record<string, ApiChat>>((acc, id) => {\n    const existingChat = byId[id];\n    const newChat = newById[id];\n\n    const membersCountChanged = !existingChat?.membersCount && newChat.membersCount;\n\n    if (existingChat && !existingChat.isMin && !membersCountChanged\n        && (newChat.isMin || existingChat.accessHash === newChat.accessHash)) {\n      return acc;\n    }\n\n    const updatedChat = getUpdatedChat(global, id, newChat);\n    if (updatedChat) {\n      acc[id] = updatedChat;\n      if (!isUpdated) {\n        isUpdated = true;\n      }\n    }\n\n    return acc;\n  }, {});\n\n  if (!isUpdated) {\n    return global;\n  }\n\n  global = replaceChats(global, {\n    ...byId,\n    ...addedById,\n  });\n\n  return global;\n}\n\n// @optimization Don't spread/unspread global for each element, do it in a batch\nfunction getUpdatedChat<T extends GlobalState>(\n  global: T, chatId: string, chatUpdate: Partial<ApiChat>,\n  noOmitUnreadReactionCount = false,\n) {\n  const { byId } = global.chats;\n  const chat = byId[chatId];\n  const omitProps: (keyof ApiChat)[] = [];\n\n  if (chatUpdate.isMin && chat && !chat.isMin) {\n    return undefined; // Do not apply updates from min constructor\n  }\n\n  if (!noOmitUnreadReactionCount) {\n    omitProps.push('unreadReactionsCount');\n  }\n\n  if (areDeepEqual(chat?.usernames, chatUpdate.usernames)) {\n    omitProps.push('usernames');\n  }\n\n  const updatedChat: ApiChat = {\n    ...chat,\n    ...omit(chatUpdate, omitProps),\n  } as ApiChat;\n\n  if (!updatedChat.id || !updatedChat.type) {\n    return undefined;\n  }\n\n  return omitUndefined(updatedChat);\n}\n\nexport function updateChatListType<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  folderId?: number,\n): T {\n  const listType = folderId === ARCHIVED_FOLDER_ID ? 'archived' : 'active';\n\n  let currentListIds = global.chats.listIds;\n  (Object.keys(currentListIds) as Array<keyof typeof currentListIds>).forEach((listTypeKey) => {\n    const currentFolderList = currentListIds[listTypeKey] || [];\n    if (listTypeKey === listType && !currentFolderList.includes(chatId)) {\n      currentListIds = {\n        ...currentListIds,\n        [listTypeKey]: [...currentFolderList, chatId],\n      };\n    } else if (listTypeKey !== listType && currentFolderList.includes(chatId)) {\n      currentListIds = {\n        ...currentListIds,\n        [listTypeKey]: currentFolderList.filter((id) => id !== chatId),\n      };\n    }\n  });\n\n  global = {\n    ...global,\n    chats: {\n      ...global.chats,\n      listIds: currentListIds,\n    },\n  };\n\n  global = updateChat(global, chatId, { folderId: folderId || undefined });\n\n  return global;\n}\n\nexport function updateChatListSecondaryInfo<T extends GlobalState>(\n  global: T,\n  type: ChatListType,\n  info: {\n    orderedPinnedIds?: string[];\n    totalChatCount: number;\n  },\n): T {\n  const totalCountKey = type === 'active' ? 'all' : type;\n\n  return {\n    ...global,\n    chats: {\n      ...global.chats,\n      ...(info.orderedPinnedIds && {\n        orderedPinnedIds: {\n          ...global.chats.orderedPinnedIds,\n          [type]: info.orderedPinnedIds,\n        },\n      }),\n      totalCount: {\n        ...global.chats.totalCount,\n        [totalCountKey]: info.totalChatCount,\n      },\n    },\n  };\n}\n\nexport function leaveChat<T extends GlobalState>(global: T, leftChatId: string): T {\n  global = removeChatFromChatLists(global, leftChatId);\n\n  global = updateChat(global, leftChatId, { isNotJoined: true });\n  global = updateChatFullInfo(global, leftChatId, { joinInfo: undefined });\n\n  return global;\n}\n\nexport function removeChatFromChatLists<T extends GlobalState>(\n  global: T, chatId: string, type: 'all' | 'saved' = 'all',\n): T {\n  const chatLists = type === 'all' ? DEFAULT_CHAT_LISTS : [type];\n  chatLists.forEach((listType) => {\n    global = replaceChatListIds(global, listType, global.chats.listIds[listType]?.filter((id) => id !== chatId));\n  });\n\n  return global;\n}\n\nexport function addChatMembers<T extends GlobalState>(global: T, chat: ApiChat, membersToAdd: ApiChatMember[]): T {\n  const currentMembers = selectChatFullInfo(global, chat.id)?.members;\n  const newMemberIds = new Set(membersToAdd.map((m) => m.userId));\n  const updatedMembers = [\n    ...currentMembers?.filter(({ userId }) => !newMemberIds.has(userId)) || [],\n    ...membersToAdd,\n  ];\n  const currentIds = currentMembers?.map(({ userId }) => userId) || [];\n  const updatedIds = updatedMembers.map(({ userId }) => userId);\n\n  if (areSortedArraysEqual(currentIds, updatedIds)) {\n    return global;\n  }\n\n  const adminMembers = updatedMembers.filter(({ isAdmin, isOwner }) => isAdmin || isOwner);\n\n  return updateChatFullInfo(global, chat.id, {\n    members: updatedMembers,\n    adminMembersById: buildCollectionByKey(adminMembers, 'userId'),\n  });\n}\n\nexport function replaceSimilarChannels<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  similarChannelIds: string[],\n  count?: number,\n) {\n  return {\n    ...global,\n    chats: {\n      ...global.chats,\n      similarChannelsById: {\n        ...global.chats.similarChannelsById,\n        [chatId]: {\n          similarChannelIds,\n          count: count || similarChannelIds.length,\n        },\n      },\n    },\n  };\n}\n\nexport function toggleSimilarChannels<T extends GlobalState>(\n  global: T,\n  chatId: string,\n) {\n  const similarChannels = global.chats.similarChannelsById[chatId];\n\n  return {\n    ...global,\n    chats: {\n      ...global.chats,\n      similarChannelsById: {\n        ...global.chats.similarChannelsById,\n        [chatId]: {\n          ...similarChannels,\n          isExpanded: !similarChannels?.isExpanded,\n        },\n      },\n    },\n  };\n}\n\nexport function addSimilarBots<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  similarBotsIds: string[],\n  count?: number,\n) {\n  return {\n    ...global,\n    chats: {\n      ...global.chats,\n      similarBotsById: {\n        ...global.chats.similarBotsById,\n        [chatId]: {\n          similarBotsIds,\n          count,\n        },\n      },\n    },\n  };\n}\n","\nmodule.exports = function () {\n  var selection = document.getSelection();\n  if (!selection.rangeCount) {\n    return function () {};\n  }\n  var active = document.activeElement;\n\n  var ranges = [];\n  for (var i = 0; i < selection.rangeCount; i++) {\n    ranges.push(selection.getRangeAt(i));\n  }\n\n  switch (active.tagName.toUpperCase()) { // .toUpperCase handles XHTML\n    case 'INPUT':\n    case 'TEXTAREA':\n      active.blur();\n      break;\n\n    default:\n      active = null;\n      break;\n  }\n\n  selection.removeAllRanges();\n  return function () {\n    selection.type === 'Caret' &&\n    selection.removeAllRanges();\n\n    if (!selection.rangeCount) {\n      ranges.forEach(function(range) {\n        selection.addRange(range);\n      });\n    }\n\n    active &&\n    active.focus();\n  };\n};\n","import { useCallback, useMemo } from '../lib/teact/teact';\n\nimport { debounce } from '../util/schedulers';\n\nexport default function useDebouncedCallback<T extends AnyToVoidFunction>(\n  fn: T,\n  deps: any[],\n  ms: number,\n  noFirst = false,\n  noLast = false,\n) {\n  // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  const fnMemo = useCallback(fn, deps);\n\n  return useMemo(() => {\n    return debounce(fnMemo, ms, !noFirst, !noLast);\n  }, [fnMemo, ms, noFirst, noLast]);\n}\n","import { type TeactNode } from '../lib/teact/teact';\n\nimport type { LangFn } from './localization';\n\nimport { STARS_CURRENCY_CODE } from '../config';\nimport { formatStarsAsIcon } from './localization/format';\n\nexport function formatCurrency(\n  lang: LangFn,\n  totalPrice: number,\n  currency: string,\n  options?: {\n    shouldOmitFractions?: boolean;\n    iconClassName?: string;\n    asFontIcon?: boolean;\n  },\n): TeactNode {\n  const price = totalPrice / 10 ** getCurrencyExp(currency);\n\n  if (currency === STARS_CURRENCY_CODE) {\n    return formatStarsAsIcon(lang, price, { asFont: options?.asFontIcon, className: options?.iconClassName });\n  }\n\n  return formatCurrencyAsString(totalPrice, currency, lang.code, options);\n}\n\nexport function formatCurrencyAsString(\n  totalPrice: number,\n  currency: string,\n  locale: string = 'en',\n  options?: {\n    shouldOmitFractions?: boolean;\n  },\n) {\n  const price = totalPrice / 10 ** getCurrencyExp(currency);\n\n  if ((options?.shouldOmitFractions || currency === STARS_CURRENCY_CODE) && Number.isInteger(price)) {\n    return new Intl.NumberFormat(locale, {\n      style: 'currency',\n      currency,\n      minimumFractionDigits: 0,\n      maximumFractionDigits: 0,\n    }).format(price);\n  }\n\n  return new Intl.NumberFormat(locale, {\n    style: 'currency',\n    currency,\n  }).format(price);\n}\n\nfunction getCurrencyExp(currency: string) {\n  if (currency === 'TON') {\n    return 9;\n  }\n  if (currency === 'CLF') {\n    return 4;\n  }\n  if (['BHD', 'IQD', 'JOD', 'KWD', 'LYD', 'OMR', 'TND'].includes(currency)) {\n    return 3;\n  }\n  if ([\n    'BIF', 'BYR', 'CLP', 'CVE', 'DJF', 'GNF', 'ISK', 'JPY', 'KMF', 'KRW', 'MGA', 'PYG', 'RWF', 'UGX', 'UYI',\n    'VND', 'VUV', 'XAF', 'XOF', 'XPF', STARS_CURRENCY_CODE,\n  ].includes(currency)) {\n    return 0;\n  }\n  if (currency === 'MRO') {\n    return 1;\n  }\n  return 2;\n}\n","import EMOJI_REGEX from '../../lib/twemojiRegex';\nimport fixNonStandardEmoji from './fixNonStandardEmoji';\n\nconst DETECT_UP_TO = 100;\nconst MAX_LENGTH = DETECT_UP_TO * 8; // Maximum 8 code points per one emoji.\n\nexport default function parseEmojiOnlyString(text: string): number | false {\n  const standardizedText = fixNonStandardEmoji(text);\n  const lines = standardizedText.split('\\n');\n  const textWithoutNewlines = lines.join('');\n  if (textWithoutNewlines.length > MAX_LENGTH) {\n    return false;\n  }\n\n  const totalCount = countIfEmojiOnly(textWithoutNewlines);\n  if (!totalCount || totalCount > DETECT_UP_TO) {\n    return false;\n  }\n\n  // Calculate max emoji count per column or line. Used in UI to determine the size of the emoji.\n  let max = lines.length;\n  for (const line of lines) {\n    const count = countIfEmojiOnly(line);\n    if (count === false) {\n      return false;\n    }\n    if (count > max) {\n      max = count;\n    }\n  }\n\n  return max;\n}\n\nfunction countIfEmojiOnly(line: string): false | number {\n  const iterator = line.matchAll(EMOJI_REGEX);\n  let count = 0;\n  let currentIndex = 0;\n\n  for (const match of iterator) {\n    if (match.index !== currentIndex) {\n      return false;\n    }\n\n    count++;\n    currentIndex = match.index + match[0].length;\n  }\n\n  if (currentIndex !== line.length) {\n    return false;\n  }\n\n  return count;\n}\n","import type { OldLangFn } from '../../hooks/useOldLang';\nimport type { TimeFormat } from '../../types';\nimport type { LangFn } from '../localization';\n\nimport { getServerTime } from '../serverTime';\nimport withCache from '../withCache';\nimport { getDays, getHours, getMinutes } from './units';\n\nconst WEEKDAYS_FULL = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\nconst MONTHS_FULL = [\n  'January', 'February', 'March', 'April', 'May', 'June',\n  'July', 'August', 'September', 'October', 'November', 'December',\n];\n\nconst MONTHS_FULL_LOWERCASE = MONTHS_FULL.map((month) => month.toLowerCase());\nconst MIN_SEARCH_YEAR = 2015;\nconst MAX_DAY_IN_MONTH = 31;\nconst MAX_MONTH_IN_YEAR = 12;\nexport const MILLISECONDS_IN_DAY = 24 * 60 * 60 * 1000;\n\nexport function isToday(date: Date) {\n  return getDayStartAt(new Date()) === getDayStartAt(date);\n}\n\nexport function getDayStart(datetime: number | Date) {\n  const date = new Date(datetime);\n  date.setHours(0, 0, 0, 0);\n  return date;\n}\n\nexport function getDayStartAt(datetime: number | Date) {\n  return getDayStart(datetime).getTime();\n}\n\nexport function toYearMonth(timestamp: number) {\n  const date = new Date(timestamp * 1000);\n  return `${date.getFullYear()}-${date.getMonth()}`;\n}\n\nfunction toIsoString(date: Date) {\n  return `${date.getFullYear()}-${date.getMonth() + 1}-${date.getDate()}`;\n}\n\n// @optimization `toLocaleTimeString` is avoided because of bad performance\nexport function formatTime(lang: OldLangFn, datetime: number | Date) {\n  const date = typeof datetime === 'number' ? new Date(datetime) : datetime;\n  const timeFormat = lang.timeFormat || '24h';\n\n  let hours = date.getHours();\n  let marker = '';\n  if (timeFormat === '12h') {\n    marker = hours >= 12 ? '\\xa0PM' : '\\xa0AM'; // NBSP\n    hours = hours > 12 ? hours % 12 : hours;\n  }\n\n  return `${String(hours).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}${marker}`;\n}\n\nexport function formatPastTimeShort(lang: OldLangFn, datetime: number | Date, alwaysShowTime = false) {\n  const date = typeof datetime === 'number' ? new Date(datetime) : datetime;\n\n  const time = formatTime(lang, date);\n\n  const today = getDayStart(new Date());\n  if (date >= today) {\n    return time;\n  }\n\n  const weekAgo = new Date(today);\n  weekAgo.setDate(today.getDate() - 7);\n  if (date >= weekAgo) {\n    const weekday = lang(`Weekday.Short${WEEKDAYS_FULL[date.getDay()]}`);\n    return alwaysShowTime ? lang('FullDateTimeFormat', [weekday, time]) : weekday;\n  }\n\n  const noYear = date.getFullYear() === today.getFullYear();\n\n  const formattedDate = formatDateToString(date, lang.code, noYear);\n  return alwaysShowTime ? lang('FullDateTimeFormat', [formattedDate, time]) : formattedDate;\n}\n\nexport function formatFullDate(lang: OldLangFn | LangFn, datetime: number | Date) {\n  return formatDateToString(datetime, lang.code, false, 'numeric');\n}\n\nexport function formatMonthAndYear(lang: OldLangFn | LangFn, date: Date, isShort = false) {\n  return formatDateToString(date, lang.code, false, isShort ? 'short' : 'long', true);\n}\n\nexport function formatCountdown(\n  lang: LangFn,\n  secondsLeft: number,\n) {\n  const days = getDays(secondsLeft);\n  if (secondsLeft < 0) {\n    return 0;\n  } else if (days < 1) {\n    return formatMediaDuration(secondsLeft);\n  } else if (days < 7) {\n    const count = days;\n    return lang('Days', { count }, { pluralValue: count });\n  } else if (days < 30) {\n    const count = Math.floor(days / 7);\n    return lang('Weeks', { count }, { pluralValue: count });\n  } else if (days < 365) {\n    const count = Math.floor(days / 30);\n    return lang('Months', { count }, { pluralValue: count });\n  } else {\n    const count = Math.floor(days / 365);\n    return lang('Years', { count }, { pluralValue: count });\n  }\n}\n\nexport function formatCountdownShort(lang: OldLangFn, msLeft: number): string {\n  if (msLeft < 60 * 1000) {\n    return Math.ceil(msLeft / 1000).toString();\n  } else if (msLeft < 60 * 60 * 1000) {\n    return Math.ceil(msLeft / (60 * 1000)).toString();\n  } else if (msLeft < MILLISECONDS_IN_DAY) {\n    return lang('MessageTimer.ShortHours', Math.ceil(msLeft / (60 * 60 * 1000)));\n  } else {\n    return lang('MessageTimer.ShortDays', Math.ceil(msLeft / MILLISECONDS_IN_DAY));\n  }\n}\n\nexport function formatLocationLastUpdate(lang: OldLangFn, currentTime: number, lastUpdated = currentTime) {\n  const seconds = currentTime - lastUpdated;\n  if (seconds < 60) {\n    return lang('LiveLocationUpdated.JustNow');\n  } else if (seconds < 60 * 60) {\n    return lang('LiveLocationUpdated.MinutesAgo', Math.floor(seconds / 60));\n  } else {\n    return lang('LiveLocationUpdated.TodayAt', formatTime(lang, lastUpdated));\n  }\n}\n\nexport function formatRelativePastTime(lang: OldLangFn, currentTime: number, lastUpdated = currentTime) {\n  const seconds = currentTime - lastUpdated;\n\n  if (seconds < 60) {\n    return lang('Time.JustNow');\n  }\n\n  // within an hour\n  if (seconds < 60 * 60) {\n    return lang('Time.MinutesAgo', Math.floor(seconds / 60));\n  }\n\n  const lastUpdatedDate = new Date(lastUpdated * 1000);\n  const today = getDayStart(new Date());\n  if (lastUpdatedDate >= today) {\n    return lang('Time.TodayAt', formatTime(lang, lastUpdatedDate));\n  }\n\n  const yesterday = new Date(today);\n  yesterday.setDate(today.getDate() - 1);\n  if (lastUpdatedDate > yesterday) {\n    return lang('Time.YesterdayAt', formatTime(lang, lastUpdatedDate));\n  }\n\n  return lang('Time.AtDate', formatFullDate(lang, lastUpdatedDate));\n}\n\nexport function formatPastDatetime(lang: LangFn, pastTime: number, currentTime = getServerTime()) {\n  const seconds = currentTime - pastTime;\n  const minutes = getMinutes(seconds);\n  const hours = getHours(seconds);\n  const days = getDays(seconds);\n\n  if (seconds < 60) {\n    return lang('JustNowAgo');\n  }\n\n  if (minutes < 60) {\n    return lang('MinutesAgo', { count: minutes }, { pluralValue: minutes });\n  }\n\n  if (hours < 24) {\n    return lang('HoursAgo', { count: hours }, { pluralValue: hours });\n  }\n\n  if (days < 28) {\n    return lang('DaysAgo', { count: days }, { pluralValue: days });\n  }\n\n  return lang('AtDateAgo', { date: formatFullDate(lang, pastTime) });\n}\n\ntype DurationType = 'Seconds' | 'Minutes' | 'Hours' | 'Days' | 'Weeks';\n\nexport function formatTimeDuration(lang: OldLangFn, duration: number, showLast = 2) {\n  if (!duration) {\n    return undefined;\n  }\n\n  const durationRecords: { duration: number; type: DurationType }[] = [];\n  const labels = [\n    { multiplier: 1, type: 'Seconds' },\n    { multiplier: 60, type: 'Minutes' },\n    { multiplier: 60, type: 'Hours' },\n    { multiplier: 24, type: 'Days' },\n    { multiplier: 7, type: 'Weeks' },\n  ] as Array<{ multiplier: number; type: DurationType }>;\n  let t = 1;\n  labels.forEach((label, idx) => {\n    t *= label.multiplier;\n\n    if (duration < t) {\n      return;\n    }\n\n    const modulus = labels[idx === (labels.length - 1) ? idx : idx + 1].multiplier!;\n    durationRecords.push({\n      duration: Math.floor((duration / t) % modulus),\n      type: label.type,\n    });\n  });\n\n  const out = durationRecords.slice(-showLast).reverse();\n  for (let i = out.length - 1; i >= 0; --i) {\n    if (out[i].duration === 0) {\n      out.splice(i, 1);\n    }\n  }\n\n  // TODO In arabic we don't use \",\" as delimiter rather we use \"and\" each time\n  return out.map((part) => lang(part.type, part.duration, 'i')).join(', ');\n}\n\nexport function formatHumanDate(\n  lang: OldLangFn,\n  datetime: number | Date,\n  isShort = false,\n  noWeekdays = false,\n  isUpperFirst?: boolean,\n) {\n  const date = typeof datetime === 'number' ? new Date(datetime) : datetime;\n\n  const today = getDayStart(new Date());\n\n  if (!noWeekdays) {\n    if (toIsoString(date) === toIsoString(today)) {\n      return (isUpperFirst || !isShort ? upperFirst : lowerFirst)(lang('Weekday.Today'));\n    }\n\n    const yesterday = new Date(today);\n    yesterday.setDate(today.getDate() - 1);\n    if (toIsoString(date) === toIsoString(yesterday)) {\n      return (isUpperFirst || !isShort ? upperFirst : lowerFirst)(lang('Weekday.Yesterday'));\n    }\n\n    const limitBefore = new Date(today);\n    limitBefore.setDate(today.getDate() - 6); // Avoid returning same weekday as today\n    const limitAhead = new Date(today);\n    limitAhead.setDate(today.getDate() + 6);\n\n    if (date >= limitBefore && date <= limitAhead) {\n      const weekDayString = formatWeekday(lang, date.getDay(), isShort);\n      return (isUpperFirst || !isShort ? upperFirst : lowerFirst)(weekDayString);\n    }\n  }\n\n  const noYear = date.getFullYear() === today.getFullYear();\n  const formattedDate = formatDateToString(date, lang.code, noYear, isShort ? 'short' : 'long');\n\n  return (isUpperFirst || !isShort ? upperFirst : lowerFirst)(formattedDate);\n}\n\n/**\n * Returns weekday name\n * @param day 0 - Sunday, 1 - Monday, ...\n */\nexport function formatWeekday(lang: OldLangFn, day: number, isShort = false) {\n  const weekDay = WEEKDAYS_FULL[day];\n  return isShort ? lang(`Weekday.Short${weekDay}`) : lang(`Weekday.${weekDay}`);\n}\n\nexport function formatMediaDateTime(\n  lang: OldLangFn,\n  datetime: number | Date,\n  isUpperFirst?: boolean,\n) {\n  const date = typeof datetime === 'number' ? new Date(datetime) : datetime;\n\n  return `${formatHumanDate(lang, date, true, undefined, isUpperFirst)}, ${formatTime(lang, date)}`;\n}\n\nexport function formatMediaDuration(duration: number, maxValue?: number) {\n  const hours = Math.floor(duration / 3600);\n  const minutes = Math.floor((duration % 3600) / 60);\n  const seconds = Math.floor(duration % 3600 % 60);\n\n  const maxHours = maxValue ? Math.floor(maxValue / 3600) : 0;\n  const maxMinutes = maxValue ? Math.floor((maxValue % 3600) / 60) : 0;\n  let string = '';\n  if (hours > 0 || maxHours > 0) {\n    string += `${String(hours).padStart(2, '0')}:`;\n    string += `${String(minutes).padStart(2, '0')}:`;\n  } else if (maxMinutes >= 10) {\n    string += `${String(minutes).padStart(2, '0')}:`;\n  } else {\n    string += `${String(minutes)}:`;\n  }\n  string += String(seconds).padStart(2, '0');\n\n  return string;\n}\n\nexport function formatVoiceRecordDuration(durationInMs: number) {\n  const parts = [];\n\n  let milliseconds = durationInMs % 1000;\n  durationInMs -= milliseconds;\n  milliseconds = Math.floor(milliseconds / 10);\n\n  durationInMs = Math.floor(durationInMs / 1000);\n  const seconds = durationInMs % 60;\n  durationInMs -= seconds;\n\n  durationInMs = Math.floor(durationInMs / 60);\n  const minutes = durationInMs % 60;\n  durationInMs -= minutes;\n\n  durationInMs = Math.floor(durationInMs / 60);\n  const hours = durationInMs % 60;\n\n  if (hours > 0) {\n    parts.push(String(hours).padStart(2, '0'));\n  }\n  parts.push(String(minutes).padStart(hours > 0 ? 2 : 1, '0'));\n  parts.push(String(seconds).padStart(2, '0'));\n\n  return `${parts.join(':')},${String(milliseconds).padStart(2, '0')}`;\n}\n\nconst formatDayToStringWithCache = withCache((\n  dayStartAt: number,\n  locale: string,\n  noYear?: boolean,\n  monthFormat: 'short' | 'long' | 'numeric' = 'short',\n  noDay?: boolean,\n) => {\n  return new Date(dayStartAt).toLocaleString(\n    locale,\n    {\n      year: noYear ? undefined : 'numeric',\n      month: monthFormat,\n      day: noDay ? undefined : 'numeric',\n    },\n  );\n});\n\nexport function formatDateToString(\n  datetime: Date | number,\n  locale = 'en-US',\n  noYear = false,\n  monthFormat: 'short' | 'long' | 'numeric' = 'short',\n  noDay = false,\n) {\n  const date = typeof datetime === 'number' ? new Date(datetime) : datetime;\n  const dayStartAt = getDayStartAt(date);\n\n  return formatDayToStringWithCache(dayStartAt, locale, noYear, monthFormat, noDay);\n}\n\nexport function formatDateTimeToString(\n  datetime: Date | number, locale = 'en-US', noSeconds?: boolean,\n  timeFormat?: TimeFormat,\n) {\n  const date = typeof datetime === 'number' ? new Date(datetime) : datetime;\n  return date.toLocaleString(\n    locale,\n    {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric',\n      hour: 'numeric',\n      minute: 'numeric',\n      second: noSeconds ? undefined : 'numeric',\n      hourCycle: timeFormat === '12h' ? 'h12' : 'h23',\n    },\n  );\n}\n\nexport function formatDateAtTime(\n  lang: OldLangFn,\n  datetime: number | Date,\n) {\n  const date = typeof datetime === 'number' ? new Date(datetime) : datetime;\n\n  const today = getDayStart(new Date());\n  const time = formatTime(lang, date);\n\n  if (toIsoString(date) === toIsoString(today)) {\n    return lang('Time.TodayAt', time);\n  }\n\n  const yesterday = new Date(today);\n  yesterday.setDate(today.getDate() - 1);\n  if (toIsoString(date) === toIsoString(yesterday)) {\n    return lang('Time.YesterdayAt', time);\n  }\n\n  const noYear = date.getFullYear() === today.getFullYear();\n  const formattedDate = formatDateToString(date, lang.code, noYear);\n\n  return lang('formatDateAtTime', [formattedDate, time]);\n}\n\nexport function formatShortDuration(lang: LangFn, duration: number) {\n  if (duration < 0) {\n    return lang('RightNow');\n  }\n\n  if (duration < 60) {\n    const count = Math.ceil(duration);\n    return lang('Seconds', { count }, { pluralValue: duration });\n  }\n\n  if (duration < 60 * 60) {\n    const count = Math.ceil(duration / 60);\n    return lang('Minutes', { count }, { pluralValue: count });\n  }\n\n  if (duration < 60 * 60 * 24) {\n    const count = Math.ceil(duration / (60 * 60));\n    return lang('Hours', { count }, { pluralValue: count });\n  }\n\n  const count = Math.ceil(duration / (60 * 60 * 24));\n  return lang('Days', { count }, { pluralValue: count });\n}\n\nfunction isValidDate(day: number, month: number, year = 2021): boolean {\n  if (month > (MAX_MONTH_IN_YEAR - 1) || day > MAX_DAY_IN_MONTH) {\n    return false;\n  }\n  const date = new Date(year, month, day);\n  return !Number.isNaN(date.getTime()) && date.getDate() === day;\n}\n\nexport function parseDateString(query = ''): string | undefined {\n  const matchStringDate = query.match(/\\d{1,2}\\s[a-zA-Z]{3,}/);\n  const matchEuropeStringDate = query.match(/[a-zA-Z]{3,}\\s\\d{1,2}/);\n  const matchNumberDate = query.match(/\\d{1,2}[./-]\\d{1,2}([./-]\\d{2,4})?/);\n  if (!matchStringDate && !matchNumberDate && !matchEuropeStringDate) {\n    return undefined;\n  }\n\n  if (matchNumberDate) {\n    const [date, month, year] = query.split(/[./-]/).map(Number);\n    return !(year && year < MIN_SEARCH_YEAR) && isValidDate(date, month - 1, year || undefined)\n      ? `${year ? `${year}-` : ''}${String(month).padStart(2, '0')}-${String(date).padStart(2, '0')}`\n      : undefined;\n  }\n\n  const dateParts = query.split(' ');\n  const date = matchStringDate ? dateParts[0] : dateParts[1];\n  const month = (matchStringDate ? dateParts[1] : dateParts[0]).toLowerCase();\n  const monthIndex = MONTHS_FULL_LOWERCASE.findIndex((item) => item.startsWith(month));\n\n  return monthIndex !== -1 && isValidDate(Number(date), monthIndex)\n    ? `${String(monthIndex + 1).padStart(2, '0')}-${String(date).padStart(2, '0')}`\n    : undefined;\n}\n\nexport function timestampPlusDay(timestamp: number) {\n  return timestamp + MILLISECONDS_IN_DAY / 1000;\n}\n\nfunction lowerFirst(str: string) {\n  return `${str[0].toLowerCase()}${str.slice(1)}`;\n}\n\nfunction upperFirst(str: string) {\n  return `${str[0].toUpperCase()}${str.slice(1)}`;\n}\n\nexport function formatRegistrationMonth(lang: string, dateString: string) {\n  const [month, year] = dateString.split('.');\n  const date = new Date(`${year}-${month}`);\n\n  return new Intl.DateTimeFormat(lang, { month: 'long', year: 'numeric' }).format(date);\n}","import { useCallback } from '../lib/teact/teact';\n\nimport { useStateRef } from './useStateRef';\n\nexport default function useLastCallback<T extends AnyFunction>(callback?: T) {\n  const ref = useStateRef(callback);\n\n  // No need for ref dependency\n  // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  return useCallback((...args: Parameters<T>) => ref.current?.(...args), []) as T;\n}\n","import type { ApiSticker, ApiStickerSet, ApiVideo } from '../../api/types';\nimport type { GlobalState, TabArgs } from '../types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { buildCollectionByKey, unique } from '../../util/iteratees';\nimport { selectCustomEmojiForEmoji, selectStickersForEmoji, selectTabState } from '../selectors';\nimport { updateTabState } from './tabs';\n\nexport function updateStickerSearch<T extends GlobalState>(\n  global: T,\n  hash: string,\n  resultIds?: string[],\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateTabState(global, {\n    stickerSearch: {\n      ...selectTabState(global, tabId).stickerSearch,\n      hash,\n      resultIds,\n    },\n  }, tabId);\n}\n\nexport function updateStickerSets<T extends GlobalState>(\n  global: T,\n  category: 'added' | 'featured' | 'search',\n  hash: string,\n  sets: ApiStickerSet[],\n): T {\n  const updatedSets = sets.map((stickerSet) => {\n    const existing = global.stickers.setsById[stickerSet.id];\n    if (!existing) {\n      return stickerSet;\n    }\n\n    return {\n      ...existing,\n      ...stickerSet,\n    };\n  });\n\n  const regularSetIds = sets.map((set) => set.id);\n\n  if (category === 'search') {\n    return {\n      ...global,\n      stickers: {\n        ...global.stickers,\n        setsById: {\n          ...global.stickers.setsById,\n          ...buildCollectionByKey(updatedSets, 'id'),\n        },\n      },\n    };\n  }\n\n  return {\n    ...global,\n    stickers: {\n      ...global.stickers,\n      setsById: {\n        ...global.stickers.setsById,\n        ...buildCollectionByKey(updatedSets, 'id'),\n      },\n      [category]: {\n        ...global.stickers[category],\n        hash,\n        setIds: [\n          ...(global.stickers[category].setIds || []),\n          ...regularSetIds,\n        ],\n      },\n    },\n  };\n}\n\nexport function updateCustomEmojiSets<T extends GlobalState>(\n  global: T,\n  hash: string,\n  sets: ApiStickerSet[],\n): T {\n  const updatedSets = sets.map((stickerSet) => {\n    const existing = global.stickers.setsById[stickerSet.id];\n    if (!existing) {\n      return stickerSet;\n    }\n\n    return {\n      ...existing,\n      ...stickerSet,\n    };\n  });\n\n  const customEmojis = sets.map((set) => set.stickers).flat().filter(Boolean);\n  const addedSetIds = sets.map((set) => set.id);\n\n  return {\n    ...global,\n    stickers: {\n      ...global.stickers,\n      setsById: {\n        ...global.stickers.setsById,\n        ...buildCollectionByKey(updatedSets, 'id'),\n      },\n    },\n    customEmojis: {\n      ...global.customEmojis,\n      added: {\n        ...global.customEmojis.added,\n        hash,\n        setIds: [\n          ...(global.customEmojis.added.setIds || []),\n          ...addedSetIds,\n        ],\n      },\n      byId: {\n        ...global.customEmojis.byId,\n        ...buildCollectionByKey(customEmojis, 'id'),\n      },\n    },\n  };\n}\n\nexport function updateStickerSet<T extends GlobalState>(\n  global: T, stickerSetId: string, update: Partial<ApiStickerSet>,\n): T {\n  const currentStickerSet = global.stickers.setsById[stickerSetId] || {};\n  const isCustomEmoji = update.isEmoji || currentStickerSet.isEmoji;\n  const addedSets = (isCustomEmoji ? global.customEmojis.added.setIds : global.stickers.added.setIds) || [];\n  let setIds: string[] = addedSets;\n  if (update.installedDate && !update.isArchived && addedSets && !addedSets.includes(stickerSetId)) {\n    setIds = [stickerSetId, ...setIds];\n  }\n\n  if (!update.installedDate && addedSets?.includes(stickerSetId)) {\n    setIds = setIds.filter((id) => id !== stickerSetId);\n  }\n\n  const customEmojiById = isCustomEmoji && update.stickers && buildCollectionByKey(update.stickers, 'id');\n\n  return {\n    ...global,\n    stickers: {\n      ...global.stickers,\n      added: {\n        ...global.stickers.added,\n        ...(!isCustomEmoji && { setIds }),\n      },\n      setsById: {\n        ...global.stickers.setsById,\n        [stickerSetId]: {\n          ...currentStickerSet,\n          ...update,\n        },\n      },\n    },\n    customEmojis: {\n      ...global.customEmojis,\n      byId: {\n        ...global.customEmojis.byId,\n        ...customEmojiById,\n      },\n      added: {\n        ...global.customEmojis.added,\n        ...(isCustomEmoji && { setIds }),\n      },\n    },\n  };\n}\n\nexport function updateGifSearch<T extends GlobalState>(\n  global: T, isNew: boolean, results: ApiVideo[], nextOffset?: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const { results: currentResults } = selectTabState(global, tabId).gifSearch;\n\n  let newResults!: ApiVideo[];\n  if (isNew || !currentResults) {\n    newResults = results;\n  } else {\n    const currentIds = new Set(currentResults.map((gif) => gif.id));\n    newResults = [\n      ...currentResults,\n      ...results.filter((gif) => !currentIds.has(gif.id)),\n    ];\n  }\n\n  return updateTabState(global, {\n    gifSearch: {\n      ...selectTabState(global, tabId).gifSearch,\n      offset: nextOffset,\n      results: newResults,\n    },\n  }, tabId);\n}\n\nexport function replaceAnimatedEmojis<T extends GlobalState>(global: T, stickerSet: ApiStickerSet): T {\n  return {\n    ...global,\n    animatedEmojis: stickerSet,\n  };\n}\n\nexport function updateStickersForEmoji<T extends GlobalState>(\n  global: T, emoji: string, remoteStickers?: ApiSticker[], hash?: string,\n): T {\n  const localStickers = selectStickersForEmoji(global, emoji);\n  const allStickers = [...localStickers, ...(remoteStickers || [])];\n  const uniqueIds = unique(allStickers.map(({ id }) => id));\n  const byId = buildCollectionByKey(allStickers, 'id');\n  const stickers = uniqueIds.map((id) => byId[id]);\n\n  return {\n    ...global,\n    stickers: {\n      ...global.stickers,\n      forEmoji: {\n        emoji,\n        stickers,\n        hash,\n      },\n    },\n  };\n}\n\nexport function updateCustomEmojiForEmoji<T extends GlobalState>(\n  global: T, emoji: string,\n): T {\n  const localStickers = selectCustomEmojiForEmoji(global, emoji);\n  const uniqueIds = unique(localStickers.map(({ id }) => id));\n  const byId = buildCollectionByKey(localStickers, 'id');\n  const stickers = uniqueIds.map((id) => byId[id]);\n\n  return {\n    ...global,\n    customEmojis: {\n      ...global.customEmojis,\n      forEmoji: {\n        emoji,\n        stickers,\n      },\n    },\n  };\n}\n\nexport function updateRecentStatusCustomEmojis<T extends GlobalState>(\n  global: T, hash: string, emojis: ApiSticker[],\n): T {\n  return {\n    ...global,\n    customEmojis: {\n      ...global.customEmojis,\n      statusRecent: {\n        ...global.customEmojis.statusRecent,\n        hash,\n        emojis,\n      },\n    },\n  };\n}\n\nexport function rebuildStickersForEmoji<T extends GlobalState>(global: T): T {\n  if (global.stickers.forEmoji) {\n    const { emoji, stickers, hash } = global.stickers.forEmoji;\n    if (!emoji) {\n      return global;\n    }\n\n    return updateStickersForEmoji(global, emoji, stickers, hash);\n  }\n\n  if (global.customEmojis.forEmoji) {\n    const { emoji } = global.customEmojis.forEmoji;\n    if (!emoji) {\n      return global;\n    }\n\n    return updateCustomEmojiForEmoji(global, emoji);\n  }\n\n  return global;\n}\n","import type {\n  ApiMissingInvitedUser,\n  ApiSavedStarGift,\n  ApiUser,\n  ApiUserCommonChats,\n  ApiUserFullInfo,\n  ApiUserStatus,\n} from '../../api/types';\nimport type { BotAppPermissions } from '../../types';\nimport type { GlobalState, TabArgs, TabState } from '../types';\n\nimport { areDeepEqual } from '../../util/areDeepEqual';\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { omit, omitUndefined, unique } from '../../util/iteratees';\nimport { MEMO_EMPTY_ARRAY } from '../../util/memo';\nimport { selectTabState } from '../selectors';\nimport { updateTabState } from './tabs';\n\nexport function replaceUsers<T extends GlobalState>(global: T, newById: Record<string, ApiUser>): T {\n  return {\n    ...global,\n    users: {\n      ...global.users,\n      byId: newById,\n    },\n  };\n}\n\nfunction updateContactList<T extends GlobalState>(global: T, updatedUsers: ApiUser[]): T {\n  const { userIds: contactUserIds } = global.contactList || {};\n\n  if (!contactUserIds) return global;\n\n  const contactUserIdsFromUpdate = updatedUsers\n    .filter((user) => user?.isContact)\n    .map((user) => user.id);\n\n  if (contactUserIdsFromUpdate.length === 0) return global;\n\n  return {\n    ...global,\n    contactList: {\n      userIds: unique([\n        ...contactUserIdsFromUpdate,\n        ...contactUserIds,\n      ]),\n    },\n  };\n}\n\nexport function updateUser<T extends GlobalState>(global: T, userId: string, userUpdate: Partial<ApiUser>): T {\n  const { byId } = global.users;\n\n  const updatedUser = getUpdatedUser(global, userId, userUpdate);\n  if (!updatedUser) {\n    return global;\n  }\n\n  global = updateContactList(global, [updatedUser]);\n\n  return replaceUsers(global, {\n    ...byId,\n    [userId]: updatedUser,\n  });\n}\n\nexport function updateUsers<T extends GlobalState>(global: T, newById: Record<string, ApiUser>): T {\n  const updatedById = Object.keys(newById).reduce((acc: Record<string, ApiUser>, id) => {\n    const updatedUser = getUpdatedUser(global, id, newById[id]);\n    if (updatedUser) {\n      acc[id] = updatedUser;\n    }\n\n    return acc;\n  }, {});\n\n  global = replaceUsers(global, {\n    ...global.users.byId,\n    ...updatedById,\n  });\n\n  global = updateContactList(global, Object.values(updatedById));\n\n  return global;\n}\n\n// @optimization Allows to avoid redundant updates which cause a lot of renders\nexport function addUsers<T extends GlobalState>(global: T, newById: Record<string, ApiUser>): T {\n  const { byId } = global.users;\n  let isUpdated = false;\n\n  const addedById = Object.keys(newById).reduce<Record<string, ApiUser>>((acc, id) => {\n    const existingUser = byId[id];\n    const newUser = newById[id];\n\n    if (existingUser && !existingUser.isMin && (newUser.isMin || existingUser.accessHash === newUser.accessHash)) {\n      return acc;\n    }\n\n    const updatedUser = getUpdatedUser(global, id, newUser);\n    if (updatedUser) {\n      acc[id] = updatedUser;\n      if (!isUpdated) {\n        isUpdated = true;\n      }\n    }\n\n    return acc;\n  }, {});\n\n  if (!isUpdated) {\n    return global;\n  }\n\n  global = replaceUsers(global, {\n    ...byId,\n    ...addedById,\n  });\n\n  global = updateContactList(global, Object.values(addedById));\n\n  return global;\n}\n\n// @optimization Don't spread/unspread global for each element, do it in a batch\nfunction getUpdatedUser(global: GlobalState, userId: string, userUpdate: Partial<ApiUser>) {\n  const { byId } = global.users;\n  const user = byId[userId];\n  const omitProps: (keyof ApiUser)[] = [];\n\n  if (userUpdate.isMin && user && !user.isMin) {\n    return undefined; // Do not apply updates from min constructor\n  }\n\n  if (areDeepEqual(user?.usernames, userUpdate.usernames)) {\n    omitProps.push('usernames');\n  }\n\n  const updatedUser = {\n    ...user,\n    ...omit(userUpdate, omitProps),\n  } as ApiUser;\n\n  if (!updatedUser.id || !updatedUser.type) {\n    return undefined;\n  }\n\n  return omitUndefined(updatedUser);\n}\n\nexport function deleteContact<T extends GlobalState>(global: T, userId: string): T {\n  const { byId } = global.users;\n  const { userIds } = global.contactList || {};\n\n  global = {\n    ...global,\n    contactList: {\n      userIds: userIds ? userIds.filter((id) => id !== userId) : MEMO_EMPTY_ARRAY,\n    },\n  };\n\n  global = replaceUsers(global, {\n    ...byId,\n    [userId]: {\n      ...byId[userId],\n      isContact: undefined,\n    },\n  });\n\n  global = {\n    ...global,\n    stories: {\n      ...global.stories,\n      orderedPeerIds: {\n        active: global.stories.orderedPeerIds.active.filter((id) => id !== userId),\n        archived: global.stories.orderedPeerIds.archived.filter((id) => id !== userId),\n      },\n    },\n  };\n\n  return updateUserFullInfo(global, userId, {\n    settings: undefined,\n  });\n}\n\nexport function updateUserSearch<T extends GlobalState>(\n  global: T,\n  searchStatePartial: Partial<TabState['userSearch']>,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateTabState(global, {\n    userSearch: {\n      ...selectTabState(global, tabId).userSearch,\n      ...searchStatePartial,\n    },\n  }, tabId);\n}\n\nexport function updateUserSearchFetchingStatus<T extends GlobalState>(\n  global: T, newState: boolean,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateUserSearch(global, {\n    fetchingStatus: newState,\n  }, tabId);\n}\n\nexport function updateUserBlockedState<T extends GlobalState>(global: T, userId: string, isBlocked: boolean): T {\n  const { fullInfoById } = global.users;\n  const fullInfo = fullInfoById[userId];\n  if (!fullInfo) {\n    return global;\n  }\n\n  return updateUserFullInfo(global, userId, { isBlocked });\n}\n\nexport function replaceUserStatuses<T extends GlobalState>(global: T, newById: Record<string, ApiUserStatus>): T {\n  return {\n    ...global,\n    users: {\n      ...global.users,\n      statusesById: newById,\n    },\n  };\n}\n\nexport function updateUserFullInfo<T extends GlobalState>(\n  global: T, userId: string, fullInfo: Partial<ApiUserFullInfo>,\n): T {\n  const userFullInfo = global.users.fullInfoById[userId];\n\n  return {\n    ...global,\n    users: {\n      ...global.users,\n      fullInfoById: {\n        ...global.users.fullInfoById,\n        [userId]: {\n          ...userFullInfo,\n          ...fullInfo,\n        },\n      },\n    },\n  };\n}\n\nexport function updateUserCommonChats<T extends GlobalState>(\n  global: T, userId: string, commonChats: ApiUserCommonChats,\n): T {\n  return {\n    ...global,\n    users: {\n      ...global.users,\n      commonChatsById: {\n        ...global.users.commonChatsById,\n        [userId]: commonChats,\n      },\n    },\n  };\n}\n\n// @optimization Allows to avoid redundant updates which cause a lot of renders\nexport function addUserStatuses<T extends GlobalState>(global: T, newById: Record<string, ApiUserStatus>): T {\n  const { statusesById } = global.users;\n\n  global = replaceUserStatuses(global, {\n    ...statusesById,\n    ...newById,\n  });\n\n  return global;\n}\n\nexport function closeNewContactDialog<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateTabState(global, {\n    newContact: undefined,\n  }, tabId);\n}\n\nexport function updateMissingInvitedUsers<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  missingUsers: ApiMissingInvitedUser[],\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  if (!missingUsers.length) {\n    return updateTabState(global, {\n      inviteViaLinkModal: undefined,\n    }, tabId);\n  }\n\n  return updateTabState(global, {\n    inviteViaLinkModal: {\n      missingUsers,\n      chatId,\n    },\n  }, tabId);\n}\n\nexport function updateBotAppPermissions<T extends GlobalState>(\n  global: T,\n  botId: string,\n  permissions: BotAppPermissions,\n): T {\n  const { botAppPermissionsById } = global.users;\n\n  return {\n    ...global,\n    users: {\n      ...global.users,\n      botAppPermissionsById: {\n        ...botAppPermissionsById,\n        [botId]: {\n          ...botAppPermissionsById[botId],\n          ...permissions,\n        },\n      },\n    },\n  };\n}\n\nexport function replacePeerSavedGifts<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  gifts: ApiSavedStarGift[],\n  nextOffset?: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const tabState = selectTabState(global, tabId);\n\n  return updateTabState(global, {\n    savedGifts: {\n      ...tabState.savedGifts,\n      giftsByPeerId: {\n        ...tabState.savedGifts.giftsByPeerId,\n        [peerId]: {\n          gifts,\n          nextOffset,\n        },\n      },\n    },\n  }, tabId);\n}\n","import type { ApiGlobalMessageSearchType, ApiMessage } from '../../api/types';\nimport type { GlobalSearchContent } from '../../types';\nimport type { GlobalState, TabArgs, TabState } from '../types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { areSortedArraysEqual } from '../../util/iteratees';\nimport { getSearchResultKey } from '../../util/keys/searchResultKey';\nimport { selectTabState } from '../selectors';\nimport { updateTabState } from './tabs';\n\nexport function updateGlobalSearch<T extends GlobalState>(\n  global: T,\n  searchStatePartial: Partial<TabState['globalSearch']>,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateTabState(global, {\n    globalSearch: {\n      ...selectTabState(global, tabId).globalSearch,\n      ...searchStatePartial,\n    },\n  }, tabId);\n}\n\nexport function updateGlobalSearchContent<T extends GlobalState>(\n  global: T,\n  currentContent: GlobalSearchContent | undefined,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateGlobalSearch(global, { currentContent }, tabId);\n}\n\nexport function updateGlobalSearchResults<T extends GlobalState>(\n  global: T,\n  newFoundMessages: ApiMessage[],\n  totalCount: number,\n  type: ApiGlobalMessageSearchType,\n  nextOffsetRate?: number,\n  nextOffsetId?: number,\n  nextOffsetPeerId?: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const { resultsByType } = selectTabState(global, tabId).globalSearch || {};\n  const newFoundMessagesById = newFoundMessages.reduce((result, message) => {\n    result[getSearchResultKey(message)] = message;\n\n    return result;\n  }, {} as Record<string, ApiMessage>);\n  const foundIdsForType = resultsByType?.[type]?.foundIds;\n\n  if (foundIdsForType !== undefined\n    && Object.keys(newFoundMessagesById).every(\n      (newId) => foundIdsForType.includes(getSearchResultKey(newFoundMessagesById[newId])),\n    )\n  ) {\n    global = updateGlobalSearchFetchingStatus(global, { messages: false }, tabId);\n    return updateGlobalSearch(global, {\n      resultsByType: {\n        ...(selectTabState(global, tabId).globalSearch || {}).resultsByType,\n        [type]: {\n          foundIds: foundIdsForType,\n          totalCount,\n          nextOffsetId,\n          nextOffsetRate,\n          nextOffsetPeerId,\n        },\n      },\n    }, tabId);\n  }\n\n  const prevFoundIds = foundIdsForType || [];\n  const newFoundIds = newFoundMessages\n    .map((message) => getSearchResultKey(message))\n    .filter((id) => !prevFoundIds.includes(id));\n  const foundIds = Array.prototype.concat(prevFoundIds, newFoundIds);\n  const foundOrPrevFoundIds = areSortedArraysEqual(prevFoundIds, foundIds) ? prevFoundIds : foundIds;\n\n  global = updateGlobalSearchFetchingStatus(global, { messages: false }, tabId);\n\n  return updateGlobalSearch(global, {\n    resultsByType: {\n      ...(selectTabState(global, tabId).globalSearch || {}).resultsByType,\n      [type]: {\n        totalCount,\n        nextOffsetId,\n        nextOffsetRate,\n        nextOffsetPeerId,\n        foundIds: foundOrPrevFoundIds,\n      },\n    },\n  }, tabId);\n}\n\nexport function updateGlobalSearchFetchingStatus<T extends GlobalState>(\n  global: T, newState: { chats?: boolean; messages?: boolean; botApps?: boolean },\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateGlobalSearch(global, {\n    fetchingStatus: {\n      ...selectTabState(global, tabId).globalSearch.fetchingStatus,\n      ...newState,\n    },\n  }, tabId);\n}\n","import type { ManagementProgress, ManagementState } from '../../types';\nimport type { GlobalState, TabArgs } from '../types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { selectTabState } from '../selectors';\nimport { updateTabState } from './tabs';\n\nexport function updateManagementProgress<T extends GlobalState>(\n  global: T, progress: ManagementProgress,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateTabState(global, {\n    management: {\n      ...selectTabState(global, tabId).management,\n      progress,\n    },\n  }, tabId);\n}\n\nexport function updateManagement<T extends GlobalState>(\n  global: T, chatId: string, update: Partial<ManagementState>,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const { management } = selectTabState(global, tabId);\n  return updateTabState(global, {\n    management: {\n      ...management,\n      byChatId: {\n        ...management.byChatId,\n        [chatId]: {\n          ...(management.byChatId[chatId] || {}),\n          ...update,\n        },\n      },\n    },\n  }, tabId);\n}\n","import type { ApiNotifyPeerType, ApiPeerNotifySettings } from '../../api/types';\nimport type {\n  AccountSettings, IThemeSettings,\n  ThemeKey,\n} from '../../types';\nimport type { GlobalState, SharedState } from '../types';\n\nimport { selectSharedSettings } from '../selectors/sharedState';\nimport { updateSharedState } from './sharedState';\nimport { updateUserBlockedState } from './users';\n\nexport function replaceSettings<T extends GlobalState>(global: T, newSettings?: Partial<AccountSettings>): T {\n  return {\n    ...global,\n    settings: {\n      ...global.settings,\n      byKey: {\n        ...global.settings.byKey,\n        ...newSettings,\n      },\n    },\n  };\n}\n\nexport function updateSharedSettings<T extends GlobalState>(\n  global: T, newSettings?: Partial<SharedState['settings']>,\n): T {\n  const settings = selectSharedSettings(global);\n  return updateSharedState(global, {\n    settings: {\n      ...settings,\n      ...newSettings,\n    },\n  });\n}\n\nexport function updateThemeSettings<T extends GlobalState>(\n  global: T, theme: ThemeKey, newSettings?: Partial<IThemeSettings>,\n): T {\n  const settings = global.settings;\n  const current = settings.themes[theme];\n\n  return {\n    ...global,\n    settings: {\n      ...global.settings,\n      themes: {\n        ...settings.themes,\n        [theme]: {\n          ...current,\n          ...newSettings,\n        },\n      },\n    },\n  };\n}\n\nexport function addNotifyExceptions<T extends GlobalState>(\n  global: T, notifyExceptionById: Record<string, ApiPeerNotifySettings>,\n): T {\n  return {\n    ...global,\n    chats: {\n      ...global.chats,\n      notifyExceptionById: {\n        ...global.chats.notifyExceptionById,\n        ...notifyExceptionById,\n      },\n    },\n  };\n}\n\nexport function replaceNotifyExceptions<T extends GlobalState>(\n  global: T, notifyExceptionById: Record<string, ApiPeerNotifySettings>,\n): T {\n  return {\n    ...global,\n    chats: {\n      ...global.chats,\n      notifyExceptionById,\n    },\n  };\n}\n\nexport function addNotifyException<T extends GlobalState>(\n  global: T, id: string, notifyException: ApiPeerNotifySettings,\n): T {\n  return {\n    ...global,\n    chats: {\n      ...global.chats,\n      notifyExceptionById: {\n        ...global.chats.notifyExceptionById,\n        [id]: notifyException,\n      },\n    },\n  };\n}\n\nexport function updateNotifyDefaults<T extends GlobalState>(\n  global: T, peerType: ApiNotifyPeerType, settings: Partial<ApiPeerNotifySettings>,\n): T {\n  return {\n    ...global,\n    settings: {\n      ...global.settings,\n      notifyDefaults: {\n        ...global.settings.notifyDefaults,\n        [peerType]: {\n          ...global.settings.notifyDefaults?.[peerType],\n          ...settings,\n        },\n      },\n    },\n  };\n}\n\nexport function addBlockedUser<T extends GlobalState>(global: T, contactId: string): T {\n  global = updateUserBlockedState(global, contactId, true);\n\n  return {\n    ...global,\n    blocked: {\n      ...global.blocked,\n      ids: [contactId, ...global.blocked.ids],\n      totalCount: global.blocked.totalCount + 1,\n    },\n  };\n}\n\nexport function removeBlockedUser<T extends GlobalState>(global: T, contactId: string): T {\n  global = updateUserBlockedState(global, contactId, false);\n\n  return {\n    ...global,\n    blocked: {\n      ...global.blocked,\n      ids: global.blocked.ids.filter((id) => id !== contactId),\n      totalCount: global.blocked.totalCount - 1,\n    },\n  };\n}","import type { GlobalState, SharedState } from '../types';\n\nexport function updateSharedState<T extends GlobalState>(\n  global: T, update: Partial<SharedState>,\n): T {\n  return {\n    ...global,\n    sharedState: {\n      ...global.sharedState,\n      ...update,\n    },\n  };\n}\n","import type { GlobalState } from '../types';\n\nexport function updateTwoFaSettings<T extends GlobalState>(\n  global: T,\n  update: GlobalState['twoFaSettings'],\n): T {\n  return {\n    ...global,\n    twoFaSettings: {\n      ...global.twoFaSettings,\n      ...update,\n    },\n  };\n}\n","import type { GlobalState, SharedState, TabState } from '../types';\n\nimport { INITIAL_GLOBAL_STATE, INITIAL_SHARED_STATE, INITIAL_TAB_STATE } from '../initialState';\n\nexport function updatePasscodeSettings<T extends GlobalState>(\n  global: T,\n  update: GlobalState['passcode'],\n): T {\n  return {\n    ...global,\n    passcode: {\n      ...global.passcode,\n      ...update,\n    },\n  };\n}\n\nexport function clearPasscodeSettings<T extends GlobalState>(global: T): T {\n  return {\n    ...global,\n    passcode: {},\n  };\n}\n\nexport function clearGlobalForLockScreen<T extends GlobalState>(global: T, withTabState = true): T {\n  return {\n    ...INITIAL_GLOBAL_STATE,\n    passcode: global.passcode,\n    settings: INITIAL_GLOBAL_STATE.settings,\n    sharedState: clearSharedStateForLockScreen(global.sharedState),\n    ...(withTabState && {\n      byTabId: Object.values(global.byTabId).reduce((acc, { id: tabId, isMasterTab }) => {\n        acc[tabId] = { ...INITIAL_TAB_STATE, isMasterTab, id: tabId };\n        return acc;\n      }, {} as Record<number, TabState>),\n    }),\n  } as T;\n}\n\nexport function clearSharedStateForLockScreen(sharedState: SharedState): SharedState {\n  const {\n    theme,\n    shouldUseSystemTheme,\n    animationLevel,\n    language,\n  } = sharedState.settings;\n\n  return {\n    ...INITIAL_SHARED_STATE,\n    settings: {\n      ...INITIAL_SHARED_STATE.settings,\n      theme,\n      shouldUseSystemTheme,\n      animationLevel,\n      language,\n    },\n  };\n}","import type {\n  ApiReceiptRegular,\n  ApiReceiptStars,\n  ApiStarsAmount,\n  ApiStarsSubscription,\n  ApiStarsTransaction,\n} from '../../api/types';\nimport type {\n  PaymentStep,\n  ShippingOption,\n  StarsSubscriptions,\n  StarsTransactionType,\n} from '../../types';\nimport type {\n  GlobalState, TabArgs, TabState,\n} from '../types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { selectStarsPayment, selectTabState } from '../selectors';\nimport { updateTabState } from './tabs';\n\nexport function updatePayment<T extends GlobalState>(\n  global: T, update: Partial<TabState['payment']>,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateTabState(global, {\n    payment: {\n      ...selectTabState(global, tabId).payment,\n      ...update,\n    },\n  }, tabId);\n}\n\nexport function updateStarsPayment<T extends GlobalState>(\n  global: T, update: Partial<TabState['starsPayment']>,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const starPayment = selectStarsPayment(global, tabId);\n  if (!starPayment) {\n    return global;\n  }\n\n  return updateTabState(global, {\n    starsPayment: {\n      ...starPayment,\n      ...update,\n    },\n  }, tabId);\n}\n\nexport function updateShippingOptions<T extends GlobalState>(\n  global: T,\n  shippingOptions: ShippingOption[],\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n\n): T {\n  return updatePayment(global, { shippingOptions }, tabId);\n}\n\nexport function setRequestInfoId<T extends GlobalState>(\n  global: T, id: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updatePayment(global, { requestId: id }, tabId);\n}\n\nexport function setPaymentStep<T extends GlobalState>(\n  global: T, step: PaymentStep,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updatePayment(global, { step }, tabId);\n}\n\nexport function setStripeCardInfo<T extends GlobalState>(\n  global: T, cardInfo: { type: string; id: string },\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updatePayment(global, { stripeCredentials: { ...cardInfo } }, tabId);\n}\n\nexport function setSmartGlocalCardInfo<T extends GlobalState>(\n  global: T,\n  cardInfo: { type: string; token: string },\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updatePayment(global, { smartGlocalCredentials: { ...cardInfo } }, tabId);\n}\n\nexport function setConfirmPaymentUrl<T extends GlobalState>(\n  global: T, url?: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updatePayment(global, { confirmPaymentUrl: url }, tabId);\n}\n\nexport function setReceipt<T extends GlobalState>(\n  global: T,\n  receipt?: ApiReceiptRegular,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  if (!receipt) {\n    return updatePayment(global, { receipt: undefined }, tabId);\n  }\n\n  return updatePayment(global, {\n    receipt,\n  }, tabId);\n}\n\nexport function clearPayment<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateTabState(global, {\n    payment: {},\n  }, tabId);\n}\n\nexport function clearStarPayment<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateTabState(global, {\n    starsPayment: {},\n  }, tabId);\n}\n\nexport function closeInvoice<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  global = updatePayment(global, {\n    isPaymentModalOpen: undefined,\n    isExtendedMedia: undefined,\n  }, tabId);\n  return global;\n}\n\nexport function updateStarsBalance<T extends GlobalState>(\n  global: T, balance: ApiStarsAmount,\n): T {\n  return {\n    ...global,\n    stars: {\n      ...global.stars,\n      balance,\n    },\n  };\n}\n\nexport function appendStarsTransactions<T extends GlobalState>(\n  global: T,\n  type: StarsTransactionType,\n  transactions: ApiStarsTransaction[],\n  nextOffset?: string,\n): T {\n  const history = global.stars?.history;\n  if (!history) {\n    return global;\n  }\n\n  const newTypeObject = {\n    transactions: (history[type]?.transactions || []).concat(transactions),\n    nextOffset,\n  };\n\n  return {\n    ...global,\n    stars: {\n      ...global.stars,\n      history: {\n        ...history,\n        [type]: newTypeObject,\n      },\n    },\n  };\n}\n\nexport function appendStarsSubscriptions<T extends GlobalState>(\n  global: T,\n  subscriptions: ApiStarsSubscription[],\n  nextOffset?: string,\n): T {\n  if (!global.stars) {\n    return global;\n  }\n\n  const newObject = {\n    list: (global.stars.subscriptions?.list || []).concat(subscriptions),\n    nextOffset,\n  } satisfies StarsSubscriptions;\n\n  return {\n    ...global,\n    stars: {\n      ...global.stars,\n      subscriptions: newObject,\n    },\n  };\n}\n\nexport function updateStarsSubscriptionLoading<T extends GlobalState>(\n  global: T, isLoading: boolean,\n): T {\n  const subscriptions = global.stars?.subscriptions;\n  if (!subscriptions) {\n    return global;\n  }\n\n  return {\n    ...global,\n    stars: {\n      ...global.stars,\n      subscriptions: {\n        ...subscriptions,\n        isLoading,\n      },\n    },\n  };\n}\n\nexport function openStarsTransactionModal<T extends GlobalState>(\n  global: T, transaction: ApiStarsTransaction, ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateTabState(global, {\n    starsTransactionModal: {\n      transaction,\n    },\n  }, tabId);\n}\n\nexport function openStarsTransactionFromReceipt<T extends GlobalState>(\n  global: T, receipt: ApiReceiptStars, ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const transaction: ApiStarsTransaction = {\n    id: receipt.transactionId,\n    peer: {\n      type: 'peer',\n      id: receipt.botId,\n    },\n    stars: {\n      amount: receipt.totalAmount,\n      nanos: 0,\n    },\n    date: receipt.date,\n    title: receipt.title,\n    description: receipt.description,\n    photo: receipt.photo,\n  };\n\n  return openStarsTransactionModal(global, transaction, tabId);\n}\n","import type {\n  ApiChannelMonetizationStatistics,\n  ApiChannelStatistics, ApiGroupStatistics, ApiPostStatistics, StatisticsGraph,\n} from '../../api/types';\nimport type { GlobalState, TabArgs, TabState } from '../types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { selectTabState } from '../selectors';\nimport { updateTabState } from './tabs';\n\nexport function updateStatistics<T extends GlobalState>(\n  global: T, chatId: string, statistics: ApiChannelStatistics | ApiGroupStatistics,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateTabState(global, {\n    statistics: {\n      byChatId: {\n        ...selectTabState(global, tabId).statistics.byChatId,\n        [chatId]: statistics,\n      },\n    },\n  }, tabId);\n}\n\nexport function updateMessageStatistics<T extends GlobalState>(\n  global: T, statistics: ApiPostStatistics,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateTabState(global, {\n    statistics: {\n      ...selectTabState(global, tabId).statistics,\n      currentMessage: statistics,\n      currentStory: undefined,\n    },\n  }, tabId);\n}\n\nexport function updateStoryStatistics<T extends GlobalState>(\n  global: T, statistics: ApiPostStatistics,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateTabState(global, {\n    statistics: {\n      ...selectTabState(global, tabId).statistics,\n      currentStory: statistics,\n      currentMessage: undefined,\n    },\n  }, tabId);\n}\n\nexport function updateStatisticsGraph<T extends GlobalState>(\n  global: T, chatId: string, name: string, update: StatisticsGraph,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const { statistics } = selectTabState(global, tabId);\n  return updateTabState(global, {\n    statistics: {\n      ...statistics,\n      byChatId: {\n        ...statistics.byChatId,\n        [chatId]: {\n          ...(statistics.byChatId[chatId] || {}),\n          [name]: update,\n        },\n      },\n    },\n  }, tabId);\n}\n\nexport function updateChannelMonetizationStatistics<T extends GlobalState>(\n  global: T, statistics: ApiChannelMonetizationStatistics,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateTabState(global, {\n    statistics: {\n      ...selectTabState(global, tabId).statistics,\n      monetization: statistics,\n    },\n  }, tabId);\n}\n\nexport function updateVerifyMonetizationModal<T extends GlobalState>(\n  global: T, update: Partial<TabState['monetizationVerificationModal']>,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const tabState = selectTabState(global, tabId);\n  if (!tabState.monetizationVerificationModal) {\n    return global;\n  }\n\n  return updateTabState(global, {\n    monetizationVerificationModal: {\n      ...tabState.monetizationVerificationModal,\n      ...update,\n    },\n  }, tabId);\n}\n","import type {\n  ApiChat, ApiChatFullInfo, ApiPeerPhotos, ApiPhoto, ApiUser, ApiUserFullInfo,\n} from '../../api/types';\nimport type { GlobalState } from '../types';\n\nimport { omit, uniqueByField } from '../../util/iteratees';\nimport { isChatChannel, isUserId } from '../helpers';\nimport {\n  selectChatFullInfo,\n  selectPeer,\n  selectPeerPhotos,\n  selectUserFullInfo,\n} from '../selectors';\nimport { updateChat, updateChatFullInfo } from './chats';\nimport { updateUser, updateUserFullInfo } from './users';\n\n// `type` has different types in ApiChat and ApiUser\ntype ApiPeerSharedFields = Omit<CommonProperties<ApiChat, ApiUser>, 'type'>;\ntype ApiPeerFullInfoSharedFields = CommonProperties<ApiChatFullInfo, ApiUserFullInfo>;\n\nexport function updatePeer<T extends GlobalState>(\n  global: T, peerId: string, peerUpdate: Partial<ApiPeerSharedFields>,\n) {\n  if (isUserId(peerId)) {\n    return updateUser(global, peerId, peerUpdate);\n  }\n\n  return updateChat(global, peerId, peerUpdate);\n}\n\nexport function updatePeerFullInfo<T extends GlobalState>(\n  global: T, peerId: string, peerFullInfoUpdate: Partial<ApiPeerFullInfoSharedFields>,\n) {\n  if (isUserId(peerId)) {\n    return updateUserFullInfo(global, peerId, peerFullInfoUpdate);\n  }\n\n  return updateChatFullInfo(global, peerId, peerFullInfoUpdate);\n}\n\nexport function updatePeerPhotosIsLoading<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  isLoading: boolean,\n) {\n  const profilePhotos = selectPeerPhotos(global, peerId);\n  if (!profilePhotos) {\n    return global;\n  }\n\n  return replacePeerPhotos(global, peerId, {\n    ...profilePhotos,\n    isLoading,\n  });\n}\n\nexport function replacePeerPhotos<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  value?: ApiPeerPhotos,\n) {\n  if (!value) {\n    return {\n      ...global,\n      peers: {\n        ...global.peers,\n        profilePhotosById: omit(global.peers.profilePhotosById, [peerId]),\n      },\n    };\n  }\n\n  return {\n    ...global,\n    peers: {\n      ...global.peers,\n      profilePhotosById: {\n        ...global.peers.profilePhotosById,\n        [peerId]: value,\n      },\n    },\n  };\n}\n\nexport function updatePeerPhotos<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  update: {\n    newPhotos: ApiPhoto[];\n    count: number;\n    nextOffset?: number;\n    fullInfo: ApiChatFullInfo | ApiUserFullInfo;\n    shouldInvalidateCache?: boolean;\n  },\n) {\n  const profilePhotos = selectPeerPhotos(global, peerId);\n\n  const {\n    newPhotos, count, nextOffset, fullInfo, shouldInvalidateCache,\n  } = update;\n  const currentPhotos = profilePhotos;\n  const profilePhoto = fullInfo.profilePhoto;\n  const fallbackPhoto = 'fallbackPhoto' in fullInfo ? fullInfo.fallbackPhoto : undefined;\n  const personalPhoto = 'personalPhoto' in fullInfo ? fullInfo.personalPhoto : undefined;\n\n  if (!currentPhotos || shouldInvalidateCache) {\n    // In some channels, last service message with photo change is deleted, so we need to patch it in\n    if (profilePhoto && profilePhoto.id !== newPhotos[0]?.id) {\n      newPhotos.unshift(profilePhoto);\n    }\n\n    if (personalPhoto && personalPhoto.id !== newPhotos[0]?.id) {\n      newPhotos.unshift(personalPhoto);\n    }\n\n    if (fallbackPhoto) {\n      newPhotos.push(fallbackPhoto);\n    }\n\n    return replacePeerPhotos(global, peerId, {\n      fallbackPhoto,\n      personalPhoto,\n      photos: newPhotos,\n      count,\n      nextOffset,\n      isLoading: false,\n    });\n  }\n\n  const hasFallbackPhoto = currentPhotos.photos[currentPhotos.photos.length - 1].id === fallbackPhoto?.id;\n  const currentPhotoArray = hasFallbackPhoto ? currentPhotos.photos.slice(0, -1) : currentPhotos.photos;\n\n  const photos = uniqueByField([...currentPhotoArray, ...newPhotos, fallbackPhoto].filter(Boolean), 'id');\n  return replacePeerPhotos(global, peerId, {\n    fallbackPhoto,\n    personalPhoto,\n    photos,\n    count,\n    nextOffset,\n    isLoading: false,\n  });\n}\n\nexport function deletePeerPhoto<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  photoId: string,\n  isFromActionMessage?: boolean,\n) {\n  const peer = selectPeer(global, peerId);\n  const profilePhotos = selectPeerPhotos(global, peerId);\n  if (!peer || !profilePhotos) {\n    return global;\n  }\n  const isChannel = 'title' in peer && isChatChannel(peer);\n\n  const userFullInfo = selectUserFullInfo(global, peerId);\n  const chatFullInfo = selectChatFullInfo(global, peerId);\n\n  const isAvatar = peer.avatarPhotoId === photoId && (!isChannel || isFromActionMessage);\n  const nextAvatarPhoto = isAvatar ? profilePhotos.photos[1] : undefined;\n\n  if (userFullInfo) {\n    const newFallbackPhoto = userFullInfo.fallbackPhoto?.id === photoId ? undefined : userFullInfo.fallbackPhoto;\n    const newPersonalPhoto = userFullInfo.personalPhoto?.id === photoId ? undefined : userFullInfo.personalPhoto;\n    const newProfilePhoto = userFullInfo.profilePhoto?.id === photoId ? nextAvatarPhoto : userFullInfo.profilePhoto;\n    global = updateUserFullInfo(global, peerId, {\n      fallbackPhoto: newFallbackPhoto,\n      personalPhoto: newPersonalPhoto,\n      profilePhoto: newProfilePhoto,\n    });\n  }\n\n  if (chatFullInfo) {\n    const newProfilePhoto = chatFullInfo.profilePhoto?.id === photoId ? nextAvatarPhoto : chatFullInfo.profilePhoto;\n    global = updateChatFullInfo(global, peerId, {\n      profilePhoto: newProfilePhoto,\n    });\n  }\n\n  const avatarPhotoId = isAvatar ? nextAvatarPhoto?.id : peer.avatarPhotoId;\n  const shouldKeepInPhotos = isAvatar && 'title' in peer && isChatChannel(peer);\n  const photos = shouldKeepInPhotos\n    ? profilePhotos.photos.filter((photo) => photo.id !== photoId) : profilePhotos.photos.slice();\n\n  global = updatePeer(global, peerId, {\n    avatarPhotoId,\n  });\n\n  global = replacePeerPhotos(global, peerId, avatarPhotoId ? {\n    ...profilePhotos,\n    photos,\n    count: profilePhotos.count - 1,\n  } : undefined);\n\n  return global;\n}\n","import type {\n  ApiPeerStories,\n  ApiReaction,\n  ApiStealthMode,\n  ApiStory,\n  ApiStoryDeleted,\n  ApiStorySkipped,\n  ApiStoryViews,\n  ApiTypeStory,\n  ApiTypeStoryView,\n} from '../../api/types';\nimport type { GlobalState, TabArgs } from '../types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { compareFields, unique } from '../../util/iteratees';\nimport { getServerTime } from '../../util/serverTime';\nimport { isUserId, updateReactionCount } from '../helpers';\nimport {\n  selectIsChatWithSelf,\n  selectPeer, selectPeerStories, selectPeerStory, selectTabState, selectUser,\n} from '../selectors';\nimport { updatePeer } from './peers';\nimport { updateTabState } from './tabs';\n\nexport function addStories<T extends GlobalState>(global: T, newStoriesByPeerId: Record<string, ApiPeerStories>): T {\n  const updatedByPeerId = Object.entries(newStoriesByPeerId).reduce((acc, [peerId, newPeerStories]) => {\n    if (!acc[peerId]) {\n      acc[peerId] = newPeerStories;\n    } else {\n      acc[peerId].byId = { ...acc[peerId].byId, ...newPeerStories.byId };\n      acc[peerId].orderedIds = unique(newPeerStories.orderedIds.concat(acc[peerId].orderedIds));\n      acc[peerId].profileIds = unique(newPeerStories.profileIds.concat(acc[peerId].profileIds)).sort((a, b) => b - a);\n      acc[peerId].lastUpdatedAt = newPeerStories.lastUpdatedAt;\n      acc[peerId].lastReadId = newPeerStories.lastReadId;\n    }\n\n    return acc;\n  }, global.stories.byPeerId);\n\n  global = {\n    ...global,\n    stories: {\n      ...global.stories,\n      byPeerId: updatedByPeerId,\n    },\n  };\n\n  return updateOrderedStoriesPeerIds(global, Object.keys(newStoriesByPeerId));\n}\n\nexport function addStoriesForPeer<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  newStories: Record<number, ApiTypeStory>,\n  newPinnedIds?: number[],\n  addToArchive?: boolean,\n): T {\n  const {\n    byId, orderedIds, profileIds, archiveIds, pinnedIds,\n  } = global.stories.byPeerId[peerId] || {};\n  const deletedIds = Object.keys(newStories).filter((id) => 'isDeleted' in newStories[Number(id)]).map(Number);\n  const updatedById = { ...byId, ...newStories };\n  let updatedOrderedIds = [...(orderedIds || [])];\n  let updatedArchiveIds = [...(archiveIds || [])];\n  const updatedProfileIds = unique(\n    [...(profileIds || [])].concat(Object.values(newStories).reduce((ids, story) => {\n      if ('isInProfile' in story && story.isInProfile) {\n        ids.push(story.id);\n      }\n\n      return ids;\n    }, [] as number[])),\n  ).sort((a, b) => b - a).filter((storyId) => !deletedIds.includes(storyId));\n\n  updatedOrderedIds = unique(Object.entries(newStories).reduce((acc, [storyId, story]) => {\n    if ('expireDate' in story && story.expireDate && story.expireDate > getServerTime()) {\n      acc.push(Number(storyId));\n    }\n\n    return acc;\n  }, updatedOrderedIds)).filter((storyId) => !deletedIds.includes(storyId));\n\n  if (addToArchive && selectIsChatWithSelf(global, peerId)) {\n    updatedArchiveIds = unique(updatedArchiveIds.concat(Object.keys(newStories).map(Number)))\n      .sort((a, b) => b - a)\n      .filter((storyId) => !deletedIds.includes(storyId));\n  }\n\n  global = {\n    ...global,\n    stories: {\n      ...global.stories,\n      byPeerId: {\n        ...global.stories.byPeerId,\n        [peerId]: {\n          ...global.stories.byPeerId[peerId],\n          byId: updatedById,\n          orderedIds: updatedOrderedIds,\n          profileIds: updatedProfileIds,\n          pinnedIds: pinnedIds || newPinnedIds,\n          ...(addToArchive && { archiveIds: updatedArchiveIds }),\n        },\n      },\n    },\n  };\n\n  if (selectIsChatWithSelf(global, peerId)\n    || selectUser(global, peerId)?.isContact\n    || peerId === global.appConfig?.storyChangelogUserId) {\n    global = updatePeerLastUpdatedAt(global, peerId);\n    global = updateOrderedStoriesPeerIds(global, [peerId]);\n  }\n\n  return global;\n}\n\nexport function updateStoriesForPeer<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  peerStories: ApiPeerStories,\n): T {\n  return {\n    ...global,\n    stories: {\n      ...global.stories,\n      byPeerId: {\n        ...global.stories.byPeerId,\n        [peerId]: peerStories,\n      },\n    },\n  };\n}\n\nexport function updatePeerStoriesFullyLoaded<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  isFullyLoaded: boolean,\n  isArchive?: boolean,\n): T {\n  return {\n    ...global,\n    stories: {\n      ...global.stories,\n      byPeerId: {\n        ...global.stories.byPeerId,\n        [peerId]: {\n          ...global.stories.byPeerId[peerId],\n          [isArchive ? 'isArchiveFullyLoaded' : 'isFullyLoaded']: isFullyLoaded,\n        },\n      },\n    },\n  };\n}\n\nexport function updateLastReadStoryForPeer<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  lastReadId: number,\n): T {\n  const { orderedIds } = selectPeerStories(global, peerId) || {};\n  if (!orderedIds) {\n    return global;\n  }\n\n  if (lastReadId >= orderedIds[orderedIds.length - 1]) {\n    global = updatePeer(global, peerId, {\n      hasUnreadStories: false,\n    });\n  }\n\n  return {\n    ...global,\n    stories: {\n      ...global.stories,\n      byPeerId: {\n        ...global.stories.byPeerId,\n        [peerId]: {\n          ...global.stories.byPeerId[peerId],\n          lastReadId,\n        },\n      },\n    },\n  };\n}\n\nexport function updateLastViewedStoryForPeer<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  lastViewedId: number,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const { orderedIds } = selectPeerStories(global, peerId) || {};\n  if (!orderedIds || !orderedIds.includes(lastViewedId)) {\n    return global;\n  }\n\n  const { storyViewer } = selectTabState(global, tabId);\n\n  return updateTabState(global, {\n    storyViewer: {\n      ...storyViewer,\n      lastViewedByPeerIds: {\n        ...storyViewer.lastViewedByPeerIds,\n        [peerId]: lastViewedId,\n      },\n    },\n  }, tabId);\n}\n\nexport function updatePeersWithStories<T extends GlobalState>(\n  global: T,\n  storiesByPeerId: Record<string, ApiPeerStories>,\n): T {\n  Object.entries(storiesByPeerId).forEach(([peerId, { lastReadId, orderedIds }]) => {\n    const peer = selectPeer(global, peerId);\n    if (!peer) return;\n\n    global = updatePeer(global, peerId, {\n      hasStories: true,\n      hasUnreadStories: !lastReadId\n        || Boolean(lastReadId && lastReadId < (peer.maxStoryId || orderedIds[orderedIds.length - 1])),\n    });\n  });\n\n  return global;\n}\n\nexport function updateStoryViews<T extends GlobalState>(\n  global: T,\n  storyId: number,\n  views: ApiTypeStoryView[],\n  nextOffset?: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const tabState = selectTabState(global, tabId);\n  const { viewModal } = tabState.storyViewer;\n  const newViews = viewModal?.storyId === storyId && viewModal.views ? [\n    ...viewModal.views,\n    ...views,\n  ] : views;\n\n  global = updateStoryViewsLoading(global, false, tabId);\n\n  return updateTabState(global, {\n    storyViewer: {\n      ...tabState.storyViewer,\n      viewModal: {\n        ...viewModal,\n        storyId,\n        views: newViews,\n        nextOffset,\n        isLoading: false,\n      },\n    },\n  }, tabId);\n}\n\nexport function updateStoryViewsLoading<T extends GlobalState>(\n  global: T,\n  isLoading: boolean,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const tabState = selectTabState(global, tabId);\n  const { viewModal } = tabState.storyViewer;\n  if (!viewModal) return global;\n\n  return updateTabState(global, {\n    storyViewer: {\n      ...tabState.storyViewer,\n      viewModal: {\n        ...viewModal,\n        isLoading,\n      },\n    },\n  }, tabId);\n}\n\nexport function removePeerStory<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  storyId: number,\n): T {\n  const {\n    orderedIds, profileIds, lastReadId, byId,\n  } = selectPeerStories(global, peerId) || { orderedIds: [] as number[], profileIds: [] as number[] };\n\n  const newOrderedIds = orderedIds.filter((id) => id !== storyId);\n  const newProfileIds = profileIds.filter((id) => id !== storyId);\n  const lastStoryId = newOrderedIds.length ? orderedIds[orderedIds.length - 1] : undefined;\n\n  const previousStoryId = orderedIds[orderedIds.indexOf(storyId) - 1];\n  const newLastReadId = lastReadId === storyId ? previousStoryId : lastReadId;\n\n  const newById = {\n    ...byId,\n    [storyId]: { id: storyId, peerId, isDeleted: true } as ApiStoryDeleted,\n  };\n  const lastUpdatedAt = lastStoryId ? (newById[lastStoryId] as ApiStory | undefined)?.date : undefined;\n  const hasStories = Boolean(newOrderedIds.length);\n\n  global = updatePeer(global, peerId, {\n    hasStories,\n    hasUnreadStories: Boolean(hasStories && lastReadId && lastStoryId && lastReadId < lastStoryId),\n  });\n\n  global = updateStoriesForPeer(global, peerId, {\n    byId: newById,\n    orderedIds: newOrderedIds,\n    profileIds: newProfileIds,\n    lastUpdatedAt,\n    lastReadId: newLastReadId,\n  });\n\n  Object.values(global.byTabId).forEach((tab) => {\n    if (tab.storyViewer.lastViewedByPeerIds?.[peerId] === storyId) {\n      global = updateLastViewedStoryForPeer(global, peerId, previousStoryId, tab.id);\n    }\n  });\n\n  if (!hasStories) {\n    global = {\n      ...global,\n      stories: {\n        ...global.stories,\n        orderedPeerIds: {\n          active: global.stories.orderedPeerIds.active.filter((id) => id !== peerId),\n          archived: global.stories.orderedPeerIds.archived.filter((id) => id !== peerId),\n        },\n      },\n    };\n  }\n\n  return global;\n}\n\nexport function updateSentStoryReaction<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  storyId: number,\n  reaction: ApiReaction | undefined,\n): T {\n  const story = selectPeerStory(global, peerId, storyId);\n  if (!story || !('content' in story)) return global;\n\n  const { views } = story;\n  const reactionsCount = views?.reactionsCount || 0;\n  const hasReaction = views?.reactions?.some((r) => r.chosenOrder !== undefined);\n  const reactions = updateReactionCount(views?.reactions || [], [reaction].filter(Boolean));\n\n  const countDiff = !reaction ? -1 : hasReaction ? 0 : 1;\n  const newReactionsCount = reactionsCount + countDiff;\n\n  global = updatePeerStory(global, peerId, storyId, {\n    sentReaction: reaction,\n    views: {\n      ...views,\n      reactionsCount: newReactionsCount,\n      reactions,\n    },\n  });\n\n  return global;\n}\n\nexport function updatePeerStory<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  storyId: number,\n  storyUpdate: Partial<ApiStory>,\n): T {\n  const peerStories = selectPeerStories(global, peerId) || {\n    byId: {}, orderedIds: [], profileIds: [], archiveIds: [],\n  };\n\n  return {\n    ...global,\n    stories: {\n      ...global.stories,\n      byPeerId: {\n        ...global.stories.byPeerId,\n        [peerId]: {\n          ...peerStories,\n          byId: {\n            ...peerStories.byId,\n            [storyId]: {\n              ...peerStories.byId[storyId],\n              ...storyUpdate,\n            },\n          },\n        },\n      },\n    },\n  };\n}\n\nexport function updatePeerStoryViews<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  storyId: number,\n  viewsUpdate: Partial<ApiStoryViews>,\n): T {\n  const story = selectPeerStory(global, peerId, storyId);\n  if (!story || !('content' in story)) return global;\n\n  const { views } = story;\n\n  return updatePeerStory(global, peerId, storyId, {\n    views: {\n      ...views,\n      ...viewsUpdate,\n    },\n  });\n}\n\nexport function updatePeerProfileStory<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  storyId: number,\n  isInProfile?: boolean,\n): T {\n  const peerStories = selectPeerStories(global, peerId) || {\n    byId: {}, orderedIds: [], profileIds: [], archiveIds: [],\n  };\n\n  const newProfileIds = isInProfile\n    ? unique(peerStories.profileIds.concat(storyId)).sort((a, b) => b - a)\n    : peerStories.profileIds.filter((id) => storyId !== id);\n\n  return {\n    ...global,\n    stories: {\n      ...global.stories,\n      byPeerId: {\n        ...global.stories.byPeerId,\n        [peerId]: {\n          ...peerStories,\n          profileIds: newProfileIds,\n        },\n      },\n    },\n  };\n}\n\nexport function updatePeerStoriesHidden<T extends GlobalState>(global: T, peerId: string, areHidden: boolean) {\n  const peer = selectPeer(global, peerId);\n  if (!peer) return global;\n\n  const currentState = peer.areStoriesHidden;\n  if (currentState === areHidden) return global; // `updateOrderedStoriesPeerIds` is computationally expensive\n\n  global = updatePeer(global, peerId, {\n    areStoriesHidden: areHidden,\n  });\n\n  return updateOrderedStoriesPeerIds(global, [peerId]);\n}\n\nfunction updateOrderedStoriesPeerIds<T extends GlobalState>(global: T, updatePeerIds: string[]): T {\n  const { currentUserId, stories: { byPeerId, orderedPeerIds } } = global;\n\n  const allPeerIds = orderedPeerIds.active.concat(orderedPeerIds.archived).concat(updatePeerIds);\n  const newOrderedPeerIds = allPeerIds.reduce<{ active: string[]; archived: string[] }>((acc, peerId) => {\n    if (!byPeerId[peerId]?.orderedIds?.length) return acc;\n    const peer = selectPeer(global, peerId);\n\n    if (peer?.areStoriesHidden) {\n      acc.archived.push(peerId);\n    } else {\n      acc.active.push(peerId);\n    }\n\n    return acc;\n  }, { active: [], archived: [] });\n\n  function compare(peerIdA: string, peerIdB: string) {\n    const peerA = selectPeer(global, peerIdA)!;\n    const peerB = selectPeer(global, peerIdB)!;\n\n    const diffCurrentUser = compareFields(currentUserId === peerIdA, currentUserId === peerIdB);\n    if (diffCurrentUser) return diffCurrentUser;\n\n    const { lastUpdatedAt: luaA = 0, orderedIds: orderedA, lastReadId: lriA = 0 } = byPeerId[peerIdA] || {};\n    const hasUnreadA = lriA < orderedA?.[orderedA.length - 1];\n    const { lastUpdatedAt: luaB = 0, orderedIds: orderedB, lastReadId: lriB = 0 } = byPeerId[peerIdB] || {};\n    const hasUnreadB = lriB < orderedB?.[orderedB.length - 1];\n\n    const diffUnread = compareFields(hasUnreadA, hasUnreadB);\n    if (diffUnread) return diffUnread;\n\n    const diffPremium = compareFields('isPremium' in peerA, 'isPremium' in peerB);\n    if (diffPremium) return diffPremium;\n\n    const diffType = compareFields(isUserId(peerIdA), isUserId(peerIdB));\n    if (diffType) return diffType;\n\n    return compareFields(luaA, luaB);\n  }\n\n  newOrderedPeerIds.archived = unique(newOrderedPeerIds.archived)\n    .filter((peerId) => byPeerId[peerId]?.orderedIds?.length)\n    .sort(compare);\n  newOrderedPeerIds.active = unique(newOrderedPeerIds.active)\n    .filter((peerId) => byPeerId[peerId]?.orderedIds?.length)\n    .sort(compare);\n\n  return {\n    ...global,\n    stories: {\n      ...global.stories,\n      orderedPeerIds: newOrderedPeerIds,\n    },\n  };\n}\n\nfunction updatePeerLastUpdatedAt<T extends GlobalState>(global: T, peerId: string): T {\n  const peerStories = global.stories.byPeerId[peerId];\n  const lastUpdatedAt = peerStories.orderedIds.reduce<number | undefined>((acc, storyId) => {\n    const { date } = peerStories.byId[storyId] as ApiStorySkipped || {};\n    if (date && (!acc || acc < date)) {\n      acc = date;\n    }\n\n    return acc;\n  }, undefined);\n\n  return {\n    ...global,\n    stories: {\n      ...global.stories,\n      byPeerId: {\n        ...global.stories.byPeerId,\n        [peerId]: {\n          ...peerStories,\n          lastUpdatedAt,\n        },\n      },\n    },\n  };\n}\n\nexport function updateStealthMode<T extends GlobalState>(\n  global: T,\n  stealthMode: ApiStealthMode,\n): T {\n  return {\n    ...global,\n    stories: {\n      ...global.stories,\n      stealthMode,\n    },\n  };\n}\n","import type { ApiTopic } from '../../api/types';\nimport type { TopicsInfo } from '../../types';\nimport type { GlobalState } from '../types';\n\nimport { buildCollectionByKey, omit, unique } from '../../util/iteratees';\nimport {\n  selectChat, selectTopic, selectTopics,\n  selectTopicsInfo,\n} from '../selectors';\nimport { updateThread, updateThreadInfo } from './messages';\n\nfunction updateTopicsStore<T extends GlobalState>(\n  global: T, chatId: string, update: Partial<TopicsInfo>,\n) {\n  const info = global.chats.topicsInfoById[chatId] || {};\n\n  global = {\n    ...global,\n    chats: {\n      ...global.chats,\n      topicsInfoById: {\n        ...global.chats.topicsInfoById,\n        [chatId]: {\n          ...info,\n          ...update,\n        },\n      },\n    },\n  };\n\n  return global;\n}\n\nexport function updateListedTopicIds<T extends GlobalState>(\n  global: T, chatId: string, topicIds: number[],\n): T {\n  const listedIds = selectTopicsInfo(global, chatId)?.listedTopicIds || [];\n  return updateTopicsStore(global, chatId, {\n    listedTopicIds: unique([\n      ...listedIds,\n      ...topicIds,\n    ]),\n  });\n}\n\nexport function updateTopics<T extends GlobalState>(\n  global: T, chatId: string, topicsCount: number, topics: ApiTopic[],\n): T {\n  const oldTopics = selectTopics(global, chatId);\n  const newTopics = buildCollectionByKey(topics, 'id');\n\n  global = updateTopicsStore(global, chatId, {\n    topicsById: {\n      ...oldTopics,\n      ...newTopics,\n    },\n    totalCount: topicsCount,\n  });\n\n  topics.forEach((topic) => {\n    global = updateThread(global, chatId, topic.id, {\n      firstMessageId: topic.id,\n    });\n\n    global = updateThreadInfo(global, chatId, topic.id, {\n      lastMessageId: topic.lastMessageId,\n      threadId: topic.id,\n      chatId,\n    });\n  });\n\n  return global;\n}\n\nexport function updateTopic<T extends GlobalState>(\n  global: T, chatId: string, topicId: number, update: Partial<ApiTopic>,\n): T {\n  const chat = selectChat(global, chatId);\n\n  if (!chat) return global;\n\n  const topic = selectTopic(global, chatId, topicId);\n  const oldTopics = selectTopics(global, chatId);\n\n  const updatedTopic = {\n    ...topic,\n    ...update,\n  } as ApiTopic;\n\n  if (!updatedTopic.id) return global;\n\n  global = updateTopicsStore(global, chatId, {\n    topicsById: {\n      ...oldTopics,\n      [topicId]: updatedTopic,\n    },\n  });\n\n  global = updateThread(global, chatId, updatedTopic.id, {\n    firstMessageId: updatedTopic.id,\n  });\n\n  global = updateThreadInfo(global, chatId, updatedTopic.id, {\n    lastMessageId: updatedTopic.lastMessageId,\n    threadId: updatedTopic.id,\n    chatId,\n  });\n\n  return global;\n}\n\nexport function deleteTopic<T extends GlobalState>(\n  global: T, chatId: string, topicId: number,\n) {\n  const topics = selectTopics(global, chatId);\n  if (!topics) return global;\n\n  global = updateTopicsStore(global, chatId, {\n    topicsById: omit(topics, [topicId]),\n  });\n\n  return global;\n}\n\nexport function updateTopicLastMessageId<T extends GlobalState>(\n  global: T, chatId: string, threadId: number, lastMessageId: number,\n) {\n  return updateTopic(global, chatId, threadId, {\n    lastMessageId,\n  });\n}\n\nexport function replacePinnedTopicIds<T extends GlobalState>(\n  global: T, chatId: string, pinnedTopicIds: number[],\n) {\n  return updateTopicsStore(global, chatId, {\n    orderedPinnedTopicIds: pinnedTopicIds,\n  });\n}\n","\"use strict\";\n\nvar deselectCurrent = require(\"toggle-selection\");\n\nvar clipboardToIE11Formatting = {\n  \"text/plain\": \"Text\",\n  \"text/html\": \"Url\",\n  \"default\": \"Text\"\n}\n\nvar defaultMessage = \"Copy to clipboard: #{key}, Enter\";\n\nfunction format(message) {\n  var copyKey = (/mac os x/i.test(navigator.userAgent) ? \"⌘\" : \"Ctrl\") + \"+C\";\n  return message.replace(/#{\\s*key\\s*}/g, copyKey);\n}\n\nfunction copy(text, options) {\n  var debug,\n    message,\n    reselectPrevious,\n    range,\n    selection,\n    mark,\n    success = false;\n  if (!options) {\n    options = {};\n  }\n  debug = options.debug || false;\n  try {\n    reselectPrevious = deselectCurrent();\n\n    range = document.createRange();\n    selection = document.getSelection();\n\n    mark = document.createElement(\"span\");\n    mark.textContent = text;\n    // avoid screen readers from reading out loud the text\n    mark.ariaHidden = \"true\"\n    // reset user styles for span element\n    mark.style.all = \"unset\";\n    // prevents scrolling to the end of the page\n    mark.style.position = \"fixed\";\n    mark.style.top = 0;\n    mark.style.clip = \"rect(0, 0, 0, 0)\";\n    // used to preserve spaces and line breaks\n    mark.style.whiteSpace = \"pre\";\n    // do not inherit user-select (it may be `none`)\n    mark.style.webkitUserSelect = \"text\";\n    mark.style.MozUserSelect = \"text\";\n    mark.style.msUserSelect = \"text\";\n    mark.style.userSelect = \"text\";\n    mark.addEventListener(\"copy\", function(e) {\n      e.stopPropagation();\n      if (options.format) {\n        e.preventDefault();\n        if (typeof e.clipboardData === \"undefined\") { // IE 11\n          debug && console.warn(\"unable to use e.clipboardData\");\n          debug && console.warn(\"trying IE specific stuff\");\n          window.clipboardData.clearData();\n          var format = clipboardToIE11Formatting[options.format] || clipboardToIE11Formatting[\"default\"]\n          window.clipboardData.setData(format, text);\n        } else { // all other browsers\n          e.clipboardData.clearData();\n          e.clipboardData.setData(options.format, text);\n        }\n      }\n      if (options.onCopy) {\n        e.preventDefault();\n        options.onCopy(e.clipboardData);\n      }\n    });\n\n    document.body.appendChild(mark);\n\n    range.selectNodeContents(mark);\n    selection.addRange(range);\n\n    var successful = document.execCommand(\"copy\");\n    if (!successful) {\n      throw new Error(\"copy command was unsuccessful\");\n    }\n    success = true;\n  } catch (err) {\n    debug && console.error(\"unable to copy using execCommand: \", err);\n    debug && console.warn(\"trying IE specific stuff\");\n    try {\n      window.clipboardData.setData(options.format || \"text\", text);\n      options.onCopy && options.onCopy(window.clipboardData);\n      success = true;\n    } catch (err) {\n      debug && console.error(\"unable to copy using clipboardData: \", err);\n      debug && console.error(\"falling back to prompt\");\n      message = format(\"message\" in options ? options.message : defaultMessage);\n      window.prompt(message, text);\n    }\n  } finally {\n    if (selection) {\n      if (typeof selection.removeRange == \"function\") {\n        selection.removeRange(range);\n      } else {\n        selection.removeAllRanges();\n      }\n    }\n\n    if (mark) {\n      document.body.removeChild(mark);\n    }\n    reselectPrevious();\n  }\n\n  return success;\n}\n\nmodule.exports = copy;\n","import type { RefObject } from 'react';\nimport type { FC } from '../../lib/teact/teact';\nimport React, {\n  getIsHeavyAnimating,\n  memo,\n  useEffect,\n  useRef,\n  useState,\n  useUnmountCleanup,\n} from '../../lib/teact/teact';\n\nimport type RLottieInstance from '../../lib/rlottie/RLottie';\n\nimport { requestMeasure } from '../../lib/fasterdom/fasterdom';\nimport { ensureRLottie, getRLottie } from '../../lib/rlottie/RLottie.async';\nimport { IS_ELECTRON } from '../../util/browser/windowEnvironment';\nimport buildClassName from '../../util/buildClassName';\nimport buildStyle from '../../util/buildStyle';\nimport generateUniqueId from '../../util/generateUniqueId';\nimport { hexToRgb } from '../../util/switchTheme';\n\nimport useColorFilter from '../../hooks/stickers/useColorFilter';\nimport useEffectWithPrevDeps from '../../hooks/useEffectWithPrevDeps';\nimport useFlag from '../../hooks/useFlag';\nimport useHeavyAnimation from '../../hooks/useHeavyAnimation';\nimport useLastCallback from '../../hooks/useLastCallback';\nimport usePriorityPlaybackCheck, { isPriorityPlaybackActive } from '../../hooks/usePriorityPlaybackCheck';\nimport useSharedIntersectionObserver from '../../hooks/useSharedIntersectionObserver';\nimport { useStateRef } from '../../hooks/useStateRef';\nimport useSyncEffect from '../../hooks/useSyncEffect';\nimport useThrottledCallback from '../../hooks/useThrottledCallback';\nimport useUniqueId from '../../hooks/useUniqueId';\nimport useBackgroundMode, { isBackgroundModeActive } from '../../hooks/window/useBackgroundMode';\n\nexport type OwnProps = {\n  ref?: RefObject<HTMLDivElement>;\n  renderId?: string;\n  className?: string;\n  style?: string;\n  tgsUrl?: string;\n  play?: boolean | string;\n  playSegment?: [number, number];\n  speed?: number;\n  noLoop?: boolean;\n  size: number;\n  quality?: number;\n  color?: string;\n  isLowPriority?: boolean;\n  forceAlways?: boolean;\n  forceOnHeavyAnimation?: boolean;\n  sharedCanvas?: HTMLCanvasElement;\n  sharedCanvasCoords?: { x: number; y: number };\n  onClick?: NoneToVoidFunction;\n  onLoad?: NoneToVoidFunction;\n  onEnded?: NoneToVoidFunction;\n  onLoop?: NoneToVoidFunction;\n};\n\nconst THROTTLE_MS = 150;\n\nconst AnimatedSticker: FC<OwnProps> = ({\n  ref,\n  renderId,\n  className,\n  style,\n  tgsUrl,\n  play,\n  playSegment,\n  speed,\n  noLoop,\n  size,\n  quality,\n  isLowPriority,\n  color,\n  forceAlways,\n  forceOnHeavyAnimation,\n  sharedCanvas,\n  sharedCanvasCoords,\n  onClick,\n  onLoad,\n  onEnded,\n  onLoop,\n}) => {\n  // eslint-disable-next-line no-null/no-null\n  let containerRef = useRef<HTMLDivElement>(null);\n  if (ref) {\n    containerRef = ref;\n  }\n\n  const viewId = useUniqueId();\n\n  const [animation, setAnimation] = useState<RLottieInstance>();\n  const animationRef = useRef<RLottieInstance>();\n  const isFirstRender = useRef(true);\n\n  const shouldUseColorFilter = !sharedCanvas && color;\n  const colorFilter = useColorFilter(shouldUseColorFilter ? color : undefined);\n\n  const playKey = play || (play === false ? false : playSegment);\n  const playRef = useStateRef(play);\n  const playSegmentRef = useStateRef(playSegment);\n\n  const rgbColor = useRef<[number, number, number] | undefined>();\n\n  const shouldForceOnHeavyAnimation = forceAlways || forceOnHeavyAnimation;\n  // Delay initialization until heavy animation ends\n  const [\n    canInitialize, markCanInitialize, unmarkCanInitialize,\n  ] = useFlag(!getIsHeavyAnimating() || shouldForceOnHeavyAnimation);\n  useHeavyAnimation(unmarkCanInitialize, markCanInitialize, shouldForceOnHeavyAnimation);\n  useEffect(() => {\n    if (shouldForceOnHeavyAnimation) markCanInitialize();\n  }, [shouldForceOnHeavyAnimation]);\n\n  useSyncEffect(() => {\n    if (color && !shouldUseColorFilter) {\n      const { r, g, b } = hexToRgb(color);\n      rgbColor.current = [r, g, b];\n    } else {\n      rgbColor.current = undefined;\n    }\n  }, [color, shouldUseColorFilter]);\n\n  const isUnmountedRef = useRef(false);\n  useUnmountCleanup(() => {\n    isUnmountedRef.current = true;\n  });\n\n  const init = useLastCallback(() => {\n    if (\n      animationRef.current\n      || isUnmountedRef.current\n      || !tgsUrl\n      || (sharedCanvas && (!sharedCanvasCoords || !sharedCanvas.offsetWidth || !sharedCanvas.offsetHeight))\n      || (getIsHeavyAnimating() && !shouldForceOnHeavyAnimation)\n    ) {\n      return;\n    }\n\n    const container = containerRef.current || sharedCanvas;\n    if (!container) {\n      return;\n    }\n\n    const newAnimation = getRLottie().init(\n      tgsUrl,\n      container,\n      renderId || generateUniqueId(),\n      {\n        size,\n        noLoop,\n        quality,\n        isLowPriority,\n        coords: sharedCanvasCoords,\n      },\n      viewId,\n      rgbColor.current,\n      onLoad,\n      onEnded,\n      onLoop,\n    );\n\n    if (speed) {\n      newAnimation.setSpeed(speed);\n    }\n\n    setAnimation(newAnimation);\n    animationRef.current = newAnimation;\n  });\n\n  useEffect(() => {\n    if (!canInitialize) return;\n    if (getRLottie()) {\n      init();\n    } else {\n      ensureRLottie().then(init);\n    }\n  }, [init, tgsUrl, sharedCanvas, sharedCanvasCoords, canInitialize]);\n\n  const throttledInit = useThrottledCallback(init, [init], THROTTLE_MS);\n  useSharedIntersectionObserver(sharedCanvas, throttledInit);\n\n  useEffect(() => {\n    if (!animation) return;\n\n    animation.setColor(rgbColor.current);\n  }, [color, animation]);\n\n  useUnmountCleanup(() => {\n    animationRef.current?.removeView(viewId);\n  });\n\n  const playAnimation = useLastCallback((shouldRestart = false) => {\n    if (\n      !animation\n      || !(playRef.current || playSegmentRef.current)\n      || isFrozen(forceAlways)\n    ) {\n      return;\n    }\n\n    if (playSegmentRef.current) {\n      animation.playSegment(playSegmentRef.current, shouldRestart, viewId);\n    } else {\n      animation.play(shouldRestart, viewId);\n    }\n  });\n\n  const playAnimationOnRaf = useLastCallback(() => {\n    requestMeasure(playAnimation);\n  });\n\n  const pauseAnimation = useLastCallback(() => {\n    if (animation?.isPlaying()) {\n      animation.pause(viewId);\n    }\n  });\n\n  useEffectWithPrevDeps(([prevNoLoop]) => {\n    if (prevNoLoop !== undefined && noLoop !== prevNoLoop) {\n      animation?.setNoLoop(noLoop);\n    }\n  }, [noLoop, animation]);\n\n  useEffectWithPrevDeps(([prevSharedCanvasCoords]) => {\n    if (prevSharedCanvasCoords !== undefined && sharedCanvasCoords !== prevSharedCanvasCoords) {\n      animation?.setSharedCanvasCoords(viewId, sharedCanvasCoords);\n    }\n  }, [sharedCanvasCoords, viewId, animation]);\n\n  useEffect(() => {\n    if (!animation) {\n      return;\n    }\n\n    if (playKey) {\n      if (!isFrozen(forceAlways, forceOnHeavyAnimation)) {\n        playAnimation(noLoop);\n      }\n    } else {\n      pauseAnimation();\n    }\n  }, [animation, playKey, noLoop, playAnimation, pauseAnimation, forceAlways, forceOnHeavyAnimation]);\n\n  useEffect(() => {\n    if (animation) {\n      if (isFirstRender.current) {\n        isFirstRender.current = false;\n      } else if (tgsUrl) {\n        animation.changeData(tgsUrl);\n        playAnimation();\n      }\n    }\n  }, [playAnimation, animation, tgsUrl]);\n\n  useHeavyAnimation(pauseAnimation, playAnimation, !playKey || shouldForceOnHeavyAnimation);\n  usePriorityPlaybackCheck(pauseAnimation, playAnimation, !playKey || forceAlways);\n  // Pausing frame may not happen in background,\n  // so we need to make sure it happens right after focusing,\n  // then we can play again.\n  useBackgroundMode(pauseAnimation, playAnimationOnRaf, !playKey || forceAlways);\n\n  if (sharedCanvas) {\n    return undefined;\n  }\n\n  return (\n    <div\n      ref={containerRef}\n      className={buildClassName('AnimatedSticker', className)}\n      style={buildStyle(\n        size !== undefined && `width: ${size}px; height: ${size}px;`,\n        onClick && !IS_ELECTRON && 'cursor: pointer',\n        colorFilter,\n        style,\n      )}\n      onClick={onClick}\n    />\n  );\n};\n\nexport default memo(AnimatedSticker);\n\nfunction isFrozen(forceAlways = false, forceOnHeavyAnimation = false) {\n  if (forceAlways) return false;\n  return (!forceOnHeavyAnimation && getIsHeavyAnimating()) || isPriorityPlaybackActive() || isBackgroundModeActive();\n}\n","import type { AriaRole } from 'react';\nimport React from '../../../lib/teact/teact';\n\nimport type { IconName } from '../../../types/icons';\n\nimport buildClassName from '../../../util/buildClassName';\n\ntype OwnProps = {\n  name: IconName;\n  className?: string;\n  style?: string;\n  role?: AriaRole;\n  ariaLabel?: string;\n  character?: string;\n  ref?: React.RefObject<HTMLElement>;\n  onClick?: (e: React.MouseEvent<HTMLDivElement>) => void;\n};\n\nconst Icon = ({\n  name,\n  ref,\n  className,\n  style,\n  role,\n  ariaLabel,\n  character,\n  onClick,\n}: OwnProps) => {\n  return (\n    <i\n      ref={ref}\n      className={buildClassName(`icon icon-${name}`, className)}\n      style={style}\n      aria-hidden={!ariaLabel}\n      aria-label={ariaLabel}\n      data-char={character}\n      role={role}\n      onClick={onClick}\n    />\n  );\n};\n\nexport default Icon;\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"KU67Uur0\",\"collapsed\":\"y_uRZXtA\",\"blockquote\":\"m3sD7_cn\",\"gradientContainer\":\"JNVT2DU9\",\"collapseIcon\":\"pyX4NpPB\",\"clickable\":\"RmvXwV0W\"};","import React, {\n  type TeactNode,\n  useRef,\n} from '../../lib/teact/teact';\n\nimport { ApiMessageEntityTypes } from '../../api/types';\n\nimport buildClassName from '../../util/buildClassName';\n\nimport useCollapsibleLines from '../../hooks/element/useCollapsibleLines';\nimport useLastCallback from '../../hooks/useLastCallback';\n\nimport Icon from './icons/Icon';\n\nimport styles from './Blockquote.module.scss';\n\ntype OwnProps = {\n  canBeCollapsible?: boolean;\n  isToggleDisabled?: boolean;\n  children: TeactNode;\n};\n\nconst MAX_LINES = 4;\n\nconst Blockquote = ({ canBeCollapsible, isToggleDisabled, children }: OwnProps) => {\n  // eslint-disable-next-line no-null/no-null\n  const ref = useRef<HTMLQuoteElement>(null);\n  const {\n    isCollapsed, isCollapsible, setIsCollapsed,\n  } = useCollapsibleLines(ref, MAX_LINES, undefined, !canBeCollapsible);\n\n  const canExpand = !isToggleDisabled && isCollapsed;\n\n  const handleExpand = useLastCallback(() => {\n    setIsCollapsed(false);\n  });\n\n  const handleToggle = useLastCallback(() => {\n    setIsCollapsed((prev) => !prev);\n  });\n\n  return (\n    <span\n      className={buildClassName(styles.root, isCollapsed && styles.collapsed)}\n      onClick={canExpand ? handleExpand : undefined}\n    >\n      <blockquote\n        className={styles.blockquote}\n        ref={ref}\n        data-entity-type={ApiMessageEntityTypes.Blockquote}\n      >\n        <div className={styles.gradientContainer}>\n          {children}\n        </div>\n        {isCollapsible && (\n          <div\n            className={buildClassName(styles.collapseIcon, !isToggleDisabled && styles.clickable)}\n            onClick={!isToggleDisabled ? handleToggle : undefined}\n            aria-hidden\n          >\n            <Icon name={isCollapsed ? 'down' : 'up'} />\n          </div>\n        )}\n      </blockquote>\n    </span>\n  );\n};\n\nexport default Blockquote;\n","const PRETTY_BY_ALIAS: Record<string, string | undefined> = {\n  js: 'JavaScript',\n  javascript: 'JavaScript',\n  ts: 'TypeScript',\n  typescript: 'TypeScript',\n  python: 'Python',\n  py: 'Python',\n  go: 'Go',\n  rust: 'Rust',\n  func: 'FunC',\n  c: 'C',\n  'c++': 'C++',\n  cpp: 'C++',\n  fortran: 'Fortran',\n  f90: 'Fortran',\n  f: 'Fortran',\n  java: 'Java',\n  sql: 'SQL',\n  swift: 'Swift',\n  'objective-c': 'Objective-C',\n  kotlin: 'Kotlin',\n  ruby: 'Ruby',\n  rb: 'Ruby',\n  php: 'PHP',\n  perl: 'Perl',\n  bash: 'Bash',\n  sh: 'Shell',\n  markdown: 'Markdown',\n  'c#': 'C#',\n  cs: 'C#',\n  json: 'JSON',\n  yaml: 'YAML',\n  yml: 'YAML',\n  solidity: 'Solidity',\n  sol: 'Solidity',\n  tl: 'TL',\n};\n\nexport function getPrettyCodeLanguageName(codeLanguage: string) {\n  const prettyLangName = PRETTY_BY_ALIAS[codeLanguage.toLowerCase()];\n  return prettyLangName ?? codeLanguage;\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"overlay\":\"pMUccFN9\",\"copy\":\"auCNtLQ4\",\"wrap\":\"a44ZN3hD\",\"wrapOn\":\"jq1KLfVD\",\"content\":\"L95Dh7wN\",\"hidden\":\"zctwFUQ8\"};","import type { FC } from '../../../lib/teact/teact';\nimport React, {\n  memo, useCallback, useEffect, useRef, useState,\n} from '../../../lib/teact/teact';\nimport { getActions } from '../../../global';\n\nimport buildClassName from '../../../util/buildClassName';\nimport { copyTextToClipboard } from '../../../util/clipboard';\nimport { areLinesWrapping } from '../helpers/renderText';\n\nimport useOldLang from '../../../hooks/useOldLang';\nimport useWindowSize from '../../../hooks/window/useWindowSize';\n\nimport Icon from '../icons/Icon';\n\nimport styles from './CodeOverlay.module.scss';\n\nexport type OwnProps = {\n  className?: string;\n  text: string;\n  noCopy?: boolean;\n  onWordWrapToggle?: (wrap: boolean) => void;\n};\n\nconst CodeOverlay: FC<OwnProps> = ({\n  text, className, noCopy, onWordWrapToggle,\n}) => {\n  const { showNotification } = getActions();\n  // eslint-disable-next-line no-null/no-null\n  const ref = useRef<HTMLDivElement>(null);\n  const windowSize = useWindowSize();\n  const lang = useOldLang();\n  const [isWordWrap, setIsWordWrap] = useState(true);\n  const [withWordWrapButton, setWithWordWrapButton] = useState(false);\n\n  const checkWordWrap = useCallback(() => {\n    const isWrap = areLinesWrapping(text, ref.current!.parentElement!);\n    setWithWordWrapButton(isWrap);\n  }, [text]);\n\n  useEffect(() => {\n    if (isWordWrap) {\n      checkWordWrap();\n    }\n  }, [checkWordWrap, isWordWrap, text, windowSize]);\n\n  const handleCopy = useCallback(() => {\n    copyTextToClipboard(text);\n    showNotification({\n      message: lang('TextCopied'),\n    });\n  }, [lang, showNotification, text]);\n\n  const handleWordWrapClick = useCallback(() => {\n    setIsWordWrap(!isWordWrap);\n    onWordWrapToggle?.(!isWordWrap);\n  }, [isWordWrap, onWordWrapToggle]);\n\n  const contentClass = buildClassName(styles.content, !withWordWrapButton && noCopy && styles.hidden);\n  const overlayClass = buildClassName(styles.overlay, className);\n  const wrapClass = buildClassName(styles.wrap, isWordWrap && styles.wrapOn);\n\n  return (\n    <div className={overlayClass} ref={ref}>\n      <div className={contentClass}>\n        {withWordWrapButton && (\n          <div className={wrapClass} onClick={handleWordWrapClick} title=\"Word Wrap\">\n            <Icon name=\"word-wrap\" />\n          </div>\n        )}\n        {!noCopy && (\n          <div className={styles.copy} onClick={handleCopy} title={lang('Copy')}>\n            <Icon name=\"copy\" />\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default memo(CodeOverlay);\n","import type { FC } from '../../../lib/teact/teact';\nimport React, { memo, useCallback, useState } from '../../../lib/teact/teact';\n\nimport { ApiMessageEntityTypes } from '../../../api/types';\n\nimport buildClassName from '../../../util/buildClassName';\nimport { getPrettyCodeLanguageName } from '../../../util/prettyCodeLanguageNames';\n\nimport useAsync from '../../../hooks/useAsync';\n\nimport PeerColorWrapper from '../PeerColorWrapper';\nimport CodeOverlay from './CodeOverlay';\n\nimport './CodeBlock.scss';\n\nexport type OwnProps = {\n  text: string;\n  language?: string;\n  noCopy?: boolean;\n};\n\nconst CodeBlock: FC<OwnProps> = ({ text, language, noCopy }) => {\n  const [isWordWrap, setWordWrap] = useState(true);\n\n  const { result: highlighted } = useAsync(() => {\n    if (!language) return Promise.resolve(undefined);\n    return import('../../../util/highlightCode')\n      .then((lib) => lib.default(text, language));\n  }, [language, text]);\n\n  const handleWordWrapToggle = useCallback((wrap) => {\n    setWordWrap(wrap);\n  }, []);\n\n  const blockClass = buildClassName(\n    'code-block',\n    !isWordWrap && 'no-word-wrap',\n  );\n\n  return (\n    <PeerColorWrapper\n      className=\"CodeBlock\"\n    >\n      {language && (<p className=\"code-title\">{getPrettyCodeLanguageName(language)}</p>)}\n      <pre className={blockClass} data-entity-type={ApiMessageEntityTypes.Pre} data-language={language}>\n        {highlighted ?? text}\n        <CodeOverlay\n          text={text}\n          className=\"code-overlay\"\n          onWordWrapToggle={handleWordWrapToggle}\n          noCopy={noCopy}\n        />\n      </pre>\n    </PeerColorWrapper>\n  );\n};\n\nexport default memo(CodeBlock);\n","import type { TeactNode } from '../../../lib/teact/teact';\nimport React, { memo, useEffect, useRef } from '../../../lib/teact/teact';\n\nimport { ApiMessageEntityTypes } from '../../../api/types';\n\nimport { createClassNameBuilder } from '../../../util/buildClassName';\nimport stopEvent from '../../../util/stopEvent';\n\nimport useFlag from '../../../hooks/useFlag';\nimport useLastCallback from '../../../hooks/useLastCallback';\n\nimport './Spoiler.scss';\n\ntype OwnProps = {\n  children?: TeactNode;\n  containerId?: string;\n};\n\nconst revealByContainerId: Map<string, VoidFunction[]> = new Map();\n\nconst buildClassName = createClassNameBuilder('Spoiler');\n\nconst Spoiler = ({\n  children,\n  containerId,\n}: OwnProps) => {\n  // eslint-disable-next-line no-null/no-null\n  const contentRef = useRef<HTMLDivElement>(null);\n\n  const [isRevealed, revealSpoiler] = useFlag();\n\n  const handleClick = useLastCallback((e: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n    if (!containerId) return;\n\n    if (!isRevealed) {\n      stopEvent(e);\n    }\n\n    revealByContainerId.get(containerId)?.forEach((reveal) => reveal());\n  });\n\n  useEffect(() => {\n    if (!containerId) {\n      return undefined;\n    }\n\n    if (revealByContainerId.has(containerId)) {\n      revealByContainerId.get(containerId)!.push(revealSpoiler);\n    } else {\n      revealByContainerId.set(containerId, [revealSpoiler]);\n    }\n\n    return () => {\n      revealByContainerId.delete(containerId);\n    };\n  }, [containerId]);\n\n  return (\n    <span\n      className={buildClassName(\n        '&',\n        !isRevealed && 'concealed',\n        !isRevealed && Boolean(containerId) && 'animated',\n      )}\n      onClick={containerId && !isRevealed ? handleClick : undefined}\n      data-entity-type={ApiMessageEntityTypes.Spoiler}\n    >\n      <span className={buildClassName('content')} ref={contentRef}>\n        {children}\n      </span>\n    </span>\n  );\n};\n\nexport default memo(Spoiler);\n","import React from '../../../lib/teact/teact';\nimport { getActions } from '../../../global';\n\nimport type { ApiFormattedText, ApiMessageEntity } from '../../../api/types';\nimport type { ObserveFn } from '../../../hooks/useIntersectionObserver';\nimport type { TextPart, ThreadId } from '../../../types';\nimport type { TextFilter } from './renderText';\nimport { ApiMessageEntityTypes } from '../../../api/types';\n\nimport buildClassName from '../../../util/buildClassName';\nimport { copyTextToClipboard } from '../../../util/clipboard';\nimport { oldTranslate } from '../../../util/oldLangProvider';\nimport { buildCustomEmojiHtmlFromEntity } from '../../middle/composer/helpers/customEmoji';\nimport renderText from './renderText';\n\nimport MentionLink from '../../middle/message/MentionLink';\nimport Blockquote from '../Blockquote';\nimport CodeBlock from '../code/CodeBlock';\nimport CustomEmoji from '../CustomEmoji';\nimport SafeLink from '../SafeLink';\nimport Spoiler from '../spoiler/Spoiler';\n\ninterface IOrganizedEntity {\n  entity: ApiMessageEntity;\n  organizedIndexes: Set<number>;\n  nestedEntities: IOrganizedEntity[];\n}\ntype RenderTextParams = Parameters<typeof renderText>[2];\n\nconst HQ_EMOJI_THRESHOLD = 64;\n\nexport function renderTextWithEntities({\n  text,\n  entities,\n  highlight,\n  emojiSize,\n  shouldRenderAsHtml,\n  containerId,\n  asPreview,\n  isProtected,\n  observeIntersectionForLoading,\n  observeIntersectionForPlaying,\n  withTranslucentThumbs,\n  sharedCanvasRef,\n  sharedCanvasHqRef,\n  cacheBuster,\n  forcePlayback,\n  noCustomEmojiPlayback,\n  isInSelectMode,\n  chatId,\n  messageId,\n  threadId,\n  maxTimestamp,\n}: {\n  text: string;\n  entities?: ApiMessageEntity[];\n  highlight?: string;\n  emojiSize?: number;\n  shouldRenderAsHtml?: boolean;\n  containerId?: string;\n  asPreview?: boolean;\n  isProtected?: boolean;\n  observeIntersectionForLoading?: ObserveFn;\n  observeIntersectionForPlaying?: ObserveFn;\n  withTranslucentThumbs?: boolean;\n  sharedCanvasRef?: React.RefObject<HTMLCanvasElement>;\n  sharedCanvasHqRef?: React.RefObject<HTMLCanvasElement>;\n  cacheBuster?: string;\n  forcePlayback?: boolean;\n  noCustomEmojiPlayback?: boolean;\n  isInSelectMode?: boolean;\n  chatId?: string;\n  messageId?: number;\n  threadId?: ThreadId;\n  maxTimestamp?: number;\n}) {\n  if (!entities?.length) {\n    return renderMessagePart({\n      content: text,\n      highlight,\n      emojiSize,\n      shouldRenderAsHtml,\n      asPreview,\n    });\n  }\n\n  const result: TextPart[] = [];\n  let deleteLineBreakAfterPre = false;\n\n  const organizedEntities = organizeEntities(entities);\n\n  // Recursive function to render regular and nested entities\n  function renderEntity(\n    textPartStart: number,\n    textPartEnd: number,\n    organizedEntity: IOrganizedEntity,\n    isLastEntity: boolean,\n  ) {\n    const renderResult: TextPart[] = [];\n    const { entity, nestedEntities } = organizedEntity;\n    const { offset, length, type } = entity;\n\n    // Render text before the entity\n    let textBefore = text.substring(textPartStart, offset);\n    const textBeforeLength = textBefore.length;\n    if (textBefore) {\n      if (deleteLineBreakAfterPre && textBefore.length > 0 && textBefore[0] === '\\n') {\n        textBefore = textBefore.substr(1);\n        deleteLineBreakAfterPre = false;\n      }\n      if (textBefore) {\n        renderResult.push(...renderMessagePart({\n          content: textBefore,\n          highlight,\n          emojiSize,\n          shouldRenderAsHtml,\n          asPreview,\n        }) as TextPart[]);\n      }\n    }\n\n    const entityStartIndex = textPartStart + textBeforeLength;\n    const entityEndIndex = entityStartIndex + length;\n\n    let entityContent: TextPart = text.substring(offset, offset + length);\n    const nestedEntityContent: TextPart[] = [];\n\n    if (deleteLineBreakAfterPre && entityContent.length > 0 && entityContent[0] === '\\n') {\n      entityContent = entityContent.substr(1);\n      deleteLineBreakAfterPre = false;\n    }\n\n    if (type === ApiMessageEntityTypes.Pre) {\n      deleteLineBreakAfterPre = true;\n    }\n\n    // Render nested entities, if any\n    if (nestedEntities.length) {\n      let nestedIndex = entityStartIndex;\n\n      nestedEntities.forEach((nestedEntity, nestedEntityIndex) => {\n        const {\n          renderResult: nestedResult,\n          entityEndIndex: nestedEntityEndIndex,\n        } = renderEntity(\n          nestedIndex,\n          entityEndIndex,\n          nestedEntity,\n          nestedEntityIndex === nestedEntities.length - 1,\n        );\n\n        nestedEntityContent.push(...nestedResult);\n        nestedIndex = nestedEntityEndIndex;\n      });\n    }\n\n    // Render the entity itself\n    const newEntity = shouldRenderAsHtml\n      ? processEntityAsHtml(entity, entityContent, nestedEntityContent)\n      : processEntity({\n        entity,\n        entityContent,\n        nestedEntityContent,\n        highlight,\n        containerId,\n        asPreview,\n        isProtected,\n        observeIntersectionForLoading,\n        observeIntersectionForPlaying,\n        withTranslucentThumbs,\n        emojiSize,\n        sharedCanvasRef,\n        sharedCanvasHqRef,\n        cacheBuster,\n        forcePlayback,\n        noCustomEmojiPlayback,\n        isInSelectMode,\n        chatId,\n        messageId,\n        threadId,\n        maxTimestamp,\n      });\n\n    if (Array.isArray(newEntity)) {\n      renderResult.push(...newEntity);\n    } else {\n      renderResult.push(newEntity);\n    }\n\n    // Render text after the entity, if it is the last entity in the text,\n    // or the last nested entity inside of another entity\n    if (isLastEntity && entityEndIndex < textPartEnd) {\n      let textAfter = text.substring(entityEndIndex, textPartEnd);\n      if (deleteLineBreakAfterPre && textAfter.length > 0 && textAfter[0] === '\\n') {\n        textAfter = textAfter.substring(1);\n      }\n      if (textAfter) {\n        renderResult.push(...renderMessagePart({\n          content: textAfter,\n          highlight,\n          emojiSize,\n          shouldRenderAsHtml,\n          asPreview,\n        }) as TextPart[]);\n      }\n    }\n\n    return {\n      renderResult,\n      entityEndIndex,\n    };\n  }\n\n  // Process highest-level entities\n  let index = 0;\n\n  organizedEntities.forEach((entity, arrayIndex) => {\n    const { renderResult, entityEndIndex } = renderEntity(\n      index,\n      text.length,\n      entity,\n      arrayIndex === organizedEntities.length - 1,\n    );\n\n    result.push(...renderResult);\n    index = entityEndIndex;\n  });\n\n  return result;\n}\n\nexport function getTextWithEntitiesAsHtml(formattedText?: ApiFormattedText) {\n  const { text, entities } = formattedText || {};\n  if (!text) {\n    return '';\n  }\n\n  const result = renderTextWithEntities({\n    text,\n    entities,\n    shouldRenderAsHtml: true,\n  });\n\n  if (Array.isArray(result)) {\n    return result.join('');\n  }\n\n  return result;\n}\n\nfunction renderMessagePart({\n  content,\n  highlight,\n  focusedQuote,\n  emojiSize,\n  shouldRenderAsHtml,\n  asPreview,\n} : {\n  content: TextPart | TextPart[];\n  highlight?: string;\n  focusedQuote?: string;\n  emojiSize?: number;\n  shouldRenderAsHtml?: boolean;\n  asPreview?: boolean;\n}) {\n  if (Array.isArray(content)) {\n    const result: TextPart[] = [];\n\n    content.forEach((c) => {\n      result.push(...renderMessagePart({\n        content: c,\n        highlight,\n        focusedQuote,\n        emojiSize,\n        shouldRenderAsHtml,\n        asPreview,\n      }));\n    });\n\n    return result;\n  }\n\n  if (shouldRenderAsHtml) {\n    return renderText(content, ['escape_html', 'emoji_html', 'br_html']);\n  }\n\n  const emojiFilter = emojiSize && emojiSize > HQ_EMOJI_THRESHOLD ? 'hq_emoji' : 'emoji';\n\n  const filters: TextFilter[] = [emojiFilter];\n  const params: RenderTextParams = {};\n  if (!asPreview) {\n    filters.push('br');\n  }\n\n  if (highlight) {\n    filters.push('highlight');\n    params.highlight = highlight;\n  }\n\n  return renderText(content, filters, params);\n}\n\nexport function insertTextEntity(entities: ApiMessageEntity[], newEntity: ApiMessageEntity) {\n  const resultEntities: ApiMessageEntity[] = [];\n\n  const newEntityStart = newEntity.offset;\n  const newEntityEnd = newEntity.offset + newEntity.length;\n\n  for (const existingEntity of entities) {\n    const existingEntityStart = existingEntity.offset;\n    const existingEntityEnd = existingEntity.offset + existingEntity.length;\n    // Push as is if edges do not overlap\n    if (existingEntityEnd <= newEntityStart\n      || existingEntityStart > newEntityEnd\n      || (existingEntityStart > newEntityStart\n        && existingEntityEnd < newEntityEnd)) {\n      resultEntities.push(existingEntity);\n      continue;\n    }\n\n    // If start edge overlaps\n    if (existingEntityStart < newEntityStart && existingEntityEnd > newEntityStart) {\n      // Split entity in two\n      resultEntities.push({\n        ...existingEntity,\n        length: newEntityStart - existingEntityStart,\n      });\n      resultEntities.push({\n        ...existingEntity,\n        offset: newEntityStart,\n        length: existingEntityEnd - newEntityStart,\n      });\n    }\n\n    // If end edge overlaps\n    if (existingEntityStart < newEntityEnd\n      && existingEntityEnd > newEntityEnd) {\n      // Split entity in two\n      resultEntities.push({\n        ...existingEntity,\n        offset: newEntityEnd,\n        length: existingEntityEnd - newEntityStart - newEntity.length,\n      });\n      resultEntities.push({\n        ...existingEntity,\n        length: newEntityEnd - existingEntityStart,\n      });\n    }\n  }\n\n  resultEntities.push(newEntity);\n  // Sort entities by offset, longer entities first\n  return resultEntities.sort((a, b) => a.offset - b.offset || b.length - a.length);\n}\n\n// Organize entities in a tree-like structure to better represent how the text will be displayed\nfunction organizeEntities(entities: ApiMessageEntity[]) {\n  const organizedEntityIndexes: Set<number> = new Set();\n  const organizedEntities: IOrganizedEntity[] = [];\n\n  entities.forEach((entity, index) => {\n    if (organizedEntityIndexes.has(index)) {\n      return;\n    }\n\n    const organizedEntity = organizeEntity(entity, index, entities, organizedEntityIndexes);\n    if (organizedEntity) {\n      organizedEntity.organizedIndexes.forEach((organizedIndex) => {\n        organizedEntityIndexes.add(organizedIndex);\n      });\n\n      organizedEntities.push(organizedEntity);\n    }\n  });\n\n  return organizedEntities;\n}\n\nfunction organizeEntity(\n  entity: ApiMessageEntity,\n  index: number,\n  entities: ApiMessageEntity[],\n  organizedEntityIndexes: Set<number>,\n): IOrganizedEntity | undefined {\n  const { offset, length } = entity;\n  const organizedIndexes = new Set([index]);\n\n  if (organizedEntityIndexes.has(index)) {\n    return undefined;\n  }\n\n  // Determine any nested entities inside current entity\n  const nestedEntities: IOrganizedEntity[] = [];\n  const parsedNestedEntities = entities\n    .filter((e, i) => i > index && e.offset >= offset && e.offset < offset + length)\n    .map((e) => organizeEntity(e, entities.indexOf(e), entities, organizedEntityIndexes))\n    .filter(Boolean);\n\n  parsedNestedEntities.forEach((parsedEntity) => {\n    let isChanged = false;\n\n    parsedEntity.organizedIndexes.forEach((organizedIndex) => {\n      if (!isChanged && !organizedIndexes.has(organizedIndex)) {\n        isChanged = true;\n      }\n\n      organizedIndexes.add(organizedIndex);\n    });\n\n    if (isChanged) {\n      nestedEntities.push(parsedEntity);\n    }\n  });\n\n  return {\n    entity,\n    organizedIndexes,\n    nestedEntities,\n  };\n}\n\nfunction processEntity({\n  entity,\n  entityContent,\n  nestedEntityContent,\n  highlight,\n  containerId,\n  asPreview,\n  isProtected,\n  observeIntersectionForLoading,\n  observeIntersectionForPlaying,\n  withTranslucentThumbs,\n  emojiSize,\n  sharedCanvasRef,\n  sharedCanvasHqRef,\n  cacheBuster,\n  forcePlayback,\n  noCustomEmojiPlayback,\n  isInSelectMode,\n  chatId,\n  messageId,\n  threadId,\n  maxTimestamp,\n} : {\n  entity: ApiMessageEntity;\n  entityContent: TextPart;\n  nestedEntityContent: TextPart[];\n  highlight?: string;\n  focusedQuote?: string;\n  containerId?: string;\n  asPreview?: boolean;\n  isProtected?: boolean;\n  observeIntersectionForLoading?: ObserveFn;\n  observeIntersectionForPlaying?: ObserveFn;\n  withTranslucentThumbs?: boolean;\n  emojiSize?: number;\n  sharedCanvasRef?: React.RefObject<HTMLCanvasElement>;\n  sharedCanvasHqRef?: React.RefObject<HTMLCanvasElement>;\n  cacheBuster?: string;\n  forcePlayback?: boolean;\n  noCustomEmojiPlayback?: boolean;\n  isInSelectMode?: boolean;\n  chatId?: string;\n  messageId?: number;\n  threadId?: ThreadId;\n  maxTimestamp?: number;\n}) {\n  const entityText = typeof entityContent === 'string' && entityContent;\n  const renderedContent = nestedEntityContent.length ? nestedEntityContent : entityContent;\n\n  function renderNestedMessagePart() {\n    return renderMessagePart({\n      content: renderedContent,\n      highlight,\n      emojiSize,\n      asPreview,\n    });\n  }\n\n  if (!entityText) {\n    return renderNestedMessagePart();\n  }\n\n  if (asPreview) {\n    const text = renderNestedMessagePart();\n    if (entity.type === ApiMessageEntityTypes.Spoiler) {\n      return <Spoiler>{text}</Spoiler>;\n    }\n\n    if (entity.type === ApiMessageEntityTypes.CustomEmoji) {\n      return (\n        <CustomEmoji\n          key={cacheBuster ? `${cacheBuster}-${entity.offset}` : undefined}\n          documentId={entity.documentId}\n          size={emojiSize}\n          isSelectable\n          withSharedAnimation\n          sharedCanvasRef={sharedCanvasRef}\n          sharedCanvasHqRef={sharedCanvasHqRef}\n          observeIntersectionForLoading={observeIntersectionForLoading}\n          observeIntersectionForPlaying={observeIntersectionForPlaying}\n          withTranslucentThumb={withTranslucentThumbs}\n          forceAlways={forcePlayback}\n          noPlay={noCustomEmojiPlayback}\n        />\n      );\n    }\n    return text;\n  }\n\n  switch (entity.type) {\n    case ApiMessageEntityTypes.Bold:\n      return <strong data-entity-type={entity.type}>{renderNestedMessagePart()}</strong>;\n    case ApiMessageEntityTypes.Blockquote:\n      return (\n        <Blockquote canBeCollapsible={entity.canCollapse} isToggleDisabled={isInSelectMode}>\n          {renderNestedMessagePart()}\n        </Blockquote>\n      );\n    case ApiMessageEntityTypes.BotCommand:\n      return (\n        <a\n          onClick={handleBotCommandClick}\n          className=\"text-entity-link\"\n          dir=\"auto\"\n          data-entity-type={entity.type}\n        >\n          {renderNestedMessagePart()}\n        </a>\n      );\n    case ApiMessageEntityTypes.Hashtag: {\n      const [tag, username] = entityContent.split('@');\n      return (\n        <a\n          onClick={() => handleHashtagClick(tag, username)}\n          className=\"text-entity-link\"\n          dir=\"auto\"\n          data-entity-type={entity.type}\n        >\n          {renderNestedMessagePart()}\n        </a>\n      );\n    }\n    case ApiMessageEntityTypes.Cashtag: {\n      const [tag, username] = entityContent.split('@');\n      return (\n        <a\n          onClick={() => handleHashtagClick(tag, username)}\n          className=\"text-entity-link\"\n          dir=\"auto\"\n          data-entity-type={entity.type}\n        >\n          {renderNestedMessagePart()}\n        </a>\n      );\n    }\n    case ApiMessageEntityTypes.Code:\n      return (\n        <code\n          className={buildClassName('text-entity-code', 'clickable')}\n          onClick={handleCodeClick}\n          role=\"textbox\"\n          tabIndex={0}\n          data-entity-type={entity.type}\n        >\n          {renderNestedMessagePart()}\n        </code>\n      );\n    case ApiMessageEntityTypes.Email:\n      return (\n        <a\n          href={`mailto:${entityText}`}\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n          className=\"text-entity-link\"\n          dir=\"auto\"\n          data-entity-type={entity.type}\n        >\n          {renderNestedMessagePart()}\n        </a>\n      );\n    case ApiMessageEntityTypes.Italic:\n      return <em data-entity-type={entity.type}>{renderNestedMessagePart()}</em>;\n    case ApiMessageEntityTypes.MentionName:\n      return (\n        <MentionLink userId={entity.userId}>\n          {renderNestedMessagePart()}\n        </MentionLink>\n      );\n    case ApiMessageEntityTypes.Mention:\n      return (\n        <MentionLink username={entityText}>\n          {renderNestedMessagePart()}\n        </MentionLink>\n      );\n    case ApiMessageEntityTypes.Phone:\n      return (\n        <a\n          href={`tel:${entityText}`}\n          className=\"text-entity-link\"\n          dir=\"auto\"\n          data-entity-type={entity.type}\n        >\n          {renderNestedMessagePart()}\n        </a>\n      );\n    case ApiMessageEntityTypes.Pre:\n      return <CodeBlock text={entityText} language={entity.language} noCopy={isProtected} />;\n    case ApiMessageEntityTypes.Strike:\n      return <del data-entity-type={entity.type}>{renderNestedMessagePart()}</del>;\n    case ApiMessageEntityTypes.TextUrl:\n    case ApiMessageEntityTypes.Url:\n      return (\n        <SafeLink\n          url={getLinkUrl(entityText, entity)}\n          text={entityText}\n        >\n          {renderNestedMessagePart()}\n        </SafeLink>\n      );\n    case ApiMessageEntityTypes.Underline:\n      return <ins data-entity-type={entity.type}>{renderNestedMessagePart()}</ins>;\n    case ApiMessageEntityTypes.Timestamp:\n      if (!chatId || !messageId || !maxTimestamp || entity.timestamp > maxTimestamp) {\n        return renderNestedMessagePart();\n      }\n\n      return (\n        <a\n          onClick={() => handleTimecodeClick(chatId, messageId, threadId, entity.timestamp)}\n          className=\"text-entity-link\"\n          dir=\"auto\"\n          data-entity-type={entity.type}\n        >\n          {renderNestedMessagePart()}\n        </a>\n      );\n    case ApiMessageEntityTypes.Spoiler:\n      return <Spoiler containerId={containerId}>{renderNestedMessagePart()}</Spoiler>;\n    case ApiMessageEntityTypes.CustomEmoji:\n      return (\n        <CustomEmoji\n          key={cacheBuster ? `${cacheBuster}-${entity.offset}` : undefined}\n          documentId={entity.documentId}\n          size={emojiSize}\n          isSelectable\n          withSharedAnimation\n          sharedCanvasRef={sharedCanvasRef}\n          sharedCanvasHqRef={sharedCanvasHqRef}\n          observeIntersectionForLoading={observeIntersectionForLoading}\n          observeIntersectionForPlaying={observeIntersectionForPlaying}\n          withTranslucentThumb={withTranslucentThumbs}\n          forceAlways={forcePlayback}\n          noPlay={noCustomEmojiPlayback}\n        />\n      );\n    case ApiMessageEntityTypes.QuoteFocus:\n      return (\n        <span className=\"matching-text-highlight is-quote\">{renderNestedMessagePart()}</span>\n      );\n    default:\n      return renderNestedMessagePart();\n  }\n}\n\nfunction processEntityAsHtml(\n  entity: ApiMessageEntity,\n  entityContent: TextPart,\n  nestedEntityContent: TextPart[],\n) {\n  const rawEntityText = typeof entityContent === 'string' ? entityContent : undefined;\n\n  // Prevent adding newlines when editing\n  const content = entity.type === ApiMessageEntityTypes.Pre ? (entityContent as string).trimEnd() : entityContent;\n\n  const renderedContent = nestedEntityContent.length\n    ? nestedEntityContent.join('')\n    : renderText(content, ['escape_html', 'emoji_html', 'br_html']).join('');\n\n  if (!rawEntityText) {\n    return renderedContent;\n  }\n\n  switch (entity.type) {\n    case ApiMessageEntityTypes.Bold:\n      return `<b>${renderedContent}</b>`;\n    case ApiMessageEntityTypes.Italic:\n      return `<i>${renderedContent}</i>`;\n    case ApiMessageEntityTypes.Underline:\n      return `<u>${renderedContent}</u>`;\n    case ApiMessageEntityTypes.Code:\n      return `<code class=\"text-entity-code\">${renderedContent}</code>`;\n    case ApiMessageEntityTypes.Pre:\n      return `\\`\\`\\`${renderText(entity.language || '', ['escape_html'])}<br/>${renderedContent}<br/>\\`\\`\\`<br/>`;\n    case ApiMessageEntityTypes.Strike:\n      return `<del>${renderedContent}</del>`;\n    case ApiMessageEntityTypes.MentionName:\n      return `<a\n        class=\"text-entity-link\"\n        data-entity-type=\"${ApiMessageEntityTypes.MentionName}\"\n        data-user-id=\"${entity.userId}\"\n        contenteditable=\"false\"\n        dir=\"auto\"\n      >${renderedContent}</a>`;\n    case ApiMessageEntityTypes.Url:\n    case ApiMessageEntityTypes.TextUrl:\n      return `<a\n        class=\"text-entity-link\"\n        href=${getLinkUrl(rawEntityText, entity)}\n        data-entity-type=\"${entity.type}\"\n        dir=\"auto\"\n      >${renderedContent}</a>`;\n    case ApiMessageEntityTypes.Spoiler:\n      return `<span\n        class=\"spoiler\"\n        data-entity-type=\"${ApiMessageEntityTypes.Spoiler}\"\n        >${renderedContent}</span>`;\n    case ApiMessageEntityTypes.CustomEmoji:\n      return buildCustomEmojiHtmlFromEntity(rawEntityText, entity);\n    case ApiMessageEntityTypes.Blockquote:\n      return `<blockquote\n        class=\"blockquote\"\n        data-entity-type=\"${ApiMessageEntityTypes.Blockquote}\"\n        >${renderedContent}</blockquote>`;\n    default:\n      return renderedContent;\n  }\n}\n\nfunction getLinkUrl(entityContent: string, entity: ApiMessageEntity) {\n  const { type } = entity;\n  return type === ApiMessageEntityTypes.TextUrl && entity.url ? entity.url : entityContent;\n}\n\nfunction handleBotCommandClick(e: React.MouseEvent<HTMLAnchorElement>) {\n  getActions().sendBotCommand({ command: e.currentTarget.innerText });\n}\n\nfunction handleHashtagClick(hashtag?: string, username?: string) {\n  if (!hashtag) return;\n  if (username) {\n    getActions().openChatByUsername({\n      username,\n      onChatChanged: {\n        action: 'searchHashtag',\n        payload: { hashtag },\n      },\n    });\n    return;\n  }\n  getActions().searchHashtag({ hashtag });\n}\n\nfunction handleCodeClick(e: React.MouseEvent<HTMLElement>) {\n  copyTextToClipboard(e.currentTarget.innerText);\n  getActions().showNotification({\n    message: oldTranslate('TextCopied'),\n  });\n}\n\nfunction handleTimecodeClick(\n  chatId: string, messageId: number, threadId: ThreadId | undefined, timestamp: number,\n) {\n  getActions().openMediaFromTimestamp({\n    chatId, messageId, threadId, timestamp,\n  });\n}\n","import React, { memo } from '../../lib/teact/teact';\nimport { withGlobal } from '../../global';\n\nimport type {\n  ApiFormattedText, ApiMessage, ApiPoll, ApiTypeStory,\n} from '../../api/types';\nimport type { ObserveFn } from '../../hooks/useIntersectionObserver';\n\nimport {\n  extractMessageText,\n  getMessagePollId,\n  groupStatefulContent,\n  isActionMessage,\n} from '../../global/helpers';\nimport {\n  getMessageSummaryDescription,\n  getMessageSummaryEmoji,\n  getMessageSummaryText,\n  TRUNCATED_SUMMARY_LENGTH,\n} from '../../global/helpers/messageSummary';\nimport { selectPeerStory, selectPollFromMessage } from '../../global/selectors';\nimport trimText from '../../util/trimText';\nimport renderText from './helpers/renderText';\n\nimport useOldLang from '../../hooks/useOldLang';\n\nimport ActionMessageText from '../middle/message/ActionMessageText';\nimport MessageText from './MessageText';\n\ntype OwnProps = {\n  message: ApiMessage;\n  translatedText?: ApiFormattedText;\n  noEmoji?: boolean;\n  highlight?: string;\n  truncateLength?: number;\n  withTranslucentThumbs?: boolean;\n  inChatList?: boolean;\n  emojiSize?: number;\n  observeIntersectionForLoading?: ObserveFn;\n  observeIntersectionForPlaying?: ObserveFn;\n};\n\ntype StateProps = {\n  poll?: ApiPoll;\n  story?: ApiTypeStory;\n};\n\nfunction MessageSummary({\n  message,\n  translatedText,\n  noEmoji = false,\n  highlight,\n  truncateLength = TRUNCATED_SUMMARY_LENGTH,\n  withTranslucentThumbs = false,\n  inChatList = false,\n  emojiSize,\n  poll,\n  story,\n  observeIntersectionForLoading,\n  observeIntersectionForPlaying,\n}: OwnProps & StateProps) {\n  const lang = useOldLang();\n  const extractedText = extractMessageText(message, inChatList);\n  const hasPoll = Boolean(getMessagePollId(message));\n  const isAction = isActionMessage(message);\n\n  const statefulContent = groupStatefulContent({ poll, story });\n\n  if (!extractedText && !hasPoll && !isAction) {\n    const summaryText = translatedText?.text\n      || getMessageSummaryText(lang, message, statefulContent, noEmoji, truncateLength);\n    const trimmedText = trimText(summaryText, truncateLength);\n\n    return (\n      <span>\n        {highlight ? (\n          renderText(trimmedText, ['emoji', 'highlight'], { highlight })\n        ) : (\n          renderText(trimmedText)\n        )}\n      </span>\n    );\n  }\n\n  function renderMessageText() {\n    if (isAction) {\n      return <ActionMessageText message={message} asPreview />;\n    }\n\n    return (\n      <MessageText\n        messageOrStory={message}\n        translatedText={translatedText}\n        highlight={highlight}\n        asPreview\n        observeIntersectionForLoading={observeIntersectionForLoading}\n        observeIntersectionForPlaying={observeIntersectionForPlaying}\n        withTranslucentThumbs={withTranslucentThumbs}\n        truncateLength={truncateLength}\n        inChatList={inChatList}\n        emojiSize={emojiSize}\n      />\n    );\n  }\n\n  const emoji = !noEmoji && getMessageSummaryEmoji(message);\n\n  return (\n    <>\n      {[\n        emoji ? renderText(`${emoji} `) : undefined,\n        getMessageSummaryDescription(lang, message, statefulContent, renderMessageText()),\n      ].flat().filter(Boolean)}\n    </>\n  );\n}\n\nexport default memo(withGlobal<OwnProps>(\n  (global, { message }): StateProps => {\n    const poll = selectPollFromMessage(global, message);\n    const storyData = message.content.storyData;\n    const story = storyData && selectPeerStory(global, storyData.peerId, storyData.id);\n\n    return {\n      poll,\n      story,\n    };\n  },\n)(MessageSummary));\n","import { useRef } from '../lib/teact/teact';\n\nimport type { Signal } from '../util/signals';\n\nimport useForceUpdate from './useForceUpdate';\nimport { useSignalEffect } from './useSignalEffect';\nimport { useStateRef } from './useStateRef';\nimport useSyncEffect from './useSyncEffect';\n\ntype SyncResolver<T> = () => T;\ntype AsyncResolver<T> = (setter: (newValue: T) => void) => void;\ntype Resolver<T> =\n  SyncResolver<T>\n  | AsyncResolver<T>;\n\nfunction useDerivedState<T>(resolver: SyncResolver<T>, dependencies: readonly any[]): T;\nfunction useDerivedState<T>(resolver: AsyncResolver<T>, dependencies: readonly any[], isAsync: true): T;\nfunction useDerivedState<T>(signal: Signal<T>): T;\n\nfunction useDerivedState<T>(resolverOrSignal: Resolver<T> | T, dependencies?: readonly any[], isAsync = false) {\n  const resolver = dependencies ? resolverOrSignal as Resolver<T> : () => ((resolverOrSignal as Signal<T>)());\n  dependencies ??= [resolverOrSignal];\n\n  const valueRef = useRef<T>();\n  const forceUpdate = useForceUpdate();\n  const resolverRef = useStateRef(resolver);\n\n  function runCurrentResolver(isSync = false) {\n    const currentResolver = resolverRef.current;\n    if (isAsync) {\n      (currentResolver as AsyncResolver<T>)((newValue) => {\n        if (valueRef.current !== newValue) {\n          valueRef.current = newValue;\n          forceUpdate();\n        }\n      });\n    } else {\n      const newValue = (currentResolver as SyncResolver<T>)();\n      if (valueRef.current !== newValue) {\n        valueRef.current = newValue;\n\n        if (!isSync) {\n          forceUpdate();\n        }\n      }\n    }\n  }\n\n  useSyncEffect(() => {\n    runCurrentResolver(true);\n    // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  }, dependencies);\n\n  // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  useSignalEffect(runCurrentResolver, dependencies);\n\n  return valueRef.current as T;\n}\n\nexport default useDerivedState;\n","const cache = new WeakMap<AnyFunction, Map<string, any>>();\n\nexport default function withCache<T extends AnyFunction>(fn: T) {\n  return (...args: Parameters<T>): ReturnType<T> => {\n    let fnCache = cache.get(fn);\n    const cacheKey = args.map(String).join('_');\n\n    if (fnCache) {\n      const cached = fnCache.get(cacheKey);\n      if (cached) {\n        return cached;\n      }\n    } else {\n      fnCache = new Map();\n      cache.set(fn, fnCache);\n    }\n\n    const newValue = fn(...args);\n\n    fnCache.set(cacheKey, newValue);\n\n    return newValue;\n  };\n}\n","import type {\n  ApiChat,\n  ApiInputMessageReplyInfo,\n  ApiMessage,\n  ApiMessageEntityCustomEmoji,\n  ApiMessageForwardInfo,\n  ApiMessageOutgoingStatus,\n  ApiPeer, ApiSponsoredMessage,\n  ApiStickerSetInfo,\n} from '../../api/types';\nimport type {\n  ChatTranslatedMessages,\n  MessageListType,\n  TabThread,\n  Thread,\n  ThreadId,\n} from '../../types';\nimport type { IAllowedAttachmentOptions } from '../helpers';\nimport type {\n  GlobalState, TabArgs,\n} from '../types';\nimport { ApiMessageEntityTypes, MAIN_THREAD_ID } from '../../api/types';\n\nimport {\n  ANONYMOUS_USER_ID, API_GENERAL_ID_LIMIT, GENERAL_TOPIC_ID, SERVICE_NOTIFICATIONS_USER_ID,\n} from '../../config';\nimport { IS_TRANSLATION_SUPPORTED } from '../../util/browser/windowEnvironment';\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { findLast } from '../../util/iteratees';\nimport { getMessageKey, isLocalMessageId } from '../../util/keys/messageKey';\nimport { MEMO_EMPTY_ARRAY } from '../../util/memo';\nimport { getServerTime } from '../../util/serverTime';\nimport {\n  canSendReaction,\n  getAllowedAttachmentOptions,\n  getCanPostInChat,\n  getHasAdminRight,\n  getIsSavedDialog,\n  getMessageAudio,\n  getMessageDocument,\n  getMessageLink,\n  getMessagePaidMedia,\n  getMessagePhoto,\n  getMessageVideo,\n  getMessageVoice,\n  getMessageWebPagePhoto,\n  getMessageWebPageVideo,\n  getSendingState,\n  getTimestampableMedia,\n  hasMessageTtl,\n  isActionMessage,\n  isChatBasicGroup,\n  isChatChannel,\n  isChatGroup,\n  isChatSuperGroup,\n  isCommonBoxChat,\n  isExpiredMessage,\n  isForwardedMessage,\n  isMessageDocumentSticker,\n  isMessageFailed,\n  isMessageLocal,\n  isMessageTranslatable,\n  isOwnMessage,\n  isServiceNotificationMessage,\n  isUserId,\n  isUserRightBanned,\n} from '../helpers';\nimport { getMessageReplyInfo } from '../helpers/replies';\nimport {\n  selectChat,\n  selectChatFullInfo,\n  selectChatLastMessageId,\n  selectIsChatWithSelf,\n  selectRequestedChatTranslationLanguage,\n} from './chats';\nimport { selectPeer, selectPeerPaidMessagesStars } from './peers';\nimport { selectPeerStory } from './stories';\nimport { selectIsStickerFavorite } from './symbols';\nimport { selectTabState } from './tabs';\nimport { selectTopic } from './topics';\nimport {\n  selectBot, selectIsCurrentUserPremium, selectUser, selectUserStatus,\n} from './users';\n\nexport function selectCurrentMessageList<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { messageLists } = selectTabState(global, tabId);\n\n  if (messageLists.length) {\n    return messageLists[messageLists.length - 1];\n  }\n\n  return undefined;\n}\n\nexport function selectCurrentChat<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { chatId } = selectCurrentMessageList(global, tabId) || {};\n\n  return chatId ? selectChat(global, chatId) : undefined;\n}\n\nexport function selectChatMessages<T extends GlobalState>(global: T, chatId: string) {\n  return global.messages.byChatId[chatId]?.byId;\n}\n\nexport function selectChatScheduledMessages<T extends GlobalState>(global: T, chatId: string) {\n  return global.scheduledMessages.byChatId[chatId]?.byId;\n}\n\nexport function selectTabThreadParam<T extends GlobalState, K extends keyof TabThread>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  key: K,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).tabThreads[chatId]?.[threadId]?.[key];\n}\n\nexport function selectThreadParam<T extends GlobalState, K extends keyof Thread>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  key: K,\n) {\n  return selectThread(global, chatId, threadId)?.[key];\n}\n\nexport function selectThread<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n) {\n  const messageInfo = global.messages.byChatId[chatId];\n  if (!messageInfo) {\n    return undefined;\n  }\n\n  const thread = messageInfo.threadsById[threadId];\n  if (!thread) {\n    return undefined;\n  }\n\n  return thread;\n}\n\nexport function selectListedIds<T extends GlobalState>(global: T, chatId: string, threadId: ThreadId) {\n  return selectThreadParam(global, chatId, threadId, 'listedIds');\n}\n\nexport function selectOutlyingListByMessageId<T extends GlobalState>(\n  global: T, chatId: string, threadId: ThreadId, messageId: number,\n) {\n  const outlyingLists = selectOutlyingLists(global, chatId, threadId);\n  if (!outlyingLists) {\n    return undefined;\n  }\n\n  return outlyingLists.find((list) => {\n    return list[0] <= messageId && list[list.length - 1] >= messageId;\n  });\n}\n\nexport function selectOutlyingLists<T extends GlobalState>(\n  global: T, chatId: string, threadId: ThreadId,\n) {\n  return selectThreadParam(global, chatId, threadId, 'outlyingLists');\n}\n\nexport function selectCurrentMessageIds<T extends GlobalState>(\n  global: T,\n  chatId: string, threadId: ThreadId, messageListType: MessageListType,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  switch (messageListType) {\n    case 'thread':\n      return selectViewportIds(global, chatId, threadId, tabId);\n    case 'pinned':\n      return selectPinnedIds(global, chatId, threadId);\n    case 'scheduled':\n      return selectScheduledIds(global, chatId, threadId);\n  }\n\n  return undefined;\n}\n\nexport function selectViewportIds<T extends GlobalState>(\n  global: T, chatId: string, threadId: ThreadId, ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabThreadParam(global, chatId, threadId, 'viewportIds', tabId);\n}\n\nexport function selectPinnedIds<T extends GlobalState>(global: T, chatId: string, threadId: ThreadId) {\n  return selectThreadParam(global, chatId, threadId, 'pinnedIds');\n}\n\nexport function selectScheduledIds<T extends GlobalState>(global: T, chatId: string, threadId: ThreadId) {\n  return selectThreadParam(global, chatId, threadId, 'scheduledIds');\n}\n\nexport function selectScrollOffset<T extends GlobalState>(\n  global: T, chatId: string, threadId: ThreadId,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabThreadParam(global, chatId, threadId, 'scrollOffset', tabId);\n}\n\nexport function selectLastScrollOffset<T extends GlobalState>(global: T, chatId: string, threadId: ThreadId) {\n  return selectThreadParam(global, chatId, threadId, 'lastScrollOffset');\n}\n\nexport function selectEditingId<T extends GlobalState>(global: T, chatId: string, threadId: ThreadId) {\n  return selectThreadParam(global, chatId, threadId, 'editingId');\n}\n\nexport function selectEditingDraft<T extends GlobalState>(global: T, chatId: string, threadId: ThreadId) {\n  return selectThreadParam(global, chatId, threadId, 'editingDraft');\n}\n\nexport function selectEditingScheduledId<T extends GlobalState>(global: T, chatId: string) {\n  return selectThreadParam(global, chatId, MAIN_THREAD_ID, 'editingScheduledId');\n}\n\nexport function selectEditingScheduledDraft<T extends GlobalState>(global: T, chatId: string) {\n  return selectThreadParam(global, chatId, MAIN_THREAD_ID, 'editingScheduledDraft');\n}\n\nexport function selectDraft<T extends GlobalState>(global: T, chatId: string, threadId: ThreadId) {\n  return selectThreadParam(global, chatId, threadId, 'draft');\n}\n\nexport function selectNoWebPage<T extends GlobalState>(global: T, chatId: string, threadId: ThreadId) {\n  return selectThreadParam(global, chatId, threadId, 'noWebPage');\n}\n\nexport function selectThreadInfo<T extends GlobalState>(global: T, chatId: string, threadId: ThreadId) {\n  return selectThreadParam(global, chatId, threadId, 'threadInfo');\n}\n\nexport function selectFirstMessageId<T extends GlobalState>(global: T, chatId: string, threadId: ThreadId) {\n  return selectThreadParam(global, chatId, threadId, 'firstMessageId');\n}\n\nexport function selectReplyStack<T extends GlobalState>(\n  global: T, chatId: string, threadId: ThreadId,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabThreadParam(global, chatId, threadId, 'replyStack', tabId);\n}\n\nexport function selectThreadMessagesCount(global: GlobalState, chatId: string, threadId: ThreadId) {\n  const chat = selectChat(global, chatId);\n  const threadInfo = selectThreadInfo(global, chatId, threadId);\n  if (!chat || !threadInfo || threadInfo.messagesCount === undefined) return undefined;\n  // In forum topics first message is ignored, but not in General\n  if (chat.isForum && threadId !== GENERAL_TOPIC_ID) return threadInfo.messagesCount - 1;\n  return threadInfo.messagesCount;\n}\n\nexport function selectThreadByMessage<T extends GlobalState>(global: T, message: ApiMessage) {\n  const threadId = selectThreadIdFromMessage(global, message);\n  if (!threadId || threadId === MAIN_THREAD_ID) {\n    return undefined;\n  }\n\n  return global.messages.byChatId[message.chatId].threadsById[threadId];\n}\n\nexport function selectIsMessageInCurrentMessageList<T extends GlobalState>(\n  global: T, chatId: string, message: ApiMessage,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const currentMessageList = selectCurrentMessageList(global, tabId);\n  if (!currentMessageList) {\n    return false;\n  }\n\n  const { threadInfo } = selectThreadByMessage(global, message) || {};\n  return (\n    chatId === currentMessageList.chatId\n    && (\n      (currentMessageList.threadId === MAIN_THREAD_ID)\n      || (threadInfo && currentMessageList.threadId === threadInfo.threadId)\n    )\n  );\n}\n\nexport function selectIsViewportNewest<T extends GlobalState>(\n  global: T, chatId: string, threadId: ThreadId,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const viewportIds = selectViewportIds(global, chatId, threadId, tabId);\n  if (!viewportIds || !viewportIds.length) {\n    return true;\n  }\n\n  const isSavedDialog = getIsSavedDialog(chatId, threadId, global.currentUserId);\n\n  let lastMessageId: number;\n\n  if (threadId === MAIN_THREAD_ID) {\n    const id = selectChatLastMessageId(global, chatId);\n    if (!id) {\n      return true;\n    }\n    lastMessageId = id;\n  } else if (isSavedDialog) {\n    const id = selectChatLastMessageId(global, String(threadId), 'saved');\n    if (!id) {\n      return true;\n    }\n    lastMessageId = id;\n  } else {\n    const threadInfo = selectThreadInfo(global, chatId, threadId);\n    if (!threadInfo || !threadInfo.lastMessageId) {\n      if (!threadInfo?.threadId) return undefined;\n      // No messages in thread, except for the thread message itself\n      lastMessageId = Number(threadInfo?.threadId);\n    } else {\n      lastMessageId = threadInfo.lastMessageId;\n    }\n  }\n\n  // Edge case: outgoing `lastMessage` is updated with a delay to optimize animation\n  if (isLocalMessageId(lastMessageId) && !selectChatMessage(global, chatId, lastMessageId)) {\n    return true;\n  }\n\n  return viewportIds[viewportIds.length - 1] >= lastMessageId;\n}\n\nexport function selectChatMessage<T extends GlobalState>(global: T, chatId: string, messageId: number) {\n  const chatMessages = selectChatMessages(global, chatId);\n\n  return chatMessages ? chatMessages[messageId] : undefined;\n}\n\nexport function selectScheduledMessage<T extends GlobalState>(global: T, chatId: string, messageId: number) {\n  const chatMessages = selectChatScheduledMessages(global, chatId);\n\n  return chatMessages ? chatMessages[messageId] : undefined;\n}\n\nexport function selectQuickReplyMessage<T extends GlobalState>(global: T, messageId: number) {\n  return global.quickReplies.messagesById[messageId];\n}\n\nexport function selectEditingMessage<T extends GlobalState>(\n  global: T, chatId: string, threadId: ThreadId, messageListType: MessageListType,\n) {\n  if (messageListType === 'scheduled') {\n    const messageId = selectEditingScheduledId(global, chatId);\n    return messageId ? selectScheduledMessage(global, chatId, messageId) : undefined;\n  } else {\n    const messageId = selectEditingId(global, chatId, threadId);\n    return messageId ? selectChatMessage(global, chatId, messageId) : undefined;\n  }\n}\n\nexport function selectFocusedMessageId<T extends GlobalState>(\n  global: T, chatId: string, ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { chatId: focusedChatId, messageId } = selectTabState(global, tabId).focusedMessage || {};\n\n  return focusedChatId === chatId ? messageId : undefined;\n}\n\nexport function selectIsMessageFocused<T extends GlobalState>(\n  global: T, message: ApiMessage, currentThreadId: ThreadId,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const focusedId = selectFocusedMessageId(global, message.chatId, tabId);\n  const threadId = selectTabState(global, tabId).focusedMessage?.threadId;\n\n  if (currentThreadId !== threadId) return false;\n\n  return focusedId ? focusedId === message.id || focusedId === message.previousLocalId : false;\n}\n\nexport function selectIsMessageUnread<T extends GlobalState>(global: T, message: ApiMessage) {\n  const { lastReadOutboxMessageId } = selectChat(global, message.chatId) || {};\n  return isMessageLocal(message) || !lastReadOutboxMessageId || lastReadOutboxMessageId < message.id;\n}\n\nexport function selectOutgoingStatus<T extends GlobalState>(\n  global: T, message: ApiMessage, isScheduledList = false,\n): ApiMessageOutgoingStatus {\n  if (!selectIsMessageUnread(global, message) && !isScheduledList) {\n    return 'read';\n  }\n\n  return getSendingState(message);\n}\n\nexport function selectSender<T extends GlobalState>(global: T, message: ApiMessage): ApiPeer | undefined {\n  const { senderId } = message;\n  const chat = selectChat(global, message.chatId);\n  const currentUser = selectUser(global, global.currentUserId!);\n  if (!senderId) {\n    return message.isOutgoing ? currentUser : chat;\n  }\n\n  if (chat && isChatChannel(chat) && !chat.areProfilesShown) return chat;\n\n  return selectPeer(global, senderId);\n}\n\nexport function getSendersFromSelectedMessages<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  messageIds: number[],\n) {\n  return messageIds.map((id) => {\n    const message = selectChatMessage(global, chatId, id);\n    return message && selectSender(global, message);\n  }).filter(Boolean);\n}\n\nexport function selectSenderFromMessage<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  messageId: number,\n): ApiPeer | undefined {\n  const message = selectChatMessage(global, chatId, messageId);\n\n  return message && selectSender(global, message);\n}\n\nexport function selectSenderFromHeader<T extends GlobalState>(\n  global: T,\n  header: ApiMessageForwardInfo,\n) {\n  const { fromId } = header;\n  if (fromId) {\n    return selectPeer(global, fromId);\n  }\n\n  return undefined;\n}\n\nexport function selectForwardedSender<T extends GlobalState>(\n  global: T, message: ApiMessage,\n): ApiPeer | undefined {\n  const isStoryForward = Boolean(message.content.storyData);\n  if (isStoryForward) {\n    const peerId = message.content.storyData!.peerId;\n    return selectPeer(global, peerId);\n  }\n\n  const { forwardInfo } = message;\n  if (!forwardInfo) {\n    return undefined;\n  }\n\n  if (forwardInfo.isChannelPost && forwardInfo.fromChatId) {\n    return selectChat(global, forwardInfo.fromChatId);\n  }\n\n  if (forwardInfo.hiddenUserName) {\n    return undefined;\n  }\n\n  if (forwardInfo.fromId) {\n    return selectPeer(global, forwardInfo.fromId);\n  }\n\n  if (forwardInfo.savedFromPeerId) {\n    return selectPeer(global, forwardInfo.savedFromPeerId);\n  }\n\n  return undefined;\n}\n\nexport function selectPoll<T extends GlobalState>(global: T, pollId: string) {\n  return global.messages.pollById[pollId];\n}\n\nexport function selectPollFromMessage<T extends GlobalState>(global: T, message: ApiMessage) {\n  if (!message.content.pollId) return undefined;\n  return selectPoll(global, message.content.pollId);\n}\n\nexport function selectTopicFromMessage<T extends GlobalState>(global: T, message: ApiMessage) {\n  const { chatId } = message;\n  const chat = selectChat(global, chatId);\n  if (!chat?.isForum) return undefined;\n\n  const threadId = selectThreadIdFromMessage(global, message);\n  return selectTopic(global, chatId, threadId);\n}\n\nconst MAX_MESSAGES_TO_DELETE_OWNER_TOPIC = 10;\nexport function selectCanDeleteOwnerTopic<T extends GlobalState>(global: T, chatId: string, topicId: number) {\n  const topic = selectTopic(global, chatId, topicId);\n  if (topic && !topic.isOwner) return false;\n\n  const thread = selectThread(global, chatId, topicId);\n  if (!thread) return false;\n\n  const { listedIds } = thread;\n  if (!listedIds\n    // Plus one for root message\n    || listedIds.length + 1 >= MAX_MESSAGES_TO_DELETE_OWNER_TOPIC) {\n    return false;\n  }\n\n  const hasNotOutgoingMessages = listedIds.some((messageId) => {\n    const message = selectChatMessage(global, chatId, messageId);\n    return !message || !message.isOutgoing;\n  });\n\n  return !hasNotOutgoingMessages;\n}\n\nexport function selectCanDeleteTopic<T extends GlobalState>(global: T, chatId: string, topicId: number) {\n  const chat = selectChat(global, chatId);\n  if (!chat) return false;\n\n  if (topicId === GENERAL_TOPIC_ID) return false;\n\n  return chat.isCreator\n    || getHasAdminRight(chat, 'deleteMessages')\n    || (chat.isForum\n      && selectCanDeleteOwnerTopic(global, chat.id, topicId));\n}\n\nexport function selectSavedDialogIdFromMessage<T extends GlobalState>(\n  global: T, message: ApiMessage,\n): string | undefined {\n  const {\n    chatId, senderId, forwardInfo, savedPeerId,\n  } = message;\n\n  if (savedPeerId) return savedPeerId;\n\n  if (chatId !== global.currentUserId) {\n    return undefined;\n  }\n\n  if (forwardInfo?.savedFromPeerId) {\n    return forwardInfo.savedFromPeerId;\n  }\n\n  if (forwardInfo?.fromId) {\n    return forwardInfo.fromId;\n  }\n\n  if (forwardInfo?.hiddenUserName) {\n    return ANONYMOUS_USER_ID;\n  }\n\n  return senderId;\n}\n\nexport function selectThreadIdFromMessage<T extends GlobalState>(global: T, message: ApiMessage): ThreadId {\n  const savedDialogId = selectSavedDialogIdFromMessage(global, message);\n  if (savedDialogId) {\n    return savedDialogId;\n  }\n\n  const chat = selectChat(global, message.chatId);\n  const { content } = message;\n  const { replyToMsgId, replyToTopId, isForumTopic } = getMessageReplyInfo(message) || {};\n  if ('action' in content && content.action?.type === 'topicCreate') {\n    return message.id;\n  }\n\n  if (!chat?.isForum) {\n    if (chat && isChatBasicGroup(chat)) return MAIN_THREAD_ID;\n\n    if (chat && isChatSuperGroup(chat)) {\n      return replyToTopId || replyToMsgId || MAIN_THREAD_ID;\n    }\n    return MAIN_THREAD_ID;\n  }\n  if (!isForumTopic) return GENERAL_TOPIC_ID;\n  return replyToTopId || replyToMsgId || GENERAL_TOPIC_ID;\n}\n\nexport function selectCanReplyToMessage<T extends GlobalState>(global: T, message: ApiMessage, threadId: ThreadId) {\n  const chat = selectChat(global, message.chatId);\n  if (!chat || chat.isRestricted || chat.isForbidden) return false;\n\n  const isLocal = isMessageLocal(message);\n  const isServiceNotification = isServiceNotificationMessage(message);\n\n  if (isLocal || isServiceNotification) return false;\n\n  const threadInfo = selectThreadInfo(global, message.chatId, threadId);\n  const isMessageThread = Boolean(!threadInfo?.isCommentsInfo && threadInfo?.fromChannelId);\n  const chatFullInfo = selectChatFullInfo(global, chat.id);\n  const topic = selectTopic(global, chat.id, threadId);\n  const canPostInChat = getCanPostInChat(chat, topic, isMessageThread, chatFullInfo);\n  if (!canPostInChat) return false;\n\n  const messageTopic = selectTopicFromMessage(global, message);\n  return !messageTopic || !messageTopic.isClosed || messageTopic.isOwner || getHasAdminRight(chat, 'manageTopics');\n}\n\nexport function selectCanForwardMessage<T extends GlobalState>(global: T, message: ApiMessage) {\n  const isLocal = isMessageLocal(message);\n  const isServiceNotification = isServiceNotificationMessage(message);\n  const isAction = isActionMessage(message);\n  const hasTtl = hasMessageTtl(message);\n  const { content } = message;\n  const story = content.storyData\n    ? selectPeerStory(global, content.storyData.peerId, content.storyData.id)\n    : (content.webPage?.story\n      ? selectPeerStory(global, content.webPage.story.peerId, content.webPage.story.id)\n      : undefined\n    );\n  const isChatProtected = selectIsChatProtected(global, message.chatId);\n  const isStoryForwardForbidden = story && ('isDeleted' in story || ('noForwards' in story && story.noForwards));\n  const canForward = (\n    !isLocal && !isAction && !isChatProtected && !isStoryForwardForbidden\n    && (message.isForwardingAllowed || isServiceNotification) && !hasTtl\n  );\n\n  return canForward;\n}\n\n// This selector is slow and not to be used within lists (e.g. Message component)\nexport function selectAllowedMessageActionsSlow<T extends GlobalState>(\n  global: T, message: ApiMessage, threadId: ThreadId,\n) {\n  const chat = selectChat(global, message.chatId);\n  if (!chat || chat.isRestricted) {\n    return {};\n  }\n\n  const isPrivate = isUserId(chat.id);\n  const isChatWithSelf = selectIsChatWithSelf(global, message.chatId);\n  const isBasicGroup = isChatBasicGroup(chat);\n  const isSuperGroup = isChatSuperGroup(chat);\n  const isChannel = isChatChannel(chat);\n  const isBotChat = Boolean(selectBot(global, chat.id));\n  const isLocal = isMessageLocal(message);\n  const isFailed = isMessageFailed(message);\n  const isServiceNotification = isServiceNotificationMessage(message);\n  const isOwn = isOwnMessage(message);\n  const isForwarded = isForwardedMessage(message);\n  const isAction = isActionMessage(message);\n  const hasTtl = hasMessageTtl(message);\n  const { content } = message;\n  const isDocumentSticker = isMessageDocumentSticker(message);\n  const isBoostMessage = message.content.action?.type === 'boostApply';\n\n  const hasChatPinPermission = (chat.isCreator\n    || (!isChannel && !isUserRightBanned(chat, 'pinMessages'))\n    || getHasAdminRight(chat, 'pinMessages'));\n\n  const hasPinPermission = isPrivate || hasChatPinPermission;\n\n  // https://github.com/telegramdesktop/tdesktop/blob/335095a332607c41a8d20b47e61f5bbd66366d4b/Telegram/SourceFiles/data/data_peer.cpp#L653\n  const canEditMessagesIndefinitely = (() => {\n    if (isPrivate) return isChatWithSelf;\n    if (isBasicGroup) return false;\n    if (isSuperGroup) return hasChatPinPermission;\n    if (isChannel) return chat.isCreator || getHasAdminRight(chat, 'editMessages');\n    return false;\n  })();\n\n  const isMessageEditable = (\n    (\n      canEditMessagesIndefinitely\n      || getServerTime() - message.date < (global.config?.editTimeLimit || Infinity)\n    ) && !(\n      content.sticker || content.contact || content.pollId || content.action\n      || (content.video?.isRound) || content.location || content.invoice || content.giveaway || content.giveawayResults\n      || isDocumentSticker\n    )\n    && !isForwarded\n    && !message.viaBotId\n    && !chat.isForbidden\n  );\n\n  const isSavedDialog = getIsSavedDialog(chat.id, threadId, global.currentUserId);\n\n  const canReply = selectCanReplyToMessage(global, message, threadId);\n  const canReplyGlobally = canReply || (!isSavedDialog && !isLocal && !isServiceNotification\n    && (isSuperGroup || isBasicGroup || isChatChannel(chat)));\n\n  let canPin = !isLocal && !isServiceNotification && !isAction && hasPinPermission && !isSavedDialog;\n  let canUnpin = false;\n\n  const pinnedMessageIds = selectPinnedIds(global, chat.id, threadId);\n\n  if (canPin) {\n    canUnpin = Boolean(pinnedMessageIds && pinnedMessageIds.includes(message.id));\n    canPin = !canUnpin;\n  }\n\n  const canNotDeleteBoostMessage = isBoostMessage && isOwn\n    && !chat.isCreator && !getHasAdminRight(chat, 'deleteMessages');\n\n  const canDelete = (!isLocal || isFailed) && !isServiceNotification && !canNotDeleteBoostMessage && (\n    isPrivate\n    || isOwn\n    || isBasicGroup\n    || chat.isCreator\n    || getHasAdminRight(chat, 'deleteMessages')\n  );\n\n  const canReport = !isPrivate && !isOwn;\n\n  const canDeleteForAll = canDelete && !chat.isForbidden && (\n    (isPrivate && !isChatWithSelf && !isBotChat)\n    || (isBasicGroup && (\n      isOwn || getHasAdminRight(chat, 'deleteMessages') || chat.isCreator\n    ))\n  );\n\n  const hasMessageEditRight = isOwn || (isChannel && (chat.isCreator || getHasAdminRight(chat, 'editMessages')));\n\n  const canEdit = !isLocal && !isAction && isMessageEditable && hasMessageEditRight;\n\n  const hasSticker = Boolean(message.content.sticker);\n  const hasFavoriteSticker = hasSticker && selectIsStickerFavorite(global, message.content.sticker!);\n  const canFaveSticker = !isAction && hasSticker && !hasFavoriteSticker;\n  const canUnfaveSticker = !isAction && hasFavoriteSticker;\n  const canCopy = !isAction;\n  const canCopyLink = !isLocal && !isAction && (isChannel || isSuperGroup);\n  const canSelect = !isLocal && !isAction;\n\n  const canDownload = Boolean(content.webPage?.document || content.webPage?.video || content.webPage?.photo\n      || content.audio || content.voice || content.photo || content.video || content.document || content.sticker)\n    && !hasTtl;\n\n  const canSaveGif = message.content.video?.isGif;\n\n  const poll = content.pollId ? selectPoll(global, content.pollId) : undefined;\n  const canRevote = !poll?.summary.closed && !poll?.summary.quiz && poll?.results.results?.some((r) => r.isChosen);\n  const canClosePoll = hasMessageEditRight && poll && !poll.summary.closed && !isForwarded;\n\n  const noOptions = [\n    canReply,\n    canReplyGlobally,\n    canEdit,\n    canPin,\n    canUnpin,\n    canReport,\n    canDelete,\n    canDeleteForAll,\n    canFaveSticker,\n    canUnfaveSticker,\n    canCopy,\n    canCopyLink,\n    canSelect,\n    canDownload,\n    canSaveGif,\n    canRevote,\n    canClosePoll,\n  ].every((ability) => !ability);\n\n  return {\n    noOptions,\n    canReply,\n    canReplyGlobally,\n    canEdit,\n    canPin,\n    canUnpin,\n    canReport,\n    canDelete,\n    canDeleteForAll,\n    canFaveSticker,\n    canUnfaveSticker,\n    canCopy,\n    canCopyLink,\n    canSelect,\n    canDownload,\n    canSaveGif,\n    canRevote,\n    canClosePoll,\n  };\n}\n\nexport function selectCanDeleteMessages<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  messageIds: number[],\n) {\n  const chatMessages = selectChatMessages(global, chatId);\n\n  if (messageIds.length > API_GENERAL_ID_LIMIT) {\n    return {};\n  }\n\n  const messageActions = messageIds\n    .map((id) => chatMessages[id] && selectAllowedMessageActionsSlow(global, chatMessages[id], threadId))\n    .filter(Boolean);\n\n  return {\n    canDelete: messageActions.every((actions) => actions.canDelete),\n    canDeleteForAll: messageActions.every((actions) => actions.canDeleteForAll),\n  };\n}\n\nexport function selectCanDeleteSelectedMessages<T extends GlobalState>(\n  global: T,\n  messageIds?: number[],\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { messageIds: selectedMessageIds } = selectTabState(global, tabId).selectedMessages || {};\n  const { chatId, threadId } = selectCurrentMessageList(global, tabId) || {};\n  const messageIdList = messageIds?.length ? messageIds : selectedMessageIds;\n  if (!chatId || !threadId || !messageIdList) {\n    return {};\n  }\n\n  return selectCanDeleteMessages(global, chatId, threadId, messageIdList);\n}\n\nexport function selectCanReportSelectedMessages<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { messageIds: selectedMessageIds } = selectTabState(global, tabId).selectedMessages || {};\n  const { chatId, threadId } = selectCurrentMessageList(global, tabId) || {};\n  const chatMessages = chatId && selectChatMessages(global, chatId);\n  if (!chatMessages || !selectedMessageIds || !threadId) {\n    return false;\n  }\n\n  const messageActions = selectedMessageIds\n    .map((id) => chatMessages[id] && selectAllowedMessageActionsSlow(global, chatMessages[id], threadId))\n    .filter(Boolean);\n\n  return messageActions.every((actions) => actions.canReport);\n}\n\nexport function selectCanDownloadSelectedMessages<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { messageIds: selectedMessageIds } = selectTabState(global, tabId).selectedMessages || {};\n  const { chatId, threadId } = selectCurrentMessageList(global, tabId) || {};\n  const chatMessages = chatId && selectChatMessages(global, chatId);\n  if (!chatMessages || !selectedMessageIds || !threadId) {\n    return false;\n  }\n\n  const messageActions = selectedMessageIds\n    .map((id) => chatMessages[id] && selectAllowedMessageActionsSlow(global, chatMessages[id], threadId))\n    .filter(Boolean);\n\n  return messageActions.some((actions) => actions.canDownload);\n}\n\nexport function selectActiveDownloads<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).activeDownloads;\n}\n\nexport function selectUploadProgress<T extends GlobalState>(global: T, message: ApiMessage) {\n  return global.fileUploads.byMessageKey[getMessageKey(message)]?.progress;\n}\n\nexport function selectRealLastReadId<T extends GlobalState>(global: T, chatId: string, threadId: ThreadId) {\n  if (threadId === MAIN_THREAD_ID) {\n    const chat = selectChat(global, chatId);\n    if (!chat) {\n      return undefined;\n    }\n\n    // `lastReadInboxMessageId` is empty for new chats\n    if (!chat.lastReadInboxMessageId) {\n      return undefined;\n    }\n\n    const lastMessageId = selectChatLastMessageId(global, chatId);\n\n    if (!lastMessageId || chat.unreadCount) {\n      return chat.lastReadInboxMessageId;\n    }\n\n    return lastMessageId;\n  } else {\n    const threadInfo = selectThreadInfo(global, chatId, threadId);\n    if (!threadInfo) {\n      return undefined;\n    }\n\n    if (!threadInfo.lastReadInboxMessageId) {\n      return Number(threadInfo.threadId);\n    }\n\n    // Some previously read messages may be deleted\n    return Math.min(threadInfo.lastReadInboxMessageId, threadInfo.lastMessageId || Infinity);\n  }\n}\n\nexport function selectFirstUnreadId<T extends GlobalState>(\n  global: T, chatId: string, threadId: ThreadId,\n) {\n  const chat = selectChat(global, chatId);\n\n  if (threadId === MAIN_THREAD_ID) {\n    if (!chat) {\n      return undefined;\n    }\n  } else {\n    const threadInfo = selectThreadInfo(global, chatId, threadId);\n    if (!threadInfo\n      || (threadInfo.lastMessageId !== undefined && threadInfo.lastMessageId === threadInfo.lastReadInboxMessageId)) {\n      return undefined;\n    }\n  }\n\n  const outlyingLists = selectOutlyingLists(global, chatId, threadId);\n  const listedIds = selectListedIds(global, chatId, threadId);\n  const byId = selectChatMessages(global, chatId);\n  if (!byId || !(outlyingLists?.length || listedIds)) {\n    return undefined;\n  }\n\n  const lastReadId = selectRealLastReadId(global, chatId, threadId);\n  if (!lastReadId && chat && chat.isNotJoined) {\n    return undefined;\n  }\n\n  const lastReadServiceNotificationId = chatId === SERVICE_NOTIFICATIONS_USER_ID\n    ? global.serviceNotifications.reduce((max, notification) => {\n      return !notification.isUnread && notification.id > max ? notification.id : max;\n    }, -1)\n    : -1;\n\n  function findAfterLastReadId(listIds: number[]) {\n    return listIds.find((id) => {\n      return (\n        (!lastReadId || id > lastReadId)\n        && byId[id]\n        && (!byId[id].isOutgoing || byId[id].isFromScheduled)\n        && id > lastReadServiceNotificationId\n      );\n    });\n  }\n\n  if (outlyingLists?.length) {\n    const found = outlyingLists.map((list) => findAfterLastReadId(list)).filter(Boolean)[0];\n    if (found) {\n      return found;\n    }\n  }\n\n  if (listedIds) {\n    const found = findAfterLastReadId(listedIds);\n    if (found) {\n      return found;\n    }\n  }\n\n  return undefined;\n}\n\nexport function selectIsForwardModalOpen<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { isShareMessageModalShown } = selectTabState(global, tabId);\n  return Boolean(isShareMessageModalShown);\n}\n\nexport function selectCommonBoxChatId<T extends GlobalState>(global: T, messageId: number) {\n  const fromLastMessage = Object.values(global.chats.byId).find((chat) => (\n    isCommonBoxChat(chat) && selectChatLastMessageId(global, chat.id) === messageId\n  ));\n  if (fromLastMessage) {\n    return fromLastMessage.id;\n  }\n\n  const { byChatId } = global.messages;\n  return Object.keys(byChatId).find((chatId) => {\n    const chat = selectChat(global, chatId);\n    return chat && isCommonBoxChat(chat) && byChatId[chat.id].byId[messageId];\n  });\n}\n\nexport function selectIsInSelectMode<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { selectedMessages } = selectTabState(global, tabId);\n\n  return Boolean(selectedMessages);\n}\n\nexport function selectIsMessageSelected<T extends GlobalState>(\n  global: T, messageId: number,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { messageIds } = selectTabState(global, tabId).selectedMessages || {};\n  if (!messageIds) {\n    return false;\n  }\n\n  return messageIds.includes(messageId);\n}\n\nexport function selectForwardedMessageIdsByGroupId<T extends GlobalState>(\n  global: T, chatId: string, groupedId: string,\n) {\n  const chatMessages = selectChatMessages(global, chatId);\n  if (!chatMessages) {\n    return undefined;\n  }\n\n  return Object.values(chatMessages)\n    .filter((message) => message.groupedId === groupedId && message.forwardInfo)\n    .map(({ forwardInfo }) => forwardInfo!.fromMessageId);\n}\n\nexport function selectMessageIdsByGroupId<T extends GlobalState>(global: T, chatId: string, groupedId: string) {\n  const chatMessages = selectChatMessages(global, chatId);\n  if (!chatMessages) {\n    return undefined;\n  }\n\n  return Object.keys(chatMessages)\n    .map(Number)\n    .filter((id) => chatMessages[id].groupedId === groupedId);\n}\n\nexport function selectIsDocumentGroupSelected<T extends GlobalState>(\n  global: T, chatId: string, groupedId: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { messageIds: selectedIds } = selectTabState(global, tabId).selectedMessages || {};\n  if (!selectedIds) {\n    return false;\n  }\n\n  const groupIds = selectMessageIdsByGroupId(global, chatId, groupedId);\n  return groupIds && groupIds.every((id) => selectedIds.includes(id));\n}\n\nexport function selectSelectedMessagesCount<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { messageIds } = selectTabState(global, tabId).selectedMessages || {};\n\n  return messageIds ? messageIds.length : 0;\n}\n\nexport function selectNewestMessageWithBotKeyboardButtons<T extends GlobalState>(\n  global: T, chatId: string, threadId: ThreadId = MAIN_THREAD_ID,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): ApiMessage | undefined {\n  const chat = selectChat(global, chatId);\n  if (!chat) {\n    return undefined;\n  }\n\n  const chatMessages = selectChatMessages(global, chatId);\n  const viewportIds = selectViewportIds(global, chatId, threadId, tabId);\n  if (!chatMessages || !viewportIds) {\n    return undefined;\n  }\n\n  const messageId = findLast(viewportIds, (id) => {\n    const message = chatMessages[id];\n    return message && selectShouldDisplayReplyKeyboard(global, message);\n  });\n\n  const replyHideMessageId = findLast(viewportIds, (id) => {\n    const message = chatMessages[id];\n    return message && selectShouldHideReplyKeyboard(global, message);\n  });\n\n  if (messageId && replyHideMessageId && replyHideMessageId > messageId) {\n    return undefined;\n  }\n\n  return messageId ? chatMessages[messageId] : undefined;\n}\n\nfunction selectShouldHideReplyKeyboard<T extends GlobalState>(global: T, message: ApiMessage) {\n  const {\n    shouldHideKeyboardButtons,\n    isHideKeyboardSelective,\n    isMentioned,\n  } = message;\n  if (!shouldHideKeyboardButtons) return false;\n\n  const replyToMessageId = getMessageReplyInfo(message)?.replyToMsgId;\n\n  if (isHideKeyboardSelective) {\n    if (isMentioned) return true;\n    if (!replyToMessageId) return false;\n\n    const replyMessage = selectChatMessage(global, message.chatId, replyToMessageId);\n    return Boolean(replyMessage?.senderId === global.currentUserId);\n  }\n  return true;\n}\n\nfunction selectShouldDisplayReplyKeyboard<T extends GlobalState>(global: T, message: ApiMessage) {\n  const {\n    keyboardButtons,\n    shouldHideKeyboardButtons,\n    isKeyboardSelective,\n    isMentioned,\n  } = message;\n  if (!keyboardButtons || shouldHideKeyboardButtons) return false;\n\n  const replyToMessageId = getMessageReplyInfo(message)?.replyToMsgId;\n\n  if (isKeyboardSelective) {\n    if (isMentioned) return true;\n    if (!replyToMessageId) return false;\n\n    const replyMessage = selectChatMessage(global, message.chatId, replyToMessageId);\n    return Boolean(replyMessage?.senderId === global.currentUserId);\n  }\n\n  return true;\n}\n\nexport function selectCanAutoLoadMedia<T extends GlobalState>(\n  global: T, message: ApiMessage | ApiSponsoredMessage,\n) {\n  const chat = selectChat(global, message.chatId);\n  if (!chat) {\n    return undefined;\n  }\n\n  const sender = 'id' in message ? selectSender(global, message) : undefined;\n\n  const isPhoto = Boolean(getMessagePhoto(message) || getMessageWebPagePhoto(message));\n  const isVideo = Boolean(getMessageVideo(message) || getMessageWebPageVideo(message));\n  const isFile = Boolean(getMessageAudio(message) || getMessageVoice(message) || getMessageDocument(message));\n\n  const {\n    canAutoLoadPhotoFromContacts,\n    canAutoLoadPhotoInPrivateChats,\n    canAutoLoadPhotoInGroups,\n    canAutoLoadPhotoInChannels,\n    canAutoLoadVideoFromContacts,\n    canAutoLoadVideoInPrivateChats,\n    canAutoLoadVideoInGroups,\n    canAutoLoadVideoInChannels,\n    canAutoLoadFileFromContacts,\n    canAutoLoadFileInPrivateChats,\n    canAutoLoadFileInGroups,\n    canAutoLoadFileInChannels,\n  } = global.settings.byKey;\n\n  if (isPhoto) {\n    return canAutoLoadMedia({\n      global,\n      chat,\n      sender,\n      canAutoLoadMediaFromContacts: canAutoLoadPhotoFromContacts,\n      canAutoLoadMediaInPrivateChats: canAutoLoadPhotoInPrivateChats,\n      canAutoLoadMediaInGroups: canAutoLoadPhotoInGroups,\n      canAutoLoadMediaInChannels: canAutoLoadPhotoInChannels,\n    });\n  }\n\n  if (isVideo) {\n    return canAutoLoadMedia({\n      global,\n      chat,\n      sender,\n      canAutoLoadMediaFromContacts: canAutoLoadVideoFromContacts,\n      canAutoLoadMediaInPrivateChats: canAutoLoadVideoInPrivateChats,\n      canAutoLoadMediaInGroups: canAutoLoadVideoInGroups,\n      canAutoLoadMediaInChannels: canAutoLoadVideoInChannels,\n    });\n  }\n\n  if (isFile) {\n    return canAutoLoadMedia({\n      global,\n      chat,\n      sender,\n      canAutoLoadMediaFromContacts: canAutoLoadFileFromContacts,\n      canAutoLoadMediaInPrivateChats: canAutoLoadFileInPrivateChats,\n      canAutoLoadMediaInGroups: canAutoLoadFileInGroups,\n      canAutoLoadMediaInChannels: canAutoLoadFileInChannels,\n    });\n  }\n\n  return true;\n}\n\nfunction canAutoLoadMedia<T extends GlobalState>({\n  global,\n  chat,\n  sender,\n  canAutoLoadMediaFromContacts,\n  canAutoLoadMediaInPrivateChats,\n  canAutoLoadMediaInGroups,\n  canAutoLoadMediaInChannels,\n}: {\n  global: T;\n  chat: ApiChat;\n  canAutoLoadMediaFromContacts: boolean;\n  canAutoLoadMediaInPrivateChats: boolean;\n  canAutoLoadMediaInGroups: boolean;\n  canAutoLoadMediaInChannels: boolean;\n  sender?: ApiPeer;\n}) {\n  const isMediaFromContact = Boolean(sender && (\n    selectIsChatWithSelf(global, sender.id) || selectUser(global, sender.id)?.isContact\n  ));\n\n  return Boolean(\n    (isMediaFromContact && canAutoLoadMediaFromContacts)\n    || (!isMediaFromContact && canAutoLoadMediaInPrivateChats && isUserId(chat.id))\n    || (canAutoLoadMediaInGroups && isChatGroup(chat))\n    || (canAutoLoadMediaInChannels && isChatChannel(chat)),\n  );\n}\n\nexport function selectLastServiceNotification<T extends GlobalState>(global: T) {\n  const { serviceNotifications } = global;\n  const maxId = Math.max(...serviceNotifications.map(({ id }) => id));\n\n  return serviceNotifications.find(({ id, isDeleted }) => !isDeleted && id === maxId);\n}\n\nexport function selectIsMessageProtected<T extends GlobalState>(global: T, message?: ApiMessage) {\n  return Boolean(message && (\n    message.isProtected || selectIsChatProtected(global, message.chatId) || hasMessageTtl(message)\n    || getMessagePaidMedia(message)\n  ));\n}\n\nexport function selectIsChatProtected<T extends GlobalState>(global: T, chatId: string) {\n  return selectChat(global, chatId)?.isProtected || false;\n}\n\nexport function selectHasProtectedMessage<T extends GlobalState>(global: T, chatId: string, messageIds?: number[]) {\n  if (selectChat(global, chatId)?.isProtected) {\n    return true;\n  }\n\n  if (!messageIds) {\n    return false;\n  }\n\n  const messages = selectChatMessages(global, chatId);\n\n  return messageIds.some((messageId) => messages[messageId]?.isProtected);\n}\n\nexport function selectCanForwardMessages<T extends GlobalState>(global: T, chatId: string, messageIds?: number[]) {\n  if (selectChat(global, chatId)?.isProtected) {\n    return false;\n  }\n\n  if (!messageIds) {\n    return false;\n  }\n\n  const messages = selectChatMessages(global, chatId);\n\n  return messageIds\n    .map((id) => messages[id])\n    .every((message) => message && !hasMessageTtl(message)\n      && (message.isForwardingAllowed || isServiceNotificationMessage(message)));\n}\n\nexport function selectSponsoredMessage<T extends GlobalState>(global: T, chatId: string) {\n  const message = global.messages.sponsoredByChatId[chatId];\n\n  return message && message.expiresAt >= Math.round(Date.now() / 1000) ? message : undefined;\n}\n\nexport function selectDefaultReaction<T extends GlobalState>(global: T, chatId: string) {\n  if (chatId === SERVICE_NOTIFICATIONS_USER_ID) return undefined;\n\n  const isPrivate = isUserId(chatId);\n  const defaultReaction = global.config?.defaultReaction;\n  if (!defaultReaction) {\n    return undefined;\n  }\n\n  if (isPrivate) {\n    return defaultReaction;\n  }\n\n  const chatReactions = selectChatFullInfo(global, chatId)?.enabledReactions;\n  if (!chatReactions || !canSendReaction(defaultReaction, chatReactions)) {\n    return undefined;\n  }\n\n  return defaultReaction;\n}\n\nexport function selectMaxUserReactions<T extends GlobalState>(global: T): number {\n  const isPremium = selectIsCurrentUserPremium(global);\n  const { maxUserReactionsPremium = 3, maxUserReactionsDefault = 1 } = global.appConfig || {};\n  return isPremium ? maxUserReactionsPremium : maxUserReactionsDefault;\n}\n\n// Slow, not to be used in `withGlobal`\nexport function selectVisibleUsers<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { chatId, threadId } = selectCurrentMessageList(global, tabId) || {};\n  if (!chatId || !threadId) {\n    return undefined;\n  }\n\n  const messageIds = selectTabThreadParam(global, chatId, threadId, 'viewportIds', tabId);\n  if (!messageIds) {\n    return undefined;\n  }\n\n  return messageIds.map((messageId) => {\n    const { senderId } = selectChatMessage(global, chatId, messageId) || {};\n    return senderId ? selectUser(global, senderId) : undefined;\n  }).filter(Boolean);\n}\n\nexport function selectShouldSchedule<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectCurrentMessageList(global, tabId)?.type === 'scheduled';\n}\n\nexport function selectCanSchedule<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const chatId = selectCurrentMessageList(global, tabId)?.chatId;\n  const paidMessagesStars = chatId ? selectPeerPaidMessagesStars(global, chatId) : undefined;\n  return !paidMessagesStars;\n}\n\nexport function selectCanScheduleUntilOnline<T extends GlobalState>(global: T, id: string) {\n  const isChatWithSelf = selectIsChatWithSelf(global, id);\n  const chatBot = selectBot(global, id);\n  const paidMessagesStars = selectPeerPaidMessagesStars(global, id);\n  return Boolean(!paidMessagesStars\n    && !isChatWithSelf && !chatBot && isUserId(id) && selectUserStatus(global, id)?.wasOnline);\n}\n\nexport function selectCustomEmojis(message: ApiMessage) {\n  const entities = message.content.text?.entities;\n  return entities?.filter((entity): entity is ApiMessageEntityCustomEmoji => (\n    entity.type === ApiMessageEntityTypes.CustomEmoji\n  ));\n}\n\nexport function selectMessageCustomEmojiSets<T extends GlobalState>(\n  global: T, message: ApiMessage,\n): ApiStickerSetInfo[] | undefined {\n  const customEmojis = selectCustomEmojis(message);\n  if (!customEmojis) return MEMO_EMPTY_ARRAY;\n  const documents = customEmojis.map((entity) => global.customEmojis.byId[entity.documentId]);\n  // If some emoji still loading, do not return empty array\n  if (!documents.every(Boolean)) return undefined;\n  const sets = documents.map((doc) => doc.stickerSetInfo);\n\n  return sets.reduce((acc, set) => {\n    if ('shortName' in set) {\n      if (acc.some((s) => 'shortName' in s && s.shortName === set.shortName)) {\n        return acc;\n      }\n    }\n\n    if ('id' in set) {\n      if (acc.some((s) => 'id' in s && s.id === set.id)) {\n        return acc;\n      }\n    }\n    acc.push(set); // Optimization\n    return acc;\n  }, [] as ApiStickerSetInfo[]);\n}\n\nexport function selectForwardsContainVoiceMessages<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { messageIds, fromChatId } = selectTabState(global, tabId).forwardMessages;\n  if (!messageIds) return false;\n  const chatMessages = selectChatMessages(global, fromChatId!);\n  return messageIds.some((messageId) => {\n    const message = chatMessages[messageId];\n    return Boolean(message.content.voice) || Boolean(message.content.video?.isRound);\n  });\n}\n\nexport function selectChatTranslations<T extends GlobalState>(\n  global: T, chatId: string,\n): ChatTranslatedMessages {\n  return global.translations.byChatId[chatId];\n}\n\nexport function selectMessageTranslations<T extends GlobalState>(\n  global: T, chatId: string, toLanguageCode: string,\n) {\n  return selectChatTranslations(global, chatId)?.byLangCode[toLanguageCode] || {};\n}\n\nexport function selectRequestedMessageTranslationLanguage<T extends GlobalState>(\n  global: T, chatId: string, messageId: number, ...[tabId = getCurrentTabId()]: TabArgs<T>\n): string | undefined {\n  // const { autoTranslate, autoTranslateLanguage } = global.settings.byKey;\n  // return autoTranslate ? autoTranslateLanguage : undefined;\n  const requestedInChat = selectTabState(global, tabId).requestedTranslations.byChatId[chatId];\n  return requestedInChat?.toLanguage || requestedInChat?.manualMessages?.[messageId];\n}\nexport function selectReplyCanBeSentToChat<T extends GlobalState>(\n  global: T,\n  toChatId: string,\n  fromChatId: string,\n  replyInfo: ApiInputMessageReplyInfo,\n) {\n  if (!replyInfo.replyToMsgId) return false;\n  const fromRealChatId = replyInfo?.replyToPeerId ?? fromChatId;\n  if (toChatId === fromRealChatId) return true;\n  const chatMessages = selectChatMessages(global, fromRealChatId!);\n  const message = chatMessages[replyInfo.replyToMsgId];\n\n  return !isExpiredMessage(message);\n}\nexport function selectForwardsCanBeSentToChat<T extends GlobalState>(\n  global: T,\n  toChatId: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { messageIds, storyId, fromChatId } = selectTabState(global, tabId).forwardMessages;\n  const chat = selectChat(global, toChatId);\n  if ((!messageIds && !storyId) || !chat) return false;\n\n  if (storyId) {\n    return true;\n  }\n\n  const chatFullInfo = selectChatFullInfo(global, toChatId);\n  const chatMessages = selectChatMessages(global, fromChatId!);\n  const options = getAllowedAttachmentOptions(chat, chatFullInfo);\n  return !messageIds!.some((messageId) => сheckMessageSendingDenied(chatMessages[messageId], options));\n}\nfunction сheckMessageSendingDenied(message: ApiMessage, options: IAllowedAttachmentOptions) {\n  const isVoice = message.content.voice;\n  const isRoundVideo = message.content.video?.isRound;\n  const isPhoto = message.content.photo;\n  const isGif = message.content.video?.isGif;\n  const isVideo = message.content.video && !isRoundVideo && !isGif;\n  const isAudio = message.content.audio;\n  const isDocument = message.content.document;\n  const isSticker = message.content.sticker;\n  const isPlainText = message.content.text\n    && !isVoice && !isRoundVideo && !isSticker && !isDocument && !isAudio && !isVideo && !isPhoto && !isGif;\n\n  return (isVoice && !options.canSendVoices)\n    || (isRoundVideo && !options.canSendRoundVideos)\n    || (isSticker && !options.canSendStickers)\n    || (isDocument && !options.canSendDocuments)\n    || (isAudio && !options.canSendAudios)\n    || (isVideo && !options.canSendVideos)\n    || (isPhoto && !options.canSendPhotos)\n    || (isGif && !options.canSendGifs)\n    || (isPlainText && !options.canSendPlainText);\n}\n\nexport function selectCanTranslateMessage<T extends GlobalState>(\n  global: T, message: ApiMessage, detectedLanguage?: string, ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { canTranslate: isTranslationEnabled, doNotTranslate } = global.settings.byKey;\n\n  const canTranslateLanguage = !detectedLanguage || !doNotTranslate.includes(detectedLanguage);\n\n  const isTranslatable = isMessageTranslatable(message);\n\n  // Separate translations are disabled when chat translation enabled\n  const chatRequestedLanguage = selectRequestedChatTranslationLanguage(global, message.chatId, tabId);\n\n  return IS_TRANSLATION_SUPPORTED && isTranslationEnabled && canTranslateLanguage && isTranslatable\n    && !chatRequestedLanguage;\n}\n\nexport function selectTopicLink<T extends GlobalState>(\n  global: T, chatId: string, topicId?: ThreadId,\n) {\n  const chat = selectChat(global, chatId);\n  if (!chat || !chat?.isForum) {\n    return undefined;\n  }\n\n  return getMessageLink(chat, topicId);\n}\n\nexport function selectMessageReplyInfo<T extends GlobalState>(\n  global: T, chatId: string, threadId: ThreadId, additionalReplyInfo?: ApiInputMessageReplyInfo,\n) {\n  const chat = selectChat(global, chatId);\n  if (!chat) return undefined;\n  const isMainThread = threadId === MAIN_THREAD_ID;\n  if (!additionalReplyInfo && isMainThread) return undefined;\n\n  const replyInfo: ApiInputMessageReplyInfo = {\n    type: 'message',\n    ...additionalReplyInfo,\n    replyToMsgId: additionalReplyInfo?.replyToMsgId || Number(threadId),\n    replyToTopId: additionalReplyInfo?.replyToTopId || (!isMainThread ? Number(threadId) : undefined),\n  };\n\n  return replyInfo;\n}\n\nexport function selectReplyMessage<T extends GlobalState>(global: T, message: ApiMessage) {\n  const { replyToMsgId, replyToPeerId } = getMessageReplyInfo(message) || {};\n  const replyMessage = replyToMsgId\n    ? selectChatMessage(global, replyToPeerId || message.chatId, replyToMsgId) : undefined;\n\n  return replyMessage;\n}\n\nexport function selectMessageTimestampableDuration<T extends GlobalState>(\n  global: T, message: ApiMessage, noReplies?: boolean,\n) {\n  const replyMessage = !noReplies ? selectReplyMessage(global, message) : undefined;\n\n  const timestampableMedia = getTimestampableMedia(message);\n  const replyTimestampableMedia = replyMessage && getTimestampableMedia(replyMessage);\n\n  return timestampableMedia?.duration || replyTimestampableMedia?.duration;\n}\n\nexport function selectMessageLastPlaybackTimestamp<T extends GlobalState>(\n  global: T, chatId: string, messageId: number,\n) {\n  return global.messages.playbackByChatId[chatId]?.byId[messageId];\n}\n","import { getActions } from '../global';\n\nimport { PRODUCTION_HOSTNAME, WEB_VERSION_BASE } from '../config';\nimport { clearWebsync } from './websync';\n\nconst SEARCH_ENGINE_REGEX = /(^|\\.)(google|bing|duckduckgo|ya|yandex)\\./i;\n// Handled by the legacy version. Cannot be updated\nconst PERMANENT_VERSION_KEY = 'kz_version';\nconst AVAILABLE_VERSIONS = ['Z', 'K'] as const;\nconst CLIENT_VERSION = 'Z';\ntype AvailableVersions = typeof AVAILABLE_VERSIONS[number];\n\nfunction setPermanentWebVersion(version: AvailableVersions) {\n  localStorage.setItem(PERMANENT_VERSION_KEY, JSON.stringify(version));\n}\n\nexport function getPermanentWebVersion(): AvailableVersions | undefined {\n  const version = localStorage.getItem(PERMANENT_VERSION_KEY);\n  if (version) {\n    return JSON.parse(version);\n  }\n\n  return undefined;\n}\n\nexport function switchPermanentWebVersion(version: AvailableVersions) {\n  setPermanentWebVersion(version);\n  clearWebsync();\n  getActions().skipLockOnUnload();\n  window.location.assign(`${WEB_VERSION_BASE}${version.toLowerCase()}`);\n}\n\nexport function checkAndAssignPermanentWebVersion() {\n  if (window.location.hostname !== PRODUCTION_HOSTNAME) return;\n\n  const referrer = document.referrer.toLowerCase();\n  if (!referrer) return;\n  try {\n    const isSearchEngine = new URL(referrer).host.match(SEARCH_ENGINE_REGEX);\n    if (!isSearchEngine) return;\n\n    const currentVersion = getPermanentWebVersion();\n    if (currentVersion) {\n      if (currentVersion !== CLIENT_VERSION) {\n        switchPermanentWebVersion(currentVersion);\n      }\n      return;\n    }\n\n    const urlParams = new URLSearchParams(window.location.search);\n    const hasTest = (urlParams.get('test') ?? undefined) !== undefined;\n    const shouldRedirect = Math.random() < 0.5;\n\n    if (hasTest || !shouldRedirect) {\n      setPermanentWebVersion('Z');\n      return;\n    }\n\n    switchPermanentWebVersion('K');\n  } catch (e) {\n    // Ignore\n  }\n}\n","import type { ChangeEvent } from 'react';\nimport type { FC, TeactNode } from '../../lib/teact/teact';\nimport React, {\n  memo,\n  useRef,\n  useState,\n} from '../../lib/teact/teact';\n\nimport type { IconName } from '../../types/icons';\nimport type { IRadioOption } from './CheckboxGroup';\n\nimport buildClassName from '../../util/buildClassName';\nimport renderText from '../common/helpers/renderText';\n\nimport useLastCallback from '../../hooks/useLastCallback';\nimport useOldLang from '../../hooks/useOldLang';\n\nimport Icon from '../common/icons/Icon';\nimport Button from './Button';\nimport Spinner from './Spinner';\n\nimport './Checkbox.scss';\n\ntype OwnProps = {\n  id?: string;\n  name?: string;\n  value?: string;\n  label?: TeactNode;\n  labelText?: TeactNode;\n  subLabel?: string;\n  checked?: boolean;\n  rightIcon?: IconName;\n  disabled?: boolean;\n  tabIndex?: number;\n  withIcon?: boolean;\n  blocking?: boolean;\n  permissionGroup?: boolean;\n  isLoading?: boolean;\n  withCheckedCallback?: boolean;\n  onlyInput?: boolean;\n  isRound?: boolean;\n  className?: string;\n  onChange?: (e: ChangeEvent<HTMLInputElement>, nestedOptionList?: IRadioOption) => void;\n  onCheck?: (isChecked: boolean) => void;\n  onClickLabel?: (e: React.MouseEvent, value?: string) => void;\n  nestedCheckbox?: boolean;\n  nestedCheckboxCount?: number | undefined;\n  nestedOptionList?: IRadioOption;\n  leftElement?: TeactNode;\n  values?: string[];\n};\n\nconst Checkbox: FC<OwnProps> = ({\n  id,\n  name,\n  value,\n  label,\n  labelText,\n  subLabel,\n  checked,\n  tabIndex,\n  disabled,\n  withIcon,\n  blocking,\n  permissionGroup,\n  isLoading,\n  className,\n  rightIcon,\n  onlyInput,\n  isRound,\n  nestedCheckbox,\n  nestedCheckboxCount,\n  nestedOptionList,\n  leftElement,\n  values = [],\n  onChange,\n  onCheck,\n  onClickLabel,\n}) => {\n  const lang = useOldLang();\n  // eslint-disable-next-line no-null/no-null\n  const labelRef = useRef<HTMLLabelElement>(null);\n  const [showNested, setShowNested] = useState(false);\n\n  const handleChange = useLastCallback((event: ChangeEvent<HTMLInputElement>) => {\n    if (disabled) {\n      return;\n    }\n\n    if (onChange) {\n      onChange(event, nestedOptionList);\n    }\n\n    if (onCheck) {\n      onCheck(event.currentTarget.checked);\n    }\n  });\n\n  const toggleNested = useLastCallback(() => {\n    setShowNested(!showNested);\n  });\n\n  function handleClick(event: React.MouseEvent) {\n    if (event.target !== labelRef.current) {\n      onClickLabel?.(event, value);\n    }\n  }\n\n  function handleInputClick(event: React.MouseEvent) {\n    event.stopPropagation();\n  }\n\n  const labelClassName = buildClassName(\n    'Checkbox',\n    disabled && 'disabled',\n    withIcon && 'withIcon',\n    isLoading && 'loading',\n    blocking && 'blocking',\n    nestedCheckbox && 'nested',\n    subLabel && 'withSubLabel',\n    permissionGroup && 'permission-group',\n    Boolean(leftElement) && 'avatar',\n    onlyInput && 'onlyInput',\n    isRound && 'round',\n    Boolean(rightIcon) && 'withNestedList',\n    className,\n  );\n\n  return (\n    <>\n      {/* eslint-disable-next-line jsx-a11y/no-noninteractive-element-interactions */}\n      <label\n        className={labelClassName}\n        dir={lang.isRtl ? 'rtl' : undefined}\n        onClick={onClickLabel ? handleClick : undefined}\n        ref={labelRef}\n      >\n        <input\n          type=\"checkbox\"\n          id={id}\n          name={name}\n          value={value}\n          checked={checked}\n          disabled={disabled}\n          tabIndex={tabIndex}\n          onChange={handleChange}\n          onClick={onClickLabel ? handleInputClick : undefined}\n        />\n        <div className={buildClassName(\n          'Checkbox-main',\n          Boolean(leftElement) && 'Nested-avatar-list',\n        )}\n        >\n          <span className=\"label\" dir=\"auto\">\n            {leftElement}\n            {typeof label === 'string' ? renderText(label) : label}\n            {labelText && <span className=\"ml-1\">{renderText(labelText)}</span>}\n          </span>\n          {subLabel && <span className=\"subLabel\" dir=\"auto\">{renderText(subLabel)}</span>}\n          {rightIcon && <Icon name={rightIcon} className=\"right-icon\" />}\n        </div>\n        {nestedCheckbox && (\n          <span className=\"nestedButton\" dir=\"auto\">\n            <Button className=\"button\" color=\"translucent\" size=\"smaller\" onClick={toggleNested}>\n              <Icon name=\"group-filled\" className=\"group-icon\" />\n              {nestedCheckboxCount}\n              <Icon name={showNested ? 'up' : 'down'} />\n            </Button>\n          </span>\n        )}\n        {isLoading && <Spinner />}\n      </label>\n      {nestedCheckbox && (\n        <div\n          className={buildClassName('nested-checkbox-group', showNested && 'nested-checkbox-group-open')}\n        >\n          {nestedOptionList?.nestedOptions?.map((nestedOption) => (\n            <Checkbox\n              key={nestedOption.value}\n              leftElement={leftElement}\n              onChange={handleChange}\n              checked={values.indexOf(nestedOption.value) !== -1}\n              values={values}\n              /* eslint-disable-next-line react/jsx-props-no-spreading */\n              {...nestedOption}\n            />\n          ))}\n        </div>\n      )}\n    </>\n  );\n};\n\nexport default memo(Checkbox);\n","import type { Scheduler } from './schedulers';\n\nimport { requestMeasure } from '../lib/fasterdom/fasterdom';\n\ninterface AnimationInstance {\n  isCancelled: boolean;\n}\n\nlet currentInstance: AnimationInstance | undefined;\n\nexport function animateSingle(tick: Function, schedulerFn: Scheduler, instance?: AnimationInstance) {\n  if (!instance) {\n    if (currentInstance && !currentInstance.isCancelled) {\n      currentInstance.isCancelled = true;\n    }\n\n    instance = { isCancelled: false };\n    currentInstance = instance;\n  }\n\n  if (!instance!.isCancelled && tick()) {\n    schedulerFn(() => {\n      animateSingle(tick, schedulerFn, instance);\n    });\n  }\n}\n\nexport function cancelSingleAnimation() {\n  const dumbScheduler = (cb: AnyFunction) => cb;\n  const dumbCb = () => undefined;\n\n  animateSingle(dumbCb, dumbScheduler);\n}\n\nexport function animate(tick: Function, schedulerFn: Scheduler) {\n  schedulerFn(() => {\n    if (tick()) {\n      animate(tick, schedulerFn);\n    }\n  });\n}\n\nexport function animateInstantly(tick: Function, schedulerFn: Scheduler) {\n  if (tick()) {\n    schedulerFn(() => {\n      animateInstantly(tick, schedulerFn);\n    });\n  }\n}\n\ntype TimingFn = (t: number) => number;\n\ntype AnimateNumberProps<T extends number | number[]> = {\n  to: T;\n  from: T;\n  duration: number;\n  onUpdate: (value: T) => void;\n  timing?: TimingFn;\n  onEnd?: (isCanceled?: boolean) => void;\n};\n\nexport const timingFunctions = {\n  linear: (t: number) => t,\n  easeIn: (t: number) => t ** 1.675,\n  easeOut: (t: number) => -1 * t ** 1.675,\n  easeInOut: (t: number) => 0.5 * (Math.sin((t - 0.5) * Math.PI) + 1),\n  easeInQuad: (t: number) => t * t,\n  easeOutQuad: (t: number) => t * (2 - t),\n  easeInOutQuad: (t: number) => (t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t),\n  easeInCubic: (t: number) => t ** 3,\n  easeOutCubic: (t: number) => (--t) * t * t + 1,\n  easeInOutCubic: (t: number) => (t < 0.5 ? 4 * t ** 3 : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1),\n  easeInQuart: (t: number) => t ** 4,\n  easeOutQuart: (t: number) => 1 - (--t) * t ** 3,\n  easeInOutQuart: (t: number) => (t < 0.5 ? 8 * t ** 4 : 1 - 8 * (--t) * t ** 3),\n  easeInQuint: (t: number) => t ** 5,\n  easeOutQuint: (t: number) => 1 + (--t) * t ** 4,\n  easeInOutQuint: (t: number) => (t < 0.5 ? 16 * t ** 5 : 1 + 16 * (--t) * t ** 4),\n};\n\nexport function animateNumber<T extends number | number[]>({\n  timing = timingFunctions.linear,\n  onUpdate,\n  duration,\n  onEnd,\n  from,\n  to,\n}: AnimateNumberProps<T>) {\n  const t0 = Date.now();\n\n  let isCanceled = false;\n\n  animateInstantly(() => {\n    if (isCanceled) return false;\n\n    const t1 = Date.now();\n    const t = Math.min((t1 - t0) / duration, 1);\n\n    const progress = timing(t);\n    if (typeof from === 'number' && typeof to === 'number') {\n      onUpdate((from + ((to - from) * progress)) as T);\n    } else if (Array.isArray(from) && Array.isArray(to)) {\n      const result = from.map((f, i) => f + ((to[i] - f) * progress));\n      onUpdate(result as T);\n    }\n\n    if (t === 1) {\n      onEnd?.();\n    }\n\n    return t < 1;\n  }, requestMeasure);\n\n  return () => {\n    isCanceled = true;\n    onEnd?.(true);\n  };\n}\n\nexport function applyStyles(element: HTMLElement, css: Record<string, string>) {\n  Object.assign(element.style, css);\n}\n","import type {\n  ApiUser, ApiUserCommonChats,\n  ApiUserFullInfo, ApiUserStatus,\n} from '../../api/types';\nimport type { BotAppPermissions } from '../../types';\nimport type { GlobalState } from '../types';\n\nimport { isUserBot } from '../helpers';\n\nexport function selectUser<T extends GlobalState>(global: T, userId: string): ApiUser | undefined {\n  return global.users.byId[userId];\n}\n\nexport function selectUserStatus<T extends GlobalState>(global: T, userId: string): ApiUserStatus | undefined {\n  return global.users.statusesById[userId];\n}\n\nexport function selectUserFullInfo<T extends GlobalState>(global: T, userId: string): ApiUserFullInfo | undefined {\n  return global.users.fullInfoById[userId];\n}\n\nexport function selectUserCommonChats<T extends GlobalState>(\n  global: T, userId: string,\n): ApiUserCommonChats | undefined {\n  return global.users.commonChatsById[userId];\n}\n\nexport function selectIsUserBlocked<T extends GlobalState>(global: T, userId: string) {\n  return selectUserFullInfo(global, userId)?.isBlocked;\n}\n\nexport function selectIsCurrentUserPremium<T extends GlobalState>(global: T) {\n  if (!global.currentUserId) return false;\n\n  return Boolean(global.users.byId[global.currentUserId].isPremium);\n}\n\nexport function selectIsCurrentUserFrozen<T extends GlobalState>(global: T) {\n  return Boolean(global.appConfig?.freezeUntilDate);\n}\n\nexport function selectIsPremiumPurchaseBlocked<T extends GlobalState>(global: T) {\n  return global.appConfig?.isPremiumPurchaseBlocked ?? true;\n}\n\nexport function selectIsGiveawayGiftsPurchaseAvailable<T extends GlobalState>(global: T) {\n  return global.appConfig?.isGiveawayGiftsPurchaseAvailable ?? true;\n}\n\n/**\n * Slow, not to be used in `withGlobal`\n */\nexport function selectUserByPhoneNumber<T extends GlobalState>(global: T, phoneNumber: string) {\n  const phoneNumberCleaned = phoneNumber.replace(/[^0-9]/g, '');\n\n  return Object.values(global.users.byId).find((user) => user?.phoneNumber === phoneNumberCleaned);\n}\n\nexport function selectBot<T extends GlobalState>(global: T, userId: string): ApiUser | undefined {\n  const user = selectUser(global, userId);\n  if (!user || !isUserBot(user)) {\n    return undefined;\n  }\n\n  return user;\n}\n\nexport function selectBotAppPermissions<T extends GlobalState>(\n  global: T, userId: string,\n): BotAppPermissions | undefined {\n  return global.users.botAppPermissionsById[userId];\n}\n","import type { ApiChatType, ApiPhoto } from '../../api/types';\nimport type { WebApp } from '../../types/webapp';\n\nimport { REPLIES_USER_ID, VERIFICATION_CODES_USER_ID } from '../../config';\n\nexport function getBotCoverMediaHash(photo: ApiPhoto) {\n  return `photo${photo.id}?size=x`;\n}\n\nexport function convertToApiChatType(type: string): ApiChatType | undefined {\n  if (type === 'channels') return 'channels';\n  if (type === 'chats' || type === 'groups') return 'chats';\n  if (type === 'users') return 'users';\n  if (type === 'bots') return 'bots';\n  return undefined;\n}\n\nexport function getWebAppKey(webApp: Partial<WebApp>) {\n  if (webApp.requestUrl) return webApp.requestUrl;\n  if (webApp.appName) return `${webApp.botId}?appName=${webApp.appName}`;\n  return webApp.botId!;\n}\n\nexport function isSystemBot(botId: string) {\n  return botId === REPLIES_USER_ID || botId === VERIFICATION_CODES_USER_ID;\n}\n","import type { PerformanceType } from '../types';\nimport type { GlobalState, SharedState, TabState } from './types';\nimport { NewChatMembersProgress } from '../types';\n\nimport {\n  ANIMATION_LEVEL_DEFAULT,\n  DARK_THEME_PATTERN_COLOR,\n  DEFAULT_GIFT_PROFILE_FILTER_OPTIONS,\n  DEFAULT_MESSAGE_TEXT_SIZE_PX,\n  DEFAULT_PATTERN_COLOR,\n  DEFAULT_PLAYBACK_RATE,\n  DEFAULT_VOLUME,\n  IOS_DEFAULT_MESSAGE_TEXT_SIZE_PX,\n  MACOS_DEFAULT_MESSAGE_TEXT_SIZE_PX,\n} from '../config';\nimport { IS_IOS, IS_MAC_OS } from '../util/browser/windowEnvironment';\n\nexport const INITIAL_PERFORMANCE_STATE_MAX: PerformanceType = {\n  animatedEmoji: true,\n  autoplayGifs: true,\n  autoplayVideos: true,\n  contextMenuAnimations: true,\n  contextMenuBlur: true,\n  loopAnimatedStickers: true,\n  mediaViewerAnimations: true,\n  messageComposerAnimations: true,\n  messageSendingAnimations: true,\n  pageTransitions: true,\n  reactionEffects: true,\n  rightColumnAnimations: true,\n  stickerEffects: true,\n  storyRibbonAnimations: true,\n  snapEffect: true,\n};\n\nexport const INITIAL_PERFORMANCE_STATE_MID: PerformanceType = {\n  animatedEmoji: true,\n  autoplayGifs: true,\n  autoplayVideos: true,\n  contextMenuAnimations: true,\n  contextMenuBlur: true,\n  loopAnimatedStickers: true,\n  mediaViewerAnimations: true,\n  messageComposerAnimations: true,\n  messageSendingAnimations: true,\n  pageTransitions: true,\n  reactionEffects: true,\n  rightColumnAnimations: false,\n  stickerEffects: false,\n  storyRibbonAnimations: false,\n  snapEffect: false,\n};\n\nexport const INITIAL_PERFORMANCE_STATE_MIN: PerformanceType = {\n  animatedEmoji: false,\n  autoplayGifs: false,\n  autoplayVideos: false,\n  contextMenuAnimations: false,\n  contextMenuBlur: false,\n  loopAnimatedStickers: false,\n  mediaViewerAnimations: false,\n  messageComposerAnimations: false,\n  messageSendingAnimations: false,\n  pageTransitions: false,\n  reactionEffects: false,\n  rightColumnAnimations: false,\n  stickerEffects: false,\n  storyRibbonAnimations: false,\n  snapEffect: false,\n};\n\nexport const INITIAL_SHARED_STATE: SharedState = {\n  settings: {\n    theme: 'light',\n    shouldUseSystemTheme: true,\n    messageTextSize: IS_IOS\n      ? IOS_DEFAULT_MESSAGE_TEXT_SIZE_PX\n      : (IS_MAC_OS ? MACOS_DEFAULT_MESSAGE_TEXT_SIZE_PX : DEFAULT_MESSAGE_TEXT_SIZE_PX),\n    animationLevel: ANIMATION_LEVEL_DEFAULT,\n    messageSendKeyCombo: 'enter',\n    performance: INITIAL_PERFORMANCE_STATE_MAX,\n    shouldSkipWebAppCloseConfirmation: false,\n    language: 'en',\n    timeFormat: '24h',\n    wasTimeFormatSetManually: false,\n    isConnectionStatusMinimized: true,\n    canDisplayChatInTitle: true,\n    shouldAllowHttpTransport: true,\n    shouldWarnAboutSvg: true,\n  },\n  isInitial: true,\n};\n\nexport const INITIAL_GLOBAL_STATE: GlobalState = {\n  cacheVersion: 2,\n  isInited: true,\n  attachMenu: { bots: {} },\n  passcode: {},\n  twoFaSettings: {},\n  isAppUpdateAvailable: false,\n  isElectronUpdateAvailable: false,\n  shouldShowContextMenuHint: true,\n\n  audioPlayer: {\n    lastPlaybackRate: DEFAULT_PLAYBACK_RATE,\n  },\n\n  mediaViewer: {\n    lastPlaybackRate: DEFAULT_PLAYBACK_RATE,\n  },\n\n  authRememberMe: true,\n  countryList: {\n    phoneCodes: [],\n    general: [],\n  },\n\n  blocked: {\n    ids: [],\n    totalCount: 0,\n  },\n\n  users: {\n    byId: {},\n    statusesById: {},\n    fullInfoById: {},\n    previewMediaByBotId: {},\n    commonChatsById: {},\n    botAppPermissionsById: {},\n  },\n\n  peers: {\n    profilePhotosById: {},\n  },\n\n  chats: {\n    listIds: {},\n    isFullyLoaded: {},\n    orderedPinnedIds: {},\n    totalCount: {},\n    lastMessageIds: {},\n    byId: {},\n    fullInfoById: {},\n    similarChannelsById: {},\n    similarBotsById: {},\n    topicsInfoById: {},\n    notifyExceptionById: {},\n    loadingParameters: {\n      active: {},\n      archived: {},\n      saved: {},\n    },\n  },\n\n  messages: {\n    byChatId: {},\n    sponsoredByChatId: {},\n    pollById: {},\n    playbackByChatId: {},\n  },\n\n  stories: {\n    byPeerId: {},\n    orderedPeerIds: {\n      archived: [],\n      active: [],\n    },\n    hasNext: true,\n    hasNextInArchive: true,\n    stealthMode: {},\n  },\n\n  groupCalls: {\n    byId: {},\n  },\n\n  attachmentSettings: {\n    shouldCompress: true,\n    shouldSendGrouped: true,\n    isInvertedMedia: undefined,\n    webPageMediaSize: undefined,\n  },\n\n  scheduledMessages: {\n    byChatId: {},\n  },\n\n  quickReplies: {\n    byId: {},\n    messagesById: {},\n  },\n\n  chatFolders: {\n    byId: {},\n    invites: {},\n  },\n\n  fileUploads: {\n    byMessageKey: {},\n  },\n\n  recentEmojis: ['grinning', 'kissing_heart', 'christmas_tree', 'brain', 'trophy', 'duck', 'cherries'],\n  recentCustomEmojis: ['5377305978079288312'],\n\n  reactions: {\n    defaultTags: [],\n    topReactions: [],\n    recentReactions: [],\n    effectReactions: [],\n    hash: {},\n  },\n  availableEffectById: {},\n\n  stickers: {\n    setsById: {},\n    added: {},\n    recent: {\n      stickers: [],\n    },\n    favorite: {\n      stickers: [],\n    },\n    greeting: {\n      stickers: [],\n    },\n    premium: {\n      stickers: [],\n    },\n    featured: {\n      setIds: [],\n    },\n    effect: {\n      stickers: [],\n      emojis: [],\n    },\n    forEmoji: {},\n  },\n\n  customEmojis: {\n    lastRendered: [],\n    byId: {},\n    added: {},\n    forEmoji: {},\n    statusRecent: {},\n  },\n\n  emojiKeywords: {},\n\n  gifs: {\n    saved: {},\n  },\n\n  topPeers: {},\n\n  topInlineBots: {},\n  topBotApps: {},\n\n  activeSessions: {\n    byHash: {},\n    orderedHashes: [],\n  },\n\n  activeWebSessions: {\n    byHash: {},\n    orderedHashes: [],\n  },\n\n  settings: {\n    byKey: {\n      canAutoLoadPhotoFromContacts: true,\n      canAutoLoadPhotoInPrivateChats: true,\n      canAutoLoadPhotoInGroups: true,\n      canAutoLoadPhotoInChannels: true,\n      canAutoLoadVideoFromContacts: true,\n      canAutoLoadVideoInPrivateChats: true,\n      canAutoLoadVideoInGroups: true,\n      canAutoLoadVideoInChannels: true,\n      canAutoLoadFileFromContacts: false,\n      canAutoLoadFileInPrivateChats: false,\n      canAutoLoadFileInGroups: false,\n      canAutoLoadFileInChannels: false,\n      autoLoadFileMaxSizeMb: 10,\n      hasWebNotifications: true,\n      hasPushNotifications: true,\n      notificationSoundVolume: 5,\n      shouldSuggestStickers: true,\n      shouldSuggestCustomEmoji: true,\n      shouldPaidMessageAutoApprove: false,\n      shouldUpdateStickerSetOrder: true,\n      shouldArchiveAndMuteNewNonContact: false,\n      shouldNewNonContactPeersRequirePremium: false,\n      disallowedGifts: undefined,\n      nonContactPeersPaidStars: 0,\n      shouldHideReadMarks: false,\n      canTranslate: false,\n      canTranslateChats: true,\n      doNotTranslate: [],\n    },\n    privacy: {},\n    botVerificationShownPeerIds: [],\n    themes: {\n      light: {\n        isBlurred: true,\n        patternColor: DEFAULT_PATTERN_COLOR,\n      },\n      dark: {\n        isBlurred: true,\n        patternColor: DARK_THEME_PATTERN_COLOR,\n      },\n    },\n  },\n\n  serviceNotifications: [],\n  trustedBotIds: [],\n\n  transcriptions: {},\n  translations: {\n    byChatId: {},\n  },\n\n  byTabId: {},\n  sharedState: INITIAL_SHARED_STATE,\n\n  archiveSettings: {\n    isMinimized: false,\n    isHidden: false,\n  },\n};\n\nexport const INITIAL_TAB_STATE: TabState = {\n  id: 0,\n  isMasterTab: false,\n  isLeftColumnShown: true,\n  isChatInfoShown: false,\n  newChatMembersProgress: NewChatMembersProgress.Closed,\n  uiReadyState: 0,\n  shouldInit: true,\n\n  gifSearch: {},\n  stickerSearch: {},\n\n  messageLists: [],\n  activeChatFolder: 0,\n  tabThreads: {},\n\n  inlineBots: {\n    isLoading: false,\n    byUsername: {},\n  },\n\n  webApps: {\n    openedWebApps: {},\n    openedOrderedKeys: [],\n    sessionKeys: [],\n    modalState: 'maximized',\n    isModalOpen: false,\n    isMoreAppsTabActive: false,\n  },\n\n  globalSearch: {},\n\n  userSearch: {},\n\n  middleSearch: {\n    byChatThreadKey: {},\n  },\n\n  sharedMediaSearch: {\n    byChatThreadKey: {},\n  },\n\n  chatMediaSearch: {\n    byChatThreadKey: {},\n  },\n\n  management: {\n    byChatId: {},\n  },\n\n  savedGifts: {\n    filter: {\n      ...DEFAULT_GIFT_PROFILE_FILTER_OPTIONS,\n    },\n    giftsByPeerId: {},\n  },\n\n  storyViewer: {\n    isMuted: true,\n    isRibbonShown: false,\n  },\n\n  mediaViewer: {\n    volume: DEFAULT_VOLUME,\n    playbackRate: DEFAULT_PLAYBACK_RATE,\n    isMuted: false,\n  },\n\n  audioPlayer: {\n    volume: DEFAULT_VOLUME,\n    playbackRate: DEFAULT_PLAYBACK_RATE,\n    isMuted: false,\n  },\n\n  isShareMessageModalShown: false,\n\n  isWebAppsCloseConfirmationModalOpen: false,\n\n  forwardMessages: {},\n\n  replyingMessage: {},\n\n  pollResults: {},\n\n  payment: {},\n  starsPayment: {},\n\n  notifications: [],\n\n  dialogs: [],\n\n  activeReactions: {},\n\n  activeDownloads: {},\n\n  statistics: {\n    byChatId: {},\n  },\n\n  pollModal: {\n    isOpen: false,\n  },\n\n  requestedTranslations: {\n    byChatId: {},\n  },\n\n  isPaymentMessageConfirmDialogOpen: false,\n};","/* eslint-disable max-len */\n/* eslint-disable no-console */\n/* eslint-disable no-null/no-null */\nexport type StoreName = 'message' | 'contact' | 'user' | 'general' | 'knowledge' | 'summaryTemplate' | 'urgentTopic' | 'summary' | 'folder' | 'aIChatFolders';\n\ntype IndexConfig = [indexName: string, keyPath: string | string[]];\n\ninterface StoreConfig {\n  keyPath?: string;\n  autoIncrement?: boolean;\n  indexes?: IndexConfig[];\n}\n\ntype StoreConfigMap = Record<StoreName, StoreConfig>;\n\nclass ChataiStoreManager {\n  private DB_NAME: string;\n\n  private VERSION: number;\n\n  public db: IDBDatabase | null = null;\n\n  private STORE_CONFIG:StoreConfigMap = {\n    summary: { keyPath: 'id', indexes: [['id', 'id'], ['timestamp', 'timestamp']] },\n    message: { keyPath: 'id', indexes: [['id', 'id'], ['chatId_timestamp', ['chatId', 'timestamp']]] },\n    contact: { keyPath: 'id', autoIncrement: true },\n    user: { keyPath: 'id', autoIncrement: true },\n    general: { autoIncrement: true },\n    knowledge: { keyPath: 'id', autoIncrement: true },\n    summaryTemplate: { keyPath: 'id', autoIncrement: true },\n    urgentTopic: { keyPath: 'id', autoIncrement: false },\n    folder: { keyPath: 'title', autoIncrement: true },\n    aIChatFolders: { keyPath: 'id', autoIncrement: true }\n  };\n\n  constructor(VERSION: number, DB_NAME: string) {\n    this.VERSION = VERSION;\n    this.DB_NAME = DB_NAME;\n  }\n\n  initDB(): Promise<IDBDatabase> {\n    // eslint-disable-next-line @typescript-eslint/quotes, no-console\n    console.log(\"初始化indexdb\", this.VERSION);\n    return new Promise<IDBDatabase>((resolve, reject) => {\n      const request = indexedDB.open(this.DB_NAME, this.VERSION);\n\n      request.onupgradeneeded = (event) => {\n        const db = (event.target as IDBOpenDBRequest).result;\n        // 遍历 STORE_CONFIG，确保所有表都被创建\n        // if (db.objectStoreNames.contains('message')) {\n        //   db.deleteObjectStore('message');\n        //   // eslint-disable-next-line no-console\n        //   console.log('messages 对象存储已删除');\n        // }\n        // if (db.objectStoreNames.contains('urgentTopic')) {\n        //   db.deleteObjectStore('urgentTopic');\n        //   // eslint-disable-next-line no-console\n        //   console.log('urgentTopic 对象存储已删除');\n        // }\n        Object.entries(this.STORE_CONFIG).forEach(([storeName, config]) => {\n          if (!db.objectStoreNames.contains(storeName)) {\n            const store = db.createObjectStore(storeName,\n              { keyPath: config.keyPath, autoIncrement: config.autoIncrement });\n\n            if (config.indexes) {\n              config.indexes.forEach(([indexName, keyPath]) => {\n                store.createIndex(indexName, keyPath, { unique: false });\n              });\n            }\n          }\n        });\n      };\n\n      request.onsuccess = () => {\n        this.db = request.result;\n        resolve(request.result);\n      };\n\n      // eslint-disable-next-line no-console\n      request.onerror = (err) => {\n        console.error(err);\n        reject(new Error('Failed to open database'));\n      };\n    });\n  }\n\n  async getDB(): Promise<IDBDatabase> {\n    if (!this.db) {\n      this.db = await this.initDB();\n    }\n    return this.db!;\n  }\n}\n\nexport default ChataiStoreManager;\n","/* eslint-disable no-null/no-null */\n/* eslint-disable no-console */\nimport type { StoreName } from './chatai-store';\nimport type ChataiDB from './chatai-store';\n\nexport interface CustomSummaryTemplate {\n  id: string;\n  title: string;\n  prompt: string;\n}\n\nclass SummaryTemplateStore {\n  private storeName: StoreName = 'summaryTemplate';\n\n  private db: IDBDatabase | null = null;\n\n  private chataiStoreManager:ChataiDB;\n\n  constructor(private dbManager: ChataiDB) {\n    this.db = dbManager.db;\n    this.chataiStoreManager = dbManager;\n  }\n\n  async getAllSummaryTemplate(): Promise<CustomSummaryTemplate[]> {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding contact:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readonly');\n      const store = tx.objectStore(this.storeName);\n      const request = store.getAll();\n      request.onsuccess = () => {\n        resolve(request.result);\n      };\n      request.onerror = () => {\n        reject(request.error);\n      };\n    });\n  }\n\n  async getSummaryTemplate(id: string): Promise<CustomSummaryTemplate> {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding contact:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readonly');\n      const store = tx.objectStore(this.storeName);\n      const request = store.get(id);\n      request.onsuccess = () => {\n        resolve(request.result);\n      };\n      request.onerror = () => {\n        reject(request.error);\n      };\n    });\n  }\n\n  async deleteSummaryTemplate(id: string):Promise<void> {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding contact:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readwrite');\n      const store = tx.objectStore(this.storeName);\n      const request = store.delete(id);\n      request.onsuccess = () => {\n        console.log(`Deleted record with key: ${id}`);\n        resolve();\n      };\n      request.onerror = () => reject(new Error('Failed to delete record'));\n    });\n  }\n\n  async addSummaryTemplate(summaryTemplate:CustomSummaryTemplate) {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding contact:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readwrite');\n      const store = tx.objectStore(this.storeName);\n      const request = store.put(summaryTemplate);\n      request.onsuccess = () => {\n        resolve(request.result);\n      };\n      request.onerror = () => {\n        reject(request.error);\n      };\n    });\n  }\n}\n\nexport default SummaryTemplateStore;\n","\nimport type { StoreName } from './chatai-store';\nimport type ChataiDB from './chatai-store';\n\ninterface AIChatFoldersInfo {}\n\nclass AIChatFoldersStore {\n  private storeName: StoreName = 'aIChatFolders';\n\n  private db: IDBDatabase | null = null;\n\n  private chataiStoreManager:ChataiDB;\n\n  constructor(private dbManager: ChataiDB) {\n    this.db = dbManager.db;\n    this.chataiStoreManager = dbManager;\n  }\n\n  async getAllAIChatFolders(): Promise<any[]> {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error getting all aichatfolders:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readonly');\n      const store = tx.objectStore(this.storeName);\n      const request = store.getAll();\n      request.onsuccess = () => {\n        resolve(request.result);\n      };\n      request.onerror = () => {\n        reject(request.error);\n      };\n    })\n  }\n\n  async getAIChatFolder(key: string): Promise<any | undefined> {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error get aichatfolder:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readonly');\n      const store = tx.objectStore(this.storeName);\n      const request = store.get(key);\n      request.onsuccess = () => {\n        resolve(request.result);\n      };\n      request.onerror = () => {\n        reject(request.error);\n      };\n    });\n  }\n\n  async deleteAIChatFolder(key:string) {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error deleting aichatfolder:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readwrite');\n      const store = tx.objectStore(this.storeName);\n      const request = store.delete(key);\n      request.onsuccess = () => {\n        resolve(request.result);\n      };\n      request.onerror = () => {\n        reject(request.error);\n      };\n    });\n  }\n\n  async addAIChatFolder(aiChatFolder: AIChatFoldersInfo) {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding aichatfolder:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readwrite');\n      const store = tx.objectStore(this.storeName);\n      const request = store.put(aiChatFolder);\n      request.onsuccess = () => {\n        resolve(request.result);\n      };\n      request.onerror = () => {\n        reject(request.error);\n      };\n    });\n  }\n}\n\nexport default AIChatFoldersStore;\n","/* eslint-disable no-null/no-null */\n/* eslint-disable no-console */\nimport type { StoreName } from './chatai-store';\nimport type ChataiDB from './chatai-store';\n\ninterface UserInfo {\n  id: string;\n  name?: string;\n  avatar?: string;\n  phoneNumber?: string;\n  tags?: string;\n}\nclass ContactStore {\n  private storeName: StoreName = 'contact';\n\n  private db: IDBDatabase | null = null;\n\n  private chataiStoreManager:ChataiDB;\n\n  constructor(private dbManager: ChataiDB) {\n    this.db = dbManager.db;\n    this.chataiStoreManager = dbManager;\n  }\n\n  async getContact(id: string): Promise<UserInfo | undefined> {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding contact:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readonly');\n      const store = tx.objectStore(this.storeName);\n      const request = store.get(id);\n      request.onsuccess = () => {\n        resolve(request.result);\n      };\n      request.onerror = () => {\n        reject(request.error);\n      };\n    });\n  }\n\n  async addContact(contact: UserInfo) {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding contact:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readwrite');\n      const store = tx.objectStore(this.storeName);\n      const request = store.put(contact);\n      request.onsuccess = () => {\n        resolve(request.result);\n      };\n      request.onerror = () => {\n        reject(request.error);\n      };\n    });\n  }\n}\n\nexport default ContactStore;\n","\nimport type { StoreName } from './chatai-store';\nimport type ChataiDB from './chatai-store';\n\ninterface FolderInfo {\n\n}\n\nclass FolderStore {\n  private storeName: StoreName = 'folder';\n\n  private db: IDBDatabase | null = null;\n\n  private chataiStoreManager:ChataiDB;\n\n  constructor(private dbManager: ChataiDB) {\n    this.db = dbManager.db;\n    this.chataiStoreManager = dbManager;\n  }\n\n  async getAllFolders(): Promise<any[]> {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error getting all folders:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readonly');\n      const store = tx.objectStore(this.storeName);\n      const request = store.getAll();\n      request.onsuccess = () => {\n        resolve(request.result);\n      };\n      request.onerror = () => {\n        reject(request.error);\n      };\n    })\n  }\n\n  async getFolder(key: string): Promise<any | undefined> {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error get folder:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readonly');\n      const store = tx.objectStore(this.storeName);\n      const request = store.get(key);\n      request.onsuccess = () => {\n        resolve(request.result);\n      };\n      request.onerror = () => {\n        reject(request.error);\n      };\n    });\n  }\n\n  async deleteFolder(key:string) {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error deleting folder:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readwrite');\n      const store = tx.objectStore(this.storeName);\n      const request = store.delete(key);\n      request.onsuccess = () => {\n        resolve(request.result);\n      };\n      request.onerror = () => {\n        reject(request.error);\n      };\n    });\n  }\n\n  async addFolder(folder: FolderInfo) {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding folder:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readwrite');\n      const store = tx.objectStore(this.storeName);\n      const request = store.put(folder);\n      request.onsuccess = () => {\n        resolve(request.result);\n      };\n      request.onerror = () => {\n        reject(request.error);\n      };\n    });\n  }\n}\n\nexport default FolderStore;\n","/* eslint-disable no-null/no-null */\n/* eslint-disable no-console */\nimport type { StoreName } from './chatai-store';\nimport type ChataiDB from './chatai-store';\n\nexport interface AiKnowledge {\n  id: string;\n  richText: any;\n  plainText: string;\n  question: string;\n}\nclass KnowledgeStore {\n  private storeName: StoreName = 'knowledge';\n\n  private db: IDBDatabase | null = null;\n\n  private chataiStoreManager:ChataiDB;\n\n  constructor(private dbManager: ChataiDB) {\n    this.db = dbManager.db;\n    this.chataiStoreManager = dbManager;\n  }\n\n  async getKnowledge(id: string): Promise<AiKnowledge | undefined> {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding contact:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readonly');\n      const store = tx.objectStore(this.storeName);\n      const request = store.get(id);\n      request.onsuccess = () => {\n        resolve(request.result);\n      };\n      request.onerror = () => {\n        reject(request.error);\n      };\n    });\n  }\n\n  async getAllKnowledge(): Promise<AiKnowledge[] | undefined> {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding contact:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readonly');\n      const store = tx.objectStore(this.storeName);\n      const request = store.getAll();\n      request.onsuccess = () => {\n        resolve(request.result);\n      };\n      request.onerror = () => {\n        reject(request.error);\n      };\n    });\n  }\n\n  async addKnowledge(knowledge: AiKnowledge) {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding contact:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readwrite');\n      const store = tx.objectStore(this.storeName);\n      const request = store.put(knowledge);\n      request.onsuccess = () => {\n        resolve(request.result);\n      };\n      request.onerror = () => {\n        reject(request.error);\n      };\n    });\n  }\n\n  async deleteKnowledge(id:string) {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding contact:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readwrite');\n      const store = tx.objectStore(this.storeName);\n      const request = store.delete(id);\n      request.onsuccess = () => {\n        resolve(request.result);\n      };\n      request.onerror = () => {\n        reject(request.error);\n      };\n    });\n  }\n}\n\nexport default KnowledgeStore;\n","/* eslint-disable no-null/no-null */\n/* eslint-disable no-console */\nimport type { StoreName } from './chatai-store';\nimport type ChataiDB from './chatai-store';\n\nexport interface UrgentTopic {\n  id: string;\n  topicName: string;\n  topicDescription: string;\n  strongAlert?: boolean;\n  phoneNumber?: string;\n}\n\nclass UrgentTopicStore {\n  private storeName: StoreName = 'urgentTopic';\n\n  private db: IDBDatabase | null = null;\n\n  private chataiStoreManager:ChataiDB;\n\n  constructor(private dbManager: ChataiDB) {\n    this.db = dbManager.db;\n    this.chataiStoreManager = dbManager;\n  }\n\n  async getAllUrgentTopic(): Promise<UrgentTopic[]> {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding contact:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readonly');\n      const store = tx.objectStore(this.storeName);\n      const request = store.getAll();\n      request.onsuccess = () => {\n        resolve(request.result);\n      };\n      request.onerror = () => {\n        reject(request.error);\n      };\n    });\n  }\n\n  async getUrgentTopic(id: string): Promise<UrgentTopic> {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding contact:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readonly');\n      const store = tx.objectStore(this.storeName);\n      const request = store.get(id);\n      request.onsuccess = () => {\n        resolve(request.result);\n      };\n      request.onerror = () => {\n        reject(request.error);\n      };\n    });\n  }\n\n  async deleteUrgentTopic(id: string):Promise<void> {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding contact:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readwrite');\n      const store = tx.objectStore(this.storeName);\n      const request = store.delete(id);\n      request.onsuccess = () => {\n        console.log(`Deleted record with key: ${id}`);\n        resolve();\n      };\n      request.onerror = () => reject(new Error('Failed to delete record'));\n    });\n  }\n\n  async addUrgentTopic(urgentTopic:UrgentTopic) {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding contact:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readwrite');\n      const store = tx.objectStore(this.storeName);\n      const request = store.put(urgentTopic);\n      request.onsuccess = () => {\n        resolve(request.result);\n      };\n      request.onerror = () => {\n        reject(request.error);\n      };\n    });\n  }\n\n  async addUrgentTopics(urgentTopics: UrgentTopic[]): Promise<void> {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding contact:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const transaction = db.transaction([this.storeName], 'readwrite');\n      const store = transaction.objectStore(this.storeName);\n\n      urgentTopics.forEach((urgentTopic) => {\n        const request = store.put(urgentTopic);\n\n        request.onsuccess = () => {\n          console.log(`urgentTopic ${urgentTopic.id} stored successfully`);\n        };\n\n        request.onerror = (event: Event) => {\n          console.error(\n            `Error storing urgentTopic ${urgentTopic.id}:`,\n            (event.target as IDBRequest).error,\n          );\n        };\n      });\n\n      transaction.oncomplete = () => {\n        console.log('All urgentTopics stored successfully');\n        resolve();\n      };\n\n      transaction.onerror = (event: Event) => {\n        console.error(\n          'Error storing urgentTopics:',\n          (event.target as IDBRequest).error,\n        );\n        reject((event.target as IDBRequest).error);\n      };\n    });\n  }\n}\n\nexport default UrgentTopicStore;\n","/* eslint-disable no-null/no-null */\n/* eslint-disable no-console */\nimport type { StoreName } from './chatai-store';\nimport type ChataiDB from './chatai-store';\n\ninterface UserInfo {\n  id: string;\n  name?: string;\n  avatar?: string;\n  phoneNumber?: string;\n  tags?:string;\n}\n\nclass UserStore {\n  private storeName: StoreName = 'user';\n\n  private db: IDBDatabase | null = null;\n\n  private chataiStoreManager:ChataiDB;\n\n  constructor(private dbManager: ChataiDB) {\n    this.db = dbManager.db;\n    this.chataiStoreManager = dbManager;\n  }\n\n  async getUser(id: string): Promise<UserInfo | undefined> {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding contact:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readonly');\n      const store = tx.objectStore(this.storeName);\n      const request = store.get(id);\n      request.onsuccess = () => {\n        resolve(request.result);\n      };\n      request.onerror = () => {\n        reject(request.error);\n      };\n    });\n  }\n\n  async addUser(contact: UserInfo) {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding contact:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readwrite');\n      const store = tx.objectStore(this.storeName);\n      const request = store.put(contact);\n      request.onsuccess = () => {\n        resolve(request.result);\n      };\n      request.onerror = () => {\n        reject(request.error);\n      };\n    });\n  }\n}\n\nexport default UserStore;\n","/* eslint-disable @typescript-eslint/no-shadow */\n/* eslint-disable no-null/no-null */\nimport eventEmitter, { Actions } from '../lib/EventEmitter';\nimport ChataiStoreManager from './chatai-store';\nimport SummaryTemplateStore from './chatai-summary-template-store';\nimport AIChatFoldersStore from \"./ai-chatfolders-store\"\nimport ContactStore from './contact-store';\nimport FolderStore from \"./folder-store\"\nimport GeneralStore from './general-store';\nimport KnowledgeStore from './knowledge-store';\nimport MessageStore from './messages-store';\nimport SummaryStore from './summary-store';\nimport UrgentTopicStore from './urgent-topic-store';\nimport UsersStore from './user-store';\n\nconst dbVersion = 18;\n\nexport const GLOBAL_SUMMARY_LAST_TIME = 'globalSummaryLastTime';\nexport const GLOBAL_SUMMARY_READ_TIME = 'globalSummaryReadTime';\nexport const GLOBAL_AICHATFOLDERS_LAST_TIME = \"globalAiChatFoldersLastTime\";\nexport const GLOBAL_AICHATFOLDERS_TIP_SHOW = 'globalAiChatFoldersTipShow'\nexport const GLOBAL_PRESET_TAG = \"globalPresetTag\";\nexport const GLOBAL_AI_TAG = \"globalAITag\"\n\nlet currentUserId!: string;\n\nexport const ChataiStores = {\n  summary: null as SummaryStore | null,\n  message: null as MessageStore | null,\n  contact: null as ContactStore | null,\n  user: null as UsersStore | null,\n  general: null as GeneralStore | null,\n  knowledge: null as KnowledgeStore | null,\n  summaryTemplate: null as SummaryTemplateStore | null,\n  urgentTopic: null as UrgentTopicStore | null,\n  folder: null as FolderStore | null,\n  aIChatFolders: null as AIChatFoldersStore | null,\n};\n\nexport function setChataiStoreBuilderCurrentUserId(_currentUserId: string) {\n  if (_currentUserId && (!currentUserId || currentUserId !== _currentUserId)) {\n    initChataiStores(_currentUserId);\n  }\n  currentUserId = _currentUserId;\n}\n\nexport async function initChataiStores(_currentUserId: string) {\n  const dbName = `tt-chatai-${_currentUserId}`;\n  const chataiStoreManager = new ChataiStoreManager(dbVersion, dbName);\n  await chataiStoreManager.initDB();\n  ChataiStores.summary = new SummaryStore(chataiStoreManager);\n  ChataiStores.message = new MessageStore(chataiStoreManager);\n  ChataiStores.contact = new ContactStore(chataiStoreManager);\n  ChataiStores.user = new UsersStore(chataiStoreManager);\n  ChataiStores.general = new GeneralStore(chataiStoreManager);\n  ChataiStores.knowledge = new KnowledgeStore(chataiStoreManager);\n  ChataiStores.summaryTemplate = new SummaryTemplateStore(chataiStoreManager);\n  ChataiStores.urgentTopic = new UrgentTopicStore(chataiStoreManager);\n  ChataiStores.folder = new FolderStore(chataiStoreManager);\n  ChataiStores.aIChatFolders = new AIChatFoldersStore(chataiStoreManager);\n  eventEmitter.emit(Actions.ChatAIStoreReady);\n  (window as any).downloadAllSummarys = () => {\n    ChataiStores.message?.getAllMessages().then((res) => {\n      const content = JSON.stringify(res);\n      const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });\n      // 3. 创建下载链接并触发点击\n      const link = document.createElement('a');\n      link.href = URL.createObjectURL(blob);\n      link.download = 'summarys.txt'; // 设置下载文件名\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      URL.revokeObjectURL(link.href);\n    });\n  };\n  (window as any).ChataiMessageStore = ChataiStores.message;\n}\n","import type {\n  ApiChat, ApiChatFullInfo, ApiChatType,\n} from '../../api/types';\nimport type { ChatListType } from '../../types';\nimport type { GlobalState, TabArgs } from '../types';\n\nimport {\n  ALL_FOLDER_ID, ARCHIVED_FOLDER_ID, MEMBERS_LOAD_SLICE, SAVED_FOLDER_ID, SERVICE_NOTIFICATIONS_USER_ID,\n} from '../../config';\nimport { IS_TRANSLATION_SUPPORTED } from '../../util/browser/windowEnvironment';\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { GLOBAL_SUMMARY_CHATID } from '../../components/chatAssistant/variables';\nimport {\n  getHasAdminRight,\n  getPrivateChatUserId,\n  isChatChannel,\n  isChatSuperGroup,\n  isHistoryClearMessage,\n  isUserBot,\n  isUserId,\n  isUserOnline,\n} from '../helpers';\nimport { selectTabState } from './tabs';\nimport {\n  selectBot, selectIsCurrentUserPremium, selectUser, selectUserFullInfo,\n} from './users';\n\nexport function selectChat<T extends GlobalState>(global: T, chatId: string): ApiChat | undefined {\n  if (chatId === GLOBAL_SUMMARY_CHATID) {\n    return {\n      id: GLOBAL_SUMMARY_CHATID,\n      isSerena: true,\n      title: 'AI Serena',\n    } as ApiChat;\n  }\n  return global.chats.byId[chatId];\n}\n\nexport function selectChatFullInfo<T extends GlobalState>(global: T, chatId: string): ApiChatFullInfo | undefined {\n  return global.chats.fullInfoById[chatId];\n}\n\nexport function selectPeerFullInfo<T extends GlobalState>(global: T, peerId: string) {\n  if (isUserId(peerId)) return selectUserFullInfo(global, peerId);\n  return selectChatFullInfo(global, peerId);\n}\n\nexport function selectChatListLoadingParameters<T extends GlobalState>(\n  global: T, listType: ChatListType,\n) {\n  return global.chats.loadingParameters[listType];\n}\n\nexport function selectChatUser<T extends GlobalState>(global: T, chat: ApiChat) {\n  const userId = getPrivateChatUserId(chat);\n  if (!userId) {\n    return false;\n  }\n\n  return selectUser(global, userId);\n}\n\nexport function selectIsChatWithSelf<T extends GlobalState>(global: T, chatId: string) {\n  return chatId === global.currentUserId;\n}\n\nexport function selectIsChatWithBot<T extends GlobalState>(global: T, chat: ApiChat) {\n  const user = selectChatUser(global, chat);\n  return user && isUserBot(user);\n}\n\nexport function selectSupportChat<T extends GlobalState>(global: T) {\n  return Object.values(global.chats.byId).find(({ isSupport }: ApiChat) => isSupport);\n}\n\nexport function selectChatOnlineCount<T extends GlobalState>(global: T, chat: ApiChat) {\n  const fullInfo = selectChatFullInfo(global, chat.id);\n  if (isUserId(chat.id) || isChatChannel(chat) || !fullInfo) {\n    return undefined;\n  }\n\n  if (!fullInfo.members || fullInfo.members.length === MEMBERS_LOAD_SLICE) {\n    return fullInfo.onlineCount;\n  }\n\n  return fullInfo.members.reduce((onlineCount, { userId }) => {\n    if (\n      !selectIsChatWithSelf(global, userId)\n      && global.users.byId[userId]\n      && isUserOnline(global.users.byId[userId], global.users.statusesById[userId])\n    ) {\n      return onlineCount + 1;\n    }\n\n    return onlineCount;\n  }, 0);\n}\n\nexport function selectIsTrustedBot<T extends GlobalState>(global: T, botId: string) {\n  return global.trustedBotIds.includes(botId);\n}\n\nexport function selectChatType<T extends GlobalState>(global: T, chatId: string) : ApiChatType | undefined {\n  const bot = selectBot(global, chatId);\n  if (bot) {\n    return 'bots';\n  }\n\n  const user = selectUser(global, chatId);\n  if (user) {\n    return 'users';\n  }\n\n  const chat = selectChat(global, chatId);\n  if (!chat) return undefined;\n\n  if (isChatChannel(chat)) {\n    return 'channels';\n  }\n\n  return 'chats';\n}\n\nexport function selectIsChatBotNotStarted<T extends GlobalState>(global: T, chatId: string) {\n  const bot = selectBot(global, chatId);\n  if (!bot) {\n    return false;\n  }\n\n  const lastMessage = selectChatLastMessage(global, chatId);\n  if (lastMessage && isHistoryClearMessage(lastMessage)) {\n    return true;\n  }\n\n  return Boolean(!lastMessage);\n}\n\nexport function selectAreActiveChatsLoaded<T extends GlobalState>(global: T): boolean {\n  return Boolean(global.chats.listIds.active);\n}\n\nexport function selectIsChatListed<T extends GlobalState>(\n  global: T, chatId: string, type?: ChatListType,\n): boolean {\n  const { listIds } = global.chats;\n  if (type) {\n    const targetList = listIds[type];\n    return Boolean(targetList && targetList.includes(chatId));\n  }\n\n  return Object.values(listIds).some((list) => list && list.includes(chatId));\n}\n\nexport function selectChatListType<T extends GlobalState>(\n  global: T, chatId: string,\n): 'active' | 'archived' | undefined {\n  const chat = selectChat(global, chatId);\n  if (!chat || !selectIsChatListed(global, chatId)) {\n    return undefined;\n  }\n\n  return chat.folderId === ARCHIVED_FOLDER_ID ? 'archived' : 'active';\n}\n\nexport function selectChatFolder<T extends GlobalState>(global: T, folderId: number) {\n  return global.chatFolders.byId[folderId];\n}\n\nexport function selectTotalChatCount<T extends GlobalState>(global: T, listType: 'active' | 'archived'): number {\n  const { totalCount } = global.chats;\n  const allChatsCount = totalCount.all;\n  const archivedChatsCount = totalCount.archived || 0;\n\n  if (listType === 'archived') {\n    return archivedChatsCount;\n  }\n\n  return allChatsCount ? allChatsCount - archivedChatsCount : 0;\n}\n\nexport function selectIsChatPinned<T extends GlobalState>(\n  global: T, chatId: string, folderId = ALL_FOLDER_ID,\n): boolean {\n  const { active, archived, saved } = global.chats.orderedPinnedIds;\n\n  if (folderId === ALL_FOLDER_ID) {\n    return Boolean(active?.includes(chatId));\n  }\n\n  if (folderId === ARCHIVED_FOLDER_ID) {\n    return Boolean(archived?.includes(chatId));\n  }\n\n  if (folderId === SAVED_FOLDER_ID) {\n    return Boolean(saved?.includes(chatId));\n  }\n\n  const { byId: chatFoldersById } = global.chatFolders;\n\n  const { pinnedChatIds } = chatFoldersById[folderId] || {};\n  return Boolean(pinnedChatIds?.includes(chatId));\n}\n\n// Slow, not to be used in `withGlobal`\nexport function selectChatByUsername<T extends GlobalState>(global: T, username: string) {\n  const usernameLowered = username.toLowerCase();\n  return Object.values(global.chats.byId).find(\n    (chat) => chat.usernames?.some((c) => c.username.toLowerCase() === usernameLowered),\n  );\n}\n\nexport function selectIsServiceChatReady<T extends GlobalState>(global: T) {\n  return Boolean(selectChat(global, SERVICE_NOTIFICATIONS_USER_ID));\n}\n\nexport function selectSendAs<T extends GlobalState>(global: T, chatId: string) {\n  const chat = selectChat(global, chatId);\n  if (!chat) return undefined;\n\n  const id = selectChatFullInfo(global, chatId)?.sendAsId;\n  if (!id) return undefined;\n\n  return selectUser(global, id) || selectChat(global, id);\n}\n\nexport function selectRequestedDraft<T extends GlobalState>(\n  global: T, chatId: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { requestedDraft } = selectTabState(global, tabId);\n  if (requestedDraft?.chatId === chatId && !requestedDraft.files?.length) {\n    return requestedDraft.text;\n  }\n  return undefined;\n}\n\nexport function selectRequestedDraftFiles<T extends GlobalState>(\n  global: T, chatId: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { requestedDraft } = selectTabState(global, tabId);\n  if (requestedDraft?.chatId === chatId) {\n    return requestedDraft.files;\n  }\n  return undefined;\n}\n\nexport function filterChatIdsByType<T extends GlobalState>(\n  global: T, chatIds: string[], filter: readonly ApiChatType[],\n) {\n  return chatIds.filter((id) => {\n    const type = selectChatType(global, id);\n    if (!type) {\n      return false;\n    }\n    return filter.includes(type);\n  });\n}\n\nexport function selectCanInviteToChat<T extends GlobalState>(global: T, chatId: string) {\n  const chat = selectChat(global, chatId);\n  if (!chat) return false;\n\n  // https://github.com/TelegramMessenger/Telegram-iOS/blob/5126be83b3b9578fb014eb52ca553da9e7a8b83a/submodules/TelegramCore/Sources/TelegramEngine/Peers/Communities.swift#L6\n  return !chat.migratedTo && Boolean(!isUserId(chatId) && ((isChatChannel(chat) || isChatSuperGroup(chat)) ? (\n    chat.isCreator || getHasAdminRight(chat, 'inviteUsers')\n    || (chat.usernames?.length && !chat.isJoinRequest)\n  ) : (chat.isCreator || getHasAdminRight(chat, 'inviteUsers'))));\n}\n\nexport function selectCanShareFolder<T extends GlobalState>(global: T, folderId: number) {\n  const folder = selectChatFolder(global, folderId);\n  if (!folder) return false;\n\n  const {\n    bots, groups, channels, contacts, nonContacts, includedChatIds, pinnedChatIds,\n    excludeArchived, excludeMuted, excludeRead, excludedChatIds,\n  } = folder;\n\n  return !bots && !groups && !channels && !contacts && !nonContacts\n    && !excludeArchived && !excludeMuted && !excludeRead && !excludedChatIds?.length\n    && (pinnedChatIds?.length || includedChatIds.length)\n    && folder.includedChatIds.concat(folder.pinnedChatIds || []).some((chatId) => {\n      return selectCanInviteToChat(global, chatId);\n    });\n}\n\nexport function selectShouldDetectChatLanguage<T extends GlobalState>(\n  global: T, chatId: string,\n) {\n  // const { autoTranslate } = global.settings.byKey;\n  // return autoTranslate;\n  const chat = selectChat(global, chatId);\n  if (!chat) return false;\n  const { canTranslateChats } = global.settings.byKey;\n\n  const isPremium = selectIsCurrentUserPremium(global);\n  const isSavedMessages = selectIsChatWithSelf(global, chatId);\n\n  return IS_TRANSLATION_SUPPORTED && canTranslateChats && isPremium && !isSavedMessages;\n}\n\nexport function selectCanTranslateChat<T extends GlobalState>(\n  global: T, chatId: string, ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const chat = selectChat(global, chatId);\n  if (!chat) return false;\n  const requestedTranslation = selectRequestedChatTranslationLanguage(global, chatId, tabId);\n  if (requestedTranslation) return true; // Prevent translation dropping on reevaluation\n\n  const isLanguageDetectable = selectShouldDetectChatLanguage(global, chatId);\n  const detectedLanguage = chat.detectedLanguage;\n\n  const { doNotTranslate } = global.settings.byKey;\n\n  return Boolean(isLanguageDetectable && detectedLanguage && !doNotTranslate.includes(detectedLanguage));\n}\n\nexport function selectRequestedChatTranslationLanguage<T extends GlobalState>(\n  global: T, chatId: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { requestedTranslations } = selectTabState(global, tabId);\n\n  return requestedTranslations.byChatId[chatId]?.toLanguage;\n}\n\nexport function selectSimilarChannelIds<T extends GlobalState>(\n  global: T,\n  chatId: string,\n) {\n  return global.chats.similarChannelsById[chatId];\n}\n\nexport function selectSimilarBotsIds<T extends GlobalState>(\n  global: T,\n  chatId: string,\n) {\n  return global.chats.similarBotsById[chatId];\n}\n\nexport function selectChatLastMessageId<T extends GlobalState>(\n  global: T, chatId: string, listType: 'all' | 'saved' = 'all',\n) {\n  return global.chats.lastMessageIds[listType]?.[chatId];\n}\n\nexport function selectChatLastMessage<T extends GlobalState>(\n  global: T, chatId: string, listType: 'all' | 'saved' = 'all',\n) {\n  const id = selectChatLastMessageId(global, chatId, listType);\n  if (!id) return undefined;\n\n  const realChatId = listType === 'saved' ? global.currentUserId! : chatId;\n  return global.messages.byChatId[realChatId]?.byId[id];\n}\n","/// In seconds\nexport const MINUTE = 60;\nexport const HOUR = 3600;\nexport const DAY = 86400;\n\nexport function getMinutes(seconds: number, roundDown?: boolean) {\n  const roundFunc = roundDown ? Math.floor : Math.ceil;\n  return roundFunc(seconds / MINUTE);\n}\n\nexport function getHours(seconds: number, roundDown?: boolean) {\n  const roundFunc = roundDown ? Math.floor : Math.ceil;\n  return roundFunc(seconds / HOUR);\n}\n\nexport function getDays(seconds: number, roundDown?: boolean) {\n  const roundFunc = roundDown ? Math.floor : Math.ceil;\n  return roundFunc(seconds / DAY);\n}\n\nexport function getSeconds(hours: number, minutes: number, seconds: number) {\n  return hours * HOUR + minutes * MINUTE + seconds;\n}\n","import { useRef } from '../lib/teact/teact';\n\nimport useSyncEffect from './useSyncEffect';\n\nconst useLayoutEffectWithPrevDeps = <const T extends readonly any[]>(\n  cb: (args: T | readonly []) => void, dependencies: T,\n) => {\n  const prevDepsRef = useRef<T>();\n\n  return useSyncEffect(() => {\n    const prevDeps = prevDepsRef.current;\n    prevDepsRef.current = dependencies;\n\n    return cb(prevDeps || []);\n    // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  }, dependencies);\n};\n\nexport default useLayoutEffectWithPrevDeps;\n","import type { RefObject } from '../lib/teact/teact';\nimport { useLayoutEffect, useRef, useSignal } from '../lib/teact/teact';\nimport { addExtraClass, toggleExtraClass } from '../lib/teact/teact-dom';\n\nimport type { Signal } from '../util/signals';\n\nimport { requestMeasure } from '../lib/fasterdom/fasterdom';\nimport useDerivedSignal from './useDerivedSignal';\nimport useDerivedState from './useDerivedState';\nimport useLastCallback from './useLastCallback';\nimport { useStateRef } from './useStateRef';\nimport useSyncEffect from './useSyncEffect';\nimport useSyncEffectWithPrevDeps from './useSyncEffectWithPrevDeps';\n\nconst CLOSE_DURATION = 350;\n\ntype BaseHookParams<RefType extends HTMLElement> = {\n  isOpen: boolean | undefined;\n  ref?: RefObject<RefType | null>;\n  noMountTransition?: boolean;\n  noOpenTransition?: boolean;\n  noCloseTransition?: boolean;\n  closeDuration?: number;\n  className?: string | false;\n  prefix?: string;\n  shouldForceOpen?: boolean;\n  onCloseAnimationEnd?: NoneToVoidFunction;\n};\n\nexport type HookParams<RefType extends HTMLElement> = BaseHookParams<RefType> & {\n  withShouldRender?: never;\n};\n\ntype HookParamsWithShouldRender<RefType extends HTMLElement> = BaseHookParams<RefType> & {\n  withShouldRender: true;\n};\n\ntype HookResult<RefType extends HTMLElement> = {\n  ref: RefObject<RefType | null>;\n  getIsClosing: Signal<boolean>;\n};\n\ntype HookResultWithShouldRender<RefType extends HTMLElement> = HookResult<RefType> & {\n  shouldRender: boolean;\n};\n\ntype State =\n  'closed'\n  | 'scheduled-open'\n  | 'open'\n  | 'closing';\n\nexport default function useShowTransition<RefType extends HTMLElement = HTMLDivElement>(\n  params: HookParams<RefType>\n): HookResult<RefType>;\nexport default function useShowTransition<RefType extends HTMLElement = HTMLDivElement>(\n  params: HookParamsWithShouldRender<RefType>\n): HookResultWithShouldRender<RefType>;\nexport default function useShowTransition<RefType extends HTMLElement = HTMLDivElement>(\n  params: HookParams<RefType> | HookParamsWithShouldRender<RefType>,\n): HookResult<RefType> | HookResultWithShouldRender<RefType> {\n  const {\n    isOpen,\n    noMountTransition = false,\n    noOpenTransition = false,\n    noCloseTransition = false,\n    closeDuration = CLOSE_DURATION,\n    className = 'fast',\n    prefix = '',\n    shouldForceOpen,\n    onCloseAnimationEnd,\n  } = params;\n\n  // eslint-disable-next-line no-null/no-null\n  const localRef = useRef<RefType>(null);\n  const ref = params.ref || localRef;\n  const closingTimeoutRef = useRef<number>();\n  const [getState, setState] = useSignal<State | undefined>();\n  const optionsRef = useStateRef({\n    closeDuration, noMountTransition, noOpenTransition, noCloseTransition,\n  });\n  const onCloseEndLast = useLastCallback(onCloseAnimationEnd);\n\n  useSyncEffectWithPrevDeps(([prevIsOpen]) => {\n    const options = optionsRef.current;\n\n    if (shouldForceOpen) {\n      setState('open');\n      return;\n    }\n\n    if (isOpen) {\n      if (closingTimeoutRef.current) {\n        clearTimeout(closingTimeoutRef.current);\n        closingTimeoutRef.current = undefined;\n      }\n\n      if (options.noOpenTransition || (prevIsOpen === undefined && options.noMountTransition)) {\n        setState('open');\n      } else {\n        setState('scheduled-open');\n        requestMeasure(() => {\n          setState('open');\n        });\n      }\n    } else if (prevIsOpen === undefined || options.noCloseTransition) {\n      setState('closed');\n    } else {\n      setState('closing');\n\n      closingTimeoutRef.current = window.setTimeout(() => {\n        setState('closed');\n        onCloseEndLast();\n      }, options.closeDuration);\n    }\n  }, [isOpen, shouldForceOpen]);\n\n  const applyClassNames = useLastCallback(() => {\n    const element = ref.current;\n    if (!element) return;\n\n    if (className !== false) {\n      addExtraClass(element, 'opacity-transition');\n      addExtraClass(element, className);\n    }\n\n    const state = getState();\n    const shouldRender = state !== 'closed';\n    const hasOpenClass = state === 'open';\n    const isClosing = state === 'closing';\n\n    toggleExtraClass(element, `${prefix}shown`, shouldRender);\n    toggleExtraClass(element, `${prefix}not-shown`, !shouldRender);\n    toggleExtraClass(element, `${prefix}open`, hasOpenClass);\n    toggleExtraClass(element, `${prefix}not-open`, !hasOpenClass);\n    toggleExtraClass(element, `${prefix}closing`, isClosing);\n  });\n\n  // Workaround for Chrome causing forced reflow in the middle of mutation phase when unmounting a focused element.\n  // Due to such forced reflow setting initial class names in the first layout effect causes transitions to start.\n  useSyncEffect(() => {\n    ref.onChange = () => {\n      ref.onChange = undefined;\n      applyClassNames();\n    };\n  }, [applyClassNames, ref]);\n\n  useLayoutEffect(applyClassNames, [applyClassNames, getState]);\n\n  const withShouldRender = 'withShouldRender' in params && params.withShouldRender;\n  const shouldRender = useDerivedState(\n    () => (withShouldRender && getState() !== 'closed'),\n    [withShouldRender, getState],\n  );\n\n  const getIsClosing = useDerivedSignal(() => getState() === 'closing', [getState]);\n\n  if (withShouldRender) {\n    return { ref, shouldRender, getIsClosing };\n  }\n\n  return { ref, getIsClosing };\n}\n","import type { PerformanceType } from '../types';\n\nexport function applyPerformanceSettings(performanceType: PerformanceType) {\n  const {\n    pageTransitions,\n    messageSendingAnimations,\n    mediaViewerAnimations,\n    messageComposerAnimations,\n    contextMenuAnimations,\n    contextMenuBlur,\n    rightColumnAnimations,\n  } = performanceType;\n\n  const root = document.body;\n\n  root.classList.toggle('no-page-transitions', !pageTransitions);\n  root.classList.toggle('no-message-sending-animations', !messageSendingAnimations);\n  root.classList.toggle('no-media-viewer-animations', !mediaViewerAnimations);\n  root.classList.toggle('no-message-composer-animations', !messageComposerAnimations);\n  root.classList.toggle('no-context-menu-animations', !contextMenuAnimations);\n  root.classList.toggle('no-menu-blur', !contextMenuBlur);\n  root.classList.toggle('no-right-column-animations', !rightColumnAnimations);\n}\n","import type { CallbackManager } from './callbacks';\n\nimport { createCallbackManager } from './callbacks';\n\ninterface SignalState<T> {\n  value: T;\n  effects: CallbackManager;\n}\n\nconst SIGNAL_MARK = Symbol('SIGNAL_MARK');\n\nexport type Signal<T = any> = ((() => T) & {\n  readonly [SIGNAL_MARK]: symbol;\n  subscribe: (cb: AnyToVoidFunction) => NoneToVoidFunction;\n  once: (cb: AnyToVoidFunction) => NoneToVoidFunction;\n});\n\nexport type SignalSetter = (newValue: any) => void;\n\nexport function isSignal(obj: any): obj is Signal {\n  return typeof obj === 'function' && SIGNAL_MARK in obj;\n}\n\n// A shorthand to unsubscribe effect from all signals\nconst unsubscribesByEffect = new Map<NoneToVoidFunction, Set<NoneToVoidFunction>>();\n\nlet currentEffect: NoneToVoidFunction | undefined;\n\nexport function createSignal<T>(defaultValue?: T) {\n  const state: SignalState<typeof defaultValue> = {\n    value: defaultValue,\n    effects: createCallbackManager(),\n  };\n\n  function subscribe(effect: NoneToVoidFunction) {\n    const unsubscribe = state.effects.addCallback(effect);\n\n    if (!unsubscribesByEffect.has(effect)) {\n      unsubscribesByEffect.set(effect, new Set([unsubscribe]));\n    } else {\n      unsubscribesByEffect.get(effect)!.add(unsubscribe);\n    }\n\n    return () => {\n      unsubscribe();\n\n      const unsubscribes = unsubscribesByEffect.get(effect)!;\n      unsubscribes.delete(unsubscribe);\n      if (!unsubscribes.size) {\n        unsubscribesByEffect.delete(effect);\n      }\n    };\n  }\n\n  function once(effect: NoneToVoidFunction) {\n    const unsub = subscribe(() => {\n      unsub();\n      effect();\n    });\n\n    return unsub;\n  }\n\n  function getter() {\n    if (currentEffect) {\n      subscribe(currentEffect);\n    }\n\n    return state.value;\n  }\n\n  function setter(newValue: T) {\n    if (state.value === newValue) {\n      return;\n    }\n\n    state.value = newValue;\n    state.effects.runCallbacks();\n  }\n\n  const signal = Object.assign(getter as Signal<T>, {\n    [SIGNAL_MARK]: SIGNAL_MARK,\n    subscribe,\n    once,\n  });\n\n  return [signal, setter] as const;\n}\n\nexport function cleanupEffect(effect: NoneToVoidFunction) {\n  unsubscribesByEffect.get(effect)?.forEach((unsubscribe) => {\n    unsubscribe();\n  });\n  unsubscribesByEffect.delete(effect);\n}\n","/* eslint-disable no-null/no-null */\n/* eslint-disable no-console */\nimport type { Message } from 'ai';\n\nimport type { StoreName } from './chatai-store';\nimport type ChataiDB from './chatai-store';\n\nexport interface SummaryStoreMessage extends Message {\n  timestamp: number;\n}\nclass SummaryStore {\n  private storeName: StoreName = 'summary';\n\n  private db: IDBDatabase | null = null;\n\n  private chataiStoreManager:ChataiDB;\n\n  constructor(private dbManager: ChataiDB) {\n    this.db = dbManager.db;\n    this.chataiStoreManager = dbManager;\n  }\n\n  async storeMessage(message: SummaryStoreMessage): Promise<void> {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding contact:', error);\n      return;\n    }\n\n    const transaction = db.transaction([this.storeName], 'readwrite');\n    const store = transaction.objectStore(this.storeName);\n\n    const request = store.put(message);\n\n    request.onsuccess = () => {\n      console.log(`Message ${message.id} stored successfully`);\n    };\n\n    request.onerror = (event: Event) => {\n      console.error(\n        `Error storing message ${message.id}:`,\n        (event.target as IDBRequest).error,\n      );\n    };\n  }\n\n  async storeMessages(messages: SummaryStoreMessage[]): Promise<void> {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding contact:', error);\n      return;\n    }\n\n    const transaction = db.transaction([this.storeName], 'readwrite');\n    const store = transaction.objectStore(this.storeName);\n\n    messages.forEach((message) => {\n      const request = store.put(message);\n\n      request.onsuccess = () => {\n        console.log(`Message ${message.id} stored successfully`);\n      };\n\n      request.onerror = (event: Event) => {\n        console.error(\n          `Error storing message ${message.id}:`,\n          (event.target as IDBRequest).error,\n        );\n      };\n    });\n\n    transaction.oncomplete = () => {\n      console.log('All messages stored successfully');\n    };\n\n    transaction.onerror = (event: Event) => {\n      console.error(\n        'Error storing messages:',\n        (event.target as IDBRequest).error,\n      );\n    };\n  }\n\n  /** 📌 分页查询某个房间的消息（按 `time` 倒序） */\n  async getMessages(\n    lastTime: number | undefined,\n    pageSize: number,\n  ): Promise<{ messages: any[]; lastTime: number | undefined ;hasMore:boolean }> {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding contact:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readonly');\n      const store = tx.objectStore(this.storeName);\n      const index = store.index('timestamp');\n\n      // 🔥 查询指定房间的消息，按 `time` 倒序\n      const range = lastTime !== undefined\n        ? IDBKeyRange.bound(0, lastTime, false, true) // 从 lastTime 之前查\n        : IDBKeyRange.bound(0, Number.MAX_SAFE_INTEGER); // 查询全部\n\n      const request = index.openCursor(range, 'prev'); // 🔥 逆序取数据\n      const messages: any[] = [];\n      let count = 0;\n      let newLastTime: number | undefined;\n\n      request.onsuccess = (event) => {\n        const cursor = (event.target as IDBRequest).result;\n        if (cursor && count < pageSize) {\n          messages.unshift(cursor.value);\n          newLastTime = cursor.value.timestamp; // 记录最后一条的时间\n          count++;\n          cursor.continue();\n        } else {\n          resolve({ messages, lastTime: newLastTime, hasMore: count === pageSize });\n        }\n      };\n\n      request.onerror = () => reject(new Error('Failed to fetch messages'));\n    });\n  }\n\n  async getAllMessages(): Promise<SummaryStoreMessage[]> {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding contact:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readonly');\n      const store = tx.objectStore(this.storeName);\n      const request = store.getAll();\n\n      request.onsuccess = () => {\n        resolve(request.result);\n      };\n      request.onerror = () => reject(new Error('Failed to fetch messages'));\n    });\n  }\n\n  async delMessage(id: string): Promise<void> {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding contact:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readwrite');\n      const store = tx.objectStore(this.storeName);\n      const request = store.delete(id);\n\n      request.onsuccess = () => {\n        console.log(`Deleted record with key: ${id}`);\n        resolve();\n      };\n      request.onerror = () => reject(new Error('Failed to delete record'));\n    });\n  }\n}\n\nexport function parseMessage2SummaryStoreMessage(\n  messages: Message[],\n): SummaryStoreMessage[] {\n  const copyedMessages = JSON.parse(JSON.stringify(messages));\n  copyedMessages.forEach((message: Message) => {\n    (message as SummaryStoreMessage).timestamp = new Date(\n      message.createdAt as Date,\n    ).getTime();\n  });\n  return copyedMessages as SummaryStoreMessage[];\n}\n\nexport function parseSummaryStoreMessage2Message(messages: SummaryStoreMessage[]): Message[] {\n  const copyedMessages = JSON.parse(JSON.stringify(messages));\n  copyedMessages.forEach((message: SummaryStoreMessage) => {\n    delete (message as any).timestamp;\n  });\n  return copyedMessages as Message[];\n}\n\nexport default SummaryStore;\n","import type { FC } from '../../lib/teact/teact';\nimport React, {\n  useCallback, useMemo, useRef, useState,\n} from '../../lib/teact/teact';\n\nimport Icon from '../common/icons/Icon';\nimport Button from './Button';\nimport Menu from './Menu';\n\nimport './DropdownMenu.scss';\n\ntype OwnProps = {\n  className?: string;\n  bubbleClassName?: string;\n  trigger?: FC<{ onTrigger: () => void; isOpen?: boolean }>;\n  transformOriginX?: number;\n  transformOriginY?: number;\n  positionX?: 'left' | 'right';\n  positionY?: 'top' | 'bottom';\n  footer?: string;\n  forceOpen?: boolean;\n  onOpen?: NoneToVoidFunction;\n  onClose?: NoneToVoidFunction;\n  onHide?: NoneToVoidFunction;\n  onTransitionEnd?: NoneToVoidFunction;\n  onMouseEnterBackdrop?: (e: React.MouseEvent<HTMLDivElement, MouseEvent>) => void;\n  children: React.ReactNode;\n  autoClose?: boolean;\n};\n\nconst DropdownMenu: FC<OwnProps> = ({\n  trigger,\n  className,\n  bubbleClassName,\n  children,\n  transformOriginX,\n  transformOriginY,\n  positionX = 'left',\n  positionY = 'top',\n  footer,\n  forceOpen,\n  onOpen,\n  onClose,\n  onTransitionEnd,\n  onMouseEnterBackdrop,\n  onHide,\n  autoClose = true,\n}) => {\n  // eslint-disable-next-line no-null/no-null\n  const menuRef = useRef<HTMLDivElement>(null);\n  const [isOpen, setIsOpen] = useState(false);\n\n  const toggleIsOpen = () => {\n    setIsOpen(!isOpen);\n\n    if (isOpen) {\n      onClose?.();\n    } else {\n      onOpen?.();\n    }\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent<any>) => {\n    const menu = menuRef.current;\n\n    if (!isOpen || e.keyCode !== 40 || !menu) {\n      return;\n    }\n\n    const focusedElement = document.activeElement;\n    const elementChildren = Array.from(menu.children);\n\n    if (!focusedElement || elementChildren.indexOf(focusedElement) === -1) {\n      (elementChildren[0] as HTMLElement).focus();\n    }\n  };\n\n  const handleClose = useCallback(() => {\n    setIsOpen(false);\n    onClose?.();\n  }, [onClose]);\n\n  const triggerComponent: FC<{ onTrigger: () => void; isOpen?: boolean }> = useMemo(() => {\n    if (trigger) return trigger;\n\n    return ({ onTrigger, isOpen: isMenuOpen }) => (\n      <Button\n        round\n        size=\"smaller\"\n        color=\"translucent\"\n        className={isMenuOpen ? 'active' : ''}\n        onClick={onTrigger}\n        ariaLabel=\"More actions\"\n      >\n        <Icon name=\"more\" />\n      </Button>\n    );\n  }, [trigger]);\n\n  return (\n    <div\n      className={`DropdownMenu ${className || ''}`}\n      onKeyDown={handleKeyDown}\n      onTransitionEnd={onTransitionEnd}\n    >\n      {triggerComponent({ onTrigger: toggleIsOpen, isOpen })}\n\n      <Menu\n        ref={menuRef}\n        isOpen={isOpen || Boolean(forceOpen)}\n        className={className || ''}\n        bubbleClassName={bubbleClassName || ''}\n        transformOriginX={transformOriginX}\n        transformOriginY={transformOriginY}\n        positionX={positionX}\n        positionY={positionY}\n        footer={footer}\n        autoClose={autoClose}\n        onClose={handleClose}\n        onCloseAnimationEnd={onHide}\n        onMouseEnterBackdrop={onMouseEnterBackdrop}\n      >\n        {children}\n      </Menu>\n    </div>\n  );\n};\n\nexport default DropdownMenu;\n","import type { RefObject } from 'react';\nimport { useEffect } from '../lib/teact/teact';\n\nimport { hasActiveViewTransition } from './animations/useViewTransition';\n\nconst BACKDROP_CLASSNAME = 'backdrop';\n\n// This effect implements closing menus by clicking outside of them\n// without adding extra elements to the DOM\nexport default function useVirtualBackdrop(\n  isOpen: boolean,\n  containerRef: RefObject<HTMLElement>,\n  onClose?: () => void | undefined,\n  ignoreRightClick?: boolean,\n  excludedClosestSelector?: string,\n) {\n  useEffect(() => {\n    if (!isOpen || !onClose) {\n      return undefined;\n    }\n\n    const handleEvent = (e: MouseEvent) => {\n      const container = containerRef.current;\n      const target = e.target as HTMLElement | null;\n      if (!container || !target || (ignoreRightClick && e.button === 2) || hasActiveViewTransition()) {\n        return;\n      }\n\n      if ((\n        !container.contains(e.target as Node | null)\n        || target.classList.contains(BACKDROP_CLASSNAME)\n      ) && !(excludedClosestSelector && (\n        target.matches(excludedClosestSelector) || target.closest(excludedClosestSelector)\n      ))) {\n        e.preventDefault();\n        e.stopPropagation();\n        onClose?.();\n      }\n    };\n\n    document.addEventListener('mousedown', handleEvent);\n\n    return () => {\n      document.removeEventListener('mousedown', handleEvent);\n    };\n  }, [excludedClosestSelector, ignoreRightClick, isOpen, containerRef, onClose]);\n}\n","import { useMemo } from '../lib/teact/teact';\nimport { getGlobal } from '../global';\n\nimport type { ApiThumbnail, MediaContainer } from '../api/types';\n\nimport { getMessageMediaThumbDataUri } from '../global/helpers';\nimport { selectTheme } from '../global/selectors';\n\nexport default function useThumbnail(media?: MediaContainer | ApiThumbnail) {\n  const isMediaContainer = media && 'content' in media;\n  const thumbDataUri = isMediaContainer ? getMessageMediaThumbDataUri(media) : media?.dataUri;\n\n  // TODO Find a way to update thumbnail on theme change\n  const theme = selectTheme(getGlobal());\n\n  const dataUri = useMemo(() => {\n    const uri = thumbDataUri;\n    if (!uri || theme !== 'dark') return uri;\n\n    return uri.replace('<svg', '<svg fill=\"white\"');\n  }, [thumbDataUri, theme]);\n\n  return dataUri;\n}\n","export function areDeepEqual<T extends any>(value1: T, value2: T): boolean {\n  const type1 = typeof value1;\n  const type2 = typeof value2;\n  if (type1 !== type2) {\n    return false;\n  }\n\n  // eslint-disable-next-line no-null/no-null\n  if (type1 !== 'object' || value1 === null || value2 === null) {\n    return value1 === value2;\n  }\n\n  const isArray1 = Array.isArray(value1);\n  const isArray2 = Array.isArray(value2);\n\n  if (isArray1 !== isArray2) {\n    return false;\n  }\n\n  if (isArray1) {\n    const array1 = value1 as any[];\n    const array2 = value2 as any[];\n\n    if (array1.length !== array2.length) {\n      return false;\n    }\n\n    return array1.every((member1, i) => areDeepEqual(member1, array2[i]));\n  }\n\n  const object1 = value1 as AnyLiteral;\n  const object2 = value2 as AnyLiteral;\n  const keys1 = Object.keys(object1);\n\n  return keys1.length === Object.keys(object2).length\n    && keys1.every((key1) => areDeepEqual(object1[key1], object2[key1]));\n}\n","import EMOJI_REGEX from '../../lib/twemojiRegex';\n\n// Non-standard variations of emojis, used on some devices\nconst EMOJI_EXCEPTIONS: [string | RegExp, string][] = [\n  [/\\u{1f3f3}\\u200d\\u{1f308}/gu, '\\u{1f3f3}\\ufe0f\\u200d\\u{1f308}'], // 🏳‍🌈\n  [/\\u{1f3f3}\\u200d\\u26a7\\ufe0f?/gu, '\\u{1f3f3}\\ufe0f\\u200d\\u26a7\\ufe0f'], // 🏳️‍⚧️\n  [/\\u26d3\\u200d\\u{1f4a5}/gu, '\\u26d3\\ufe0f\\u200d\\u{1f4a5}'], // ⛓‍💥\n  [/\\u200d([\\u2640\\u2642])(?!\\ufe0f)/gu, '\\u200d$1\\ufe0f'], // Gender variation without 0xFE0F\n];\n\nexport default function fixNonStandardEmoji(text: string) {\n  // Non-standard sequences typically parsed as separate emojis, so no need to fix text without any\n  if (!text.match(EMOJI_REGEX)) return text;\n  // eslint-disable-next-line no-restricted-syntax\n  for (const [regex, replacement] of EMOJI_EXCEPTIONS) {\n    text = text.replace(regex, replacement);\n  }\n\n  return text;\n}\n","import type { FC } from '../../lib/teact/teact';\nimport React from '../../lib/teact/teact';\n\nimport type { IconName } from '../../types/icons';\n\nimport { IS_TEST } from '../../config';\nimport buildClassName from '../../util/buildClassName';\n\nimport useAppLayout from '../../hooks/useAppLayout';\nimport useLastCallback from '../../hooks/useLastCallback';\nimport useOldLang from '../../hooks/useOldLang';\n\nimport Icon from '../common/icons/Icon';\n\nimport './MenuItem.scss';\n\nexport type MenuItemProps = {\n  customIcon?: React.ReactNode;\n  className?: string;\n  children: React.ReactNode;\n  onClick?: (e: React.SyntheticEvent<HTMLDivElement | HTMLAnchorElement>, arg?: number) => void;\n  clickArg?: number;\n  onContextMenu?: (e: React.UIEvent) => void;\n  href?: string;\n  rel?: string;\n  target?: string;\n  download?: string;\n  disabled?: boolean;\n  destructive?: boolean;\n  ariaLabel?: string;\n  withWrap?: boolean;\n  withPreventDefaultOnMouseDown?: boolean;\n} & ({\n  icon: 'A' | 'K';\n  isCharIcon: true;\n} | {\n  icon?: IconName;\n  isCharIcon?: false;\n});\n\nconst MenuItem: FC<MenuItemProps> = (props) => {\n  const {\n    icon,\n    isCharIcon,\n    customIcon,\n    className,\n    children,\n    onClick,\n    href,\n    target,\n    download,\n    disabled,\n    destructive,\n    ariaLabel,\n    withWrap,\n    rel = 'noopener noreferrer',\n    onContextMenu,\n    clickArg,\n    withPreventDefaultOnMouseDown,\n  } = props;\n\n  const lang = useOldLang();\n  const { isTouchScreen } = useAppLayout();\n  const handleClick = useLastCallback((e: React.MouseEvent<HTMLDivElement>) => {\n    if (disabled || !onClick) {\n      e.preventDefault();\n      return;\n    }\n    onClick(e, clickArg);\n  });\n\n  const handleKeyDown = useLastCallback((e: React.KeyboardEvent<HTMLDivElement>) => {\n    if (e.keyCode !== 13 && e.keyCode !== 32) {\n      return;\n    }\n\n    if (disabled || !onClick) {\n      e.preventDefault();\n\n      return;\n    }\n    onClick(e, clickArg);\n  });\n  const handleMouseDown = useLastCallback((e: React.SyntheticEvent<HTMLDivElement | HTMLAnchorElement>) => {\n    if (withPreventDefaultOnMouseDown) {\n      e.preventDefault();\n    }\n  });\n\n  const fullClassName = buildClassName(\n    'MenuItem',\n    className,\n    disabled && 'disabled',\n    destructive && 'destructive',\n    !isTouchScreen && 'compact',\n    withWrap && 'wrap',\n  );\n\n  const content = (\n    <>\n      {!customIcon && icon && (\n        <Icon name={isCharIcon ? 'char' : icon} character={isCharIcon ? icon : undefined} />\n      )}\n      {customIcon}\n      {children}\n    </>\n  );\n\n  if (href && !disabled) {\n    return (\n      <a\n        tabIndex={0}\n        className={fullClassName}\n        href={href}\n        download={download}\n        aria-label={ariaLabel}\n        title={ariaLabel}\n        target={target || (href.startsWith(window.location.origin) || IS_TEST ? '_self' : '_blank')}\n        rel={rel}\n        dir={lang.isRtl ? 'rtl' : undefined}\n        onClick={onClick}\n        onMouseDown={handleMouseDown}\n      >\n        {content}\n      </a>\n    );\n  }\n\n  return (\n    <div\n      role=\"menuitem\"\n      tabIndex={0}\n      className={fullClassName}\n      onClick={handleClick}\n      onKeyDown={handleKeyDown}\n      onMouseDown={handleMouseDown}\n      onContextMenu={onContextMenu}\n      aria-label={ariaLabel}\n      title={ariaLabel}\n      dir={lang.isRtl ? 'rtl' : undefined}\n    >\n      {content}\n    </div>\n  );\n};\n\nexport default MenuItem;\n","import type { ThreadId } from '../../types';\n\nexport function buildChatThreadKey(chatId: string, threadId: ThreadId) {\n  return `${chatId}_${threadId}`;\n}\n","import { getAverageColor, getColorLuma } from './colors';\n\nconst LUMA_THRESHOLD = 240;\n\nexport function scaleImage(image: string | Blob, ratio: number, outputType: string = 'image/png'): Promise<string> {\n  const url = image instanceof Blob ? URL.createObjectURL(image) : image;\n  const img = new Image();\n  return new Promise((resolve) => {\n    img.onload = () => {\n      scale(img, img.width * ratio, img.height * ratio, outputType)\n        .then((blob) => {\n          if (!blob) throw new Error('Image resize failed!');\n          return URL.createObjectURL(blob);\n        })\n        .then(resolve)\n        .finally(() => {\n          if (image instanceof Blob) {\n            URL.revokeObjectURL(url); // Revoke blob url that we created\n          }\n        });\n    };\n    img.src = url;\n  });\n}\n\nexport function resizeImage(\n  image: string | Blob, width: number, height: number, outputType: string = 'image/png',\n): Promise<string> {\n  const url = image instanceof Blob ? URL.createObjectURL(image) : image;\n  const img = new Image();\n  return new Promise((resolve) => {\n    img.onload = () => {\n      scale(img, width, height, outputType)\n        .then((blob) => {\n          if (!blob) throw new Error('Image resize failed!');\n          return URL.createObjectURL(blob);\n        })\n        .then(resolve)\n        .finally(() => {\n          if (image instanceof Blob) {\n            URL.revokeObjectURL(url); // Revoke blob url that we created\n          }\n        });\n    };\n    img.src = url;\n  });\n}\n\nasync function scale(\n  img: HTMLImageElement, width: number, height: number, outputType: string = 'image/png',\n): Promise<Blob | null> {\n  // Safari does not have built-in resize method with quality control\n  if ('createImageBitmap' in window) {\n    try {\n      const bitmap = await window.createImageBitmap(img,\n        { resizeWidth: width, resizeHeight: height, resizeQuality: 'high' });\n      if (bitmap.height !== height || bitmap.width !== width) {\n        throw new Error('Image bitmap resize not supported!'); // FF93 added support for options, but not resize\n      }\n      const averageColor = await getAverageColor(img.src);\n      const fillColor = getColorLuma(averageColor) < LUMA_THRESHOLD ? '#fff' : '#000';\n      return await new Promise((res) => {\n        const canvas = document.createElement('canvas');\n        canvas.width = bitmap.width;\n        canvas.height = bitmap.height;\n        const ctx2D = canvas.getContext('2d')!;\n        ctx2D.fillStyle = fillColor;\n        ctx2D.fillRect(0, 0, canvas.width, canvas.height);\n        const ctx = canvas.getContext('bitmaprenderer');\n        if (ctx) {\n          ctx.transferFromImageBitmap(bitmap);\n        } else {\n          ctx2D.drawImage(bitmap, 0, 0);\n        }\n        canvas.toBlob(res, outputType);\n      });\n    } catch (e) {\n      // Fallback. Firefox below 93 does not recognize `createImageBitmap` with 2 parameters\n      return steppedScale(img, width, height, undefined, outputType);\n    }\n  } else {\n    return steppedScale(img, width, height, undefined, outputType);\n  }\n}\n\nasync function steppedScale(\n  img: HTMLImageElement, width: number, height: number, step: number = 0.5, outputType: string = 'image/png',\n): Promise<Blob | null> {\n  const canvas = document.createElement('canvas');\n  const ctx = canvas.getContext('2d')!;\n  const oc = document.createElement('canvas');\n  const octx = oc.getContext('2d')!;\n\n  canvas.width = width;\n  canvas.height = height;\n\n  if (img.width * step > width) { // For performance avoid unnecessary drawing\n    const mul = 1 / step;\n    let cur = {\n      width: Math.floor(img.width * step),\n      height: Math.floor(img.height * step),\n    };\n\n    oc.width = cur.width;\n    oc.height = cur.height;\n\n    octx.drawImage(img, 0, 0, cur.width, cur.height);\n\n    while (cur.width * step > width) {\n      cur = {\n        width: Math.floor(cur.width * step),\n        height: Math.floor(cur.height * step),\n      };\n      octx.drawImage(oc, 0, 0, cur.width * mul, cur.height * mul, 0, 0, cur.width, cur.height);\n    }\n\n    ctx.drawImage(oc, 0, 0, cur.width, cur.height, 0, 0, canvas.width, canvas.height);\n  } else {\n    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n  }\n\n  const averageColor = await getAverageColor(img.src);\n  const fillColor = getColorLuma(averageColor) < LUMA_THRESHOLD ? '#fff' : '#000';\n  ctx.fillStyle = fillColor;\n  ctx.globalCompositeOperation = 'destination-over';\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n  return new Promise((resolve) => {\n    canvas.toBlob(resolve, outputType);\n  });\n}\n","const randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nexport default { randomUUID };\n","let getRandomValues;\nconst rnds8 = new Uint8Array(16);\nexport default function rng() {\n    if (!getRandomValues) {\n        if (typeof crypto === 'undefined' || !crypto.getRandomValues) {\n            throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n        }\n        getRandomValues = crypto.getRandomValues.bind(crypto);\n    }\n    return getRandomValues(rnds8);\n}\n","import validate from './validate.js';\nconst byteToHex = [];\nfor (let i = 0; i < 256; ++i) {\n    byteToHex.push((i + 0x100).toString(16).slice(1));\n}\nexport function unsafeStringify(arr, offset = 0) {\n    return (byteToHex[arr[offset + 0]] +\n        byteToHex[arr[offset + 1]] +\n        byteToHex[arr[offset + 2]] +\n        byteToHex[arr[offset + 3]] +\n        '-' +\n        byteToHex[arr[offset + 4]] +\n        byteToHex[arr[offset + 5]] +\n        '-' +\n        byteToHex[arr[offset + 6]] +\n        byteToHex[arr[offset + 7]] +\n        '-' +\n        byteToHex[arr[offset + 8]] +\n        byteToHex[arr[offset + 9]] +\n        '-' +\n        byteToHex[arr[offset + 10]] +\n        byteToHex[arr[offset + 11]] +\n        byteToHex[arr[offset + 12]] +\n        byteToHex[arr[offset + 13]] +\n        byteToHex[arr[offset + 14]] +\n        byteToHex[arr[offset + 15]]).toLowerCase();\n}\nfunction stringify(arr, offset = 0) {\n    const uuid = unsafeStringify(arr, offset);\n    if (!validate(uuid)) {\n        throw TypeError('Stringified UUID is invalid');\n    }\n    return uuid;\n}\nexport default stringify;\n","import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\nfunction v4(options, buf, offset) {\n    if (native.randomUUID && !buf && !options) {\n        return native.randomUUID();\n    }\n    options = options || {};\n    const rnds = options.random ?? options.rng?.() ?? rng();\n    if (rnds.length < 16) {\n        throw new Error('Random bytes length must be >= 16');\n    }\n    rnds[6] = (rnds[6] & 0x0f) | 0x40;\n    rnds[8] = (rnds[8] & 0x3f) | 0x80;\n    if (buf) {\n        offset = offset || 0;\n        if (offset < 0 || offset + 16 > buf.length) {\n            throw new RangeError(`UUID byte range ${offset}:${offset + 15} is out of buffer bounds`);\n        }\n        for (let i = 0; i < 16; ++i) {\n            buf[offset + i] = rnds[i];\n        }\n        return buf;\n    }\n    return unsafeStringify(rnds);\n}\nexport default v4;\n","import { ApiMessage, MAIN_THREAD_ID } from \"../../../api/types/messages\";\nimport {\n  AI_FOLDER_ID,\n  ALL_FOLDER_ID,\n  PRESET_FOLDER_ID,\n  SERVICE_NOTIFICATIONS_USER_ID,\n  UNREAD_FOLDER_ID,\n} from \"../../../config\";\nimport { getActions, getGlobal } from \"../../../global\";\nimport { selectChat, selectChatLastMessageId } from \"../../../global/selectors\";\nimport { getOrderedIds } from \"../../../util/folderManager\";\nimport { fetchChatMessageByCount } from \"../utils/fetch-messages\";\nimport { ChataiStores, GLOBAL_AICHATFOLDERS_LAST_TIME } from \"../store\";\nimport {\n  batchAiChatFolders,\n  AI_CHATFOLDERS_LIST,\n  AI_CHATFOLDERS_LOG_PRE,\n  AIChatFolder,\n  deleteAiChatFolders,\n  groupAiChatFoldersRes,\n  isChatBot,\n  saveAiChatFolders,\n  sleep,\n  formatJSONContent,\n} from \"../ai-chatfolders/util\";\nimport { flatMap, uniq } from \"lodash\";\nimport { selectSharedSettings } from \"../../../global/selectors/sharedState\";\n\nconst AI_CHATFOLDERS_INTERVAL_TIME = 1000 * 60 * 60 * 24 * 7;\nconst AI_CHATFOLDERS_BATCH_SIZE = 20;\n\nclass AIChatFoldersTask {\n  private static instance: AIChatFoldersTask | undefined;\n\n  public static getInstance() {\n    if (!AIChatFoldersTask.instance) {\n      AIChatFoldersTask.instance = new AIChatFoldersTask();\n    }\n    return AIChatFoldersTask.instance;\n  }\n\n  async initTask() {\n    setInterval(async () => {\n      this.classifyChatMessageByCount();\n    }, AI_CHATFOLDERS_INTERVAL_TIME);\n\n    setTimeout(() => {\n      this.classifyChatMessageByCount();\n    }, 1000);\n  }\n\n  async runAIChatFolders(chatMessages: { [key: string]: ApiMessage[] }) {\n    if (!Object.keys(chatMessages).length) return;\n    // 1. ai chat folders classify\n    const res: AIChatFolder[] = await batchAiChatFolders(\n      chatMessages,\n      AI_CHATFOLDERS_BATCH_SIZE\n    );\n    console.log(AI_CHATFOLDERS_LOG_PRE + \"aiClassify: \", res, new Date());\n    // 2. save classify result\n    saveAiChatFolders(res);\n    const groupedRes = groupAiChatFoldersRes(res);\n    // 3. update chat folder\n    await this.updateChatFolder(groupedRes);\n  }\n\n  async updateChatFolder(content: { [key: string]: number[] }) {\n    const sortedKeys = Object.keys(content);\n    if (!sortedKeys.length) return;\n\n    const { addChatFolder, editChatFolder } = getActions();\n    console.log(\n      AI_CHATFOLDERS_LOG_PRE + \"updateChatFolder: \",\n      sortedKeys,\n      new Date()\n    );\n\n    // delete all ai chat folder\n    await deleteAiChatFolders();\n    // add folders\n    for (let i = 0; i < sortedKeys.length; i++) {\n      const folderTitle = sortedKeys[i];\n      if (content[folderTitle].length) {\n        const folder = {\n          id: i + 2,\n          title: { text: folderTitle, desc: \"AI\" },\n          includedChatIds: content[folderTitle].map((item) => item + \"\"),\n          excludedChatIds: [],\n        };\n        const existDb = await ChataiStores.folder?.getFolder(folderTitle);\n        const globalFolders = getGlobal().chatFolders?.byId;\n        const existFolder = flatMap(globalFolders)?.find(o=>o?.title?.text === folderTitle)\n        const exist = existDb ? existDb : existFolder\n        if (exist) {\n          // 用户已有自定义分类，将用户自定义标签和AI标签对比去重后取合集\n          folder.id = Number(exist.id);\n          folder.includedChatIds = uniq(\n            folder.includedChatIds.concat(exist.includedChatIds)\n          );\n          await editChatFolder?.({\n            id: folder.id,\n            folderUpdate: folder,\n            from: \"AI\",\n          });\n          console.log(\n            AI_CHATFOLDERS_LOG_PRE + \"update: \" + folderTitle,\n            folder,\n            new Date()\n          );\n        } else {\n          await addChatFolder?.({ folder, from: \"AI\" });\n          console.log(\n            AI_CHATFOLDERS_LOG_PRE + \"add: \" + folderTitle,\n            folder,\n            new Date()\n          );\n        }\n        await sleep(3000);\n      }\n    }\n    await this.sortChatFolder();\n    // update last classify time\n    ChataiStores.general?.set(\n      GLOBAL_AICHATFOLDERS_LAST_TIME,\n      new Date().getTime()\n    );\n    console.log(AI_CHATFOLDERS_LOG_PRE + \"end\", new Date());\n  }\n\n  async sortChatFolder() {\n    // sort folders\n    const global = getGlobal();\n    const ids = Object.keys(global.chatFolders.byId)\n      ?.sort(\n        (a, b) =>\n          (AI_CHATFOLDERS_LIST?.findIndex(\n            (item) =>\n              item === (global.chatFolders.byId[Number(a)]?.title?.text ?? \"\")\n          ) ?? 0) -\n          (AI_CHATFOLDERS_LIST?.findIndex(\n            (item) =>\n              item === (global.chatFolders.byId[Number(b)]?.title?.text ?? \"\")\n          ) ?? 0)\n      )\n      ?.map((item) => Number(item));\n    const folderIds = [0, ...ids, PRESET_FOLDER_ID, AI_FOLDER_ID];\n    folderIds.splice(3, 0, UNREAD_FOLDER_ID);\n    await getActions().sortChatFolders({ folderIds });\n    console.log(\n      AI_CHATFOLDERS_LOG_PRE + \"sort: \",\n      folderIds,\n      new Date(),\n      global.chatFolders\n    );\n  }\n\n  async classifyChatMessageByCount() {\n    const global = getGlobal();\n    const { aiChatFolders } = selectSharedSettings(global);\n    if (aiChatFolders !== true) {\n      console.log(AI_CHATFOLDERS_LOG_PRE + \"enable=false, pass\", global);\n      return;\n    }\n    const lastTime = await ChataiStores.general?.get(\n      GLOBAL_AICHATFOLDERS_LAST_TIME\n    );\n    if (\n      lastTime &&\n      new Date().getTime() - lastTime < AI_CHATFOLDERS_INTERVAL_TIME\n    ) {\n      console.log(AI_CHATFOLDERS_LOG_PRE + \"pass\", lastTime, global);\n      return;\n    }\n    console.log(\n      AI_CHATFOLDERS_LOG_PRE + \"running\",\n      lastTime,\n      global.chatFolders\n    );\n    let chatMessages: { [key: string]: ApiMessage[] } = {};\n    const orderedIds = (getOrderedIds(ALL_FOLDER_ID) || [])?.filter(\n      (o) => o !== SERVICE_NOTIFICATIONS_USER_ID\n    );\n    console.log(AI_CHATFOLDERS_LOG_PRE + \"orderedIds:\", orderedIds);\n    for (let i = 0; i < orderedIds.length; i++) {\n      const chatId = orderedIds[i];\n      const chat = selectChat(global, chatId);\n      const chatBot = isChatBot(chatId);\n      const chatLastMessageId = selectChatLastMessageId(global, chatId) || 0;\n      if (chat && !chatBot && chatLastMessageId) {\n        const roomMsgs = await fetchChatMessageByCount({\n          chat,\n          offsetId: chatLastMessageId,\n          addOffset: -1,\n          sliceSize: 30,\n          threadId: MAIN_THREAD_ID,\n          maxCount: 100,\n        });\n        if (roomMsgs.length) {\n          chatMessages[chatId] = roomMsgs;\n        }\n      }\n    }\n    console.log(\n      AI_CHATFOLDERS_LOG_PRE + \"fetchMsg\",\n      Object.keys(chatMessages).length\n    );\n\n    await this.runAIChatFolders(chatMessages);\n  }\n}\n\nexport const aiChatFoldersTask = new AIChatFoldersTask();\n","// Sometimes event is fired earlier than animation completes\nconst ANIMATION_END_DELAY = 50;\n\nexport function waitForTransitionEnd(\n  node: Node, handler: NoneToVoidFunction, propertyName?: string, fallbackMs?: number,\n) {\n  return waitForEndEvent('transitionend', node, handler, propertyName, fallbackMs);\n}\n\nexport function waitForAnimationEnd(\n  node: Node, handler: NoneToVoidFunction, animationName?: string, fallbackMs?: number,\n) {\n  return waitForEndEvent('animationend', node, handler, animationName, fallbackMs);\n}\n\nfunction waitForEndEvent(\n  eventType: 'transitionend' | 'animationend',\n  node: Node,\n  handler: NoneToVoidFunction,\n  detailedName?: string,\n  fallbackMs?: number,\n) {\n  let isHandled = false;\n\n  function cleanup() {\n    node.removeEventListener(eventType, handleAnimationEnd);\n  }\n\n  function handleAnimationEnd(e: TransitionEvent | AnimationEvent | Event) {\n    if (isHandled || e.target !== e.currentTarget) {\n      return;\n    }\n\n    if (detailedName && (\n      (e instanceof TransitionEvent && e.propertyName === detailedName)\n      || (e instanceof AnimationEvent && e.animationName === detailedName)\n    )) {\n      return;\n    }\n\n    isHandled = true;\n\n    cleanup();\n\n    setTimeout(() => {\n      handler();\n    }, ANIMATION_END_DELAY);\n  }\n\n  node.addEventListener(eventType, handleAnimationEnd);\n\n  if (fallbackMs) {\n    setTimeout(() => {\n      if (isHandled) return;\n\n      cleanup();\n\n      handler();\n    }, fallbackMs);\n  }\n\n  return cleanup;\n}\n","import { useCallback, useRef } from '../lib/teact/teact';\nimport { getActions } from '../global';\n\nimport { IS_TEST } from '../config';\nimport { requestMeasure } from '../lib/fasterdom/fasterdom';\nimport { IS_IOS } from '../util/browser/windowEnvironment';\nimport useEffectOnce from './useEffectOnce';\nimport useLastCallback from './useLastCallback';\nimport useSyncEffect from './useSyncEffect';\n\nconst PATH_BASE = `${window.location.pathname}${window.location.search}`;\n// Carefully selected by swiping and observing visual changes\n// TODO: may be different on other devices such as iPad, maybe take dpi into account?\nconst SAFARI_EDGE_BACK_GESTURE_LIMIT = 300;\nconst SAFARI_EDGE_BACK_GESTURE_DURATION = 350;\n\ntype HistoryRecord = {\n  index: number;\n  // Should this record be replaced by the next record (for example Menu)\n  shouldBeReplaced?: boolean;\n  // Mark this record as replaced by the next record. Only used to check if needed to perform effectBack\n  markReplaced?: VoidFunction;\n  onBack?: VoidFunction;\n  // Set if the element is closed in the UI, but not in the real history\n  isClosed?: boolean;\n};\n\ntype HistoryOperationGo = {\n  type: 'go';\n  delta: number;\n};\n\ntype HistoryOperationState = {\n  type: 'pushState' | 'replaceState';\n  data: any;\n  hash?: string;\n};\n\ntype HistoryOperation = HistoryOperationGo | HistoryOperationState;\n\n// Needed to dismiss any 'trashed' history records from the previous page reloads.\nconst historyUniqueSessionId = Number(new Date());\n// Reflects real history state, but also contains information on which records should be replaced by the next record and\n// which records are deferred to close on the next operation\nlet historyState: HistoryRecord[];\n// Reflects current real history index\nlet historyCursor: number;\n// If we alter real history programmatically, the popstate event will be fired, which we don't need\nlet isAlteringHistory = false;\n// Unfortunately Safari doesn't really like when there's 2+ consequent history operations in one frame, so we need\n// to delay them to the next raf\nlet deferredHistoryOperations: HistoryOperation[] = [];\nlet deferredPopstateOperations: HistoryOperationState[] = [];\nlet isSafariGestureAnimation = false;\n\n// Do not remove: used for history unit tests\nif (IS_TEST) {\n  (window as any).TEST_getHistoryState = () => historyState;\n  (window as any).TEST_getHistoryCursor = () => historyCursor;\n}\n\nfunction handleTouchStart(event: TouchEvent) {\n  const x = event.touches[0].pageX;\n\n  if (x <= SAFARI_EDGE_BACK_GESTURE_LIMIT || x >= window.innerWidth - SAFARI_EDGE_BACK_GESTURE_LIMIT) {\n    isSafariGestureAnimation = true;\n  }\n}\n\nfunction handleTouchEnd() {\n  if (!isSafariGestureAnimation) {\n    return;\n  }\n\n  setTimeout(() => {\n    isSafariGestureAnimation = false;\n  }, SAFARI_EDGE_BACK_GESTURE_DURATION);\n}\n\nif (IS_IOS) {\n  window.addEventListener('touchstart', handleTouchStart);\n  window.addEventListener('touchend', handleTouchEnd);\n  window.addEventListener('popstate', handleTouchEnd);\n}\n\nfunction applyDeferredHistoryOperations() {\n  const goOperations = deferredHistoryOperations.filter((op) => op.type === 'go') as HistoryOperationGo[];\n  const stateOperations = deferredHistoryOperations.filter((op) => op.type !== 'go') as HistoryOperationState[];\n  const goCount = goOperations.reduce((acc, op) => acc + op.delta, 0);\n\n  deferredHistoryOperations = [];\n\n  if (goCount) {\n    window.history.go(goCount);\n\n    // If we have some `state` operations after the `go` operations, we need to wait until the popstate event\n    // so the order of operations is correctly preserved\n    if (stateOperations.length) {\n      deferredPopstateOperations.push(...stateOperations);\n      return;\n    }\n  }\n\n  processStateOperations(stateOperations);\n}\n\nfunction processStateOperations(stateOperations: HistoryOperationState[]) {\n  stateOperations.forEach((op) => window.history[op.type](op.data, '', op.hash));\n}\n\nfunction deferHistoryOperation(historyOperation: HistoryOperation) {\n  if (!deferredHistoryOperations.length) {\n    requestMeasure(applyDeferredHistoryOperations);\n  }\n\n  deferredHistoryOperations.push(historyOperation);\n}\n\n// Resets history to the `root` state\nfunction resetHistory() {\n  historyCursor = 0;\n  historyState = [{\n    index: 0,\n    onBack: () => window.history.back(),\n  }];\n\n  window.history.replaceState({ index: 0, historyUniqueSessionId }, '', PATH_BASE);\n}\n\nresetHistory();\n\nfunction cleanupClosed(alreadyClosedCount = 1) {\n  let countClosed = alreadyClosedCount;\n  for (let i = historyCursor - 1; i > 0; i--) {\n    if (!historyState[i].isClosed) break;\n    countClosed++;\n  }\n  if (countClosed) {\n    isAlteringHistory = true;\n    deferHistoryOperation({\n      type: 'go',\n      delta: -countClosed,\n    });\n  }\n  return countClosed;\n}\n\nfunction cleanupTrashedState() {\n  // Navigation to previous page reload, state of which was trashed by reload\n  let isAnimationDisabled = false;\n  for (let i = historyState.length - 1; i > 0; i--) {\n    if (historyState[i].isClosed) {\n      continue;\n    }\n    // TODO[history]: probably we should not call this inside the loop\n    if (!isAnimationDisabled && isSafariGestureAnimation) {\n      getActions().disableHistoryAnimations();\n      isAnimationDisabled = true;\n    }\n    historyState[i].onBack?.();\n  }\n\n  resetHistory();\n}\n\nwindow.addEventListener('popstate', ({ state }: PopStateEvent) => {\n  if (isAlteringHistory) {\n    isAlteringHistory = false;\n    if (deferredPopstateOperations.length) {\n      processStateOperations(deferredPopstateOperations);\n      deferredPopstateOperations = [];\n    }\n    return;\n  }\n\n  if (!state) {\n    cleanupTrashedState();\n\n    if (!window.location.hash) {\n      return;\n    }\n    return;\n  }\n\n  const { index, historyUniqueSessionId: previousUniqueSessionId } = state;\n  if (previousUniqueSessionId !== historyUniqueSessionId) {\n    cleanupTrashedState();\n    return;\n  }\n\n  // New real history state matches the old virtual one. Not possible in theory, but in practice we have Safari\n  if (index === historyCursor) {\n    return;\n  }\n\n  if (index < historyCursor) {\n    // Navigating back\n    let alreadyClosedCount = 0;\n    let isAnimationDisabled = false;\n    for (let i = historyCursor; i > index - alreadyClosedCount; i--) {\n      if (historyState[i].isClosed) {\n        alreadyClosedCount++;\n        continue;\n      }\n      // TODO[history]: probably we should not call this inside the loop\n      if (!isAnimationDisabled && isSafariGestureAnimation) {\n        getActions().disableHistoryAnimations();\n        isAnimationDisabled = true;\n      }\n      historyState[i].onBack?.();\n    }\n\n    const countClosed = cleanupClosed(alreadyClosedCount);\n    historyCursor += index - historyCursor - countClosed;\n\n    // Can happen when we have deferred a real back for some element (for example Menu), closed via UI,\n    // pressed back button and caused a pushState.\n    if (historyCursor < 0) {\n      historyCursor = 0;\n    }\n  } else if (index > historyCursor) {\n    // Forward navigation is not yet supported\n    isAlteringHistory = true;\n    deferHistoryOperation({\n      type: 'go',\n      delta: -(index - historyCursor),\n    });\n  }\n});\n\nexport default function useHistoryBack({\n  isActive,\n  shouldBeReplaced,\n  shouldResetUrlHash,\n  hash,\n  onBack,\n}: {\n  isActive?: boolean;\n  shouldBeReplaced?: boolean;\n  hash?: string;\n  shouldResetUrlHash?: boolean;\n  onBack: VoidFunction;\n}) {\n  const lastOnBack = useLastCallback(onBack);\n\n  // Active index of the record\n  const indexRef = useRef<number>();\n  const wasReplaced = useRef(false);\n\n  const isFirstRender = useRef(true);\n\n  const pushState = useCallback((forceReplace = false) => {\n    // Check if the old state should be replaced\n    const shouldReplace = forceReplace || historyState[historyCursor].shouldBeReplaced;\n    indexRef.current = shouldReplace ? historyCursor : ++historyCursor;\n\n    historyCursor = indexRef.current;\n\n    // Mark the previous record as replaced so effectBack doesn't perform back operation on the new record\n    const previousRecord = historyState[indexRef.current];\n    if (previousRecord && !previousRecord.isClosed) {\n      previousRecord.markReplaced?.();\n    }\n\n    historyState[indexRef.current] = {\n      index: indexRef.current,\n      onBack: lastOnBack,\n      shouldBeReplaced,\n      markReplaced: () => {\n        wasReplaced.current = true;\n      },\n    };\n\n    deferHistoryOperation({\n      type: shouldReplace ? 'replaceState' : 'pushState',\n      data: {\n        index: indexRef.current,\n        historyUniqueSessionId,\n      },\n      // Space is a hack to make the browser completely remove the hash\n      hash: hash ? `#${hash}` : (shouldResetUrlHash ? ' ' : undefined),\n    });\n  }, [hash, shouldBeReplaced, shouldResetUrlHash]);\n\n  const processBack = useCallback(() => {\n    // Only process back on open records\n    if (indexRef.current && historyState[indexRef.current] && !wasReplaced.current) {\n      historyState[indexRef.current].isClosed = true;\n      wasReplaced.current = true;\n      if (indexRef.current === historyCursor && !shouldBeReplaced) {\n        historyCursor -= cleanupClosed();\n      }\n    }\n  }, [shouldBeReplaced]);\n\n  // Process back navigation when element is unmounted\n  useEffectOnce(() => {\n    isFirstRender.current = false;\n    return () => {\n      if (!isActive || wasReplaced.current) return;\n      processBack();\n    };\n  });\n\n  useSyncEffect(([prevIsActive]) => {\n    if (prevIsActive === isActive) return;\n    if (isFirstRender.current && !isActive) return;\n\n    if (isActive) {\n      pushState();\n    } else {\n      processBack();\n    }\n  }, [isActive, processBack, pushState]);\n}\n","import { getGlobal } from '../global';\n\nimport { DEBUG } from '../config';\nimport { selectTabState } from '../global/selectors';\n\nexport function updateAppBadge(unreadCount: number) {\n  if (!selectTabState(getGlobal()).isMasterTab) return;\n  if (typeof window.navigator.setAppBadge !== 'function') {\n    return;\n  }\n\n  window.navigator.setAppBadge(unreadCount).catch((err) => {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.error(err);\n    }\n  });\n}\n","import type { ApiMessage, ApiMessageReplyInfo, ApiStoryReplyInfo } from '../../api/types';\n\nexport function getMessageReplyInfo(message: ApiMessage): ApiMessageReplyInfo | undefined {\n  const { replyInfo } = message;\n  if (!replyInfo || replyInfo.type !== 'message') return undefined;\n  return replyInfo;\n}\n\nexport function getStoryReplyInfo(message: ApiMessage): ApiStoryReplyInfo | undefined {\n  const { replyInfo } = message;\n  if (!replyInfo || replyInfo.type !== 'story') return undefined;\n  return replyInfo;\n}\n","import type { ApiPrivacySettings, ApiUsername } from '../../../api/types';\nimport type { ActionReturnType } from '../../types';\nimport {\n  ProfileEditProgress,\n  UPLOADING_WALLPAPER_SLUG,\n} from '../../../types';\n\nimport { APP_CONFIG_REFETCH_INTERVAL, COUNTRIES_WITH_12H_TIME_FORMAT, MAX_INT_32 } from '../../../config';\nimport { getCurrentTabId } from '../../../util/establishMultitabRole';\nimport { buildCollectionByKey } from '../../../util/iteratees';\nimport { requestPermission, subscribe, unsubscribe } from '../../../util/notifications';\nimport { setTimeFormat } from '../../../util/oldLangProvider';\nimport requestActionTimeout from '../../../util/requestActionTimeout';\nimport { getServerTime } from '../../../util/serverTime';\nimport { callApi } from '../../../api/gramjs';\nimport { buildApiInputPrivacyRules } from '../../helpers';\nimport { addActionHandler, getGlobal, setGlobal } from '../../index';\nimport {\n  addBlockedUser, addNotifyException, addNotifyExceptions, deletePeerPhoto,\n  removeBlockedUser, replaceSettings, updateChat,\n  updateSharedSettings, updateUser, updateUserFullInfo,\n} from '../../reducers';\nimport { updateTabState } from '../../reducers/tabs';\nimport {\n  selectChat, selectIsCurrentUserFrozen,\n  selectTabState, selectUser,\n} from '../../selectors';\nimport { selectSharedSettings } from '../../selectors/sharedState';\n\naddActionHandler('updateProfile', async (global, actions, payload): Promise<void> => {\n  const {\n    photo, firstName, lastName, bio: about, username,\n    tabId = getCurrentTabId(),\n  } = payload;\n\n  const { currentUserId } = global;\n  if (!currentUserId) {\n    return;\n  }\n\n  global = updateTabState(global, {\n    profileEdit: {\n      progress: ProfileEditProgress.InProgress,\n    },\n  }, tabId);\n  setGlobal(global);\n\n  if (photo) {\n    await callApi('uploadProfilePhoto', photo);\n  }\n\n  if (firstName || lastName || about) {\n    const result = await callApi('updateProfile', { firstName, lastName, about });\n    if (result) {\n      global = getGlobal();\n      const currentUser = currentUserId && selectUser(global, currentUserId);\n\n      if (currentUser) {\n        global = updateUser(\n          global,\n          currentUser.id,\n          {\n            firstName,\n            lastName,\n          },\n        );\n        global = updateUserFullInfo(global, currentUser.id, { bio: about });\n        setGlobal(global);\n      }\n    }\n  }\n\n  if (username !== undefined) {\n    const result = await callApi('updateUsername', username);\n    global = getGlobal();\n    const currentUser = currentUserId && selectUser(global, currentUserId);\n\n    if (result && currentUser) {\n      const shouldUsernameUpdate = currentUser.usernames?.find((u) => u.isEditable);\n      const usernames = shouldUsernameUpdate\n        ? currentUser.usernames?.map((u) => (u.isEditable ? { ...u, username } : u))\n        : [{ username, isEditable: true, isActive: true } as ApiUsername, ...currentUser.usernames || []];\n      global = updateUser(global, currentUserId, { usernames });\n      setGlobal(global);\n    }\n  }\n\n  global = getGlobal();\n  global = updateTabState(global, {\n    profileEdit: {\n      progress: ProfileEditProgress.Complete,\n    },\n  }, tabId);\n  setGlobal(global);\n\n  if (photo) {\n    actions.loadFullUser({ userId: currentUserId, withPhotos: true });\n  }\n});\n\naddActionHandler('updateProfilePhoto', async (global, actions, payload): Promise<void> => {\n  const { photo, isFallback } = payload;\n  const { currentUserId } = global;\n  if (!currentUserId) return;\n  const currentUser = selectUser(global, currentUserId);\n  if (!currentUser) return;\n\n  global = updateUser(global, currentUserId, { avatarPhotoId: undefined });\n  global = updateUserFullInfo(global, currentUserId, { profilePhoto: undefined });\n\n  setGlobal(global);\n\n  const result = await callApi('updateProfilePhoto', photo, isFallback);\n  if (!result) return;\n\n  actions.loadFullUser({ userId: currentUserId, withPhotos: true });\n});\n\naddActionHandler('deleteProfilePhoto', async (global, actions, payload): Promise<void> => {\n  const { photo } = payload;\n  const { currentUserId } = global;\n  if (!currentUserId) return;\n\n  const isDeleted = await callApi('deleteProfilePhotos', [photo]);\n  if (!isDeleted) return;\n\n  global = getGlobal();\n  global = deletePeerPhoto(global, currentUserId, photo.id);\n  setGlobal(global);\n\n  actions.loadFullUser({ userId: currentUserId, withPhotos: true });\n});\n\naddActionHandler('checkUsername', async (global, actions, payload): Promise<void> => {\n  const { username, tabId = getCurrentTabId() } = payload!;\n\n  let tabState = selectTabState(global, tabId);\n  // No need to check the username if profile update is already in progress\n  if (tabState.profileEdit && tabState.profileEdit.progress === ProfileEditProgress.InProgress) {\n    return;\n  }\n\n  global = updateTabState(global, {\n    profileEdit: {\n      progress: tabState.profileEdit ? tabState.profileEdit.progress : ProfileEditProgress.Idle,\n      checkedUsername: undefined,\n      isUsernameAvailable: undefined,\n      error: undefined,\n    },\n  }, tabId);\n  setGlobal(global);\n\n  const { result, error } = (await callApi('checkUsername', username))!;\n\n  global = getGlobal();\n  tabState = selectTabState(global, tabId);\n  global = updateTabState(global, {\n    profileEdit: {\n      ...tabState.profileEdit!,\n      checkedUsername: username,\n      isUsernameAvailable: result === true,\n      error,\n    },\n  }, tabId);\n  setGlobal(global);\n});\n\naddActionHandler('loadWallpapers', async (global): Promise<void> => {\n  const result = await callApi('fetchWallpapers');\n  if (!result) {\n    return;\n  }\n\n  global = getGlobal();\n  global = {\n    ...global,\n    settings: {\n      ...global.settings,\n      loadedWallpapers: result.wallpapers,\n    },\n  };\n  setGlobal(global);\n});\n\naddActionHandler('uploadWallpaper', async (global, actions, payload): Promise<void> => {\n  const file = payload;\n  const previewBlobUrl = URL.createObjectURL(file);\n\n  global = {\n    ...global,\n    settings: {\n      ...global.settings,\n      loadedWallpapers: [\n        {\n          slug: UPLOADING_WALLPAPER_SLUG,\n          document: {\n            mediaType: 'document',\n            fileName: '',\n            size: file.size,\n            mimeType: file.type,\n            previewBlobUrl,\n          },\n        },\n        ...(global.settings.loadedWallpapers || []),\n      ],\n    },\n  };\n  setGlobal(global);\n\n  const result = await callApi('uploadWallpaper', file);\n  if (!result) {\n    return;\n  }\n\n  const { wallpaper } = result;\n\n  global = getGlobal();\n  if (!global.settings.loadedWallpapers) {\n    return;\n  }\n\n  const firstWallpaper = global.settings.loadedWallpapers[0];\n  if (!firstWallpaper || firstWallpaper.slug !== UPLOADING_WALLPAPER_SLUG) {\n    return;\n  }\n\n  const withLocalMedia = {\n    ...wallpaper,\n    document: {\n      ...wallpaper.document,\n      previewBlobUrl,\n    },\n  };\n\n  global = {\n    ...global,\n    settings: {\n      ...global.settings,\n      loadedWallpapers: [\n        withLocalMedia,\n        ...global.settings.loadedWallpapers.slice(1),\n      ],\n    },\n  };\n  setGlobal(global);\n});\n\naddActionHandler('loadBlockedUsers', async (global): Promise<void> => {\n  const result = await callApi('fetchBlockedUsers', {});\n  if (!result) return;\n\n  global = getGlobal();\n\n  global = {\n    ...global,\n    blocked: {\n      ids: result.blockedIds,\n      totalCount: result.totalCount,\n    },\n  };\n\n  setGlobal(global);\n});\n\naddActionHandler('blockUser', async (global, actions, payload): Promise<void> => {\n  const { userId, isOnlyStories } = payload;\n\n  const user = selectUser(global, userId);\n  if (!user) return;\n\n  const result = await callApi('blockUser', {\n    user,\n    isOnlyStories: isOnlyStories || undefined,\n  });\n  if (!result) return;\n\n  global = getGlobal();\n  global = addBlockedUser(global, userId);\n  setGlobal(global);\n});\n\naddActionHandler('unblockUser', async (global, actions, payload): Promise<void> => {\n  const { userId, isOnlyStories } = payload;\n\n  const user = selectUser(global, userId);\n  if (!user) return;\n\n  const result = await callApi('unblockUser', {\n    user,\n    isOnlyStories: isOnlyStories || undefined,\n  });\n  if (!result) return;\n\n  global = getGlobal();\n  global = removeBlockedUser(global, userId);\n  setGlobal(global);\n});\n\naddActionHandler('loadNotificationExceptions', async (global): Promise<void> => {\n  const result = await callApi('fetchNotificationExceptions');\n  if (!result) {\n    return;\n  }\n\n  global = getGlobal();\n  global = addNotifyExceptions(global, result);\n  setGlobal(global);\n});\n\naddActionHandler('loadNotificationSettings', async (global): Promise<void> => {\n  const [signUpNotification, notifyDefaults] = await Promise.all([\n    callApi('fetchContactSignUpSetting'),\n    callApi('fetchNotifyDefaultSettings'),\n  ]);\n\n  if (!notifyDefaults) return;\n\n  global = getGlobal();\n  global = replaceSettings(global, {\n    hasContactJoinedNotifications: signUpNotification,\n  });\n  global = {\n    ...global,\n    settings: {\n      ...global.settings,\n      notifyDefaults,\n    },\n  };\n  setGlobal(global);\n});\n\naddActionHandler('updateNotificationSettings', async (global, actions, payload): Promise<void> => {\n  const { peerType, isMuted, shouldShowPreviews } = payload!;\n\n  const result = await callApi('updateNotificationSettings', peerType, { isMuted, shouldShowPreviews });\n  if (!result) {\n    return;\n  }\n\n  global = getGlobal();\n  global = addNotifyException(global, peerType, {\n    mutedUntil: isMuted ? MAX_INT_32 : undefined,\n    shouldShowPreviews,\n  });\n  setGlobal(global);\n});\n\naddActionHandler('updateWebNotificationSettings', async (global, actions, payload): Promise<void> => {\n  const oldSettings = global.settings.byKey;\n  global = replaceSettings(global, payload);\n  setGlobal(global);\n  const { hasWebNotifications, hasPushNotifications } = global.settings.byKey;\n  if (!oldSettings.hasPushNotifications && hasPushNotifications) {\n    await subscribe();\n  }\n  if (oldSettings.hasPushNotifications && !hasPushNotifications) {\n    await unsubscribe();\n  }\n  if (!oldSettings.hasWebNotifications && hasWebNotifications) {\n    const isGranted = await requestPermission();\n    if (!isGranted) {\n      global = getGlobal();\n      global = replaceSettings(global, { hasWebNotifications: false });\n      setGlobal(global);\n    }\n  }\n});\n\naddActionHandler('updateContactSignUpNotification', async (global, actions, payload): Promise<void> => {\n  const { isSilent } = payload;\n\n  const result = await callApi('updateContactSignUpNotification', isSilent);\n  if (!result) {\n    return;\n  }\n\n  global = getGlobal();\n  global = replaceSettings(global, { hasContactJoinedNotifications: !isSilent });\n  setGlobal(global);\n});\n\naddActionHandler('loadLanguages', async (global): Promise<void> => {\n  const result = await callApi('fetchLanguages');\n  if (!result) {\n    return;\n  }\n\n  global = getGlobal();\n  global = updateSharedSettings(global, { languages: result });\n  setGlobal(global);\n});\n\naddActionHandler('loadPrivacySettings', async (global): Promise<void> => {\n  if (selectIsCurrentUserFrozen(global)) return;\n\n  const result = await Promise.all([\n    callApi('fetchPrivacySettings', 'phoneNumber'),\n    callApi('fetchPrivacySettings', 'addByPhone'),\n    callApi('fetchPrivacySettings', 'lastSeen'),\n    callApi('fetchPrivacySettings', 'profilePhoto'),\n    callApi('fetchPrivacySettings', 'forwards'),\n    callApi('fetchPrivacySettings', 'chatInvite'),\n    callApi('fetchPrivacySettings', 'phoneCall'),\n    callApi('fetchPrivacySettings', 'phoneP2P'),\n    callApi('fetchPrivacySettings', 'voiceMessages'),\n    callApi('fetchPrivacySettings', 'bio'),\n    callApi('fetchPrivacySettings', 'birthday'),\n    callApi('fetchPrivacySettings', 'gifts'),\n    callApi('fetchPrivacySettings', 'noPaidMessages'),\n  ]);\n\n  if (result.some((e) => e === undefined)) {\n    return;\n  }\n\n  const [\n    phoneNumberSettings,\n    addByPhoneSettings,\n    lastSeenSettings,\n    profilePhotoSettings,\n    forwardsSettings,\n    chatInviteSettings,\n    phoneCallSettings,\n    phoneP2PSettings,\n    voiceMessagesSettings,\n    bioSettings,\n    birthdaySettings,\n    giftsSettings,\n    noPaidMessagesSettings,\n  ] = result as {\n    rules: ApiPrivacySettings;\n  }[];\n\n  global = getGlobal();\n  global = {\n    ...global,\n    settings: {\n      ...global.settings,\n      privacy: {\n        ...global.settings.privacy,\n        phoneNumber: phoneNumberSettings.rules,\n        addByPhone: addByPhoneSettings.rules,\n        lastSeen: lastSeenSettings.rules,\n        profilePhoto: profilePhotoSettings.rules,\n        forwards: forwardsSettings.rules,\n        chatInvite: chatInviteSettings.rules,\n        phoneCall: phoneCallSettings.rules,\n        phoneP2P: phoneP2PSettings.rules,\n        voiceMessages: voiceMessagesSettings.rules,\n        bio: bioSettings.rules,\n        birthday: birthdaySettings.rules,\n        gifts: giftsSettings.rules,\n        noPaidMessages: noPaidMessagesSettings.rules,\n      },\n    },\n  };\n  setGlobal(global);\n});\n\naddActionHandler('setPrivacyVisibility', async (global, actions, payload): Promise<void> => {\n  const { privacyKey, visibility, onSuccess } = payload!;\n\n  if (!global.settings.privacy[privacyKey]) {\n    const result = await callApi('fetchPrivacySettings', privacyKey);\n    if (!result) {\n      return;\n    }\n\n    global = getGlobal();\n    global = {\n      ...global,\n      settings: {\n        ...global.settings,\n        privacy: {\n          ...global.settings.privacy,\n          [privacyKey]: result.rules,\n        },\n      },\n    };\n    setGlobal(global);\n  }\n\n  const {\n    privacy: { [privacyKey]: settings },\n  } = global.settings;\n\n  if (!settings) {\n    return;\n  }\n\n  const rules = buildApiInputPrivacyRules(global, {\n    visibility,\n    allowedIds: [...settings.allowUserIds, ...settings.allowChatIds],\n    blockedIds: [...settings.blockUserIds, ...settings.blockChatIds],\n    botsPrivacy: settings.botsPrivacy,\n  });\n\n  const result = await callApi('setPrivacySettings', privacyKey, rules);\n  if (!result) {\n    return;\n  }\n\n  onSuccess?.();\n\n  global = getGlobal();\n  global = {\n    ...global,\n    settings: {\n      ...global.settings,\n      privacy: {\n        ...global.settings.privacy,\n        [privacyKey]: result.rules,\n      },\n    },\n  };\n  setGlobal(global);\n});\n\naddActionHandler('setPrivacySettings', async (global, actions, payload): Promise<void> => {\n  const {\n    privacyKey, isAllowList, updatedIds, isPremiumAllowed, botsPrivacy,\n  } = payload!;\n  const {\n    privacy: { [privacyKey]: settings },\n  } = global.settings;\n\n  if (!settings) {\n    return;\n  }\n\n  if (privacyKey === 'noPaidMessages') {\n    global = getGlobal();\n    const idsForUpdate = [\n      ...updatedIds.filter((id) => !settings.allowUserIds.includes(id)),\n      ...settings.allowUserIds.filter((id) => !updatedIds.includes(id)),\n    ];\n\n    idsForUpdate.forEach((userId) => {\n      global = updateUserFullInfo(global, userId, {\n        settings: undefined,\n      });\n    });\n    setGlobal(global);\n  }\n\n  const rules = buildApiInputPrivacyRules(global, {\n    visibility: settings.visibility,\n    isUnspecified: settings.isUnspecified,\n    shouldAllowPremium: isPremiumAllowed,\n    allowedIds: isAllowList ? updatedIds : [...settings.allowUserIds, ...settings.allowChatIds],\n    blockedIds: !isAllowList ? updatedIds : [...settings.blockUserIds, ...settings.blockChatIds],\n    botsPrivacy,\n  });\n\n  const result = await callApi('setPrivacySettings', privacyKey, rules);\n  if (!result) {\n    return;\n  }\n\n  global = getGlobal();\n  global = {\n    ...global,\n    settings: {\n      ...global.settings,\n      privacy: {\n        ...global.settings.privacy,\n        [privacyKey]: result.rules,\n      },\n    },\n  };\n  setGlobal(global);\n});\n\naddActionHandler('updateIsOnline', (global, actions, payload): ActionReturnType => {\n  if (global.connectionState !== 'connectionStateReady') return;\n  callApi('updateIsOnline', payload);\n});\n\naddActionHandler('loadContentSettings', async (global): Promise<void> => {\n  if (selectIsCurrentUserFrozen(global)) return;\n\n  const result = await callApi('fetchContentSettings');\n  if (!result) return;\n\n  global = getGlobal();\n  global = replaceSettings(global, result);\n  setGlobal(global);\n});\n\naddActionHandler('updateContentSettings', async (global, actions, payload): Promise<void> => {\n  global = replaceSettings(global, { isSensitiveEnabled: payload });\n  setGlobal(global);\n\n  const result = await callApi('updateContentSettings', payload);\n  if (!result) {\n    global = getGlobal();\n    global = replaceSettings(global, { isSensitiveEnabled: !payload });\n    setGlobal(global);\n  }\n});\n\naddActionHandler('loadCountryList', async (global, actions, payload): Promise<void> => {\n  let { langCode } = payload;\n  if (!langCode) langCode = selectSharedSettings(global).language;\n\n  const countryList = await callApi('fetchCountryList', { langCode });\n  if (!countryList) return;\n\n  global = getGlobal();\n  global = {\n    ...global,\n    countryList,\n  };\n  setGlobal(global);\n});\n\naddActionHandler('ensureTimeFormat', async (global, actions): Promise<void> => {\n  if (global.authNearestCountry) {\n    const timeFormat = COUNTRIES_WITH_12H_TIME_FORMAT\n      .has(global.authNearestCountry.toUpperCase()) ? '12h' : '24h';\n    actions.setSharedSettingOption({ timeFormat });\n    setTimeFormat(timeFormat);\n  }\n\n  if (selectSharedSettings(global).wasTimeFormatSetManually) {\n    return;\n  }\n\n  const nearestCountryCode = await callApi('fetchNearestCountry');\n  if (nearestCountryCode) {\n    const timeFormat = COUNTRIES_WITH_12H_TIME_FORMAT.has(nearestCountryCode.toUpperCase()) ? '12h' : '24h';\n    actions.setSharedSettingOption({ timeFormat });\n    setTimeFormat(timeFormat);\n  }\n});\n\naddActionHandler('loadAppConfig', async (global, actions, payload): Promise<void> => {\n  const hash = payload?.hash;\n\n  const appConfig = await callApi('fetchAppConfig', hash);\n  if (!appConfig) return;\n\n  requestActionTimeout({\n    action: 'loadAppConfig',\n    payload: { hash: appConfig.hash },\n  }, APP_CONFIG_REFETCH_INTERVAL);\n\n  global = getGlobal();\n  global = {\n    ...global,\n    appConfig,\n    isAppConfigLoaded: true,\n  };\n  setGlobal(global);\n});\n\naddActionHandler('loadConfig', async (global): Promise<void> => {\n  const config = await callApi('fetchConfig');\n  if (!config) return;\n\n  global = getGlobal();\n  const timeout = config.expiresAt - getServerTime();\n  requestActionTimeout({\n    action: 'loadConfig',\n    payload: undefined,\n  }, timeout * 1000);\n\n  global = {\n    ...global,\n    config,\n  };\n  setGlobal(global);\n});\n\naddActionHandler('loadPeerColors', async (global): Promise<void> => {\n  const hash = global.peerColors?.generalHash;\n  const result = await callApi('fetchPeerColors', hash);\n  if (!result) return;\n\n  global = getGlobal();\n  global = {\n    ...global,\n    peerColors: {\n      ...global.peerColors,\n      general: result.colors,\n      generalHash: result.hash,\n    },\n  };\n  setGlobal(global);\n});\n\naddActionHandler('loadTimezones', async (global): Promise<void> => {\n  const hash = global.timezones?.hash;\n  const result = await callApi('fetchTimezones', hash);\n  if (!result) return;\n\n  global = getGlobal();\n  global = {\n    ...global,\n    timezones: {\n      byId: buildCollectionByKey(result.timezones, 'id'),\n      hash: result.hash,\n    },\n  };\n  setGlobal(global);\n});\n\naddActionHandler('loadGlobalPrivacySettings', async (global): Promise<void> => {\n  const globalSettings = await callApi('fetchGlobalPrivacySettings');\n  if (!globalSettings) {\n    return;\n  }\n\n  global = getGlobal();\n  global = replaceSettings(global, { ...globalSettings });\n  setGlobal(global);\n});\n\naddActionHandler('updateGlobalPrivacySettings', async (global, actions, payload): Promise<void> => {\n  const shouldArchiveAndMuteNewNonContact = payload.shouldArchiveAndMuteNewNonContact\n    ?? Boolean(global.settings.byKey.shouldArchiveAndMuteNewNonContact);\n  const shouldHideReadMarks = payload.shouldHideReadMarks ?? Boolean(global.settings.byKey.shouldHideReadMarks);\n  const shouldNewNonContactPeersRequirePremium = payload.shouldNewNonContactPeersRequirePremium\n    ?? Boolean(global.settings.byKey.shouldNewNonContactPeersRequirePremium);\n    // eslint-disable-next-line no-null/no-null\n  const nonContactPeersPaidStars = payload.nonContactPeersPaidStars === null ? undefined\n    : payload.nonContactPeersPaidStars || global.settings.byKey.nonContactPeersPaidStars;\n  const shouldDisplayGiftsButton = payload.shouldDisplayGiftsButton\n    ?? Boolean(global.settings.byKey.shouldDisplayGiftsButton);\n  const disallowedGifts = payload.disallowedGifts\n    ?? global.settings.byKey.disallowedGifts;\n\n  // eslint-disable-next-line no-null/no-null\n  const shouldUpdateUsersSettings = (payload.nonContactPeersPaidStars === null)\n  || payload.nonContactPeersPaidStars;\n\n  global = getGlobal();\n  global = replaceSettings(global, {\n    shouldArchiveAndMuteNewNonContact,\n    shouldHideReadMarks,\n    shouldNewNonContactPeersRequirePremium,\n    nonContactPeersPaidStars,\n    shouldDisplayGiftsButton,\n    disallowedGifts,\n  });\n  setGlobal(global);\n\n  const result = await callApi('updateGlobalPrivacySettings', {\n    shouldArchiveAndMuteNewNonContact,\n    shouldHideReadMarks,\n    shouldNewNonContactPeersRequirePremium,\n    nonContactPeersPaidStars,\n    shouldDisplayGiftsButton,\n    disallowedGifts,\n  });\n\n  global = getGlobal();\n  global = replaceSettings(global, {\n    shouldArchiveAndMuteNewNonContact: !result\n      ? !shouldArchiveAndMuteNewNonContact\n      : result.shouldArchiveAndMuteNewNonContact,\n    shouldHideReadMarks: !result ? !shouldHideReadMarks : result.shouldHideReadMarks,\n    shouldNewNonContactPeersRequirePremium: !result\n      ? !shouldNewNonContactPeersRequirePremium\n      : result.shouldNewNonContactPeersRequirePremium,\n    nonContactPeersPaidStars: !result\n      ? undefined\n      : result.nonContactPeersPaidStars,\n    shouldDisplayGiftsButton: !result ? !shouldDisplayGiftsButton : result.shouldDisplayGiftsButton,\n    disallowedGifts: !result ? disallowedGifts : result.disallowedGifts,\n  });\n\n  if (shouldUpdateUsersSettings) {\n    Object.keys(global.users.fullInfoById).forEach((userId) => {\n      global = updateUserFullInfo(global, userId, {\n        settings: undefined,\n      });\n    });\n  }\n\n  setGlobal(global);\n});\n\naddActionHandler('toggleUsername', async (global, actions, payload): Promise<void> => {\n  const { username, isActive } = payload;\n  const { currentUserId } = global;\n  if (!currentUserId) {\n    return;\n  }\n\n  const currentUser = selectUser(global, currentUserId);\n  if (!currentUser?.usernames) {\n    return;\n  }\n\n  const usernames = currentUser.usernames.map((item) => {\n    if (item.username !== username) {\n      return item;\n    }\n\n    return { ...item, isActive: isActive || undefined };\n  });\n\n  global = updateUser(global, currentUserId, { usernames });\n  setGlobal(global);\n\n  const result = await callApi('toggleUsername', { username, isActive });\n\n  if (!result) {\n    actions.loadFullUser({ userId: currentUserId });\n  }\n});\n\naddActionHandler('toggleChatUsername', async (global, actions, payload): Promise<void> => {\n  const {\n    chatId, username, isActive,\n  } = payload;\n  const chat = selectChat(global, chatId);\n  if (!chat?.usernames) {\n    return;\n  }\n\n  const usernames = chat.usernames.map((item) => {\n    if (item.username !== username) {\n      return item;\n    }\n\n    return { ...item, isActive: isActive || undefined };\n  });\n\n  global = updateChat(global, chatId, { usernames });\n  setGlobal(global);\n\n  const result = await callApi('toggleUsername', {\n    chatId: chat.id,\n    accessHash: chat.accessHash,\n    username,\n    isActive,\n  });\n\n  if (!result) {\n    actions.loadFullChat({ chatId });\n  }\n});\n\naddActionHandler('sortUsernames', async (global, actions, payload): Promise<void> => {\n  const { usernames } = payload;\n  const { currentUserId } = global;\n  if (!currentUserId) {\n    return;\n  }\n\n  const result = await callApi('reorderUsernames', { usernames });\n\n  // After saving the order of usernames, server sends an update with the necessary data,\n  // so there is no need to update the state in this place\n  if (!result) {\n    actions.loadUser({ userId: currentUserId });\n  }\n});\n\naddActionHandler('sortChatUsernames', async (global, actions, payload): Promise<void> => {\n  const { chatId, usernames } = payload;\n  const chat = selectChat(global, chatId);\n  if (!chat) {\n    return;\n  }\n\n  const prevUsernames = [...chat.usernames!];\n  const sortedUsernames = chat.usernames!.reduce((res, currentUsername) => {\n    const idx = usernames.findIndex((username) => username === currentUsername.username);\n    res[idx] = currentUsername;\n\n    return res;\n  }, [] as ApiUsername[]);\n\n  global = updateChat(global, chatId, { usernames: sortedUsernames });\n  setGlobal(global);\n\n  const result = await callApi('reorderUsernames', {\n    chatId: chat.id,\n    accessHash: chat.accessHash,\n    usernames,\n  });\n\n  if (!result) {\n    global = getGlobal();\n    global = updateChat(global, chatId, { usernames: prevUsernames });\n    setGlobal(global);\n  }\n});","import type {\n  ApiChat,\n  ApiNotifyPeerType,\n  ApiPeer,\n  ApiPeerNotifySettings,\n} from '../../api/types';\n\nimport { omitUndefined } from '../../util/iteratees';\nimport { getServerTime } from '../../util/serverTime';\nimport { isChatChannel, isUserId } from './chats';\n\nexport function getIsChatMuted(\n  chat: ApiChat,\n  notifyDefaults?: Record<ApiNotifyPeerType, ApiPeerNotifySettings>,\n  notifyException?: ApiPeerNotifySettings,\n) {\n  const settings = getChatNotifySettings(chat, notifyDefaults, notifyException);\n  if (!settings?.mutedUntil) return false;\n  return getServerTime() < settings.mutedUntil;\n}\n\nexport function getIsChatSilent(\n  chat: ApiChat,\n  notifyDefaults?: Record<ApiNotifyPeerType, ApiPeerNotifySettings>,\n  notifyException?: ApiPeerNotifySettings,\n) {\n  const settings = getChatNotifySettings(chat, notifyDefaults, notifyException);\n  if (!settings) return false;\n  return !settings.hasSound;\n}\n\nexport function getShouldShowMessagePreview(\n  chat: ApiChat,\n  notifyDefaults?: Record<ApiNotifyPeerType, ApiPeerNotifySettings>,\n  notifyException?: ApiPeerNotifySettings,\n) {\n  const settings = getChatNotifySettings(chat, notifyDefaults, notifyException);\n  return Boolean(settings?.shouldShowPreviews);\n}\n\nexport function getChatNotifySettings(\n  chat: ApiChat,\n  notifyDefaults?: Record<ApiNotifyPeerType, ApiPeerNotifySettings>,\n  notifyException?: ApiPeerNotifySettings,\n): ApiPeerNotifySettings | undefined {\n  const defaults = notifyDefaults?.[getNotificationPeerType(chat)];\n\n  if (!notifyException && !defaults) {\n    return undefined;\n  }\n\n  return {\n    ...defaults,\n    ...(notifyException && omitUndefined(notifyException)),\n  };\n}\n\nexport function getNotificationPeerType(peer: ApiPeer): ApiNotifyPeerType {\n  if (isUserId(peer.id)) {\n    return 'users';\n  }\n\n  const chat = peer as ApiChat;\n  return isChatChannel(chat) ? 'channels' : 'groups';\n}\n","import { SVG_NAMESPACE } from '../config';\nimport { requestMutation } from '../lib/fasterdom/fasterdom';\nimport jsxToHtml from './element/jsxToHtml';\nimport generateUniqueId from './generateUniqueId';\n\nconst DEFINITION_MAP = new Map<string, Element>();\n\nlet defs: SVGElement | undefined;\n\nfunction init() {\n  if (defs) return;\n\n  const container = document.createElementNS(SVG_NAMESPACE, 'svg');\n  container.setAttribute('width', '0');\n  container.setAttribute('height', '0');\n  container.setAttribute('viewBox', '0 0 1 1');\n  container.classList.add('svg-definitions');\n  document.body.appendChild(container);\n\n  defs = document.createElementNS(SVG_NAMESPACE, 'defs');\n  container.appendChild(defs);\n}\n\nfunction appendElement(element: Element) {\n  requestMutation(() => {\n    if (!defs) init();\n    defs!.appendChild(element);\n  });\n}\n\nexport function addSvgDefinition(element: React.JSX.Element, id?: string) {\n  id ??= generateUniqueId();\n  element.props.id = id;\n\n  const htmlElement = jsxToHtml(element)[0];\n  DEFINITION_MAP.set(element.props.id, htmlElement);\n  appendElement(htmlElement);\n  return id;\n}\n\nexport function removeSvgDefinition(id: string) {\n  const element = DEFINITION_MAP.get(id);\n  if (element) {\n    requestMutation(() => {\n      element.remove();\n    });\n    DEFINITION_MAP.delete(id);\n  }\n}\n","import type { GlobalState, TabArgs } from '../types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport {\n  getCanAddContact,\n  isAnonymousForwardsChat,\n  isChatAdmin, isChatGroup, isUserBot, isUserId,\n} from '../helpers';\nimport { selectChat, selectIsChatWithSelf } from './chats';\nimport { selectCurrentMessageList } from './messages';\nimport { selectTabState } from './tabs';\nimport { selectBot, selectUser } from './users';\n\nexport function selectManagement<T extends GlobalState>(\n  global: T, chatId: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).management.byChatId[chatId];\n}\n\nexport function selectCurrentManagement<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { chatId, threadId } = selectCurrentMessageList(global, tabId) || {};\n  if (!chatId || !threadId) {\n    return undefined;\n  }\n\n  const currentManagement = selectTabState(global, tabId).management.byChatId[chatId];\n  if (!currentManagement?.isActive) {\n    return undefined;\n  }\n\n  return currentManagement;\n}\n\nexport function selectCurrentManagementType<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { chatId, threadId } = selectCurrentMessageList(global, tabId) || {};\n\n  if (!chatId || !threadId) {\n    return undefined;\n  }\n\n  const chatBot = selectBot(global, chatId);\n  if (chatBot) {\n    return 'bot';\n  }\n\n  if (isUserId(chatId)) {\n    return 'user';\n  }\n\n  const chat = selectChat(global, chatId);\n  if (!chat) {\n    return undefined;\n  }\n\n  if (isChatGroup(chat)) {\n    return 'group';\n  }\n\n  return 'channel';\n}\n\nexport function selectCanManage<T extends GlobalState>(\n  global: T,\n  chatId: string,\n) {\n  const chat = selectChat(global, chatId);\n  if (!chat || chat.isRestricted) return false;\n\n  const isPrivate = isUserId(chat.id);\n  const user = isPrivate ? selectUser(global, chatId) : undefined;\n  const canAddContact = user && getCanAddContact(user);\n\n  const isBot = user && isUserBot(user);\n  return Boolean(\n    !canAddContact\n    && chat\n    && !selectIsChatWithSelf(global, chat.id)\n    && !isAnonymousForwardsChat(chat.id)\n    // chat.isCreator is for Basic Groups\n    && (isUserId(chat.id) || ((isChatAdmin(chat) || chat.isCreator) && !chat.isNotJoined))\n    && !isBot,\n  );\n}\n","import type { GlobalState, TabArgs } from '../types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { selectChatFullInfo } from './chats';\nimport { selectCurrentMessageList } from './messages';\nimport { selectTabState } from './tabs';\n\nexport function selectStatistics<T extends GlobalState>(\n  global: T, chatId: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).statistics.byChatId[chatId];\n}\n\nexport function selectIsStatisticsShown<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  if (!selectTabState(global, tabId).isStatisticsShown) {\n    return false;\n  }\n\n  const { chatId: currentChatId } = selectCurrentMessageList(global, tabId) || {};\n\n  return currentChatId ? selectChatFullInfo(global, currentChatId)?.canViewStatistics : undefined;\n}\n","import type { ApiMessage, ApiSponsoredMessage } from '../../api/types';\nimport type { PerformanceTypeKey, ThemeKey } from '../../types';\nimport type { GlobalState, TabArgs } from '../types';\nimport { NewChatMembersProgress, RightColumnContent } from '../../types';\n\nimport { IS_SNAP_EFFECT_SUPPORTED } from '../../util/browser/windowEnvironment';\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { getMessageVideo, getMessageWebPageVideo } from '../helpers/messageMedia';\nimport { selectCurrentManagement } from './management';\nimport { selectSharedSettings } from './sharedState';\nimport { selectIsStatisticsShown } from './statistics';\nimport { selectTabState } from './tabs';\n\nexport function selectIsMediaViewerOpen<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const {\n    mediaViewer: {\n      chatId,\n      messageId,\n      isAvatarView,\n      standaloneMedia,\n      isSponsoredMessage,\n    },\n  } = selectTabState(global, tabId);\n  return Boolean(standaloneMedia || (chatId && (isAvatarView || messageId || isSponsoredMessage)));\n}\n\nexport function selectRightColumnContentKey<T extends GlobalState>(\n  global: T,\n  isMobile?: boolean,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const tabState = selectTabState(global, tabId);\n\n  return tabState.editTopicPanel ? (\n    RightColumnContent.EditTopic\n  ) : tabState.createTopicPanel ? (\n    RightColumnContent.CreateTopic\n  ) : tabState.pollResults.messageId ? (\n    RightColumnContent.PollResults\n  ) : selectCurrentManagement(global, tabId) ? (\n    RightColumnContent.Management\n  ) : tabState.isStatisticsShown && tabState.statistics.currentMessageId ? (\n    RightColumnContent.MessageStatistics\n  ) : tabState.isStatisticsShown && tabState.statistics.currentStoryId ? (\n    RightColumnContent.StoryStatistics\n  ) : selectIsStatisticsShown(global, tabId) ? (\n    RightColumnContent.Statistics\n  ) : tabState.boostStatistics ? (\n    RightColumnContent.BoostStatistics\n  ) : tabState.monetizationStatistics ? (\n    RightColumnContent.MonetizationStatistics\n  ) : tabState.stickerSearch.query !== undefined ? (\n    RightColumnContent.StickerSearch\n  ) : tabState.gifSearch.query !== undefined ? (\n    RightColumnContent.GifSearch\n  ) : tabState.newChatMembersProgress !== NewChatMembersProgress.Closed ? (\n    RightColumnContent.AddingMembers\n  ) : tabState.isChatAIShown ? (\n    RightColumnContent.ChatAI\n  ) : tabState.isChatInfoShown && tabState.messageLists.length ? (\n    RightColumnContent.ChatInfo\n  ) : undefined;\n}\n\nexport function selectIsRightColumnShown<T extends GlobalState>(\n  global: T,\n  isMobile?: boolean,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectRightColumnContentKey(global, isMobile, tabId) !== undefined;\n}\n\nexport function selectTheme<T extends GlobalState>(global: T) {\n  return selectSharedSettings(global).theme;\n}\n\nexport function selectThemeValues<T extends GlobalState>(global: T, themeKey: ThemeKey) {\n  return global.settings.themes[themeKey];\n}\n\nexport function selectIsForumPanelOpen<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const tabState = selectTabState(global, tabId);\n\n  return Boolean(tabState.forumPanelChatId) && (\n    tabState.globalSearch.query === undefined || Boolean(tabState.globalSearch.isClosing)\n  );\n}\n\nexport function selectIsForumPanelClosed<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return !selectIsForumPanelOpen(global, tabId);\n}\n\nexport function selectIsReactionPickerOpen<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { reactionPicker } = selectTabState(global, tabId);\n  return Boolean(reactionPicker?.position);\n}\n\nexport function selectPerformanceSettings<T extends GlobalState>(global: T) {\n  return selectSharedSettings(global).performance;\n}\n\nexport function selectPerformanceSettingsValue<T extends GlobalState>(\n  global: T,\n  key: PerformanceTypeKey,\n) {\n  return selectPerformanceSettings(global)[key];\n}\n\nexport function selectCanAutoPlayMedia<T extends GlobalState>(global: T, message: ApiMessage | ApiSponsoredMessage) {\n  const video = getMessageVideo(message) || getMessageWebPageVideo(message);\n  if (!video) {\n    return undefined;\n  }\n\n  const canAutoPlayVideos = selectPerformanceSettingsValue(global, 'autoplayVideos');\n  const canAutoPlayGifs = selectPerformanceSettingsValue(global, 'autoplayGifs');\n\n  const asGif = video.isGif || video.isRound;\n\n  return (canAutoPlayVideos && !asGif) || (canAutoPlayGifs && asGif);\n}\n\nexport function selectShouldLoopStickers<T extends GlobalState>(global: T) {\n  return selectPerformanceSettingsValue(global, 'loopAnimatedStickers');\n}\n\nexport function selectCanPlayAnimatedEmojis<T extends GlobalState>(global: T) {\n  return selectPerformanceSettingsValue(global, 'animatedEmoji');\n}\n\nexport function selectCanAnimateInterface<T extends GlobalState>(global: T) {\n  return selectPerformanceSettingsValue(global, 'pageTransitions');\n}\n\nexport function selectIsContextMenuTranslucent<T extends GlobalState>(global: T) {\n  return selectPerformanceSettingsValue(global, 'contextMenuBlur');\n}\n\nexport function selectIsSynced<T extends GlobalState>(global: T) {\n  return global.isSynced;\n}\n\nexport function selectCanAnimateSnapEffect<T extends GlobalState>(global: T) {\n  return IS_SNAP_EFFECT_SUPPORTED && selectPerformanceSettingsValue(global, 'snapEffect');\n}\n\nexport function selectWebApp<T extends GlobalState>(\n  global: T, key: string, ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).webApps.openedWebApps[key];\n}\n\nexport function selectActiveWebApp<T extends GlobalState>(\n  global: T, ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const activeWebAppKey = selectTabState(global, tabId).webApps.activeWebAppKey;\n  if (!activeWebAppKey) return undefined;\n\n  return selectWebApp(global, activeWebAppKey, tabId);\n}\n","import type { GlobalState, TabArgs } from '../types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { selectTabState } from './tabs';\n\nexport function selectCurrentGlobalSearchQuery<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).globalSearch.query;\n}\n","import type { GlobalState, TabArgs } from '../types';\n\nimport { DEFAULT_GIFT_PROFILE_FILTER_OPTIONS } from '../../config';\nimport arePropsShallowEqual from '../../util/arePropsShallowEqual';\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport {\n  getHasAdminRight, isChatAdmin, isChatChannel,\n} from '../helpers';\nimport { selectChat } from './chats';\nimport { selectTabState } from './tabs';\nimport { selectUser } from './users';\n\nexport function selectPaymentInputInvoice<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).payment.inputInvoice;\n}\n\nexport function selectPaymentForm<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).payment.form;\n}\n\nexport function selectStarsPayment<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).starsPayment;\n}\n\nexport function selectPaymentRequestId<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).payment.requestId;\n}\n\nexport function selectProviderPublishableKey<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).payment.form?.nativeParams.publishableKey;\n}\n\nexport function selectProviderPublicToken<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).payment.form?.nativeParams.publicToken;\n}\n\nexport function selectStripeCredentials<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).payment.stripeCredentials;\n}\n\nexport function selectSmartGlocalCredentials<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).payment.smartGlocalCredentials;\n}\n\nexport function selectCanUseGiftProfileAdminFilter<T extends GlobalState>(\n  global: T, peerId: string,\n) {\n  const chat = selectChat(global, peerId);\n  const isCurrentUser = global.currentUserId === peerId;\n  return isCurrentUser || (chat && isChatChannel(chat) && isChatAdmin(chat) && getHasAdminRight(chat, 'postMessages'));\n}\n\nexport function selectCanUseGiftProfileFilter<T extends GlobalState>(\n  global: T, peerId: string,\n) {\n  const chat = selectChat(global, peerId);\n  const user = selectUser(global, peerId);\n  return Boolean(user) || (chat && isChatChannel(chat));\n}\n\nexport function selectGiftProfileFilter<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectCanUseGiftProfileFilter(global, peerId) ? selectTabState(global, tabId).savedGifts.filter : undefined;\n}\n\nexport function selectIsGiftProfileFilterDefault<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return arePropsShallowEqual(selectTabState(global, tabId).savedGifts.filter, DEFAULT_GIFT_PROFILE_FILTER_OPTIONS);\n}\n","import type { GlobalState } from '../types';\n\nimport { ACCOUNT_SLOT, getAccountsInfo } from '../../util/multiaccount';\nimport { selectSharedSettings } from './sharedState';\n\nexport function selectNotifySettings<T extends GlobalState>(global: T) {\n  return global.settings.byKey;\n}\n\nexport function selectNotifyDefaults<T extends GlobalState>(global: T) {\n  return global.settings.notifyDefaults;\n}\n\nexport function selectNotifyException<T extends GlobalState>(global: T, chatId: string) {\n  return global.chats.notifyExceptionById?.[chatId];\n}\n\nexport function selectLanguageCode<T extends GlobalState>(global: T) {\n  return selectSharedSettings(global).language.replace('-raw', '');\n}\n\nexport function selectCanSetPasscode<T extends GlobalState>(global: T) {\n  // TODO[passcode]: remove this when multiacc passcode is implemented\n  const accounts = getAccountsInfo();\n  return global.authRememberMe && !ACCOUNT_SLOT && Object.keys(accounts).length === 1;\n}\n\nexport function selectTranslationLanguage<T extends GlobalState>(global: T) {\n  return global.settings.byKey.translationLanguage || selectLanguageCode(global);\n}\n\nexport function selectNewNoncontactPeersRequirePremium<T extends GlobalState>(global: T) {\n  return global.settings.byKey.shouldNewNonContactPeersRequirePremium;\n}\n\nexport function selectNonContactPeersPaidStars<T extends GlobalState>(global: T) {\n  return global.settings.byKey.nonContactPeersPaidStars;\n}\n\nexport function selectShouldHideReadMarks<T extends GlobalState>(global: T) {\n  return global.settings.byKey.shouldHideReadMarks;\n}\n\nexport function selectSettingsKeys<T extends GlobalState>(global: T) {\n  return global.settings.byKey;\n}\n","import type { ApiSticker, ApiStickerSet, ApiStickerSetInfo } from '../../api/types';\nimport type { GlobalState, TabArgs } from '../types';\n\nimport { RESTRICTED_EMOJI_SET_ID } from '../../config';\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { selectTabState } from './tabs';\nimport { selectIsCurrentUserPremium } from './users';\n\n// https://github.com/DrKLO/Telegram/blob/c319639e9a4dff2f22da6762dcebd12d49f5afa1/TMessagesProj/src/main/java/org/telegram/ui/Components/Premium/boosts/cells/msg/GiveawayMessageCell.java#L59\nconst MONTH_EMOTICON: Record<number, string> = {\n  1: `${1}\\u{FE0F}\\u20E3`,\n  3: `${2}\\u{FE0F}\\u20E3`,\n  6: `${3}\\u{FE0F}\\u20E3`,\n  12: `${4}\\u{FE0F}\\u20E3`,\n  24: `${5}\\u{FE0F}\\u20E3`,\n};\n\nconst STAR_EMOTICON: Record<number, string> = {\n  1000: `${2}\\u{FE0F}\\u20E3`,\n  2500: `${3}\\u{FE0F}\\u20E3`,\n  5000: `${4}\\u{FE0F}\\u20E3`,\n};\n\nexport function selectIsStickerFavorite<T extends GlobalState>(global: T, sticker: ApiSticker) {\n  const { stickers } = global.stickers.favorite;\n  return stickers && stickers.some(({ id }) => id === sticker.id);\n}\n\nexport function selectCurrentStickerSearch<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).stickerSearch;\n}\n\nexport function selectCurrentGifSearch<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).gifSearch;\n}\n\nexport function selectStickerSet<T extends GlobalState>(global: T, id: string | ApiStickerSetInfo) {\n  if (typeof id === 'string') {\n    return global.stickers.setsById[id];\n  }\n\n  if ('id' in id) {\n    return global.stickers.setsById[id.id];\n  }\n\n  if ('isMissing' in id) return undefined;\n\n  return Object.values(global.stickers.setsById).find(({ shortName }) => (\n    shortName.toLowerCase() === id.shortName.toLowerCase()\n  ));\n}\n\nexport function selectStickersForEmoji<T extends GlobalState>(global: T, emoji: string) {\n  const addedSets = global.stickers.added.setIds;\n  let stickersForEmoji: ApiSticker[] = [];\n  // Favorites\n  global.stickers.favorite.stickers.forEach((sticker) => {\n    if (sticker.emoji === emoji) stickersForEmoji.push(sticker);\n  });\n\n  // Added sets\n  addedSets?.forEach((id) => {\n    const packs = global.stickers.setsById[id].packs;\n    if (!packs) {\n      return;\n    }\n\n    stickersForEmoji = stickersForEmoji.concat(packs[emoji] || [], packs[cleanEmoji(emoji)] || []);\n  });\n  return stickersForEmoji;\n}\n\nexport function selectCustomEmojiForEmoji<T extends GlobalState>(global: T, emoji: string) {\n  const isCurrentUserPremium = selectIsCurrentUserPremium(global);\n  const addedCustomSets = global.customEmojis.added.setIds;\n  let customEmojiForEmoji: ApiSticker[] = [];\n\n  // Added sets\n  addedCustomSets?.forEach((id) => {\n    const packs = global.stickers.setsById[id].packs;\n    if (!packs) {\n      return;\n    }\n\n    customEmojiForEmoji = customEmojiForEmoji.concat(packs[emoji] || [], packs[cleanEmoji(emoji)] || []);\n  });\n  return isCurrentUserPremium ? customEmojiForEmoji : customEmojiForEmoji.filter(({ isFree }) => isFree);\n}\n\n// Slow, not to be used in `withGlobal`\nexport function selectCustomEmojiForEmojis<T extends GlobalState>(global: T, emojis: string[]) {\n  const isCurrentUserPremium = selectIsCurrentUserPremium(global);\n  const addedCustomSets = global.customEmojis.added.setIds;\n  let customEmojiForEmoji: ApiSticker[] = [];\n\n  // Added sets\n  addedCustomSets?.forEach((id) => {\n    const packs = global.stickers.setsById[id].packs;\n    if (!packs) {\n      return;\n    }\n    const customEmojis = Object.entries(packs).filter(([emoji]) => (\n      emojis.includes(emoji) || emojis.includes(cleanEmoji(emoji))\n    )).flatMap(([, stickers]) => stickers);\n    customEmojiForEmoji = customEmojiForEmoji.concat(customEmojis);\n  });\n  return isCurrentUserPremium ? customEmojiForEmoji : customEmojiForEmoji.filter(({ isFree }) => isFree);\n}\n\nexport function selectIsSetPremium(stickerSet: Pick<ApiStickerSet, 'stickers' | 'isEmoji'>) {\n  return stickerSet.isEmoji && stickerSet.stickers?.some((sticker) => !sticker.isFree);\n}\n\nfunction cleanEmoji(emoji: string) {\n  // Some emojis (❤️ for example) with a service symbol 'VARIATION SELECTOR-16' are not recognized as animated\n  return emoji.replace('\\ufe0f', '');\n}\n\nexport function selectAnimatedEmoji<T extends GlobalState>(global: T, emoji: string) {\n  const { animatedEmojis } = global;\n  if (!animatedEmojis || !animatedEmojis.stickers) {\n    return undefined;\n  }\n\n  const cleanedEmoji = cleanEmoji(emoji);\n\n  return animatedEmojis.stickers.find((sticker) => sticker.emoji === emoji || sticker.emoji === cleanedEmoji);\n}\n\nexport function selectRestrictedEmoji<T extends GlobalState>(global: T, emoji: string) {\n  const { restrictedEmoji } = global;\n  if (!restrictedEmoji || !restrictedEmoji.stickers) {\n    return undefined;\n  }\n\n  const cleanedEmoji = cleanEmoji(emoji);\n\n  return restrictedEmoji.stickers.find((sticker) => {\n    if (!sticker.emoji) return undefined;\n    const cleanedStickerEmoji = cleanEmoji(sticker.emoji);\n    return cleanedStickerEmoji === cleanedEmoji;\n  });\n}\n\nexport function selectAnimatedEmojiEffect<T extends GlobalState>(global: T, emoji: string) {\n  const { animatedEmojiEffects } = global;\n  if (!animatedEmojiEffects || !animatedEmojiEffects.stickers) {\n    return undefined;\n  }\n\n  const cleanedEmoji = cleanEmoji(emoji);\n\n  return animatedEmojiEffects.stickers.find((sticker) => sticker.emoji === emoji || sticker.emoji === cleanedEmoji);\n}\n\nexport function selectAnimatedEmojiSound<T extends GlobalState>(global: T, emoji: string) {\n  return global?.appConfig?.emojiSounds[cleanEmoji(emoji)];\n}\n\nexport function selectIsAlwaysHighPriorityEmoji<T extends GlobalState>(\n  global: T, stickerSet: ApiStickerSetInfo | ApiStickerSet,\n) {\n  if (!('id' in stickerSet)) return false;\n  return stickerSet.id === global.appConfig?.defaultEmojiStatusesStickerSetId\n    || stickerSet.id === RESTRICTED_EMOJI_SET_ID;\n}\n\nexport function selectGiftStickerForDuration<T extends GlobalState>(global: T, duration = 1) {\n  const stickers = global.premiumGifts?.stickers;\n  if (!stickers) return undefined;\n  const emoji = MONTH_EMOTICON[duration];\n  return stickers.find((sticker) => sticker.emoji === emoji) || stickers[0];\n}\n\nexport function selectGiftStickerForStars<T extends GlobalState>(global: T, starCount?: number) {\n  const stickers = global.premiumGifts?.stickers;\n\n  if (!stickers || !starCount) return undefined;\n\n  let emoji;\n  if (starCount <= 1000) {\n    emoji = STAR_EMOTICON[1000];\n  } else if (starCount < 2500) {\n    emoji = STAR_EMOTICON[2500];\n  } else {\n    emoji = STAR_EMOTICON[5000];\n  }\n\n  return stickers.find((sticker) => sticker.emoji === emoji) || stickers[0];\n}\n","import type { GlobalState } from '../types';\n\nexport function selectSharedState<T extends GlobalState>(\n  global: T,\n) {\n  return global.sharedState;\n}\n\nexport function selectSharedSettings<T extends GlobalState>(\n  global: T,\n) {\n  return selectSharedState(global).settings;\n}\n","import { useCallback, useState } from '../lib/teact/teact';\n\nconst useForceUpdate = () => {\n  const [, setTrigger] = useState<boolean>(false);\n\n  return useCallback(() => {\n    setTrigger((trigger) => !trigger);\n  }, []);\n};\n\nexport default useForceUpdate;\n","import type {\n  ApiLimitType, ApiLimitTypeForPromo, ApiPremiumSection, ApiReactionEmoji,\n} from './api/types';\nimport type {\n  GiftProfileFilterOptions,\n} from './types';\n\nexport const APP_CODE_NAME = 'A';\nexport const APP_NAME = process.env.APP_NAME || `Telegram Web ${APP_CODE_NAME}`;\nexport const RELEASE_DATETIME = process.env.RELEASE_DATETIME;\n\nexport const PRODUCTION_HOSTNAME = 'web.telegram.org';\nexport const PRODUCTION_URL = 'https://web.telegram.org/a';\nexport const WEB_VERSION_BASE = 'https://web.telegram.org/'; // Used to redirect to other versions\nexport const BASE_URL = process.env.BASE_URL;\nexport const ACCOUNT_QUERY = 'account';\n\nexport const IS_MOCKED_CLIENT = process.env.APP_MOCKED_CLIENT === '1';\nexport const IS_TEST = process.env.APP_ENV === 'test';\nexport const IS_PERF = process.env.APP_ENV === 'perf';\nexport const IS_BETA = process.env.APP_ENV === 'staging';\nexport const IS_PACKAGED_ELECTRON = process.env.IS_PACKAGED_ELECTRON;\nexport const PAID_MESSAGES_PURPOSE = 'paid_messages';\n\nexport const DEBUG = process.env.APP_ENV !== 'production';\nexport const DEBUG_MORE = false;\nexport const DEBUG_LOG_FILENAME = 'tt-log.json';\nexport const STRICTERDOM_ENABLED = DEBUG;\nexport const BOT_VERIFICATION_PEERS_LIMIT = 20;\n\nexport const BETA_CHANGELOG_URL = 'https://telegra.ph/WebA-Beta-03-20';\nexport const ELECTRON_HOST_URL = process.env.ELECTRON_HOST_URL!;\n\nexport const DEBUG_ALERT_MSG = 'Shoot!\\nSomething went wrong, please see the error details in Dev Tools Console.';\nexport const DEBUG_GRAMJS = false;\n\nexport const PAGE_TITLE = process.env.APP_TITLE!;\nexport const INACTIVE_MARKER = '[Inactive]';\n\nexport const DEBUG_PAYMENT_SMART_GLOCAL = false;\n\nexport const SESSION_LEGACY_USER_KEY = 'user_auth';\nexport const SESSION_ACCOUNT_PREFIX = 'account';\nexport const LEGACY_PASSCODE_CACHE_NAME = 'tt-passcode';\n\nexport const MULTIACCOUNT_MAX_SLOTS = 6;\nexport const GLOBAL_STATE_CACHE_DISABLED = false;\nexport const GLOBAL_STATE_CACHE_PREFIX = 'tt-global-state';\nexport const SHARED_STATE_CACHE_KEY = 'tt-shared-state';\nexport const GLOBAL_STATE_CACHE_USER_LIST_LIMIT = 500;\nexport const GLOBAL_STATE_CACHE_CHAT_LIST_LIMIT = 200;\nexport const GLOBAL_STATE_CACHE_ARCHIVED_CHAT_LIST_LIMIT = 10;\nexport const GLOBAL_STATE_CACHE_CUSTOM_EMOJI_LIMIT = 150;\n\nexport const IS_SCREEN_LOCKED_CACHE_KEY = 'tt-is-screen-locked';\n\nexport const MEDIA_CACHE_DISABLED = false;\nexport const MEDIA_CACHE_NAME = 'tt-media';\nexport const MEDIA_CACHE_NAME_AVATARS = 'tt-media-avatars';\nexport const MEDIA_PROGRESSIVE_CACHE_DISABLED = false;\nexport const MEDIA_PROGRESSIVE_CACHE_NAME = 'tt-media-progressive';\nexport const MEDIA_CACHE_MAX_BYTES = 512 * 1024; // 512 KB\nexport const CUSTOM_BG_CACHE_NAME = 'tt-custom-bg';\nexport const LANG_CACHE_NAME = 'tt-lang-packs-v49';\nexport const ASSET_CACHE_NAME = 'tt-assets';\nexport const AUTODOWNLOAD_FILESIZE_MB_LIMITS = [1, 5, 10, 50, 100, 500];\nexport const DATA_BROADCAST_CHANNEL_PREFIX = 'tt-global';\nexport const ESTABLISH_BROADCAST_CHANNEL_PREFIX = 'tt-establish';\nexport const MULTITAB_LOCALSTORAGE_KEY_PREFIX = 'tt-multitab';\nexport const DC_IDS = [1, 2, 3, 4, 5] as const;\n\nexport const DOWNLOAD_WORKERS = 16;\nexport const UPLOAD_WORKERS = 16;\n\nconst isBigScreen = typeof window !== 'undefined' && window.innerHeight >= 900;\n\nexport const MIN_PASSWORD_LENGTH = 1;\n\nexport const MESSAGE_LIST_SLICE = isBigScreen ? 60 : 40;\nexport const MESSAGE_LIST_VIEWPORT_LIMIT = MESSAGE_LIST_SLICE * 2;\n\nexport const ARCHIVE_MINIMIZED_HEIGHT = 36;\nexport const CHAT_HEIGHT_PX = 72;\nexport const TOPIC_HEIGHT_PX = 65;\nexport const PEER_PICKER_ITEM_HEIGHT_PX = 56;\nexport const CHAT_LIST_SLICE = isBigScreen ? 30 : 25;\nexport const CHAT_LIST_LOAD_SLICE = 100;\nexport const SHARED_MEDIA_SLICE = 42;\nexport const CHAT_MEDIA_SLICE = 42;\nexport const MESSAGE_SEARCH_SLICE = 42;\nexport const GLOBAL_SEARCH_SLICE = 20;\nexport const GLOBAL_TOPIC_SEARCH_SLICE = 5;\nexport const GLOBAL_SEARCH_CONTACTS_LIMIT = 20;\nexport const MEMBERS_SLICE = 30;\nexport const MEMBERS_LOAD_SLICE = 200;\nexport const PINNED_MESSAGES_LIMIT = 50;\nexport const BLOCKED_LIST_LIMIT = 100;\nexport const PROFILE_SENSITIVE_AREA = 500;\nexport const TOPIC_LIST_SENSITIVE_AREA = 600;\nexport const GROUP_CALL_PARTICIPANTS_LIMIT = 100;\nexport const STORY_LIST_LIMIT = 100;\nexport const API_GENERAL_ID_LIMIT = 100;\nexport const STATISTICS_PUBLIC_FORWARDS_LIMIT = 50;\n\nexport const STORY_VIEWS_MIN_SEARCH = 15;\nexport const STORY_MIN_REACTIONS_SORT = 10;\nexport const STORY_VIEWS_MIN_CONTACTS_FILTER = 20;\n\nexport const MEDIA_TIMESTAMP_SAVE_MINIMUM_DURATION = 30; // 30s\n\nexport const GLOBAL_SUGGESTED_CHANNELS_ID = 'global';\n\n// As in Telegram for Android\n// https://github.com/DrKLO/Telegram/blob/51e9947527/TMessagesProj/src/main/java/org/telegram/messenger/MediaDataController.java#L7799\nexport const TOP_REACTIONS_LIMIT = 100;\n\n// As in Telegram for Android\n// https://github.com/DrKLO/Telegram/blob/51e9947527/TMessagesProj/src/main/java/org/telegram/messenger/MediaDataController.java#L7781\nexport const RECENT_REACTIONS_LIMIT = 50;\nexport const REACTION_LIST_LIMIT = 100;\nexport const REACTION_UNREAD_SLICE = 100;\nexport const MENTION_UNREAD_SLICE = 100;\nexport const TOPICS_SLICE = 20;\nexport const TOPICS_SLICE_SECOND_LOAD = 500;\n\nexport const TOP_CHAT_MESSAGES_PRELOAD_LIMIT = 20;\n\nexport const SPONSORED_MESSAGE_CACHE_MS = 300000; // 5 min\n\nexport const DEFAULT_CHARGE_FOR_MESSAGES = 250;\nexport const MINIMUM_CHARGE_FOR_MESSAGES = 1;\nexport const DEFAULT_MAXIMUM_CHARGE_FOR_MESSAGES = 10000;\n\nexport const DEFAULT_VOLUME = 1;\nexport const DEFAULT_PLAYBACK_RATE = 1;\nexport const PLAYBACK_RATE_FOR_AUDIO_MIN_DURATION = 20 * 60; // 20 min\n\nexport const ANIMATION_LEVEL_CUSTOM = -1;\nexport const ANIMATION_LEVEL_MIN = 0;\nexport const ANIMATION_LEVEL_MED = 1;\nexport const ANIMATION_LEVEL_MAX = 2;\nexport const ANIMATION_LEVEL_DEFAULT = ANIMATION_LEVEL_MAX;\n\nexport const DEFAULT_MESSAGE_TEXT_SIZE_PX = 16;\nexport const IOS_DEFAULT_MESSAGE_TEXT_SIZE_PX = 17;\nexport const MACOS_DEFAULT_MESSAGE_TEXT_SIZE_PX = 15;\n\nexport const PREVIEW_AVATAR_COUNT = 3;\n\nexport const DRAFT_DEBOUNCE = 10000; // 10s\nexport const SEND_MESSAGE_ACTION_INTERVAL = 3000; // 3s\n// 10000s from https://corefork.telegram.org/api/url-authorization#automatic-authorization\nexport const APP_CONFIG_REFETCH_INTERVAL = 10000 * 1000;\nexport const GENERAL_REFETCH_INTERVAL = 60 * 60 * 1000; // 1h\n\nexport const EDITABLE_INPUT_ID = 'editable-message-text';\nexport const EDITABLE_INPUT_MODAL_ID = 'editable-message-text-modal';\nexport const EDITABLE_STORY_INPUT_ID = 'editable-story-input-text';\n// eslint-disable-next-line max-len\nexport const EDITABLE_INPUT_CSS_SELECTOR = `.messages-layout .Transition_slide-active #${EDITABLE_INPUT_ID}, .messages-layout .Transition > .Transition_slide-to #${EDITABLE_INPUT_ID}`;\nexport const EDITABLE_INPUT_MODAL_CSS_SELECTOR = `#${EDITABLE_INPUT_MODAL_ID}`;\nexport const EDITABLE_STORY_INPUT_CSS_SELECTOR = `#${EDITABLE_STORY_INPUT_ID}`;\n\nexport const CUSTOM_APPENDIX_ATTRIBUTE = 'data-has-custom-appendix';\nexport const MESSAGE_CONTENT_CLASS_NAME = 'message-content';\nexport const MESSAGE_CONTENT_SELECTOR = '.message-content';\nexport const VIEW_TRANSITION_CLASS_NAME = 'active-view-transition';\n\nexport const RESIZE_HANDLE_CLASS_NAME = 'resizeHandle';\nexport const RESIZE_HANDLE_SELECTOR = `.${RESIZE_HANDLE_CLASS_NAME}`;\n\nexport const SNAP_EFFECT_CONTAINER_ID = 'snap-effect-container';\nexport const SNAP_EFFECT_ID = 'snap-effect';\n\nexport const STARS_ICON_PLACEHOLDER = '⭐';\nexport const STARS_CURRENCY_CODE = 'XTR';\n\nexport const MIN_SCREEN_WIDTH_FOR_STATIC_RIGHT_COLUMN = 1275; // px\nexport const MIN_SCREEN_WIDTH_FOR_STATIC_LEFT_COLUMN = 925; // px\nexport const MOBILE_SCREEN_MAX_WIDTH = 600; // px\nexport const MOBILE_SCREEN_LANDSCAPE_MAX_WIDTH = 950; // px\nexport const MOBILE_SCREEN_LANDSCAPE_MAX_HEIGHT = 450; // px\n\nexport const MAX_INT_32 = 2 ** 31 - 1;\nexport const TMP_CHAT_ID = '0';\n\nexport const ANIMATION_END_DELAY = 100;\nexport const ANIMATION_WAVE_MIN_INTERVAL = 200;\nexport const MESSAGE_APPEARANCE_DELAY = 10;\nexport const PAID_SEND_DELAY = 5000;\n\nexport const SCROLL_MIN_DURATION = 300;\nexport const SCROLL_MAX_DURATION = 600;\nexport const SCROLL_MAX_DISTANCE = 800;\nexport const SCROLL_SHORT_TRANSITION_MAX_DISTANCE = 300; // px\n\n// Average duration of message sending animation\nexport const API_UPDATE_THROTTLE = Math.round((SCROLL_MIN_DURATION + SCROLL_MAX_DURATION) / 2);\nexport const API_THROTTLE_RESET_UPDATES = new Set([\n  'newMessage',\n  'newScheduledMessage',\n  'deleteMessages',\n  'deleteScheduledMessages',\n  'deleteHistory',\n  'deleteParticipantHistory',\n]);\n\nexport const LOCK_SCREEN_ANIMATION_DURATION_MS = 200;\n\nexport const STICKER_SIZE_INLINE_DESKTOP_FACTOR = 13;\nexport const STICKER_SIZE_INLINE_MOBILE_FACTOR = 11;\nexport const STICKER_SIZE_AUTH = 160;\nexport const STICKER_SIZE_AUTH_MOBILE = 120;\nexport const STICKER_SIZE_PICKER = 72;\nexport const EMOJI_SIZE_PICKER = 36;\nexport const COMPOSER_EMOJI_SIZE_PICKER = 32;\nexport const STICKER_SIZE_GENERAL_SETTINGS = 40;\nexport const STICKER_SIZE_PICKER_HEADER = 32;\nexport const STICKER_PICKER_MAX_SHARED_COVERS = 20;\nexport const STICKER_SIZE_SEARCH = 72;\nexport const STICKER_SIZE_MODAL = 72;\nexport const EMOJI_SIZE_MODAL = 36;\nexport const STICKER_SIZE_TWO_FA = 160;\nexport const STICKER_SIZE_PASSCODE = 160;\nexport const STICKER_SIZE_DISCUSSION_GROUPS = 140;\nexport const STICKER_SIZE_FOLDER_SETTINGS = 100;\nexport const STICKER_SIZE_INLINE_BOT_RESULT = 100;\nexport const STICKER_SIZE_JOIN_REQUESTS = 140;\nexport const STICKER_SIZE_INVITES = 140;\nexport const RECENT_STICKERS_LIMIT = 20;\nexport const RECENT_STATUS_LIMIT = 20;\nexport const EMOJI_STATUS_LOOP_LIMIT = 2;\nexport const EMOJI_SIZES = 7;\nexport const TOP_SYMBOL_SET_ID = 'top';\nexport const POPULAR_SYMBOL_SET_ID = 'popular';\nexport const RECENT_SYMBOL_SET_ID = 'recent';\nexport const COLLECTIBLE_STATUS_SET_ID = 'collectibleStatus';\nexport const FAVORITE_SYMBOL_SET_ID = 'favorite';\nexport const EFFECT_STICKERS_SET_ID = 'effectStickers';\nexport const EFFECT_EMOJIS_SET_ID = 'effectEmojis';\nexport const CHAT_STICKER_SET_ID = 'chatStickers';\nexport const DEFAULT_TOPIC_ICON_STICKER_ID = 'topic-default-icon';\nexport const DEFAULT_STATUS_ICON_ID = 'status-default-icon';\nexport const EMOJI_IMG_REGEX = /<img[^>]+alt=\"([^\"]+)\"(?![^>]*data-document-id)[^>]*>/gm;\n\nexport const BASE_EMOJI_KEYWORD_LANG = 'en';\n\nexport const MENU_TRANSITION_DURATION = 200;\nexport const SLIDE_TRANSITION_DURATION = 450;\n\nexport const BIRTHDAY_NUMBERS_SET = 'FestiveFontEmoji';\nexport const RESTRICTED_EMOJI_SET = 'RestrictedEmoji';\n\nexport const SVG_NAMESPACE = 'http://www.w3.org/2000/svg';\n\nexport const VIDEO_WEBM_TYPE = 'video/webm';\nexport const GIF_MIME_TYPE = 'image/gif';\n\nexport const LOTTIE_STICKER_MIME_TYPE = 'application/x-tgsticker';\nexport const VIDEO_STICKER_MIME_TYPE = VIDEO_WEBM_TYPE;\n\nexport const SUPPORTED_PHOTO_CONTENT_TYPES = new Set([\n  'image/png', 'image/jpeg', GIF_MIME_TYPE,\n]);\n\nexport const SUPPORTED_VIDEO_CONTENT_TYPES = new Set([\n  'video/mp4', 'video/quicktime',\n]);\n\nexport const SUPPORTED_AUDIO_CONTENT_TYPES = new Set([\n  'audio/mp3',\n  'audio/ogg',\n  'audio/wav',\n  'audio/mpeg',\n  'audio/flac',\n  'audio/aac',\n  'audio/m4a',\n  'audio/mp4',\n  'audio/x-m4a',\n]);\n\nexport const CONTENT_TYPES_WITH_PREVIEW = new Set([\n  ...SUPPORTED_PHOTO_CONTENT_TYPES,\n  ...SUPPORTED_VIDEO_CONTENT_TYPES,\n]);\n\nexport const CONTENT_NOT_SUPPORTED = 'The message is not supported on this version of Telegram.';\n\n// Taken from https://github.com/telegramdesktop/tdesktop/blob/41d9a9fcbd0c809c60ddbd9350791b1436aff7d9/Telegram/SourceFiles/ui/boxes/choose_language_box.cpp#L28\nexport const SUPPORTED_TRANSLATION_LANGUAGES = [\n  // Official\n  'en', 'ar', 'be', 'ca', 'zh', 'nl', 'fr', 'de', 'id',\n  'it', 'ja', 'ko', 'pl', 'pt', 'ru', 'es', 'uk',\n  // Unofficial\n  'af', 'sq', 'am', 'hy', 'az', 'eu', 'bn', 'bs', 'bg',\n  'ceb', 'zh-CN', 'zh-TW', 'co', 'hr', 'cs', 'da', 'eo',\n  'et', 'fi', 'fy', 'gl', 'ka', 'el', 'gu', 'ht', 'ha',\n  'haw', 'he', 'iw', 'hi', 'hmn', 'hu', 'is', 'ig', 'ga',\n  'jv', 'kn', 'kk', 'km', 'rw', 'ku', 'ky', 'lo', 'la',\n  'lv', 'lt', 'lb', 'mk', 'mg', 'ms', 'ml', 'mt', 'mi',\n  'mr', 'mn', 'my', 'ne', 'no', 'ny', 'or', 'ps', 'fa',\n  'pa', 'ro', 'sm', 'gd', 'sr', 'st', 'sn', 'sd', 'si',\n  'sk', 'sl', 'so', 'su', 'sw', 'sv', 'tl', 'tg', 'ta',\n  'tt', 'te', 'th', 'tr', 'tk', 'ur', 'ug', 'uz', 'vi',\n  'cy', 'xh', 'yi', 'yo', 'zu',\n];\n\n// eslint-disable-next-line max-len\nexport const RE_LINK_TEMPLATE = '((ftp|https?):\\\\/\\\\/)?((www\\\\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\\\\.[a-zA-Z][-a-zA-Z0-9]{1,62})\\\\b([-a-zA-Z0-9()@:%_+.,~#?&/=]*)';\nexport const RE_MENTION_TEMPLATE = '(@[\\\\w\\\\d_-]+)';\nexport const RE_TG_LINK = /^tg:(\\/\\/)?/i;\nexport const RE_TME_LINK = /^(https?:\\/\\/)?([-a-zA-Z0-9@:%_+~#=]{1,32}\\.)?t\\.me/i;\nexport const RE_TELEGRAM_LINK = /^(https?:\\/\\/)?telegram\\.org\\//i;\nexport const TME_LINK_PREFIX = 'https://t.me/';\nexport const BOT_FATHER_USERNAME = 'botfather';\nexport const USERNAME_PURCHASE_ERROR = 'USERNAME_PURCHASE_AVAILABLE';\nexport const MESSAGE_ID_REQUIRED_ERROR = 'MESSAGE_ID_REQUIRED';\nexport const PURCHASE_USERNAME = 'auction';\nexport const ACCEPTABLE_USERNAME_ERRORS = new Set([USERNAME_PURCHASE_ERROR, 'USERNAME_INVALID']);\nexport const TME_WEB_DOMAINS = new Set(['t.me', 'web.t.me', 'a.t.me', 'k.t.me', 'z.t.me']);\nexport const WEB_APP_PLATFORM = 'weba';\nexport const LANG_PACK = 'weba';\n\n// eslint-disable-next-line max-len\nexport const COUNTRIES_WITH_12H_TIME_FORMAT = new Set(['AU', 'BD', 'CA', 'CO', 'EG', 'HN', 'IE', 'IN', 'JO', 'MX', 'MY', 'NI', 'NZ', 'PH', 'PK', 'SA', 'SV', 'US']);\n\nexport const API_CHAT_TYPES = ['bots', 'channels', 'chats', 'users', 'groups'] as const;\n\nexport const HEART_REACTION: ApiReactionEmoji = {\n  type: 'emoji',\n  emoticon: '❤',\n};\n\n// MTProto constants\nexport const SERVICE_NOTIFICATIONS_USER_ID = '777000';\nexport const REPLIES_USER_ID = '1271266957'; // TODO For Test connection ID must be equal to 708513\nexport const VERIFICATION_CODES_USER_ID = '489000';\nexport const ANONYMOUS_USER_ID = '2666000';\nexport const RESTRICTED_EMOJI_SET_ID = '7173162320003080';\nexport const CHANNEL_ID_LENGTH = 14; // 14 symbols, based on TDLib's `ZERO_CHANNEL_ID = -1000000000000`\nexport const DEFAULT_GIF_SEARCH_BOT_USERNAME = 'gif';\nexport const ALL_FOLDER_ID = 0;\nexport const ARCHIVED_FOLDER_ID = 1;\nexport const SAVED_FOLDER_ID = -1;\nexport const UNREAD_FOLDER_ID = -2;\nexport const PRESET_FOLDER_ID = -3;\nexport const AI_FOLDER_ID = -4;\nexport const DELETED_COMMENTS_CHANNEL_ID = '-1000000000777';\nexport const MAX_MEDIA_FILES_FOR_ALBUM = 10;\nexport const MAX_ACTIVE_PINNED_CHATS = 5;\nexport const SCHEDULED_WHEN_ONLINE = 0x7FFFFFFE;\nexport const LANG_PACKS = ['android', 'ios', 'tdesktop', 'macos'] as const;\nexport const FEEDBACK_URL = 'https://bugs.telegram.org/?tag_ids=41&sort=time';\nexport const FAQ_URL = 'https://telegram.org/faq';\nexport const PRIVACY_URL = 'https://telegram.org/privacy';\nexport const MINI_APP_TOS_URL = 'https://telegram.org/tos/mini-apps';\nexport const FRAGMENT_ADS_URL = 'https://fragment.com/ads';\nexport const GENERAL_TOPIC_ID = 1;\nexport const STORY_EXPIRE_PERIOD = 86400; // 1 day\nexport const STORY_VIEWERS_EXPIRE_PERIOD = 86400; // 1 day\nexport const FRESH_AUTH_PERIOD = 86400; // 1 day\nexport const GIVEAWAY_BOOST_PER_PREMIUM = 4;\nexport const GIVEAWAY_MAX_ADDITIONAL_CHANNELS = 10;\nexport const GIVEAWAY_MAX_ADDITIONAL_USERS = 10;\nexport const GIVEAWAY_MAX_ADDITIONAL_COUNTRIES = 10;\nexport const BOOST_PER_SENT_GIFT = 3;\nexport const FRAGMENT_PHONE_CODE = '888';\nexport const FRAGMENT_PHONE_LENGTH = 11;\n\nexport const LIGHT_THEME_BG_COLOR = '#99BA92';\nexport const DARK_THEME_BG_COLOR = '#0F0F0F';\nexport const DEFAULT_PATTERN_COLOR = '#4A8E3A8C';\nexport const DARK_THEME_PATTERN_COLOR = '#0A0A0A8C';\nexport const PEER_COLOR_BG_OPACITY = '1a';\nexport const PEER_COLOR_BG_ACTIVE_OPACITY = '2b';\nexport const PEER_COLOR_GRADIENT_STEP = 5; // px\nexport const MAX_UPLOAD_FILEPART_SIZE = 524288;\nexport const MAX_UNIQUE_REACTIONS = 11;\n\nexport const IGNORE_UNHANDLED_ERRORS = new Set([\n  'USER_CANCELED',\n]);\n\n// Group calls\nexport const GROUP_CALL_VOLUME_MULTIPLIER = 100;\nexport const GROUP_CALL_DEFAULT_VOLUME = 100 * GROUP_CALL_VOLUME_MULTIPLIER;\n\nexport const DEFAULT_LIMITS: Record<ApiLimitType, readonly [number, number]> = {\n  uploadMaxFileparts: [4000, 8000],\n  stickersFaved: [5, 10],\n  savedGifs: [200, 400],\n  dialogFiltersChats: [100, 200],\n  dialogFilters: [10, 20],\n  dialogFolderPinned: [5, 10],\n  captionLength: [1024, 4096],\n  channels: [500, 1000],\n  channelsPublic: [10, 20],\n  aboutLength: [70, 140],\n  chatlistInvites: [3, 100],\n  chatlistJoined: [2, 20],\n  recommendedChannels: [10, 100],\n  savedDialogsPinned: [5, 100],\n  moreAccounts: [3, MULTIACCOUNT_MAX_SLOTS],\n};\nexport const DEFAULT_MAX_MESSAGE_LENGTH = 4096;\n\nexport const ONE_TIME_MEDIA_TTL_SECONDS = 2147483647;\n\n// Premium\nexport const PREMIUM_FEATURE_SECTIONS = [\n  'stories',\n  'double_limits',\n  'more_upload',\n  'faster_download',\n  'voice_to_text',\n  'no_ads',\n  'infinite_reactions',\n  'premium_stickers',\n  'animated_emoji',\n  'advanced_chat_management',\n  'profile_badge',\n  'animated_userpics',\n  'emoji_status',\n  'translations',\n  'saved_tags',\n  'last_seen',\n  'message_privacy',\n  'effects',\n] as const;\n\nexport const PREMIUM_BOTTOM_VIDEOS: ApiPremiumSection[] = [\n  'faster_download',\n  'voice_to_text',\n  'advanced_chat_management',\n  'infinite_reactions',\n  'profile_badge',\n  'animated_userpics',\n  'emoji_status',\n  'translations',\n  'saved_tags',\n  'last_seen',\n  'message_privacy',\n  'effects',\n];\n\nexport const PREMIUM_LIMITS_ORDER: ApiLimitTypeForPromo[] = [\n  'channels',\n  'dialogFolderPinned',\n  'channelsPublic',\n  'savedGifs',\n  'stickersFaved',\n  'aboutLength',\n  'captionLength',\n  'dialogFilters',\n  'dialogFiltersChats',\n  'moreAccounts',\n  'recommendedChannels',\n];\n\nexport const DEFAULT_GIFT_PROFILE_FILTER_OPTIONS : GiftProfileFilterOptions = {\n  sortType: 'byDate',\n  shouldIncludeUnlimited: true,\n  shouldIncludeLimited: true,\n  shouldIncludeUnique: true,\n  shouldIncludeDisplayed: true,\n  shouldIncludeHidden: true,\n} as const;\n","import { useEffect } from '../../lib/teact/teact';\n\nimport useLastCallback from '../useLastCallback';\n\nfunction useInterval(callback: NoneToVoidFunction, delay?: number, noFirst = false) {\n  const savedCallback = useLastCallback(callback);\n\n  useEffect(() => {\n    if (delay === undefined) {\n      return undefined;\n    }\n\n    const id = setInterval(() => savedCallback(), delay);\n    if (!noFirst) savedCallback();\n\n    return () => clearInterval(id);\n  }, [delay, noFirst]);\n}\n\nexport default useInterval;\n","import type { GlobalState, TabArgs, TabState } from '../types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\n\nexport function updateTabState<T extends GlobalState>(\n  global: T,\n  tabStatePartial: Partial<TabState>,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return {\n    ...global,\n    byTabId: {\n      ...global.byTabId,\n      [tabId]: {\n        ...global.byTabId[tabId],\n        ...tabStatePartial,\n      },\n    },\n  };\n}\n","import { getActions } from '../global';\n\nimport type { CallbackAction } from '../global/types';\n\nconst callbacks = new Map<string, number>();\n\n// TODO Pass callbacks to the master tab. Sync them on master change\nexport default function requestActionTimeout(action: CallbackAction, timeout: number) {\n  const name = action.action;\n  clearTimeout(callbacks.get(name));\n  const timerId = window.setTimeout(() => {\n    // @ts-ignore\n    getActions()[name](action.payload);\n  }, timeout);\n  callbacks.set(name, timerId);\n}\n","import type { DiffObject } from './deepDiff';\n\nimport { isLiteralObject, unique } from './iteratees';\n\nexport function deepMerge<T extends object>(value1: T, value2: DiffObject<T>): T {\n  if (value1 === value2) {\n    return value2 as unknown as T;\n  }\n\n  if (!isLiteralObject(value2)) {\n    return value2;\n  }\n\n  if (!isLiteralObject(value1)) {\n    return reduceDiff(value2) as T;\n  }\n\n  // eslint-disable-next-line no-underscore-dangle\n  if ('__deleteAllChildren' in value2) {\n    return {} as T;\n  }\n\n  const allKeys = unique(Object.keys(value1).concat(Object.keys(value2)));\n\n  return allKeys.reduce((acc: AnyLiteral, key) => {\n    const oldValue = (value1 as AnyLiteral)[key];\n\n    if (!value2.hasOwnProperty(key)) {\n      acc[key] = oldValue;\n    } else {\n      const newValue = (value2 as AnyLiteral)[key];\n      // eslint-disable-next-line no-underscore-dangle\n      if (!newValue?.__delete) {\n        acc[key] = deepMerge(oldValue, newValue);\n      }\n    }\n\n    return acc;\n  }, {}) as T;\n}\n\nfunction reduceDiff(diff: AnyLiteral) {\n  // eslint-disable-next-line no-underscore-dangle\n  if (diff.__deleteAllChildren) {\n    return {};\n  }\n\n  return Object.entries(diff).reduce((acc: AnyLiteral, [key, value]) => {\n    // eslint-disable-next-line no-underscore-dangle\n    if (!value?.__delete) {\n      // eslint-disable-next-line no-null/no-null\n      acc[key] = isLiteralObject(value) ? reduceDiff(value) : value;\n    }\n\n    return acc;\n  }, {});\n}","import { useEffect } from '../lib/teact/teact';\n\nimport { createCallbackManager } from '../util/callbacks';\nimport useLastCallback from './useLastCallback';\n\nconst startCallbacks = createCallbackManager();\nconst endCallbacks = createCallbackManager();\n\nlet timeout: number | undefined;\nlet isActive = false;\n\nconst usePriorityPlaybackCheck = (\n  onStart?: AnyToVoidFunction,\n  onEnd?: AnyToVoidFunction,\n  isDisabled = false,\n) => {\n  const lastOnStart = useLastCallback(onStart);\n  const lastOnEnd = useLastCallback(onEnd);\n\n  useEffect(() => {\n    if (isDisabled) {\n      return undefined;\n    }\n\n    if (isActive) {\n      lastOnStart();\n    }\n\n    startCallbacks.addCallback(lastOnStart);\n    endCallbacks.addCallback(lastOnEnd);\n\n    return () => {\n      endCallbacks.removeCallback(lastOnEnd);\n      startCallbacks.removeCallback(lastOnStart);\n    };\n  }, [isDisabled, lastOnStart, lastOnEnd]);\n};\n\nexport function isPriorityPlaybackActive() {\n  return isActive;\n}\n\nexport function dispatchPriorityPlaybackEvent() {\n  if (!isActive) {\n    isActive = true;\n    startCallbacks.runCallbacks();\n  }\n\n  if (timeout) {\n    clearTimeout(timeout);\n    timeout = undefined;\n  }\n\n  // Race condition may happen if another `dispatchPriorityPlaybackEvent` is called before `onEnd`\n  function onEnd() {\n    if (timeout) {\n      clearTimeout(timeout);\n      timeout = undefined;\n    }\n\n    isActive = false;\n    endCallbacks.runCallbacks();\n  }\n\n  return onEnd;\n}\n\nexport default usePriorityPlaybackCheck;\n","import type { ApiPeer, ApiPeerColor } from '../../../api/types';\nimport type { CustomPeer } from '../../../types';\n\nimport { getPeerColorCount, getPeerColorKey } from '../../../global/helpers';\n\nexport function getPeerColorClass(peer?: ApiPeer | CustomPeer, noUserColors?: boolean, shouldReset?: boolean) {\n  if (!peer) {\n    if (!shouldReset) return undefined;\n    return noUserColors ? 'peer-color-count-1' : 'peer-color-0';\n  }\n\n  if ('isCustomPeer' in peer) {\n    if (peer.peerColorId === undefined) return undefined;\n    return `peer-color-${peer.peerColorId}`;\n  }\n  return noUserColors ? `peer-color-count-${getPeerColorCount(peer)}` : `peer-color-${getPeerColorKey(peer)}`;\n}\n\nexport function getApiPeerColorClass(color: ApiPeerColor) {\n  return `peer-color-${color.color}`;\n}\n","import { useRef, useUnmountCleanup } from '../lib/teact/teact';\n\nimport usePreviousDeprecated from './usePreviousDeprecated';\n\nexport default function useSyncEffect<const T extends readonly any[]>(\n  effect: (args: T | readonly []) => NoneToVoidFunction | void,\n  dependencies: T,\n) {\n  const prevDeps = usePreviousDeprecated<T>(dependencies);\n  const cleanupRef = useRef<NoneToVoidFunction>();\n\n  if (!prevDeps || dependencies.some((d, i) => d !== prevDeps[i])) {\n    cleanupRef.current?.();\n    cleanupRef.current = effect(prevDeps || []) ?? undefined;\n  }\n\n  useUnmountCleanup(() => {\n    cleanupRef.current?.();\n  });\n}\n","// We cache avatars as Data URI for faster initial load\n// and messages media as Blob for smaller size.\n\nexport enum ApiMediaFormat {\n  BlobUrl,\n  Progressive,\n  DownloadUrl,\n  Text,\n}\n\nexport type ApiParsedMedia = string | Blob | ArrayBuffer;\nexport type ApiPreparedMedia = string;\n","import React, { useEffect } from '../../lib/teact/teact';\n\nimport { SVG_NAMESPACE } from '../../config';\nimport { addSvgDefinition, removeSvgDefinition } from '../../util/svgController';\nimport { hexToRgb } from '../../util/switchTheme';\n\nconst SVG_MAP = new Map<string, SvgColorFilter>();\n\nclass SvgColorFilter {\n  public filterId: string;\n\n  private referenceCount = 0;\n\n  constructor(public color: string) {\n    this.filterId = `color-filter-${color.slice(1)}`;\n\n    const rgbColor = hexToRgb(color);\n    addSvgDefinition(\n      <filter color-interpolation-filters=\"sRGB\" xmlns={SVG_NAMESPACE}>\n        <feColorMatrix\n          type=\"matrix\"\n          values={`0 0 0 0 ${rgbColor.r / 255} 0 0 0 0 ${rgbColor.g / 255} 0 0 0 0 ${rgbColor.b / 255} 0 0 0 1 0`}\n        />\n      </filter>,\n      this.filterId,\n    );\n  }\n\n  public getFilterId() {\n    this.referenceCount += 1;\n    return this.filterId;\n  }\n\n  public removeReference() {\n    this.referenceCount -= 1;\n    if (this.referenceCount === 0) {\n      removeSvgDefinition(this.filterId);\n    }\n  }\n\n  public isUsed() {\n    return this.referenceCount > 0;\n  }\n}\n\nexport default function useColorFilter(color?: string, asValue?: boolean) {\n  useEffect(() => {\n    if (!color) return undefined;\n\n    return () => {\n      const colorFilter = SVG_MAP.get(color);\n      if (colorFilter) {\n        colorFilter.removeReference();\n        if (!colorFilter.isUsed()) {\n          SVG_MAP.delete(colorFilter.color);\n        }\n      }\n    };\n  }, [color]);\n\n  if (!color) return undefined;\n\n  if (SVG_MAP.has(color)) {\n    const svg = SVG_MAP.get(color)!;\n    return prepareStyle(svg.getFilterId(), asValue);\n  }\n\n  const svg = new SvgColorFilter(color);\n  SVG_MAP.set(color, svg);\n\n  return prepareStyle(svg.getFilterId(), asValue);\n}\n\nfunction prepareStyle(filterId: string, asValue?: boolean) {\n  if (asValue) {\n    return `url(#${filterId})`;\n  }\n\n  return `filter: url(#${filterId});`;\n}\n","import { useCallback, useState } from '../lib/teact/teact';\n\nconst useFlag = (initial = false, debugKey?: string): [boolean, NoneToVoidFunction, NoneToVoidFunction] => {\n  const [value, setValue] = useState(initial, debugKey);\n\n  const setTrue = useCallback(() => {\n    setValue(true);\n  }, []);\n\n  const setFalse = useCallback(() => {\n    setValue(false);\n  }, []);\n\n  return [value, setTrue, setFalse];\n};\n\nexport default useFlag;\n","/* eslint-disable no-null/no-null */\n/* eslint-disable no-console */\n\nimport type { StoreName } from './chatai-store';\nimport type ChataiDB from './chatai-store';\n\nexport const SUMMARY_CHATS = 'summaryChats';\nexport const URGENT_CHATS = 'urgentChats';\nclass GeneralStore {\n  private storeName: StoreName = 'general';\n\n  private db: IDBDatabase | null = null;\n\n  private chataiStoreManager:ChataiDB;\n\n  constructor(private dbManager: ChataiDB) {\n    this.db = dbManager.db;\n    this.chataiStoreManager = dbManager;\n  }\n\n  async get(key: string): Promise<any | undefined> {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding contact:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readonly');\n      const store = tx.objectStore(this.storeName);\n      const request = store.get(key);\n      request.onsuccess = () => {\n        resolve(request.result);\n      };\n      request.onerror = () => {\n        reject(request.error);\n      };\n    });\n  }\n\n  async set(key:string, value:any) {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding contact:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readwrite');\n      const store = tx.objectStore(this.storeName);\n      const request = store.put(value, key);\n      request.onsuccess = () => {\n        resolve(request.result);\n      };\n      request.onerror = () => {\n        reject(request.error);\n      };\n    });\n  }\n\n  async delete(key:string) {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding contact:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readwrite');\n      const store = tx.objectStore(this.storeName);\n      const request = store.delete(key);\n      request.onsuccess = () => {\n        resolve(request.result);\n      };\n      request.onerror = () => {\n        reject(request.error);\n      };\n    });\n  }\n}\n\nexport default GeneralStore;\n","export type Scheduler = typeof requestAnimationFrame | typeof onTickEnd;\n\nexport function debounce<F extends AnyToVoidFunction>(\n  fn: F,\n  ms: number,\n  shouldRunFirst = true,\n  shouldRunLast = true,\n) {\n  let waitingTimeout: number | undefined;\n\n  return (...args: Parameters<F>) => {\n    if (waitingTimeout) {\n      clearTimeout(waitingTimeout);\n      waitingTimeout = undefined;\n    } else if (shouldRunFirst) {\n      fn(...args);\n    }\n\n    // eslint-disable-next-line no-restricted-globals\n    waitingTimeout = self.setTimeout(() => {\n      if (shouldRunLast) {\n        fn(...args);\n      }\n\n      waitingTimeout = undefined;\n    }, ms);\n  };\n}\n\nexport function throttle<F extends AnyToVoidFunction>(\n  fn: F,\n  ms: number,\n  shouldRunFirst = true,\n) {\n  let interval: number | undefined;\n  let isPending: boolean;\n  let args: Parameters<F>;\n\n  return (..._args: Parameters<F>) => {\n    isPending = true;\n    args = _args;\n\n    if (!interval) {\n      if (shouldRunFirst) {\n        isPending = false;\n        fn(...args);\n      }\n\n      // eslint-disable-next-line no-restricted-globals\n      interval = self.setInterval(() => {\n        if (!isPending) {\n          // eslint-disable-next-line no-restricted-globals\n          self.clearInterval(interval!);\n          interval = undefined;\n          return;\n        }\n\n        isPending = false;\n        fn(...args);\n      }, ms);\n    }\n  };\n}\n\nexport function throttleWithTickEnd<F extends AnyToVoidFunction>(fn: F) {\n  return throttleWith(onTickEnd, fn);\n}\n\nexport function throttleWith<F extends AnyToVoidFunction>(schedulerFn: Scheduler, fn: F) {\n  let waiting = false;\n  let args: Parameters<F>;\n\n  return (..._args: Parameters<F>) => {\n    args = _args;\n\n    if (!waiting) {\n      waiting = true;\n\n      schedulerFn(() => {\n        waiting = false;\n        fn(...args);\n      });\n    }\n  };\n}\n\nexport const pause = (ms: number) => new Promise<void>((resolve) => {\n  setTimeout(() => resolve(), ms);\n});\n\nexport function rafPromise() {\n  return new Promise<void>((resolve) => {\n    fastRaf(resolve);\n  });\n}\n\nconst FAST_RAF_TIMEOUT_FALLBACK_MS = 35; // < 30 FPS\n\nlet fastRafCallbacks: Set<NoneToVoidFunction> | undefined;\nlet fastRafFallbackCallbacks: Set<NoneToVoidFunction> | undefined;\nlet fastRafFallbackTimeout: number | undefined;\n\n// May result in an immediate execution if called from another RAF callback which was scheduled\n// (and therefore is executed) earlier than RAF callback scheduled by `fastRaf`\nexport function fastRaf(callback: NoneToVoidFunction, withTimeoutFallback = false) {\n  if (!fastRafCallbacks) {\n    fastRafCallbacks = new Set([callback]);\n\n    requestAnimationFrame(() => {\n      const currentCallbacks = fastRafCallbacks!;\n\n      fastRafCallbacks = undefined;\n      fastRafFallbackCallbacks = undefined;\n\n      if (fastRafFallbackTimeout) {\n        clearTimeout(fastRafFallbackTimeout);\n        fastRafFallbackTimeout = undefined;\n      }\n\n      currentCallbacks.forEach((cb) => cb());\n    });\n  } else {\n    fastRafCallbacks.add(callback);\n  }\n\n  if (withTimeoutFallback) {\n    if (!fastRafFallbackCallbacks) {\n      fastRafFallbackCallbacks = new Set([callback]);\n    } else {\n      fastRafFallbackCallbacks.add(callback);\n    }\n\n    if (!fastRafFallbackTimeout) {\n      fastRafFallbackTimeout = window.setTimeout(() => {\n        const currentTimeoutCallbacks = fastRafFallbackCallbacks!;\n\n        if (fastRafCallbacks) {\n          currentTimeoutCallbacks.forEach(fastRafCallbacks.delete, fastRafCallbacks);\n        }\n        fastRafFallbackCallbacks = undefined;\n\n        if (fastRafFallbackTimeout) {\n          clearTimeout(fastRafFallbackTimeout);\n          fastRafFallbackTimeout = undefined;\n        }\n\n        currentTimeoutCallbacks.forEach((cb) => cb());\n      }, FAST_RAF_TIMEOUT_FALLBACK_MS);\n    }\n  }\n}\n\nlet onTickEndCallbacks: NoneToVoidFunction[] | undefined;\n\nexport function onTickEnd(callback: NoneToVoidFunction) {\n  if (!onTickEndCallbacks) {\n    onTickEndCallbacks = [callback];\n\n    Promise.resolve().then(() => {\n      const currentCallbacks = onTickEndCallbacks!;\n      onTickEndCallbacks = undefined;\n      currentCallbacks.forEach((cb) => cb());\n    });\n  } else {\n    onTickEndCallbacks.push(callback);\n  }\n}\n\nconst IDLE_TIMEOUT = 500;\n\nlet onIdleCallbacks: NoneToVoidFunction[] | undefined;\n\nexport function onIdle(callback: NoneToVoidFunction) {\n  // eslint-disable-next-line no-restricted-globals\n  if (!self.requestIdleCallback) {\n    onTickEnd(callback);\n    return;\n  }\n\n  if (!onIdleCallbacks) {\n    onIdleCallbacks = [callback];\n\n    requestIdleCallback((deadline) => {\n      const currentCallbacks = onIdleCallbacks!;\n      onIdleCallbacks = undefined;\n\n      while (currentCallbacks.length) {\n        const cb = currentCallbacks.shift()!;\n        cb();\n\n        if (!deadline.timeRemaining()) break;\n      }\n\n      if (currentCallbacks.length) {\n        if (onIdleCallbacks) {\n          // Prepend the remaining callbacks if the next pass is already planned\n          onIdleCallbacks = currentCallbacks.concat(onIdleCallbacks);\n        } else {\n          currentCallbacks.forEach(onIdle);\n        }\n      }\n    }, { timeout: IDLE_TIMEOUT });\n  } else {\n    onIdleCallbacks.push(callback);\n  }\n}\n\nlet beforeUnloadCallbacks: NoneToVoidFunction[] | undefined;\n\nexport function onBeforeUnload(callback: NoneToVoidFunction, isLast = false) {\n  if (!beforeUnloadCallbacks) {\n    beforeUnloadCallbacks = [];\n    // eslint-disable-next-line no-restricted-globals\n    self.addEventListener('beforeunload', () => {\n      beforeUnloadCallbacks!.forEach((cb) => cb());\n    });\n  }\n\n  if (isLast) {\n    beforeUnloadCallbacks.push(callback);\n  } else {\n    beforeUnloadCallbacks.unshift(callback);\n  }\n\n  return () => {\n    beforeUnloadCallbacks = beforeUnloadCallbacks!.filter((cb) => cb !== callback);\n  };\n}\n","import type { FC, FC_withDebug, Props } from './teact';\n\nimport { DEBUG, DEBUG_MORE } from '../../config';\nimport arePropsShallowEqual, { logUnequalProps } from '../../util/arePropsShallowEqual';\nimport { handleError } from '../../util/handleError';\nimport { orderBy } from '../../util/iteratees';\nimport { throttleWithTickEnd } from '../../util/schedulers';\nimport React, { DEBUG_resolveComponentName, getIsHeavyAnimating, useUnmountCleanup } from './teact';\n\nimport useForceUpdate from '../../hooks/useForceUpdate';\nimport useUniqueId from '../../hooks/useUniqueId';\n\nexport default React;\n\ninterface Container {\n  mapStateToProps: MapStateToProps<any>;\n  activationFn?: ActivationFn<any>;\n  stuckTo?: any;\n  ownProps: Props;\n  mappedProps?: Props;\n  forceUpdate: Function;\n  DEBUG_updates: number;\n  DEBUG_componentName: string;\n}\n\ntype GlobalState =\n  AnyLiteral\n  & { DEBUG_randomId?: number };\ntype ActionNames = string;\ntype ActionPayload = any;\n\nexport interface ActionOptions {\n  forceOnHeavyAnimation?: boolean;\n  // Workaround for iOS gesture history navigation\n  forceSyncOnIOs?: boolean;\n  forceOutdated?: boolean;\n}\n\ntype Actions = Record<ActionNames, (payload?: ActionPayload, options?: ActionOptions) => void>;\n\ntype ActionHandler = (\n  global: GlobalState,\n  actions: Actions,\n  payload: any,\n) => GlobalState | void | Promise<void>;\n\ntype MapStateToProps<OwnProps = undefined> = (global: GlobalState, ownProps: OwnProps) => AnyLiteral;\ntype StickToFirstFn = (value: any) => boolean;\ntype ActivationFn<OwnProps = undefined> = (\n  global: GlobalState, ownProps: OwnProps, stickToFirst: StickToFirstFn,\n) => boolean;\n\nlet currentGlobal = {\n  isInited: false,\n} as GlobalState;\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\nlet DEBUG_currentRandomId: number | undefined;\n// eslint-disable-next-line @typescript-eslint/naming-convention\nconst DEBUG_invalidateGlobalOnTickEnd = throttleWithTickEnd(() => {\n  DEBUG_currentRandomId = Math.random();\n});\n\nconst actionHandlers: Record<string, ActionHandler[]> = {};\nconst callbacks: Function[] = [updateContainers];\nconst actions = {} as Actions;\nconst containers = new Map<string, Container>();\n\nconst runCallbacksThrottled = throttleWithTickEnd(runCallbacks);\n\nlet forceOnHeavyAnimation = true;\n\nfunction runCallbacks() {\n  if (forceOnHeavyAnimation) {\n    forceOnHeavyAnimation = false;\n  } else if (getIsHeavyAnimating()) {\n    getIsHeavyAnimating.once(runCallbacksThrottled);\n    return;\n  }\n\n  callbacks.forEach((cb) => cb(currentGlobal));\n}\n\nexport function setUntypedGlobal(newGlobal?: GlobalState, options?: ActionOptions) {\n  if (typeof newGlobal === 'object' && newGlobal !== currentGlobal) {\n    if (DEBUG) {\n      if (\n        !options?.forceOutdated\n        && newGlobal.DEBUG_randomId && newGlobal.DEBUG_randomId !== DEBUG_currentRandomId\n      ) {\n        throw new Error('[TeactN.setGlobal] Attempt to set an outdated global');\n      }\n\n      DEBUG_currentRandomId = Math.random();\n    }\n\n    currentGlobal = newGlobal;\n\n    if (options?.forceSyncOnIOs) {\n      forceOnHeavyAnimation = true;\n      runCallbacks();\n    } else {\n      if (options?.forceOnHeavyAnimation) {\n        forceOnHeavyAnimation = true;\n      }\n\n      runCallbacksThrottled();\n    }\n  }\n}\n\nexport function getUntypedGlobal() {\n  if (DEBUG) {\n    currentGlobal = {\n      ...currentGlobal,\n      DEBUG_randomId: DEBUG_currentRandomId,\n    };\n    DEBUG_invalidateGlobalOnTickEnd();\n  }\n\n  return currentGlobal;\n}\n\nexport function getUntypedActions() {\n  return actions;\n}\n\nexport function forceOnHeavyAnimationOnce() {\n  forceOnHeavyAnimation = true;\n}\n\nlet actionQueue: NoneToVoidFunction[] = [];\n\nfunction handleAction(name: string, payload?: ActionPayload, options?: ActionOptions) {\n  actionQueue.push(() => {\n    actionHandlers[name]?.forEach((handler) => {\n      const response = handler(DEBUG ? getUntypedGlobal() : currentGlobal, actions, payload);\n      if (!response || typeof response.then === 'function') {\n        return;\n      }\n\n      // eslint-disable-next-line eslint-multitab-tt/set-global-only-variable\n      setUntypedGlobal(response as GlobalState, options);\n    });\n  });\n\n  if (actionQueue.length === 1) {\n    try {\n      while (actionQueue.length) {\n        actionQueue[0]();\n        actionQueue.shift();\n      }\n    } finally {\n      actionQueue = [];\n    }\n  }\n}\n\nfunction updateContainers() {\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  let DEBUG_startAt: number | undefined;\n  if (DEBUG) {\n    DEBUG_startAt = performance.now();\n  }\n\n  // eslint-disable-next-line no-restricted-syntax\n  for (const container of containers.values()) {\n    const {\n      mapStateToProps, ownProps, mappedProps, forceUpdate,\n    } = container;\n\n    if (!activateContainer(container, currentGlobal, ownProps)) {\n      continue;\n    }\n\n    let newMappedProps;\n\n    try {\n      newMappedProps = mapStateToProps(currentGlobal, ownProps);\n    } catch (err: any) {\n      handleError(err);\n\n      return;\n    }\n\n    if (DEBUG) {\n      if (Object.values(newMappedProps).some(Number.isNaN)) {\n        // eslint-disable-next-line no-console\n        console.warn(\n          // eslint-disable-next-line max-len\n          `[TeactN] Some of \\`${container.DEBUG_componentName}\\` mappers contain NaN values. This may cause redundant updates because of incorrect equality check.`,\n        );\n      }\n    }\n\n    if (Object.keys(newMappedProps).length && !arePropsShallowEqual(mappedProps!, newMappedProps)) {\n      if (DEBUG_MORE) {\n        logUnequalProps(\n          mappedProps!,\n          newMappedProps,\n          `[TeactN] Will update ${container.DEBUG_componentName} caused by:`,\n        );\n      }\n\n      container.mappedProps = newMappedProps;\n      container.DEBUG_updates++;\n\n      forceUpdate();\n    }\n  }\n\n  if (DEBUG) {\n    const updateTime = performance.now() - DEBUG_startAt!;\n    if (updateTime > 7) {\n      // eslint-disable-next-line no-console\n      console.warn(`[TeactN] Slow containers update: ${Math.round(updateTime)} ms`);\n    }\n  }\n}\n\nexport function addUntypedActionHandler(name: ActionNames, handler: ActionHandler) {\n  if (!actionHandlers[name]) {\n    actionHandlers[name] = [];\n\n    actions[name] = (payload?: ActionPayload, options?: ActionOptions) => {\n      handleAction(name, payload, options);\n    };\n  }\n\n  actionHandlers[name].push(handler);\n}\n\nexport function addCallback(cb: Function) {\n  callbacks.push(cb);\n}\n\nexport function removeCallback(cb: Function) {\n  const index = callbacks.indexOf(cb);\n  if (index !== -1) {\n    callbacks.splice(index, 1);\n  }\n}\n\nexport function withUntypedGlobal<OwnProps extends AnyLiteral>(\n  mapStateToProps: MapStateToProps<OwnProps> = () => ({}),\n  activationFn?: ActivationFn<OwnProps>,\n) {\n  return (Component: FC) => {\n    function TeactNContainer(props: OwnProps) {\n      const id = useUniqueId();\n      const forceUpdate = useForceUpdate();\n\n      useUnmountCleanup(() => {\n        containers.delete(id);\n      });\n\n      let container = containers.get(id)!;\n      if (!container) {\n        container = {\n          mapStateToProps,\n          activationFn,\n          ownProps: props,\n          forceUpdate,\n          DEBUG_updates: 0,\n          DEBUG_componentName: Component.name,\n        };\n\n        containers.set(id, container);\n      }\n\n      if (!container.mappedProps || (\n        !arePropsShallowEqual(container.ownProps, props) && activateContainer(container, currentGlobal, props)\n      )) {\n        try {\n          container.mappedProps = mapStateToProps(currentGlobal, props);\n        } catch (err: any) {\n          handleError(err);\n        }\n      }\n\n      container.ownProps = props;\n\n      // eslint-disable-next-line react/jsx-props-no-spreading\n      return <Component {...container.mappedProps} {...props} />;\n    }\n\n    (TeactNContainer as FC_withDebug).DEBUG_contentComponentName = DEBUG_resolveComponentName(Component);\n\n    return TeactNContainer;\n  };\n}\n\nfunction activateContainer(container: Container, global: GlobalState, props: Props) {\n  const { activationFn, stuckTo } = container;\n  if (!activationFn) {\n    return true;\n  }\n\n  return activationFn(global, props, (stickTo: any) => {\n    if (stickTo && !stuckTo) {\n      container.stuckTo = stickTo;\n    }\n\n    return stickTo && (!stuckTo || stuckTo === stickTo);\n  });\n}\n\nexport function typify<\n  ProjectGlobalState,\n  ActionPayloads,\n>() {\n  type ProjectActionNames = keyof ActionPayloads;\n\n  // When payload is allowed to be `undefined` we consider it optional\n  type ProjectActions = {\n    [ActionName in ProjectActionNames]:\n    (undefined extends ActionPayloads[ActionName] ? (\n      (payload?: ActionPayloads[ActionName], options?: ActionOptions) => void\n    ) : (\n      (payload: ActionPayloads[ActionName], options?: ActionOptions) => void\n    ))\n  };\n\n  type ActionHandlers = {\n    [ActionName in keyof ActionPayloads]: (\n      global: ProjectGlobalState,\n      actions: ProjectActions,\n      payload: ActionPayloads[ActionName],\n    ) => ProjectGlobalState | void | Promise<void>;\n  };\n\n  return {\n    getGlobal: getUntypedGlobal as <T extends ProjectGlobalState>() => T,\n    setGlobal: setUntypedGlobal as (state: ProjectGlobalState, options?: ActionOptions) => void,\n    getActions: getUntypedActions as () => ProjectActions,\n    addActionHandler: addUntypedActionHandler as <ActionName extends ProjectActionNames>(\n      name: ActionName,\n      handler: ActionHandlers[ActionName],\n    ) => void,\n    withGlobal: withUntypedGlobal as <OwnProps extends AnyLiteral>(\n      mapStateToProps: (global: ProjectGlobalState, ownProps: OwnProps) => AnyLiteral,\n      activationFn?: (global: ProjectGlobalState, ownProps: OwnProps, stickToFirst: StickToFirstFn) => boolean,\n    ) => (Component: FC) => FC<OwnProps>,\n  };\n}\n\nif (DEBUG) {\n  (window as any).getGlobal = getUntypedGlobal;\n  (window as any).setGlobal = setUntypedGlobal;\n\n  document.addEventListener('dblclick', () => {\n    // eslint-disable-next-line no-console\n    console.warn(\n      'GLOBAL CONTAINERS',\n      orderBy(\n        Array.from(containers.values())\n          .map(({ DEBUG_componentName, DEBUG_updates }) => ({ DEBUG_componentName, DEBUG_updates })),\n        'DEBUG_updates',\n        'desc',\n      ),\n    );\n  });\n}\n","import useShowTransition, { type HookParams } from './useShowTransition';\n\nexport default function useMediaTransition<RefType extends HTMLElement = HTMLDivElement>(\n  mediaData?: unknown,\n  options?: Partial<HookParams<RefType>>,\n) {\n  const isMediaReady = Boolean(mediaData);\n\n  const { ref } = useShowTransition<RefType>({\n    isOpen: isMediaReady,\n    noMountTransition: isMediaReady,\n    className: 'slow',\n    ...options,\n  });\n\n  return ref;\n}\n","import { useState } from '../../lib/teact/teact';\n\nimport { createCallbackManager } from '../../util/callbacks';\nimport useEffectOnce from '../useEffectOnce';\n\nconst callbacks = createCallbackManager();\n\nfunction createListener() {\n  window.matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`)\n    .addEventListener('change', callbacks.runCallbacks, { once: true });\n}\n\nexport default function useDevicePixelRatio() {\n  const [dpr, setDpr] = useState(window.devicePixelRatio);\n\n  useEffectOnce(() => {\n    return callbacks.addCallback(() => {\n      setDpr(window.devicePixelRatio);\n    });\n  });\n\n  return dpr;\n}\n\ncreateListener();\n\n// Set up new listener for the next `devicePixelRatio` change\ncallbacks.addCallback(createListener);\n","import {\n  addLocalizationCallback,\n  getTranslationFn,\n  type LangFn,\n} from '../util/localization';\nimport useEffectOnce from './useEffectOnce';\nimport useForceUpdate from './useForceUpdate';\n\nconst useLang = (): LangFn => {\n  const forceUpdate = useForceUpdate();\n\n  useEffectOnce(() => {\n    return addLocalizationCallback(forceUpdate);\n  });\n\n  return getTranslationFn();\n};\n\nexport default useLang;\n","import { useEffect, useMemo, useState } from '../../lib/teact/teact';\n\nimport { throttle } from '../../util/schedulers';\nimport windowSize from '../../util/windowSize';\nimport useDebouncedCallback from '../useDebouncedCallback';\n\nconst THROTTLE = 250;\n\nexport default function useWindowSize() {\n  const { width: initialWidth, height: initialHeight } = windowSize.get();\n  const [width, setWidth] = useState(initialWidth);\n  const [height, setHeight] = useState(initialHeight);\n  const [isResizing, setIsResizing] = useState(false);\n  const setIsResizingDebounced = useDebouncedCallback(setIsResizing, [setIsResizing], THROTTLE, true);\n\n  useEffect(() => {\n    const throttledSetIsResizing = throttle(() => {\n      setIsResizing(true);\n    }, THROTTLE, true);\n\n    const throttledSetSize = throttle(() => {\n      const { width: newWidth, height: newHeight } = windowSize.get();\n      setWidth(newWidth);\n      setHeight(newHeight);\n      setIsResizingDebounced(false);\n    }, THROTTLE, false);\n\n    const handleResize = () => {\n      throttledSetIsResizing();\n      throttledSetSize();\n    };\n\n    window.addEventListener('resize', handleResize);\n\n    return () => {\n      window.removeEventListener('resize', handleResize);\n    };\n  }, [setIsResizingDebounced]);\n\n  return useMemo(() => ({ width, height, isResizing }), [height, isResizing, width]);\n}\n","export default function unloadVideo(video: HTMLVideoElement) {\n  video.pause();\n  // https://github.com/shaka-project/shaka-player/commit/0e3d10e61cb08cc35750e48face4e58f24542fc8\n  video.removeAttribute('src');\n  while (video.firstChild) {\n    video.removeChild(video.firstChild);\n  }\n\n  video.load();\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"pTWe_CYU\"};","import React, {\n  memo, useEffect, useRef, useState,\n} from '../../../lib/teact/teact';\n\nimport { requestMutation } from '../../../lib/fasterdom/fasterdom';\nimport { getStickerMediaHash } from '../../../global/helpers';\nimport buildClassName from '../../../util/buildClassName';\nimport { preloadImage } from '../../../util/files';\nimport { REM } from '../helpers/mediaDimensions';\n\nimport useDynamicColorListener from '../../../hooks/stickers/useDynamicColorListener';\nimport { useThrottleForHeavyAnimation } from '../../../hooks/useHeavyAnimation';\nimport useLastCallback from '../../../hooks/useLastCallback';\nimport useMedia from '../../../hooks/useMedia';\nimport useOldLang from '../../../hooks/useOldLang';\nimport useResizeObserver from '../../../hooks/useResizeObserver';\nimport useDevicePixelRatio from '../../../hooks/window/useDevicePixelRatio';\nimport useCustomEmoji from '../hooks/useCustomEmoji';\n\nimport styles from './EmojiIconBackground.module.scss';\n\ntype IconPosition = {\n  inline: number;\n  block: number;\n  opacity: number;\n  scale: number;\n};\n\nconst ICON_POSITIONS: IconPosition[] = [\n  {\n    inline: 22, block: 38, opacity: 0.35, scale: 0.75,\n  },\n  {\n    inline: 32, block: 12, opacity: 0.3, scale: 1,\n  },\n  {\n    inline: 60, block: 22, opacity: 0.25, scale: 0.75,\n  },\n  {\n    inline: 75, block: 44, opacity: 0.25, scale: 1,\n  },\n  {\n    inline: 75, block: 2, opacity: 0.2, scale: 0.625,\n  },\n  {\n    inline: 95, block: 18, opacity: 0.2, scale: 1,\n  },\n  {\n    inline: 115, block: 38, opacity: 0.2, scale: 0.625,\n  },\n  {\n    inline: 125, block: 12, opacity: 0.1, scale: 0.75,\n  },\n];\n\nconst EMOJI_SIZE = REM;\nconst LOTTIE_TINT_OPACITY = 'ff';\nconst NON_LOTTIE_TINT_OPACITY = 'bb';\n\ntype OwnProps = {\n  emojiDocumentId: string;\n  className?: string;\n};\n\nconst EmojiIconBackground = ({\n  emojiDocumentId,\n  className,\n}: OwnProps) => {\n  // eslint-disable-next-line no-null/no-null\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  // eslint-disable-next-line no-null/no-null\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  const [emojiImage, setEmojiImage] = useState<HTMLImageElement | undefined>();\n\n  const dpr = useDevicePixelRatio();\n\n  const lang = useOldLang();\n\n  const { customEmoji } = useCustomEmoji(emojiDocumentId);\n  const previewMediaHash = customEmoji ? getStickerMediaHash(customEmoji, 'preview') : undefined;\n  const previewUrl = useMedia(previewMediaHash);\n\n  const customColor = useDynamicColorListener(containerRef);\n\n  const preloadAfterHeavyAnimation = useThrottleForHeavyAnimation(() => {\n    if (!previewUrl) return;\n    preloadImage(previewUrl).then(setEmojiImage);\n  }, [previewUrl]);\n\n  useEffect(() => {\n    preloadAfterHeavyAnimation();\n  }, [preloadAfterHeavyAnimation]);\n\n  const updateCanvas = useLastCallback(() => {\n    const canvas = canvasRef.current;\n    if (!canvas || !emojiImage || !customColor) return;\n\n    const context = canvas.getContext('2d')!;\n    const { width, height } = canvas;\n\n    context.clearRect(0, 0, width, height);\n\n    ICON_POSITIONS.forEach(({\n      inline, block, opacity, scale,\n    }) => {\n      const x = (lang.isRtl ? inline : width / dpr - inline) * dpr;\n      const y = block * dpr;\n\n      const emojiSize = EMOJI_SIZE * dpr;\n\n      context.save();\n      context.globalAlpha = opacity;\n      context.translate(x, y);\n      context.scale(scale, scale);\n      context.drawImage(emojiImage, -emojiSize / 2, -emojiSize / 2, emojiSize, emojiSize);\n      context.restore();\n    });\n\n    const tintColor = `${customColor}${customEmoji!.isLottie ? LOTTIE_TINT_OPACITY : NON_LOTTIE_TINT_OPACITY}`;\n\n    context.save();\n    context.fillStyle = tintColor;\n    context.globalCompositeOperation = 'source-atop';\n    context.fillRect(0, 0, width, height);\n    context.restore();\n  });\n\n  const updateCanvasAfterHeavyAnimation = useThrottleForHeavyAnimation(updateCanvas, [updateCanvas]);\n\n  useEffect(() => {\n    updateCanvasAfterHeavyAnimation();\n  }, [emojiImage, lang.isRtl, customColor, updateCanvasAfterHeavyAnimation]);\n\n  const updateCanvasSize = useThrottleForHeavyAnimation((parentWidth: number, parentHeight: number) => {\n    requestMutation(() => {\n      const canvas = canvasRef.current;\n      if (!canvas) return;\n\n      canvas.width = parentWidth * dpr;\n      canvas.height = parentHeight * dpr;\n\n      canvas.style.width = `${parentWidth}px`;\n      canvas.style.height = `${parentHeight}px`;\n\n      updateCanvas();\n    });\n  }, [dpr]);\n\n  const handleResize = useThrottleForHeavyAnimation((entry: ResizeObserverEntry) => {\n    const { width, height } = entry.contentRect;\n\n    updateCanvasSize(width, height);\n  }, [updateCanvasSize]);\n\n  useResizeObserver(containerRef, handleResize);\n\n  useEffect(() => {\n    const container = containerRef.current;\n    if (!container) return;\n\n    const { width, height } = container.getBoundingClientRect();\n\n    updateCanvasSize(width, height);\n  }, [updateCanvasSize]);\n\n  return (\n    <div className={buildClassName(styles.root, className)} ref={containerRef}>\n      <canvas ref={canvasRef} />\n    </div>\n  );\n};\n\nexport default memo(EmojiIconBackground);\n","import type {\n  ChangeEvent, FormEvent, RefObject,\n} from 'react';\nimport type { FC } from '../../lib/teact/teact';\nimport React, { memo } from '../../lib/teact/teact';\n\nimport buildClassName from '../../util/buildClassName';\n\nimport useOldLang from '../../hooks/useOldLang';\n\ntype OwnProps = {\n  ref?: RefObject<HTMLInputElement>;\n  id?: string;\n  className?: string;\n  value?: string;\n  label?: string;\n  error?: string;\n  success?: string;\n  disabled?: boolean;\n  readOnly?: boolean;\n  placeholder?: string;\n  autoComplete?: string;\n  maxLength?: number;\n  tabIndex?: number;\n  teactExperimentControlled?: boolean;\n  inputMode?: 'text' | 'none' | 'tel' | 'url' | 'email' | 'numeric' | 'decimal' | 'search';\n  onChange?: (e: ChangeEvent<HTMLInputElement>) => void;\n  onInput?: (e: FormEvent<HTMLInputElement>) => void;\n  onKeyPress?: (e: React.KeyboardEvent<HTMLInputElement>) => void;\n  onKeyDown?: (e: React.KeyboardEvent<HTMLInputElement>) => void;\n  onBlur?: (e: React.FocusEvent<HTMLInputElement>) => void;\n  onPaste?: (e: React.ClipboardEvent<HTMLInputElement>) => void;\n};\n\nconst InputText: FC<OwnProps> = ({\n  ref,\n  id,\n  className,\n  value,\n  label,\n  error,\n  success,\n  disabled,\n  readOnly,\n  placeholder,\n  autoComplete,\n  inputMode,\n  maxLength,\n  tabIndex,\n  teactExperimentControlled,\n  onChange,\n  onInput,\n  onKeyPress,\n  onKeyDown,\n  onBlur,\n  onPaste,\n}) => {\n  const lang = useOldLang();\n  const labelText = error || success || label;\n  const fullClassName = buildClassName(\n    'input-group',\n    value && 'touched',\n    error ? 'error' : success && 'success',\n    disabled && 'disabled',\n    readOnly && 'disabled',\n    labelText && 'with-label',\n    className,\n  );\n\n  return (\n    <div className={fullClassName} dir={lang.isRtl ? 'rtl' : undefined}>\n      <input\n        ref={ref}\n        className=\"form-control\"\n        type=\"text\"\n        id={id}\n        dir=\"auto\"\n        value={value || ''}\n        tabIndex={tabIndex}\n        placeholder={placeholder}\n        maxLength={maxLength}\n        autoComplete={autoComplete}\n        inputMode={inputMode}\n        disabled={disabled}\n        readOnly={readOnly}\n        onChange={onChange}\n        onInput={onInput}\n        onKeyPress={onKeyPress}\n        onKeyDown={onKeyDown}\n        onBlur={onBlur}\n        onPaste={onPaste}\n        aria-label={labelText}\n        teactExperimentControlled={teactExperimentControlled}\n      />\n      {labelText && (\n        <label htmlFor={id}>{labelText}</label>\n      )}\n    </div>\n  );\n};\n\nexport default memo(InputText);\n","export const GLOBAL_SUMMARY_CHATID = '777888';\nexport const TOOLS_SCHEDULE_MEETING_ID = 'schedule-meeting';\nexport const TOOLS_SEARCH_GROUP_ID = 'search-group';\nexport const TOOLS_SEARCH_USER_ID = 'search-user';\n","import type { RefObject } from 'react';\nimport React, {\n  beginHeavyAnimation, useEffect, useLayoutEffect, useRef,\n} from '../../lib/teact/teact';\nimport {\n  addExtraClass, removeExtraClass, setExtraStyles, toggleExtraClass,\n} from '../../lib/teact/teact-dom';\nimport { getGlobal } from '../../global';\n\nimport { requestForcedReflow, requestMutation } from '../../lib/fasterdom/fasterdom';\nimport { selectCanAnimateInterface } from '../../global/selectors';\nimport buildClassName from '../../util/buildClassName';\nimport { waitForAnimationEnd, waitForTransitionEnd } from '../../util/cssAnimationEndListeners';\nimport forceReflow from '../../util/forceReflow';\nimport { omit } from '../../util/iteratees';\nimport { allowSwipeControlForTransition } from '../../util/swipeController';\n\nimport useForceUpdate from '../../hooks/useForceUpdate';\nimport usePreviousDeprecated from '../../hooks/usePreviousDeprecated';\n\nimport './Transition.scss';\n\ntype AnimationName = (\n  'none' | 'slide' | 'slideRtl' | 'slideFade' | 'zoomFade' | 'zoomBounceSemiFade' | 'slideLayers'\n  | 'fade' | 'pushSlide' | 'reveal' | 'slideOptimized' | 'slideOptimizedRtl' | 'semiFade'\n  | 'slideVertical' | 'slideVerticalFade' | 'slideFadeAndroid'\n  );\nexport type ChildrenFn = (isActive: boolean, isFrom: boolean, currentKey: number, activeKey: number) => React.ReactNode;\nexport type TransitionProps = {\n  ref?: RefObject<HTMLDivElement>;\n  activeKey: number;\n  nextKey?: number;\n  name: AnimationName;\n  direction?: 'auto' | 'inverse' | 1 | -1;\n  renderCount?: number;\n  shouldRestoreHeight?: boolean;\n  shouldCleanup?: boolean;\n  cleanupExceptionKey?: number;\n  cleanupOnlyKey?: number;\n  // Used by async components which are usually remounted during first animation\n  shouldWrap?: boolean;\n  wrapExceptionKey?: number;\n  id?: string;\n  className?: string;\n  slideClassName?: string;\n  withSwipeControl?: boolean;\n  isBlockingAnimation?: boolean;\n  onStart?: NoneToVoidFunction;\n  onStop?: NoneToVoidFunction;\n  children: React.ReactNode | ChildrenFn;\n};\n\nconst FALLBACK_ANIMATION_END = 1000;\nconst CLASSES = {\n  slide: 'Transition_slide',\n  active: 'Transition_slide-active',\n  from: 'Transition_slide-from',\n  to: 'Transition_slide-to',\n  inactive: 'Transition_slide-inactive',\n};\n\nexport const ACTIVE_SLIDE_CLASS_NAME = CLASSES.active;\nexport const TO_SLIDE_CLASS_NAME = CLASSES.to;\n\nconst DISABLEABLE_ANIMATIONS = new Set<AnimationName>([\n  'slide', 'slideRtl', 'slideFade', 'zoomFade', 'zoomBounceSemiFade', 'slideLayers', 'pushSlide', 'reveal',\n  'slideOptimized', 'slideOptimizedRtl', 'slideVertical', 'slideVerticalFade',\n]);\n\nfunction Transition({\n  ref,\n  activeKey,\n  nextKey,\n  name,\n  direction = 'auto',\n  renderCount,\n  shouldRestoreHeight,\n  shouldCleanup,\n  cleanupExceptionKey,\n  cleanupOnlyKey,\n  shouldWrap,\n  wrapExceptionKey,\n  id,\n  className,\n  slideClassName,\n  withSwipeControl,\n  isBlockingAnimation,\n  onStart,\n  onStop,\n  children,\n}: TransitionProps) {\n  const currentKeyRef = useRef<number>();\n  // No need for a container to update on change\n  const shouldDisableAnimation = DISABLEABLE_ANIMATIONS.has(name)\n    && !selectCanAnimateInterface(getGlobal());\n\n  // eslint-disable-next-line no-null/no-null\n  let containerRef = useRef<HTMLDivElement>(null);\n  if (ref) {\n    containerRef = ref;\n  }\n\n  const rendersRef = useRef<Record<number, React.ReactNode | ChildrenFn>>({});\n  const prevActiveKey = usePreviousDeprecated<any>(activeKey);\n  const forceUpdate = useForceUpdate();\n  const isAnimatingRef = useRef(false);\n  const isSwipeJustCancelledRef = useRef(false);\n\n  const hasActiveKeyChanged = prevActiveKey !== undefined && activeKey !== prevActiveKey;\n\n  if (!renderCount && hasActiveKeyChanged) {\n    rendersRef.current = { [prevActiveKey]: rendersRef.current[prevActiveKey] };\n  }\n\n  rendersRef.current[activeKey] = children;\n  if (nextKey) {\n    rendersRef.current[nextKey] = children;\n  }\n\n  const isBackwards = (\n    direction === -1\n    || (direction === 'auto' && prevActiveKey > activeKey)\n    || (direction === 'inverse' && prevActiveKey < activeKey)\n  );\n\n  useLayoutEffect(() => {\n    function cleanup() {\n      if (!shouldCleanup) {\n        return;\n      }\n      if (cleanupExceptionKey !== undefined) {\n        rendersRef.current = { [cleanupExceptionKey]: rendersRef.current[cleanupExceptionKey] };\n      } else if (cleanupOnlyKey !== undefined) {\n        rendersRef.current = omit(rendersRef.current, [cleanupOnlyKey]);\n      } else {\n        rendersRef.current = {};\n      }\n      forceUpdate();\n    }\n\n    const isSlideOptimized = name === 'slideOptimized' || name === 'slideOptimizedRtl';\n    const container = containerRef.current!;\n    const keys = Object.keys(rendersRef.current).map(Number);\n    const prevActiveIndex = renderCount ? prevActiveKey : keys.indexOf(prevActiveKey);\n    const activeIndex = renderCount ? activeKey : keys.indexOf(activeKey);\n\n    const childNodes = Array.from(container.childNodes);\n    if (!childNodes.length) {\n      return;\n    }\n\n    const childElements = Array.from(container.children) as HTMLElement[];\n    childElements.forEach((el) => {\n      addExtraClass(el, CLASSES.slide);\n\n      if (slideClassName) {\n        slideClassName.split(/\\s+/).forEach((token) => {\n          addExtraClass(el, token);\n        });\n      }\n    });\n\n    if (!hasActiveKeyChanged) {\n      if (isAnimatingRef.current) {\n        return;\n      }\n\n      childElements.forEach((childElement) => {\n        if (childElement === childNodes[activeIndex]) {\n          addExtraClass(childElement, CLASSES.active);\n\n          if (isSlideOptimized) {\n            setExtraStyles(childElement, {\n              transition: 'none',\n              transform: 'translate3d(0, 0, 0)',\n            });\n          }\n        } else if (!isSlideOptimized) {\n          addExtraClass(childElement, CLASSES.inactive);\n        }\n      });\n\n      return;\n    }\n\n    currentKeyRef.current = activeKey;\n\n    if (isSlideOptimized) {\n      if (!childNodes[activeIndex]) {\n        return;\n      }\n\n      performSlideOptimized(\n        shouldDisableAnimation,\n        name,\n        isBackwards,\n        cleanup,\n        activeKey,\n        currentKeyRef,\n        isAnimatingRef,\n        container,\n        childNodes[activeIndex],\n        childNodes[prevActiveIndex],\n        shouldRestoreHeight,\n        isBlockingAnimation,\n        onStart,\n        onStop,\n      );\n\n      return;\n    }\n\n    if (name === 'none' || shouldDisableAnimation || isSwipeJustCancelledRef.current) {\n      if (isSwipeJustCancelledRef.current) {\n        isSwipeJustCancelledRef.current = false;\n      }\n\n      childNodes.forEach((node, i) => {\n        if (node instanceof HTMLElement) {\n          removeExtraClass(node, CLASSES.from);\n          removeExtraClass(node, CLASSES.to);\n          toggleExtraClass(node, CLASSES.active, i === activeIndex);\n          toggleExtraClass(node, CLASSES.inactive, i !== activeIndex);\n        }\n      });\n\n      cleanup();\n\n      return;\n    }\n\n    childNodes.forEach((node, i) => {\n      if (node instanceof HTMLElement) {\n        removeExtraClass(node, CLASSES.active);\n        toggleExtraClass(node, CLASSES.from, i === prevActiveIndex);\n        toggleExtraClass(node, CLASSES.to, i === activeIndex);\n        toggleExtraClass(node, CLASSES.inactive, i !== prevActiveIndex && i !== activeIndex);\n      }\n    });\n\n    isAnimatingRef.current = true;\n    const endHeavyAnimation = beginHeavyAnimation(undefined, isBlockingAnimation);\n    onStart?.();\n\n    toggleExtraClass(container, `Transition-${name}`, !isBackwards);\n    toggleExtraClass(container, `Transition-${name}Backwards`, isBackwards);\n\n    function onAnimationEnd() {\n      const activeElement = container.querySelector<HTMLDivElement>(`.${CLASSES.active}`);\n      const { clientHeight } = activeElement || {};\n\n      requestMutation(() => {\n        if (activeKey !== currentKeyRef.current) {\n          endHeavyAnimation();\n          return;\n        }\n\n        removeExtraClass(container, `Transition-${name}`);\n        removeExtraClass(container, `Transition-${name}Backwards`);\n\n        childNodes.forEach((node, i) => {\n          if (node instanceof HTMLElement) {\n            removeExtraClass(node, CLASSES.from);\n            removeExtraClass(node, CLASSES.to);\n            toggleExtraClass(node, CLASSES.active, i === activeIndex);\n            toggleExtraClass(node, CLASSES.inactive, i !== activeIndex);\n          }\n        });\n\n        if (shouldRestoreHeight) {\n          if (activeElement) {\n            setExtraStyles(activeElement, { height: 'auto' });\n            setExtraStyles(container, { height: `${clientHeight}px` });\n          }\n        }\n\n        onStop?.();\n        endHeavyAnimation();\n        isAnimatingRef.current = false;\n\n        cleanup();\n      });\n    }\n\n    const watchedNode = (name === 'reveal' || name === 'slideFadeAndroid') && isBackwards\n      ? childNodes[prevActiveIndex]\n      : childNodes[activeIndex];\n\n    if (watchedNode) {\n      if (withSwipeControl && childNodes[prevActiveIndex]) {\n        const giveUpAnimationEnd = waitForAnimationEnd(watchedNode, onAnimationEnd);\n\n        allowSwipeControlForTransition(\n          childNodes[prevActiveIndex] as HTMLElement,\n          childNodes[activeIndex] as HTMLElement,\n          () => {\n            giveUpAnimationEnd();\n            isSwipeJustCancelledRef.current = true;\n            onStop?.();\n            endHeavyAnimation();\n            isAnimatingRef.current = false;\n          },\n        );\n      } else {\n        waitForAnimationEnd(watchedNode, onAnimationEnd, undefined, FALLBACK_ANIMATION_END);\n      }\n    } else {\n      onAnimationEnd();\n    }\n  }, [\n    activeKey,\n    nextKey,\n    prevActiveKey,\n    hasActiveKeyChanged,\n    isBackwards,\n    name,\n    onStart,\n    onStop,\n    renderCount,\n    shouldRestoreHeight,\n    shouldCleanup,\n    slideClassName,\n    cleanupExceptionKey,\n    shouldDisableAnimation,\n    forceUpdate,\n    withSwipeControl,\n    isBlockingAnimation,\n    cleanupOnlyKey,\n  ]);\n\n  useEffect(() => {\n    if (!shouldRestoreHeight) {\n      return;\n    }\n\n    const container = containerRef.current!;\n    const activeElement = container.querySelector<HTMLDivElement>(`:scope > .${CLASSES.active}`)\n      || container.querySelector<HTMLDivElement>(`:scope > .${CLASSES.from}`);\n    if (!activeElement) {\n      return;\n    }\n\n    const { clientHeight, clientWidth } = activeElement || {};\n    if (!clientHeight || !clientWidth) {\n      return;\n    }\n\n    requestMutation(() => {\n      setExtraStyles(activeElement, { height: 'auto' });\n      setExtraStyles(container, {\n        height: `${clientHeight}px`,\n        flexBasis: `${clientHeight}px`,\n      });\n    });\n  }, [shouldRestoreHeight, children]);\n\n  const asFastList = !renderCount;\n  const renders = rendersRef.current;\n  const renderKeys = Object.keys(renderCount ? new Array(renderCount).fill(undefined) : renders).map(Number);\n  const contents = renderKeys.map((key) => {\n    const render = renders[key];\n    if (!render) {\n      return undefined;\n    }\n\n    const rendered = typeof render === 'function'\n      ? render(key === activeKey, key === prevActiveKey, key, activeKey)\n      : render;\n\n    return (shouldWrap && key !== wrapExceptionKey) || asFastList\n      ? <div key={key} teactOrderKey={key}>{rendered}</div>\n      : rendered;\n  });\n\n  return (\n    <div\n      ref={containerRef}\n      id={id}\n      className={buildClassName('Transition', className)}\n      teactFastList={asFastList}\n    >\n      {contents}\n    </div>\n  );\n}\n\nexport default Transition;\n\nfunction performSlideOptimized(\n  shouldDisableAnimation: boolean,\n  name: 'slideOptimized' | 'slideOptimizedRtl',\n  isBackwards: boolean,\n  cleanup: NoneToVoidFunction,\n  activeKey: number,\n  currentKeyRef: { current: number | undefined },\n  isAnimatingRef: { current: boolean | undefined },\n  container: HTMLElement,\n  toSlide: ChildNode,\n  fromSlide?: ChildNode,\n  shouldRestoreHeight?: boolean,\n  isBlockingAnimation?: boolean,\n  onStart?: NoneToVoidFunction,\n  onStop?: NoneToVoidFunction,\n) {\n  if (shouldDisableAnimation) {\n    toggleExtraClass(container, `Transition-${name}`, !isBackwards);\n    toggleExtraClass(container, `Transition-${name}Backwards`, isBackwards);\n\n    if (fromSlide instanceof HTMLElement) {\n      removeExtraClass(fromSlide, CLASSES.active);\n      setExtraStyles(fromSlide, {\n        transition: 'none',\n        transform: '',\n      });\n    }\n\n    if (toSlide instanceof HTMLElement) {\n      addExtraClass(toSlide, CLASSES.active);\n      setExtraStyles(toSlide, {\n        transition: 'none',\n        transform: 'translate3d(0, 0, 0)',\n      });\n    }\n\n    cleanup();\n\n    return;\n  }\n\n  if (name === 'slideOptimizedRtl') {\n    isBackwards = !isBackwards;\n  }\n\n  isAnimatingRef.current = true;\n  const endHeavyAnimation = beginHeavyAnimation(undefined, isBlockingAnimation);\n  onStart?.();\n\n  toggleExtraClass(container, `Transition-${name}`, !isBackwards);\n  toggleExtraClass(container, `Transition-${name}Backwards`, isBackwards);\n\n  if (fromSlide instanceof HTMLElement) {\n    setExtraStyles(fromSlide, {\n      transition: 'none',\n      transform: 'translate3d(0, 0, 0)',\n    });\n  }\n\n  if (toSlide instanceof HTMLElement) {\n    setExtraStyles(toSlide, {\n      transition: 'none',\n      transform: `translate3d(${isBackwards ? '-' : ''}100%, 0, 0)`,\n    });\n  }\n\n  requestForcedReflow(() => {\n    if (toSlide instanceof HTMLElement) {\n      forceReflow(toSlide);\n    }\n\n    return () => {\n      if (fromSlide instanceof HTMLElement) {\n        removeExtraClass(fromSlide, CLASSES.active);\n        setExtraStyles(fromSlide, {\n          transition: '',\n          transform: `translate3d(${isBackwards ? '' : '-'}100%, 0, 0)`,\n        });\n      }\n\n      if (toSlide instanceof HTMLElement) {\n        addExtraClass(toSlide, CLASSES.active);\n        setExtraStyles(toSlide, {\n          transition: '',\n          transform: 'translate3d(0, 0, 0)',\n        });\n      }\n    };\n  });\n\n  waitForTransitionEnd(toSlide, () => {\n    const clientHeight = toSlide instanceof HTMLElement ? toSlide.clientHeight : undefined;\n\n    requestMutation(() => {\n      if (activeKey !== currentKeyRef.current) {\n        endHeavyAnimation();\n        return;\n      }\n\n      if (fromSlide instanceof HTMLElement) {\n        setExtraStyles(fromSlide, {\n          transition: 'none',\n          transform: '',\n        });\n      }\n\n      if (shouldRestoreHeight && clientHeight && toSlide instanceof HTMLElement) {\n        setExtraStyles(toSlide, { height: 'auto' });\n        setExtraStyles(container, { height: `${clientHeight}px` });\n      }\n\n      onStop?.();\n      endHeavyAnimation();\n      isAnimatingRef.current = false;\n\n      cleanup();\n    });\n  });\n}\n","import { useRef } from '../lib/teact/teact';\n\n// Allows to use state value as \"silent\" dependency in hooks (not causing updates).\n// Also useful for state values that update frequently (such as controlled input value).\nexport function useStateRef<T>(value: T) {\n  const ref = useRef<T>(value);\n  ref.current = value;\n  return ref;\n}\n","// Used before applying CSS transition\nexport default function forceReflow(element: HTMLElement) {\n  // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n  element.offsetWidth;\n}\n","import { DEBUG } from '../config';\n\nconst safePlay = (mediaEl: HTMLMediaElement) => {\n  mediaEl.play().catch((err) => {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.warn(err, mediaEl);\n    }\n  });\n};\n\nexport const getIsVideoPlaying = (video: HTMLVideoElement) => {\n  return video.currentTime > 0 && !video.paused && !video.ended && video.readyState > 2;\n};\n\nexport default safePlay;\n","/* eslint-disable eslint-multitab-tt/no-immediate-global */\nimport { getIsHeavyAnimating, onFullyIdle } from '../lib/teact/teact';\nimport { addCallback, removeCallback } from '../lib/teact/teactn';\n\nimport type {\n  ApiAvailableReaction,\n  ApiMessage,\n} from '../api/types';\nimport type { MessageList, ThreadId } from '../types';\nimport type { ActionReturnType, GlobalState, SharedState } from './types';\nimport { MAIN_THREAD_ID } from '../api/types';\n\nimport {\n  ALL_FOLDER_ID,\n  ARCHIVED_FOLDER_ID,\n  DEBUG,\n  DEFAULT_LIMITS,\n  GLOBAL_STATE_CACHE_ARCHIVED_CHAT_LIST_LIMIT,\n  GLOBAL_STATE_CACHE_CHAT_LIST_LIMIT,\n  GLOBAL_STATE_CACHE_CUSTOM_EMOJI_LIMIT,\n  GLOBAL_STATE_CACHE_DISABLED,\n  GLOBAL_STATE_CACHE_USER_LIST_LIMIT,\n  IS_SCREEN_LOCKED_CACHE_KEY,\n  SAVED_FOLDER_ID,\n  SHARED_STATE_CACHE_KEY,\n} from '../config';\nimport { MAIN_IDB_STORE } from '../util/browser/idb';\nimport { getOrderedIds } from '../util/folderManager';\nimport {\n  compact, pick, pickTruthy, unique,\n} from '../util/iteratees';\nimport { GLOBAL_STATE_CACHE_KEY } from '../util/multiaccount';\nimport { encryptSession } from '../util/passcode';\nimport { onBeforeUnload, throttle } from '../util/schedulers';\nimport { hasStoredSession } from '../util/sessions';\nimport { isUserId } from './helpers';\nimport { addActionHandler, getGlobal } from './index';\nimport { INITIAL_GLOBAL_STATE } from './initialState';\nimport { clearGlobalForLockScreen, clearSharedStateForLockScreen } from './reducers';\nimport {\n  selectChatLastMessageId,\n  selectChatMessages,\n  selectCurrentMessageList,\n  selectTopics,\n  selectViewportIds,\n  selectVisibleUsers,\n} from './selectors';\n\nimport { getIsMobile } from '../hooks/useAppLayout';\n\nconst UPDATE_THROTTLE = 5000;\n\nconst updateCacheThrottled = throttle(() => onFullyIdle(() => updateCache()), UPDATE_THROTTLE, false);\nconst updateCacheForced = () => updateCache(true);\n\nlet isCaching = false;\nlet isRemovingCache = false;\nlet unsubscribeFromBeforeUnload: NoneToVoidFunction | undefined;\n\nexport function cacheGlobal(global: GlobalState) {\n  return MAIN_IDB_STORE.set(GLOBAL_STATE_CACHE_KEY, global);\n}\n\nexport function cacheSharedState(state: SharedState) {\n  return MAIN_IDB_STORE.set(SHARED_STATE_CACHE_KEY, state);\n}\n\nexport function loadCachedGlobal() {\n  return MAIN_IDB_STORE.get<GlobalState>(GLOBAL_STATE_CACHE_KEY);\n}\n\nexport function loadCachedSharedState() {\n  return MAIN_IDB_STORE.get<SharedState>(SHARED_STATE_CACHE_KEY);\n}\n\nexport function removeGlobalFromCache() {\n  return MAIN_IDB_STORE.del(GLOBAL_STATE_CACHE_KEY);\n}\n\nexport function removeSharedStateFromCache() {\n  return MAIN_IDB_STORE.del(SHARED_STATE_CACHE_KEY);\n}\n\nfunction cacheIsScreenLocked(global: GlobalState) {\n  if (global?.passcode?.isScreenLocked) localStorage.setItem(IS_SCREEN_LOCKED_CACHE_KEY, 'true');\n}\n\nexport function initCache() {\n  if (GLOBAL_STATE_CACHE_DISABLED) {\n    return;\n  }\n\n  const resetCache = () => {\n    isRemovingCache = true;\n    removeGlobalFromCache().finally(() => {\n      localStorage.removeItem(IS_SCREEN_LOCKED_CACHE_KEY);\n      isRemovingCache = false;\n      if (!isCaching) {\n        return;\n      }\n\n      clearCaching();\n    });\n  };\n\n  addActionHandler('saveSession', (): ActionReturnType => {\n    if (isCaching) {\n      return;\n    }\n\n    setupCaching();\n    updateCacheForced();\n  });\n\n  addActionHandler('reset', resetCache);\n}\n\nexport async function loadCache(initialState: GlobalState): Promise<GlobalState | undefined> {\n  if (GLOBAL_STATE_CACHE_DISABLED) {\n    return undefined;\n  }\n\n  const cache = await readCache(initialState);\n\n  if (cache.passcode.hasPasscode || hasStoredSession()) {\n    setupCaching();\n\n    return cache;\n  } else {\n    clearCaching();\n\n    return undefined;\n  }\n}\n\nexport function setupCaching() {\n  isCaching = true;\n  unsubscribeFromBeforeUnload = onBeforeUnload(updateCacheForced, true);\n  window.addEventListener('blur', updateCacheForced);\n  addCallback(updateCacheThrottled);\n}\n\nexport function clearCaching() {\n  isCaching = false;\n  removeCallback(updateCacheThrottled);\n  window.removeEventListener('blur', updateCacheForced);\n  if (unsubscribeFromBeforeUnload) {\n    unsubscribeFromBeforeUnload();\n  }\n}\n\nasync function readCache(initialState: GlobalState): Promise<GlobalState> {\n  if (DEBUG) {\n    // eslint-disable-next-line no-console\n    console.time('global-state-cache-read');\n  }\n\n  const json = localStorage.getItem(GLOBAL_STATE_CACHE_KEY);\n  const cachedFromLocalStorage = json ? JSON.parse(json) as GlobalState : undefined;\n  if (cachedFromLocalStorage) localStorage.removeItem(GLOBAL_STATE_CACHE_KEY);\n\n  let cached = cachedFromLocalStorage || await loadCachedGlobal();\n  const cachedSharedState = await loadCachedSharedState();\n  const sharedState = cachedSharedState || initialState.sharedState;\n\n  if (cached) {\n    cached = {\n      ...cached,\n      sharedState,\n    };\n  }\n\n  if (DEBUG) {\n    // eslint-disable-next-line no-console\n    console.timeEnd('global-state-cache-read');\n  }\n\n  if (cached) {\n    migrateCache(cached, initialState);\n  }\n\n  const newState: GlobalState = {\n    ...initialState,\n    ...cached,\n    sharedState: {\n      ...sharedState,\n      ...cached?.sharedState, // Allow migration to override shared state\n    },\n  };\n\n  return newState;\n}\n\nexport function migrateCache(cached: GlobalState, initialState: GlobalState) {\n  try {\n    unsafeMigrateCache(cached, initialState);\n  } catch (err) {\n    // eslint-disable-next-line no-console\n    console.error(err);\n  }\n}\n\nfunction unsafeMigrateCache(cached: GlobalState, initialState: GlobalState) {\n  const untypedCached = cached as any;\n  // Pre-fill settings with defaults\n  cached.settings.byKey = {\n    ...initialState.settings.byKey,\n    ...cached.settings.byKey,\n  };\n\n  cached.chatFolders = {\n    ...initialState.chatFolders,\n    ...cached.chatFolders,\n  };\n\n  if (cached.appConfig && !cached.appConfig.limits) {\n    cached.appConfig.limits = DEFAULT_LIMITS;\n  }\n\n  if (!cached.chats.similarChannelsById) {\n    cached.chats.similarChannelsById = initialState.chats.similarChannelsById;\n  }\n\n  if (!cached.chats.similarBotsById) {\n    cached.chats.similarBotsById = initialState.chats.similarBotsById;\n  }\n\n  if (!cached.chats.lastMessageIds) {\n    cached.chats.lastMessageIds = initialState.chats.lastMessageIds;\n  }\n\n  // Clear old color storage to optimize cache size\n  if (untypedCached?.appConfig?.peerColors) {\n    untypedCached.appConfig.peerColors = undefined;\n    untypedCached.appConfig.darkPeerColors = undefined;\n  }\n\n  if (!cached.fileUploads.byMessageKey) {\n    cached.fileUploads.byMessageKey = {};\n  }\n\n  if (!cached.reactions) {\n    cached.reactions = initialState.reactions;\n  }\n\n  if (!cached.quickReplies) {\n    cached.quickReplies = initialState.quickReplies;\n  }\n\n  if (!cached.users.previewMediaByBotId) {\n    cached.users.previewMediaByBotId = initialState.users.previewMediaByBotId;\n  }\n  if (!cached.chats.loadingParameters) {\n    cached.chats.loadingParameters = initialState.chats.loadingParameters;\n  }\n  if (!cached.topBotApps) {\n    cached.topBotApps = initialState.topBotApps;\n  }\n\n  if (!cached.reactions.defaultTags?.[0]?.type) {\n    cached.reactions = initialState.reactions;\n  }\n\n  if (!cached.users.commonChatsById) {\n    cached.users.commonChatsById = initialState.users.commonChatsById;\n  }\n  if (!cached.users.botAppPermissionsById) {\n    cached.users.botAppPermissionsById = initialState.users.botAppPermissionsById;\n  }\n  if (!cached.chats.topicsInfoById) {\n    cached.chats.topicsInfoById = initialState.chats.topicsInfoById;\n  }\n\n  if (!cached.messages.pollById) {\n    cached.messages.pollById = initialState.messages.pollById;\n  }\n  if (!cached.settings.botVerificationShownPeerIds) {\n    cached.settings.botVerificationShownPeerIds = initialState.settings.botVerificationShownPeerIds;\n  }\n\n  if (!cached.peers) {\n    cached.peers = initialState.peers;\n  }\n\n  if (!cached.cacheVersion) {\n    cached.cacheVersion = initialState.cacheVersion;\n    // Reset because of the new action message structure\n    cached.messages = initialState.messages;\n    cached.chats.listIds = initialState.chats.listIds;\n  }\n\n  if (!cached.messages.playbackByChatId) {\n    cached.messages.playbackByChatId = initialState.messages.playbackByChatId;\n  }\n\n  if (cached.cacheVersion < 2) {\n    if (untypedCached.settings.themes.dark) {\n      untypedCached.settings.themes.dark.patternColor = (initialState as any).settings.themes.dark!.patternColor;\n    }\n\n    if (untypedCached.settings.themes.light) {\n      untypedCached.settings.themes.light.patternColor = (initialState as any).settings.themes.light!.patternColor;\n    }\n\n    cached.cacheVersion = 2;\n  }\n\n  if (cached.appConfig?.limits && !cached.appConfig.limits.moreAccounts) {\n    cached.appConfig.limits.moreAccounts = DEFAULT_LIMITS.moreAccounts;\n  }\n  if (!cached.chats.notifyExceptionById) {\n    cached.chats.notifyExceptionById = initialState.chats.notifyExceptionById;\n  }\n\n  if (!cached.sharedState) {\n    cached.sharedState = initialState.sharedState;\n    cached.sharedState.settings = {\n      canDisplayChatInTitle: untypedCached.settings.byKey.canDisplayChatInTitle,\n      animationLevel: untypedCached.settings.byKey.animationLevel,\n      messageSendKeyCombo: untypedCached.settings.byKey.messageSendKeyCombo,\n      messageTextSize: untypedCached.settings.byKey.messageTextSize,\n      performance: untypedCached.settings.performance,\n      theme: untypedCached.settings.byKey.theme,\n      timeFormat: untypedCached.settings.byKey.timeFormat,\n      wasTimeFormatSetManually: untypedCached.settings.byKey.wasTimeFormatSetManually,\n      shouldUseSystemTheme: untypedCached.settings.byKey.shouldUseSystemTheme,\n      isConnectionStatusMinimized: untypedCached.settings.byKey.isConnectionStatusMinimized,\n      shouldForceHttpTransport: untypedCached.settings.byKey.shouldForceHttpTransport,\n      language: untypedCached.settings.byKey.language,\n      languages: untypedCached.settings.languages,\n      shouldSkipWebAppCloseConfirmation: untypedCached.settings.byKey.shouldSkipWebAppCloseConfirmation,\n      miniAppsCachedPosition: untypedCached.settings.miniAppsCachedPosition,\n      miniAppsCachedSize: untypedCached.settings.miniAppsCachedSize,\n      shouldAllowHttpTransport: untypedCached.settings.byKey.shouldAllowHttpTransport,\n      shouldCollectDebugLogs: untypedCached.settings.byKey.shouldCollectDebugLogs,\n      shouldDebugExportedSenders: untypedCached.settings.byKey.shouldDebugExportedSenders,\n      shouldWarnAboutSvg: untypedCached.settings.byKey.shouldWarnAboutSvg,\n    };\n  }\n\n  if (!cached.settings.themes) {\n    cached.settings.themes = initialState.settings.themes;\n  }\n}\n\nfunction updateCache(force?: boolean) {\n  const global = getGlobal();\n  if (isRemovingCache || !isCaching || global.isLoggingOut || (!force && getIsHeavyAnimating())) {\n    return;\n  }\n\n  forceUpdateCache();\n}\n\nexport function forceUpdateCache(noEncrypt = false) {\n  const global = getGlobal();\n  const { hasPasscode, isScreenLocked } = global.passcode;\n\n  if (hasPasscode) {\n    if (!isScreenLocked && !noEncrypt) {\n      const serializedGlobal = serializeGlobal(global);\n      void encryptSession(undefined, serializedGlobal);\n    }\n\n    cacheIsScreenLocked(global);\n    cacheGlobal(clearGlobalForLockScreen(global, false));\n    cacheSharedState(clearSharedStateForLockScreen(global.sharedState));\n    return;\n  }\n\n  cacheIsScreenLocked(global);\n  cacheGlobal(reduceGlobal(global));\n  cacheSharedState(reduceSharedState(global.sharedState));\n}\n\nfunction reduceGlobal<T extends GlobalState>(global: T) {\n  const reducedGlobal: GlobalState = {\n    ...INITIAL_GLOBAL_STATE,\n    ...pick(global, [\n      'appConfig',\n      'config',\n      'authState',\n      'authPhoneNumber',\n      'authRememberMe',\n      'authNearestCountry',\n      'attachMenu',\n      'currentUserId',\n      'contactList',\n      'topPeers',\n      'topInlineBots',\n      'topBotApps',\n      'recentEmojis',\n      'recentCustomEmojis',\n      'push',\n      'serviceNotifications',\n      'attachmentSettings',\n      'leftColumnWidth',\n      'archiveSettings',\n      'mediaViewer',\n      'audioPlayer',\n      'shouldShowContextMenuHint',\n      'trustedBotIds',\n      'recentlyFoundChatIds',\n      'peerColors',\n      'savedReactionTags',\n      'timezones',\n      'availableEffectById',\n    ]),\n    lastIsChatInfoShown: !getIsMobile() ? global.lastIsChatInfoShown : undefined,\n    customEmojis: reduceCustomEmojis(global),\n    users: reduceUsers(global),\n    chats: reduceChats(global),\n    messages: reduceMessages(global),\n    settings: reduceSettings(global),\n    chatFolders: reduceChatFolders(global),\n    groupCalls: reduceGroupCalls(global),\n    reactions: {\n      ...pick(global.reactions, [\n        'defaultTags',\n        'recentReactions',\n        'topReactions',\n        'effectReactions',\n        'hash',\n      ]),\n      availableReactions: reduceAvailableReactions(global.reactions.availableReactions),\n    },\n    passcode: pick(global.passcode, [\n      'isScreenLocked',\n      'hasPasscode',\n      'invalidAttemptsCount',\n      'timeoutUntil',\n    ]),\n  };\n\n  return reducedGlobal;\n}\n\nfunction reduceSharedState(sharedState: SharedState): SharedState {\n  return {\n    ...sharedState,\n    settings: {\n      ...sharedState.settings,\n      languages: undefined,\n    },\n    isInitial: undefined,\n  };\n}\n\nexport function serializeGlobal<T extends GlobalState>(global: T) {\n  return JSON.stringify(reduceGlobal(global));\n}\n\nfunction reduceCustomEmojis<T extends GlobalState>(global: T): GlobalState['customEmojis'] {\n  const { lastRendered, byId } = global.customEmojis;\n  const idsToSave = lastRendered.slice(0, GLOBAL_STATE_CACHE_CUSTOM_EMOJI_LIMIT);\n  const byIdToSave = pick(byId, idsToSave);\n\n  return {\n    byId: byIdToSave,\n    lastRendered: idsToSave,\n    forEmoji: {},\n    added: {},\n    statusRecent: {},\n  };\n}\n\nfunction reduceUsers<T extends GlobalState>(global: T): GlobalState['users'] {\n  const {\n    users: {\n      byId, statusesById, fullInfoById, botAppPermissionsById,\n    }, currentUserId,\n  } = global;\n  const currentChatIds = compact(\n    Object.values(global.byTabId)\n      .map(({ id: tabId }) => selectCurrentMessageList(global, tabId)),\n  ).map(({ chatId }) => chatId).filter((chatId) => isUserId(chatId));\n\n  const visibleUserIds = unique(compact(Object.values(global.byTabId)\n    .flatMap(({ id: tabId }) => selectVisibleUsers(global, tabId)?.map((u) => u.id) || [])));\n\n  const chatStoriesUserIds = currentChatIds\n    .flatMap((chatId) => Object.values(selectChatMessages(global, chatId) || {}))\n    .map((message) => message.content.storyData?.peerId || message.content.webPage?.story?.peerId)\n    .filter((id): id is string => Boolean(id) && isUserId(id));\n\n  const attachBotIds = Object.keys(global.attachMenu?.bots || {});\n\n  const idsToSave = unique([\n    ...currentUserId ? [currentUserId] : [],\n    ...currentChatIds,\n    ...chatStoriesUserIds,\n    ...visibleUserIds || [],\n    ...attachBotIds,\n    ...global.topPeers.userIds || [],\n    ...global.recentlyFoundChatIds?.filter(isUserId) || [],\n    ...getOrderedIds(ARCHIVED_FOLDER_ID)?.slice(0, GLOBAL_STATE_CACHE_ARCHIVED_CHAT_LIST_LIMIT).filter(isUserId) || [],\n    ...getOrderedIds(ALL_FOLDER_ID)?.filter(isUserId) || [],\n    ...global.contactList?.userIds || [],\n    ...Object.keys(byId),\n  ]).slice(0, GLOBAL_STATE_CACHE_USER_LIST_LIMIT);\n\n  return {\n    ...INITIAL_GLOBAL_STATE.users,\n    byId: pickTruthy(byId, idsToSave),\n    statusesById: pickTruthy(statusesById, idsToSave),\n    fullInfoById: pickTruthy(fullInfoById, idsToSave),\n    botAppPermissionsById,\n  };\n}\n\nfunction reduceChats<T extends GlobalState>(global: T): GlobalState['chats'] {\n  const { chats: { byId }, currentUserId } = global;\n  const currentChatIds = compact(\n    Object.values(global.byTabId)\n      .map(({ id: tabId }): MessageList | undefined => {\n        return selectCurrentMessageList(global, tabId);\n      }),\n  ).map(({ chatId }) => chatId);\n\n  const messagesChatIds = compact(Object.values(global.byTabId).flatMap(({ id: tabId }) => {\n    const messageList = selectCurrentMessageList(global, tabId);\n    if (!messageList) return undefined;\n\n    const messages = selectChatMessages(global, messageList.chatId);\n    const viewportIds = selectViewportIds(global, messageList.chatId, messageList.threadId, tabId);\n    return viewportIds?.map((id) => {\n      const message = messages[id];\n      if (!message) return undefined;\n      const content = message.content;\n      const replyPeer = message.replyInfo?.type === 'message' && message.replyInfo.replyToPeerId;\n      return content.storyData?.peerId || content.webPage?.story?.peerId || replyPeer;\n    });\n  }));\n\n  const idsToSave = unique([\n    ...currentUserId ? [currentUserId] : [],\n    ...currentChatIds,\n    ...messagesChatIds,\n    ...global.recentlyFoundChatIds || [],\n    ...getOrderedIds(ARCHIVED_FOLDER_ID)?.slice(0, GLOBAL_STATE_CACHE_ARCHIVED_CHAT_LIST_LIMIT) || [],\n    ...getOrderedIds(ALL_FOLDER_ID) || [],\n    ...getOrderedIds(SAVED_FOLDER_ID) || [],\n    ...Object.keys(byId),\n  ]).slice(0, GLOBAL_STATE_CACHE_CHAT_LIST_LIMIT);\n\n  return {\n    ...global.chats,\n    similarChannelsById: {},\n    similarBotsById: {},\n    isFullyLoaded: {},\n    notifyExceptionById: pickTruthy(global.chats.notifyExceptionById, idsToSave),\n    loadingParameters: INITIAL_GLOBAL_STATE.chats.loadingParameters,\n    byId: pickTruthy(global.chats.byId, idsToSave),\n    fullInfoById: pickTruthy(global.chats.fullInfoById, idsToSave),\n    lastMessageIds: {\n      all: pickTruthy(global.chats.lastMessageIds.all || {}, idsToSave),\n      saved: global.chats.lastMessageIds.saved,\n    },\n    topicsInfoById: pickTruthy(global.chats.topicsInfoById, currentChatIds),\n  };\n}\n\nfunction reduceMessages<T extends GlobalState>(global: T): GlobalState['messages'] {\n  const { currentUserId } = global;\n  const byChatId: GlobalState['messages']['byChatId'] = {};\n  const currentChatIds = compact(\n    Object.values(global.byTabId)\n      .map(({ id: tabId }) => selectCurrentMessageList(global, tabId)),\n  ).map(({ chatId }) => chatId);\n  const forumPanelChatIds = compact(\n    Object.values(global.byTabId)\n      .map(({ forumPanelChatId }) => forumPanelChatId),\n  );\n  const chatIdsToSave = unique([\n    ...currentChatIds,\n    ...currentUserId ? [currentUserId] : [],\n    ...forumPanelChatIds,\n    ...getOrderedIds(ALL_FOLDER_ID) || [],\n    ...getOrderedIds(ARCHIVED_FOLDER_ID)?.slice(0, GLOBAL_STATE_CACHE_ARCHIVED_CHAT_LIST_LIMIT) || [],\n  ]);\n\n  const openedChatThreadIds = Object.values(global.byTabId).reduce((acc, { id: tabId }) => {\n    const { chatId: tabChatId, threadId } = selectCurrentMessageList(global, tabId) || {};\n    if (!tabChatId || !threadId || threadId === MAIN_THREAD_ID) {\n      return acc;\n    }\n    const current = acc[tabChatId] || new Set();\n    current.add(threadId);\n    acc[tabChatId] = current;\n\n    return acc;\n  }, {} as Record<string, Set<ThreadId>>);\n\n  const pollIdsToSave: string[] = [];\n\n  chatIdsToSave.forEach((chatId) => {\n    const current = global.messages.byChatId[chatId];\n    if (!current) {\n      return;\n    }\n\n    const chatLastMessageId = selectChatLastMessageId(global, chatId);\n\n    const openedThreadIds = Array.from(openedChatThreadIds[chatId] || []);\n    const commentThreadIds = Object.values(global.messages.byChatId[chatId].threadsById || {})\n      .map(({ threadInfo }) => (threadInfo?.isCommentsInfo ? threadInfo?.originMessageId : undefined))\n      .filter(Boolean);\n    const threadIds = unique(openedThreadIds.concat(commentThreadIds));\n\n    const threadsToSave = pickTruthy(current.threadsById, [MAIN_THREAD_ID, ...threadIds]);\n\n    const viewportIdsToSave = unique(Object.values(threadsToSave).flatMap((thread) => thread.lastViewportIds || []));\n    const topics = selectTopics(global, chatId);\n    const topicLastMessageIds = topics && forumPanelChatIds.includes(chatId)\n      ? Object.values(topics).map(({ lastMessageId }) => lastMessageId) : [];\n    const savedLastMessageIds = chatId === currentUserId && global.chats.lastMessageIds.saved\n      ? Object.values(global.chats.lastMessageIds.saved) : [];\n    const lastMessageIdsToSave = [chatLastMessageId].concat(topicLastMessageIds).concat(savedLastMessageIds)\n      .filter(Boolean);\n    const byId = pick(current.byId, viewportIdsToSave.concat(lastMessageIdsToSave));\n    const threadsById = Object.keys(threadsToSave).reduce((acc, key) => {\n      const thread = threadsToSave[Number(key)];\n      acc[Number(key)] = {\n        ...thread,\n        listedIds: thread.lastViewportIds,\n        pinnedIds: undefined,\n        typingStatus: undefined,\n      };\n      return acc;\n    }, {} as GlobalState['messages']['byChatId'][string]['threadsById']);\n\n    const cleanedById = Object.values(byId).reduce((acc, message) => {\n      if (!message) return acc;\n\n      let cleanedMessage = omitLocalMedia(message);\n      cleanedMessage = omitLocalPaidReactions(cleanedMessage);\n      acc[message.id] = cleanedMessage;\n\n      if (message.content.pollId) {\n        pollIdsToSave.push(message.content.pollId);\n      }\n\n      return acc;\n    }, {} as Record<number, ApiMessage>);\n\n    byChatId[chatId] = {\n      byId: cleanedById,\n      threadsById,\n    };\n  });\n\n  return {\n    byChatId,\n    pollById: pickTruthy(global.messages.pollById, pollIdsToSave),\n    sponsoredByChatId: {},\n    playbackByChatId: {},\n  };\n}\n\nfunction omitLocalPaidReactions(message: ApiMessage): ApiMessage {\n  if (!message.reactions?.results.length) return message;\n  return {\n    ...message,\n    reactions: {\n      ...message.reactions,\n      results: message.reactions.results.map((reaction) => {\n        if (reaction.localAmount) {\n          return {\n            ...reaction,\n            localAmount: undefined,\n          };\n        }\n        return reaction;\n      }),\n    },\n  };\n}\n\nfunction omitLocalMedia(message: ApiMessage): ApiMessage {\n  const {\n    photo, video, document, sticker,\n  } = message.content;\n\n  return {\n    ...message,\n    content: {\n      ...message.content,\n      photo: photo && {\n        ...photo,\n        blobUrl: undefined,\n      },\n      video: video && {\n        ...video,\n        blobUrl: undefined,\n        previewBlobUrl: undefined,\n      },\n      document: document && {\n        ...document,\n        previewBlobUrl: undefined,\n      },\n      sticker: sticker && {\n        ...sticker,\n        isPreloadedGlobally: undefined,\n      },\n    },\n    previousLocalId: undefined,\n  };\n}\n\nfunction reduceSettings<T extends GlobalState>(global: T): GlobalState['settings'] {\n  const {\n    byKey, botVerificationShownPeerIds, notifyDefaults, lastPremiumBandwithNotificationDate, themes,\n  } = global.settings;\n\n  return {\n    byKey,\n    privacy: {},\n    botVerificationShownPeerIds,\n    lastPremiumBandwithNotificationDate,\n    notifyDefaults,\n    themes,\n  };\n}\n\nfunction reduceChatFolders<T extends GlobalState>(global: T): GlobalState['chatFolders'] {\n  return {\n    ...global.chatFolders,\n  };\n}\n\nfunction reduceGroupCalls<T extends GlobalState>(global: T): GlobalState['groupCalls'] {\n  return {\n    ...global.groupCalls,\n    byId: {},\n    activeGroupCallId: undefined,\n  };\n}\n\nfunction reduceAvailableReactions(availableReactions?: ApiAvailableReaction[]): ApiAvailableReaction[] | undefined {\n  return availableReactions\n    ?.map((r) => pick(r, ['reaction', 'staticIcon', 'title', 'isInactive']));\n}","import type { FC } from '../../lib/teact/teact';\nimport React, { memo, useMemo, useState } from '../../lib/teact/teact';\n\nimport { debounce } from '../../util/schedulers';\n\nimport useLastCallback from '../../hooks/useLastCallback';\n\nimport './RippleEffect.scss';\n\ninterface Ripple {\n  x: number;\n  y: number;\n  size: number;\n}\n\nconst ANIMATION_DURATION_MS = 700;\n\nconst RippleEffect: FC = () => {\n  const [ripples, setRipples] = useState<Ripple[]>([]);\n\n  const cleanUpDebounced = useMemo(() => {\n    return debounce(() => {\n      setRipples([]);\n    }, ANIMATION_DURATION_MS, false);\n  }, []);\n\n  const handleMouseDown = useLastCallback((e: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n    if (e.button !== 0) {\n      return;\n    }\n\n    const container = e.currentTarget;\n    const position = container.getBoundingClientRect();\n    const rippleSize = container.offsetWidth / 2;\n\n    setRipples([\n      ...ripples,\n      {\n        x: e.clientX - position.x - (rippleSize / 2),\n        y: e.clientY - position.y - (rippleSize / 2),\n        size: rippleSize,\n      },\n    ]);\n\n    cleanUpDebounced();\n  });\n\n  return (\n    <div className=\"ripple-container\" onMouseDown={handleMouseDown}>\n      {ripples.map(({ x, y, size }) => (\n        <div\n          className=\"ripple-wave\"\n          style={`left: ${x}px; top: ${y}px; width: ${size}px; height: ${size}px;`}\n        />\n      ))}\n    </div>\n  );\n};\n\nexport default memo(RippleEffect);\n","import { DEBUG } from '../../config';\n\nexport default function readStrings(data: string): Record<string, string> {\n  const lines = data.split(/;\\r?\\n?/);\n  const result: Record<string, string> = {};\n  for (const line of lines) {\n    if (!line.startsWith('\"')) continue;\n    const [key, value] = parseLine(line) || [];\n    if (!key || !value) {\n      // eslint-disable-next-line no-console\n      console.warn('Bad formatting in line:', line);\n      continue;\n    }\n    if (result[key]) {\n      // eslint-disable-next-line no-console\n      console.warn('Duplicate key:', key);\n    }\n    result[key] = value;\n  }\n  return result;\n}\n\nfunction parseLine(line: string) {\n  let isEscaped = false;\n  let isInsideString = false;\n\n  let separatorIndex;\n  for (let i = 0; i < line.length; i++) {\n    const char = line[i];\n    if (char === '\\\\') {\n      isEscaped = !isEscaped;\n      continue;\n    }\n\n    if (char === '\"' && !isEscaped) {\n      isInsideString = !isInsideString;\n      continue;\n    }\n\n    if (char === '=' && !isInsideString) {\n      separatorIndex = i;\n      break;\n    }\n\n    isEscaped = false;\n  }\n\n  if (separatorIndex === undefined || separatorIndex === line.length - 1) return undefined;\n\n  try {\n    const key = JSON.parse(line.slice(0, separatorIndex));\n    const value = JSON.parse(line.slice(separatorIndex + 1));\n\n    return [key, value];\n  } catch (e) {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.error('Error parsing line:', line, e);\n    }\n  }\n\n  return undefined;\n}\n","import type {\n  ApiLanguage, CachedLangData, LangPack, LangPackStringValuePlural,\n} from '../../api/types';\n\nimport readStrings from './readStrings';\n\nconst FALLBACK_LANG_CODE = 'en';\nconst FALLBACK_VERSION = 0;\nconst FALLBACK_TRANSLATE_URL = 'https://translations.telegram.org/en/weba';\n\nexport default async function readFallbackStrings(forLocalScript?: boolean): Promise<CachedLangData> {\n  let fileData;\n  if (forLocalScript) {\n    fileData = (await import('fs')).readFileSync('./src/assets/localization/fallback.strings', 'utf8');\n  } else {\n    const file = await import('../../assets/localization/fallback.strings');\n    fileData = file.default;\n  }\n  const rawStrings = readStrings(fileData);\n\n  const strings: LangPack['strings'] = {};\n\n  Object.entries(rawStrings).forEach(([key, value]) => {\n    const [clearKey, pluralSuffix] = key.split('_');\n\n    if (!pluralSuffix) {\n      strings[clearKey] = value;\n      return;\n    }\n\n    const knownValue = (strings[clearKey] || {}) as LangPackStringValuePlural;\n    knownValue[pluralSuffix as keyof LangPackStringValuePlural] = value;\n    strings[clearKey] = knownValue;\n  });\n\n  const langPack: LangPack = {\n    langCode: FALLBACK_LANG_CODE,\n    version: FALLBACK_VERSION,\n    strings,\n  };\n\n  const stringsCount = Object.keys(strings).length;\n\n  const language: ApiLanguage = {\n    langCode: FALLBACK_LANG_CODE,\n    name: 'English',\n    nativeName: 'English',\n    pluralCode: FALLBACK_LANG_CODE,\n    stringsCount,\n    translatedCount: stringsCount,\n    translationsUrl: FALLBACK_TRANSLATE_URL,\n  };\n\n  return {\n    langPack,\n    language,\n  };\n}\n","/* eslint-disable */\n// This file is generated by dev/generateInitialLangFallback.ts. Do not edit it manually.\n\nimport type { LangPackStringValue } from '../../api/types';\nimport type { LangKey } from '../../types/language';\n\nexport default {\n  \"WrongNumber\": \"Wrong number?\",\n  \"SentAppCode\": \"We've sent the code to the **Telegram** app on your other device.\",\n  \"LoginJustSentSms\": \"We've sent you a code via SMS. Please enter it above.\",\n  \"LoginHeaderPassword\": \"Enter Password\",\n  \"LoginEnterPasswordDescription\": \"You have Two-Step Verification enabled, so your account is protected with an additional password.\",\n  \"StartText\": \"Please confirm your country code\\nand enter your phone number.\",\n  \"LoginPhonePlaceholder\": \"Your phone number\",\n  \"LoginNext\": \"Next\",\n  \"LoginQRLogin\": \"Log in by QR Code\",\n  \"LoginQRTitle\": \"Log in to Telegram by QR Code\",\n  \"LoginQRHelp1\": \"Open Telegram on your phone\",\n  \"LoginQRHelp2\": \"Go to **Settings** > **Devices** > **Link Desktop Device**\",\n  \"LoginQRHelp3\": \"Point your phone at this screen to confirm login\",\n  \"LoginQRCancel\": \"Log in by phone Number\",\n  \"YourName\": \"Your Name\",\n  \"LoginRegisterDesc\": \"Enter your name and add a profile photo.\",\n  \"LoginRegisterFirstNamePlaceholder\": \"First Name\",\n  \"LoginRegisterLastNamePlaceholder\": \"Last Name\",\n  \"LoginSelectCountryTitle\": \"Country\",\n  \"CountryNone\": \"Country not found\",\n  \"PleaseEnterPassword\": \"Enter your new password\",\n  \"ErrorPhoneNumberInvalid\": \"Invalid phone number, please try again.\",\n  \"ErrorCodeInvalid\": \"Invalid code, please try again.\",\n  \"ErrorIncorrectPassword\": \"Invalid password, please try again.\",\n  \"ErrorPasswordFlood\": \"Too many attempts, please try again later.\",\n  \"ErrorPhoneBanned\": \"This phone number is banned.\",\n  \"ErrorFloodTime\": \"Too many attempts, please try again in {time}.\",\n  \"ErrorUnexpected\": \"Unexpected error\",\n  \"ErrorUnexpectedMessage\": \"Unexpected error: {error}\"\n} as Record<LangKey, LangPackStringValue>;\n","import type { TeactNode } from '../../lib/teact/teact';\n\nimport type {\n  ApiLanguage,\n  CachedLangData,\n  LangPack,\n  LangPackStringValue,\n} from '../../api/types';\nimport type { LangKey, LangVariable } from '../../types/language';\nimport {\n  type AdvancedLangFnOptions,\n  type AdvancedLangFnOptionsWithPlural,\n  type AdvancedLangFnParameters,\n  areAdvancedLangFnOptions,\n  isDeletedLangString,\n  isPluralLangString,\n  type LangFn,\n  type LangFnOptions,\n  type LangFnOptionsWithPlural,\n  type LangFnParameters,\n  type LangFormatters,\n  type RegularLangFnParameters,\n} from './types';\n\nimport { DEBUG, LANG_PACK } from '../../config';\nimport { callApi } from '../../api/gramjs';\nimport renderText, { type TextFilter } from '../../components/common/helpers/renderText';\nimport { IS_INTL_LIST_FORMAT_SUPPORTED } from '../browser/globalEnvironment';\nimport { MAIN_IDB_STORE } from '../browser/idb';\nimport { getBasicListFormat } from '../browser/intlListFormat';\nimport { notifyLangpackUpdate } from '../browser/multitab';\nimport { createCallbackManager } from '../callbacks';\nimport readFallbackStrings from '../data/readFallbackStrings';\nimport { initialEstablishmentPromise, isCurrentTabMaster } from '../establishMultitabRole';\nimport { omit, unique } from '../iteratees';\nimport { replaceInStringsWithTeact } from '../replaceWithTeact';\nimport { fastRaf } from '../schedulers';\n\nimport Deferred from '../Deferred';\nimport LimitedMap from '../primitives/LimitedMap';\n\nimport initialStrings from '../../assets/localization/initialStrings';\n\nconst LANGPACK_STORE_PREFIX = 'langpack-';\nconst FORMATTERS_FALLBACK_LANG = 'en';\n\nconst STRING_CACHE_LIMIT = 400;\nconst TRANSLATION_CACHE = new LimitedMap<string, string>(STRING_CACHE_LIMIT);\n\nlet language: ApiLanguage | undefined;\nlet formatters: LangFormatters | undefined;\n\nlet langPack: LangPack | undefined;\nlet fallbackLangPack: LangPack | undefined;\n\nlet translationFn = createTranslationFn();\n\nconst {\n  addCallback,\n  removeCallback,\n  runCallbacks,\n} = createCallbackManager();\n\nlet areCallbacksScheduled = false;\nfunction scheduleCallbacks() {\n  if (areCallbacksScheduled) return;\n  areCallbacksScheduled = true;\n  fastRaf(() => {\n    runCallbacks();\n    areCallbacksScheduled = false;\n  });\n}\n\nconst localizationReady = new Deferred<void>();\n\nfunction loadCachedLangData(langCode: string) {\n  return MAIN_IDB_STORE.get<CachedLangData>(`${LANGPACK_STORE_PREFIX}${langCode}`);\n}\n\nfunction cacheLangData(data: CachedLangData) {\n  notifyLangpackUpdate(data.language.langCode);\n  return MAIN_IDB_STORE.set(`${LANGPACK_STORE_PREFIX}${data.language.langCode}`, data);\n}\n\nlet fallbackLoadPromise: Promise<CachedLangData> | undefined;\nasync function loadFallbackPack() {\n  if (fallbackLangPack || fallbackLoadPromise) return;\n  fallbackLoadPromise = readFallbackStrings();\n  const fallbackData = await fallbackLoadPromise;\n  fallbackLangPack = fallbackData.langPack;\n\n  TRANSLATION_CACHE.clear();\n\n  if (!language) {\n    updateLanguage(fallbackData.language);\n  } else {\n    translationFn = createTranslationFn();\n    scheduleCallbacks();\n  }\n}\n\nasync function fetchDifference() {\n  if (!langPack || !language) {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.warn('[Localization] Trying to fetch difference without loaded data');\n    }\n    return;\n  }\n\n  await initialEstablishmentPromise;\n  if (!isCurrentTabMaster()) return;\n\n  const result = await callApi('fetchLangDifference', {\n    langPack: LANG_PACK,\n    langCode: langPack.langCode,\n    fromVersion: langPack.version,\n  });\n  if (!result) return;\n\n  applyLangPackDifference(result.version, result.strings, result.keysToRemove);\n}\n\nexport function applyLangPackDifference(\n  version: number, strings: Record<string, LangPackStringValue>, keysToRemove: string[],\n) {\n  if (!langPack || !language || version === langPack.version) return;\n\n  const newLangPack = {\n    ...langPack,\n    version,\n    strings: {\n      ...omit(langPack.strings, keysToRemove),\n      ...strings,\n    },\n  };\n  updateLangPack(newLangPack);\n\n  cacheLangData({\n    langPack: newLangPack,\n    language,\n  });\n  scheduleCallbacks();\n}\n\nfunction updateLanguage(newLang: ApiLanguage) {\n  language = newLang;\n\n  createFormatters();\n\n  translationFn = createTranslationFn();\n\n  scheduleCallbacks();\n}\n\nfunction createFormatters() {\n  if (!language) return;\n  const langCode = language.pluralCode;\n  const listFormatFallback = getBasicListFormat();\n\n  function createListFormat(lang: string, type: 'conjunction' | 'disjunction') {\n    return IS_INTL_LIST_FORMAT_SUPPORTED ? new Intl.ListFormat(lang, { type }) : listFormatFallback;\n  }\n\n  try {\n    formatters = {\n      pluralRules: new Intl.PluralRules(langCode),\n      region: new Intl.DisplayNames(langCode, { type: 'region' }),\n      conjunction: createListFormat(langCode, 'conjunction'),\n      disjunction: createListFormat(langCode, 'disjunction'),\n      number: new Intl.NumberFormat(langCode),\n    };\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.warn('Failed to create formatters:', e);\n    formatters = {\n      pluralRules: new Intl.PluralRules(FORMATTERS_FALLBACK_LANG),\n      region: new Intl.DisplayNames(FORMATTERS_FALLBACK_LANG, { type: 'region' }),\n      conjunction: createListFormat(FORMATTERS_FALLBACK_LANG, 'conjunction'),\n      disjunction: createListFormat(FORMATTERS_FALLBACK_LANG, 'disjunction'),\n      number: new Intl.NumberFormat(FORMATTERS_FALLBACK_LANG),\n    };\n  }\n}\n\nfunction updateLangPack(newLangPack: LangPack) {\n  langPack = newLangPack;\n\n  TRANSLATION_CACHE.clear();\n\n  scheduleCallbacks();\n}\n\nexport async function initLocalization(langCode: string, canLoadFromServer?: boolean) {\n  if (language) return;\n\n  const cachedData = await loadCachedLangData(langCode);\n  if (cachedData) {\n    langPack = cachedData.langPack;\n    language = cachedData.language;\n    createFormatters();\n\n    fetchDifference();\n  } else if (canLoadFromServer) {\n    await loadAndChangeLanguage(langCode);\n  }\n\n  // Always start loading fallback pack in the background. Some languages may not have every string translated.\n  loadFallbackPack();\n\n  translationFn = createTranslationFn();\n  scheduleCallbacks();\n  localizationReady.resolve();\n}\n\nexport async function refreshFromCache(langCode: string) {\n  if (isCurrentTabMaster()) return;\n\n  const cachedData = await loadCachedLangData(langCode);\n  if (cachedData) {\n    updateLangPack(cachedData.langPack);\n    updateLanguage(cachedData.language);\n  }\n}\n\nexport async function loadAndChangeLanguage(langCode: string, shouldCheckCache?: boolean) {\n  if (shouldCheckCache) { // Can be removed when old lang provider is phased out. Cache is checked in `initLocalization`.\n    const cachedData = await loadCachedLangData(langCode);\n    if (cachedData) {\n      return changeLanguage(cachedData.language);\n    }\n  }\n\n  await initialEstablishmentPromise;\n  if (!isCurrentTabMaster()) return undefined;\n\n  const remoteLanguage = await callApi('fetchLanguage', {\n    langPack: LANG_PACK,\n    langCode,\n  });\n\n  if (!remoteLanguage) {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.warn('Failed to fetch language', langCode);\n    }\n    return undefined;\n  }\n\n  return changeLanguage(remoteLanguage);\n}\n\nexport function requestLangPackDifference(langCode: string) {\n  if (language?.langCode !== langCode) return;\n  fetchDifference();\n}\n\nexport async function changeLanguage(newLanguage: ApiLanguage) {\n  if (langPack && language?.langCode === newLanguage.langCode) return;\n\n  const cachedData = await loadCachedLangData(newLanguage.langCode);\n  if (cachedData) {\n    updateLangPack(cachedData.langPack);\n    updateLanguage(cachedData.language);\n\n    fetchDifference();\n  } else {\n    await initialEstablishmentPromise;\n    if (!isCurrentTabMaster()) return;\n    const remoteLangPack = await callApi('fetchLangPack', {\n      langPack: LANG_PACK,\n      langCode: newLanguage.langCode,\n    });\n    if (!remoteLangPack) {\n      // eslint-disable-next-line no-console\n      console.warn('Failed to fetch lang pack');\n      return;\n    }\n\n    updateLangPack({\n      langCode: newLanguage.langCode,\n      version: remoteLangPack.version,\n      strings: remoteLangPack.strings,\n    });\n    updateLanguage(newLanguage);\n\n    cacheLangData({\n      langPack: langPack!,\n      language: newLanguage,\n    });\n  }\n\n  document.documentElement.lang = newLanguage.baseLangCode || newLanguage.langCode;\n\n  scheduleCallbacks();\n}\n\nfunction createTranslationFn(): LangFn {\n  const fn: LangFn = ((\n    key: LangKey,\n    variables: Record<string, unknown> | undefined,\n    options: LangFnOptions | AdvancedLangFnOptions | undefined,\n  ) => {\n    if (options && areAdvancedLangFnOptions(options)) {\n      return processTranslationAdvanced(key, variables as Record<string, TeactNode>, options);\n    }\n    return processTranslation(key, variables as Record<string, string | number>, options);\n  }) as LangFn;\n  fn.rawCode = language?.langCode || FORMATTERS_FALLBACK_LANG;\n  fn.isRtl = language?.isRtl;\n  fn.code = language?.pluralCode || FORMATTERS_FALLBACK_LANG;\n  fn.with = (({ key, variables, options }: LangFnParameters) => {\n    if (options && areAdvancedLangFnOptions(options)) {\n      return processTranslationAdvanced(key, variables as Record<string, TeactNode | undefined>, options);\n    }\n    return processTranslation(key, variables as Record<string, LangVariable>, options);\n  });\n  fn.withRegular = (({ key, variables, options }: RegularLangFnParameters) => {\n    return processTranslation(key, variables, options);\n  });\n  fn.withAdvanced = (({ key, variables, options }: AdvancedLangFnParameters) => {\n    return processTranslationAdvanced(key, variables, options);\n  });\n  fn.region = (code: string) => formatters?.region.of(code);\n  fn.conjunction = (list: string[]) => formatters?.conjunction.format(list) || list.join(', ');\n  fn.disjunction = (list: string[]) => formatters?.disjunction.format(list) || list.join(', ');\n  fn.number = (value: number) => formatters?.number.format(value) || String(value);\n  fn.internalFormatters = formatters!;\n  fn.languageInfo = language!;\n  return fn;\n}\n\nexport function getTranslationFn(): LangFn {\n  return translationFn;\n}\n\nfunction getString(langKey: LangKey, count: number) {\n  let langPackStringValue = langPack?.strings[langKey];\n\n  if (!langPackStringValue && !fallbackLangPack) {\n    loadFallbackPack();\n  }\n\n  langPackStringValue ||= fallbackLangPack?.strings[langKey];\n  langPackStringValue ||= initialStrings[langKey];\n\n  if (!langPackStringValue || isDeletedLangString(langPackStringValue)) return undefined;\n\n  const pluralSuffix = formatters?.pluralRules.select(count) || 'other';\n\n  const string = isPluralLangString(langPackStringValue)\n    ? (langPackStringValue[pluralSuffix] || langPackStringValue.other)\n    : langPackStringValue;\n\n  return string;\n}\n\nfunction processTranslation(\n  langKey: LangKey,\n  variables?: Record<string, LangVariable | RegularLangFnParameters>,\n  options?: LangFnOptions | LangFnOptionsWithPlural,\n): string {\n  const cacheKey = `${langKey}-${JSON.stringify(variables)}-${JSON.stringify(options)}`;\n  if (TRANSLATION_CACHE.has(cacheKey)) {\n    return TRANSLATION_CACHE.get(cacheKey)!;\n  }\n\n  const pluralValue = options && 'pluralValue' in options ? Number(options.pluralValue) : 0;\n  const string = getString(langKey, pluralValue);\n\n  if (!string) return langKey;\n\n  const variableEntries = variables ? Object.entries(variables) : [];\n  const finalString = variableEntries.reduce((result, [key, value]) => {\n    if (value === undefined) return result;\n    if (typeof value === 'object') { // Allow recursive variables in basic `lang.with`\n      value = processTranslation(value.key, value.variables, value.options);\n    }\n\n    const valueAsString = Number.isFinite(value) ? formatters!.number.format(value as number) : String(value);\n    return result.replace(`{${key}}`, valueAsString);\n  }, string);\n\n  TRANSLATION_CACHE.set(cacheKey, finalString);\n\n  return finalString;\n}\n\nfunction processTranslationAdvanced(\n  langKey: LangKey,\n  variables?: Record<string, TeactNode | undefined>,\n  options?: AdvancedLangFnOptions | AdvancedLangFnOptionsWithPlural,\n): TeactNode {\n  const pluralValue = options && 'pluralValue' in options ? Number(options.pluralValue) : 0;\n  const string = getString(langKey, pluralValue);\n  if (!string) return langKey;\n\n  const variableEntries = variables ? Object.entries(variables) : [];\n\n  let tempResult: TeactNode = [string];\n  if (options?.specialReplacement) {\n    const specialReplacements = Object.entries(options.specialReplacement);\n    tempResult = specialReplacements.reduce((acc, [key, value]) => {\n      return replaceInStringsWithTeact(acc, key, value);\n    }, tempResult);\n  }\n\n  const withRenderText = options?.withMarkdown || options?.renderTextFilters;\n\n  if (withRenderText) {\n    const filters = options?.withMarkdown\n      ? unique((options.renderTextFilters || []).concat(['simple_markdown', 'emoji']) as TextFilter[])\n      : options.renderTextFilters;\n\n    return tempResult.flatMap((curr: TeactNode) => {\n      if (typeof curr !== 'string') {\n        return curr;\n      }\n\n      return renderText(curr, filters, {\n        markdownPostProcessor: (part: string) => {\n          return variableEntries.reduce((result, [key, value]): TeactNode[] => {\n            if (value === undefined) return result;\n\n            const preparedValue = Number.isFinite(value) ? formatters!.number.format(value as number) : value;\n            return replaceInStringsWithTeact(result, `{${key}}`, renderText(preparedValue));\n          }, [part] as TeactNode[]);\n        },\n      });\n    });\n  }\n\n  return variableEntries.reduce((result, [key, value]): TeactNode[] => {\n    if (value === undefined) return result;\n\n    const preparedValue = Number.isFinite(value) ? formatters!.number.format(value as number) : value;\n    return replaceInStringsWithTeact(result, `{${key}}`, renderText(preparedValue));\n  }, tempResult);\n}\n\nexport const localizationReadyPromise = localizationReady.promise;\n\nexport {\n  addCallback as addLocalizationCallback,\n  removeCallback as removeLocalizationCallback,\n};\n\nexport type {\n  LangFn,\n  LangFnParameters,\n  RegularLangFnParameters,\n  AdvancedLangFnParameters,\n};","type Part = {\n  type: 'literal' | 'element';\n  value: string;\n};\n\nexport function getBasicListFormat() {\n  return {\n    format: (items: string[]) => items.join(', '),\n    formatToParts: (items: string[]): Part[] => {\n      const result: Part[] = [];\n\n      items.forEach((item, i) => {\n        if (i > 0) {\n          result.push({ type: 'literal', value: ', ' });\n        }\n        result.push({ type: 'element', value: item });\n      });\n\n      return result;\n    },\n  };\n}\n","export const clamp = (num: number, min: number, max: number) => (Math.min(max, Math.max(min, num)));\nexport const isBetween = (num: number, min: number, max: number) => (num >= min && num <= max);\nexport const round = (num: number, decimals: number = 0) => Math.round(num * 10 ** decimals) / 10 ** decimals;\nexport const ceil = (num: number, decimals: number = 0) => Math.ceil(num * 10 ** decimals) / 10 ** decimals;\nexport const floor = (num: number, decimals: number = 0) => Math.floor(num * 10 ** decimals) / 10 ** decimals;\nexport const lerp = (start: number, end: number, interpolationRatio: number) => {\n  return (1 - interpolationRatio) * start + interpolationRatio * end;\n};\n\n// Fractional values cause blurry text & canvas. Round to even to keep whole numbers while centering\nexport function roundToNearestEven(value: number) {\n  return Math.round(value / 2) * 2;\n}\n","import type { IDimensions } from '../types';\n\nimport { requestMutation } from '../lib/fasterdom/fasterdom';\nimport { IS_IOS } from './browser/windowEnvironment';\nimport { throttle } from './schedulers';\n\nconst WINDOW_ORIENTATION_CHANGE_THROTTLE_MS = 100;\nconst WINDOW_RESIZE_THROTTLE_MS = 250;\n\nlet initialHeight = window.innerHeight;\nlet currentWindowSize = updateSizes();\n\nconst handleResize = throttle(() => {\n  currentWindowSize = updateSizes();\n}, WINDOW_RESIZE_THROTTLE_MS, true);\n\nconst handleOrientationChange = throttle(() => {\n  initialHeight = window.innerHeight;\n  handleResize();\n}, WINDOW_ORIENTATION_CHANGE_THROTTLE_MS, false);\n\nwindow.addEventListener('orientationchange', handleOrientationChange);\nif (IS_IOS) {\n  window.visualViewport!.addEventListener('resize', handleResize);\n} else {\n  window.addEventListener('resize', handleResize);\n}\n\nexport function updateSizes(): IDimensions {\n  let height: number;\n  if (IS_IOS) {\n    height = window.visualViewport!.height + window.visualViewport!.pageTop;\n  } else {\n    height = window.innerHeight;\n  }\n\n  requestMutation(() => {\n    const vh = height * 0.01;\n    document.documentElement.style.setProperty('--vh', `${vh}px`);\n  });\n\n  return {\n    width: window.innerWidth,\n    height: window.innerHeight,\n  };\n}\n\nconst windowSize = {\n  get: () => currentWindowSize,\n  getIsKeyboardVisible: () => initialHeight > currentWindowSize.height,\n};\n\nexport default windowSize;\n","import { useEffect } from '../lib/teact/teact';\n\nimport {\n  MIN_SCREEN_WIDTH_FOR_STATIC_LEFT_COLUMN,\n  MOBILE_SCREEN_LANDSCAPE_MAX_HEIGHT,\n  MOBILE_SCREEN_LANDSCAPE_MAX_WIDTH,\n  MOBILE_SCREEN_MAX_WIDTH,\n} from '../config';\nimport { IS_IOS } from '../util/browser/windowEnvironment';\nimport { createCallbackManager } from '../util/callbacks';\nimport { updateSizes } from '../util/windowSize';\nimport useForceUpdate from './useForceUpdate';\n\ntype MediaQueryCacheKey = 'mobile' | 'tablet' | 'landscape' | 'touch';\n\nconst mediaQueryCache = new Map<MediaQueryCacheKey, MediaQueryList>();\nconst callbacks = createCallbackManager();\n\nlet isMobile: boolean | undefined;\nlet isTablet: boolean | undefined;\nlet isLandscape: boolean | undefined;\nlet isTouchScreen: boolean | undefined;\n\nexport function getIsMobile() {\n  return isMobile;\n}\n\nexport function getIsTablet() {\n  return isTablet;\n}\n\nexport function getIsWebAppsFullscreenSupported() {\n  return !getIsMobile();\n}\n\nfunction handleMediaQueryChange() {\n  isMobile = mediaQueryCache.get('mobile')?.matches || false;\n  isTablet = !isMobile && (mediaQueryCache.get('tablet')?.matches || false);\n  isLandscape = mediaQueryCache.get('landscape')?.matches || false;\n  isTouchScreen = mediaQueryCache.get('touch')?.matches || false;\n  updateSizes();\n  callbacks.runCallbacks();\n}\n\nfunction initMediaQueryCache() {\n  const mobileQuery = window.matchMedia(`(max-width: ${MOBILE_SCREEN_MAX_WIDTH}px), \\\n  (max-width: ${MOBILE_SCREEN_LANDSCAPE_MAX_WIDTH}px and max-height: ${MOBILE_SCREEN_LANDSCAPE_MAX_HEIGHT}px)`);\n  mediaQueryCache.set('mobile', mobileQuery);\n  mobileQuery.addEventListener('change', handleMediaQueryChange);\n\n  const tabletQuery = window.matchMedia(`(max-width: ${MIN_SCREEN_WIDTH_FOR_STATIC_LEFT_COLUMN}px)`);\n  mediaQueryCache.set('tablet', tabletQuery);\n  tabletQuery.addEventListener('change', handleMediaQueryChange);\n\n  const landscapeQuery = window.matchMedia(\n    IS_IOS\n      ? '(orientation: landscape)'\n      // Source: https://web.archive.org/web/20160509220835/http://blog.abouthalf.com/development/orientation-media-query-challenges-in-android-browsers/\n      // Feature is marked as deprecated now, but it is still supported\n      // https://developer.mozilla.org/en-US/docs/Web/CSS/@media/device-aspect-ratio#browser_compatibility\n      : 'screen and (min-device-aspect-ratio: 1/1) and (orientation: landscape)',\n  );\n  mediaQueryCache.set('landscape', landscapeQuery);\n  landscapeQuery.addEventListener('change', handleMediaQueryChange);\n\n  const isTouchScreenQuery = window.matchMedia('(pointer: coarse)');\n  mediaQueryCache.set('touch', isTouchScreenQuery);\n  isTouchScreenQuery.addEventListener('change', handleMediaQueryChange);\n}\n\ninitMediaQueryCache();\nhandleMediaQueryChange();\n\nexport default function useAppLayout() {\n  const forceUpdate = useForceUpdate();\n\n  useEffect(() => callbacks.addCallback(forceUpdate), [forceUpdate]);\n\n  return {\n    isMobile,\n    isTablet,\n    isLandscape,\n    isDesktop: !isMobile && !isTablet,\n    isTouchScreen,\n  };\n}\n","import type { ApiPeer, ApiSavedGifts } from '../../api/types';\nimport type { GlobalState, TabArgs } from '../types';\n\nimport { SERVICE_NOTIFICATIONS_USER_ID } from '../../config';\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { isChatAdmin, isDeletedUser, isUserId } from '../helpers';\nimport { selectChat, selectChatFullInfo } from './chats';\nimport { selectTabState } from './tabs';\nimport { selectBot, selectUser, selectUserFullInfo } from './users';\n\nexport function selectPeer<T extends GlobalState>(global: T, peerId: string): ApiPeer | undefined {\n  return selectUser(global, peerId) || selectChat(global, peerId);\n}\n\nexport function selectPeerPhotos<T extends GlobalState>(global: T, peerId: string) {\n  return global.peers.profilePhotosById[peerId];\n}\n\nexport function selectCanGift<T extends GlobalState>(global: T, peerId: string) {\n  const bot = selectBot(global, peerId);\n  const user = selectUser(global, peerId);\n\n  if (user) {\n    return !bot && peerId !== SERVICE_NOTIFICATIONS_USER_ID && !isDeletedUser(user);\n  }\n\n  return selectChatFullInfo(global, peerId)?.areStarGiftsAvailable;\n}\n\nexport function selectPeerSavedGifts<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) : ApiSavedGifts {\n  return selectTabState(global, tabId).savedGifts.giftsByPeerId[peerId];\n}\n\nexport function selectPeerPaidMessagesStars<T extends GlobalState>(\n  global: T,\n  peerId: string,\n) {\n  const isChatWithUser = isUserId(peerId);\n  if (isChatWithUser) {\n    const userFullInfo = isChatWithUser ? selectUserFullInfo(global, peerId) : undefined;\n    return userFullInfo?.paidMessagesStars;\n  }\n\n  const chat = selectChat(global, peerId);\n  if (!chat) return undefined;\n  if (isChatAdmin(chat)) return undefined;\n  return chat.paidMessagesStars;\n}\n","import type { ThreadId } from '../types';\n\nimport { RE_TG_LINK, RE_TME_LINK } from '../config';\nimport { toChannelId } from '../global/helpers';\nimport { IS_BAD_URL_PARSER } from './browser/globalEnvironment';\nimport { ensureProtocol } from './browser/url';\nimport { parseTimestampDuration } from './dates/timestamp';\nimport { isUsernameValid } from './username';\n\nexport type DeepLinkMethod = 'resolve' | 'login' | 'passport' | 'settings' | 'join' | 'addstickers' | 'addemoji' |\n'setlanguage' | 'addtheme' | 'confirmphone' | 'socks' | 'proxy' | 'privatepost' | 'bg' | 'share' | 'msg' | 'msg_url' |\n'invoice' | 'addlist' | 'boost' | 'giftcode' | 'message' | 'premium_offer' | 'premium_multigift' | 'stars_topup'\n| 'nft';\n\ninterface PublicMessageLink {\n  type: 'publicMessageLink';\n  username: string;\n  messageId: number;\n  isSingle: boolean;\n  threadId?: ThreadId;\n  commentId?: number;\n  timestamp?: number;\n}\n\nexport interface PrivateMessageLink {\n  type: 'privateMessageLink';\n  channelId: string;\n  messageId: number;\n  isSingle: boolean;\n  threadId?: ThreadId;\n  commentId?: number;\n  timestamp?: number;\n}\n\ninterface ShareLink {\n  type: 'shareLink';\n  url: string;\n  text?: string;\n}\n\ninterface ChatFolderLink {\n  type: 'chatFolderLink';\n  slug: string;\n}\n\ninterface LoginCodeLink {\n  type: 'loginCodeLink';\n  code: string;\n}\n\ninterface TelegramPassportLink {\n  type: 'telegramPassportLink';\n  botId: number;\n  scope: string;\n  publicKey: string;\n  nonce: string;\n  callbackUrl?: string;\n  payload?: string;\n}\n\ninterface PublicUsernameOrBotLink {\n  type: 'publicUsernameOrBotLink';\n  username: string;\n  start?: string;\n  ref?: string;\n  startApp?: string;\n  mode?: string;\n  appName?: string;\n  startAttach?: string;\n  attach?: string;\n  text?: string;\n  choose?: string;\n}\n\ninterface PrivateChannelLink {\n  type: 'privateChannelLink';\n  channelId: string;\n}\n\ninterface ChatBoostLink {\n  type: 'chatBoostLink';\n  username?: string;\n  id?: string;\n}\n\ninterface BusinessChatLink {\n  type: 'businessChatLink';\n  slug: string;\n}\n\ninterface PremiumReferrerLink {\n  type: 'premiumReferrerLink';\n  referrer: string;\n}\n\ninterface PremiumMultigiftLink {\n  type: 'premiumMultigiftLink';\n  referrer: string;\n}\n\ninterface GiftUniqueLink {\n  type: 'giftUniqueLink';\n  slug: string;\n}\n\ntype DeepLink =\n  TelegramPassportLink |\n  LoginCodeLink |\n  PublicMessageLink |\n  PrivateMessageLink |\n  ShareLink |\n  ChatFolderLink |\n  PublicUsernameOrBotLink |\n  PrivateChannelLink |\n  BusinessChatLink |\n  PremiumReferrerLink |\n  PremiumMultigiftLink |\n  ChatBoostLink |\n  GiftUniqueLink;\n\ntype BuilderParams<T extends DeepLink> = Record<keyof Omit<T, 'type'>, string | undefined>;\ntype BuilderReturnType<T extends DeepLink> = T | undefined;\ntype DeepLinkType = DeepLink['type'] | 'unknown';\n\ntype PrivateMessageLinkBuilderParams = Omit<BuilderParams<PrivateMessageLink>, 'isSingle'> & {\n  single?: string;\n};\n\ntype PublicMessageLinkBuilderParams = Omit<BuilderParams<PublicMessageLink>, 'isSingle'> & {\n  single?: string;\n};\n\nconst ELIGIBLE_HOSTNAMES = new Set(['t.me', 'telegram.me', 'telegram.dog']);\n\nexport function isDeepLink(link: string): boolean {\n  return Boolean(link.match(RE_TME_LINK) || link.match(RE_TG_LINK));\n}\n\nexport function tryParseDeepLink(link: string): DeepLink | undefined {\n  if (!isDeepLink(link)) {\n    return undefined;\n  }\n  try {\n    return parseDeepLink(link);\n  } catch (err) {\n    return undefined;\n  }\n}\n\nexport function getUsernameFromDeepLink(url: string) {\n  const deepLink = tryParseDeepLink(url);\n  if (deepLink?.type === 'publicUsernameOrBotLink') {\n    return deepLink.username;\n  }\n  return undefined;\n}\n\nfunction parseDeepLink(url: string) {\n  const correctUrl = ensureProtocol(url);\n  if (!correctUrl) {\n    return undefined;\n  }\n  if (correctUrl.startsWith('https:') || correctUrl.startsWith('http:')) {\n    const urlParsed = new URL(correctUrl);\n    return parseHttpLink(urlParsed);\n  }\n  if (correctUrl.startsWith('tg:')) {\n    const urlToParse = IS_BAD_URL_PARSER ? correctUrl.replace(/^tg:\\/\\//, 'https://') : correctUrl;\n    const urlParsed = new URL(urlToParse);\n    return parseTgLink(urlParsed);\n  }\n  return undefined;\n}\n\nfunction parseTgLink(url: URL) {\n  const { hostname } = url;\n  const queryParams = getQueryParams(url);\n  const pathParams = getPathParams(url);\n  const method = hostname as DeepLinkMethod;\n\n  const deepLinkType = getTgDeepLinkType(queryParams, pathParams, method);\n  switch (deepLinkType) {\n    case 'publicMessageLink': {\n      const {\n        domain, post, single, thread, comment, t,\n      } = queryParams;\n      return buildPublicMessageLink({\n        username: domain,\n        messageId: post,\n        single,\n        threadId: thread,\n        commentId: comment,\n        timestamp: t,\n      });\n    }\n    case 'privateMessageLink': {\n      const {\n        channel, post, single, thread, comment, t,\n      } = queryParams;\n      return buildPrivateMessageLink({\n        channelId: channel,\n        messageId: post,\n        single,\n        threadId: thread,\n        commentId: comment,\n        timestamp: t,\n      });\n    }\n    case 'shareLink':\n      return buildShareLink({ text: queryParams.text, url: queryParams.url });\n    case 'chatFolderLink':\n      return buildChatFolderLink({ slug: queryParams.slug });\n    case 'loginCodeLink':\n      return buildLoginCodeLink({ code: queryParams.code });\n    case 'telegramPassportLink':\n      return buildTelegramPassportLink({\n        botId: queryParams.bot_id,\n        scope: queryParams.scope,\n        publicKey: queryParams.public_key,\n        nonce: queryParams.nonce,\n        callbackUrl: queryParams.callback_url,\n        payload: queryParams.payload,\n      });\n    case 'publicUsernameOrBotLink':\n      return buildPublicUsernameOrBotLink({\n        username: queryParams.domain,\n        start: queryParams.start,\n        text: queryParams.text,\n        appName: queryParams.appname,\n        startApp: queryParams.startapp,\n        mode: queryParams.mode,\n        startAttach: queryParams.startattach,\n        attach: queryParams.attach,\n        choose: queryParams.choose,\n        ref: queryParams.ref,\n      });\n    case 'privateChannelLink': {\n      return buildPrivateChannelLink({ channelId: queryParams.channel });\n    }\n    case 'businessChatLink':\n      return buildBusinessChatLink({ slug: queryParams.slug });\n    case 'premiumReferrerLink':\n      return buildPremiumReferrerLink({ referrer: queryParams.ref });\n    case 'premiumMultigiftLink':\n      return buildPremiumMultigiftLink({ referrer: queryParams.ref });\n    case 'chatBoostLink':\n      return buildChatBoostLink({ username: queryParams.domain, id: queryParams.channel });\n    case 'giftUniqueLink':\n      return buildGiftUniqueLink({ slug: queryParams.slug });\n    default:\n      break;\n  }\n  return undefined;\n}\n\nfunction parseHttpLink(url: URL) {\n  if (!ELIGIBLE_HOSTNAMES.has(url.hostname)) {\n    return undefined;\n  }\n  const queryParams = getQueryParams(url);\n  const pathParams = getPathParams(url);\n\n  const deepLinkType = getHttpDeepLinkType(queryParams, pathParams);\n  switch (deepLinkType) {\n    case 'publicMessageLink': {\n      const {\n        single, comment, t,\n      } = queryParams;\n      const {\n        username,\n        thread,\n        messageId,\n      } = pathParams.length === 2 ? {\n        username: pathParams[0],\n        thread: queryParams.thread,\n        messageId: pathParams[1],\n      } : {\n        username: pathParams[0],\n        thread: pathParams[1],\n        messageId: pathParams[2],\n      };\n      return buildPublicMessageLink({\n        username,\n        messageId,\n        single,\n        threadId: thread,\n        commentId: comment,\n        timestamp: t,\n      });\n    }\n    case 'privateMessageLink': {\n      const {\n        single, comment, t,\n      } = queryParams;\n      const {\n        channelId,\n        thread,\n        messageId,\n      } = pathParams.length === 3 ? {\n        channelId: pathParams[1],\n        thread: queryParams.thread,\n        messageId: pathParams[2],\n      } : {\n        channelId: pathParams[1],\n        thread: pathParams[2],\n        messageId: pathParams[3],\n      };\n      return buildPrivateMessageLink({\n        channelId,\n        messageId,\n        single,\n        threadId: thread,\n        commentId: comment,\n        timestamp: t,\n      });\n    }\n    case 'shareLink': {\n      return buildShareLink({ text: queryParams.text, url: queryParams.url });\n    }\n    case 'chatFolderLink':\n      return buildChatFolderLink({ slug: pathParams[1] });\n    case 'loginCodeLink':\n      return buildLoginCodeLink({ code: pathParams[1] });\n    case 'publicUsernameOrBotLink':\n      return buildPublicUsernameOrBotLink({\n        username: pathParams[0],\n        start: queryParams.start,\n        text: queryParams.text,\n        startApp: queryParams.startapp,\n        mode: queryParams.mode,\n        appName: undefined,\n        startAttach: queryParams.startattach,\n        attach: queryParams.attach,\n        choose: queryParams.choose,\n        ref: queryParams.ref,\n      });\n    case 'privateChannelLink': {\n      return buildPrivateChannelLink({ channelId: pathParams[1] });\n    }\n    case 'businessChatLink':\n      return buildBusinessChatLink({ slug: pathParams[1] });\n    case 'chatBoostLink': {\n      if (pathParams[0] === 'boost') {\n        return buildChatBoostLink({ username: pathParams[1], id: queryParams.c });\n      }\n      const isPrivateChannel = pathParams[0] === 'c';\n      return buildChatBoostLink({\n        username: !isPrivateChannel ? pathParams[0] : undefined,\n        id: isPrivateChannel ? pathParams[1] : undefined,\n      });\n    }\n    case 'giftUniqueLink': {\n      const slug = pathParams.slice(1).join('/');\n      return buildGiftUniqueLink({\n        slug,\n      });\n    }\n    default:\n      break;\n  }\n  return undefined;\n}\n\nfunction getHttpDeepLinkType(\n  queryParams: Record<string, string>,\n  pathParams: string[],\n): DeepLinkType {\n  const len = pathParams.length;\n  const method = pathParams[0];\n  if (len === 1) {\n    if (method === 'share') return 'shareLink';\n    if (method === 'boost' || queryParams.boost !== undefined) return 'chatBoostLink';\n\n    if (isUsernameValid(method)) {\n      return 'publicUsernameOrBotLink';\n    }\n  } else if (len === 2) {\n    if (method === 'addlist') return 'chatFolderLink';\n    if (method === 'login') return 'loginCodeLink';\n    if (method === 'm') return 'businessChatLink';\n    if (method === 'boost') return 'chatBoostLink';\n    if (method === 'nft') return 'giftUniqueLink';\n    if (method === 'c') {\n      if (queryParams.boost !== undefined) return 'chatBoostLink';\n      return 'privateChannelLink';\n    }\n\n    if (isUsernameValid(pathParams[0]) && isNumber(pathParams[1])) {\n      return 'publicMessageLink';\n    }\n  } else if (len === 3) {\n    if (method === 'c' && pathParams.slice(1).every(isNumber)) {\n      return 'privateMessageLink';\n    }\n    if (isUsernameValid(pathParams[0]) && pathParams.slice(1).every(isNumber)) {\n      return 'publicMessageLink';\n    }\n    if (method === 'nft') return 'giftUniqueLink';\n  } else if (len === 4) {\n    if (method === 'c' && pathParams.slice(1).every(isNumber)) {\n      return 'privateMessageLink';\n    }\n  }\n  return 'unknown';\n}\n\nfunction getTgDeepLinkType(\n  queryParams: Record<string, string>,\n  pathParams: string[],\n  method: DeepLinkMethod,\n): DeepLinkType {\n  switch (method) {\n    case 'resolve': {\n      const {\n        // eslint-disable-next-line @typescript-eslint/naming-convention\n        domain, post, bot_id, scope, public_key, nonce,\n      } = queryParams;\n      if (domain === 'telegrampassport' && bot_id && scope && public_key && nonce) {\n        return 'telegramPassportLink';\n      }\n      if (domain && post) {\n        return 'publicMessageLink';\n      }\n      if (isUsernameValid(domain)) {\n        return 'publicUsernameOrBotLink';\n      }\n      break;\n    }\n    case 'privatepost': {\n      const { channel, post } = queryParams;\n      if (channel) {\n        if (post) return 'privateMessageLink';\n        return 'privateChannelLink';\n      }\n      break;\n    }\n    case 'msg_url':\n      return 'shareLink';\n    case 'addlist':\n      return 'chatFolderLink';\n    case 'login':\n      return 'loginCodeLink';\n    case 'passport':\n      return 'telegramPassportLink';\n    case 'message':\n      return 'businessChatLink';\n    case 'premium_offer':\n      return 'premiumReferrerLink';\n    case 'premium_multigift':\n      return 'premiumMultigiftLink';\n    case 'boost':\n      return 'chatBoostLink';\n    case 'nft':\n      return 'giftUniqueLink';\n    default:\n      break;\n  }\n  return 'unknown';\n}\n\nfunction buildShareLink(params: BuilderParams<ShareLink>): BuilderReturnType<ShareLink> {\n  const { url, text } = params;\n  if (!url) {\n    return undefined;\n  }\n  return {\n    type: 'shareLink',\n    url,\n    text,\n  };\n}\n\nfunction buildPublicMessageLink(params: PublicMessageLinkBuilderParams): BuilderReturnType<PublicMessageLink> {\n  const {\n    messageId, threadId, commentId, username, single, timestamp,\n  } = params;\n  if (!username || !isUsernameValid(username)) {\n    return undefined;\n  }\n  if (!messageId || !isNumber(messageId)) {\n    return undefined;\n  }\n  if (threadId && !isNumber(threadId)) {\n    return undefined;\n  }\n  if (commentId && !isNumber(commentId)) {\n    return undefined;\n  }\n  return {\n    type: 'publicMessageLink',\n    username,\n    messageId: Number(messageId),\n    isSingle: single === '',\n    threadId: threadId ? Number(threadId) : undefined,\n    commentId: commentId ? Number(commentId) : undefined,\n    timestamp: timestamp ? parseTimestampDuration(timestamp) : undefined,\n  };\n}\n\nfunction buildPrivateMessageLink(params: PrivateMessageLinkBuilderParams): BuilderReturnType<PrivateMessageLink> {\n  const {\n    messageId, threadId, commentId, channelId, single, timestamp,\n  } = params;\n  if (!channelId || !isNumber(channelId)) {\n    return undefined;\n  }\n  if (!messageId || !isNumber(messageId)) {\n    return undefined;\n  }\n  if (threadId && !isNumber(threadId)) {\n    return undefined;\n  }\n  if (commentId && !isNumber(commentId)) {\n    return undefined;\n  }\n  return {\n    type: 'privateMessageLink',\n    channelId: toChannelId(channelId),\n    messageId: Number(messageId),\n    isSingle: single === '',\n    threadId: threadId ? Number(threadId) : undefined,\n    commentId: commentId ? Number(commentId) : undefined,\n    timestamp: timestamp ? parseTimestampDuration(timestamp) : undefined,\n  };\n}\n\nfunction buildChatFolderLink(params: BuilderParams<ChatFolderLink>): BuilderReturnType<ChatFolderLink> {\n  const {\n    slug,\n  } = params;\n  if (!slug) {\n    return undefined;\n  }\n  return {\n    type: 'chatFolderLink',\n    slug,\n  };\n}\n\nfunction buildLoginCodeLink(params: BuilderParams<LoginCodeLink>): BuilderReturnType<LoginCodeLink> {\n  const {\n    code,\n  } = params;\n  if (!code) {\n    return undefined;\n  }\n  return {\n    type: 'loginCodeLink',\n    code,\n  };\n}\n\nfunction buildTelegramPassportLink(\n  params: BuilderParams<TelegramPassportLink>,\n): BuilderReturnType<TelegramPassportLink> {\n  const {\n    botId,\n    scope,\n    publicKey,\n    nonce,\n    callbackUrl,\n    payload,\n  } = params;\n  if (!botId || !isNumber(botId) || !scope || !publicKey || !nonce) {\n    return undefined;\n  }\n  return {\n    type: 'telegramPassportLink',\n    botId: Number(botId),\n    scope,\n    publicKey,\n    nonce,\n    callbackUrl,\n    payload,\n  };\n}\n\nfunction buildPublicUsernameOrBotLink(\n  params: BuilderParams<PublicUsernameOrBotLink>,\n): BuilderReturnType<PublicUsernameOrBotLink> {\n  const {\n    username,\n    start,\n    text,\n    startApp,\n    mode,\n    startAttach,\n    attach,\n    appName,\n    choose,\n    ref,\n  } = params;\n  if (!username) {\n    return undefined;\n  }\n  if (!isUsernameValid(username)) {\n    return undefined;\n  }\n  return {\n    type: 'publicUsernameOrBotLink',\n    username,\n    start,\n    startApp,\n    mode,\n    appName,\n    startAttach,\n    attach,\n    text,\n    choose,\n    ref,\n  };\n}\n\nfunction buildPrivateChannelLink(params: BuilderParams<PrivateChannelLink>): BuilderReturnType<PrivateChannelLink> {\n  const {\n    channelId,\n  } = params;\n  if (!channelId) {\n    return undefined;\n  }\n\n  return {\n    type: 'privateChannelLink',\n    channelId: toChannelId(channelId),\n  };\n}\n\nexport function buildChatBoostLink(params: BuilderParams<ChatBoostLink>): BuilderReturnType<ChatBoostLink> {\n  const {\n    username,\n    id,\n  } = params;\n\n  if (!username && !id) {\n    return undefined;\n  }\n\n  return {\n    type: 'chatBoostLink',\n    username,\n    id: id ? toChannelId(id) : undefined,\n  };\n}\n\nfunction buildBusinessChatLink(params: BuilderParams<BusinessChatLink>): BuilderReturnType<BusinessChatLink> {\n  const {\n    slug,\n  } = params;\n\n  if (!slug) {\n    return undefined;\n  }\n\n  return {\n    type: 'businessChatLink',\n    slug,\n  };\n}\n\nfunction buildGiftUniqueLink(params: BuilderParams<GiftUniqueLink>): BuilderReturnType<GiftUniqueLink> {\n  const {\n    slug,\n  } = params;\n\n  if (!slug) {\n    return undefined;\n  }\n\n  return {\n    type: 'giftUniqueLink',\n    slug,\n  };\n}\n\nfunction buildPremiumReferrerLink(params: BuilderParams<PremiumReferrerLink>): BuilderReturnType<PremiumReferrerLink> {\n  const {\n    referrer,\n  } = params;\n\n  if (!referrer) {\n    return undefined;\n  }\n\n  return {\n    type: 'premiumReferrerLink',\n    referrer,\n  };\n}\n\nfunction buildPremiumMultigiftLink(\n  params: BuilderParams<PremiumMultigiftLink>,\n): BuilderReturnType<PremiumMultigiftLink> {\n  const {\n    referrer,\n  } = params;\n\n  if (!referrer) {\n    return undefined;\n  }\n\n  return {\n    type: 'premiumMultigiftLink',\n    referrer,\n  };\n}\n\nfunction isNumber(s: string) {\n  return /^-?\\d+$/.test(s);\n}\n\nfunction getPathParams(url: URL) {\n  const parts = url.pathname.split('/').filter(Boolean);\n  if (parts[0] === 's') {\n    parts.shift();\n  }\n  return parts.map(decodeURI);\n}\n\nfunction getQueryParams(url: URL) {\n  return Object.fromEntries(url.searchParams);\n}\n","export function createCallbackManager<T extends AnyToVoidFunction = AnyToVoidFunction>() {\n  const callbacks = new Set<T>();\n\n  function addCallback(cb: T) {\n    callbacks.add(cb);\n\n    return () => {\n      removeCallback(cb);\n    };\n  }\n\n  function removeCallback(cb: T) {\n    callbacks.delete(cb);\n  }\n\n  function runCallbacks(...args: Parameters<T>) {\n    callbacks.forEach((callback) => {\n      callback(...args);\n    });\n  }\n\n  function hasCallbacks() {\n    return Boolean(callbacks.size);\n  }\n\n  return {\n    runCallbacks,\n    addCallback,\n    removeCallback,\n    hasCallbacks,\n  };\n}\n\nexport type CallbackManager<T extends AnyToVoidFunction = AnyToVoidFunction>\n  = ReturnType<typeof createCallbackManager<T>>;\n","import { getIsHeavyAnimating, useEffect } from '../lib/teact/teact';\n\nimport type { CallbackManager } from '../util/callbacks';\n\nimport { requestMeasure } from '../lib/fasterdom/fasterdom';\nimport { createCallbackManager } from '../util/callbacks';\nimport useLastCallback from './useLastCallback';\n\nconst elementObserverMap = new Map<HTMLElement, [IntersectionObserver, CallbackManager]>();\n\nexport default function useSharedIntersectionObserver(\n  refOrElement: React.RefObject<HTMLElement> | HTMLElement | undefined,\n  onIntersectionChange: (entry: IntersectionObserverEntry) => void,\n  isDisabled = false,\n) {\n  const onIntersectionChangeLast = useLastCallback(onIntersectionChange);\n\n  useEffect(() => {\n    const el = refOrElement && 'current' in refOrElement ? refOrElement.current : refOrElement;\n    if (!el || isDisabled) {\n      return undefined;\n    }\n\n    const entriesAccumulator = new Map<Element, IntersectionObserverEntry>();\n\n    function flush() {\n      for (const entry of entriesAccumulator.values()) {\n        // Ignore updates when element is not properly mounted (`display: none`)\n        if (!(entry.target as HTMLElement).offsetParent) {\n          continue;\n        }\n\n        onIntersectionChangeLast(entry);\n      }\n\n      entriesAccumulator.clear();\n    }\n\n    const callback: IntersectionObserverCallback = ([entry]) => {\n      entriesAccumulator.set(entry.target, entry);\n\n      if (!getIsHeavyAnimating()) {\n        flush();\n      } else {\n        getIsHeavyAnimating.once(() => {\n          requestMeasure(flush);\n        });\n      }\n    };\n\n    let [observer, callbackManager] = elementObserverMap.get(el) || [undefined, undefined];\n    if (!observer) {\n      callbackManager = createCallbackManager();\n      observer = new IntersectionObserver(callbackManager.runCallbacks);\n      elementObserverMap.set(el, [observer, callbackManager]);\n      observer.observe(el);\n    }\n    callbackManager!.addCallback(callback);\n\n    return () => {\n      callbackManager!.removeCallback(callback);\n      if (!callbackManager!.hasCallbacks()) {\n        observer!.unobserve(el);\n        observer!.disconnect();\n        elementObserverMap.delete(el);\n      }\n    };\n  }, [isDisabled, refOrElement]);\n}\n","import { getActions, getGlobal } from '../global';\n\nimport { addCustomEmojiInputRenderCallback } from '../util/emoji/customEmojiManager';\nimport { throttle } from '../util/schedulers';\n\nlet LOAD_QUEUE = new Set<string>();\nconst RENDER_HISTORY = new Set<string>();\nconst THROTTLE = 200;\nconst LIMIT_PER_REQUEST = 100;\n\nconst loadFromQueue = throttle(() => {\n  const queue = [...LOAD_QUEUE];\n\n  const queueToLoad = queue.slice(0, LIMIT_PER_REQUEST);\n  const otherQueue = queue.slice(LIMIT_PER_REQUEST + 1);\n\n  getActions().loadCustomEmojis({\n    ids: queueToLoad,\n  });\n\n  LOAD_QUEUE = new Set(otherQueue);\n\n  // Schedule next load\n  if (LOAD_QUEUE.size) {\n    loadFromQueue();\n  }\n}, THROTTLE, false);\n\nconst updateLastRendered = throttle(() => {\n  getActions().updateLastRenderedCustomEmojis({\n    ids: [...RENDER_HISTORY].reverse(),\n  });\n\n  RENDER_HISTORY.clear();\n}, THROTTLE, false);\n\nfunction notifyCustomEmojiRender(emojiId: string) {\n  RENDER_HISTORY.add(emojiId);\n  updateLastRendered();\n}\n\naddCustomEmojiInputRenderCallback(notifyCustomEmojiRender);\n\nexport default function useEnsureCustomEmoji(id?: string) {\n  if (!id) return;\n  notifyCustomEmojiRender(id);\n\n  if (getGlobal().customEmojis.byId[id]) {\n    return;\n  }\n\n  LOAD_QUEUE.add(id);\n  loadFromQueue();\n}\n","import { useEffect, useState } from '../../../lib/teact/teact';\nimport { getGlobal } from '../../../global';\n\nimport type { ApiSticker } from '../../../api/types';\nimport type { GlobalState } from '../../../global/types';\n\nimport { selectCanPlayAnimatedEmojis } from '../../../global/selectors';\nimport { addCustomEmojiCallback, removeCustomEmojiCallback } from '../../../util/emoji/customEmojiManager';\n\nimport useEnsureCustomEmoji from '../../../hooks/useEnsureCustomEmoji';\nimport useLastCallback from '../../../hooks/useLastCallback';\n\nexport default function useCustomEmoji(documentId?: string) {\n  const [customEmoji, setCustomEmoji] = useState<ApiSticker | undefined>(\n    documentId ? getGlobal().customEmojis.byId[documentId] : undefined,\n  );\n  const [canPlay, setCanPlay] = useState(selectCanPlayAnimatedEmojis(getGlobal()));\n\n  useEnsureCustomEmoji(documentId);\n\n  const handleGlobalChange = useLastCallback((customEmojis?: GlobalState['customEmojis']) => {\n    if (!documentId) return;\n\n    const newGlobal = getGlobal();\n    setCustomEmoji((customEmojis ?? newGlobal.customEmojis).byId[documentId]);\n    setCanPlay(selectCanPlayAnimatedEmojis(newGlobal));\n  });\n\n  useEffect(handleGlobalChange, [documentId, handleGlobalChange]);\n\n  useEffect(() => {\n    if (!documentId) return undefined;\n\n    addCustomEmojiCallback(handleGlobalChange, documentId);\n\n    return () => {\n      removeCustomEmojiCallback(handleGlobalChange);\n    };\n  }, [customEmoji, documentId, handleGlobalChange]);\n\n  return { customEmoji, canPlay };\n}\n","import type { ActionReturnType } from '../../types';\nimport { ManagementProgress } from '../../../types';\n\nimport {\n  CUSTOM_BG_CACHE_NAME,\n  LANG_CACHE_NAME,\n  LOCK_SCREEN_ANIMATION_DURATION_MS,\n  MEDIA_CACHE_NAME,\n  MEDIA_CACHE_NAME_AVATARS,\n  MEDIA_PROGRESSIVE_CACHE_NAME,\n} from '../../../config';\nimport { updateAppBadge } from '../../../util/appBadge';\nimport { PASSCODE_IDB_STORE } from '../../../util/browser/idb';\nimport {\n  IS_WEBM_SUPPORTED, MAX_BUFFER_SIZE, PLATFORM_ENV,\n} from '../../../util/browser/windowEnvironment';\nimport * as cacheApi from '../../../util/cacheApi';\nimport { getCurrentTabId } from '../../../util/establishMultitabRole';\nimport { ACCOUNT_SLOT, getAccountsInfo } from '../../../util/multiaccount';\nimport { unsubscribe } from '../../../util/notifications';\nimport { clearEncryptedSession, encryptSession, forgetPasscode } from '../../../util/passcode';\nimport { parseInitialLocationHash, resetInitialLocationHash, resetLocationHash } from '../../../util/routing';\nimport { pause } from '../../../util/schedulers';\nimport {\n  clearStoredSession,\n  loadStoredSession,\n  storeSession,\n} from '../../../util/sessions';\nimport { forceWebsync } from '../../../util/websync';\nimport {\n  callApi, callApiLocal, initApi, setShouldEnableDebugLog,\n} from '../../../api/gramjs';\nimport { removeGlobalFromCache, removeSharedStateFromCache, serializeGlobal } from '../../cache';\nimport {\n  addActionHandler, getGlobal, setGlobal,\n} from '../../index';\nimport {\n  clearGlobalForLockScreen, updateManagementProgress, updatePasscodeSettings,\n} from '../../reducers';\nimport { selectSharedSettings } from '../../selectors/sharedState';\nimport { destroySharedStatePort } from '../../shared/sharedStateConnector';\n\naddActionHandler('initApi', (global, actions): ActionReturnType => {\n  const initialLocationHash = parseInitialLocationHash();\n  const {\n    shouldAllowHttpTransport,\n    shouldForceHttpTransport,\n    shouldDebugExportedSenders,\n    shouldCollectDebugLogs,\n    language,\n  } = selectSharedSettings(global);\n\n  const hasTestParam = window.location.search.includes('test') || initialLocationHash?.tgWebAuthTest === '1';\n\n  const accountsInfo = getAccountsInfo();\n  const accountIds = Object.values(accountsInfo).map(({ userId }) => userId)?.filter(Boolean);\n\n  void initApi(actions.apiUpdate, {\n    userAgent: navigator.userAgent,\n    platform: PLATFORM_ENV,\n    sessionData: loadStoredSession(),\n    isWebmSupported: IS_WEBM_SUPPORTED,\n    maxBufferSize: MAX_BUFFER_SIZE,\n    webAuthToken: initialLocationHash?.tgWebAuthToken,\n    dcId: initialLocationHash?.tgWebAuthDcId ? Number(initialLocationHash?.tgWebAuthDcId) : undefined,\n    mockScenario: initialLocationHash?.mockScenario,\n    shouldAllowHttpTransport,\n    shouldForceHttpTransport,\n    shouldDebugExportedSenders,\n    langCode: language,\n    isTestServerRequested: hasTestParam,\n    accountIds,\n  });\n\n  void setShouldEnableDebugLog(Boolean(shouldCollectDebugLogs));\n});\n\naddActionHandler('setAuthPhoneNumber', (global, actions, payload): ActionReturnType => {\n  const { phoneNumber } = payload!;\n\n  void callApi('provideAuthPhoneNumber', phoneNumber.replace(/[^\\d]/g, ''));\n\n  return {\n    ...global,\n    authIsLoading: true,\n    authErrorKey: undefined,\n  };\n});\n\naddActionHandler('setAuthCode', (global, actions, payload): ActionReturnType => {\n  const { code } = payload!;\n\n  void callApi('provideAuthCode', code);\n\n  return {\n    ...global,\n    authIsLoading: true,\n    authErrorKey: undefined,\n  };\n});\n\naddActionHandler('setAuthPassword', (global, actions, payload): ActionReturnType => {\n  const { password } = payload!;\n\n  void callApi('provideAuthPassword', password);\n\n  return {\n    ...global,\n    authIsLoading: true,\n    authErrorKey: undefined,\n  };\n});\n\naddActionHandler('uploadProfilePhoto', async (global, actions, payload): Promise<void> => {\n  const {\n    file, isFallback, isVideo, videoTs, bot,\n    tabId = getCurrentTabId(),\n  } = payload!;\n\n  global = updateManagementProgress(global, ManagementProgress.InProgress, tabId);\n  setGlobal(global);\n\n  const result = await callApi('uploadProfilePhoto', file, isFallback, isVideo, videoTs, bot);\n  if (!result) return;\n\n  global = getGlobal();\n  global = updateManagementProgress(global, ManagementProgress.Complete, tabId);\n  setGlobal(global);\n\n  actions.loadFullUser({ userId: global.currentUserId! });\n});\n\naddActionHandler('signUp', (global, actions, payload): ActionReturnType => {\n  const { firstName, lastName } = payload!;\n\n  void callApi('provideAuthRegistration', { firstName, lastName });\n\n  return {\n    ...global,\n    authIsLoading: true,\n    authErrorKey: undefined,\n  };\n});\n\naddActionHandler('returnToAuthPhoneNumber', (global): ActionReturnType => {\n  void callApi('restartAuth');\n\n  return {\n    ...global,\n    authErrorKey: undefined,\n  };\n});\n\naddActionHandler('goToAuthQrCode', (global): ActionReturnType => {\n  void callApi('restartAuthWithQr');\n\n  return {\n    ...global,\n    authIsLoadingQrCode: true,\n    authErrorKey: undefined,\n  };\n});\n\naddActionHandler('saveSession', (global, actions, payload): ActionReturnType => {\n  if (global.passcode.isScreenLocked) {\n    return;\n  }\n\n  const { sessionData } = payload;\n  if (sessionData) {\n    storeSession(sessionData);\n  } else {\n    clearStoredSession();\n  }\n});\n\naddActionHandler('signOut', async (global, actions, payload): Promise<void> => {\n  if ('hangUp' in actions) actions.hangUp({ tabId: getCurrentTabId() });\n  if ('leaveGroupCall' in actions) actions.leaveGroupCall({ tabId: getCurrentTabId() });\n\n  try {\n    resetInitialLocationHash();\n    resetLocationHash();\n    await unsubscribe();\n    await Promise.race([callApi('destroy'), pause(3000)]);\n    await forceWebsync(false);\n  } catch (err) {\n    // Do nothing\n  }\n\n  actions.reset();\n\n  if (payload?.forceInitApi) {\n    actions.initApi();\n  }\n});\n\naddActionHandler('requestChannelDifference', (global, actions, payload): ActionReturnType => {\n  const { chatId } = payload;\n\n  void callApi('requestChannelDifference', chatId);\n});\n\naddActionHandler('reset', (global, actions): ActionReturnType => {\n  clearStoredSession(ACCOUNT_SLOT);\n  clearEncryptedSession();\n\n  void cacheApi.clear(MEDIA_CACHE_NAME);\n  void cacheApi.clear(MEDIA_CACHE_NAME_AVATARS);\n  void cacheApi.clear(MEDIA_PROGRESSIVE_CACHE_NAME);\n  void cacheApi.clear(CUSTOM_BG_CACHE_NAME);\n\n  removeGlobalFromCache();\n  destroySharedStatePort();\n\n  // Check if there are any accounts left\n  const accounts = getAccountsInfo();\n  if (!Object.values(accounts).length) {\n    PASSCODE_IDB_STORE.clear();\n    removeSharedStateFromCache();\n  }\n\n  const langCachePrefix = LANG_CACHE_NAME.replace(/\\d+$/, '');\n  const langCacheVersion = Number((LANG_CACHE_NAME.match(/\\d+$/) || ['0'])[0]);\n  for (let i = 0; i < langCacheVersion; i++) {\n    void cacheApi.clear(`${langCachePrefix}${i === 0 ? '' : i}`);\n  }\n\n  updateAppBadge(0);\n\n  actions.initShared({ force: true });\n  Object.values(global.byTabId).forEach(({ id: otherTabId, isMasterTab }) => {\n    actions.init({ tabId: otherTabId, isMasterTab });\n  });\n});\n\naddActionHandler('disconnect', (): ActionReturnType => {\n  void callApiLocal('disconnect');\n});\n\naddActionHandler('destroyConnection', (): ActionReturnType => {\n  void callApiLocal('destroy', true, true);\n});\n\naddActionHandler('loadNearestCountry', async (global): Promise<void> => {\n  if (global.connectionState !== 'connectionStateReady') {\n    return;\n  }\n\n  const authNearestCountry = await callApi('fetchNearestCountry');\n\n  global = getGlobal();\n  global = {\n    ...global,\n    authNearestCountry,\n  };\n  setGlobal(global);\n});\n\naddActionHandler('setDeviceToken', (global, actions, deviceToken): ActionReturnType => {\n  return {\n    ...global,\n    push: {\n      deviceToken,\n      subscribedAt: Date.now(),\n    },\n  };\n});\n\naddActionHandler('deleteDeviceToken', (global): ActionReturnType => {\n  return {\n    ...global,\n    push: undefined,\n  };\n});\n\naddActionHandler('lockScreen', async (global): Promise<void> => {\n  const sessionJson = JSON.stringify({ ...loadStoredSession(), userId: global.currentUserId });\n  const globalJson = await serializeGlobal(global);\n\n  await encryptSession(sessionJson, globalJson);\n  forgetPasscode();\n  clearStoredSession();\n  updateAppBadge(0);\n\n  global = getGlobal();\n  global = updatePasscodeSettings(\n    global,\n    {\n      isScreenLocked: true,\n      invalidAttemptsCount: 0,\n      timeoutUntil: undefined,\n    },\n  );\n  setGlobal(global);\n\n  setTimeout(() => {\n    global = getGlobal();\n    global = clearGlobalForLockScreen(global);\n    setGlobal(global);\n  }, LOCK_SCREEN_ANIMATION_DURATION_MS);\n\n  try {\n    await unsubscribe();\n    await callApi('destroy', true);\n  } catch (err) {\n    // Do nothing\n  }\n});","import React from '../../lib/teact/teact';\n\nimport type { LangFn } from './types';\n\nimport { STARS_ICON_PLACEHOLDER } from '../../config';\nimport buildClassName from '../buildClassName';\n\nimport Icon from '../../components/common/icons/Icon';\nimport StarIcon from '../../components/common/icons/StarIcon';\n\nexport function formatStarsAsText(lang: LangFn, amount: number) {\n  return lang('StarsAmountText', { amount }, { pluralValue: amount });\n}\n\nexport function formatStarsAsIcon(lang: LangFn, amount: number, options?: {\n  asFont?: boolean; className?: string; containerClassName?: string; }) {\n  const { asFont, className, containerClassName } = options || {};\n  const icon = asFont\n    ? <Icon name=\"star\" className={buildClassName('star-amount-icon', className)} />\n    : <StarIcon type=\"gold\" className={buildClassName('star-amount-icon', className)} size=\"adaptive\" />;\n\n  if (containerClassName) {\n    return (\n      <span className={containerClassName}>\n        {lang('StarsAmount', { amount }, {\n          withNodes: true,\n          specialReplacement: {\n            [STARS_ICON_PLACEHOLDER]: icon,\n          },\n        })}\n      </span>\n    );\n  }\n\n  return lang('StarsAmount', { amount }, {\n    withNodes: true,\n    specialReplacement: {\n      [STARS_ICON_PLACEHOLDER]: icon,\n    },\n  });\n}\n","/* eslint-disable eqeqeq */\n/* eslint-disable prefer-template */\n/* eslint-disable prefer-const */\n/* eslint-disable prefer-destructuring */\n/* eslint-disable one-var */\n/* eslint-disable one-var-declaration-per-line */\n\nimport { preloadImage } from './files';\n\nconst LUMA_THRESHOLD = 128;\n\n/**\n * HEX > RGB\n * input: 'xxxxxx' (ex. 'ed15fa') case-insensitive\n * output: [r, g, b] ([0-255, 0-255, 0-255])\n */\nexport function hex2rgb(param: string): [number, number, number] {\n  return [\n    parseInt(param.substring(0, 2), 16),\n    parseInt(param.substring(2, 4), 16),\n    parseInt(param.substring(4, 6), 16),\n  ];\n}\n\n/**\n * RGB > HEX\n * input: [r, g, b] ([0-255, 0-255, 0-255])\n * output: 'xxxxxx' (ex. 'ff0000')\n */\nexport function rgb2hex(param: [number, number, number]) {\n  const p0 = param[0].toString(16);\n  const p1 = param[1].toString(16);\n  const p2 = param[2].toString(16);\n  return (p0.length == 1 ? '0' + p0 : p0) + (p1.length == 1 ? '0' + p1 : p1) + (p2.length == 1 ? '0' + p2 : p2);\n}\n\n/**\n * Converts an RGB color value to HSV. Conversion formula\n * adapted from http://en.wikipedia.org/wiki/HSV_color_space.\n * Assumes r, g, and b are contained in the set [0, 255] and\n * returns h, s, and v in the set [0, 1].\n *\n * @param   Number  r       The red color value\n * @param   Number  g       The green color value\n * @param   Number  b       The blue color value\n * @return  Array           The HSV representation\n */\nexport function rgb2hsb([r, g, b]: [number, number, number]): [number, number, number] {\n  r /= 255;\n  g /= 255;\n  b /= 255;\n\n  let max = Math.max(r, g, b), min = Math.min(r, g, b);\n  let h!: number, s: number, v: number = max;\n\n  let d = max - min;\n  s = max == 0 ? 0 : d / max;\n\n  if (max == min) {\n    h = 0; // achromatic\n  } else {\n    switch (max) {\n      case r:\n        h = (g - b) / d + (g < b ? 6 : 0);\n        break;\n      case g:\n        h = (b - r) / d + 2;\n        break;\n      case b:\n        h = (r - g) / d + 4;\n        break;\n    }\n\n    h /= 6;\n  }\n\n  return [h, s, v];\n}\n\n/**\n * Converts an HSV color value to RGB. Conversion formula\n * adapted from http://en.wikipedia.org/wiki/HSV_color_space.\n * Assumes h, s, and v are contained in the set [0, 1] and\n * returns r, g, and b in the set [0, 255].\n *\n * @param   Number  h       The hue\n * @param   Number  s       The saturation\n * @param   Number  v       The value\n * @return  Array           The RGB representation\n */\nexport function hsb2rgb([h, s, v]: [number, number, number]): [number, number, number] {\n  let r!: number, g!: number, b!: number;\n\n  let i = Math.floor(h * 6);\n  let f = h * 6 - i;\n  let p = v * (1 - s);\n  let q = v * (1 - f * s);\n  let t = v * (1 - (1 - f) * s);\n\n  switch (i % 6) {\n    case 0:\n      r = v;\n      g = t;\n      b = p;\n      break;\n    case 1:\n      r = q;\n      g = v;\n      b = p;\n      break;\n    case 2:\n      r = p;\n      g = v;\n      b = t;\n      break;\n    case 3:\n      r = p;\n      g = q;\n      b = v;\n      break;\n    case 4:\n      r = t;\n      g = p;\n      b = v;\n      break;\n    case 5:\n      r = v;\n      g = p;\n      b = q;\n      break;\n  }\n\n  return [\n    Math.round(r * 255),\n    Math.round(g * 255),\n    Math.round(b * 255),\n  ];\n}\n\nexport async function getAverageColor(url: string): Promise<[number, number, number]> {\n  // Only visit every 5 pixels\n  const blockSize = 5;\n  const defaultRGB: [number, number, number] = [0, 0, 0];\n  let data;\n  let width;\n  let height;\n  let i = -4;\n  let length;\n  let rgb: [number, number, number] = [0, 0, 0];\n  let count = 0;\n\n  const canvas = document.createElement('canvas');\n  const context = canvas.getContext && canvas.getContext('2d');\n  if (!context) {\n    return defaultRGB;\n  }\n\n  const image = await preloadImage(url);\n  height = image.naturalHeight || image.offsetHeight || image.height;\n  width = image.naturalWidth || image.offsetWidth || image.width;\n  canvas.height = height;\n  canvas.width = width;\n\n  context.drawImage(image, 0, 0);\n\n  try {\n    data = context.getImageData(0, 0, width, height);\n  } catch (e) {\n    return defaultRGB;\n  }\n\n  length = data.data.length;\n\n  // eslint-disable-next-line no-cond-assign\n  while ((i += blockSize * 4) < length) {\n    if (data.data[i + 3] === 0) continue; // Ignore fully transparent pixels\n    ++count;\n    rgb[0] += data.data[i];\n    rgb[1] += data.data[i + 1];\n    rgb[2] += data.data[i + 2];\n  }\n\n  rgb[0] = Math.floor(rgb[0] / count);\n  rgb[1] = Math.floor(rgb[1] / count);\n  rgb[2] = Math.floor(rgb[2] / count);\n\n  return rgb;\n}\n\nexport function getColorLuma(rgbColor: [number, number, number]) {\n  const [r, g, b] = rgbColor;\n  const luma = 0.2126 * r + 0.7152 * g + 0.0722 * b;\n  return luma;\n}\n// https://stackoverflow.com/a/64090995\nexport function hsl2rgb([h, s, l]: [number, number, number]): [number, number, number] {\n  let a = s * Math.min(l, 1 - l);\n  let f = (n: number, k = (n + h / 30) % 12) => l - a * Math.max(Math.min(k - 3, 9 - k, 1), -1);\n  return [f(0), f(8), f(4)];\n}\n\n// Function was adapted from https://github.com/telegramdesktop/tdesktop/blob/35ff621b5b52f7e3553fb0f990ea13ade7101b8e/Telegram/SourceFiles/data/data_wall_paper.cpp#L518\nexport function getPatternColor(rgbColor: [number, number, number]) {\n  let [hue, saturation, value] = rgb2hsb(rgbColor);\n\n  saturation = Math.min(1, saturation + 0.05 + 0.1 * (1 - saturation));\n  value = value > 0.5\n    ? Math.max(0, value * 0.65)\n    : Math.max(0, Math.min(1, 1 - value * 0.65));\n\n  const rgb = hsl2rgb([hue * 360, saturation, value]);\n  const hex = rgb2hex(rgb.map((c) => Math.floor(c * 255)) as [number, number, number]);\n  return `#${hex}66`;\n}\n\n/* eslint-disable no-bitwise */\nexport const convertToRGBA = (color: number): string => {\n  const alpha = (color >> 24) & 0xff;\n  const red = (color >> 16) & 0xff;\n  const green = (color >> 8) & 0xff;\n  const blue = color & 0xff;\n\n  const alphaFloat = alpha / 255;\n  return `rgba(${red}, ${green}, ${blue}, ${alphaFloat})`;\n};\n\nexport const numberToHexColor = (color: number): string => {\n  return `#${color.toString(16).padStart(6, '0')}`;\n};\n\nexport const getTextColor = (color: number): string => {\n  const r = (color >> 16) & 0xff;\n  const g = (color >> 8) & 0xff;\n  const b = color & 0xff;\n  const luma = getColorLuma([r, g, b]);\n  return luma > LUMA_THRESHOLD ? 'black' : 'white';\n};\n","import { onFullyIdle } from '../lib/teact/teact';\nimport { addCallback } from '../lib/teact/teactn';\nimport { addActionHandler, getGlobal } from '../global';\n\nimport type {\n  ApiChat, ApiChatFolder, ApiNotifyPeerType, ApiPeerNotifySettings, ApiUser,\n} from '../api/types';\nimport type { GlobalState } from '../global/types';\nimport type { CallbackManager } from './callbacks';\n\nimport {\n  AI_FOLDER_ID,\n  ALL_FOLDER_ID, ARCHIVED_FOLDER_ID, DEBUG, PRESET_FOLDER_ID, SAVED_FOLDER_ID, SERVICE_NOTIFICATIONS_USER_ID,\n  UNREAD_FOLDER_ID\n} from '../config';\nimport { getIsChatMuted } from '../global/helpers/notifications';\nimport {\n  selectChatLastMessage,\n  selectNotifyDefaults,\n  selectTabState,\n  selectTopics,\n} from '../global/selectors';\nimport arePropsShallowEqual from './arePropsShallowEqual';\nimport { createCallbackManager } from './callbacks';\nimport { areSortedArraysEqual, unique } from './iteratees';\nimport { throttle } from './schedulers';\n\ninterface FolderSummary {\n  id: number;\n  listIds?: Set<string>;\n  orderedPinnedIds?: string[];\n  contacts?: true;\n  nonContacts?: true;\n  groups?: true;\n  channels?: true;\n  bots?: true;\n  excludeMuted?: true;\n  excludeRead?: true;\n  excludeArchived?: true;\n  excludedChatIds?: Set<string>;\n  includedChatIds?: Set<string>;\n  pinnedChatIds?: Set<string>;\n}\n\ninterface ChatSummary {\n  id: string;\n  type: ApiChat['type'];\n  isListedInAll: boolean;\n  isListedInSaved: boolean;\n  isArchived: boolean;\n  isMuted: boolean;\n  isUnread: boolean;\n  unreadCount?: number;\n  unreadMentionsCount?: number;\n  orderInAll: number;\n  orderInSaved: number;\n  isUserBot?: boolean;\n  isUserContact?: boolean;\n}\n\nconst UPDATE_THROTTLE = 500;\nconst DEBUG_DURATION_LIMIT = 6;\n\nconst initials = buildInitials();\n\nlet prevGlobal: {\n  allFolderListIds?: GlobalState['chats']['listIds']['active'];\n  allFolderPinnedIds?: GlobalState['chats']['orderedPinnedIds']['active'];\n  archivedFolderListIds?: GlobalState['chats']['listIds']['archived'];\n  archivedFolderPinnedIds?: GlobalState['chats']['orderedPinnedIds']['archived'];\n  savedFolderListIds?: GlobalState['chats']['listIds']['saved'];\n  savedFolderPinnedIds?: GlobalState['chats']['orderedPinnedIds']['saved'];\n  isAllFolderFullyLoaded?: boolean;\n  isArchivedFolderFullyLoaded?: boolean;\n  isSavedFolderFullyLoaded?: boolean;\n  lastAllMessageIds?: GlobalState['chats']['lastMessageIds']['all'];\n  lastSavedMessageIds?: GlobalState['chats']['lastMessageIds']['saved'];\n  topicsInfoById: GlobalState['chats']['topicsInfoById'];\n  chatsById: Record<string, ApiChat>;\n  foldersById: Record<string, ApiChatFolder>;\n  usersById: Record<string, ApiUser>;\n  notifyDefaults?: Record<ApiNotifyPeerType, ApiPeerNotifySettings>;\n  notifyExceptions?: Record<number, ApiPeerNotifySettings>;\n} = initials.prevGlobal;\n\nlet prepared: {\n  folderSummariesById: Record<string, FolderSummary>;\n  chatSummariesById: Map<string, ChatSummary>;\n  folderIdsByChatId: Record<string, number[]>;\n  chatIdsByFolderId: Record<number, Set<string> | undefined>;\n  isOrderedListJustPatched: Record<number, boolean | undefined>;\n} = initials.prepared;\n\nlet results: {\n  orderedIdsByFolderId: Record<string, string[] | undefined>;\n  pinnedCountByFolderId: Record<string, number | undefined>; // Also watched by `callbacks.orderedIdsByFolderId`\n  chatsCountByFolderId: Record<string, number | undefined>;\n  unreadCountersByFolderId: Record<string, {\n    chatsCount: number;\n    notificationsCount: number;\n  } | undefined>;\n  unreadChatIdsByFolderId: Record<string, string[] | undefined>;\n} = initials.results;\n\nlet callbacks: {\n  orderedIdsByFolderId: Record<number, CallbackManager>;\n  chatsCountByFolderId: CallbackManager;\n  unreadCountersByFolderId: CallbackManager;\n  unreadChatIdsByFolderId: CallbackManager;\n} = initials.callbacks;\n\nif (DEBUG) {\n  (window as any).DEBUG_getFolderManager = () => ({\n    prepared,\n    results,\n  });\n}\n\nconst updateFolderManagerThrottled = throttle(() => {\n  onFullyIdle(() => {\n    updateFolderManager(getGlobal());\n  });\n}, UPDATE_THROTTLE);\n\nlet inited = false;\n\n/* Getters */\n\nexport function init() {\n  inited = true;\n\n  addCallback(updateFolderManagerThrottled);\n  addActionHandler('reset', reset);\n\n  const global = getGlobal();\n  if (!selectTabState(global).isMasterTab) {\n    updateFolders(global, true, true, true, true);\n  }\n  updateFolderManager(global);\n}\n\nexport function getOrderedIds(folderId: number) {\n  if (!inited) init();\n\n  return results.orderedIdsByFolderId[folderId];\n}\n\nexport function getPinnedChatsCount(folderId: number) {\n  if (!inited) init();\n\n  return results.pinnedCountByFolderId[folderId] || 0;\n}\n\nexport function getChatsCount() {\n  if (!inited) init();\n\n  return results.chatsCountByFolderId;\n}\n\nexport function getUnreadCounters() {\n  if (!inited) init();\n\n  return results.unreadCountersByFolderId;\n}\n\nexport function getUnreadChatsByFolderId() {\n  if (!inited) init();\n\n  return results.unreadChatIdsByFolderId;\n}\n\nexport function getAllNotificationsCount() {\n  return getUnreadCounters()[ALL_FOLDER_ID]?.notificationsCount || 0;\n}\n\nexport function getOrderKey(chatId: string, isForSaved?: boolean) {\n  const summary = prepared.chatSummariesById.get(chatId)!;\n  return isForSaved ? summary.orderInSaved : summary.orderInAll;\n}\n\n/* Callback managers */\n\nexport function addOrderedIdsCallback(folderId: number, callback: (orderedIds: string[]) => void) {\n  if (!callbacks.orderedIdsByFolderId[folderId]) {\n    callbacks.orderedIdsByFolderId[folderId] = createCallbackManager();\n  }\n\n  return callbacks.orderedIdsByFolderId[folderId].addCallback(callback);\n}\n\nexport function addChatsCountCallback(callback: (chatsCount: typeof results.chatsCountByFolderId) => void) {\n  return callbacks.chatsCountByFolderId.addCallback(callback);\n}\n\nexport function addUnreadChatsByFolderIdCallback(\n  callback: (unreadChats: typeof results.unreadChatIdsByFolderId) => void,\n) {\n  return callbacks.unreadChatIdsByFolderId.addCallback(callback);\n}\n\nexport function addUnreadCountersCallback(callback: (unreadCounters: typeof results.unreadCountersByFolderId) => void) {\n  return callbacks.unreadCountersByFolderId.addCallback(callback);\n}\n\n/* Global update handlers */\n\nfunction updateFolderManager(global: GlobalState) {\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  let DEBUG_startedAt: number;\n  if (DEBUG) {\n    DEBUG_startedAt = performance.now();\n  }\n\n  const isAllFolderChanged = Boolean(\n    global.chats.listIds.active\n    && isMainFolderChanged(ALL_FOLDER_ID, global.chats.listIds.active, global.chats.orderedPinnedIds.active),\n  );\n  const isArchivedFolderChanged = Boolean(\n    global.chats.listIds.archived\n    && isMainFolderChanged(ARCHIVED_FOLDER_ID, global.chats.listIds.archived, global.chats.orderedPinnedIds.archived),\n  );\n  const isSavedFolderChanged = Boolean(\n    global.chats.listIds.saved\n    && isMainFolderChanged(SAVED_FOLDER_ID, global.chats.listIds.saved, global.chats.orderedPinnedIds.saved),\n  );\n  const isAllFullyLoadedChanged = global.chats.isFullyLoaded.active !== prevGlobal.isAllFolderFullyLoaded;\n  const isArchivedFullyLoadedChanged = global.chats.isFullyLoaded.archived !== prevGlobal.isArchivedFolderFullyLoaded;\n  const isSavedFolderFullyLoadedChanged = global.chats.isFullyLoaded.saved !== prevGlobal.isSavedFolderFullyLoaded;\n\n  const areFoldersChanged = global.chatFolders.byId !== prevGlobal.foldersById;\n  const areChatsChanged = global.chats.byId !== prevGlobal.chatsById;\n  const areSavedLastMessageIdsChanged = global.chats.lastMessageIds.saved !== prevGlobal.lastSavedMessageIds;\n  const areAllLastMessageIdsChanged = global.chats.lastMessageIds.all !== prevGlobal.lastAllMessageIds;\n  const areTopicsChanged = global.chats.topicsInfoById !== prevGlobal.topicsInfoById;\n  const areUsersChanged = global.users.byId !== prevGlobal.usersById;\n  const areNotifyDefaultsChanged = selectNotifyDefaults(global) !== prevGlobal.notifyDefaults;\n  const areNotifyExceptionsChanged = global.chats.notifyExceptionById !== prevGlobal.notifyExceptions;\n\n  let affectedFolderIds: number[] = [];\n\n  if (isAllFullyLoadedChanged || isArchivedFullyLoadedChanged || isSavedFolderFullyLoadedChanged) {\n    affectedFolderIds = affectedFolderIds.concat(\n      updateFullyLoaded(global, isArchivedFullyLoadedChanged, isSavedFolderFullyLoadedChanged),\n    );\n  }\n\n  if (!(\n    isAllFolderChanged || isArchivedFolderChanged || isSavedFolderChanged || areFoldersChanged\n    || areChatsChanged || areUsersChanged || areTopicsChanged || areNotifyDefaultsChanged || areNotifyExceptionsChanged\n    || areSavedLastMessageIdsChanged || areAllLastMessageIdsChanged\n  )\n  ) {\n    if (affectedFolderIds.length) {\n      updateResults(affectedFolderIds);\n    }\n\n    return;\n  }\n\n  const prevAllFolderListIds = prevGlobal.allFolderListIds;\n  const prevArchivedFolderListIds = prevGlobal.archivedFolderListIds;\n  const prevSavedFolderListIds = prevGlobal.savedFolderListIds;\n\n  updateFolders(global, isAllFolderChanged, isArchivedFolderChanged, isSavedFolderChanged, areFoldersChanged);\n\n  affectedFolderIds = affectedFolderIds.concat(updateChats(\n    global,\n    areFoldersChanged || isAllFolderChanged || isArchivedFolderChanged || isSavedFolderChanged,\n    areNotifyDefaultsChanged,\n    areNotifyExceptionsChanged,\n    prevAllFolderListIds,\n    prevArchivedFolderListIds,\n    prevSavedFolderListIds,\n  ));\n\n  updateResults(unique(affectedFolderIds));\n\n  if (DEBUG) {\n    const duration = performance.now() - DEBUG_startedAt!;\n    if (duration > DEBUG_DURATION_LIMIT) {\n      // eslint-disable-next-line no-console\n      console.warn(`Slow \\`updateFolderManager\\`: ${Math.round(duration)} ms`);\n    }\n  }\n}\n\nfunction isMainFolderChanged(folderId: number, newListIds?: string[], newPinnedIds?: string[]) {\n  const currentListIds = folderId === ALL_FOLDER_ID\n    ? prevGlobal.allFolderListIds\n    : folderId === SAVED_FOLDER_ID\n      ? prevGlobal.savedFolderListIds : prevGlobal.archivedFolderListIds;\n  const currentPinnedIds = folderId === ALL_FOLDER_ID\n    ? prevGlobal.allFolderPinnedIds\n    : folderId === SAVED_FOLDER_ID\n      ? prevGlobal.savedFolderPinnedIds : prevGlobal.archivedFolderPinnedIds;\n\n  return currentListIds !== newListIds || currentPinnedIds !== newPinnedIds;\n}\n\nfunction updateFullyLoaded(\n  global: GlobalState,\n  isArchivedFullyLoadedChanged = false,\n  isSavedFolderFullyLoadedChanged = false,\n) {\n  let affectedFolderIds = [];\n\n  if (isArchivedFullyLoadedChanged) {\n    affectedFolderIds.push(ARCHIVED_FOLDER_ID);\n  }\n\n  if (isSavedFolderFullyLoadedChanged) {\n    affectedFolderIds.push(SAVED_FOLDER_ID);\n  }\n\n  const isAllFolderFullyLoaded = global.chats.isFullyLoaded.active;\n  const isArchivedFolderFullyLoaded = global.chats.isFullyLoaded.archived;\n  const isSavedFolderFullyLoaded = global.chats.isFullyLoaded.saved;\n\n  if (isAllFolderFullyLoaded && isArchivedFolderFullyLoaded) {\n    const emptyFolderIds = Object.keys(prepared.folderSummariesById)\n      .filter((folderId) => !results.orderedIdsByFolderId[folderId])\n      .map(Number);\n\n    affectedFolderIds = affectedFolderIds.concat(emptyFolderIds);\n  }\n\n  prevGlobal.isAllFolderFullyLoaded = isAllFolderFullyLoaded;\n  prevGlobal.isArchivedFolderFullyLoaded = isArchivedFolderFullyLoaded;\n  prevGlobal.isSavedFolderFullyLoaded = isSavedFolderFullyLoaded;\n\n  return affectedFolderIds;\n}\n\nfunction updateFolders(\n  global: GlobalState,\n  isAllFolderChanged: boolean,\n  isArchivedFolderChanged: boolean,\n  isSavedFolderChanged: boolean,\n  areFoldersChanged: boolean,\n) {\n  const changedFolders = [];\n\n  if (isAllFolderChanged) {\n    const newListIds = global.chats.listIds.active!;\n    const newPinnedIds = global.chats.orderedPinnedIds.active;\n\n    prepared.folderSummariesById[ALL_FOLDER_ID] = buildFolderSummaryFromMainList(\n      ALL_FOLDER_ID, newListIds, newPinnedIds,\n    );\n    prepared.folderSummariesById[UNREAD_FOLDER_ID] = buildFolderSummaryFromMainList(\n      UNREAD_FOLDER_ID, newListIds, newPinnedIds,\n    );\n    prepared.folderSummariesById[PRESET_FOLDER_ID] = buildFolderSummaryFromMainList(\n      PRESET_FOLDER_ID, newListIds, newPinnedIds,\n    );\n    prepared.folderSummariesById[AI_FOLDER_ID] = buildFolderSummaryFromMainList(\n      AI_FOLDER_ID, newListIds, newPinnedIds,\n    );\n\n    prevGlobal.allFolderListIds = newListIds;\n    prevGlobal.allFolderPinnedIds = newPinnedIds;\n\n    changedFolders.push(ALL_FOLDER_ID);\n    changedFolders.push(UNREAD_FOLDER_ID);\n    changedFolders.push(PRESET_FOLDER_ID);\n    changedFolders.push(AI_FOLDER_ID);\n  }\n\n  if (isArchivedFolderChanged) {\n    const newListIds = global.chats.listIds.archived!;\n    const newPinnedIds = global.chats.orderedPinnedIds.archived;\n\n    prepared.folderSummariesById[ARCHIVED_FOLDER_ID] = buildFolderSummaryFromMainList(\n      ARCHIVED_FOLDER_ID, newListIds, newPinnedIds,\n    );\n\n    prevGlobal.archivedFolderListIds = newListIds;\n    prevGlobal.archivedFolderPinnedIds = newPinnedIds;\n\n    changedFolders.push(ARCHIVED_FOLDER_ID);\n  }\n\n  if (isSavedFolderChanged) {\n    const newListIds = global.chats.listIds.saved!;\n    const newPinnedIds = global.chats.orderedPinnedIds.saved;\n\n    prepared.folderSummariesById[SAVED_FOLDER_ID] = buildFolderSummaryFromMainList(\n      SAVED_FOLDER_ID, newListIds, newPinnedIds,\n    );\n\n    prevGlobal.savedFolderListIds = newListIds;\n    prevGlobal.savedFolderPinnedIds = newPinnedIds;\n\n    changedFolders.push(SAVED_FOLDER_ID);\n  }\n\n  if (areFoldersChanged) {\n    const newFoldersById = global.chatFolders.byId;\n\n    Object.values(newFoldersById).forEach((folder) => {\n      if (folder === prevGlobal.foldersById[folder.id]) {\n        return;\n      }\n\n      prepared.folderSummariesById[folder.id] = buildFolderSummary(folder);\n\n      changedFolders.push(folder.id);\n    });\n\n    prevGlobal.foldersById = newFoldersById;\n  }\n\n  return changedFolders;\n}\n\nfunction buildFolderSummaryFromMainList(\n  folderId: number, listIds: string[], orderedPinnedIds?: string[],\n): FolderSummary {\n  return {\n    id: folderId,\n    listIds: new Set(listIds),\n    orderedPinnedIds,\n    pinnedChatIds: new Set(orderedPinnedIds),\n  };\n}\n\nfunction buildFolderSummary(folder: ApiChatFolder): FolderSummary {\n  return {\n    ...folder,\n    orderedPinnedIds: folder.pinnedChatIds,\n    excludedChatIds: folder.excludedChatIds ? new Set(folder.excludedChatIds) : undefined,\n    includedChatIds: folder.excludedChatIds ? new Set(folder.includedChatIds) : undefined,\n    pinnedChatIds: folder.excludedChatIds ? new Set(folder.pinnedChatIds) : undefined,\n  };\n}\n\nfunction updateChats(\n  global: GlobalState,\n  areFoldersChanged: boolean,\n  areNotifyDefaultsChanged: boolean,\n  areNotifyExceptionsChanged: boolean,\n  prevAllFolderListIds?: string[],\n  prevArchivedFolderListIds?: string[],\n  prevSavedFolderListIds?: string[],\n) {\n  const newChatsById = global.chats.byId;\n  const newUsersById = global.users.byId;\n  const newAllLastMessageIds = global.chats.lastMessageIds.all;\n  const newSavedLastMessageIds = global.chats.lastMessageIds.saved;\n  const newNotifyDefaults = selectNotifyDefaults(global);\n  const newNotifyExceptions = global.chats.notifyExceptionById;\n  const folderSummaries = Object.values(prepared.folderSummariesById);\n  const affectedFolderIds = new Set<number>();\n\n  const newAllFolderListIds = global.chats.listIds.active;\n  const newArchivedFolderListIds = global.chats.listIds.archived;\n  const newSavedFolderListIds = global.chats.listIds.saved;\n\n  const newGeneralIds = [...newAllFolderListIds || [], ...newArchivedFolderListIds || []];\n  const newAllIds = [...newGeneralIds, ...newSavedFolderListIds || []];\n  let allIds = newAllIds;\n  if (newAllFolderListIds !== prevAllFolderListIds || newArchivedFolderListIds !== prevArchivedFolderListIds\n    || newSavedFolderListIds !== prevSavedFolderListIds) {\n    allIds = unique(allIds.concat(\n      prevAllFolderListIds || [], prevArchivedFolderListIds || [], prevSavedFolderListIds || [],\n    ));\n  }\n\n  allIds.forEach((chatId) => {\n    const chat = newChatsById[chatId];\n\n    if (\n      !areFoldersChanged\n      && !areNotifyDefaultsChanged\n      && !areNotifyExceptionsChanged\n      && chat === prevGlobal.chatsById[chatId]\n      && newUsersById[chatId] === prevGlobal.usersById[chatId]\n      && newAllLastMessageIds?.[chatId] === prevGlobal.lastAllMessageIds?.[chatId]\n      && newSavedLastMessageIds?.[chatId] === prevGlobal.lastSavedMessageIds?.[chatId]\n    ) {\n      return;\n    }\n\n    let newFolderIds: number[];\n    if (chat) {\n      const currentSummary = prepared.chatSummariesById.get(chatId);\n      const isRemovedFromAll = !newGeneralIds.includes(chatId);\n      const isRemovedFromSaved = !newSavedFolderListIds?.includes(chatId);\n      const newSummary = buildChatSummary(\n        global,\n        chat,\n        newNotifyDefaults,\n        newNotifyExceptions,\n        newUsersById[chatId],\n        isRemovedFromAll,\n        isRemovedFromSaved,\n      );\n\n      if (!areFoldersChanged && currentSummary && arePropsShallowEqual(newSummary, currentSummary)) {\n        return;\n      }\n\n      prepared.chatSummariesById.set(chatId, newSummary);\n\n      newFolderIds = buildChatFolderIds(newSummary, folderSummaries);\n      newFolderIds.forEach((folderId) => {\n        affectedFolderIds.add(folderId);\n      });\n    } else {\n      prepared.chatSummariesById.delete(chatId);\n      newFolderIds = [];\n    }\n\n    const currentFolderIds = prepared.folderIdsByChatId[chatId] || [];\n    if (areSortedArraysEqual(newFolderIds, currentFolderIds)) {\n      return;\n    }\n\n    const deletedFolderIds = updateListsForChat(chatId, currentFolderIds, newFolderIds);\n    deletedFolderIds.forEach((folderId) => {\n      affectedFolderIds.add(folderId);\n    });\n  });\n\n  prevGlobal.chatsById = newChatsById;\n  prevGlobal.usersById = newUsersById;\n  prevGlobal.lastAllMessageIds = newAllLastMessageIds;\n  prevGlobal.lastSavedMessageIds = newSavedLastMessageIds;\n  prevGlobal.notifyDefaults = newNotifyDefaults;\n  prevGlobal.notifyExceptions = newNotifyExceptions;\n\n  return Array.from(affectedFolderIds);\n}\n\nfunction buildChatSummary<T extends GlobalState>(\n  global: T,\n  chat: ApiChat,\n  notifyDefaults?: Record<ApiNotifyPeerType, ApiPeerNotifySettings>,\n  notifyExceptions?: Record<string, ApiPeerNotifySettings>,\n  user?: ApiUser,\n  isRemovedFromAll?: boolean,\n  isRemovedFromSaved?: boolean,\n): ChatSummary {\n  const {\n    id, type, isRestricted, isNotJoined, migratedTo, folderId,\n    unreadCount: chatUnreadCount, unreadMentionsCount: chatUnreadMentionsCount, hasUnreadMark,\n    isForum,\n  } = chat;\n  const topics = selectTopics(global, chat.id);\n\n  const { unreadCount, unreadMentionsCount } = isForum\n    ? Object.values(topics || {}).reduce((acc, topic) => {\n      acc.unreadCount += topic.unreadCount;\n      acc.unreadMentionsCount += topic.unreadMentionsCount;\n\n      return acc;\n    }, { unreadCount: 0, unreadMentionsCount: 0 })\n    : { unreadCount: chatUnreadCount, unreadMentionsCount: chatUnreadMentionsCount };\n\n  const userInfo = type === 'chatTypePrivate' && user;\n  const lastMessage = selectChatLastMessage(global, chat.id);\n  const shouldHideServiceChat = chat.id === SERVICE_NOTIFICATIONS_USER_ID && (\n    !lastMessage || lastMessage.content.action?.type === 'historyClear'\n  );\n\n  const orderInAll = Math.max(chat.creationDate || 0, chat.draftDate || 0, lastMessage?.date || 0);\n\n  const lastMessageInSaved = selectChatLastMessage(global, chat.id, 'saved');\n  const orderInSaved = lastMessageInSaved?.date || 0;\n\n  return {\n    id,\n    type,\n    isListedInAll: Boolean(!isRestricted && !isNotJoined && !migratedTo && !shouldHideServiceChat && !isRemovedFromAll),\n    isListedInSaved: !isRemovedFromSaved,\n    isArchived: folderId === ARCHIVED_FOLDER_ID,\n    isMuted: getIsChatMuted(chat, notifyDefaults, notifyExceptions?.[chat.id]),\n    isUnread: Boolean(unreadCount || unreadMentionsCount || hasUnreadMark),\n    unreadCount,\n    unreadMentionsCount,\n    isUserBot: userInfo ? userInfo.type === 'userTypeBot' : undefined,\n    isUserContact: userInfo ? userInfo.isContact : undefined,\n    orderInAll,\n    orderInSaved,\n  };\n}\n\nfunction buildChatFolderIds(chatSummary: ChatSummary, folderSummaries: FolderSummary[]) {\n  return folderSummaries.reduce<number[]>((acc, folderSummary) => {\n    if (isChatInFolder(chatSummary, folderSummary)) {\n      acc.push(folderSummary.id);\n    }\n\n    return acc;\n  }, []).sort();\n}\n\nfunction isChatInFolder(\n  chatSummary: ChatSummary,\n  folderSummary: FolderSummary,\n) {\n  const isListed = folderSummary.id === SAVED_FOLDER_ID ? chatSummary.isListedInSaved : chatSummary.isListedInAll;\n  if (!isListed) {\n    return false;\n  }\n\n  const { id: chatId, type } = chatSummary;\n\n  if (folderSummary.listIds) {\n    if (\n      (chatSummary.isArchived && folderSummary.id === ALL_FOLDER_ID)\n      || (!chatSummary.isArchived && folderSummary.id === ARCHIVED_FOLDER_ID)\n    ) {\n      return false;\n    }\n\n    return folderSummary.listIds.has(chatId);\n  }\n\n  if (folderSummary.excludedChatIds?.has(chatId)) {\n    return false;\n  }\n\n  if (folderSummary.includedChatIds?.has(chatId)) {\n    return true;\n  }\n\n  if (folderSummary.pinnedChatIds?.has(chatId)) {\n    return true;\n  }\n\n  if (folderSummary.excludeArchived && chatSummary.isArchived) {\n    return false;\n  }\n\n  if (folderSummary.excludeRead && !chatSummary.isUnread) {\n    return false;\n  }\n\n  if (folderSummary.excludeMuted && chatSummary.isMuted && !chatSummary.unreadMentionsCount) {\n    return false;\n  }\n\n  if (type === 'chatTypePrivate') {\n    if (chatSummary.isUserBot) {\n      if (folderSummary.bots) {\n        return true;\n      }\n    } else {\n      if (folderSummary.contacts && chatSummary.isUserContact) {\n        return true;\n      }\n\n      if (folderSummary.nonContacts && !chatSummary.isUserContact) {\n        return true;\n      }\n    }\n  } else if (type === 'chatTypeChannel') {\n    return Boolean(folderSummary.channels);\n  } else if (type === 'chatTypeBasicGroup' || type === 'chatTypeSuperGroup') {\n    return Boolean(folderSummary.groups);\n  }\n\n  return false;\n}\n\nfunction updateListsForChat(chatId: string, currentFolderIds: number[], newFolderIds: number[]) {\n  const currentFolderIdsSet = new Set(currentFolderIds);\n  const newFolderIdsSet = new Set(newFolderIds);\n  const deletedFolderIds: number[] = [];\n\n  unique([...currentFolderIds, ...newFolderIds]).forEach((folderId) => {\n    let currentFolderOrderedIds = results.orderedIdsByFolderId[folderId];\n\n    if (currentFolderIdsSet.has(folderId) && !newFolderIdsSet.has(folderId)) {\n      prepared.chatIdsByFolderId[folderId]!.delete(chatId);\n\n      deletedFolderIds.push(folderId);\n\n      if (currentFolderOrderedIds) {\n        currentFolderOrderedIds = currentFolderOrderedIds.filter((id) => id !== chatId);\n        prepared.isOrderedListJustPatched[folderId] = true;\n      }\n    } else if (!currentFolderIdsSet.has(folderId) && newFolderIdsSet.has(folderId)) {\n      if (!prepared.chatIdsByFolderId[folderId]) {\n        prepared.chatIdsByFolderId[folderId] = new Set();\n      }\n\n      prepared.chatIdsByFolderId[folderId]!.add(chatId);\n\n      if (currentFolderOrderedIds) {\n        currentFolderOrderedIds.push(chatId);\n        prepared.isOrderedListJustPatched[folderId] = true;\n      }\n    }\n\n    results.orderedIdsByFolderId[folderId] = currentFolderOrderedIds;\n  });\n\n  prepared.folderIdsByChatId[chatId] = newFolderIds;\n\n  return deletedFolderIds;\n}\n\nfunction updateResults(affectedFolderIds: number[]) {\n  let wasUnreadCountersChanged = false;\n  let wasChatsCountChanged = false;\n  let wasUnreadChatsChanged = false;\n\n  Array.from(affectedFolderIds).forEach((folderId) => {\n    const { pinnedCount: newPinnedCount, orderedIds: newOrderedIds } = buildFolderOrderedIds(folderId);\n    // When signed out\n    if (!newOrderedIds) {\n      return;\n    }\n\n    const currentOrderedIds = results.orderedIdsByFolderId[folderId];\n    const currentPinnedCount = results.pinnedCountByFolderId[folderId];\n    const areOrderedIdsChanged = (\n      !currentOrderedIds\n      || currentPinnedCount === undefined || currentPinnedCount !== newPinnedCount\n      || prepared.isOrderedListJustPatched[folderId]\n      || !areSortedArraysEqual(newOrderedIds, currentOrderedIds)\n    );\n    if (areOrderedIdsChanged) {\n      prepared.isOrderedListJustPatched[folderId] = false;\n      results.orderedIdsByFolderId[folderId] = newOrderedIds;\n      results.pinnedCountByFolderId[folderId] = newPinnedCount;\n      callbacks.orderedIdsByFolderId[folderId]?.runCallbacks(newOrderedIds);\n    }\n\n    const currentChatsCount = results.chatsCountByFolderId[folderId];\n    const newChatsCount = newOrderedIds.length;\n    if (!wasChatsCountChanged) {\n      wasChatsCountChanged = currentChatsCount !== newChatsCount;\n    }\n    results.chatsCountByFolderId[folderId] = newChatsCount;\n\n    const currentUnreadCounters = results.unreadCountersByFolderId[folderId];\n    const newUnreadCounters = buildFolderUnreadCounters(folderId);\n    if (!wasUnreadCountersChanged) {\n      wasUnreadCountersChanged = (\n        !currentUnreadCounters || !arePropsShallowEqual(newUnreadCounters, currentUnreadCounters)\n      );\n    }\n    results.unreadCountersByFolderId[folderId] = newUnreadCounters;\n\n    const currentUnreadChats = results.unreadChatIdsByFolderId[folderId];\n    const newUnreadChats = buildFolderByUnreadChats(folderId);\n    if (!wasUnreadChatsChanged) {\n      wasUnreadChatsChanged = (\n        !currentUnreadChats || !areSortedArraysEqual(newUnreadChats, currentUnreadChats)\n      );\n    }\n    results.unreadChatIdsByFolderId[folderId] = newUnreadChats;\n  });\n\n  if (wasChatsCountChanged) {\n    // We need to update the entire object as it will be returned from a hook\n    const newValue = { ...results.chatsCountByFolderId };\n    results.chatsCountByFolderId = newValue;\n    callbacks.chatsCountByFolderId.runCallbacks(newValue);\n  }\n\n  if (wasUnreadCountersChanged) {\n    // We need to update the entire object as it will be returned from a hook\n    const newValue = { ...results.unreadCountersByFolderId };\n    results.unreadCountersByFolderId = newValue;\n    callbacks.unreadCountersByFolderId.runCallbacks(newValue);\n  }\n\n  if (wasUnreadChatsChanged) {\n    callbacks.unreadChatIdsByFolderId.runCallbacks(results.unreadChatIdsByFolderId);\n  }\n}\n\nfunction buildFolderOrderedIds(folderId: number) {\n  const folderSummary = prepared.folderSummariesById[folderId];\n  if (!folderSummary) {\n    return {};\n  }\n\n  const { orderedPinnedIds, pinnedChatIds } = folderSummary;\n  const {\n    chatIdsByFolderId: { [folderId]: chatIds },\n  } = prepared;\n  const {\n    orderedIdsByFolderId: { [folderId]: prevOrderedIds },\n  } = results;\n\n  const isSavedFolder = folderId === SAVED_FOLDER_ID;\n\n  const sortedPinnedIds = chatIds ? orderedPinnedIds?.filter((id) => chatIds.has(id)) : orderedPinnedIds;\n  const allListIds = prevOrderedIds || (chatIds && Array.from(chatIds)) || [];\n  const notPinnedIds = pinnedChatIds ? allListIds.filter((id) => !pinnedChatIds.has(id)) : allListIds;\n  const sortedNotPinnedIds = notPinnedIds.sort((chatId1: string, chatId2: string) => {\n    return getOrderKey(chatId2, isSavedFolder) - getOrderKey(chatId1, isSavedFolder);\n  });\n\n  return {\n    pinnedCount: sortedPinnedIds?.length || 0,\n    orderedIds: [\n      ...(sortedPinnedIds || []),\n      ...sortedNotPinnedIds,\n    ],\n  };\n}\n\nfunction buildFolderUnreadCounters(folderId: number) {\n  const {\n    chatSummariesById,\n  } = prepared;\n  const {\n    orderedIdsByFolderId: { [folderId]: orderedIds },\n  } = results;\n\n  return orderedIds!.reduce((newUnreadCounters, chatId) => {\n    const chatSummary = chatSummariesById.get(chatId);\n    if (!chatSummary) {\n      return newUnreadCounters;\n    }\n\n    if (chatSummary.isUnread) {\n      newUnreadCounters.chatsCount++;\n\n      if (chatSummary.unreadMentionsCount) {\n        newUnreadCounters.notificationsCount += chatSummary.unreadMentionsCount;\n      }\n\n      if (!chatSummary.isMuted) {\n        if (chatSummary.unreadCount) {\n          newUnreadCounters.notificationsCount += chatSummary.unreadCount;\n        } else if (!chatSummary.unreadMentionsCount) {\n          newUnreadCounters.notificationsCount += 1; // Manually marked unread\n        }\n      }\n    }\n\n    return newUnreadCounters;\n  }, {\n    chatsCount: 0,\n    notificationsCount: 0,\n  });\n}\n\nfunction buildFolderByUnreadChats(folderId: number) {\n  const { chatSummariesById } = prepared;\n  const { orderedIdsByFolderId: { [folderId]: orderedIds } } = results;\n\n  return orderedIds!.filter((chatId) => {\n    const chatSummary = chatSummariesById.get(chatId);\n    return chatSummary?.isUnread;\n  });\n}\n\nfunction buildInitials() {\n  return {\n    prevGlobal: {\n      foldersById: {},\n      chatsById: {},\n      usersById: {},\n      topicsInfoById: {},\n    },\n\n    prepared: {\n      folderSummariesById: {},\n      chatSummariesById: new Map(),\n      folderIdsByChatId: {},\n      chatIdsByFolderId: {},\n      isOrderedListJustPatched: {},\n    },\n\n    results: {\n      orderedIdsByFolderId: {},\n      pinnedCountByFolderId: {},\n      chatsCountByFolderId: {},\n      unreadCountersByFolderId: {},\n      unreadChatIdsByFolderId: {},\n    },\n\n    callbacks: {\n      orderedIdsByFolderId: {},\n      chatsCountByFolderId: createCallbackManager(),\n      unreadCountersByFolderId: createCallbackManager(),\n      unreadChatIdsByFolderId: createCallbackManager(),\n    },\n  };\n}\n\nfunction reset() {\n  const newInitials = buildInitials();\n\n  prevGlobal = newInitials.prevGlobal;\n  prepared = newInitials.prepared;\n  results = newInitials.results;\n  callbacks = newInitials.callbacks;\n}\n","import { DEBUG_MORE } from '../config';\nimport { handleError } from './handleError';\n\nconst SAFE_EXEC_ENABLED = !DEBUG_MORE;\n\ntype SafeExecOptions = {\n  rescue?: (err: Error) => void;\n  always?: NoneToVoidFunction;\n  shouldIgnoreError?: boolean;\n};\n\nexport default function safeExec<T extends AnyFunction>(cb: T, options?: SafeExecOptions): ReturnType<T> | undefined {\n  if (!SAFE_EXEC_ENABLED) {\n    return cb();\n  }\n\n  const { rescue, always, shouldIgnoreError } = options ?? {};\n\n  try {\n    return cb();\n  } catch (err: any) {\n    rescue?.(err);\n    if (!shouldIgnoreError) {\n      handleError(err);\n    }\n    return undefined;\n  } finally {\n    always?.();\n  }\n}\n","import { IS_IOS, IS_WINDOWS } from './browser/windowEnvironment';\nimport { Lethargy } from './lethargy';\nimport { clamp, round } from './math';\nimport { debounce } from './schedulers';\nimport windowSize from './windowSize';\n\nexport enum SwipeDirection {\n  Up,\n  Down,\n  Left,\n  Right,\n}\n\nexport interface MoveOffsets {\n  dragOffsetX: number;\n  dragOffsetY: number;\n}\n\ninterface CaptureOptions {\n  onCapture?: (e: MouseEvent | TouchEvent | WheelEvent) => void;\n  onRelease?: (e: MouseEvent | TouchEvent | WheelEvent) => void;\n  onDrag?: (\n    e: MouseEvent | TouchEvent | WheelEvent,\n    captureEvent: MouseEvent | TouchEvent | WheelEvent,\n    offsets: MoveOffsets,\n    cancelDrag?: (x: boolean, y: boolean) => void,\n  ) => void;\n  onSwipe?: (e: Event, direction: SwipeDirection, offsets: MoveOffsets) => boolean;\n  onZoom?: (e: TouchEvent | WheelEvent, params: {\n    // Absolute zoom level\n    zoom?: number;\n    // Relative zoom factor\n    zoomFactor?: number;\n\n    // center coordinate of the initial pinch\n    initialCenterX: number;\n    initialCenterY: number;\n\n    // offset of the pinch center (current from initial)\n    dragOffsetX: number;\n    dragOffsetY: number;\n\n    // center coordinate of the current pinch\n    currentCenterX: number;\n    currentCenterY: number;\n  }) => void;\n  onClick?: (e: MouseEvent | TouchEvent) => void;\n  onDoubleClick?: (e: MouseEvent | RealTouchEvent | WheelEvent, params: { centerX: number; centerY: number }) => void;\n  excludedClosestSelector?: string;\n  includedClosestSelector?: string;\n  selectorToPreventScroll?: string;\n  withNativeDrag?: boolean;\n  maxZoom?: number;\n  minZoom?: number;\n  doubleTapZoom?: number;\n  initialZoom?: number;\n  isNotPassive?: boolean;\n  withCursor?: boolean;\n  swipeThreshold?: number;\n  withWheelDrag?: boolean;\n}\n\n// https://stackoverflow.com/questions/11287877/how-can-i-get-e-offsetx-on-mobile-ipad\n// Android does not have this value, and iOS has it but as read-only\nexport interface RealTouchEvent extends TouchEvent {\n  pageX?: number;\n  pageY?: number;\n}\n\ntype TSwipeAxis =\n  'x'\n  | 'y'\n  | undefined;\n\nexport const IOS_SCREEN_EDGE_THRESHOLD = 20;\nexport const SWIPE_DIRECTION_THRESHOLD = 10;\nexport const SWIPE_DIRECTION_TOLERANCE = 1.5;\n\nconst MOVE_THRESHOLD = 15;\nconst SWIPE_THRESHOLD_DEFAULT = 20;\nconst RELEASE_WHEEL_ZOOM_DELAY = 150;\nconst RELEASE_WHEEL_DRAG_DELAY = 150;\n\nfunction getDistance(a: Touch, b?: Touch) {\n  if (!b) return 0;\n  return Math.hypot((b.pageX - a.pageX), (b.pageY - a.pageY));\n}\n\nfunction getTouchCenter(a: Touch, b: Touch) {\n  return {\n    x: (a.pageX + b.pageX) / 2,\n    y: (a.pageY + b.pageY) / 2,\n  };\n}\n\nlet lastClickTime = 0;\nconst lethargy = new Lethargy({\n  stability: 5,\n  sensitivity: 25,\n  tolerance: IS_WINDOWS ? 1 : 0.6, // Windows `scrollDelta` does not die down to 0\n  delay: 150,\n});\n\nexport function captureEvents(element: HTMLElement, options: CaptureOptions) {\n  let captureEvent: MouseEvent | RealTouchEvent | WheelEvent | undefined;\n  let hasMoved = false;\n  let hasSwiped = false;\n  let isZooming = false;\n  let initialDistance = 0;\n  let wheelZoom = options.initialZoom ?? 1;\n  let initialDragOffset = {\n    x: 0,\n    y: 0,\n  };\n  let isDragCanceled = {\n    x: false,\n    y: false,\n  };\n  const currentWindowSize = windowSize.get();\n  let initialTouchCenter = {\n    x: currentWindowSize.width / 2,\n    y: currentWindowSize.height / 2,\n  };\n  let initialSwipeAxis: TSwipeAxis | undefined;\n  const minZoom = options.minZoom ?? 1;\n  const maxZoom = options.maxZoom ?? 4;\n\n  function onCapture(e: MouseEvent | RealTouchEvent) {\n    const target = e.target as HTMLElement;\n    const {\n      excludedClosestSelector,\n      includedClosestSelector,\n      withNativeDrag,\n      withCursor,\n      onDrag,\n    } = options;\n\n    if (element !== target && !element.contains(target)) {\n      return;\n    }\n\n    if (target.tagName === 'INPUT' || target.tagName === 'TEXTAREA') {\n      return;\n    }\n\n    if (\n      (excludedClosestSelector && (target.matches(excludedClosestSelector) || target.closest(excludedClosestSelector)))\n      || (\n        includedClosestSelector && !(target.matches(includedClosestSelector) || target.closest(includedClosestSelector))\n      )\n    ) {\n      return;\n    }\n\n    captureEvent = e;\n\n    if (e.type === 'mousedown') {\n      if (!withNativeDrag && onDrag) {\n        e.preventDefault();\n      }\n\n      document.addEventListener('mousemove', onMove);\n      document.addEventListener('mouseup', onRelease);\n    } else if (e.type === 'touchstart') {\n      // We need to always listen on `touchstart` target:\n      // https://stackoverflow.com/questions/33298828/touch-move-event-dont-fire-after-touch-start-target-is-removed\n      target.addEventListener('touchmove', onMove, { passive: true });\n      target.addEventListener('touchend', onRelease, { passive: true });\n      target.addEventListener('touchcancel', onRelease, { passive: true });\n\n      if ('touches' in e) {\n        if (e.pageX === undefined) {\n          e.pageX = e.touches[0].pageX;\n        }\n\n        if (e.pageY === undefined) {\n          e.pageY = e.touches[0].pageY;\n        }\n\n        if (e.touches.length === 2) {\n          initialDistance = getDistance(e.touches[0], e.touches[1]);\n          initialTouchCenter = getTouchCenter(e.touches[0], e.touches[1]);\n        }\n      }\n    }\n\n    if (withCursor) {\n      document.body.classList.add('cursor-grabbing');\n    }\n\n    options.onCapture?.(e);\n  }\n\n  function onRelease(e?: MouseEvent | TouchEvent) {\n    if (captureEvent) {\n      if (options.withCursor) {\n        document.body.classList.remove('cursor-grabbing');\n      }\n\n      document.removeEventListener('mouseup', onRelease);\n      document.removeEventListener('mousemove', onMove);\n      (captureEvent.target as HTMLElement).removeEventListener('touchcancel', onRelease);\n      (captureEvent.target as HTMLElement).removeEventListener('touchend', onRelease);\n      (captureEvent.target as HTMLElement).removeEventListener('touchmove', onMove);\n\n      if (IS_IOS && options.selectorToPreventScroll) {\n        Array.from(document.querySelectorAll<HTMLElement>(options.selectorToPreventScroll))\n          .forEach((scrollable) => {\n            scrollable.style.overflow = '';\n          });\n      }\n\n      if (e) {\n        if (hasMoved) {\n          if (options.onRelease) {\n            options.onRelease(e);\n          }\n        } else if (e.type === 'mouseup') {\n          if (options.onDoubleClick && Date.now() - lastClickTime < 300) {\n            options.onDoubleClick(e, {\n              centerX: captureEvent!.pageX!,\n              centerY: captureEvent!.pageY!,\n            });\n          } else if (options.onClick && (!('button' in e) || e.button === 0)) {\n            options.onClick(e);\n          }\n          lastClickTime = Date.now();\n        }\n      }\n    }\n\n    hasMoved = false;\n    hasSwiped = false;\n    isZooming = false;\n    initialDistance = 0;\n    wheelZoom = clamp(wheelZoom, minZoom, maxZoom);\n    initialSwipeAxis = undefined;\n    initialDragOffset = {\n      x: 0,\n      y: 0,\n    };\n    isDragCanceled = {\n      x: false,\n      y: false,\n    };\n    const newWindowSize = windowSize.get();\n    initialTouchCenter = {\n      x: newWindowSize.width / 2,\n      y: newWindowSize.height / 2,\n    };\n    captureEvent = undefined;\n  }\n\n  function onMove(e: MouseEvent | RealTouchEvent) {\n    if (captureEvent) {\n      if (e.type === 'touchmove' && ('touches' in e)) {\n        if (e.pageX === undefined) {\n          e.pageX = e.touches[0].pageX;\n        }\n\n        if (e.pageY === undefined) {\n          e.pageY = e.touches[0].pageY;\n        }\n\n        if (options.onZoom && initialDistance > 0 && e.touches.length === 2) {\n          const endDistance = getDistance(e.touches[0], e.touches[1]);\n          const touchCenter = getTouchCenter(e.touches[0], e.touches[1]);\n          const dragOffsetX = touchCenter.x - initialTouchCenter.x;\n          const dragOffsetY = touchCenter.y - initialTouchCenter.y;\n          const zoomFactor = endDistance / initialDistance;\n          options.onZoom(e, {\n            zoomFactor,\n            initialCenterX: initialTouchCenter.x,\n            initialCenterY: initialTouchCenter.y,\n            dragOffsetX,\n            dragOffsetY,\n            currentCenterX: touchCenter.x,\n            currentCenterY: touchCenter.y,\n          });\n          if (zoomFactor !== 1) hasMoved = true;\n        }\n      }\n\n      const dragOffsetX = e.pageX! - captureEvent.pageX!;\n      const dragOffsetY = e.pageY! - captureEvent.pageY!;\n\n      if (Math.abs(dragOffsetX) >= MOVE_THRESHOLD || Math.abs(dragOffsetY) >= MOVE_THRESHOLD) {\n        hasMoved = true;\n      }\n\n      let shouldPreventScroll = false;\n\n      if (options.onDrag) {\n        options.onDrag(e, captureEvent, {\n          dragOffsetX,\n          dragOffsetY,\n        });\n        shouldPreventScroll = true;\n      }\n\n      if (options.onSwipe && !hasSwiped) {\n        hasSwiped = onSwipe(e, dragOffsetX, dragOffsetY);\n        shouldPreventScroll = hasSwiped;\n      }\n\n      if (IS_IOS && shouldPreventScroll && options.selectorToPreventScroll) {\n        Array.from(document.querySelectorAll<HTMLElement>(options.selectorToPreventScroll))\n          .forEach((scrollable) => {\n            scrollable.style.overflow = 'hidden';\n          });\n      }\n    }\n  }\n\n  function onSwipe(e: MouseEvent | RealTouchEvent, dragOffsetX: number, dragOffsetY: number) {\n    // Avoid conflicts with swipe-to-back gestures\n    if (IS_IOS) {\n      const x = (e as RealTouchEvent).touches[0].pageX;\n      if (x <= IOS_SCREEN_EDGE_THRESHOLD || x >= windowSize.get().width - IOS_SCREEN_EDGE_THRESHOLD) {\n        return false;\n      }\n    }\n\n    const xAbs = Math.abs(dragOffsetX);\n    const yAbs = Math.abs(dragOffsetY);\n    const threshold = options.swipeThreshold ?? SWIPE_THRESHOLD_DEFAULT;\n\n    let axis: TSwipeAxis | undefined;\n    if (xAbs > yAbs && xAbs >= threshold) {\n      axis = 'x';\n    } else if (yAbs > xAbs && yAbs >= threshold) {\n      axis = 'y';\n    }\n\n    if (!axis) {\n      return false;\n    }\n\n    if (!initialSwipeAxis) {\n      initialSwipeAxis = axis;\n    } else if (initialSwipeAxis !== axis) {\n      // Prevent horizontal swipe after vertical to prioritize scroll\n      return false;\n    }\n\n    return processSwipe(e, axis, dragOffsetX, dragOffsetY, options.onSwipe!);\n  }\n\n  const releaseWheelDrag = debounce(onRelease, RELEASE_WHEEL_DRAG_DELAY, false);\n  const releaseWheelZoom = debounce(onRelease, RELEASE_WHEEL_ZOOM_DELAY, false);\n\n  function onWheelCapture(e: WheelEvent) {\n    if (hasMoved) return;\n    onCapture(e);\n    hasMoved = true;\n    initialTouchCenter = { x: e.x, y: e.y };\n  }\n\n  function onWheelZoom(e: WheelEvent) {\n    if (!options.onZoom) return;\n    onWheelCapture(e);\n    const dragOffsetX = e.x - initialTouchCenter.x;\n    const dragOffsetY = e.y - initialTouchCenter.y;\n    const delta = clamp(e.deltaY, -25, 25);\n    wheelZoom -= delta * 0.01;\n    wheelZoom = clamp(wheelZoom, minZoom * 0.5, maxZoom * 3);\n    isZooming = true;\n    options.onZoom(e, {\n      zoom: round(wheelZoom, 2),\n      initialCenterX: initialTouchCenter.x,\n      initialCenterY: initialTouchCenter.y,\n      dragOffsetX,\n      dragOffsetY,\n      currentCenterX: e.x,\n      currentCenterY: e.y,\n    });\n    releaseWheelZoom(e);\n  }\n\n  function onWheelDrag(e: WheelEvent) {\n    if (!options.onDrag) return;\n    onWheelCapture(e);\n    // Ignore wheel inertia if drag is canceled in this direction\n    if (!isDragCanceled.x || Math.sign(initialDragOffset.x) === Math.sign(e.deltaX)) {\n      initialDragOffset.x -= e.deltaX;\n    }\n    if (!isDragCanceled.y || Math.sign(initialDragOffset.y) === Math.sign(e.deltaY)) {\n      initialDragOffset.y -= e.deltaY;\n    }\n    const { x, y } = initialDragOffset;\n    options.onDrag(e, captureEvent!, {\n      dragOffsetX: x,\n      dragOffsetY: y,\n    }, (dx, dy) => {\n      isDragCanceled = { x: dx, y: dy };\n    });\n    releaseWheelDrag(e);\n  }\n\n  function onWheel(e: WheelEvent) {\n    if (!options.onZoom && !options.onDrag) return;\n    if (options.excludedClosestSelector && (\n      (e.target as HTMLElement).matches(options.excludedClosestSelector)\n      || (e.target as HTMLElement).closest(options.excludedClosestSelector)\n    )) {\n      return;\n    }\n    e.preventDefault();\n    e.stopPropagation();\n    const { doubleTapZoom = 3 } = options;\n    if (options.onDoubleClick && Object.is(e.deltaX, -0) && Object.is(e.deltaY, -0) && e.ctrlKey) {\n      onWheelCapture(e);\n      wheelZoom = wheelZoom > 1 ? 1 : doubleTapZoom;\n      options.onDoubleClick(e, { centerX: e.pageX, centerY: e.pageY });\n      hasMoved = false;\n      return;\n    }\n    const metaKeyPressed = e.metaKey || e.ctrlKey || e.shiftKey;\n    if (metaKeyPressed) {\n      onWheelZoom(e);\n    }\n    if (!metaKeyPressed && !isZooming) {\n      // Check if this event produced by user scroll and not by inertia\n      const isUserEvent = lethargy.check(e);\n      if (wheelZoom !== 1 || isUserEvent) {\n        onWheelDrag(e);\n      }\n    }\n  }\n\n  if (options.withWheelDrag) {\n    element.addEventListener('wheel', onWheel);\n  }\n\n  element.addEventListener('mousedown', onCapture);\n  document.body.addEventListener('touchstart', onCapture, { passive: !options.isNotPassive });\n\n  return () => {\n    onRelease();\n    document.body.removeEventListener('touchstart', onCapture);\n    element.removeEventListener('mousedown', onCapture);\n    element.removeEventListener('wheel', onWheel);\n  };\n}\n\nfunction processSwipe(\n  e: Event,\n  currentSwipeAxis: TSwipeAxis,\n  dragOffsetX: number,\n  dragOffsetY: number,\n  onSwipe: (e: Event, direction: SwipeDirection, offsets: MoveOffsets) => boolean,\n) {\n  const offsets = { dragOffsetX, dragOffsetY };\n\n  if (currentSwipeAxis === 'x') {\n    if (dragOffsetX < 0) {\n      return onSwipe(e, SwipeDirection.Left, offsets);\n    } else {\n      return onSwipe(e, SwipeDirection.Right, offsets);\n    }\n  } else if (currentSwipeAxis === 'y') {\n    if (dragOffsetY < 0) {\n      return onSwipe(e, SwipeDirection.Up, offsets);\n    } else {\n      return onSwipe(e, SwipeDirection.Down, offsets);\n    }\n  }\n\n  return false;\n}\n","/**\n * Lethargy help distinguish between scroll events initiated by the user, and those by inertial scrolling.\n * Lethargy does not have external dependencies.\n *\n * @param stability - Specifies the length of the rolling average.\n * In effect, the larger the value, the smoother the curve will be.\n * This attempts to prevent anomalies from firing 'real' events. Valid values are all positive integers,\n * but in most cases, you would need to stay between 5 and around 30.\n *\n * @param sensitivity - Specifies the minimum value for wheelDelta for it to register as a valid scroll event.\n * Because the tail of the curve have low wheelDelta values,\n * this will stop them from registering as valid scroll events.\n * The unofficial standard wheelDelta is 120, so valid values are positive integers below 120.\n *\n * @param tolerance - Prevent small fluctuations from affecting results.\n * Valid values are decimals from 0, but should ideally be between 0.05 and 0.3.\n *\n * Based on https://github.com/d4nyll/lethargy\n */\n\nexport type LethargyConfig = {\n  stability?: number;\n  sensitivity?: number;\n  tolerance?: number;\n  delay?: number;\n};\n\nexport class Lethargy {\n  stability: number;\n\n  sensitivity: number;\n\n  tolerance: number;\n\n  delay: number;\n\n  lastUpDeltas: Array<number>;\n\n  lastDownDeltas: Array<number>;\n\n  deltasTimestamp: Array<number>;\n\n  constructor({\n    stability = 8,\n    sensitivity = 100,\n    tolerance = 1.1,\n    delay = 150,\n  }: LethargyConfig = {}) {\n    this.stability = stability;\n    this.sensitivity = sensitivity;\n    this.tolerance = tolerance;\n    this.delay = delay;\n    this.lastUpDeltas = new Array(this.stability * 2).fill(0);\n    this.lastDownDeltas = new Array(this.stability * 2).fill(0);\n    this.deltasTimestamp = new Array(this.stability * 2).fill(0);\n  }\n\n  check(e: any) {\n    let lastDelta;\n    e = e.originalEvent || e;\n    if (e.wheelDelta !== undefined) {\n      lastDelta = e.wheelDelta;\n    } else if (e.deltaY !== undefined) {\n      lastDelta = e.deltaY * -40;\n    } else if (e.detail !== undefined || e.detail === 0) {\n      lastDelta = e.detail * -40;\n    }\n    this.deltasTimestamp.push(Date.now());\n    this.deltasTimestamp.shift();\n    if (lastDelta > 0) {\n      this.lastUpDeltas.push(lastDelta);\n      this.lastUpDeltas.shift();\n      return this.isInertia(1);\n    } else {\n      this.lastDownDeltas.push(lastDelta);\n      this.lastDownDeltas.shift();\n      return this.isInertia(-1);\n    }\n  }\n\n  isInertia(direction: number) {\n    const lastDeltas = direction === -1 ? this.lastDownDeltas : this.lastUpDeltas;\n    if (lastDeltas[0] === undefined) return direction;\n    if (\n      this.deltasTimestamp[this.stability * 2 - 2] + this.delay > Date.now()\n      && lastDeltas[0] === lastDeltas[this.stability * 2 - 1]\n    ) {\n      return false;\n    }\n    const lastDeltasOld = lastDeltas.slice(0, this.stability);\n    const lastDeltasNew = lastDeltas.slice(this.stability, this.stability * 2);\n    const oldSum = lastDeltasOld.reduce((t, s) => t + s);\n    const newSum = lastDeltasNew.reduce((t, s) => t + s);\n    const oldAverage = oldSum / lastDeltasOld.length;\n    const newAverage = newSum / lastDeltasNew.length;\n    return Math.abs(oldAverage) <= Math.abs(newAverage * this.tolerance)\n      && this.sensitivity < Math.abs(newAverage);\n  }\n}\n","import { useRef, useState } from '../lib/teact/teact';\n\nimport buildClassName from '../util/buildClassName';\n\nconst CLOSE_DURATION = 350;\n\nconst useShowTransitionDeprecated = (\n  isOpen = false,\n  onCloseTransitionEnd?: () => void,\n  noFirstOpenTransition = false,\n  className: string | false = 'fast',\n  noCloseTransition = false,\n  closeDuration = CLOSE_DURATION,\n  noOpenTransition = false,\n) => {\n  const [isClosed, setIsClosed] = useState(!isOpen);\n  const closeTimeoutRef = useRef<number>();\n  // СSS class should be added in a separate tick to turn on CSS transition.\n  const [hasOpenClassName, setHasOpenClassName] = useState(isOpen && noFirstOpenTransition);\n\n  if (isOpen) {\n    setIsClosed(false);\n    setHasOpenClassName(true);\n\n    if (closeTimeoutRef.current) {\n      window.clearTimeout(closeTimeoutRef.current);\n\n      closeTimeoutRef.current = undefined;\n    }\n  } else {\n    setHasOpenClassName(false);\n\n    if (!isClosed && !closeTimeoutRef.current) {\n      const exec = () => {\n        setIsClosed(true);\n\n        if (onCloseTransitionEnd) {\n          onCloseTransitionEnd();\n        }\n\n        closeTimeoutRef.current = undefined;\n      };\n\n      if (noCloseTransition) {\n        exec();\n      } else {\n        closeTimeoutRef.current = window.setTimeout(exec, closeDuration);\n      }\n    }\n  }\n\n  // `noCloseTransition`, when set to true, should remove the open class immediately\n  const shouldHaveOpenClassName = (hasOpenClassName && !(noCloseTransition && !isOpen)) || (noOpenTransition && isOpen);\n  const isClosing = Boolean(closeTimeoutRef.current);\n  const shouldRender = isOpen || isClosing;\n  const transitionClassNames = buildClassName(\n    className && 'opacity-transition',\n    className,\n    shouldHaveOpenClassName && 'open',\n    !shouldHaveOpenClassName && 'not-open',\n    shouldRender && 'shown',\n    !shouldRender && 'not-shown',\n    isClosing && 'closing',\n  );\n\n  return {\n    shouldRender,\n    transitionClassNames,\n    hasShownClass: shouldRender,\n    hasOpenClass: shouldHaveOpenClassName,\n    isClosing,\n  };\n};\n\nexport default useShowTransitionDeprecated;\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"W4ndaFuS\",\"contentBox\":\"qIESjPFU\",\"textContent\":\"cgQoy2xy\",\"hasFullContent\":\"x0D811xX\",\"inlineWrapper\":\"CrZTrncJ\",\"singleLine\":\"j1bGIpWD\",\"strong\":\"d5ep97lr\",\"messageLink\":\"Soqky8rY\",\"contextContainer\":\"Rz1leKMF\",\"fluidMultiline\":\"oL3NoM4Y\",\"fluidBackground\":\"faqkTF52\",\"info\":\"Jcta1qBG\",\"stickerWrapper\":\"F8w9vDlr\",\"channelPhoto\":\"wnjg6GZj\",\"suggestedAvatar\":\"ClHX4zX1\",\"suggestedText\":\"jT6o01vL\",\"actionButton\":\"LB5i9s3a\",\"title\":\"Cp_BJqe5\",\"subtitle\":\"VCJyqpS8\",\"starGift\":\"lcncBNHa\",\"uniqueGift\":\"jxcv_A2w\",\"uniqueBackgroundWrapper\":\"lsTgPDw1\",\"uniqueBackground\":\"uzTnIOE7\",\"uniqueValue\":\"pae10ItJ\"};","import { intersection, uniq } from \"lodash\";\nimport { getGlobal } from \"../../../global\";\n\nexport function filterPresetTag(orderedIds?: string[]) {\n  const global = getGlobal();\n\n  const activePresetTag = global?.chatFolders?.aiChatFolders?.activePresetTag;\n  if (!orderedIds || !activePresetTag || !activePresetTag?.length)\n    return orderedIds;\n\n  const allAiChatFolders = global?.chatFolders?.aiChatFolders?.list;\n  if (allAiChatFolders?.length) {\n    return allAiChatFolders\n      ?.filter((o) => intersection(o?.presetTag, activePresetTag).length)\n      ?.map((o) => o?.id ?? \"\");\n  } else {\n    return orderedIds;\n  }\n}\n\nexport function filterAITag(orderedIds?: string[]) {\n  const global = getGlobal();\n\n  const activeAITag = global?.chatFolders?.aiChatFolders?.activeAITag;\n  if (!orderedIds || !activeAITag || !activeAITag?.length) return orderedIds;\n\n  const allAiChatFolders = global?.chatFolders?.aiChatFolders?.list;\n  if (allAiChatFolders?.length) {\n    return allAiChatFolders\n      ?.filter((o) => intersection(o?.AITag, activeAITag).length)\n      ?.map((o) => o?.id ?? \"\");\n  } else {\n    return orderedIds;\n  }\n}\n\nexport function getAITags() {\n  const global = getGlobal();\n  const allAiChatFolders = global?.chatFolders?.aiChatFolders?.list;\n\n  return (\n    uniq(\n      allAiChatFolders?.filter((o) => o?.AITag?.length)?.flatMap((o) => o?.AITag)\n    ) ?? []\n  );\n}\n","import { addExtraClass } from '../../lib/teact/teact-dom';\n\nimport { requestMutation } from '../../lib/fasterdom/fasterdom';\nimport { removeVS16s } from '../../lib/twemojiRegex';\nimport withCache from '../withCache';\n\n// Due to the fact that emoji from Apple do not contain some characters, it is necessary to remove them from emoji-data\n// https://github.com/iamcal/emoji-data/issues/136\nconst EXCLUDE_EMOJIS = ['female_sign', 'male_sign', 'medical_symbol'];\n\nconst ISO_FLAGS_OFFSET = 127397;\n\nexport type EmojiRawData = typeof import('emoji-data-ios/emoji-data.json');\nexport type EmojiModule = { default: EmojiRawData };\n\nexport type EmojiData = {\n  categories: Array<EmojiCategory>;\n  emojis: Record<string, Emoji>;\n};\n\nfunction unifiedToNative(unified: string) {\n  const unicodes = unified.split('-');\n  const codePoints = unicodes.map((i) => parseInt(i, 16));\n\n  return String.fromCodePoint(...codePoints);\n}\n\nexport const LOADED_EMOJIS = new Set<string>();\n\nexport function handleEmojiLoad(event: React.SyntheticEvent<HTMLImageElement>) {\n  const emoji = event.currentTarget;\n\n  LOADED_EMOJIS.add(event.currentTarget.dataset.path!);\n\n  requestMutation(() => {\n    addExtraClass(emoji, 'open');\n  });\n}\n\nexport function nativeToUnified(emoji: string) {\n  let code;\n\n  if (emoji.length === 1) {\n    code = emoji.charCodeAt(0).toString(16).padStart(4, '0');\n  } else {\n    const pairs = [];\n    for (let i = 0; i < emoji.length; i++) {\n      if (emoji.charCodeAt(i) >= 0xd800 && emoji.charCodeAt(i) <= 0xdbff) {\n        if (emoji.charCodeAt(i + 1) >= 0xdc00 && emoji.charCodeAt(i + 1) <= 0xdfff) {\n          pairs.push(\n            (emoji.charCodeAt(i) - 0xd800) * 0x400\n            + (emoji.charCodeAt(i + 1) - 0xdc00) + 0x10000,\n          );\n        }\n      } else if (emoji.charCodeAt(i) < 0xd800 || emoji.charCodeAt(i) > 0xdfff) {\n        pairs.push(emoji.charCodeAt(i));\n      }\n    }\n\n    code = pairs.map((x) => x.toString(16).padStart(4, '0')).join('-');\n  }\n\n  return code;\n}\n\nfunction nativeToUnifiedExtended(emoji: string) {\n  return nativeToUnified(removeVS16s(emoji));\n}\n\nexport const nativeToUnifiedExtendedWithCache = withCache(nativeToUnifiedExtended);\n\nexport function uncompressEmoji(data: EmojiRawData): EmojiData {\n  const emojiData: EmojiData = { categories: [], emojis: {} };\n\n  for (let i = 0; i < data.length; i += 2) {\n    const category = {\n      id: data[i][0],\n      name: data[i][1],\n      emojis: [],\n    } as EmojiCategory;\n\n    for (let j = 0; j < data[i + 1].length; j++) {\n      const emojiRaw = data[i + 1][j];\n      if (!EXCLUDE_EMOJIS.includes(emojiRaw[1][0])) {\n        category.emojis.push(emojiRaw[1][0]);\n        emojiData.emojis[emojiRaw[1][0]] = {\n          id: emojiRaw[1][0],\n          names: emojiRaw[1] as string[],\n          native: unifiedToNative(emojiRaw[0] as string),\n          image: (emojiRaw[0] as string).toLowerCase(),\n        };\n      }\n    }\n\n    emojiData.categories.push(category);\n  }\n\n  return emojiData;\n}\n\nexport function isoToEmoji(iso: string) {\n  // Special case for Fragment numbers\n  if (iso === 'FT') {\n    return '\\uD83C\\uDFF4\\u200D\\u2620\\uFE0F';\n  }\n\n  const code = iso.toUpperCase();\n\n  if (!/^[A-Z]{2}$/.test(code)) return iso;\n  const codePoints = [...code].map((c) => c.codePointAt(0)! + ISO_FLAGS_OFFSET);\n  return String.fromCodePoint(...codePoints);\n}\n","type HandlerName =\n  'onEnter'\n  | 'onBackspace'\n  | 'onDelete'\n  | 'onEsc'\n  | 'onUp'\n  | 'onDown'\n  | 'onLeft'\n  | 'onRight'\n  | 'onTab';\ntype Handler = (e: KeyboardEvent) => void | boolean;\ntype CaptureOptions = Partial<Record<HandlerName, Handler>>;\n\nconst keyToHandlerName: Record<string, HandlerName> = {\n  Enter: 'onEnter',\n  Backspace: 'onBackspace',\n  Delete: 'onDelete',\n  Esc: 'onEsc',\n  Escape: 'onEsc',\n  ArrowUp: 'onUp',\n  ArrowDown: 'onDown',\n  ArrowLeft: 'onLeft',\n  ArrowRight: 'onRight',\n  Tab: 'onTab',\n};\n\nconst handlers: Record<HandlerName, Handler[]> = {\n  onEnter: [],\n  onDelete: [],\n  onBackspace: [],\n  onEsc: [],\n  onUp: [],\n  onDown: [],\n  onLeft: [],\n  onRight: [],\n  onTab: [],\n};\n\nexport default function captureKeyboardListeners(options: CaptureOptions) {\n  if (!hasActiveHandlers()) {\n    document.addEventListener('keydown', handleKeyDown, true);\n  }\n\n  (Object.keys(options) as Array<HandlerName>).forEach((handlerName) => {\n    const handler = options[handlerName];\n    if (!handler) {\n      return;\n    }\n\n    const currentEventHandlers = handlers[handlerName];\n    if (currentEventHandlers) {\n      currentEventHandlers.push(handler);\n    }\n  });\n\n  return () => {\n    releaseKeyboardListener(options);\n  };\n}\n\nfunction hasActiveHandlers() {\n  return Object.values(handlers).some((keyHandlers) => Boolean(keyHandlers.length));\n}\n\nfunction handleKeyDown(e: KeyboardEvent) {\n  const handlerName = keyToHandlerName[e.key];\n  if (!handlerName) {\n    return;\n  }\n\n  const { length } = handlers[handlerName];\n  if (!length) {\n    return;\n  }\n\n  for (let i = length - 1; i >= 0; i--) {\n    const handler = handlers[handlerName][i]!;\n    if (handler(e) !== false) {\n      e.stopPropagation();\n      break;\n    }\n  }\n}\n\nfunction releaseKeyboardListener(options: CaptureOptions) {\n  (Object.keys(options) as Array<HandlerName>).forEach((handlerName) => {\n    const handler = options[handlerName];\n    const currentEventHandlers = handlers[handlerName];\n    if (currentEventHandlers) {\n      const index = currentEventHandlers.findIndex((cb) => cb === handler);\n      if (index !== -1) {\n        currentEventHandlers.splice(index, 1);\n      }\n    }\n  });\n\n  if (!hasActiveHandlers()) {\n    document.removeEventListener('keydown', handleKeyDown, false);\n  }\n}\n","/* eslint-disable no-console */\n// utils/analytics.ts\n\nimport { getGlobal } from '../../../global';\n\nimport { getUserFullName } from '../../../global/helpers';\nimport { selectUser } from '../../../global/selectors';\n\nexport const sendGAEvent = (\n  eventName: string,\n  params?: Record<string, any>,\n): void => {\n  if (typeof window !== 'undefined' && typeof (window as any).gtag === 'function') {\n    const global = getGlobal();\n    const { currentUserId } = global;\n    const user = selectUser(global, currentUserId!);\n    const name = getUserFullName(user);\n    params = {\n      ...params,\n      userId: currentUserId,\n      name,\n    };\n    (window as any).gtag('event', eventName, params || {});\n  } else {\n    console.warn('gtag is not defined');\n  }\n};\n","import React, { memo } from '../../lib/teact/teact';\n\nimport buildClassName from '../../util/buildClassName';\n\nimport Spinner from './Spinner';\n\nimport './Loading.scss';\n\ntype OwnProps = {\n  color?: 'blue' | 'white' | 'black' | 'yellow';\n  backgroundColor?: 'light' | 'dark';\n  className?: string;\n  onClick?: NoneToVoidFunction;\n};\n\nconst Loading = ({\n  color = 'blue', backgroundColor, className, onClick,\n}: OwnProps) => {\n  return (\n    <div className={buildClassName('Loading', onClick && 'interactive', className)} onClick={onClick}>\n      <Spinner color={color} backgroundColor={backgroundColor} />\n    </div>\n  );\n};\n\nexport default memo(Loading);\n","import type React from '../../../lib/teact/teact';\n\nimport { EDITABLE_INPUT_ID } from '../../../config';\nimport { IS_IOS } from '../../../util/browser/windowEnvironment';\n\nexport function preventMessageInputBlur(e: React.MouseEvent<HTMLElement>, withBubbling = false) {\n  if (\n    IS_IOS\n    || !document.activeElement\n    || document.activeElement.id !== EDITABLE_INPUT_ID\n    || (!withBubbling && e.target !== e.currentTarget)\n  ) {\n    return;\n  }\n\n  e.preventDefault();\n}\n\nexport function preventMessageInputBlurWithBubbling(e: React.MouseEvent<HTMLElement>) {\n  preventMessageInputBlur(e, true);\n}\n","import { getActions } from '../global';\n\nimport type { ApiChatType, ApiFormattedText } from '../api/types';\nimport type { DeepLinkMethod } from './deepLinkParser';\n\nimport { API_CHAT_TYPES, RE_TG_LINK } from '../config';\nimport { IS_BAD_URL_PARSER } from './browser/globalEnvironment';\nimport { tryParseDeepLink } from './deepLinkParser';\n\nexport const processDeepLink = (url: string): boolean => {\n  const actions = getActions();\n\n  const parsedLink = tryParseDeepLink(url);\n  if (parsedLink) {\n    switch (parsedLink.type) {\n      case 'privateMessageLink':\n        actions.openPrivateChannel({\n          id: parsedLink.channelId,\n          threadId: parsedLink.threadId,\n          messageId: parsedLink.messageId,\n          commentId: parsedLink.commentId,\n          timestamp: parsedLink.timestamp,\n        });\n        return true;\n      case 'publicMessageLink': {\n        actions.openChatByUsername({\n          username: parsedLink.username,\n          threadId: parsedLink.threadId,\n          messageId: parsedLink.messageId,\n          commentId: parsedLink.commentId,\n          timestamp: parsedLink.timestamp,\n        });\n        return true;\n      }\n      case 'publicUsernameOrBotLink': {\n        const choose = parseChooseParameter(parsedLink.choose);\n\n        actions.openChatByUsername({\n          username: parsedLink.username,\n          startParam: parsedLink.start,\n          ref: parsedLink.ref,\n          text: parsedLink.text,\n          startApp: parsedLink.startApp,\n          mode: parsedLink.mode,\n          startAttach: parsedLink.startAttach,\n          attach: parsedLink.attach,\n          choose,\n          originalParts: [parsedLink.username, parsedLink.appName],\n        });\n        return true;\n      }\n      case 'privateChannelLink': {\n        actions.openPrivateChannel({\n          id: parsedLink.channelId,\n        });\n        return true;\n      }\n      case 'businessChatLink':\n        actions.resolveBusinessChatLink({\n          slug: parsedLink.slug,\n        });\n        return true;\n      case 'premiumReferrerLink':\n        actions.openPremiumModal();\n        return true;\n      case 'premiumMultigiftLink':\n        actions.openGiftRecipientPicker();\n        return true;\n      case 'chatBoostLink':\n        actions.processBoostParameters({\n          usernameOrId: (parsedLink.username || parsedLink.id)!,\n          isPrivate: Boolean(parsedLink.id),\n        });\n        return true;\n      case 'giftUniqueLink':\n        actions.openUniqueGiftBySlug({ slug: parsedLink.slug });\n        return true;\n      default:\n        break;\n    }\n  }\n\n  if (!url.match(RE_TG_LINK)) {\n    return false;\n  }\n\n  const urlToParse = IS_BAD_URL_PARSER ? url.replace(/^tg:\\/\\//, 'https://') : url;\n\n  const {\n    protocol, searchParams, hostname,\n  } = new URL(urlToParse);\n\n  if (protocol !== 'tg:') return false;\n\n  const method = hostname as DeepLinkMethod;\n  const params = Object.fromEntries(searchParams);\n\n  const {\n    checkChatInvite,\n    openChatByUsername,\n    openChatByPhoneNumber,\n    openStickerSet,\n    joinVoiceChatByLink,\n    openInvoice,\n    openChatWithDraft,\n    checkChatlistInvite,\n    openStoryViewerByUsername,\n    checkGiftCode,\n    openStarsBalanceModal,\n  } = actions;\n\n  switch (method) {\n    case 'resolve': {\n      const {\n        domain, phone, post, comment, voicechat, livestream, start, startattach, attach, thread, topic,\n        appname, startapp, mode, story, text,\n      } = params;\n\n      const threadId = Number(thread) || Number(topic) || undefined;\n\n      if (domain !== 'telegrampassport') {\n        if (appname) {\n          openChatByUsername({\n            username: domain,\n            startApp: startapp,\n            mode,\n            originalParts: [domain, appname],\n            text,\n          });\n        } else if (params.hasOwnProperty('voicechat') || params.hasOwnProperty('livestream')) {\n          joinVoiceChatByLink({\n            username: domain,\n            inviteHash: voicechat || livestream,\n          });\n        } else if (phone) {\n          openChatByPhoneNumber({\n            phoneNumber: phone,\n            startAttach: startattach,\n            attach,\n            text,\n          });\n        } else if (story) {\n          openStoryViewerByUsername({ username: domain, storyId: Number(story) });\n        } else {\n          openChatByUsername({\n            username: domain,\n            messageId: post ? Number(post) : undefined,\n            commentId: comment ? Number(comment) : undefined,\n            startParam: start,\n            mode,\n            startAttach: startattach,\n            attach,\n            threadId,\n          });\n        }\n      }\n      break;\n    }\n    case 'bg': {\n      // const {\n      //   slug, color, rotation, mode, intensity, bg_color: bgColor, gradient,\n      // } = params;\n      break;\n    }\n    case 'join': {\n      const { invite } = params;\n\n      checkChatInvite({ hash: invite });\n      break;\n    }\n    case 'addemoji':\n    case 'addstickers': {\n      const { set } = params;\n\n      openStickerSet({\n        stickerSetInfo: {\n          shortName: set,\n        },\n      });\n      break;\n    }\n    case 'share':\n    case 'msg':\n    case 'msg_url': {\n      const { url: urlParam, text } = params;\n      openChatWithDraft({ text: formatShareText(urlParam, text) });\n      break;\n    }\n    case 'addlist': {\n      checkChatlistInvite({ slug: params.slug });\n      break;\n    }\n\n    case 'login': {\n      // const { code, token } = params;\n      break;\n    }\n\n    case 'invoice': {\n      const { slug } = params;\n      openInvoice({ type: 'slug', slug });\n      break;\n    }\n\n    case 'stars_topup': {\n      const { balance, purpose } = params;\n      const balanceNeeded = Number(balance);\n      if (!balanceNeeded || balanceNeeded < 0) return true;\n\n      openStarsBalanceModal({ topup: { balanceNeeded, purpose } });\n      break;\n    }\n\n    case 'giftcode': {\n      const { slug } = params;\n      checkGiftCode({ slug });\n      break;\n    }\n    default:\n      // Unsupported deeplink\n      return false;\n  }\n  return true;\n};\n\nexport function formatShareText(url?: string, text?: string, title?: string): ApiFormattedText {\n  return {\n    text: [url, title, text].filter(Boolean).join('\\n'),\n  };\n}\n\nfunction parseChooseParameter(choose?: string) {\n  if (!choose) return undefined;\n  const types = choose.toLowerCase().split(' ').flatMap((type) => {\n    if (type === 'groups') {\n      return ['chats', 'groups'];\n    }\n    return [type];\n  });\n  return types.filter((type): type is ApiChatType => API_CHAT_TYPES.includes(type as ApiChatType));\n}\n","import { addCallback, removeCallback } from '../../lib/teact/teactn';\n\nimport type { SharedState } from '../types';\nimport type { ClientBoundMessageEvent } from './sharedState.worker';\n\nimport { APP_NAME } from '../../config';\nimport { deepDiff, type DiffObject } from '../../util/deepDiff';\nimport { deepMerge } from '../../util/deepMerge';\nimport { throttleWithTickEnd } from '../../util/schedulers';\nimport { INITIAL_SHARED_STATE } from '../initialState';\nimport { getGlobal, setGlobal } from '..';\n\ninterface GetFullStateEvent {\n  type: 'reqGetFullState';\n  localState: SharedState;\n}\n\ninterface UpdateStateEvent {\n  type: 'reqUpdateState';\n  update: DiffObject<SharedState>;\n}\n\nexport type WorkerBoundMessageEvent = GetFullStateEvent | UpdateStateEvent;\n\nlet sharedWorker: SharedWorker | undefined;\n\n// Tracks if the client has been synced with the shared state.\nlet synced = false;\nlet lastSharedState: SharedState = INITIAL_SHARED_STATE;\n\nexport function initSharedState(localState: SharedState) {\n  sharedWorker = new SharedWorker(new URL('./sharedState.worker.ts', import.meta.url), { name: APP_NAME });\n\n  sharedWorker.port.addEventListener('message', onMessage);\n  sharedWorker.port.start();\n\n  sendToWorker({ type: 'reqGetFullState', localState });\n\n  addCallback(onGlobalChange);\n}\n\nfunction onGlobalChange() {\n  const global = getGlobal();\n  if (global.sharedState === lastSharedState) return;\n  if (global.sharedState.isInitial) return;\n\n  updateSharedState(global.sharedState);\n}\n\nfunction onMessage(event: MessageEvent<ClientBoundMessageEvent>) {\n  const data = event.data;\n  switch (data.type) {\n    case 'stateUpdate': {\n      const state = deepMerge(lastSharedState, data.update);\n      updateGlobal(state);\n      break;\n    }\n    case 'fullState':\n      synced = true;\n      updateGlobal(data.state);\n      break;\n  }\n}\n\nexport function destroySharedStatePort() {\n  if (!sharedWorker) return;\n  sharedWorker.port.removeEventListener('message', onMessage);\n  sharedWorker.port.close();\n  sharedWorker = undefined;\n  removeCallback(onGlobalChange);\n}\n\nfunction updateSharedState(update: SharedState) {\n  if (!synced) return;\n  const diff = deepDiff(lastSharedState, update);\n  lastSharedState = update;\n  if (typeof diff === 'symbol') return;\n\n  sendToWorker({ type: 'reqUpdateState', update: diff });\n}\n\nconst scheduledEvents = new Set<WorkerBoundMessageEvent>();\n\nconst sendOnTickEnd = throttleWithTickEnd(() => {\n  if (!sharedWorker) {\n    throw new Error('Shared worker not initialized');\n  }\n\n  for (const event of scheduledEvents) {\n    sharedWorker.port.postMessage(event);\n  }\n  scheduledEvents.clear();\n});\n\nfunction sendToWorker(event: WorkerBoundMessageEvent) {\n  if (!sharedWorker) {\n    throw new Error('Shared worker not initialized');\n  }\n\n  scheduledEvents.add(event);\n  sendOnTickEnd();\n}\n\nfunction updateGlobal(update: Partial<SharedState>) {\n  let global = getGlobal();\n  lastSharedState = {\n    ...global.sharedState,\n    ...update,\n  };\n\n  global = {\n    ...global,\n    sharedState: lastSharedState,\n  };\n  setGlobal(global);\n}\n","import type { MoveOffsets } from './captureEvents';\n\nimport { requestMeasure, requestMutation } from '../lib/fasterdom/fasterdom';\nimport { IS_IOS } from './browser/windowEnvironment';\nimport { animateNumber, timingFunctions } from './animation';\nimport { captureEvents, SwipeDirection } from './captureEvents';\nimport { waitForAnimationEnd } from './cssAnimationEndListeners';\nimport { clamp } from './math';\n\nconst INERTIA_DURATION = 300;\nconst INERTIA_EASING = timingFunctions.easeOutCubic;\n\nlet isSwipeActive = false;\nlet swipeOffsets: MoveOffsets | undefined;\nlet onDrag: ((offsets: MoveOffsets) => void) | undefined;\nlet onRelease: ((onCancel: NoneToVoidFunction) => void) | undefined;\nlet cancelCurrentReleaseAnimation: NoneToVoidFunction | undefined;\n\nexport function captureControlledSwipe(\n  element: HTMLElement, options: {\n    excludedClosestSelector?: string;\n    selectorToPreventScroll?: string;\n    onSwipeLeftStart?: NoneToVoidFunction;\n    onSwipeRightStart?: NoneToVoidFunction;\n    onCancel: NoneToVoidFunction;\n  },\n) {\n  return captureEvents(element, {\n    excludedClosestSelector: options.excludedClosestSelector,\n    selectorToPreventScroll: options.selectorToPreventScroll,\n    swipeThreshold: 10,\n\n    onSwipe(e, direction, offsets) {\n      if (direction === SwipeDirection.Left) {\n        options.onSwipeLeftStart?.();\n      } else if (direction === SwipeDirection.Right) {\n        options.onSwipeRightStart?.();\n      } else {\n        return false;\n      }\n\n      if (IS_IOS) {\n        isSwipeActive = true;\n        swipeOffsets = offsets;\n      }\n\n      return true;\n    },\n\n    onDrag(e, captureEvent, offsets) {\n      if (!isSwipeActive) return;\n\n      onDrag?.(offsets);\n    },\n\n    onRelease() {\n      if (!isSwipeActive) return;\n\n      isSwipeActive = false;\n\n      onRelease?.(options.onCancel);\n\n      onDrag = undefined;\n      onRelease = undefined;\n    },\n  });\n}\n\nexport function allowSwipeControlForTransition(\n  currentSlide: HTMLElement,\n  nextSlide: HTMLElement,\n  onCancelForTransition: NoneToVoidFunction,\n) {\n  cancelCurrentReleaseAnimation?.();\n\n  if (!isSwipeActive) return;\n\n  const targetPosition = extractAnimationEndPosition(currentSlide);\n  if (!targetPosition) return;\n\n  currentSlide.getAnimations().forEach((a) => a.pause());\n  nextSlide.getAnimations().forEach((a) => a.pause());\n\n  currentSlide.style.animationTimingFunction = 'linear';\n  nextSlide.style.animationTimingFunction = 'linear';\n\n  let currentDirection: 1 | -1 | undefined;\n\n  requestMeasure(() => {\n    const computedStyle = getComputedStyle(currentSlide);\n    const initialPositionPx = extractPositionFromMatrix(computedStyle.transform, targetPosition.axis);\n    const targetPositionPx = targetPosition.units === 'px'\n      ? targetPosition.value\n      : ((targetPosition.value / 100) * (\n        targetPosition.axis === 'X' ? currentSlide.offsetWidth : currentSlide.offsetHeight\n      ));\n    const distance = targetPositionPx - initialPositionPx;\n\n    let progress = 0;\n\n    onDrag = ({ dragOffsetX, dragOffsetY }) => {\n      const dragOffset = targetPosition.axis === 'X'\n        ? dragOffsetX - swipeOffsets!.dragOffsetX\n        : dragOffsetY - swipeOffsets!.dragOffsetY;\n\n      const newProgress = clamp(dragOffset / distance, 0, 1);\n      currentDirection = newProgress > progress ? 1 : -1;\n      progress = newProgress;\n\n      updateAnimationProgress([currentSlide, nextSlide], progress);\n    };\n\n    onRelease = (onCancelForClient: NoneToVoidFunction) => {\n      const isRevertSwipe = currentDirection === -1;\n\n      function cleanup() {\n        currentSlide.getAnimations().forEach((a) => a.cancel());\n        nextSlide.getAnimations().forEach((a) => a.cancel());\n\n        requestMutation(() => {\n          currentSlide.style.animationTimingFunction = '';\n          nextSlide.style.animationTimingFunction = '';\n        });\n      }\n\n      if (!isRevertSwipe) {\n        // For some reason animations are not cleared when CSS class is removed\n        waitForAnimationEnd(currentSlide, cleanup);\n      }\n\n      cancelCurrentReleaseAnimation = animateNumber({\n        from: progress,\n        to: isRevertSwipe ? 0 : 1,\n        duration: INERTIA_DURATION,\n        timing: INERTIA_EASING,\n        onUpdate(releaseProgress) {\n          updateAnimationProgress([currentSlide, nextSlide], releaseProgress);\n        },\n        onEnd(isCanceled = false) {\n          cancelCurrentReleaseAnimation = undefined;\n\n          if (isCanceled || isRevertSwipe) {\n            cleanup();\n            onCancelForTransition();\n            onCancelForClient();\n          }\n        },\n      });\n    };\n  });\n}\n\nfunction updateAnimationProgress(elements: HTMLElement[], progress: number) {\n  elements.map((e) => e.getAnimations()).flat().forEach((animation) => {\n    animation.currentTime = (animation.effect!.getTiming().duration as number) * progress;\n  });\n}\n\nfunction extractAnimationEndPosition(element: HTMLElement) {\n  for (const animation of element.getAnimations()) {\n    if (!(animation.effect instanceof KeyframeEffect)) continue;\n\n    for (const keyframe of animation.effect.getKeyframes()) {\n      if (keyframe.offset !== 1 || !keyframe.transform) continue;\n\n      const position = extractPositionFromTransform(keyframe.transform as string);\n      if (position) {\n        return position;\n      }\n    }\n  }\n\n  return undefined;\n}\n\nfunction extractPositionFromTransform(transformRule: string) {\n  const match = transformRule.match(/([XY])\\((-?\\d+)(%|px)\\)/);\n  if (!match) return undefined;\n\n  return {\n    axis: match[1] as 'X' | 'Y',\n    value: Number(match[2]),\n    units: match[3],\n  };\n}\n\nfunction extractPositionFromMatrix(transform: string, axis: 'X' | 'Y') {\n  const matrix = transform.slice(7, -1).split(',').map(Number);\n  return matrix[axis === 'X' ? 4 : 5];\n}\n","import type { TeactNode } from '../../../lib/teact/teact';\nimport React from '../../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../../global';\n\nimport type { ApiPeer } from '../../../api/types';\nimport { ApiMessageEntityTypes } from '../../../api/types';\n\nimport { selectUser } from '../../../global/selectors';\n\nimport useAppLayout from '../../../hooks/useAppLayout';\n\ntype OwnProps = {\n  userId?: string;\n  username?: string;\n  children: TeactNode;\n};\n\ntype StateProps = {\n  userOrChat?: ApiPeer;\n};\n\nconst MentionLink = ({\n  userId,\n  username,\n  userOrChat,\n  children,\n}: OwnProps & StateProps) => {\n  const {\n    openChat,\n    openChatByUsername,\n    closeStoryViewer,\n    setShouldCloseRightColumn,\n  } = getActions();\n\n  const { isMobile } = useAppLayout();\n\n  const handleClick = () => {\n    if (isMobile) {\n      setShouldCloseRightColumn({\n        value: true,\n      });\n    }\n\n    if (userOrChat) {\n      openChat({ id: userOrChat.id });\n    } else if (username) {\n      closeStoryViewer();\n      openChatByUsername({ username: username.substring(1) });\n    }\n  };\n\n  return (\n    <a\n      onClick={handleClick}\n      className=\"text-entity-link\"\n      dir=\"auto\"\n      data-entity-type={userId ? ApiMessageEntityTypes.MentionName : ApiMessageEntityTypes.Mention}\n    >\n      {children}\n    </a>\n  );\n};\n\nexport default withGlobal<OwnProps>(\n  (global, { userId }): StateProps => {\n    return {\n      userOrChat: userId ? selectUser(global, userId) : undefined,\n    };\n  },\n)(MentionLink);\n","import { useEffect, useState } from '../lib/teact/teact';\n\nconst useAsync = <T>(fn: () => Promise<T>, deps: any[], defaultValue?: T) => {\n  const [isLoading, setIsLoading] = useState<boolean>(false);\n  const [error, setError] = useState<Error | undefined>();\n  const [result, setResult] = useState<T | undefined>(defaultValue);\n  useEffect(() => {\n    setIsLoading(true);\n    let wasCancelled = false;\n    fn().then((res) => {\n      if (wasCancelled) return;\n      setIsLoading(false);\n      setResult(res);\n    }, (err) => {\n      if (wasCancelled) return;\n      setIsLoading(false);\n      setError(err);\n    });\n    return () => {\n      wasCancelled = true;\n    };\n  // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  }, deps);\n  return { isLoading, error, result };\n};\n\nexport default useAsync;\n","import type { ApiMessage } from '../../api/types';\n\nexport type SearchResultKey = `${string}_${number}`;\n\nexport function getSearchResultKey(message: ApiMessage): SearchResultKey {\n  const { chatId, id } = message;\n\n  return `${chatId}_${id}`;\n}\n\nexport function parseSearchResultKey(key: SearchResultKey) {\n  const [chatId, messageId] = key.split('_');\n\n  return [chatId, Number(messageId)] as const;\n}\n","import { getGlobal } from '../../../global';\n\nimport eventEmitter, { Actions } from '../lib/EventEmitter';\nimport { selectCurrentChat } from '../../../global/selectors';\nimport { GLOBAL_SUMMARY_CHATID } from '../variables';\n\nexport default class GlobalSummaryBadge {\n  static chatId = GLOBAL_SUMMARY_CHATID;\n\n  public static updateRoomData(type: string, value: any) {\n    const chatId = this.chatId;\n    const roomAIData = localStorage.getItem('room-ai-data');\n    const parsedData = roomAIData ? JSON.parse(roomAIData) : {};\n    const currentData = parsedData[chatId] || {};\n    currentData[type] = value;\n    parsedData[chatId] = currentData;\n    localStorage.setItem('room-ai-data', JSON.stringify(parsedData));\n    if (type === 'unreadCount') {\n      eventEmitter.emit(Actions.UpdateRoomAIUnreadCount, {\n        chatId,\n        count: value,\n      });\n    }\n  }\n\n  public static getUnreadCount() {\n    const roomAIData = localStorage.getItem('room-ai-data');\n    return roomAIData\n      ? JSON.parse(roomAIData)?.[this.chatId]?.unreadCount || 0\n      : 0;\n  }\n\n  public static increaseUnreadCount() {\n    const global = getGlobal();\n    const chat = selectCurrentChat(global);\n    if (chat?.id !== this.chatId) {\n      const count = this.getUnreadCount() + 1;\n      this.updateRoomData('unreadCount', count);\n    }\n  }\n}\n","import type { FC } from '../../lib/teact/teact';\nimport React from '../../lib/teact/teact';\n\nimport buildClassName from '../../util/buildClassName';\n\nimport './Spinner.scss';\n\nconst Spinner: FC<{\n  color?: 'blue' | 'white' | 'black' | 'green' | 'gray' | 'yellow';\n  backgroundColor?: 'light' | 'dark';\n  className?: string;\n}> = ({\n  color = 'blue',\n  backgroundColor,\n  className,\n}) => {\n  return (\n    <div className={buildClassName(\n      'Spinner', className, color, backgroundColor && 'with-background', backgroundColor && `bg-${backgroundColor}`,\n    )}\n    >\n      <div className=\"Spinner__inner\" />\n    </div>\n  );\n};\n\nexport default Spinner;\n","import type { RefObject } from 'react';\nimport {\n  useEffect, useLayoutEffect, useRef, useState,\n} from '../../lib/teact/teact';\n\nimport { requestForcedReflow, requestMeasure, requestMutation } from '../../lib/fasterdom/fasterdom';\nimport calcTextLineHeightAndCount from '../../util/element/calcTextLineHeightAndCount';\nimport useDebouncedCallback from '../useDebouncedCallback';\nimport useLastCallback from '../useLastCallback';\nimport useWindowSize from '../window/useWindowSize';\n\nconst WINDOW_RESIZE_LINE_RECALC_DEBOUNCE = 200;\n\nexport default function useCollapsibleLines<T extends HTMLElement, C extends HTMLElement>(\n  ref: RefObject<T>,\n  maxLinesBeforeCollapse: number,\n  cutoutRef?: RefObject<C>,\n  isDisabled?: boolean,\n) {\n  const isFirstRenderRef = useRef(true);\n  const cutoutHeightRef = useRef<number | undefined>();\n  const [isCollapsible, setIsCollapsible] = useState(!isDisabled);\n  const [isCollapsed, setIsCollapsed] = useState(isCollapsible);\n\n  useLayoutEffect(() => {\n    const element = (cutoutRef || ref).current;\n    if (isDisabled || !element || isFirstRenderRef.current) return;\n\n    requestMutation(() => {\n      element.style.maxHeight = isCollapsed ? `${cutoutHeightRef.current}px` : '';\n    });\n  }, [cutoutRef, isCollapsed, isDisabled, ref]);\n\n  const recalculateTextLines = useLastCallback(() => {\n    if (isDisabled || !ref.current) {\n      return;\n    }\n    const element = ref.current;\n\n    const { lineHeight, totalLines } = calcTextLineHeightAndCount(element);\n    if (totalLines > maxLinesBeforeCollapse) {\n      cutoutHeightRef.current = lineHeight * maxLinesBeforeCollapse;\n      setIsCollapsible(true);\n    } else {\n      setIsCollapsible(false);\n      setIsCollapsed(false);\n    }\n  });\n\n  const debouncedRecalcTextLines = useDebouncedCallback(\n    () => requestMeasure(recalculateTextLines),\n    [recalculateTextLines],\n    WINDOW_RESIZE_LINE_RECALC_DEBOUNCE,\n  );\n\n  useLayoutEffect(() => {\n    if (!isDisabled && isFirstRenderRef.current) {\n      requestForcedReflow(() => {\n        recalculateTextLines();\n\n        return () => {\n          isFirstRenderRef.current = false;\n          const element = (cutoutRef || ref).current;\n          if (!element) return;\n          element.style.maxHeight = cutoutHeightRef.current ? `${cutoutHeightRef.current}px` : '';\n        };\n      });\n    }\n  }, [cutoutRef, isDisabled, recalculateTextLines, ref]);\n\n  // Parent resize is triggered on every collapse/expand, so we do recalculation only on window resize to save resources\n  const { width: windowWidth } = useWindowSize();\n  useEffect(() => {\n    if (!isDisabled) {\n      if (isFirstRenderRef.current) return;\n\n      debouncedRecalcTextLines();\n    } else {\n      setIsCollapsible(false);\n      setIsCollapsed(false);\n    }\n  }, [debouncedRecalcTextLines, isDisabled, windowWidth]);\n\n  return {\n    isCollapsed,\n    isCollapsible,\n    setIsCollapsed,\n  };\n}\n","import type { ApiSessionData } from '../api/types';\nimport type { DcId, SharedSessionData } from '../types';\n\nimport {\n  DC_IDS,\n  DEBUG, IS_SCREEN_LOCKED_CACHE_KEY,\n  SESSION_ACCOUNT_PREFIX,\n  SESSION_LEGACY_USER_KEY,\n} from '../config';\nimport { ACCOUNT_SLOT, storeAccountData, writeSlotSession } from './multiaccount';\n\nexport function hasStoredSession() {\n  if (checkSessionLocked()) {\n    return true;\n  }\n\n  const slotData = loadSlotSession(ACCOUNT_SLOT);\n  if (slotData) return Boolean(slotData.dcId);\n\n  if (!ACCOUNT_SLOT) {\n    const legacyAuthJson = localStorage.getItem(SESSION_LEGACY_USER_KEY);\n    if (legacyAuthJson) {\n      try {\n        const userAuth = JSON.parse(legacyAuthJson);\n        return Boolean(userAuth && userAuth.id && userAuth.dcID);\n      } catch (err) {\n        // Do nothing.\n        return false;\n      }\n    }\n  }\n\n  return false;\n}\n\nexport function storeSession(sessionData: ApiSessionData) {\n  const {\n    mainDcId, keys, isTest,\n  } = sessionData;\n\n  const currentSlotData = loadSlotSession(ACCOUNT_SLOT);\n  const newSlotData: SharedSessionData = {\n    ...currentSlotData,\n    dcId: mainDcId,\n    isTest,\n  };\n\n  Object.keys(keys).map(Number).forEach((dcId) => {\n    newSlotData[`dc${dcId as DcId}_auth_key`] = keys[dcId];\n  });\n\n  if (!ACCOUNT_SLOT) {\n    storeLegacySession(sessionData, currentSlotData?.userId);\n  }\n\n  writeSlotSession(ACCOUNT_SLOT, newSlotData);\n}\n\nfunction storeLegacySession(sessionData: ApiSessionData, currentUserId?: string) {\n  const {\n    mainDcId, keys, isTest,\n  } = sessionData;\n\n  localStorage.setItem(SESSION_LEGACY_USER_KEY, JSON.stringify({\n    dcID: mainDcId,\n    id: currentUserId,\n    test: isTest,\n  }));\n  localStorage.setItem('dc', String(mainDcId));\n  Object.keys(keys).map(Number).forEach((dcId) => {\n    localStorage.setItem(`dc${dcId}_auth_key`, JSON.stringify(keys[dcId]));\n  });\n}\n\nexport function clearStoredSession(slot?: number) {\n  if (!slot) {\n    clearStoredLegacySession();\n  }\n\n  localStorage.removeItem(`${SESSION_ACCOUNT_PREFIX}${slot || 1}`);\n}\n\nfunction clearStoredLegacySession() {\n  [\n    SESSION_LEGACY_USER_KEY,\n    'dc',\n    ...DC_IDS.map((dcId) => `dc${dcId}_auth_key`),\n    ...DC_IDS.map((dcId) => `dc${dcId}_hash`),\n    ...DC_IDS.map((dcId) => `dc${dcId}_server_salt`),\n  ].forEach((key) => {\n    localStorage.removeItem(key);\n  });\n}\n\nexport function loadStoredSession(): ApiSessionData | undefined {\n  if (!hasStoredSession()) {\n    return undefined;\n  }\n\n  const slotData = loadSlotSession(ACCOUNT_SLOT);\n\n  if (!slotData) {\n    if (ACCOUNT_SLOT) return undefined;\n    return loadStoredLegacySession();\n  }\n\n  const sessionData: ApiSessionData = {\n    mainDcId: slotData.dcId,\n    keys: DC_IDS.reduce((acc, dcId) => {\n      const key = slotData[`dc${dcId}_auth_key` as const];\n      if (key) {\n        acc[dcId] = key;\n      }\n      return acc;\n    }, {} as Record<number, string>),\n    isTest: slotData.isTest || undefined,\n  };\n\n  return sessionData;\n}\n\nfunction loadStoredLegacySession(): ApiSessionData | undefined {\n  if (!hasStoredSession()) {\n    return undefined;\n  }\n\n  const userAuth = JSON.parse(localStorage.getItem(SESSION_LEGACY_USER_KEY) || 'null');\n  if (!userAuth) {\n    return undefined;\n  }\n  const mainDcId = Number(userAuth.dcID);\n  const isTest = userAuth.test;\n  const keys: Record<number, string> = {};\n\n  DC_IDS.forEach((dcId) => {\n    try {\n      const key = localStorage.getItem(`dc${dcId}_auth_key`);\n      if (key) {\n        keys[dcId] = JSON.parse(key);\n      }\n    } catch (err) {\n      if (DEBUG) {\n        // eslint-disable-next-line no-console\n        console.warn('Failed to load stored session', err);\n      }\n      // Do nothing.\n    }\n  });\n\n  if (!Object.keys(keys).length) return undefined;\n\n  return {\n    mainDcId,\n    keys,\n    isTest,\n  };\n}\n\nexport function loadSlotSession(slot: number | undefined): SharedSessionData | undefined {\n  try {\n    const data = JSON.parse(localStorage.getItem(`${SESSION_ACCOUNT_PREFIX}${slot || 1}`) || '{}') as SharedSessionData;\n    if (!data.dcId) return undefined;\n    return data;\n  } catch (e) {\n    return undefined;\n  }\n}\n\nexport function updateSessionUserId(currentUserId: string) {\n  const slotData = loadSlotSession(ACCOUNT_SLOT);\n  if (!slotData) return;\n  storeAccountData(ACCOUNT_SLOT, { userId: currentUserId });\n}\n\nexport function importTestSession() {\n  const sessionJson = process.env.TEST_SESSION!;\n  try {\n    const sessionData = JSON.parse(sessionJson) as ApiSessionData & { userId: string };\n    storeLegacySession(sessionData, sessionData.userId);\n  } catch (err) {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.warn('Failed to load test session', err);\n    }\n  }\n}\n\nexport function checkSessionLocked() {\n  return localStorage.getItem(IS_SCREEN_LOCKED_CACHE_KEY) === 'true';\n}","const SAMPLE_RATE = 48000;\nconst BIT_DEPTH = 16;\n\nexport async function oggToWav(opusData: Blob): Promise<Blob> {\n  const arrayBuffer = await new Response(opusData).arrayBuffer();\n\n  return new Promise((resolve) => {\n    const typedArray = new Uint8Array(arrayBuffer);\n\n    let decoderWorker: Worker | undefined = new Worker(\n      new URL('opus-recorder/dist/decoderWorker.min.js', import.meta.url),\n    );\n    let wavWorker: Worker | undefined = new Worker(new URL('opus-recorder/dist/waveWorker.min.js', import.meta.url));\n\n    decoderWorker.onmessage = (e) => {\n      // eslint-disable-next-line no-null/no-null\n      if (e.data === null) {\n        // `null` means decoder is finished\n        wavWorker!.postMessage({ command: 'done' });\n      } else {\n        // `e.data` contains decoded buffers as float32 values\n        wavWorker!.postMessage(\n          {\n            command: 'encode',\n            buffers: e.data,\n          },\n          e.data.map(({ buffer }: Float32Array) => buffer),\n        );\n      }\n    };\n\n    wavWorker.onmessage = (e) => {\n      if (e.data.message === 'page') {\n        resolve(new Blob([e.data.page], { type: 'audio/wav' }));\n\n        decoderWorker!.terminate();\n        decoderWorker = undefined;\n        wavWorker!.terminate();\n        wavWorker = undefined;\n      }\n    };\n\n    wavWorker.postMessage({\n      command: 'init',\n      wavBitDepth: BIT_DEPTH,\n      wavSampleRate: SAMPLE_RATE,\n    });\n\n    decoderWorker.postMessage({\n      command: 'init',\n      decoderSampleRate: SAMPLE_RATE,\n      outputBufferSampleRate: SAMPLE_RATE,\n    });\n\n    decoderWorker.postMessage({\n      command: 'decode',\n      pages: typedArray,\n    }, [typedArray.buffer]);\n  });\n}\n","import type {\n  ApiOnProgress,\n  ApiParsedMedia,\n  ApiPreparedMedia,\n} from '../api/types';\nimport {\n  ApiMediaFormat,\n} from '../api/types';\n\nimport {\n  DEBUG, ELECTRON_HOST_URL,\n  IS_PACKAGED_ELECTRON, MEDIA_CACHE_DISABLED, MEDIA_CACHE_NAME, MEDIA_CACHE_NAME_AVATARS,\n} from '../config';\nimport { callApi, cancelApiProgress } from '../api/gramjs';\nimport {\n  IS_OPUS_SUPPORTED, IS_PROGRESSIVE_SUPPORTED,\n} from './browser/windowEnvironment';\nimport * as cacheApi from './cacheApi';\nimport { fetchBlob } from './files';\nimport { ACCOUNT_SLOT } from './multiaccount';\nimport { oggToWav } from './oggToWav';\n\nconst asCacheApiType = {\n  [ApiMediaFormat.BlobUrl]: cacheApi.Type.Blob,\n  [ApiMediaFormat.Text]: cacheApi.Type.Text,\n  [ApiMediaFormat.DownloadUrl]: undefined,\n  [ApiMediaFormat.Progressive]: undefined,\n};\n\nconst PROGRESSIVE_URL_PREFIX = `${IS_PACKAGED_ELECTRON ? ELECTRON_HOST_URL : '.'}/progressive/`;\nconst DOWNLOAD_URL_PREFIX = './download/';\nconst MAX_MEDIA_RETRIES = 5;\n\nconst memoryCache = new Map<string, ApiPreparedMedia>();\nconst fetchPromises = new Map<string, Promise<ApiPreparedMedia | undefined>>();\nconst progressCallbacks = new Map<string, Map<string, ApiOnProgress>>();\nconst cancellableCallbacks = new Map<string, ApiOnProgress>();\n\nexport function fetch<T extends ApiMediaFormat>(\n  url: string,\n  mediaFormat: T,\n  isHtmlAllowed = false,\n  onProgress?: ApiOnProgress,\n  callbackUniqueId?: string,\n): Promise<ApiPreparedMedia> {\n  if (mediaFormat === ApiMediaFormat.Progressive) {\n    return (\n      IS_PROGRESSIVE_SUPPORTED\n        ? Promise.resolve(getProgressiveUrl(url))\n        : fetch(url, ApiMediaFormat.BlobUrl, isHtmlAllowed, onProgress, callbackUniqueId)\n    );\n  }\n\n  if (mediaFormat === ApiMediaFormat.DownloadUrl) {\n    return (\n      IS_PROGRESSIVE_SUPPORTED\n        ? Promise.resolve(getDownloadUrl(url))\n        : fetch(url, ApiMediaFormat.BlobUrl, isHtmlAllowed, onProgress, callbackUniqueId)\n    );\n  }\n\n  if (!fetchPromises.has(url)) {\n    const promise = fetchFromCacheOrRemote(url, mediaFormat, isHtmlAllowed)\n      .catch((err) => {\n        if (DEBUG) {\n          // eslint-disable-next-line no-console\n          console.warn(err);\n        }\n\n        return undefined;\n      })\n      .finally(() => {\n        fetchPromises.delete(url);\n        progressCallbacks.delete(url);\n        cancellableCallbacks.delete(url);\n      });\n\n    fetchPromises.set(url, promise);\n  }\n\n  if (onProgress && callbackUniqueId) {\n    let activeCallbacks = progressCallbacks.get(url);\n    if (!activeCallbacks) {\n      activeCallbacks = new Map<string, ApiOnProgress>();\n      progressCallbacks.set(url, activeCallbacks);\n    }\n    activeCallbacks.set(callbackUniqueId, onProgress);\n  }\n\n  return fetchPromises.get(url) as Promise<ApiPreparedMedia>;\n}\n\nexport function getFromMemory(url: string) {\n  return memoryCache.get(url) as ApiPreparedMedia;\n}\n\nexport function cancelProgress(progressCallback: ApiOnProgress) {\n  progressCallbacks.forEach((map, url) => {\n    map.forEach((callback) => {\n      if (callback === progressCallback) {\n        const parentCallback = cancellableCallbacks.get(url);\n        if (!parentCallback) return;\n\n        cancelApiProgress(parentCallback);\n        cancellableCallbacks.delete(url);\n        progressCallbacks.delete(url);\n      }\n    });\n  });\n}\n\nexport function removeCallback(url: string, callbackUniqueId: string) {\n  const callbacks = progressCallbacks.get(url);\n  if (!callbacks) return;\n  callbacks.delete(callbackUniqueId);\n}\n\nexport function getProgressiveUrl(url: string) {\n  const base = new URL(`${PROGRESSIVE_URL_PREFIX}${url}`, window.location.href);\n  if (ACCOUNT_SLOT) base.searchParams.set('account', ACCOUNT_SLOT.toString());\n  memoryCache.set(url, base.href); // Needed for hooks to detect document as already loaded and apply URL\n  return base.href;\n}\n\nfunction getDownloadUrl(url: string) {\n  const base = new URL(`${DOWNLOAD_URL_PREFIX}${url}`, window.location.href);\n  if (ACCOUNT_SLOT) base.searchParams.set('account', ACCOUNT_SLOT.toString());\n  return base.href;\n}\n\nasync function fetchFromCacheOrRemote(\n  url: string, mediaFormat: ApiMediaFormat, isHtmlAllowed: boolean, retryNumber = 0,\n): Promise<string> {\n  if (!MEDIA_CACHE_DISABLED) {\n    const cacheName = url.startsWith('avatar') ? MEDIA_CACHE_NAME_AVATARS : MEDIA_CACHE_NAME;\n    const cached = await cacheApi.fetch(cacheName, url, asCacheApiType[mediaFormat]!, isHtmlAllowed);\n\n    if (cached) {\n      let media = cached;\n\n      if (cached.type === 'audio/ogg' && !IS_OPUS_SUPPORTED) {\n        media = await oggToWav(media);\n      }\n\n      const prepared = prepareMedia(media);\n\n      memoryCache.set(url, prepared);\n\n      return prepared;\n    }\n  }\n\n  const onProgress = makeOnProgress(url);\n  cancellableCallbacks.set(url, onProgress);\n\n  const remote = await callApi('downloadMedia', { url, mediaFormat, isHtmlAllowed }, onProgress);\n  if (!remote) {\n    if (retryNumber >= MAX_MEDIA_RETRIES) {\n      throw new Error(`Failed to fetch media ${url}`);\n    }\n    await new Promise((resolve) => {\n      setTimeout(resolve, getRetryTimeout(retryNumber));\n    });\n    // eslint-disable-next-line no-console\n    if (DEBUG) console.debug(`Retrying to fetch media ${url}`);\n    return fetchFromCacheOrRemote(url, mediaFormat, isHtmlAllowed, retryNumber + 1);\n  }\n\n  let { mimeType } = remote;\n  let prepared = prepareMedia(remote.dataBlob);\n\n  if (mimeType === 'audio/ogg' && !IS_OPUS_SUPPORTED) {\n    const blob = await fetchBlob(prepared as string);\n    URL.revokeObjectURL(prepared as string);\n    const media = await oggToWav(blob);\n    prepared = prepareMedia(media);\n    mimeType = media.type;\n  }\n\n  memoryCache.set(url, prepared);\n\n  return prepared;\n}\n\nfunction makeOnProgress(url: string) {\n  const onProgress: ApiOnProgress = (progress: number) => {\n    progressCallbacks.get(url)?.forEach((callback) => {\n      callback(progress);\n      if (callback.isCanceled) onProgress.isCanceled = true;\n    });\n  };\n\n  return onProgress;\n}\n\nfunction prepareMedia(mediaData: Exclude<ApiParsedMedia, ArrayBuffer>): ApiPreparedMedia {\n  if (mediaData instanceof Blob) {\n    return URL.createObjectURL(mediaData);\n  }\n\n  return mediaData;\n}\n\nif (IS_PROGRESSIVE_SUPPORTED) {\n  navigator.serviceWorker.addEventListener('message', async (e) => {\n    const { type, messageId, params } = e.data as {\n      type: string;\n      messageId: string;\n      params: { url: string; start: number; end: number };\n    };\n\n    if (type !== 'requestPart') {\n      return;\n    }\n\n    const result = await callApi('downloadMedia', { mediaFormat: ApiMediaFormat.Progressive, ...params });\n    if (!result) {\n      return;\n    }\n\n    const { arrayBuffer, mimeType, fullSize } = result;\n\n    navigator.serviceWorker.controller!.postMessage({\n      type: 'partResponse',\n      messageId,\n      result: {\n        arrayBuffer,\n        mimeType,\n        fullSize,\n      },\n    }, [arrayBuffer!]);\n  });\n}\n\nfunction getRetryTimeout(retryNumber: number) {\n  // 250ms, 500ms, 1s, 2s, 4s\n  return 250 * 2 ** retryNumber;\n}","import { getGlobal } from '../../../../global';\n\nimport type { ApiMessageEntityCustomEmoji, ApiSticker } from '../../../../api/types';\nimport { ApiMessageEntityTypes } from '../../../../api/types';\n\nimport { EMOJI_SIZES } from '../../../../config';\nimport buildClassName from '../../../../util/buildClassName';\nimport { getInputCustomEmojiParams } from '../../../../util/emoji/customEmojiManager';\nimport { REM } from '../../../common/helpers/mediaDimensions';\n\nexport const INPUT_CUSTOM_EMOJI_SELECTOR = 'img[data-document-id]';\n\nexport function buildCustomEmojiHtml(emoji: ApiSticker) {\n  const [isPlaceholder, src, uniqueId] = getInputCustomEmojiParams(emoji);\n\n  const className = buildClassName(\n    'custom-emoji', 'emoji', 'emoji-small', isPlaceholder && 'placeholder', emoji.shouldUseTextColor && 'colorable',\n  );\n\n  return `<img\n    class=\"${className}\"\n    draggable=\"false\"\n    alt=\"${emoji.emoji}\"\n    data-document-id=\"${emoji.id}\"\n    ${uniqueId ? `data-unique-id=\"${uniqueId}\"` : ''}\n    data-entity-type=\"${ApiMessageEntityTypes.CustomEmoji}\"\n    src=\"${src}\"\n  />`;\n}\n\nexport function buildCustomEmojiHtmlFromEntity(rawText: string, entity: ApiMessageEntityCustomEmoji) {\n  const customEmoji = getGlobal().customEmojis.byId[entity.documentId];\n  const [isPlaceholder, src, uniqueId] = getInputCustomEmojiParams(customEmoji);\n\n  const className = buildClassName(\n    'custom-emoji',\n    'emoji',\n    'emoji-small',\n    isPlaceholder && 'placeholder',\n    customEmoji?.shouldUseTextColor && 'colorable',\n  );\n\n  return `<img\n    class=\"${className}\"\n    draggable=\"false\"\n    alt=\"${rawText}\"\n    data-document-id=\"${entity.documentId}\"\n    ${uniqueId ? `data-unique-id=\"${uniqueId}\"` : ''}\n    data-entity-type=\"${ApiMessageEntityTypes.CustomEmoji}\"\n    src=\"${src}\"\n  />`;\n}\n\nexport function getCustomEmojiSize(maxEmojisInLine?: number): number | undefined {\n  if (!maxEmojisInLine) return undefined;\n\n  // Should be the same as in _message-content.scss\n  if (maxEmojisInLine > EMOJI_SIZES) return 2.25 * REM;\n  if (maxEmojisInLine === 1) return 7 * REM;\n  return Math.min(7.5 - (maxEmojisInLine * 0.75), 5.625) * REM;\n}\n","export default function trimText<T extends string | undefined>(text: T, length?: number) {\n  if (!text || !length || text.length <= length) {\n    return text;\n  }\n\n  return `${text.substring(0, length)}...`;\n}\n","import * as langProvider from '../util/oldLangProvider';\nimport useEffectOnce from './useEffectOnce';\nimport useForceUpdate from './useForceUpdate';\n\nexport type OldLangFn = langProvider.LangFn;\n/**\n * @deprecated\n */\nconst useOldLang = (): OldLangFn => {\n  const forceUpdate = useForceUpdate();\n\n  useEffectOnce(() => {\n    return langProvider.addCallback(forceUpdate);\n  });\n\n  return langProvider.getTranslationFn();\n};\n\nexport default useOldLang;\n","/* eslint-disable eslint-multitab-tt/set-global-only-variable */\nimport { onFullyIdle } from '../../lib/teact/teact';\nimport { addCallback } from '../../lib/teact/teactn';\nimport { getActions, getGlobal, setGlobal } from '../../global';\n\nimport type { LocalDb } from '../../api/gramjs/localDb';\nimport type { MethodArgs, Methods } from '../../api/gramjs/methods/types';\nimport type { ApiInitialArgs } from '../../api/types';\nimport type { GlobalState } from '../../global/types';\n\nimport { selectTabState } from '../../global/selectors';\nimport {\n  callApiLocal,\n  cancelApiProgressMaster,\n  handleMethodCallback,\n  handleMethodResponse,\n  initApi,\n  updateFullLocalDb,\n  updateLocalDb,\n} from '../../api/gramjs';\nimport { deepDiff } from '../deepDiff';\nimport { deepMerge } from '../deepMerge';\nimport { getCurrentTabId, signalPasscodeHash, subscribeToTokenDied } from '../establishMultitabRole';\nimport { omit } from '../iteratees';\nimport { DATA_BROADCAST_CHANNEL_NAME, MULTITAB_STORAGE_KEY } from '../multiaccount';\n\ntype BroadcastChannelRefreshLangpack = {\n  type: 'langpackRefresh';\n  langCode: string;\n};\n\ntype BroadcastChannelRequestGlobal = {\n  type: 'requestGlobal';\n  token?: number;\n  appVersion: string;\n};\n\ntype BroadcastChannelGlobalUpdate = {\n  type: 'globalUpdate';\n  global: GlobalState;\n};\n\ntype BroadcastChannelCancelApiProgress = {\n  type: 'cancelApiProgress';\n  token: number;\n  messageId: string;\n};\n\ntype BroadcastChannelCallApi = {\n  type: 'callApi';\n  token: number;\n  messageId: string;\n  name: keyof Methods;\n  args: MethodArgs<keyof Methods>;\n  withCallback?: boolean;\n};\n\ntype BroadcastChannelMessageResponse = {\n  type: 'messageResponse';\n  token: number;\n  messageId: string;\n  response: any;\n};\n\ntype BroadcastChannelLocalDbUpdate = {\n  type: 'localDbUpdate';\n  batchedUpdates: {\n    name: keyof LocalDb;\n    prop: string;\n    value: any;\n  }[];\n};\n\ntype BroadcastChannelLocalDbUpdateFull = {\n  type: 'localDbUpdateFull';\n  localDb: any;\n};\n\ntype BroadcastChannelMessageCallback = {\n  type: 'messageCallback';\n  token: number;\n  messageId: string;\n  callbackArgs: any;\n};\n\ntype BroadcastChannelGlobalDiff = {\n  type: 'globalDiffUpdate';\n  diff: any;\n};\n\ntype BroadcastChannelInitApi = {\n  type: 'initApi';\n  token: number;\n  initialArgs: ApiInitialArgs;\n};\n\nconst MULTITAB_ESTABLISH_TIMEOUT = 800;\n\nexport type TypedBroadcastChannel = {\n  postMessage: (message: BroadcastChannelMessage) => void;\n  addEventListener: (type: 'message', listener: (event: { data: BroadcastChannelMessage }) => void) => void;\n  removeEventListener: (type: 'message', listener: (event: { data: BroadcastChannelMessage }) => void) => void;\n};\n\ntype BroadcastChannelMessage = (\n  BroadcastChannelRequestGlobal | BroadcastChannelGlobalUpdate | BroadcastChannelCallApi |\n  BroadcastChannelMessageResponse | BroadcastChannelRefreshLangpack |\n  BroadcastChannelMessageCallback | BroadcastChannelCancelApiProgress | BroadcastChannelLocalDbUpdate |\n  BroadcastChannelLocalDbUpdateFull | BroadcastChannelGlobalDiff | BroadcastChannelInitApi\n);\n\nlet resolveGlobalPromise: VoidFunction | undefined;\nlet isFirstGlobalResolved = false;\nlet currentGlobal: GlobalState | undefined;\nlet isDisabled = false;\n\nconst channel = new BroadcastChannel(DATA_BROADCAST_CHANNEL_NAME) as TypedBroadcastChannel;\n\nlet isBroadcastDiffScheduled = false;\nlet lastBroadcastDiffGlobal: GlobalState | undefined;\n\nfunction broadcastDiffOnIdle() {\n  if (isBroadcastDiffScheduled) return;\n\n  isBroadcastDiffScheduled = true;\n  lastBroadcastDiffGlobal = currentGlobal;\n\n  onFullyIdle(() => {\n    const diff = deepDiff(lastBroadcastDiffGlobal, currentGlobal);\n\n    if (typeof diff !== 'symbol') {\n      channel.postMessage({\n        type: 'globalDiffUpdate',\n        diff,\n      });\n    }\n\n    isBroadcastDiffScheduled = false;\n  });\n}\n\nexport function unsubcribeFromMultitabBroadcastChannel() {\n  channel.removeEventListener('message', handleMessage);\n  isDisabled = true;\n}\n\nexport function subscribeToMultitabBroadcastChannel() {\n  subscribeToTokenDied((token) => {\n    if (token === getCurrentTabId()) {\n      unsubcribeFromMultitabBroadcastChannel();\n      const global = getGlobal();\n      const newGlobal = {\n        ...global,\n        byTabId: omit(global.byTabId, [token]),\n      };\n\n      const diff = deepDiff(global, newGlobal);\n\n      if (typeof diff !== 'symbol') {\n        channel.postMessage({\n          type: 'globalDiffUpdate',\n          diff,\n        });\n      }\n      return;\n    }\n    let global = getGlobal();\n    global = {\n      ...global,\n      byTabId: omit(global.byTabId, [token]),\n    };\n\n    setGlobal(global);\n  });\n\n  addCallback((global: GlobalState) => {\n    if (!isFirstGlobalResolved || isDisabled) {\n      currentGlobal = global;\n      return;\n    }\n\n    if (currentGlobal === global) {\n      return;\n    }\n\n    if (!currentGlobal) {\n      currentGlobal = global;\n      channel.postMessage({\n        type: 'globalUpdate',\n        global,\n      });\n      return;\n    }\n\n    broadcastDiffOnIdle();\n\n    currentGlobal = global;\n  });\n\n  channel.addEventListener('message', handleMessage);\n}\n\nexport function handleMessage({ data }: { data: BroadcastChannelMessage }) {\n  if (!data) return;\n\n  switch (data.type) {\n    case 'initApi': {\n      const global = getGlobal();\n      if (!selectTabState(global).isMasterTab) return;\n\n      const { initialArgs } = data;\n      initApi(getActions().apiUpdate, initialArgs);\n      break;\n    }\n\n    case 'globalDiffUpdate': {\n      if (!isFirstGlobalResolved) return;\n      const { diff } = data;\n      const oldGlobal = getGlobal();\n      const global = deepMerge(oldGlobal, diff);\n\n      // @ts-ignore\n      global.DEBUG_randomId = oldGlobal.DEBUG_randomId;\n\n      currentGlobal = global;\n      setGlobal(global);\n      break;\n    }\n\n    case 'globalUpdate': {\n      if (isFirstGlobalResolved) return;\n      const oldGlobal = getGlobal();\n      // @ts-ignore\n      data.global.DEBUG_randomId = oldGlobal.DEBUG_randomId;\n      currentGlobal = data.global;\n      setGlobal(data.global);\n      if (resolveGlobalPromise) {\n        resolveGlobalPromise();\n        resolveGlobalPromise = undefined;\n        isFirstGlobalResolved = true;\n      }\n      break;\n    }\n\n    case 'requestGlobal': {\n      const { appVersion } = data;\n      if (appVersion !== APP_VERSION) {\n        // If app version on the other tab was updated, reload the current page immediately and don't respond\n        // to the other tab's request because our current global might be incompatible with the new version\n        window.location.reload();\n        return;\n      }\n\n      if (!isFirstGlobalResolved) return;\n      const global = getGlobal();\n\n      if (!selectTabState(global).isMasterTab) return;\n\n      channel.postMessage({\n        type: 'globalUpdate',\n        global,\n      });\n\n      signalPasscodeHash();\n      break;\n    }\n\n    case 'messageCallback': {\n      if (!isFirstGlobalResolved) return;\n      const global = getGlobal();\n      if (selectTabState(global).isMasterTab) return;\n\n      handleMethodCallback(data);\n      break;\n    }\n\n    case 'localDbUpdate': {\n      if (!isFirstGlobalResolved) return;\n      const global = getGlobal();\n      if (selectTabState(global).isMasterTab) return;\n\n      const {\n        batchedUpdates,\n      } = data;\n\n      batchedUpdates.forEach(({\n        name,\n        prop,\n        value,\n      }) => {\n        updateLocalDb(name, prop, value);\n      });\n      break;\n    }\n\n    case 'localDbUpdateFull': {\n      if (!isFirstGlobalResolved) return;\n      const global = getGlobal();\n      if (selectTabState(global).isMasterTab) return;\n\n      const { localDb } = data;\n\n      updateFullLocalDb(localDb);\n      break;\n    }\n\n    case 'messageResponse': {\n      if (!isFirstGlobalResolved) return;\n      const global = getGlobal();\n\n      if (selectTabState(global).isMasterTab) return;\n\n      handleMethodResponse(data);\n      break;\n    }\n\n    case 'cancelApiProgress': {\n      if (!isFirstGlobalResolved) return;\n      const global = getGlobal();\n      if (!selectTabState(global).isMasterTab) return;\n\n      const { messageId } = data;\n\n      cancelApiProgressMaster(messageId);\n      break;\n    }\n\n    case 'callApi': {\n      if (!isFirstGlobalResolved) return;\n      const global = getGlobal();\n      if (!selectTabState(global).isMasterTab) return;\n\n      const {\n        name, messageId, token, args, withCallback,\n      } = data;\n\n      const argsWithCallback = (withCallback ? [...args, (...callbackArgs: any[]) => {\n        channel.postMessage({\n          type: 'messageCallback',\n          token,\n          messageId,\n          callbackArgs,\n        });\n      }] : args) as MethodArgs<keyof Methods>;\n\n      (async () => {\n        const result = await (callApiLocal(name, ...argsWithCallback));\n\n        channel.postMessage({\n          type: 'messageResponse',\n          token,\n          messageId,\n          response: result,\n        });\n      })();\n\n      break;\n    }\n\n    case 'langpackRefresh': {\n      getActions().refreshLangPackFromCache({ langCode: data.langCode });\n      break;\n    }\n  }\n}\n\nexport function requestGlobal(appVersion: string): Promise<void> {\n  channel.postMessage({\n    type: 'requestGlobal',\n    appVersion,\n  });\n\n  const resolveWithoutGlobal = () => {\n    if (resolveGlobalPromise) {\n      resolveGlobalPromise();\n      resolveGlobalPromise = undefined;\n    }\n    isFirstGlobalResolved = true;\n  };\n\n  if (localStorage.getItem(MULTITAB_STORAGE_KEY)) {\n    setTimeout(resolveWithoutGlobal, MULTITAB_ESTABLISH_TIMEOUT);\n  } else {\n    resolveWithoutGlobal();\n    return Promise.resolve();\n  }\n\n  return new Promise((resolve) => {\n    resolveGlobalPromise = resolve;\n  });\n}\n\nexport function notifyLangpackUpdate(langCode: string) {\n  channel.postMessage({\n    type: 'langpackRefresh',\n    langCode,\n  });\n}\n","import type { ApiThemeParameters } from '../api/types';\n\nexport function extractCurrentThemeParams(): ApiThemeParameters {\n  const style = getComputedStyle(document.documentElement);\n\n  const backgroundColor = getPropertyHexColor(style, '--color-background')!;\n  const secondaryTextColor = getPropertyHexColor(style, '--color-text-secondary')!;\n\n  const bgColor = backgroundColor;\n  const textColor = getPropertyHexColor(style, '--color-text')!;\n  const buttonColor = getPropertyHexColor(style, '--color-primary')!;\n  const buttonTextColor = getPropertyHexColor(style, '--color-white')!;\n  const linkColor = getPropertyHexColor(style, '--color-links')!;\n  const hintColor = secondaryTextColor;\n  const secondaryBgColor = getPropertyHexColor(style, '--color-background-secondary')!;\n  const sectionSeparatorColor = getPropertyHexColor(style, '--color-divider')!;\n\n  const headerBgColor = backgroundColor;\n  const accentTextColor = getPropertyHexColor(style, '--color-primary')!;\n  const sectionBgColor = backgroundColor;\n  const sectionHeaderTextColor = secondaryTextColor;\n  const subtitleTextColor = hintColor;\n  const destructiveTextColor = getPropertyHexColor(style, '--color-error')!;\n\n  return {\n    bg_color: bgColor,\n    text_color: textColor,\n    hint_color: hintColor,\n    link_color: linkColor,\n    button_color: buttonColor,\n    button_text_color: buttonTextColor,\n    secondary_bg_color: secondaryBgColor,\n    header_bg_color: headerBgColor,\n    accent_text_color: accentTextColor,\n    section_bg_color: sectionBgColor,\n    section_header_text_color: sectionHeaderTextColor,\n    subtitle_text_color: subtitleTextColor,\n    destructive_text_color: destructiveTextColor,\n    section_separator_color: sectionSeparatorColor,\n  };\n}\n\nexport function validateHexColor(color: string) {\n  return /^#[0-9A-F]{6}$/i.test(color);\n}\n\nexport function getPropertyHexColor(style: CSSStyleDeclaration, property: string) {\n  const value = style.getPropertyValue(property);\n  if (!value) return undefined;\n  return prepareHexColor(value.trim());\n}\n\nexport function prepareHexColor(color: string) {\n  if (validateHexColor(color)) return color;\n  return `#${color.match(/^rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)(?:,\\s*(\\d+\\.{0,1}\\d*))?\\)$/)!\n    .slice(1)\n    .map((n: string, i: number) => (i === 3 ? Math.round(parseFloat(n) * 255) : parseFloat(n))\n      .toString(16)\n      .padStart(2, '0')\n      .replace('NaN', ''))\n    .join('')}`;\n}\n","/* eslint-disable no-console */\n/* eslint-disable no-null/no-null */\nimport { v4 as uuidv4 } from 'uuid';\nimport { getActions, getGlobal } from '../../../global';\n\nimport type { CustomSummaryTemplate } from '../store/chatai-summary-template-store';\nimport type { SummaryStoreMessage } from '../store/summary-store';\nimport { type ApiMessage, MAIN_THREAD_ID } from '../../../api/types/messages';\n\nimport { ALL_FOLDER_ID } from '../../../config';\nimport eventEmitter, { Actions } from '../lib/EventEmitter';\nimport { isSystemBot, isUserId } from '../../../global/helpers';\nimport {\n  selectBot, selectChat, selectChatLastMessageId, selectFirstUnreadId, selectUser,\n} from '../../../global/selectors';\nimport { getOrderedIds } from '../../../util/folderManager';\nimport GlobalSummaryBadge from '../globalSummary/global-summary-badge';\nimport {\n  ChataiStores,\n  GLOBAL_SUMMARY_LAST_TIME, GLOBAL_SUMMARY_READ_TIME,\n} from '../store';\nimport { SUMMARY_CHATS } from '../store/general-store';\nimport { sendGAEvent } from '../utils/analytics';\nimport { fetchChatMessageByDeadline, fetchChatUnreadMessage } from '../utils/fetch-messages';\nimport { GLOBAL_SUMMARY_CHATID } from '../variables';\n\nfunction getAlignedExecutionTimestamp(): number | null {\n  const date = new Date();\n  const hour = date.getHours();\n  const minute = date.getMinutes();\n\n  const toTimestamp = (h: number, m: number = 0) => {\n    const d = new Date(date);\n    d.setHours(h, m, 0, 0);\n    return d.getTime();\n  };\n\n  // 09:00 - 12:00\n  if (hour >= 9 && hour < 12) {\n    const minutesAligned = Math.floor(minute / 30) * 30;\n    return toTimestamp(hour, minutesAligned);\n  }\n\n  // 14:00 - 17:00\n  if (hour >= 14 && hour < 17) {\n    const minutesAligned = Math.floor(minute / 30) * 30;\n    return toTimestamp(hour, minutesAligned);\n  }\n\n  // 17:00 - 23:00 每2小时执行一次\n  if (hour >= 17 && hour < 23) {\n    const baseHour = Math.floor((hour - 17) / 2) * 2 + 17;\n    return toTimestamp(baseHour, 0);\n  }\n\n  // 不在执行时间内\n  return null;\n}\n\nclass GlobalSummaryTask {\n  private static instance: GlobalSummaryTask | undefined;\n\n  private pendingMessages: ApiMessage[] = [];\n\n  private summaryChats: string[] = [];\n\n  private customizationTemplate:CustomSummaryTemplate | undefined = undefined;\n\n  private unreadSummaryCount = 0;\n\n  private summaryChatsInitialized = false;\n\n  private timmer: NodeJS.Timeout | undefined;\n\n  initTask() {\n    if (this.timmer) {\n      clearInterval(this.timmer);\n    }\n    const executeTask = () => {\n      const currentTime = new Date();\n      const hours = currentTime.getHours();\n      const minutes = currentTime.getMinutes();\n      // eslint-disable-next-line no-console\n      console.log('计时任务hours', hours);\n      // eslint-disable-next-line no-console\n      console.log('计时任务minutes', minutes);\n      // 9:00 - 12:00 每30分钟执行一次\n      if (hours >= 9 && hours < 12 && minutes % 30 === 0) {\n        this.initSummaryChats();\n      }\n\n      // 14:00 - 17:00 每30分钟执行一次\n      if (hours >= 14 && hours < 17 && minutes % 30 === 0) {\n        this.initSummaryChats();\n      }\n\n      // 17:00 - 23:00 每2小时执行一次\n      if (hours >= 17 && hours < 23 && (hours - 17) % 2 === 0 && minutes === 0) {\n        this.initSummaryChats();\n      }\n    };\n\n    // 每分钟执行一次来检查时间段\n    this.timmer = setInterval(executeTask, 60000);\n    eventEmitter.on(Actions.ChatAIStoreReady, async () => {\n      await this.updateSummarySettings();\n      const globalSummaryLastTime: number | undefined = await ChataiStores.general?.get(GLOBAL_SUMMARY_LAST_TIME);\n      if (!globalSummaryLastTime) {\n      // TODO 总结所有的未读消息\n        this.summaryAllUnreadMessages();\n      } else if (Date.now() - globalSummaryLastTime > 1000 * 60 * 60 * 10) {\n      // TODO 获取所有未读消息\n        this.summaryMessageByDeadline(globalSummaryLastTime);\n      }\n    });\n  }\n\n  async initSummaryChats() {\n    const globalSummaryLastTime: number | undefined = await ChataiStores.general?.get(GLOBAL_SUMMARY_LAST_TIME);\n    if (!globalSummaryLastTime) {\n      // TODO 总结所有的未读消息\n      this.summaryAllUnreadMessages();\n    } else {\n      this.summaryMessageByDeadline(globalSummaryLastTime);\n    }\n  }\n\n  async updateSummarySettings() {\n    try {\n      this.customizationTemplate = await ChataiStores.general?.get('lastDefinedPrompt');\n      this.summaryChats = await ChataiStores.general?.get(SUMMARY_CHATS) || [];\n    } catch (e) {\n      console.log(e);\n    }\n  }\n\n  public updateSummaryDefineTemplate(template: CustomSummaryTemplate | undefined) {\n    this.customizationTemplate = template;\n  }\n\n  public updateSummaryChats(chats:string[]) {\n    this.summaryChats = chats;\n  }\n\n  async startSummary(chats: Record<string, ApiMessage[]>, callback?:()=>void) {\n    const global = getGlobal();\n    const { autoTranslateLanguage = 'en' } = global.settings.byKey;\n    const globalSummaryLastTime = await ChataiStores.general?.get(GLOBAL_SUMMARY_LAST_TIME) || 0;\n    const summaryTime = getAlignedExecutionTimestamp();\n    if (!Object.keys(chats).length) return;\n    const summaryChats:any[] = [];\n    Object.keys(chats).forEach((chatId) => {\n      const chat = chatId ? selectChat(global, chatId) : undefined;\n      const chatType = isUserId(chatId) ? 'private' : 'group';\n      const messages = chats[chatId].map((message) => {\n        if (message.content.text?.text) {\n          const peer = message.senderId ? selectUser(global, message.senderId) : undefined;\n          return {\n            senderId: message.senderId,\n            senderName: peer ? `${peer.firstName || ''} ${peer.lastName || ''}` : '',\n            date: message.date,\n            messageId: Math.floor(message.id),\n            content: message.content.text?.text ?? '',\n          };\n        }\n        return null;\n      }).filter(Boolean);\n      if (messages.length > 0) {\n        summaryChats.push({\n          chatId,\n          chatName: chat?.title ?? 'Unknown',\n          chatType,\n          messages,\n        });\n      }\n    });\n    if (!summaryChats.length) return;\n    const summaryInfo = {\n      summaryStartTime: globalSummaryLastTime || null,\n      summaryEndTime: summaryTime,\n      summaryMessageCount: Object.values(chats).reduce(\n        (sum, messages) => sum + messages.length,\n        0,\n      ),\n      summaryChatIds: Object.keys(chats),\n    };\n    fetch('https://telegpt-three.vercel.app/global-summary', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        messages: summaryChats,\n        language: new Intl.DisplayNames([autoTranslateLanguage], { type: 'language' }).of(autoTranslateLanguage),\n        definePrompt: this.customizationTemplate?.prompt || '',\n      }),\n    })\n      .then((response) => response.json())\n      .then((data) => {\n        console.log('summary response', data);\n        const content = {\n          ...data.data,\n          summaryInfo,\n          customizationTemplate: this.customizationTemplate,\n        };\n        const newMessage: SummaryStoreMessage = {\n          timestamp: new Date().getTime(),\n          content: JSON.stringify(content),\n          id: uuidv4(),\n          createdAt: new Date(),\n          role: 'assistant',\n          annotations: [{\n            type: 'global-summary',\n          }],\n        };\n        ChataiStores.summary?.storeMessage(newMessage);\n        ChataiStores.general?.set(GLOBAL_SUMMARY_LAST_TIME, summaryTime);\n        eventEmitter.emit(Actions.AddSummaryMessage, newMessage);\n        GlobalSummaryBadge.increaseUnreadCount();\n        window.Notification.requestPermission().then((permission) => {\n          if (permission === 'granted') {\n            const notification = new Notification('Chat Summary', {\n              body: 'You have received a new Chat Summary',\n            });\n            notification.onclick = () => {\n              getActions().openChat({ id: GLOBAL_SUMMARY_CHATID });\n              sendGAEvent('summary_view');\n            };\n            setTimeout(() => notification.close(), 5000);\n          }\n        });\n        callback?.();\n      });\n    this.clearPendingMessages();\n  }\n\n  summaryAllUnreadMessages = async () => {\n    const unreadMessages: Record<string, ApiMessage[]> = {};\n    const global = getGlobal();\n    const orderedIds = getOrderedIds(ALL_FOLDER_ID) || [];\n    const summaryChatIds = this.summaryChats.length ? this.summaryChats : orderedIds;\n    for (let i = 0; i < summaryChatIds.length; i++) {\n      const chatId = summaryChatIds[i];\n      const chat = selectChat(global, chatId);\n      const chatBot = !isSystemBot(chatId) ? selectBot(global, chatId) : undefined;\n      if (chat && chat.unreadCount && !chatBot) {\n        const firstUnreadId = selectFirstUnreadId(global, chatId, MAIN_THREAD_ID) || chat.lastReadInboxMessageId;\n        const roomUnreadMsgs = await fetchChatUnreadMessage({\n          chat,\n          offsetId: firstUnreadId || 0,\n          addOffset: -30,\n          sliceSize: 30,\n          threadId: MAIN_THREAD_ID,\n          unreadCount: chat.unreadCount,\n          maxCount: 100,\n        });\n        if (roomUnreadMsgs.length > 0) {\n          unreadMessages[chatId] = roomUnreadMsgs;\n        }\n      }\n    }\n    if (Object.keys(unreadMessages).length) {\n      this.startSummary(unreadMessages);\n    }\n  };\n\n  async summaryMessageByDeadline(deadline: number) {\n    const unreadMessages: Record<string, ApiMessage[]> = {};\n    const global = getGlobal();\n    const orderedIds = getOrderedIds(ALL_FOLDER_ID) || [];\n    const summaryChatIds = this.summaryChats.length ? this.summaryChats : orderedIds;\n    for (let i = 0; i < summaryChatIds.length; i++) {\n      const chatId = summaryChatIds[i];\n      const chat = selectChat(global, chatId);\n      const chatBot = !isSystemBot(chatId) ? selectBot(global, chatId) : undefined;\n      const chatLastMessageId = selectChatLastMessageId(global, chatId) || 0;\n      if (chat && chat.unreadCount && !chatBot && chatLastMessageId) {\n        const roomUnreadMsgs = await fetchChatMessageByDeadline({\n          chat,\n          deadline: deadline / 1000,\n          offsetId: chatLastMessageId,\n          addOffset: -30,\n          sliceSize: 30,\n          threadId: MAIN_THREAD_ID,\n          maxCount: 100,\n        });\n        unreadMessages[chatId] = roomUnreadMsgs;\n      }\n    }\n    if (Object.keys(unreadMessages).length) {\n      this.startSummary(unreadMessages);\n    }\n  }\n\n  async mergeUnreadSummarys() {\n    const lastReadTime: number | undefined = await ChataiStores.general?.get(GLOBAL_SUMMARY_READ_TIME);\n    if (lastReadTime && this.unreadSummaryCount > 2) {\n      this.summaryMessageByDeadline(lastReadTime);\n    }\n    ChataiStores.general?.set(GLOBAL_SUMMARY_READ_TIME, new Date().getTime());\n    this.unreadSummaryCount = 0;\n  }\n\n  getSummaryChats():Promise<string[]> {\n    return new Promise((resolve) => {\n      if (this.summaryChatsInitialized) {\n        resolve(this.summaryChats);\n      } else {\n        this.summaryChatsInitialized = true;\n        ChataiStores.general?.get(SUMMARY_CHATS).then((chats) => {\n          this.summaryChats = chats || [];\n          resolve(chats || []);\n        }).catch(() => {\n          resolve([]);\n        });\n      }\n    });\n  }\n\n  async addNewMessage(message: ApiMessage) {\n    const summaryChats = await this.getSummaryChats() || [];\n    const chatId = message.chatId;\n    if (summaryChats.length === 0 || summaryChats.includes(chatId)) {\n      this.pendingMessages.push(message);\n      console.log('待总结的消息', this.pendingMessages);\n    }\n  }\n\n  clearPendingMessages() {\n    this.pendingMessages = [];\n  }\n\n  getPendingMessages() {\n    return this.pendingMessages;\n  }\n\n  public static getInstance() {\n    if (!GlobalSummaryTask.instance) {\n      GlobalSummaryTask.instance = new GlobalSummaryTask();\n    }\n    return GlobalSummaryTask.instance;\n  }\n}\n\nexport const globalSummaryTask = GlobalSummaryTask.getInstance();\n","import { getGlobal } from '../global';\n\nimport type { ApiOldLangPack, ApiOldLangString } from '../api/types';\nimport type { LangCode, TimeFormat } from '../types';\n\nimport {\n  LANG_CACHE_NAME, LANG_PACKS,\n} from '../config';\nimport { selectSharedSettings } from '../global/selectors/sharedState';\nimport { callApi } from '../api/gramjs';\nimport * as cacheApi from './cacheApi';\nimport { createCallbackManager } from './callbacks';\nimport { loadAndChangeLanguage } from './localization';\nimport { formatInteger } from './textFormat';\n\nexport interface LangFn {\n  (key: string, value?: any, format?: 'i', pluralValue?: number): string;\n\n  isRtl?: boolean;\n  code?: LangCode;\n  langName?: string;\n  timeFormat?: TimeFormat;\n}\n\nconst SUBSTITUTION_REGEX = /%\\d?\\$?[sdf@]/g;\nconst PLURAL_OPTIONS = ['value', 'zeroValue', 'oneValue', 'twoValue', 'fewValue', 'manyValue', 'otherValue'] as const;\n// Some rules edited from https://github.com/eemeli/make-plural/blob/master/packages/plurals/cardinals.js\nconst PLURAL_RULES = {\n  /* eslint-disable max-len */\n  en: (n: number) => (n !== 1 ? 6 : 2),\n  ar: (n: number) => (n === 0 ? 1 : n === 1 ? 2 : n === 2 ? 3 : n % 100 >= 3 && n % 100 <= 10 ? 4 : n % 100 >= 11 ? 5 : 6),\n  be: (n: number) => {\n    const s = String(n).split('.');\n    const t0 = Number(s[0]) === n;\n    const n10 = t0 ? Number(s[0].slice(-1)) : 0;\n    const n100 = t0 ? Number(s[0].slice(-2)) : 0;\n    return n10 === 1 && n100 !== 11 ? 2\n      : (n10 >= 2 && n10 <= 4) && (n100 < 12 || n100 > 14) ? 4\n        : (t0 && n10 === 0) || (n10 >= 5 && n10 <= 9) || (n100 >= 11 && n100 <= 14) ? 5\n          : 6;\n  },\n  ca: (n: number) => (n !== 1 ? 6 : 2),\n  cs: (n: number) => {\n    const s = String(n).split('.');\n    const i = Number(s[0]);\n    const v0 = !s[1];\n    return n === 1 && v0 ? 2 : (i >= 2 && i <= 4) && v0 ? 4 : !v0 ? 5 : 6;\n  },\n  de: (n: number) => (n !== 1 ? 6 : 2),\n  es: (n: number) => (n !== 1 ? 6 : 2),\n  fa: (n: number) => (n > 1 ? 6 : 2),\n  fi: (n: number) => (n !== 1 ? 6 : 2),\n  fr: (n: number) => (n > 1 ? 6 : 2),\n  id: () => 0,\n  it: (n: number) => (n !== 1 ? 6 : 2),\n  hr: (n: number) => {\n    const s = String(n).split('.');\n    const i = s[0];\n    const f = s[1] || '';\n    const v0 = !s[1];\n    const i10 = Number(i.slice(-1));\n    const i100 = Number(i.slice(-2));\n    const f10 = Number(f.slice(-1));\n    const f100 = Number(f.slice(-2));\n    return (v0 && i10 === 1 && i100 !== 11) || (f10 === 1 && f100 !== 11) ? 2\n      : (v0 && (i10 >= 2 && i10 <= 4) && (i100 < 12 || i100 > 14)) || ((f10 >= 2 && f10 <= 4) && (f100 < 12 || f100 > 14)) ? 4\n        : 6;\n  },\n  hu: (n: number) => (n > 1 ? 6 : 2),\n  ko: () => 0,\n  ms: () => 0,\n  nb: (n: number) => (n > 1 ? 6 : 2),\n  nl: (n: number) => (n !== 1 ? 6 : 2),\n  pl: (n: number) => (n === 1 ? 2 : n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 4 : 5),\n  'pt-br': (n: number) => (n > 1 ? 6 : 2),\n  ru: (n: number) => (n % 10 === 1 && n % 100 !== 11 ? 2 : n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 4 : 5),\n  sk: (n: number) => {\n    const s = String(n).split('.');\n    const i = Number(s[0]);\n    const v0 = !s[1];\n    return n === 1 && v0 ? 2 : (i >= 2 && i <= 4) && v0 ? 4 : !v0 ? 5 : 6;\n  },\n  sr: (n: number) => {\n    const s = String(n).split('.');\n    const i = s[0];\n    const f = s[1] || '';\n    const v0 = !s[1];\n    const i10 = Number(i.slice(-1));\n    const i100 = Number(i.slice(-2));\n    const f10 = Number(f.slice(-1));\n    const f100 = Number(f.slice(-2));\n    return (v0 && i10 === 1 && i100 !== 11) || (f10 === 1 && f100 !== 11) ? 2\n      : (v0 && (i10 >= 2 && i10 <= 4) && (i100 < 12 || i100 > 14)) || ((f10 >= 2 && f10 <= 4) && (f100 < 12 || f100 > 14)) ? 4\n        : 6;\n  },\n  tr: (n: number) => (n > 1 ? 6 : 2),\n  uk: (n: number) => (n % 10 === 1 && n % 100 !== 11 ? 2 : n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 4 : 5),\n  uz: (n: number) => (n > 1 ? 6 : 2),\n  /* eslint-enable max-len */\n};\n\nconst cache = new Map<string, string>();\n\nlet langPack: ApiOldLangPack | undefined;\nlet fallbackLangPack: ApiOldLangPack | undefined;\n\nconst {\n  addCallback,\n  removeCallback,\n  runCallbacks,\n} = createCallbackManager();\n\nexport { addCallback, removeCallback };\n\nlet currentLangCode: string | undefined;\nlet currentTimeFormat: TimeFormat | undefined;\n\nfunction createLangFn() {\n  return (key: string, value?: any, format?: 'i', pluralValue?: number) => {\n    if (value !== undefined) {\n      const cacheValue = Array.isArray(value) ? JSON.stringify(value) : value;\n      const cached = cache.get(`${key}_${cacheValue}_${format}${pluralValue ? `_${pluralValue}` : ''}`);\n      if (cached) {\n        return cached;\n      }\n    }\n\n    if (!fallbackLangPack) {\n      void importFallbackLangPack();\n    }\n\n    const langString = langPack?.[key] || fallbackLangPack?.[key];\n    if (!langString) {\n      return key;\n    }\n\n    return processTranslation(langString, key, value, format, pluralValue);\n  };\n}\n\nlet translationFn: LangFn = createLangFn();\n\n/**\n * @deprecated Do not translate inside non-reactive contexts. Pass parameters to the component instead\n */\nexport function oldTranslate(...args: Parameters<LangFn>) {\n  return translationFn(...args);\n}\n\nexport function getTranslationFn(): LangFn {\n  return translationFn;\n}\n\n/**\n * @deprecated Migrate to `changeLanguage` in `util/localization.ts` instead\n */\nexport async function oldSetLanguage(langCode: LangCode, callback?: NoneToVoidFunction, withFallback = false) {\n  loadAndChangeLanguage(langCode, true);\n  if (langPack && langCode === currentLangCode) {\n    if (callback) {\n      callback();\n    }\n\n    return;\n  }\n\n  let newLangPack = await cacheApi.fetch(LANG_CACHE_NAME, langCode, cacheApi.Type.Json);\n  if (!newLangPack) {\n    if (withFallback) {\n      await importFallbackLangPack();\n    }\n\n    newLangPack = await fetchRemote(langCode);\n    if (!newLangPack) {\n      return;\n    }\n  }\n\n  cache.clear();\n\n  currentLangCode = langCode;\n  langPack = newLangPack;\n  document.documentElement.lang = langCode;\n\n  const global = getGlobal();\n  const { languages, timeFormat } = selectSharedSettings(global);\n  const langInfo = languages?.find((lang) => lang.langCode === langCode);\n  translationFn = createLangFn();\n  translationFn.isRtl = Boolean(langInfo?.isRtl);\n  translationFn.code = langCode.replace('-raw', '') as LangCode;\n  translationFn.langName = langInfo?.nativeName;\n  translationFn.timeFormat = timeFormat;\n\n  if (callback) {\n    callback();\n  }\n\n  runCallbacks();\n}\n\nexport function setTimeFormat(timeFormat: TimeFormat) {\n  if (timeFormat && timeFormat === currentTimeFormat) {\n    return;\n  }\n\n  currentTimeFormat = timeFormat;\n  translationFn.timeFormat = timeFormat;\n\n  runCallbacks();\n}\n\nasync function importFallbackLangPack() {\n  if (fallbackLangPack) {\n    return;\n  }\n\n  fallbackLangPack = (await import('./fallbackLangPack')).default;\n  runCallbacks();\n}\n\nasync function fetchRemote(langCode: string): Promise<ApiOldLangPack | undefined> {\n  const remote = await callApi('oldFetchLangPack', { sourceLangPacks: LANG_PACKS, langCode });\n  if (remote) {\n    await cacheApi.save(LANG_CACHE_NAME, langCode, remote.langPack);\n    return remote.langPack;\n  }\n\n  return undefined;\n}\n\nfunction getPluralOption(amount: number) {\n  const langCode = currentLangCode || 'en';\n  const optionIndex = PLURAL_RULES[langCode as keyof typeof PLURAL_RULES]\n    ? PLURAL_RULES[langCode as keyof typeof PLURAL_RULES](amount)\n    : 0;\n\n  return PLURAL_OPTIONS[optionIndex];\n}\n\nfunction processTemplate(template: string, value: any) {\n  value = Array.isArray(value) ? value : [value];\n  const translationSlices = template.split(SUBSTITUTION_REGEX);\n  const initialValue = translationSlices.shift();\n\n  return translationSlices.reduce((result, str, index) => {\n    return `${result}${String(value[index] ?? '')}${str}`;\n  }, initialValue || '');\n}\n\nfunction processTranslation(\n  langString: ApiOldLangString | undefined, key: string, value?: any, format?: 'i', pluralValue?: number,\n) {\n  const preferredPluralOption = typeof value === 'number' || pluralValue !== undefined\n    ? getPluralOption(pluralValue ?? value)\n    : 'value';\n  const template = typeof langString === 'string'\n    ? langString\n    : preferredPluralOption === 'value'\n      // Support cached older `langString` interface\n      ? (typeof langString === 'object' ? (langString as any).value : langString)\n      : typeof langString === 'object'\n        ? langString[preferredPluralOption] || langString.otherValue\n        : undefined;\n\n  if (!template?.trim()) {\n    const parts = key.split('.');\n\n    return parts[parts.length - 1];\n  }\n\n  if (value !== undefined) {\n    const formattedValue = format === 'i' ? formatInteger(value) : value;\n    const result = processTemplate(template, formattedValue);\n    const cacheValue = Array.isArray(value) ? JSON.stringify(value) : value;\n    cache.set(`${key}_${cacheValue}_${format}${pluralValue ? `_${pluralValue}` : ''}`, result);\n    return result;\n  }\n\n  return template;\n}\n","const instanceOfAny = (object, constructors) => constructors.some((c) => object instanceof c);\n\nlet idbProxyableTypes;\nlet cursorAdvanceMethods;\n// This is a function to prevent it throwing up in node environments.\nfunction getIdbProxyableTypes() {\n    return (idbProxyableTypes ||\n        (idbProxyableTypes = [\n            IDBDatabase,\n            IDBObjectStore,\n            IDBIndex,\n            IDBCursor,\n            IDBTransaction,\n        ]));\n}\n// This is a function to prevent it throwing up in node environments.\nfunction getCursorAdvanceMethods() {\n    return (cursorAdvanceMethods ||\n        (cursorAdvanceMethods = [\n            IDBCursor.prototype.advance,\n            IDBCursor.prototype.continue,\n            IDBCursor.prototype.continuePrimaryKey,\n        ]));\n}\nconst transactionDoneMap = new WeakMap();\nconst transformCache = new WeakMap();\nconst reverseTransformCache = new WeakMap();\nfunction promisifyRequest(request) {\n    const promise = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            request.removeEventListener('success', success);\n            request.removeEventListener('error', error);\n        };\n        const success = () => {\n            resolve(wrap(request.result));\n            unlisten();\n        };\n        const error = () => {\n            reject(request.error);\n            unlisten();\n        };\n        request.addEventListener('success', success);\n        request.addEventListener('error', error);\n    });\n    // This mapping exists in reverseTransformCache but doesn't exist in transformCache. This\n    // is because we create many promises from a single IDBRequest.\n    reverseTransformCache.set(promise, request);\n    return promise;\n}\nfunction cacheDonePromiseForTransaction(tx) {\n    // Early bail if we've already created a done promise for this transaction.\n    if (transactionDoneMap.has(tx))\n        return;\n    const done = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            tx.removeEventListener('complete', complete);\n            tx.removeEventListener('error', error);\n            tx.removeEventListener('abort', error);\n        };\n        const complete = () => {\n            resolve();\n            unlisten();\n        };\n        const error = () => {\n            reject(tx.error || new DOMException('AbortError', 'AbortError'));\n            unlisten();\n        };\n        tx.addEventListener('complete', complete);\n        tx.addEventListener('error', error);\n        tx.addEventListener('abort', error);\n    });\n    // Cache it for later retrieval.\n    transactionDoneMap.set(tx, done);\n}\nlet idbProxyTraps = {\n    get(target, prop, receiver) {\n        if (target instanceof IDBTransaction) {\n            // Special handling for transaction.done.\n            if (prop === 'done')\n                return transactionDoneMap.get(target);\n            // Make tx.store return the only store in the transaction, or undefined if there are many.\n            if (prop === 'store') {\n                return receiver.objectStoreNames[1]\n                    ? undefined\n                    : receiver.objectStore(receiver.objectStoreNames[0]);\n            }\n        }\n        // Else transform whatever we get back.\n        return wrap(target[prop]);\n    },\n    set(target, prop, value) {\n        target[prop] = value;\n        return true;\n    },\n    has(target, prop) {\n        if (target instanceof IDBTransaction &&\n            (prop === 'done' || prop === 'store')) {\n            return true;\n        }\n        return prop in target;\n    },\n};\nfunction replaceTraps(callback) {\n    idbProxyTraps = callback(idbProxyTraps);\n}\nfunction wrapFunction(func) {\n    // Due to expected object equality (which is enforced by the caching in `wrap`), we\n    // only create one new func per func.\n    // Cursor methods are special, as the behaviour is a little more different to standard IDB. In\n    // IDB, you advance the cursor and wait for a new 'success' on the IDBRequest that gave you the\n    // cursor. It's kinda like a promise that can resolve with many values. That doesn't make sense\n    // with real promises, so each advance methods returns a new promise for the cursor object, or\n    // undefined if the end of the cursor has been reached.\n    if (getCursorAdvanceMethods().includes(func)) {\n        return function (...args) {\n            // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n            // the original object.\n            func.apply(unwrap(this), args);\n            return wrap(this.request);\n        };\n    }\n    return function (...args) {\n        // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n        // the original object.\n        return wrap(func.apply(unwrap(this), args));\n    };\n}\nfunction transformCachableValue(value) {\n    if (typeof value === 'function')\n        return wrapFunction(value);\n    // This doesn't return, it just creates a 'done' promise for the transaction,\n    // which is later returned for transaction.done (see idbObjectHandler).\n    if (value instanceof IDBTransaction)\n        cacheDonePromiseForTransaction(value);\n    if (instanceOfAny(value, getIdbProxyableTypes()))\n        return new Proxy(value, idbProxyTraps);\n    // Return the same value back if we're not going to transform it.\n    return value;\n}\nfunction wrap(value) {\n    // We sometimes generate multiple promises from a single IDBRequest (eg when cursoring), because\n    // IDB is weird and a single IDBRequest can yield many responses, so these can't be cached.\n    if (value instanceof IDBRequest)\n        return promisifyRequest(value);\n    // If we've already transformed this value before, reuse the transformed value.\n    // This is faster, but it also provides object equality.\n    if (transformCache.has(value))\n        return transformCache.get(value);\n    const newValue = transformCachableValue(value);\n    // Not all types are transformed.\n    // These may be primitive types, so they can't be WeakMap keys.\n    if (newValue !== value) {\n        transformCache.set(value, newValue);\n        reverseTransformCache.set(newValue, value);\n    }\n    return newValue;\n}\nconst unwrap = (value) => reverseTransformCache.get(value);\n\n/**\n * Open a database.\n *\n * @param name Name of the database.\n * @param version Schema version.\n * @param callbacks Additional callbacks.\n */\nfunction openDB(name, version, { blocked, upgrade, blocking, terminated } = {}) {\n    const request = indexedDB.open(name, version);\n    const openPromise = wrap(request);\n    if (upgrade) {\n        request.addEventListener('upgradeneeded', (event) => {\n            upgrade(wrap(request.result), event.oldVersion, event.newVersion, wrap(request.transaction), event);\n        });\n    }\n    if (blocked) {\n        request.addEventListener('blocked', (event) => blocked(\n        // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405\n        event.oldVersion, event.newVersion, event));\n    }\n    openPromise\n        .then((db) => {\n        if (terminated)\n            db.addEventListener('close', () => terminated());\n        if (blocking) {\n            db.addEventListener('versionchange', (event) => blocking(event.oldVersion, event.newVersion, event));\n        }\n    })\n        .catch(() => { });\n    return openPromise;\n}\n/**\n * Delete a database.\n *\n * @param name Name of the database.\n */\nfunction deleteDB(name, { blocked } = {}) {\n    const request = indexedDB.deleteDatabase(name);\n    if (blocked) {\n        request.addEventListener('blocked', (event) => blocked(\n        // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405\n        event.oldVersion, event));\n    }\n    return wrap(request).then(() => undefined);\n}\n\nconst readMethods = ['get', 'getKey', 'getAll', 'getAllKeys', 'count'];\nconst writeMethods = ['put', 'add', 'delete', 'clear'];\nconst cachedMethods = new Map();\nfunction getMethod(target, prop) {\n    if (!(target instanceof IDBDatabase &&\n        !(prop in target) &&\n        typeof prop === 'string')) {\n        return;\n    }\n    if (cachedMethods.get(prop))\n        return cachedMethods.get(prop);\n    const targetFuncName = prop.replace(/FromIndex$/, '');\n    const useIndex = prop !== targetFuncName;\n    const isWrite = writeMethods.includes(targetFuncName);\n    if (\n    // Bail if the target doesn't exist on the target. Eg, getAll isn't in Edge.\n    !(targetFuncName in (useIndex ? IDBIndex : IDBObjectStore).prototype) ||\n        !(isWrite || readMethods.includes(targetFuncName))) {\n        return;\n    }\n    const method = async function (storeName, ...args) {\n        // isWrite ? 'readwrite' : undefined gzipps better, but fails in Edge :(\n        const tx = this.transaction(storeName, isWrite ? 'readwrite' : 'readonly');\n        let target = tx.store;\n        if (useIndex)\n            target = target.index(args.shift());\n        // Must reject if op rejects.\n        // If it's a write operation, must reject if tx.done rejects.\n        // Must reject with op rejection first.\n        // Must resolve with op value.\n        // Must handle both promises (no unhandled rejections)\n        return (await Promise.all([\n            target[targetFuncName](...args),\n            isWrite && tx.done,\n        ]))[0];\n    };\n    cachedMethods.set(prop, method);\n    return method;\n}\nreplaceTraps((oldTraps) => ({\n    ...oldTraps,\n    get: (target, prop, receiver) => getMethod(target, prop) || oldTraps.get(target, prop, receiver),\n    has: (target, prop) => !!getMethod(target, prop) || oldTraps.has(target, prop),\n}));\n\nconst advanceMethodProps = ['continue', 'continuePrimaryKey', 'advance'];\nconst methodMap = {};\nconst advanceResults = new WeakMap();\nconst ittrProxiedCursorToOriginalProxy = new WeakMap();\nconst cursorIteratorTraps = {\n    get(target, prop) {\n        if (!advanceMethodProps.includes(prop))\n            return target[prop];\n        let cachedFunc = methodMap[prop];\n        if (!cachedFunc) {\n            cachedFunc = methodMap[prop] = function (...args) {\n                advanceResults.set(this, ittrProxiedCursorToOriginalProxy.get(this)[prop](...args));\n            };\n        }\n        return cachedFunc;\n    },\n};\nasync function* iterate(...args) {\n    // tslint:disable-next-line:no-this-assignment\n    let cursor = this;\n    if (!(cursor instanceof IDBCursor)) {\n        cursor = await cursor.openCursor(...args);\n    }\n    if (!cursor)\n        return;\n    cursor = cursor;\n    const proxiedCursor = new Proxy(cursor, cursorIteratorTraps);\n    ittrProxiedCursorToOriginalProxy.set(proxiedCursor, cursor);\n    // Map this double-proxy back to the original, so other cursor methods work.\n    reverseTransformCache.set(proxiedCursor, unwrap(cursor));\n    while (cursor) {\n        yield proxiedCursor;\n        // If one of the advancing methods was not called, call continue().\n        cursor = await (advanceResults.get(proxiedCursor) || cursor.continue());\n        advanceResults.delete(proxiedCursor);\n    }\n}\nfunction isIteratorProp(target, prop) {\n    return ((prop === Symbol.asyncIterator &&\n        instanceOfAny(target, [IDBIndex, IDBObjectStore, IDBCursor])) ||\n        (prop === 'iterate' && instanceOfAny(target, [IDBIndex, IDBObjectStore])));\n}\nreplaceTraps((oldTraps) => ({\n    ...oldTraps,\n    get(target, prop, receiver) {\n        if (isIteratorProp(target, prop))\n            return iterate;\n        return oldTraps.get(target, prop, receiver);\n    },\n    has(target, prop) {\n        return isIteratorProp(target, prop) || oldTraps.has(target, prop);\n    },\n}));\n\nexport { deleteDB, openDB, unwrap, wrap };\n","/* eslint-disable func-names */\n/* eslint-disable no-null/no-null */\n/* eslint-disable no-restricted-syntax */\n/* eslint-disable max-len */\nimport type { IVSDocument } from '../types/IVSDocument';\nimport type { IVSFilterCriteria, IVSFilterOptions } from '../types/IVSFilterOptions';\n\nexport function filterDocuments(documents: Array<IVSDocument<any>>, filterOptions?: IVSFilterOptions): Array<IVSDocument<any>> {\n  let filteredDocuments = documents;\n  if (filterOptions) {\n    if (filterOptions.include) {\n      filteredDocuments = filteredDocuments.filter((doc) => matchesCriteria(doc, filterOptions.include!));\n    }\n    if (filterOptions.exclude) {\n      filteredDocuments = filteredDocuments.filter((doc) => !matchesCriteria(doc, filterOptions.exclude!));\n    }\n  }\n  return filteredDocuments;\n}\n\nfunction matchesCriteria(document: IVSDocument<any>, criteria: IVSFilterCriteria): boolean {\n  if (criteria.metadata) {\n    for (const key in criteria.metadata) {\n      if (document.metadata[key] !== criteria.metadata[key]) {\n        return false;\n      }\n    }\n  }\n  if (criteria.text) {\n    const texts = Array.isArray(criteria.text) ? criteria.text : [criteria.text];\n    if (!texts.includes(document.text)) {\n      return false;\n    }\n  }\n  return true;\n}\n\nexport function getObjectSizeInMB(obj: object): number {\n  const bytes = JSON.stringify(obj).length;\n  const kilobytes = bytes / 1024;\n  return kilobytes / 1024;\n}\n\nexport function debounce(func: (...args: any[]) => void, delay: number): (...args: any[]) => void {\n  let timeoutId: NodeJS.Timeout | null = null;\n\n  return function (this: any, ...args: any[]) {\n    const context = this;\n\n    if (timeoutId) {\n      clearTimeout(timeoutId);\n    }\n\n    timeoutId = setTimeout(() => func.apply(context, args), delay);\n  };\n}\n","/* eslint-disable no-async-without-await/no-async-without-await */\n/* eslint-disable no-console */\n/* eslint-disable class-methods-use-this */\n/* eslint-disable max-len */\nimport type { IDBPDatabase } from 'idb';\nimport { openDB } from 'idb';\n\nimport type { ICreateEmbeddingResponse } from './types/ICreateEmbeddingResponse';\nimport type { IVSDocument, IVSSimilaritySearchItem } from './types/IVSDocument';\nimport type { IVSOptions } from './types/IVSOptions';\nimport type { IVSSimilaritySearchParams } from './types/IVSSimilaritySearchParams';\n\nimport { constants } from './common/constants';\nimport { filterDocuments, getObjectSizeInMB } from './common/helpers';\n\nexport class VectorStorage<T> {\n  private db!: IDBPDatabase<any>;\n\n  private documents: Array<IVSDocument<T>> = [];\n\n  private readonly maxSizeInMB: number;\n\n  private readonly debounceTime: number;\n\n  private readonly openaiModel: string;\n\n  private readonly openaiApiKey?: string;\n\n  private readonly embedTextsFn: (texts: string[]) => Promise<number[][]>;\n\n  private readonly dbName: string;\n\n  constructor(options: IVSOptions = {}) {\n    this.dbName = options.dbName ?? constants.DEFAULT_DB_NAME;\n    this.maxSizeInMB = options.maxSizeInMB ?? constants.DEFAULT_MAX_SIZE_IN_MB;\n    this.debounceTime = options.debounceTime ?? constants.DEFAULT_DEBOUNCE_TIME;\n    this.openaiModel = options.openaiModel ?? constants.DEFAULT_OPENAI_MODEL;\n    this.embedTextsFn = options.embedTextsFn ?? this.embedTexts; // Use the custom function if provided, else use the default one\n    this.openaiApiKey = options.openAIApiKey;\n    if (!this.openaiApiKey && !options.embedTextsFn) {\n      console.error('VectorStorage: pass as an option either an OpenAI API key or a custom embedTextsFn function.');\n    } else {\n      this.loadFromIndexDbStorage();\n    }\n  }\n\n  public async addText(text: string, id:string, metadata: T): Promise<IVSDocument<T>> {\n    // Create a document from the text and metadata\n    const doc: IVSDocument<T> = {\n      metadata,\n      text,\n      id,\n      timestamp: Date.now(),\n      vector: [],\n      vectorMag: 0,\n    };\n    const docs = await this.addDocuments([doc]);\n    return docs[0];\n  }\n\n  public async updateText(text: string, id:string, metadata: T): Promise<IVSDocument<T>> {\n    const doc: IVSDocument<T> = {\n      metadata,\n      text,\n      id,\n      timestamp: Date.now(),\n      vector: [],\n      vectorMag: 0,\n    };\n    const docs = await this.updateDocument(doc);\n    return docs;\n  }\n\n  public async deleteText(id: string): Promise<void> {\n    this.documents = this.documents.filter((doc) => doc.id !== id);\n    if (!this.db) {\n      this.db = await this.initDB();\n    }\n    try {\n      const tx = this.db.transaction('documents', 'readwrite');\n      tx.objectStore('documents').delete(id);\n      await tx.done;\n    } catch (error) {\n      console.error('Error deleting text:', error);\n    }\n  }\n\n  public async getText(id: string): Promise<any | undefined> {\n    if (!this.db) {\n      this.db = await this.initDB();\n    }\n    const tx = this.db.transaction('documents', 'readonly');\n    const result = await tx.objectStore('documents').get(id);\n    return result;\n  }\n\n  public async addTexts(texts: string[], metadatas: T[]): Promise<Array<IVSDocument<T>>> {\n    if (texts.length !== metadatas.length) {\n      throw new Error('The lengths of texts and metadata arrays must match.');\n    }\n    const docs: Array<IVSDocument<T>> = texts.map((text, index) => ({\n      metadata: metadatas[index],\n      text,\n      timestamp: Date.now(),\n      vector: [],\n      vectorMag: 0,\n    }));\n    return this.addDocuments(docs);\n  }\n\n  public async similaritySearch(params: IVSSimilaritySearchParams): Promise<{\n    similarItems: Array<IVSSimilaritySearchItem<T>>;\n    query: { text: string; embedding: number[] };\n  }> {\n    const {\n      query, k = 4, filterOptions, includeValues,\n    } = params;\n    const queryEmbedding = await this.embedText(query);\n    const queryMagnitude = await this.calculateMagnitude(queryEmbedding);\n    const filteredDocuments = filterDocuments(this.documents, filterOptions);\n    const scoresPairs: Array<[IVSDocument<T>, number]> = this.calculateSimilarityScores(filteredDocuments, queryEmbedding, queryMagnitude);\n    const sortedPairs = scoresPairs.sort((a, b) => b[1] - a[1]);\n    const results = sortedPairs.slice(0, k).map((pair) => ({ ...pair[0], score: pair[1] }));\n    this.updateHitCounters(results);\n    if (results.length > 0) {\n      this.removeDocsLRU();\n      // await this.saveToIndexDbStorage();\n    }\n    if (!includeValues) {\n      results.forEach((result) => {\n        delete result.vector;\n        delete result.vectorMag;\n      });\n    }\n    return {\n      query: { embedding: queryEmbedding, text: query },\n      similarItems: results,\n    };\n  }\n\n  private async initDB(): Promise<IDBPDatabase<any>> {\n    return openDB<any>(this.dbName, undefined, {\n      upgrade(db) {\n        const documentStore = db.createObjectStore('documents', {\n          autoIncrement: true,\n          keyPath: 'id',\n        });\n        documentStore.createIndex('text', 'text', { unique: true });\n        documentStore.createIndex('metadata', 'metadata');\n        documentStore.createIndex('timestamp', 'timestamp');\n        documentStore.createIndex('vector', 'vector');\n        documentStore.createIndex('vectorMag', 'vectorMag');\n        documentStore.createIndex('hits', 'hits');\n        documentStore.createIndex('id', 'id', { unique: true });\n      },\n    });\n  }\n\n  private async addDocuments(documents: Array<IVSDocument<T>>): Promise<Array<IVSDocument<T>>> {\n    // filter out already existing documents\n    const newDocuments = documents.filter((doc) => !this.documents.some((d) => d.text === doc.text));\n    // If there are no new documents, return an empty array\n    if (newDocuments.length === 0) {\n      return [];\n    }\n    const newVectors = await this.embedTextsFn(newDocuments.map((doc) => doc.text));\n    // Assign vectors and precompute vector magnitudes for new documents\n    newDocuments.forEach((doc, index) => {\n      doc.vector = newVectors[index];\n      doc.vectorMag = calcVectorMagnitude(doc);\n    });\n    // Add new documents to the store\n    this.documents.push(...newDocuments);\n    this.removeDocsLRU();\n    // Save to index db storage\n    await this.addToIndexDbStorage(newDocuments);\n    return newDocuments;\n  }\n\n  private async updateDocument(document: IVSDocument<T>): Promise<IVSDocument<T>> {\n    const newVectors = await this.embedTextsFn([document.text]);\n    document.vector = newVectors[0];\n    document.vectorMag = calcVectorMagnitude(document);\n    const oldDoc = this.documents.find((doc) => doc.id === document.id);\n    if (oldDoc) {\n      // Add new documents to the store\n      this.documents = this.documents.map((doc) => {\n        if (doc.id === document.id) {\n          return document;\n        }\n        return doc;\n      });\n    } else {\n      this.documents.push(document);\n    }\n\n    this.removeDocsLRU();\n    // Save to index db storage\n    await this.addToIndexDbStorage([document]);\n    return document;\n  }\n\n  private async embedTexts(texts: string[]): Promise<number[][]> {\n    const response = await fetch(constants.OPENAI_API_URL, {\n      body: JSON.stringify({\n        input: texts,\n        model: this.openaiModel,\n      }),\n      headers: {\n        Authorization: `Bearer ${this.openaiApiKey}`,\n        'Content-Type': 'application/json',\n      },\n      method: 'POST',\n    });\n\n    if (!response.ok) {\n      throw new Error(`HTTP error! status: ${response.status}`);\n    }\n\n    const responseData = (await response.json()) as ICreateEmbeddingResponse;\n    return responseData.data.map((data) => data.embedding);\n  }\n\n  private async embedText(query: string): Promise<number[]> {\n    return (await this.embedTextsFn([query]))[0];\n  }\n\n  private calculateMagnitude(embedding: number[]): number {\n    const queryMagnitude = Math.sqrt(embedding.reduce((sum, val) => sum + val * val, 0));\n    return queryMagnitude;\n  }\n\n  private calculateSimilarityScores(filteredDocuments: Array<IVSDocument<T>>, queryVector: number[], queryMagnitude: number): Array<[IVSDocument<T>, number]> {\n    return filteredDocuments.map((doc) => {\n      const dotProduct = doc.vector!.reduce((sum, val, i) => sum + val * queryVector[i], 0);\n      let score = getCosineSimilarityScore(dotProduct, doc.vectorMag!, queryMagnitude);\n      score = normalizeScore(score); // Normalize the score\n      return [doc, score];\n    });\n  }\n\n  private updateHitCounters(results: Array<IVSDocument<T>>): void {\n    results.forEach((doc) => {\n      doc.hits = (doc.hits ?? 0) + 1; // Update hit counter\n    });\n  }\n\n  private async loadFromIndexDbStorage(): Promise<void> {\n    if (!this.db) {\n      this.db = await this.initDB();\n    }\n    this.documents = await this.db.getAll('documents');\n    this.removeDocsLRU();\n  }\n\n  private async saveToIndexDbStorage(): Promise<void> {\n    if (!this.db) {\n      this.db = await this.initDB();\n    }\n    try {\n      const tx = this.db.transaction('documents', 'readwrite');\n      await tx.objectStore('documents').clear();\n      for (const doc of this.documents) {\n        // eslint-disable-next-line no-await-in-loop\n        await tx.objectStore('documents').put(doc);\n      }\n      await tx.done;\n    } catch (error: any) {\n      console.error('Failed to save to IndexedDB:', error.message);\n    }\n  }\n\n  private async addToIndexDbStorage(documents:Array<IVSDocument<T>>): Promise<void> {\n    if (!this.db) {\n      this.db = await this.initDB();\n    }\n    try {\n      const tx = this.db.transaction('documents', 'readwrite');\n      for (const doc of documents) {\n        // eslint-disable-next-line no-await-in-loop\n        await tx.objectStore('documents').put(doc);\n      }\n      await tx.done;\n    } catch (error: any) {\n      console.error('Failed to save to IndexedDB:', error.message);\n    }\n  }\n\n  private removeDocsLRU(): void {\n    if (getObjectSizeInMB(this.documents) > this.maxSizeInMB) {\n      // Sort documents by hit counter (ascending) and then by timestamp (ascending)\n      this.documents.sort((a, b) => (a.hits ?? 0) - (b.hits ?? 0) || a.timestamp - b.timestamp);\n\n      // Remove documents until the size is below the limit\n      while (getObjectSizeInMB(this.documents) > this.maxSizeInMB) {\n        this.documents.shift();\n      }\n    }\n  }\n}\n\nfunction calcVectorMagnitude(doc: IVSDocument<any>): number {\n  return Math.sqrt(doc.vector!.reduce((sum, val) => sum + val * val, 0));\n}\n\nfunction getCosineSimilarityScore(dotProduct: number, magnitudeA: number, magnitudeB: number): number {\n  return dotProduct / (magnitudeA * magnitudeB);\n}\n\nfunction normalizeScore(score: number): number {\n  return (score + 1) / 2;\n}\n","// Define constants\nexport const constants = {\n  DEFAULT_DEBOUNCE_TIME: 0,\n  DEFAULT_MAX_SIZE_IN_MB: 2048,\n  DEFAULT_OPENAI_MODEL: 'text-embedding-ada-002',\n  OPENAI_API_URL: 'https://api.openai.com/v1/embeddings',\n  DEFAULT_DB_NAME: 'VectorStorage',\n};\n","/* eslint-disable max-len */\nimport { VectorStorage } from './vector-storage/VectorStorage';\n\nasync function embedTextsFn(texts: string[]): Promise<number[][]> {\n  const response = await fetch('https://telegpt-three.vercel.app/embeddings', {\n    body: JSON.stringify({\n      values: texts,\n      //   model: '',\n    }),\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    method: 'POST',\n  });\n\n  if (!response.ok) {\n    throw new Error(`HTTP error! status: ${response.status}`);\n  }\n\n  const responseData = (await response.json());\n  return responseData.embeddings;\n}\n\nconst vectorStoreMap = new Map();\n\nfunction getVectorStore(dbName: string) {\n  if (!vectorStoreMap.has(dbName)) {\n    vectorStoreMap.set(dbName, new VectorStorage({ embedTextsFn, dbName }));\n  }\n  return vectorStoreMap.get(dbName)!;\n}\n\nexport const toolsEmbeddingStore = getVectorStore('tools-embedding');\nexport const messageEmbeddingStore = getVectorStore('message-embedding');\nexport const knowledgeEmbeddingStore = getVectorStore('knowledge-embedding');\n(window as any).toolsEmbeddingStore = toolsEmbeddingStore;\n","import { addCallback } from '../../lib/teact/teactn';\nimport { getGlobal } from '../../global';\n\nimport type { ApiSticker } from '../../api/types';\nimport type { GlobalState } from '../../global/types';\nimport { ApiMediaFormat } from '../../api/types';\n\nimport { requestMutation } from '../../lib/fasterdom/fasterdom';\nimport { getStickerHashById } from '../../global/helpers';\nimport { selectCanPlayAnimatedEmojis } from '../../global/selectors';\nimport { IS_WEBM_SUPPORTED } from '../browser/windowEnvironment';\nimport { createCallbackManager } from '../callbacks';\nimport generateUniqueId from '../generateUniqueId';\nimport * as mediaLoader from '../mediaLoader';\nimport { throttle } from '../schedulers';\n\nimport blankSrc from '../../assets/blank.png';\nimport placeholderSrc from '../../assets/square.svg';\n\ntype CustomEmojiLoadCallback = (customEmojis: GlobalState['customEmojis']) => void;\ntype CustomEmojiInputRenderCallback = (emojiId: string) => void;\n\nconst DOM_PROCESS_THROTTLE = 500;\n\nconst INPUT_WAITING_CUSTOM_EMOJI_IDS: Set<string> = new Set();\n\nconst handlers = new Map<CustomEmojiLoadCallback, string>();\nconst renderCallbacks = createCallbackManager<CustomEmojiInputRenderCallback>();\n\nlet prevGlobal: GlobalState | undefined;\n\naddCallback((global: GlobalState) => {\n  if (\n    global.customEmojis.byId !== prevGlobal?.customEmojis.byId\n    || selectCanPlayAnimatedEmojis(global) !== selectCanPlayAnimatedEmojis(prevGlobal)\n  ) {\n    for (const entry of handlers) {\n      const [handler, id] = entry;\n      if (global.customEmojis.byId[id]) {\n        handler(global.customEmojis);\n      }\n    }\n\n    checkInputCustomEmojiLoad(global.customEmojis);\n  }\n\n  prevGlobal = global;\n});\n\nexport function addCustomEmojiCallback(handler: CustomEmojiLoadCallback, emojiId: string) {\n  handlers.set(handler, emojiId);\n}\n\nexport function removeCustomEmojiCallback(handler: CustomEmojiLoadCallback) {\n  handlers.delete(handler);\n}\n\nexport const addCustomEmojiInputRenderCallback = renderCallbacks.addCallback;\nconst callInputRenderHandlers = throttle(renderCallbacks.runCallbacks, DOM_PROCESS_THROTTLE);\n\nfunction processDomForCustomEmoji() {\n  const emojis = document.querySelectorAll<HTMLImageElement>('.custom-emoji.placeholder');\n  emojis.forEach((emoji) => {\n    const customEmoji = getGlobal().customEmojis.byId[emoji.dataset.documentId!];\n    if (!customEmoji) {\n      INPUT_WAITING_CUSTOM_EMOJI_IDS.add(emoji.dataset.documentId!);\n      return;\n    }\n    const [isPlaceholder, src, uniqueId] = getInputCustomEmojiParams(customEmoji);\n\n    if (customEmoji.shouldUseTextColor && !emoji.classList.contains('colorable')) {\n      requestMutation(() => {\n        emoji.classList.add('colorable');\n      });\n    }\n\n    if (!isPlaceholder) {\n      requestMutation(() => {\n        emoji.src = src;\n        emoji.classList.remove('placeholder');\n        if (uniqueId) emoji.dataset.uniqueId = uniqueId;\n\n        callInputRenderHandlers(customEmoji.id);\n      });\n    }\n  });\n}\n\nexport const processMessageInputForCustomEmoji = throttle(processDomForCustomEmoji, DOM_PROCESS_THROTTLE);\n\nfunction checkInputCustomEmojiLoad(customEmojis: GlobalState['customEmojis']) {\n  const loaded = Array.from(INPUT_WAITING_CUSTOM_EMOJI_IDS).filter((id) => Boolean(customEmojis.byId[id]));\n  if (loaded.length) {\n    loaded.forEach((id) => INPUT_WAITING_CUSTOM_EMOJI_IDS.delete(id));\n    processMessageInputForCustomEmoji();\n  }\n}\n\nexport function getCustomEmojiMediaDataForInput(emojiId: string, isPreview?: boolean) {\n  const mediaHash = getStickerHashById(emojiId, isPreview);\n  const data = mediaLoader.getFromMemory(mediaHash);\n  if (data) {\n    return data;\n  }\n\n  fetchAndProcess(mediaHash);\n  return undefined;\n}\n\nfunction fetchAndProcess(mediaHash: string) {\n  return mediaLoader.fetch(mediaHash, ApiMediaFormat.BlobUrl).then(() => {\n    processMessageInputForCustomEmoji();\n  });\n}\n\nexport function getInputCustomEmojiParams(customEmoji?: ApiSticker) {\n  if (!customEmoji) return [true, placeholderSrc, undefined];\n  const shouldUseStaticFallback = !IS_WEBM_SUPPORTED && customEmoji.isVideo;\n  const isUsingSharedCanvas = customEmoji.isLottie || (customEmoji.isVideo && !shouldUseStaticFallback);\n  if (isUsingSharedCanvas) {\n    fetchAndProcess(`sticker${customEmoji.id}`);\n    return [false, blankSrc, generateUniqueId()];\n  }\n\n  const mediaData = getCustomEmojiMediaDataForInput(customEmoji.id, shouldUseStaticFallback);\n\n  return [!mediaData, mediaData || placeholderSrc, undefined];\n}\n","import type { ApiMessage, ApiSponsoredMessage } from '../../api/types';\n\nexport type MessageKey = `msg${string}-${number}`;\n\nexport function getMessageKey(message: ApiMessage | ApiSponsoredMessage): MessageKey {\n  const {\n    chatId,\n  } = message;\n\n  if ('randomId' in message) {\n    return buildMessageKey(chatId, Number(message.randomId));\n  }\n  return buildMessageKey(chatId, message.previousLocalId || message.id);\n}\n\nexport function getMessageServerKey(message: ApiMessage): MessageKey | undefined {\n  if (isLocalMessageId(message.id)) {\n    return undefined;\n  }\n  const { chatId, id } = message;\n  return buildMessageKey(chatId, id);\n}\n\nexport function buildMessageKey(chatId: string, msgId: number): MessageKey {\n  return `msg${chatId}-${msgId}`;\n}\n\nexport function parseMessageKey(key: MessageKey) {\n  const match = key.match(/^msg(-?\\d+)-(\\d+)/)!;\n\n  return { chatId: match[1], messageId: Number(match[2]) };\n}\n\nexport function isLocalMessageId(id: number) {\n  return !Number.isInteger(id);\n}\n","import { useEffect } from '../../lib/teact/teact';\n\nimport { createCallbackManager } from '../../util/callbacks';\nimport useLastCallback from '../useLastCallback';\n\nconst blurCallbacks = createCallbackManager();\nconst focusCallbacks = createCallbackManager();\n\nlet isFocused = document.hasFocus();\n\nwindow.addEventListener('blur', () => {\n  if (!isFocused) {\n    return;\n  }\n\n  isFocused = false;\n  blurCallbacks.runCallbacks();\n});\n\nwindow.addEventListener('focus', () => {\n  isFocused = true;\n  focusCallbacks.runCallbacks();\n});\n\nexport default function useBackgroundMode(\n  onBlur?: AnyToVoidFunction,\n  onFocus?: AnyToVoidFunction,\n  isDisabled = false,\n) {\n  const lastOnBlur = useLastCallback(onBlur);\n  const lastOnFocus = useLastCallback(onFocus);\n\n  useEffect(() => {\n    if (isDisabled) {\n      return undefined;\n    }\n\n    if (!isFocused) {\n      lastOnBlur();\n    }\n\n    blurCallbacks.addCallback(lastOnBlur);\n    focusCallbacks.addCallback(lastOnFocus);\n\n    return () => {\n      focusCallbacks.removeCallback(lastOnFocus);\n      blurCallbacks.removeCallback(lastOnBlur);\n    };\n  }, [isDisabled, lastOnBlur, lastOnFocus]);\n}\n\nexport function isBackgroundModeActive() {\n  return !isFocused;\n}\n","/* eslint-disable no-console */\n\nexport const DEBUG_LEVELS = ['log', 'error', 'warn', 'info', 'debug'] as const;\nexport type DebugLevel = typeof DEBUG_LEVELS[number];\n// @ts-ignore\nconst ORIGINAL_FUNCTIONS: Record<DebugLevel, (...args: any[]) => void> = DEBUG_LEVELS.reduce((acc, level) => {\n  // @ts-ignore\n  acc[level] = console[level];\n  return acc;\n}, {});\n\ntype DebugEntry = {\n  level: DebugLevel;\n  args: any[];\n  date: Date;\n};\nlet DEBUG_LOGS: DebugEntry[] = [];\n\nexport function logDebugMessage(level: DebugLevel, ...args: any[]) {\n  DEBUG_LOGS.push({\n    level,\n    args,\n    date: new Date(),\n  });\n  ORIGINAL_FUNCTIONS[level](...args);\n}\n\nexport function initDebugConsole() {\n  DEBUG_LOGS = [];\n  DEBUG_LEVELS.forEach((level) => {\n    // @ts-ignore\n    console[level] = (...args: any[]) => {\n      logDebugMessage(level, ...args);\n    };\n  });\n}\n\nexport function disableDebugConsole() {\n  DEBUG_LEVELS.forEach((level) => {\n    // @ts-ignore\n    console[level] = ORIGINAL_FUNCTIONS[level];\n  });\n  DEBUG_LOGS = [];\n}\n\nexport function getDebugLogs() {\n  return JSON.stringify(DEBUG_LOGS, (key, value) => (typeof value === 'bigint'\n    ? value.toString()\n    : value));\n}\n","import type { ChangeEvent } from 'react';\n\nimport type { Signal } from '../../util/signals';\nimport type {\n  VirtualElement,\n  VirtualElementChildren,\n  VirtualElementComponent,\n  VirtualElementFragment,\n  VirtualElementParent,\n  VirtualElementReal,\n  VirtualElementTag,\n} from './teact';\n\nimport { DEBUG } from '../../config';\nimport { unique } from '../../util/iteratees';\nimport { addEventListener, removeAllDelegatedListeners, removeEventListener } from './dom-events';\nimport {\n  captureImmediateEffects,\n  hasElementChanged,\n  isParentElement,\n  mountComponent,\n  MountState,\n  renderComponent,\n  unmountComponent,\n  VirtualType,\n} from './teact';\n\ninterface VirtualDomHead {\n  children: [VirtualElement] | [];\n}\n\ninterface SelectionState {\n  selectionStart: number | null;\n  selectionEnd: number | null;\n  isCaretAtEnd: boolean;\n}\n\ntype CurrentContext = Record<string, Signal<unknown>>;\n\ntype DOMElement = HTMLElement | SVGElement;\n\nconst SVG_NAMESPACE = 'http://www.w3.org/2000/svg';\nconst HTML_NAMESPACE = 'http://www.w3.org/1999/xhtml';\n\nconst FILTERED_ATTRIBUTES = new Set(['key', 'ref', 'teactFastList', 'teactOrderKey']);\nconst HTML_ATTRIBUTES = new Set(['dir', 'role', 'form']);\nconst CONTROLLABLE_TAGS = ['INPUT', 'TEXTAREA', 'SELECT'];\nconst MAPPED_ATTRIBUTES: { [k: string]: string } = {\n  autoCapitalize: 'autocapitalize',\n  autoComplete: 'autocomplete',\n  autoCorrect: 'autocorrect',\n  autoPlay: 'autoplay',\n  spellCheck: 'spellcheck',\n};\nconst INDEX_KEY_PREFIX = '__indexKey#';\n\nconst headsByElement = new WeakMap<Element, VirtualDomHead>();\nconst extraClasses = new WeakMap<Element, Set<string>>();\nconst extraStyles = new WeakMap<Element, Record<string, string>>();\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\nlet DEBUG_virtualTreeSize = 1;\n\nfunction render($element: VirtualElement | undefined, parentEl: HTMLElement) {\n  if (!headsByElement.has(parentEl)) {\n    headsByElement.set(parentEl, { children: [] });\n  }\n\n  const runImmediateEffects = captureImmediateEffects();\n  const $head = headsByElement.get(parentEl)!;\n  const $renderedChild = renderWithVirtual(parentEl, $head.children[0], $element, $head, {}, 0);\n  runImmediateEffects?.();\n\n  $head.children = $renderedChild ? [$renderedChild] : [];\n\n  if (process.env.APP_ENV === 'perf') {\n    DEBUG_virtualTreeSize = 0;\n    DEBUG_addToVirtualTreeSize($head);\n\n    return DEBUG_virtualTreeSize;\n  }\n\n  return undefined;\n}\n\nfunction renderWithVirtual<T extends VirtualElement | undefined>(\n  parentEl: DOMElement,\n  $current: VirtualElement | undefined,\n  $new: T,\n  $parent: VirtualElementParent | VirtualDomHead,\n  currentContext: CurrentContext,\n  index: number,\n  options: {\n    skipComponentUpdate?: boolean;\n    nextSibling?: ChildNode;\n    forceMoveToEnd?: boolean;\n    fragment?: DocumentFragment;\n    namespace?: string;\n  } = {},\n): T {\n  const { skipComponentUpdate, fragment } = options;\n  let { nextSibling, namespace } = options;\n\n  const isCurrentComponent = $current?.type === VirtualType.Component;\n  const isNewComponent = $new?.type === VirtualType.Component;\n  const $newAsReal = $new as VirtualElementReal;\n\n  const isCurrentFragment = !isCurrentComponent && $current?.type === VirtualType.Fragment;\n  const isNewFragment = !isNewComponent && $new?.type === VirtualType.Fragment;\n\n  if ($new?.type === VirtualType.Tag) {\n    if ($new.tag === 'svg') namespace = SVG_NAMESPACE;\n    if ($new.props.xmlns) namespace = $new.props.xmlns;\n  }\n\n  if (\n    !skipComponentUpdate\n    && isCurrentComponent && isNewComponent\n    && !hasElementChanged($current!, $new!)\n  ) {\n    $new = updateComponent($current, $new as VirtualElementComponent) as typeof $new;\n  }\n\n  // Parent element may have changed, so we need to update the listener closure.\n  if (\n    !skipComponentUpdate\n    && isNewComponent\n    && ($new as VirtualElementComponent).componentInstance.mountState === MountState.Mounted\n  ) {\n    setupComponentUpdateListener(parentEl, $new as VirtualElementComponent, $parent, currentContext, index);\n  }\n\n  if ($current === $new) {\n    return $new;\n  }\n\n  if (DEBUG && $new) {\n    const newTarget = 'target' in $new && $new.target;\n    if (newTarget && (!$current || ('target' in $current && newTarget !== $current.target))) {\n      throw new Error('[Teact] Cached virtual element was moved within tree');\n    }\n  }\n\n  if (!$current && $new) {\n    if (isNewComponent || isNewFragment) {\n      if (isNewComponent) {\n        $new = initComponent(\n          parentEl, $new as VirtualElementComponent, $parent, currentContext, index,\n        ) as unknown as typeof $new;\n        currentContext = ($new as VirtualElementComponent).componentInstance.context ?? currentContext;\n      }\n\n      mountChildren(parentEl, $new as VirtualElementComponent | VirtualElementFragment, currentContext, {\n        nextSibling, fragment, namespace,\n      });\n    } else {\n      const canSetTextContent = !fragment\n        && !nextSibling\n        && $newAsReal.type === VirtualType.Text\n        && $parent.children.length === 1\n        && !parentEl.firstChild;\n\n      if (canSetTextContent) {\n        parentEl.textContent = $newAsReal.value;\n        $newAsReal.target = parentEl.firstChild!;\n      } else {\n        const node = createNode($newAsReal, currentContext, namespace);\n        $newAsReal.target = node;\n        insertBefore(fragment || parentEl, node, nextSibling);\n\n        if ($newAsReal.type === VirtualType.Tag) {\n          setElementRef($newAsReal, node as DOMElement);\n        }\n      }\n    }\n  } else if ($current && !$new) {\n    remount(parentEl, $current, currentContext, undefined);\n  } else if ($current && $new) {\n    if (hasElementChanged($current, $new)) {\n      if (!nextSibling) {\n        nextSibling = getNextSibling($current);\n      }\n\n      if (isNewComponent || isNewFragment) {\n        if (isNewComponent) {\n          $new = initComponent(\n            parentEl, $new as VirtualElementComponent, $parent, currentContext, index,\n          ) as unknown as typeof $new;\n          currentContext = ($new as VirtualElementComponent).componentInstance.context ?? currentContext;\n        }\n\n        remount(parentEl, $current, currentContext, undefined);\n        mountChildren(parentEl, $new as VirtualElementComponent | VirtualElementFragment, currentContext, {\n          nextSibling, fragment, namespace,\n        });\n      } else {\n        const node = createNode($newAsReal, currentContext, namespace);\n        $newAsReal.target = node;\n        remount(parentEl, $current, currentContext, node, nextSibling);\n\n        if ($newAsReal.type === VirtualType.Tag) {\n          setElementRef($newAsReal, node as DOMElement);\n        }\n      }\n    } else {\n      const isComponent = isCurrentComponent && isNewComponent;\n      const isFragment = isCurrentFragment && isNewFragment;\n\n      if (isComponent || isFragment) {\n        renderChildren(\n          $current,\n          $new as VirtualElementComponent | VirtualElementFragment,\n          currentContext,\n          parentEl,\n          nextSibling,\n          options.forceMoveToEnd,\n        );\n      } else {\n        const $currentAsReal = $current as VirtualElementReal;\n        const currentTarget = $currentAsReal.target!;\n\n        $newAsReal.target = currentTarget;\n        $currentAsReal.target = undefined; // Help GC\n\n        const isTag = $current.type === VirtualType.Tag;\n        if (isTag) {\n          const $newAsTag = $new as VirtualElementTag;\n\n          setElementRef($current, undefined);\n          setElementRef($newAsTag, currentTarget as DOMElement);\n\n          if (nextSibling || options.forceMoveToEnd) {\n            insertBefore(parentEl, currentTarget, nextSibling);\n          }\n\n          updateAttributes($current, $newAsTag, currentTarget as DOMElement, namespace);\n          renderChildren(\n            $current, $newAsTag, currentContext, currentTarget as DOMElement, undefined, undefined, namespace,\n          );\n        }\n      }\n    }\n  }\n\n  return $new;\n}\n\nfunction initComponent(\n  parentEl: DOMElement,\n  $element: VirtualElementComponent,\n  $parent: VirtualElementParent | VirtualDomHead,\n  currentContext: CurrentContext,\n  index: number,\n) {\n  const { componentInstance } = $element;\n\n  $element.componentInstance.context = currentContext;\n\n  if (componentInstance.mountState === MountState.Unmounted) {\n    $element = mountComponent(componentInstance);\n    setupComponentUpdateListener(parentEl, $element, $parent, currentContext, index);\n  }\n\n  return $element;\n}\n\nfunction updateComponent($current: VirtualElementComponent, $new: VirtualElementComponent) {\n  $current.componentInstance.props = $new.componentInstance.props;\n\n  return renderComponent($current.componentInstance);\n}\n\nfunction setupComponentUpdateListener(\n  parentEl: DOMElement,\n  $element: VirtualElementComponent,\n  $parent: VirtualElementParent | VirtualDomHead,\n  currentContext: CurrentContext,\n  index: number,\n) {\n  const { componentInstance } = $element;\n\n  componentInstance.onUpdate = () => {\n    $parent.children[index] = renderWithVirtual(\n      parentEl,\n      $parent.children[index],\n      componentInstance.$element,\n      $parent,\n      currentContext,\n      index,\n      { skipComponentUpdate: true },\n    );\n  };\n}\n\nfunction mountChildren(\n  parentEl: DOMElement,\n  $element: VirtualElementComponent | VirtualElementFragment,\n  currentContext: CurrentContext,\n  options: {\n    nextSibling?: ChildNode;\n    fragment?: DocumentFragment;\n    namespace?: string;\n  },\n) {\n  const { children } = $element;\n  for (let i = 0, l = children.length; i < l; i++) {\n    const $child = children[i];\n    const $renderedChild = renderWithVirtual(parentEl, undefined, $child, $element, currentContext, i, options);\n    if ($renderedChild !== $child) {\n      children[i] = $renderedChild;\n    }\n  }\n}\n\nfunction unmountChildren(\n  parentEl: DOMElement, $element: VirtualElementComponent | VirtualElementFragment, currentContext: CurrentContext,\n) {\n  for (const $child of $element.children) {\n    renderWithVirtual(parentEl, $child, undefined, $element, currentContext, -1);\n  }\n}\n\nfunction createNode($element: VirtualElementReal, currentContext: CurrentContext, namespace = HTML_NAMESPACE): Node {\n  if ($element.type === VirtualType.Empty) {\n    return document.createTextNode('');\n  }\n\n  if ($element.type === VirtualType.Text) {\n    return document.createTextNode($element.value);\n  }\n\n  const { tag, props, children } = $element;\n  const element = document.createElementNS(namespace, tag) as DOMElement;\n\n  processControlled(tag, props);\n\n  // eslint-disable-next-line no-restricted-syntax\n  for (const key in props) {\n    if (!props.hasOwnProperty(key)) continue;\n\n    if (props[key] !== undefined) {\n      setAttribute(element, key, props[key], namespace);\n    }\n  }\n\n  processUncontrolledOnMount(element, props);\n\n  for (let i = 0, l = children.length; i < l; i++) {\n    const $child = children[i];\n    const $renderedChild = renderWithVirtual(element, undefined, $child, $element, currentContext, i, { namespace });\n    if ($renderedChild !== $child) {\n      children[i] = $renderedChild;\n    }\n  }\n\n  return element;\n}\n\nfunction remount(\n  parentEl: DOMElement,\n  $current: VirtualElement,\n  currentContext: CurrentContext,\n  node: Node | undefined,\n  componentNextSibling?: ChildNode,\n) {\n  const isComponent = $current.type === VirtualType.Component;\n  const isFragment = !isComponent && $current.type === VirtualType.Fragment;\n\n  if (isComponent || isFragment) {\n    if (isComponent) {\n      unmountComponent($current.componentInstance);\n    }\n\n    unmountChildren(parentEl, $current, currentContext);\n\n    if (node) {\n      insertBefore(parentEl, node, componentNextSibling);\n    }\n  } else {\n    if (node) {\n      parentEl.replaceChild(node, $current.target!);\n    } else {\n      parentEl.removeChild($current.target!);\n    }\n\n    unmountRealTree($current);\n  }\n}\n\nfunction unmountRealTree($element: VirtualElement) {\n  if ($element.type === VirtualType.Component) {\n    unmountComponent($element.componentInstance);\n  } else if ($element.type !== VirtualType.Fragment) {\n    if ($element.type === VirtualType.Tag) {\n      extraClasses.delete($element.target!);\n      setElementRef($element, undefined);\n      removeAllDelegatedListeners($element.target!);\n    }\n\n    $element.target = undefined; // Help GC\n\n    if ($element.type !== VirtualType.Tag) {\n      return;\n    }\n  }\n\n  for (const $child of $element.children) {\n    unmountRealTree($child);\n  }\n}\n\nfunction insertBefore(parentEl: DOMElement | DocumentFragment, node: Node, nextSibling?: ChildNode) {\n  if (nextSibling) {\n    parentEl.insertBefore(node, nextSibling);\n  } else {\n    parentEl.appendChild(node);\n  }\n}\n\nfunction getNextSibling($current: VirtualElement): ChildNode | undefined {\n  if ($current.type === VirtualType.Component || $current.type === VirtualType.Fragment) {\n    const lastChild = $current.children[$current.children.length - 1];\n    return getNextSibling(lastChild);\n  }\n\n  return $current.target!.nextSibling || undefined;\n}\n\nfunction renderChildren(\n  $current: VirtualElementParent,\n  $new: VirtualElementParent,\n  currentContext: CurrentContext,\n  currentEl: DOMElement,\n  nextSibling?: ChildNode,\n  forceMoveToEnd = false,\n  namespace?: string,\n) {\n  if (DEBUG) {\n    DEBUG_checkKeyUniqueness($new.children);\n  }\n\n  if (('props' in $new) && $new.props.teactFastList) {\n    renderFastListChildren($current, $new, currentContext, currentEl);\n    return;\n  }\n\n  const currentChildren = $current.children;\n  const newChildren = $new.children;\n\n  const currentChildrenLength = currentChildren.length;\n  const newChildrenLength = newChildren.length;\n  const maxLength = Math.max(currentChildrenLength, newChildrenLength);\n\n  const fragment = newChildrenLength > currentChildrenLength ? document.createDocumentFragment() : undefined;\n  const lastCurrentChild = $current.children[currentChildrenLength - 1];\n  const fragmentNextSibling = fragment && (\n    nextSibling || (lastCurrentChild ? getNextSibling(lastCurrentChild) : undefined)\n  );\n\n  for (let i = 0; i < maxLength; i++) {\n    const $renderedChild = renderWithVirtual(\n      currentEl,\n      currentChildren[i],\n      newChildren[i],\n      $new,\n      currentContext,\n      i,\n      i >= currentChildrenLength ? { fragment, namespace } : { nextSibling, forceMoveToEnd, namespace },\n    );\n\n    if ($renderedChild && $renderedChild !== newChildren[i]) {\n      newChildren[i] = $renderedChild;\n    }\n  }\n\n  if (fragment) {\n    insertBefore(currentEl, fragment, fragmentNextSibling);\n  }\n}\n\n// This function allows to prepend/append a bunch of new DOM nodes to the top/bottom of preserved ones.\n// It also allows to selectively move particular preserved nodes within their DOM list.\nfunction renderFastListChildren(\n  $current: VirtualElementParent, $new: VirtualElementParent, currentContext: CurrentContext, currentEl: DOMElement,\n) {\n  const currentChildren = $current.children;\n  const newChildren = $new.children;\n\n  const newKeys = new Set();\n  for (const $newChild of newChildren) {\n    const key = 'props' in $newChild ? $newChild.props.key : undefined;\n\n    if (DEBUG && isParentElement($newChild)) {\n      // eslint-disable-next-line no-null/no-null\n      if (key === undefined || key === null) {\n        // eslint-disable-next-line no-console\n        console.warn('Missing `key` in `teactFastList`');\n      }\n\n      if ($newChild.type === VirtualType.Fragment) {\n        throw new Error('[Teact] Fragment can not be child of container with `teactFastList`');\n      }\n    }\n\n    newKeys.add(key);\n  }\n\n  // Build a collection of old children that also remain in the new list\n  let currentRemainingIndex = 0;\n  const remainingByKey: Record<string, { $element: VirtualElement; index: number; orderKey?: number }> = {};\n  for (let i = 0, l = currentChildren.length; i < l; i++) {\n    const $currentChild = currentChildren[i];\n\n    let key = 'props' in $currentChild ? $currentChild.props.key : undefined;\n    // eslint-disable-next-line no-null/no-null\n    const isKeyPresent = key !== undefined && key !== null;\n\n    // First we process removed children\n    if (isKeyPresent && !newKeys.has(key)) {\n      renderWithVirtual(currentEl, $currentChild, undefined, $new, currentContext, -1);\n\n      continue;\n    } else if (!isKeyPresent) {\n      const $newChild = newChildren[i];\n      const newChildKey = ($newChild && 'props' in $newChild) ? $newChild.props.key : undefined;\n      // If a non-key element remains at the same index we preserve it with a virtual `key`\n      if ($newChild && !newChildKey) {\n        key = `${INDEX_KEY_PREFIX}${i}`;\n        // Otherwise, we just remove it\n      } else {\n        renderWithVirtual(currentEl, $currentChild, undefined, $new, currentContext, -1);\n\n        continue;\n      }\n    }\n\n    // Then we build up info about remaining children\n    remainingByKey[key] = {\n      $element: $currentChild,\n      index: currentRemainingIndex++,\n      orderKey: 'props' in $currentChild ? $currentChild.props.teactOrderKey : undefined,\n    };\n  }\n\n  let fragmentIndex: number | undefined;\n  let fragmentSize: number | undefined;\n\n  let currentPreservedIndex = 0;\n\n  for (let i = 0, l = newChildren.length; i < l; i++) {\n    const $newChild = newChildren[i];\n    const key = 'props' in $newChild ? $newChild.props.key : `${INDEX_KEY_PREFIX}${i}`;\n    const currentChildInfo = remainingByKey[key];\n\n    if (!currentChildInfo) {\n      if (fragmentSize === undefined) {\n        fragmentIndex = i;\n        fragmentSize = 0;\n      }\n\n      fragmentSize++;\n      continue;\n    }\n\n    // This prepends new children to the top\n    if (fragmentSize) {\n      renderFragment(fragmentIndex!, fragmentSize, currentEl, $new, currentContext);\n      fragmentSize = undefined;\n      fragmentIndex = undefined;\n    }\n\n    // Now we check if a preserved node was moved within preserved list\n    const newOrderKey = 'props' in $newChild ? $newChild.props.teactOrderKey : undefined;\n    // That is indicated by a changed `teactOrderKey` value\n    const shouldMoveNode = (\n      currentChildInfo.index !== currentPreservedIndex && (!newOrderKey || currentChildInfo.orderKey !== newOrderKey)\n    );\n    const isMovingDown = shouldMoveNode && currentPreservedIndex > currentChildInfo.index;\n\n    if (!shouldMoveNode || isMovingDown) {\n      currentPreservedIndex++;\n    }\n\n    const nextSibling = currentEl.childNodes[isMovingDown ? i + 1 : i];\n    const options = shouldMoveNode ? (nextSibling ? { nextSibling } : { forceMoveToEnd: true }) : undefined;\n\n    const $renderedChild = renderWithVirtual(\n      currentEl, currentChildInfo.$element, $newChild, $new, currentContext, i, options,\n    );\n    if ($renderedChild !== $newChild) {\n      newChildren[i] = $renderedChild;\n    }\n  }\n\n  // This appends new children to the bottom\n  if (fragmentSize) {\n    renderFragment(fragmentIndex!, fragmentSize, currentEl, $new, currentContext);\n  }\n}\n\nfunction renderFragment(\n  fragmentIndex: number,\n  fragmentSize: number,\n  parentEl: DOMElement,\n  $parent: VirtualElementParent,\n  currentContext: CurrentContext,\n) {\n  const nextSibling = parentEl.childNodes[fragmentIndex];\n\n  if (fragmentSize === 1) {\n    const $child = $parent.children[fragmentIndex];\n    const $renderedChild = renderWithVirtual(\n      parentEl, undefined, $child, $parent, currentContext, fragmentIndex, { nextSibling },\n    );\n    if ($renderedChild !== $child) {\n      $parent.children[fragmentIndex] = $renderedChild;\n    }\n\n    return;\n  }\n\n  const fragment = document.createDocumentFragment();\n\n  for (let i = fragmentIndex; i < fragmentIndex + fragmentSize; i++) {\n    const $child = $parent.children[i];\n    const $renderedChild = renderWithVirtual(parentEl, undefined, $child, $parent, currentContext, i, { fragment });\n    if ($renderedChild !== $child) {\n      $parent.children[i] = $renderedChild;\n    }\n  }\n\n  insertBefore(parentEl, fragment, nextSibling);\n}\n\nfunction setElementRef($element: VirtualElementTag, element: DOMElement | undefined) {\n  const { ref } = $element.props;\n\n  if (typeof ref === 'object') {\n    ref.current = element;\n    ref.onChange?.();\n  } else if (typeof ref === 'function') {\n    ref(element);\n  }\n}\n\nfunction processControlled(tag: string, props: AnyLiteral) {\n  // TODO Remove after tests\n  if (!props.teactExperimentControlled) {\n    return;\n  }\n\n  const isValueControlled = props.value !== undefined;\n  const isCheckedControlled = props.checked !== undefined;\n  const isControlled = (isValueControlled || isCheckedControlled) && CONTROLLABLE_TAGS.includes(tag.toUpperCase());\n  if (!isControlled) {\n    return;\n  }\n\n  const {\n    value, checked, onInput, onChange,\n  } = props;\n\n  props.onChange = undefined;\n  props.onInput = (e: ChangeEvent<HTMLInputElement>) => {\n    onInput?.(e);\n    onChange?.(e);\n\n    if (value !== undefined && value !== e.currentTarget.value) {\n      const { selectionStart, selectionEnd } = e.currentTarget;\n      const isCaretAtEnd = selectionStart === selectionEnd && selectionEnd === e.currentTarget.value.length;\n\n      e.currentTarget.value = value;\n\n      if (typeof selectionStart === 'number' && typeof selectionEnd === 'number') {\n        e.currentTarget.setSelectionRange(selectionStart, selectionEnd);\n\n        const selectionState: SelectionState = { selectionStart, selectionEnd, isCaretAtEnd };\n        // eslint-disable-next-line no-underscore-dangle\n        e.currentTarget.dataset.__teactSelectionState = JSON.stringify(selectionState);\n      }\n    }\n\n    if (checked !== undefined) {\n      e.currentTarget.checked = checked;\n    }\n  };\n}\n\nfunction processUncontrolledOnMount(element: DOMElement, props: AnyLiteral) {\n  if (!CONTROLLABLE_TAGS.includes(element.tagName)) {\n    return;\n  }\n\n  if (props.defaultValue) {\n    setAttribute(element, 'value', props.defaultValue);\n  }\n\n  if (props.defaultChecked) {\n    setAttribute(element, 'checked', props.defaultChecked);\n  }\n}\n\nfunction updateAttributes(\n  $current: VirtualElementTag, $new: VirtualElementTag, element: DOMElement, namespace?: string,\n) {\n  processControlled(element.tagName, $new.props);\n\n  const currentEntries = Object.entries($current.props);\n  const newEntries = Object.entries($new.props);\n\n  for (const [key, currentValue] of currentEntries) {\n    const newValue = $new.props[key];\n\n    if (\n      currentValue !== undefined\n      && (\n        newValue === undefined\n        || (currentValue !== newValue && key.startsWith('on'))\n      )\n    ) {\n      removeAttribute(element, key, currentValue);\n    }\n  }\n\n  for (const [key, newValue] of newEntries) {\n    const currentValue = $current.props[key];\n\n    if (newValue !== undefined && newValue !== currentValue) {\n      setAttribute(element, key, newValue, namespace);\n    }\n  }\n}\n\nfunction setAttribute(element: DOMElement, key: string, value: any, namespace?: string) {\n  if (key === 'className') {\n    updateClassName(element, value, namespace);\n  } else if (key === 'value') {\n    const inputEl = element as HTMLInputElement;\n\n    if (inputEl.value !== value) {\n      inputEl.value = value;\n\n      // eslint-disable-next-line no-underscore-dangle\n      const selectionStateJson = inputEl.dataset.__teactSelectionState;\n      if (selectionStateJson) {\n        const { selectionStart, selectionEnd, isCaretAtEnd } = JSON.parse(selectionStateJson) as SelectionState;\n\n        if (isCaretAtEnd) {\n          const length = inputEl.value.length;\n          inputEl.setSelectionRange(length, length);\n        } else if (typeof selectionStart === 'number' && typeof selectionEnd === 'number') {\n          inputEl.setSelectionRange(selectionStart, selectionEnd);\n        }\n      }\n    }\n  } else if (key === 'style') {\n    updateStyle(element, value);\n  } else if (key === 'dangerouslySetInnerHTML') {\n    // eslint-disable-next-line no-underscore-dangle\n    element.innerHTML = value.__html;\n  } else if (key.startsWith('on')) {\n    addEventListener(element, key, value, key.endsWith('Capture'));\n  } else if (\n    namespace === SVG_NAMESPACE || key.startsWith('data-') || key.startsWith('aria-') || HTML_ATTRIBUTES.has(key)\n  ) {\n    element.setAttribute(key, value);\n  } else if (!FILTERED_ATTRIBUTES.has(key)) {\n    (element as any)[MAPPED_ATTRIBUTES[key] || key] = value;\n  }\n}\n\nfunction removeAttribute(element: DOMElement, key: string, value: any) {\n  if (key === 'className') {\n    updateClassName(element, '');\n  } else if (key === 'value') {\n    (element as HTMLInputElement).value = '';\n  } else if (key === 'style') {\n    updateStyle(element, '');\n  } else if (key === 'dangerouslySetInnerHTML') {\n    element.innerHTML = '';\n  } else if (key.startsWith('on')) {\n    removeEventListener(element, key, value, key.endsWith('Capture'));\n  } else if (!FILTERED_ATTRIBUTES.has(key)) {\n    element.removeAttribute(key);\n  }\n}\n\nfunction updateClassName(element: DOMElement, value: string, namespace?: string) {\n  if (namespace === SVG_NAMESPACE) {\n    element.setAttribute('class', value);\n    return;\n  }\n\n  const htmlElement = element as HTMLElement;\n  const extra = extraClasses.get(element);\n  if (!extra) {\n    htmlElement.className = value;\n    return;\n  }\n\n  const extraArray = Array.from(extra);\n  if (value) {\n    extraArray.push(value);\n  }\n\n  htmlElement.className = extraArray.join(' ');\n}\n\nfunction updateStyle(element: DOMElement, value: string) {\n  element.style.cssText = value;\n\n  const extraObject = extraStyles.get(element);\n  if (extraObject) {\n    applyExtraStyles(element);\n  }\n}\n\nexport function addExtraClass(element: DOMElement, className: string) {\n  element.classList.add(className);\n\n  const classList = extraClasses.get(element);\n  if (classList) {\n    classList.add(className);\n  } else {\n    extraClasses.set(element, new Set([className]));\n  }\n}\n\nexport function removeExtraClass(element: DOMElement, className: string) {\n  element.classList.remove(className);\n\n  const classList = extraClasses.get(element);\n  if (classList) {\n    classList.delete(className);\n\n    if (!classList.size) {\n      extraClasses.delete(element);\n    }\n  }\n}\n\nexport function toggleExtraClass(element: DOMElement, className: string, force?: boolean) {\n  if (force === true) {\n    addExtraClass(element, className);\n  } else if (force === false) {\n    removeExtraClass(element, className);\n  } else if (extraClasses.get(element)?.has(className)) {\n    removeExtraClass(element, className);\n  } else {\n    addExtraClass(element, className);\n  }\n}\n\nexport function setExtraStyles(element: DOMElement, styles: Partial<CSSStyleDeclaration> & AnyLiteral) {\n  extraStyles.set(element, styles);\n  applyExtraStyles(element);\n}\n\nfunction applyExtraStyles(element: DOMElement) {\n  const standardStyles = Object.entries(extraStyles.get(element)!).reduce<Record<string, string>>(\n    (acc, [prop, value]) => {\n      if (prop.startsWith('--')) {\n        element.style.setProperty(prop, value);\n      } else {\n        acc[prop] = value;\n      }\n\n      return acc;\n    },\n    {},\n  );\n\n  Object.assign(element.style, standardStyles);\n}\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\nfunction DEBUG_addToVirtualTreeSize($current: VirtualElementParent | VirtualDomHead) {\n  DEBUG_virtualTreeSize += $current.children.length;\n\n  $current.children.forEach(($child) => {\n    if (isParentElement($child)) {\n      DEBUG_addToVirtualTreeSize($child);\n    }\n  });\n}\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\nfunction DEBUG_checkKeyUniqueness(children: VirtualElementChildren) {\n  const firstChild = children[0];\n  if (firstChild && 'props' in firstChild && firstChild.props.key !== undefined) {\n    const keys = children.reduce((acc: any[], child) => {\n      if ('props' in child && child.props.key) {\n        acc.push(child.props.key);\n      }\n\n      return acc;\n    }, []);\n\n    if (keys.length !== unique(keys).length) {\n      // eslint-disable-next-line no-console\n      console.warn('[Teact] Duplicated keys:', keys.filter((e, i, a) => a.indexOf(e) !== i), children);\n      throw new Error('[Teact] Children keys are not unique');\n    }\n  }\n}\n\nconst TeactDOM = { render };\nexport default TeactDOM;\n","import type {\n  ApiChat,\n  ApiChatAdminRights,\n  ApiChatBannedRights,\n  ApiChatFolder,\n  ApiChatFullInfo,\n  ApiChatInviteInfo,\n  ApiMessage,\n  ApiPeer,\n  ApiPreparedInlineMessage,\n  ApiTopic,\n} from '../../api/types';\nimport type { OldLangFn } from '../../hooks/useOldLang';\nimport type {\n  CustomPeer, ThreadId,\n} from '../../types';\nimport type { LangFn } from '../../util/localization';\nimport { MAIN_THREAD_ID } from '../../api/types';\n\nimport {\n  ANONYMOUS_USER_ID,\n  ARCHIVED_FOLDER_ID, CHANNEL_ID_LENGTH, GENERAL_TOPIC_ID, REPLIES_USER_ID, TME_LINK_PREFIX,\n  VERIFICATION_CODES_USER_ID,\n} from '../../config';\nimport { formatDateToString, formatTime } from '../../util/dates/dateFormat';\nimport { getServerTime } from '../../util/serverTime';\nimport { getGlobal } from '..';\nimport { isSystemBot } from './bots';\nimport { getMainUsername } from './users';\n\nconst FOREVER_BANNED_DATE = Date.now() / 1000 + 31622400; // 366 days\n\nexport function isUserId(entityId: string) {\n  return !entityId.startsWith('-');\n}\n\nexport function isChannelId(entityId: string) {\n  return entityId.length === CHANNEL_ID_LENGTH && entityId.startsWith('-1');\n}\n\nexport function toChannelId(mtpId: string) {\n  return `-1${mtpId.padStart(CHANNEL_ID_LENGTH - 2, '0')}`;\n}\n\nexport function isChatGroup(chat: ApiChat) {\n  return isChatBasicGroup(chat) || isChatSuperGroup(chat);\n}\n\nexport function isChatBasicGroup(chat: ApiChat) {\n  return chat.type === 'chatTypeBasicGroup';\n}\n\nexport function isChatSuperGroup(chat: ApiChat) {\n  return chat.type === 'chatTypeSuperGroup';\n}\n\nexport function isChatChannel(chat: ApiChat) {\n  return chat.type === 'chatTypeChannel';\n}\n\nexport function isCommonBoxChat(chat: ApiChat) {\n  return chat.type === 'chatTypePrivate' || chat.type === 'chatTypeBasicGroup';\n}\n\nexport function isChatWithRepliesBot(chatId: string) {\n  return chatId === REPLIES_USER_ID;\n}\n\nexport function isChatWithVerificationCodesBot(chatId: string) {\n  return chatId === VERIFICATION_CODES_USER_ID;\n}\n\nexport function isAnonymousForwardsChat(chatId: string) {\n  return chatId === ANONYMOUS_USER_ID;\n}\n\nexport function getChatTypeString(chat: ApiChat) {\n  switch (chat.type) {\n    case 'chatTypePrivate':\n      return 'PrivateChat';\n    case 'chatTypeBasicGroup':\n    case 'chatTypeSuperGroup':\n      return 'AccDescrGroup';\n    case 'chatTypeChannel':\n      return 'AccDescrChannel';\n    default:\n      return 'Chat';\n  }\n}\n\nexport function getPrivateChatUserId(chat: ApiChat) {\n  if (chat.type !== 'chatTypePrivate' && chat.type !== 'chatTypeSecret') {\n    return undefined;\n  }\n  return chat.id;\n}\n\nexport function getChatTitle(lang: OldLangFn | LangFn, chat: ApiChat, isSelf = false) {\n  if (isSelf) {\n    return lang('SavedMessages');\n  }\n  return chat.title || lang('HiddenName');\n}\n\nexport function getChatLink(chat: ApiChat) {\n  const activeUsername = getMainUsername(chat);\n\n  return activeUsername ? `${TME_LINK_PREFIX}${activeUsername}` : undefined;\n}\n\nexport function getChatAvatarHash(\n  owner: ApiPeer,\n  size: 'normal' | 'big' = 'normal',\n  avatarPhotoId = owner.avatarPhotoId,\n) {\n  if (!avatarPhotoId) {\n    return undefined;\n  }\n\n  switch (size) {\n    case 'big':\n      return `profile${owner.id}?${avatarPhotoId}`;\n    default:\n      return `avatar${owner.id}?${avatarPhotoId}`;\n  }\n}\n\nexport function isChatAdmin(chat: ApiChat) {\n  return Boolean(chat.adminRights || chat.isCreator);\n}\n\nexport function getHasAdminRight(chat: ApiChat, key: keyof ApiChatAdminRights) {\n  return chat.adminRights?.[key] || false;\n}\n\nexport function getCanManageTopic(chat: ApiChat, topic: ApiTopic) {\n  if (topic.id === GENERAL_TOPIC_ID) return chat.isCreator;\n  return chat.isCreator || getHasAdminRight(chat, 'manageTopics') || topic.isOwner;\n}\n\nexport function isUserRightBanned(chat: ApiChat, key: keyof ApiChatBannedRights, chatFullInfo?: ApiChatFullInfo) {\n  const unrestrictedByBoosts = chatFullInfo?.boostsToUnrestrict\n    && (chatFullInfo.boostsApplied || 0) >= chatFullInfo.boostsToUnrestrict;\n  return Boolean(\n    (chat.currentUserBannedRights?.[key])\n    || (chat.defaultBannedRights?.[key] && !unrestrictedByBoosts),\n  );\n}\n\nexport function getCanPostInChat(\n  chat: ApiChat, topic?: ApiTopic, isMessageThread?: boolean, chatFullInfo?: ApiChatFullInfo,\n) {\n  if (topic) {\n    if (chat.isForum) {\n      if (chat.isNotJoined) {\n        return false;\n      }\n\n      if (topic?.isClosed && !topic.isOwner && !getHasAdminRight(chat, 'manageTopics')) {\n        return false;\n      }\n    }\n  }\n\n  if (chat.isRestricted || chat.isForbidden || chat.migratedTo\n    || (!isMessageThread && chat.isNotJoined) || isSystemBot(chat.id) || isAnonymousForwardsChat(chat.id)) {\n    return false;\n  }\n\n  if (chat.isCreator) {\n    return true;\n  }\n\n  if (isUserId(chat.id)) {\n    return true;\n  }\n\n  if (isChatChannel(chat)) {\n    return getHasAdminRight(chat, 'postMessages');\n  }\n\n  return isChatAdmin(chat) || !isUserRightBanned(chat, 'sendMessages', chatFullInfo);\n}\n\nexport interface IAllowedAttachmentOptions {\n  canAttachMedia: boolean;\n  canAttachPolls: boolean;\n  canSendStickers: boolean;\n  canSendGifs: boolean;\n  canAttachEmbedLinks: boolean;\n  canSendPhotos: boolean;\n  canSendVideos: boolean;\n  canSendRoundVideos: boolean;\n  canSendAudios: boolean;\n  canSendVoices: boolean;\n  canSendPlainText: boolean;\n  canSendDocuments: boolean;\n}\n\nexport function getAllowedAttachmentOptions(\n  chat?: ApiChat,\n  chatFullInfo?: ApiChatFullInfo,\n  isChatWithBot = false,\n  isStoryReply = false,\n  paidMessagesStars?: number,\n  isInScheduledList = false,\n): IAllowedAttachmentOptions {\n  if (!chat || (paidMessagesStars && isInScheduledList)) {\n    return {\n      canAttachMedia: false,\n      canAttachPolls: false,\n      canSendStickers: false,\n      canSendGifs: false,\n      canAttachEmbedLinks: false,\n      canSendPhotos: false,\n      canSendVideos: false,\n      canSendRoundVideos: false,\n      canSendAudios: false,\n      canSendVoices: false,\n      canSendPlainText: false,\n      canSendDocuments: false,\n    };\n  }\n\n  const isAdmin = isChatAdmin(chat);\n\n  return {\n    canAttachMedia: isAdmin || isStoryReply || !isUserRightBanned(chat, 'sendMedia', chatFullInfo),\n    canAttachPolls: !isStoryReply\n      && (isAdmin || !isUserRightBanned(chat, 'sendPolls', chatFullInfo))\n      && (!isUserId(chat.id) || isChatWithBot),\n    canSendStickers: isAdmin || isStoryReply || !isUserRightBanned(chat, 'sendStickers', chatFullInfo),\n    canSendGifs: isAdmin || isStoryReply || !isUserRightBanned(chat, 'sendGifs', chatFullInfo),\n    canAttachEmbedLinks: !isStoryReply && (isAdmin || !isUserRightBanned(chat, 'embedLinks', chatFullInfo)),\n    canSendPhotos: isAdmin || isStoryReply || !isUserRightBanned(chat, 'sendPhotos', chatFullInfo),\n    canSendVideos: isAdmin || isStoryReply || !isUserRightBanned(chat, 'sendVideos', chatFullInfo),\n    canSendRoundVideos: isAdmin || isStoryReply || !isUserRightBanned(chat, 'sendRoundvideos', chatFullInfo),\n    canSendAudios: isAdmin || isStoryReply || !isUserRightBanned(chat, 'sendAudios', chatFullInfo),\n    canSendVoices: isAdmin || isStoryReply || !isUserRightBanned(chat, 'sendVoices', chatFullInfo),\n    canSendPlainText: isAdmin || isStoryReply || !isUserRightBanned(chat, 'sendPlain', chatFullInfo),\n    canSendDocuments: isAdmin || isStoryReply || !isUserRightBanned(chat, 'sendDocs', chatFullInfo),\n  };\n}\n\nexport function getMessageSendingRestrictionReason(\n  lang: OldLangFn,\n  currentUserBannedRights?: ApiChatBannedRights,\n  defaultBannedRights?: ApiChatBannedRights,\n) {\n  if (currentUserBannedRights?.sendMessages) {\n    const { untilDate } = currentUserBannedRights;\n    return untilDate && untilDate < FOREVER_BANNED_DATE\n      ? lang(\n        'Channel.Persmission.Denied.SendMessages.Until',\n        lang(\n          'formatDateAtTime',\n          [formatDateToString(new Date(untilDate * 1000), lang.code), formatTime(lang, untilDate * 1000)],\n        ),\n      )\n      : lang('Channel.Persmission.Denied.SendMessages.Forever');\n  }\n\n  if (defaultBannedRights?.sendMessages) {\n    return lang('Channel.Persmission.Denied.SendMessages.DefaultRestrictedText');\n  }\n\n  return undefined;\n}\n\nexport function getForumComposerPlaceholder(\n  lang: OldLangFn,\n  chat?: ApiChat,\n  threadId: ThreadId = MAIN_THREAD_ID,\n  topics?: Record<number, ApiTopic>,\n  isReplying?: boolean,\n) {\n  if (!chat?.isForum) {\n    return undefined;\n  }\n\n  if (threadId === MAIN_THREAD_ID) {\n    if (isReplying || (topics && !topics[GENERAL_TOPIC_ID]?.isClosed)) return undefined;\n    return lang('lng_forum_replies_only');\n  }\n\n  const topic = topics?.[Number(threadId)];\n  if (!topic) {\n    return undefined;\n  }\n\n  if (topic.isClosed && !topic.isOwner && !getHasAdminRight(chat, 'manageTopics')) {\n    return lang('TopicClosedByAdmin');\n  }\n\n  return undefined;\n}\n\nexport function isChatArchived(chat: ApiChat) {\n  return chat.folderId === ARCHIVED_FOLDER_ID;\n}\n\nexport function getCanDeleteChat(chat: ApiChat) {\n  return isChatBasicGroup(chat) || ((isChatSuperGroup(chat) || isChatChannel(chat)) && chat.isCreator);\n}\n\nexport function getFolderDescriptionText(lang: OldLangFn, folder: ApiChatFolder, chatsCount?: number) {\n  const {\n    excludedChatIds, includedChatIds,\n    bots, groups, contacts, nonContacts, channels,\n  } = folder;\n\n  const filters = [bots, groups, contacts, nonContacts, channels];\n\n  // If folder has multiple additive filters or uses include/exclude lists,\n  // we display folder chats count\n  if (\n    chatsCount !== undefined && (\n      Object.values(filters).filter(Boolean).length > 1\n      || (excludedChatIds?.length)\n      || (includedChatIds?.length)\n    )) {\n    return lang('Chats', chatsCount);\n  }\n\n  // Otherwise, we return a short description of a single filter\n  if (bots) {\n    return lang('FilterBots');\n  } else if (groups) {\n    return lang('FilterGroups');\n  } else if (channels) {\n    return lang('FilterChannels');\n  } else if (contacts) {\n    return lang('FilterContacts');\n  } else if (nonContacts) {\n    return lang('FilterNonContacts');\n  } else {\n    return undefined;\n  }\n}\n\nexport function isChatPublic(chat: ApiChat) {\n  return chat.usernames?.some(({ isActive }) => isActive);\n}\n\nexport function getOrderedTopics(\n  topics: ApiTopic[], pinnedOrder?: number[], shouldSortByLastMessage = false,\n): ApiTopic[] {\n  if (shouldSortByLastMessage) {\n    return topics.sort((a, b) => b.lastMessageId - a.lastMessageId);\n  } else {\n    const pinned = topics.filter((topic) => topic.isPinned);\n    const ordered = topics\n      .filter((topic) => !topic.isPinned && !topic.isHidden)\n      .sort((a, b) => b.lastMessageId - a.lastMessageId);\n    const hidden = topics.filter((topic) => !topic.isPinned && topic.isHidden)\n      .sort((a, b) => b.lastMessageId - a.lastMessageId);\n\n    const pinnedOrdered = pinnedOrder\n      ? pinnedOrder.map((id) => pinned.find((topic) => topic.id === id)).filter(Boolean) : pinned;\n\n    return [...pinnedOrdered, ...ordered, ...hidden];\n  }\n}\n\nexport function getCleanPeerId(peerId: string) {\n  return isChannelId(peerId)\n    // Remove -1 and leading zeros\n    ? peerId.replace(/^-10+/, '')\n    : peerId.replace('-', '');\n}\n\nexport function getPeerIdDividend(peerId: string) {\n  return Math.abs(Number(getCleanPeerId(peerId)));\n}\n\nexport function getPeerColorKey(peer: ApiPeer | undefined) {\n  if (peer?.color?.color) return peer.color.color;\n\n  return peer ? getPeerIdDividend(peer.id) % 7 : 0;\n}\n\nexport function getPeerColorCount(peer: ApiPeer) {\n  const key = getPeerColorKey(peer);\n  // eslint-disable-next-line eslint-multitab-tt/no-immediate-global\n  return getGlobal().peerColors?.general[key].colors?.length || 1;\n}\n\nexport function getIsSavedDialog(chatId: string, threadId: ThreadId | undefined, currentUserId: string | undefined) {\n  return chatId === currentUserId && threadId !== MAIN_THREAD_ID;\n}\n\nexport function getGroupStatus(lang: OldLangFn, chat: ApiChat) {\n  const chatTypeString = lang(getChatTypeString(chat));\n  const { membersCount } = chat;\n\n  if (chat.isRestricted) {\n    return chatTypeString === 'Channel' ? 'channel is inaccessible' : 'group is inaccessible';\n  }\n\n  if (!membersCount) {\n    return chatTypeString;\n  }\n\n  return chatTypeString === 'Channel'\n    ? lang('Subscribers', membersCount, 'i')\n    : lang('Members', membersCount, 'i');\n}\n\nexport function getCustomPeerFromInvite(invite: ApiChatInviteInfo): CustomPeer {\n  const {\n    title, color, isVerified, isFake, isScam,\n  } = invite;\n  return {\n    isCustomPeer: true,\n    title,\n    peerColorId: color,\n    isVerified,\n    fakeType: isFake ? 'fake' : isScam ? 'scam' : undefined,\n  };\n}\n\nexport function getMockPreparedMessageFromResult(botId: string, preparedMessage: ApiPreparedInlineMessage) {\n  const { result } = preparedMessage;\n\n  const inlineButtons = result?.sendMessage?.replyMarkup?.inlineButtons;\n\n  return {\n    chatId: botId,\n    content: result.sendMessage.content,\n    date: getServerTime(),\n    id: 0,\n    isOutgoing: true,\n    viaBotId: botId,\n    inlineButtons,\n  } satisfies ApiMessage;\n}\n","import { useEffect } from '../lib/teact/teact';\n\nimport { ApiMediaFormat } from '../api/types';\n\nimport { selectIsSynced } from '../global/selectors';\nimport * as mediaLoader from '../util/mediaLoader';\nimport useSelector from './data/useSelector';\nimport useForceUpdate from './useForceUpdate';\n\nconst useMedia = (\n  mediaHash: string | false | undefined,\n  noLoad = false,\n  mediaFormat = ApiMediaFormat.BlobUrl,\n  delay?: number | false,\n) => {\n  const mediaData = mediaHash ? mediaLoader.getFromMemory(mediaHash) : undefined;\n  const forceUpdate = useForceUpdate();\n  const isSynced = useSelector(selectIsSynced);\n\n  useEffect(() => {\n    if (!noLoad && mediaHash && !mediaData) {\n      const startedAt = Date.now();\n\n      mediaLoader.fetch(mediaHash, mediaFormat).then(() => {\n        const spentTime = Date.now() - startedAt;\n        if (!delay || spentTime >= delay) {\n          forceUpdate();\n        } else {\n          setTimeout(forceUpdate, delay - spentTime);\n        }\n      });\n    }\n  }, [noLoad, mediaHash, mediaData, mediaFormat, delay, isSynced]);\n\n  return mediaData;\n};\n\nexport default useMedia;\n","declare const globalThis: ServiceWorkerGlobalScope & WorkerGlobalScope & SharedWorkerGlobalScope & Window;\n\nexport const IS_MULTIACCOUNT_SUPPORTED = 'SharedWorker' in globalThis;\nexport const IS_INTL_LIST_FORMAT_SUPPORTED = 'ListFormat' in Intl;\nexport const IS_BAD_URL_PARSER = new URL('tg://host').host !== 'host';\nexport const ARE_WEBCODECS_SUPPORTED = 'VideoDecoder' in globalThis;\n","import type { GlobalState } from '../../global/types';\n\nimport useDerivedState from '../useDerivedState';\nimport useSelectorSignal from './useSelectorSignal';\n\ntype Selector<T extends unknown> = (global: GlobalState) => T;\n\nexport default function useSelector<T extends unknown>(selector: Selector<T>) {\n  const selectorSignal = useSelectorSignal(selector);\n  return useDerivedState(selectorSignal);\n}\n","import type { MouseEvent as ReactMouseEvent, RefObject } from 'react';\nimport type { FC } from '../../lib/teact/teact';\nimport React, { useRef, useState } from '../../lib/teact/teact';\n\nimport { IS_TOUCH_ENV, MouseButton } from '../../util/browser/windowEnvironment';\nimport buildClassName from '../../util/buildClassName';\nimport buildStyle from '../../util/buildStyle';\n\nimport useLastCallback from '../../hooks/useLastCallback';\nimport useOldLang from '../../hooks/useOldLang';\n\nimport Sparkles from '../common/Sparkles';\nimport RippleEffect from './RippleEffect';\nimport Spinner from './Spinner';\n\nimport './Button.scss';\n\nexport type OwnProps = {\n  ref?: RefObject<HTMLButtonElement | HTMLAnchorElement>;\n  type?: 'button' | 'submit' | 'reset';\n  children: React.ReactNode;\n  size?: 'default' | 'smaller' | 'tiny';\n  color?: (\n    'primary' | 'secondary' | 'gray' | 'danger' | 'translucent' | 'translucent-white' | 'translucent-black'\n    | 'translucent-bordered' | 'dark' | 'green' | 'adaptive' | 'stars'\n  );\n  backgroundImage?: string;\n  id?: string;\n  className?: string;\n  round?: boolean;\n  pill?: boolean;\n  badge?: boolean;\n  fluid?: boolean;\n  isText?: boolean;\n  isLoading?: boolean;\n  ariaLabel?: string;\n  ariaControls?: string;\n  hasPopup?: boolean;\n  href?: string;\n  download?: string;\n  disabled?: boolean;\n  nonInteractive?: boolean;\n  allowDisabledClick?: boolean;\n  noFastClick?: boolean;\n  ripple?: boolean;\n  faded?: boolean;\n  tabIndex?: number;\n  isRtl?: boolean;\n  isShiny?: boolean;\n  isRectangular?: boolean;\n  withPremiumGradient?: boolean;\n  withSparkleEffect?: boolean;\n  noPreventDefault?: boolean;\n  noForcedUpperCase?: boolean;\n  shouldStopPropagation?: boolean;\n  style?: string;\n  onClick?: (e: ReactMouseEvent<HTMLButtonElement, MouseEvent>) => void;\n  onContextMenu?: (e: ReactMouseEvent<HTMLButtonElement, MouseEvent>) => void;\n  onMouseDown?: (e: ReactMouseEvent<HTMLButtonElement>) => void;\n  onMouseUp?: (e: ReactMouseEvent<HTMLButtonElement>) => void;\n  onMouseEnter?: (e: ReactMouseEvent<HTMLButtonElement>) => void;\n  onMouseLeave?: NoneToVoidFunction;\n  onFocus?: NoneToVoidFunction;\n  onTransitionEnd?: NoneToVoidFunction;\n};\n\n// Longest animation duration;\nconst CLICKED_TIMEOUT = 400;\n\nconst Button: FC<OwnProps> = ({\n  ref,\n  type = 'button',\n  id,\n  onClick,\n  onContextMenu,\n  onMouseDown,\n  onMouseUp,\n  onMouseEnter,\n  onMouseLeave,\n  onFocus,\n  children,\n  size = 'default',\n  color = 'primary',\n  backgroundImage,\n  className,\n  round,\n  pill,\n  badge,\n  fluid,\n  isText,\n  isLoading,\n  isShiny,\n  withPremiumGradient,\n  withSparkleEffect,\n  onTransitionEnd,\n  ariaLabel,\n  ariaControls,\n  hasPopup,\n  href,\n  download,\n  disabled,\n  nonInteractive,\n  allowDisabledClick,\n  noFastClick = color === 'danger',\n  ripple,\n  faded,\n  tabIndex,\n  isRtl,\n  isRectangular,\n  noPreventDefault,\n  shouldStopPropagation,\n  noForcedUpperCase,\n  style,\n}) => {\n  // eslint-disable-next-line no-null/no-null\n  let elementRef = useRef<HTMLButtonElement | HTMLAnchorElement>(null);\n  if (ref) {\n    elementRef = ref;\n  }\n\n  const lang = useOldLang();\n\n  const [isClicked, setIsClicked] = useState(false);\n\n  const isNotInteractive = disabled || nonInteractive;\n\n  const fullClassName = buildClassName(\n    'Button',\n    className,\n    size,\n    color,\n    round && 'round',\n    pill && 'pill',\n    fluid && 'fluid',\n    badge && 'badge',\n    isNotInteractive && 'disabled',\n    nonInteractive && 'non-interactive',\n    allowDisabledClick && 'click-allowed',\n    isText && 'text',\n    isLoading && 'loading',\n    ripple && 'has-ripple',\n    faded && 'faded',\n    isClicked && 'clicked',\n    backgroundImage && 'with-image',\n    isShiny && 'shiny',\n    withPremiumGradient && 'premium',\n    isRectangular && 'rectangular',\n    noForcedUpperCase && 'no-upper-case',\n  );\n\n  const handleClick = useLastCallback((e: ReactMouseEvent<HTMLButtonElement, MouseEvent>) => {\n    if ((allowDisabledClick || !isNotInteractive) && onClick) {\n      onClick(e);\n    }\n\n    if (shouldStopPropagation) e.stopPropagation();\n\n    setIsClicked(true);\n    setTimeout(() => {\n      setIsClicked(false);\n    }, CLICKED_TIMEOUT);\n  });\n\n  const handleMouseDown = useLastCallback((e: ReactMouseEvent<HTMLButtonElement>) => {\n    if (!noPreventDefault) e.preventDefault();\n\n    if ((allowDisabledClick || !isNotInteractive) && onMouseDown) {\n      onMouseDown(e);\n    }\n\n    if (!IS_TOUCH_ENV && e.button === MouseButton.Main && !noFastClick) {\n      handleClick(e);\n    }\n  });\n\n  const content = (\n    <>\n      {withSparkleEffect && <Sparkles preset=\"button\" />}\n      {isLoading ? (\n        <div>\n          <span dir={isRtl ? 'auto' : undefined}>{lang('Cache.ClearProgress')}</span>\n          <Spinner color={isText ? 'blue' : 'white'} />\n        </div>\n      ) : children}\n      {!isNotInteractive && ripple && (\n        <RippleEffect />\n      )}\n    </>\n  );\n\n  if (href) {\n    return (\n      <a\n        ref={elementRef as RefObject<HTMLAnchorElement>}\n        id={id}\n        className={fullClassName}\n        href={href}\n        title={ariaLabel}\n        download={download}\n        tabIndex={tabIndex}\n        dir={isRtl ? 'rtl' : undefined}\n        aria-label={ariaLabel}\n        aria-controls={ariaControls}\n        style={style}\n        onTransitionEnd={onTransitionEnd}\n        target=\"_blank\"\n        rel=\"noreferrer\"\n      >\n        {content}\n      </a>\n    );\n  }\n\n  return (\n    <button\n      ref={elementRef as RefObject<HTMLButtonElement>}\n      id={id}\n      type={type}\n      className={fullClassName}\n      onClick={IS_TOUCH_ENV || noFastClick ? handleClick : undefined}\n      onContextMenu={onContextMenu}\n      onMouseDown={handleMouseDown}\n      onMouseUp={onMouseUp}\n      onMouseEnter={onMouseEnter && !isNotInteractive ? onMouseEnter : undefined}\n      onMouseLeave={onMouseLeave && !isNotInteractive ? onMouseLeave : undefined}\n      onTransitionEnd={onTransitionEnd}\n      onFocus={onFocus && !isNotInteractive ? onFocus : undefined}\n      aria-label={ariaLabel}\n      aria-controls={ariaControls}\n      aria-haspopup={hasPopup}\n      title={ariaLabel}\n      tabIndex={tabIndex}\n      dir={isRtl ? 'rtl' : undefined}\n      style={buildStyle(style, backgroundImage && `background-image: url(${backgroundImage})`) || undefined}\n    >\n      {content}\n    </button>\n  );\n};\n\nexport default Button;\n","import type { ApiCountryCode } from '../api/types';\n\nconst PATTERN_PLACEHOLDER = 'X';\nconst DEFAULT_PATTERN = 'XXX XXX XXX XXX';\n\nexport function getCountryCodeByIso(phoneCodeList: ApiCountryCode[], iso: string) {\n  return phoneCodeList.find((country) => country.iso2 === iso);\n}\n\nexport function getCountryFromPhoneNumber(phoneCodeList: ApiCountryCode[], input = '') {\n  let phoneNumber = input.replace(/[^\\d+]+/g, '');\n  if (phoneNumber.startsWith('+')) {\n    phoneNumber = phoneNumber.substr(1);\n  }\n\n  const possibleCountries = phoneCodeList\n    .filter((country) => phoneNumber.startsWith(country.countryCode));\n  const codesWithPrefix: { code: string; country: ApiCountryCode }[] = possibleCountries\n    .map((country) => (country.prefixes || ['']).map((prefix) => {\n      return {\n        code: `${country.countryCode}${prefix}`,\n        country,\n      };\n    }))\n    .flat();\n\n  const bestMatches = codesWithPrefix\n    .filter(({ code }) => phoneNumber.startsWith(code))\n    .sort((a, b) => a.code.length - b.code.length);\n\n  return bestMatches[bestMatches.length - 1]?.country;\n}\n\nexport function formatPhoneNumber(input: string, country?: ApiCountryCode) {\n  if (!input) {\n    return '';\n  }\n\n  let phoneNumber = input.replace(/[^\\d]+/g, '');\n  if (country) {\n    phoneNumber = phoneNumber.substr(country.countryCode.length);\n  } else if (input.startsWith('+')) {\n    return input;\n  }\n  const pattern = getBestPattern(phoneNumber, country?.patterns);\n\n  const result: string[] = []; // Result character array\n  let j = 0; // Position inside pattern\n  for (let i = 0; i < phoneNumber.length; i++) {\n    while (pattern[j] !== PATTERN_PLACEHOLDER && j < pattern.length) {\n      result.push(pattern[j]);\n      if (pattern[j] === phoneNumber[i]) { // If pattern contains digits, move input position too\n        i++;\n        if (i === phoneNumber.length) break; // But don't overdo it, or it will insert full pattern unexpectedly\n      }\n      j++;\n    }\n\n    result.push(phoneNumber[i]); // For placeholder characters, setting current input digit\n    j++;\n  }\n\n  return result.join('');\n}\n\nfunction getBestPattern(numberWithoutCode: string, patterns?: string[]) {\n  if (!patterns || patterns.length === 0) return DEFAULT_PATTERN;\n  if (patterns.length === 1) return patterns[0];\n\n  const defaultPattern = patterns.find((pattern) => pattern.startsWith(PATTERN_PLACEHOLDER)) || DEFAULT_PATTERN;\n\n  const bestMatches = patterns.filter((pattern) => {\n    const stripped = pattern.replace(/[^\\dX]+/g, '');\n    if (stripped.startsWith(PATTERN_PLACEHOLDER)) return false; // Don't consider default number format here\n    for (let i = 0; i < numberWithoutCode.length; i++) {\n      if (i > stripped.length - 1 || (stripped[i] !== PATTERN_PLACEHOLDER && stripped[i] !== numberWithoutCode[i])) {\n        return false;\n      }\n    }\n    return true;\n  });\n\n  // Playing it safe: if not sure, use default for that region\n  return bestMatches.length === 1 ? bestMatches[0] : defaultPattern;\n}\n\nexport function formatPhoneNumberWithCode(phoneCodeList: ApiCountryCode[], phoneNumber: string) {\n  if (!phoneNumber) {\n    return '';\n  }\n\n  const numberWithPlus = phoneNumber.startsWith('+') ? phoneNumber : `+${phoneNumber}`;\n  const country = getCountryFromPhoneNumber(phoneCodeList, numberWithPlus);\n  if (!country) {\n    return numberWithPlus;\n  }\n  return `+${country.countryCode} ${formatPhoneNumber(numberWithPlus, country)}`;\n}\n","import { getIsHeavyAnimating, useEffect, useRef } from '../../../../lib/teact/teact';\n\nimport { requestMeasure } from '../../../../lib/fasterdom/fasterdom';\n\nimport useHeavyAnimation from '../../../../hooks/useHeavyAnimation';\nimport useLastCallback from '../../../../hooks/useLastCallback';\nimport usePriorityPlaybackCheck, { isPriorityPlaybackActive } from '../../../../hooks/usePriorityPlaybackCheck';\nimport useBackgroundMode, { isBackgroundModeActive } from '../../../../hooks/window/useBackgroundMode';\n\nexport default function useVideoAutoPause(\n  playerRef: { current: HTMLVideoElement | null }, canPlay: boolean, isPriority?: boolean,\n) {\n  const canPlayRef = useRef();\n  canPlayRef.current = canPlay;\n\n  const { play, pause } = usePlayPause(playerRef);\n\n  const unfreezePlaying = useLastCallback(() => {\n    if (canPlayRef.current && (isPriority || !isFrozen())) {\n      play();\n    }\n  });\n\n  const unfreezePlayingOnRaf = useLastCallback(() => {\n    requestMeasure(unfreezePlaying);\n  });\n\n  useBackgroundMode(pause, unfreezePlayingOnRaf, !canPlay || isPriority);\n  useHeavyAnimation(pause, unfreezePlaying, !canPlay || isPriority);\n  usePriorityPlaybackCheck(pause, unfreezePlaying, !canPlay || isPriority);\n\n  const handlePlaying = useLastCallback(() => {\n    if (!canPlayRef.current || (!isPriority && isFrozen())) {\n      pause();\n    }\n  });\n\n  useEffect(() => {\n    if (canPlay) {\n      if (isPriority || !isFrozen()) {\n        play();\n      }\n    } else {\n      pause();\n    }\n  }, [canPlay, play, pause, isPriority]);\n\n  return { handlePlaying };\n}\n\nfunction usePlayPause(mediaRef: React.RefObject<HTMLMediaElement>) {\n  const shouldPauseRef = useRef(false);\n  const isLoadingPlayRef = useRef(false);\n\n  const play = useLastCallback(() => {\n    shouldPauseRef.current = false;\n    if (mediaRef.current && !isLoadingPlayRef.current && document.body.contains(mediaRef.current)) {\n      isLoadingPlayRef.current = true;\n      mediaRef.current.play().then(() => {\n        isLoadingPlayRef.current = false;\n        if (shouldPauseRef.current) {\n          mediaRef.current?.pause();\n          shouldPauseRef.current = false;\n        }\n      }).catch((e) => {\n        // eslint-disable-next-line no-console\n        console.warn(e);\n      });\n    }\n  });\n\n  const pause = useLastCallback(() => {\n    if (isLoadingPlayRef.current) {\n      shouldPauseRef.current = true;\n    } else {\n      mediaRef.current?.pause();\n    }\n  });\n\n  return { play, pause };\n}\n\nfunction isFrozen() {\n  return getIsHeavyAnimating() || isPriorityPlaybackActive() || isBackgroundModeActive();\n}\n","import React, { memo, useMemo, useRef } from '../../lib/teact/teact';\n\nimport useBuffering from '../../hooks/useBuffering';\nimport useLastCallback from '../../hooks/useLastCallback';\nimport useSyncEffect from '../../hooks/useSyncEffect';\nimport useVideoCleanup from '../../hooks/useVideoCleanup';\nimport useVideoAutoPause from '../middle/message/hooks/useVideoAutoPause';\n\ntype VideoProps = React.DetailedHTMLProps<React.VideoHTMLAttributes<HTMLVideoElement>, HTMLVideoElement>;\n\ntype OwnProps =\n  {\n    ref?: React.RefObject<HTMLVideoElement>;\n    isPriority?: boolean;\n    canPlay: boolean;\n    children?: React.ReactNode;\n    onReady?: NoneToVoidFunction;\n    onBroken?: NoneToVoidFunction;\n  }\n  & VideoProps;\n\nfunction OptimizedVideo({\n  ref,\n  isPriority,\n  canPlay,\n  children,\n  onReady,\n  onBroken,\n  onTimeUpdate,\n  ...restProps\n}: OwnProps) {\n  // eslint-disable-next-line no-null/no-null\n  const localRef = useRef<HTMLVideoElement>(null);\n  if (!ref) {\n    ref = localRef;\n  }\n\n  const { handlePlaying: handlePlayingForAutoPause } = useVideoAutoPause(ref, canPlay, isPriority);\n\n  const isReadyRef = useRef(false);\n  const handleReady = useLastCallback(() => {\n    if (!isReadyRef.current) {\n      onReady?.();\n      isReadyRef.current = true;\n    }\n  });\n\n  // This is only needed for browsers not allowing autoplay\n  const { isBuffered, bufferingHandlers } = useBuffering(true, onTimeUpdate, onBroken);\n  const { onPlaying: handlePlayingForBuffering, ...otherBufferingHandlers } = bufferingHandlers;\n  useSyncEffect(([prevIsBuffered]) => {\n    if (prevIsBuffered === undefined) {\n      return;\n    }\n\n    handleReady();\n  }, [isBuffered, handleReady]);\n\n  const handlePlaying = useLastCallback((e) => {\n    handlePlayingForAutoPause();\n    handlePlayingForBuffering(e);\n    handleReady();\n    restProps.onPlaying?.(e);\n  });\n\n  const mergedOtherBufferingHandlers = useMemo(() => {\n    const mergedHandlers: Record<string, AnyFunction> = {};\n    Object.keys(otherBufferingHandlers).forEach((keyString) => {\n      const key = keyString as keyof typeof otherBufferingHandlers;\n      mergedHandlers[key] = (event: Event) => {\n        restProps[key as keyof typeof restProps]?.(event);\n        otherBufferingHandlers[key]?.(event);\n      };\n    });\n\n    return mergedHandlers;\n  }, [otherBufferingHandlers, restProps]);\n\n  useVideoCleanup(ref, mergedOtherBufferingHandlers);\n\n  return (\n    // eslint-disable-next-line react/jsx-props-no-spreading\n    <video ref={ref} autoPlay {...restProps} {...mergedOtherBufferingHandlers} onPlaying={handlePlaying}>\n      {children}\n    </video>\n  );\n}\n\nexport default memo(OptimizedVideo);\n","import type { MessageListType, ThreadId } from '../types';\nimport { MAIN_THREAD_ID } from '../api/types';\n\nimport { IS_MOCKED_CLIENT } from '../config';\n\nlet parsedInitialLocationHash: Record<string, string> | undefined;\nlet messageHash: string | undefined;\nlet isAlreadyParsed = false;\nlet initialLocationHash = window.location.hash;\n\nexport function resetInitialLocationHash() {\n  isAlreadyParsed = false;\n  messageHash = undefined;\n  parsedInitialLocationHash = undefined;\n  initialLocationHash = '';\n}\n\nexport function resetLocationHash() {\n  window.location.hash = '';\n}\n\nexport const createLocationHash = (chatId: string, type: MessageListType, threadId: ThreadId): string => {\n  const displayType = type === 'thread' ? undefined : type;\n  const parts = threadId === MAIN_THREAD_ID ? [chatId, displayType] : [chatId, threadId, displayType];\n\n  return parts.filter(Boolean).join('_');\n};\n\nexport function parseLocationHash(currentUserId?: string) {\n  parseInitialLocationHash();\n\n  if (!messageHash) return undefined;\n\n  const parts = messageHash.split('_');\n  let chatId: string | undefined;\n  let type: string | undefined;\n  let threadId: string | undefined;\n  if (parts.length === 1) {\n    chatId = parts[0];\n  } else if (parts.length === 2) {\n    const isType = ['thread', 'pinned', 'scheduled'].includes(parts[1]);\n    chatId = parts[0];\n    type = isType ? parts[1] : 'thread';\n    threadId = !isType ? parts[1] : undefined;\n  } else if (parts.length >= 3) {\n    [chatId, threadId, type] = parts;\n  }\n  if (!chatId?.match(/^-?\\d+$/)) return undefined;\n\n  const isType = ['thread', 'pinned', 'scheduled'].includes(type!);\n\n  const castedThreadId = (chatId === currentUserId ? threadId : Number(threadId)) || MAIN_THREAD_ID;\n\n  return {\n    chatId,\n    type: type && isType ? (type as MessageListType) : 'thread',\n    threadId: castedThreadId,\n  };\n}\n\nexport const createMessageHashUrl = (chatId: string, type: MessageListType, threadId: ThreadId): string => {\n  const url = new URL(window.location.href);\n  url.hash = createLocationHash(chatId, type, threadId);\n  return url.href;\n};\n\nexport function parseInitialLocationHash() {\n  if (parsedInitialLocationHash) return parsedInitialLocationHash;\n\n  if (isAlreadyParsed) return undefined;\n\n  const locationHash = getInitialLocationHash();\n  if (!locationHash) return undefined;\n\n  let parsedHash = locationHash.replace(/^#/, '');\n  if (parsedHash.includes('?')) {\n    [messageHash, parsedHash] = parsedHash.split('?');\n    if (!IS_MOCKED_CLIENT) {\n      window.location.hash = messageHash;\n    }\n  } else if (parsedHash.includes('=')) {\n    if (!IS_MOCKED_CLIENT) {\n      window.location.hash = '';\n    }\n  }\n\n  parsedInitialLocationHash = parsedHash.includes('=') ? parsedHash.split('&').reduce((acc, cur) => {\n    const [key, value] = cur.split('=');\n    acc[key] = value;\n    return acc;\n  }, {} as Record<string, string>) : undefined;\n  isAlreadyParsed = true;\n  if (!parsedInitialLocationHash) {\n    messageHash = parsedHash;\n  }\n\n  return parsedInitialLocationHash;\n}\n\nexport function clearWebTokenAuth() {\n  if (!parsedInitialLocationHash) return;\n\n  delete parsedInitialLocationHash.tgWebAuthToken;\n}\n\nexport function getInitialLocationHash() {\n  return initialLocationHash;\n}\n","import safeExec from '../../util/safeExec';\nimport { fastRaf, throttleWith } from '../../util/schedulers';\nimport { setPhase } from './stricterdom';\n\nlet pendingMeasureTasks: NoneToVoidFunction[] = [];\nlet pendingMutationTasks: NoneToVoidFunction[] = [];\nlet pendingForceReflowTasks: (() => NoneToVoidFunction | void)[] = [];\n\nconst runUpdatePassOnRaf = throttleWithRafFallback(() => {\n  const currentMeasureTasks = pendingMeasureTasks;\n  pendingMeasureTasks = [];\n  currentMeasureTasks.forEach((task) => {\n    safeExec(task);\n  });\n\n  // We use promises to provide correct order for Mutation Observer callback microtasks\n  Promise.resolve()\n    .then(() => {\n      setPhase('mutate');\n\n      const currentMutationTasks = pendingMutationTasks;\n      pendingMutationTasks = [];\n\n      currentMutationTasks.forEach((task) => {\n        safeExec(task);\n      });\n    })\n    .then(() => {\n      setPhase('measure');\n\n      const pendingForceReflowMutationTasks: NoneToVoidFunction[] = [];\n      // Will include tasks created during the loop\n      for (const task of pendingForceReflowTasks) {\n        safeExec(() => {\n          const mutationTask = task();\n          if (mutationTask) {\n            pendingForceReflowMutationTasks.push(mutationTask);\n          }\n        });\n      }\n      pendingForceReflowTasks = [];\n\n      return pendingForceReflowMutationTasks;\n    })\n    .then((pendingForceReflowMutationTasks) => {\n      setPhase('mutate');\n\n      // Will include tasks created during the loop\n      for (const task of pendingForceReflowMutationTasks) {\n        safeExec(task);\n      }\n    })\n    .then(() => {\n      setPhase('measure');\n    });\n});\n\nexport function requestMeasure(cb: NoneToVoidFunction) {\n  pendingMeasureTasks.push(cb);\n  runUpdatePassOnRaf();\n}\n\nexport function requestMutation(cb: NoneToVoidFunction) {\n  pendingMutationTasks.push(cb);\n  runUpdatePassOnRaf();\n}\n\nexport function requestNextMutation(cb: () => (NoneToVoidFunction | void)) {\n  requestMeasure(() => {\n    requestMutation(cb);\n  });\n}\n\nexport function requestForcedReflow(cb: () => (NoneToVoidFunction | void)) {\n  pendingForceReflowTasks.push(cb);\n  runUpdatePassOnRaf();\n}\n\nfunction throttleWithRafFallback<F extends AnyToVoidFunction>(fn: F) {\n  return throttleWith((throttledFn: NoneToVoidFunction) => {\n    fastRaf(throttledFn, true);\n  }, fn);\n}\n\nexport * from './stricterdom';\n","/* eslint-disable no-null/no-null */\nimport { getGlobal } from '../../../global';\n\nimport type { ApiChat, ApiMessage } from '../../../api/types';\nimport type { SummaryMessage } from '../type/message';\n\nimport { selectUser } from '../../../global/selectors';\n\nconst { callApi } = require('../../../api/gramjs/worker/connector');\n// import { callApi } from '../../../api/gramjs/worker/connector';\n\nexport const fetchMessage = (props:{\n  chat: ApiChat;\n  offsetId: number;\n  addOffset: number;\n  sliceSize: number;\n  threadId: number;\n}) => {\n  const {\n    chat, offsetId, addOffset, sliceSize, threadId,\n  } = props;\n  callApi('fetchMessages', {\n    chat,\n    offsetId,\n    addOffset,\n    limit: sliceSize,\n    threadId,\n  }).then((result:any) => {\n    if (!result) {\n      return undefined;\n    }\n    const {\n      messages, count,\n    } = result;\n    return { messages, count };\n  });\n};\n\nexport const fetchChatUnreadMessage = async (\n  props: {\n    chat: ApiChat;\n    offsetId: number;\n    addOffset: number;\n    sliceSize: number;\n    threadId: number;\n    unreadCount:number;\n    maxCount?:number;\n  },\n): Promise<ApiMessage[]> => {\n  let messages: any[] = [];\n  let totalCount = 0;\n  let { offsetId } = props; // 记录偏移量\n  const mergeCount = Math.min(props.unreadCount, props.maxCount || 100);\n  while (messages.length < mergeCount) {\n    const result = await callApi('fetchMessages', {\n      ...props,\n      offsetId,\n      limit: props.sliceSize,\n    });\n\n    if (!result || !result.messages?.length) {\n      break; // 没有更多消息，退出循环\n    }\n    const resultMessage = result.messages.reverse();\n    if (totalCount + resultMessage.length > mergeCount) {\n      messages = messages.concat(resultMessage.slice(0, mergeCount - messages.length));\n      break;\n    } else {\n      messages = messages.concat(resultMessage);\n    }\n\n    totalCount += resultMessage.length || 0;\n    offsetId = resultMessage[resultMessage.length - 1].id; // 更新 offsetId\n\n    if (resultMessage.length < props.sliceSize) {\n      break; // 本次获取的消息不足 sliceSize，说明没有更多消息了\n    }\n  }\n\n  return messages;\n};\n\nexport const fetchChatMessageByDeadline = async (\n  props: {\n    chat: ApiChat;\n    deadline: number;\n    offsetId: number;\n    addOffset: number;\n    sliceSize: number;\n    threadId: number;\n    maxCount?:number;\n  },\n): Promise<ApiMessage[]> => {\n  let messages: any[] = [];\n  let {\n    // eslint-disable-next-line prefer-const\n    offsetId, deadline, sliceSize, maxCount = 100,\n  } = props; // 记录偏移量\n\n  while ((!messages.length || messages[0]?.date >= deadline) && messages.length < maxCount) {\n    const result = await callApi('fetchMessages', {\n      ...props,\n      offsetId,\n      limit: sliceSize,\n    });\n\n    if (!result || !result.messages?.length) {\n      break; // 没有更多消息，退出循环\n    }\n    if (result.messages[result.messages.length - 1].date < deadline) {\n      const effectMessage = result.messages.filter((msg:any) => msg.date >= deadline);\n      messages = messages.concat(effectMessage);\n      break;\n    } else if (messages.length + result.messages.length > maxCount) {\n      messages = messages.concat(result.messages.slice(0, maxCount - messages.length));\n      break;\n    } else {\n      messages = messages.concat(result.messages);\n    }\n\n    offsetId = result.messages[result.messages.length - 1].id; // 更新 offsetId\n\n    if (result.messages.length < props.sliceSize) {\n      break; // 本次获取的消息不足 sliceSize，说明没有更多消息了\n    }\n  }\n\n  return messages.reverse();\n};\n\nexport const fetchChatMessageByOffsetId = async (\n  props: {\n    chat: ApiChat;\n    addOffset: number;\n    offsetId: number;\n    sliceSize: number;\n    threadId: number;\n    maxCount?:number;\n  },\n): Promise<ApiMessage[]> => {\n  let messages: any[] = [];\n  let {\n    // eslint-disable-next-line prefer-const\n    offsetId, sliceSize, maxCount = 100,\n  } = props; // 记录偏移量\n\n  while (!messages.length && messages.length < maxCount) {\n    const result = await callApi('fetchMessages', {\n      ...props,\n      offsetId,\n      limit: sliceSize,\n    });\n\n    if (!result || !result.messages?.length) {\n      break; // 没有更多消息，退出循环\n    }\n    if (messages.length + result.messages.length >= maxCount) {\n      messages = messages.concat(result.messages.slice(0, maxCount - messages.length));\n      break;\n    } else {\n      messages = messages.concat(result.messages);\n    }\n\n    offsetId = result.messages[result.messages.length - 1].id; // 更新 offsetId\n\n    if (result.messages.length < props.sliceSize) {\n      break; // 本次获取的消息不足 sliceSize，说明没有更多消息了\n    }\n  }\n\n  return messages.reverse();\n};\n\nexport const formateMessage2Summary = (messages: ApiMessage[]):SummaryMessage[] => {\n  const global = getGlobal();\n  const formateMessages = messages.map((message) => {\n    if (message.content.text?.text) {\n      const peer = message.senderId ? selectUser(global, message.senderId) : undefined;\n      return {\n        senderId: message?.senderId || message?.chatId,\n        senderName: peer ? `${peer.firstName || ''} ${peer.lastName || ''}` : '',\n        date: message.date,\n        messageId: Math.floor(message.id),\n        content: message.content.text?.text ?? '',\n      };\n    }\n    return null;\n  }).filter(Boolean);\n  return formateMessages;\n};\n\nexport const fetchChatMessageByCount = async (props:{\n  chat: ApiChat;\n  offsetId: number;\n  addOffset: number;\n  sliceSize: number;\n  threadId: number;\n  maxCount?:number;\n}): Promise<ApiMessage[]> => {\n  let messages: any[] = [];\n  let { offsetId, sliceSize, maxCount = 100 } = props;\n  while (!messages.length || messages.length < maxCount) {\n    const result = await callApi('fetchMessages', {\n      ...props,\n      offsetId,\n      limit: sliceSize,\n    });\n\n    if (!result || !result.messages?.length) {\n      break;\n    }\n    messages = messages.concat(result.messages);\n\n    offsetId = result.messages[result.messages.length - 1].id;\n\n    if (result.messages.length < props.sliceSize) {\n      break;\n    }\n  }\n  return messages.reverse();\n}\n","import {\n  useEffect,\n  useRef,\n  useState,\n} from '../../lib/teact/teact';\n\nimport { VIEW_TRANSITION_CLASS_NAME } from '../../config';\nimport { requestMutation, requestNextMutation } from '../../lib/fasterdom/fasterdom';\nimport { IS_VIEW_TRANSITION_SUPPORTED } from '../../util/browser/windowEnvironment';\nimport Deferred from '../../util/Deferred';\n\ntype TransitionFunction = () => Promise<void> | void;\n\ntype TransitionState = 'idle' | 'capturing-old' | 'capturing-new' | 'animating' | 'skipped';\ninterface ViewTransitionController {\n  transitionState: TransitionState;\n  shouldApplyVtn?: boolean;\n  startViewTransition: (domUpdateCallback?: TransitionFunction) => PromiseLike<void> | void;\n}\n\nlet hasActiveTransition = false;\nexport function hasActiveViewTransition(): boolean {\n  return hasActiveTransition;\n}\n\nexport function useViewTransition(): ViewTransitionController {\n  const domUpdaterFn = useRef<TransitionFunction>();\n  const [transitionState, setTransitionState] = useState<TransitionState>('idle');\n\n  useEffect(() => {\n    if (transitionState !== 'capturing-old') return;\n\n    const transition = document.startViewTransition(async () => {\n      setTransitionState('capturing-new');\n      if (domUpdaterFn.current) await domUpdaterFn.current();\n      const deferred = new Deferred<void>();\n      requestNextMutation(() => {\n        deferred.resolve();\n      });\n      return deferred.promise;\n    });\n\n    transition.finished.then(() => {\n      setTransitionState('idle');\n      requestMutation(() => {\n        document.body.classList.remove(VIEW_TRANSITION_CLASS_NAME);\n      });\n      hasActiveTransition = false;\n    });\n\n    transition.ready.then(() => {\n      setTransitionState('animating');\n    }).catch((e:unknown) => {\n      // eslint-disable-next-line no-console\n      console.error(e);\n      setTransitionState('skipped');\n      requestMutation(() => {\n        document.body.classList.remove(VIEW_TRANSITION_CLASS_NAME);\n      });\n      hasActiveTransition = false;\n    });\n  }, [transitionState]);\n\n  function startViewTransition(updateCallback?: TransitionFunction): PromiseLike<void> | void {\n    // Fallback: simply run the callback immediately if view transitions aren't supported.\n    if (!IS_VIEW_TRANSITION_SUPPORTED) {\n      if (updateCallback) updateCallback();\n      return;\n    }\n\n    domUpdaterFn.current = updateCallback;\n    setTransitionState('capturing-old');\n    requestMutation(() => {\n      document.body.classList.add(VIEW_TRANSITION_CLASS_NAME);\n    });\n    hasActiveTransition = true;\n  }\n\n  return {\n    shouldApplyVtn: transitionState === 'capturing-old'\n      || transitionState === 'capturing-new' || transitionState === 'animating',\n    transitionState,\n    startViewTransition,\n  };\n}\n","import type { ApiMessage, ApiMessageSearchType } from '../../api/types';\nimport type {\n  ChatMediaSearchParams,\n  ChatMediaSearchSegment,\n  LoadingState,\n  MiddleSearchParams,\n  MiddleSearchResults,\n  SharedMediaType,\n  ThreadId,\n} from '../../types';\nimport type { GlobalState, TabArgs } from '../types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport {\n  areSortedArraysEqual, areSortedArraysIntersecting, omit, unique,\n} from '../../util/iteratees';\nimport { buildChatThreadKey, isMediaLoadableInViewer } from '../helpers';\nimport { selectTabState } from '../selectors';\nimport { selectChatMediaSearch } from '../selectors/middleSearch';\nimport { updateTabState } from './tabs';\n\ninterface SharedMediaSearchParams {\n  currentType?: SharedMediaType;\n  resultsByType?: Partial<Record<SharedMediaType, {\n    totalCount?: number;\n    nextOffsetId: number;\n    foundIds: number[];\n  }>>;\n}\n\nfunction replaceMiddleSearch<T extends GlobalState>(\n  global: T,\n  chatThreadKey: string,\n  searchParams?: MiddleSearchParams,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const current = selectTabState(global, tabId).middleSearch.byChatThreadKey;\n  if (!searchParams) {\n    return updateTabState(global, {\n      middleSearch: {\n        byChatThreadKey: omit(current, [chatThreadKey]),\n      },\n    }, tabId);\n  }\n\n  const { type = 'chat', ...rest } = searchParams;\n  return updateTabState(global, {\n    middleSearch: {\n      byChatThreadKey: {\n        ...selectTabState(global, tabId).middleSearch.byChatThreadKey,\n        [chatThreadKey]: {\n          type,\n          ...rest,\n        },\n      },\n    },\n  }, tabId);\n}\n\nexport function updateMiddleSearch<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  update: Partial<MiddleSearchParams>,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const chatThreadKey = buildChatThreadKey(chatId, threadId);\n  const currentSearch = selectTabState(global, tabId).middleSearch.byChatThreadKey[chatThreadKey];\n\n  const updated = {\n    type: 'chat',\n    ...currentSearch,\n    ...update,\n  } satisfies MiddleSearchParams;\n\n  if (!updated.isHashtag) {\n    updated.type = 'chat';\n  }\n\n  if (currentSearch && (currentSearch.type !== updated.type || currentSearch.savedTag !== updated.savedTag)) {\n    updated.results = undefined;\n  }\n\n  return replaceMiddleSearch(global, chatThreadKey, updated, tabId);\n}\n\nexport function resetMiddleSearch<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return replaceMiddleSearch(global, buildChatThreadKey(chatId, threadId), {\n    type: 'chat',\n  }, tabId);\n}\n\nfunction replaceMiddleSearchResults<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  results: MiddleSearchResults,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateMiddleSearch(global, chatId, threadId, {\n    results,\n    fetchingQuery: undefined,\n  }, tabId);\n}\n\nexport function updateMiddleSearchResults<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  update: MiddleSearchResults,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const chatThreadKey = buildChatThreadKey(chatId, threadId);\n  const { results } = selectTabState(global, tabId).middleSearch.byChatThreadKey[chatThreadKey] || {};\n  const prevQuery = (results?.query) || '';\n  if (update.query !== prevQuery) {\n    return replaceMiddleSearchResults(global, chatId, threadId, update, tabId);\n  }\n\n  const prevFoundIds = (results?.foundIds) || [];\n  const {\n    query, foundIds: newFoundIds, totalCount, nextOffsetId, nextOffsetPeerId, nextOffsetRate,\n  } = update;\n  const foundIds = unique(Array.prototype.concat(prevFoundIds, newFoundIds));\n  const foundOrPrevFoundIds = areSortedArraysEqual(prevFoundIds, foundIds) ? prevFoundIds : foundIds;\n\n  return replaceMiddleSearchResults(\n    global, chatId, threadId, {\n      query,\n      foundIds: foundOrPrevFoundIds,\n      totalCount,\n      nextOffsetId,\n      nextOffsetRate,\n      nextOffsetPeerId,\n    }, tabId,\n  );\n}\n\nexport function closeMiddleSearch<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const chatThreadKey = buildChatThreadKey(chatId, threadId);\n\n  return replaceMiddleSearch(global, chatThreadKey, undefined, tabId);\n}\n\nfunction replaceSharedMediaSearch<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  searchParams: SharedMediaSearchParams,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const chatThreadKey = buildChatThreadKey(chatId, threadId);\n\n  return updateTabState(global, {\n    sharedMediaSearch: {\n      byChatThreadKey: {\n        ...selectTabState(global, tabId).sharedMediaSearch.byChatThreadKey,\n        [chatThreadKey]: searchParams,\n      },\n    },\n  }, tabId);\n}\n\nexport function updateSharedMediaSearchType<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  currentType: SharedMediaType | undefined,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const chatThreadKey = buildChatThreadKey(chatId, threadId);\n\n  return replaceSharedMediaSearch(global, chatId, threadId, {\n    ...selectTabState(global, tabId).sharedMediaSearch.byChatThreadKey[chatThreadKey],\n    currentType,\n  }, tabId);\n}\n\nexport function replaceSharedMediaSearchResults<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  type: ApiMessageSearchType,\n  foundIds?: number[],\n  totalCount?: number,\n  nextOffsetId?: number,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const chatThreadKey = buildChatThreadKey(chatId, threadId);\n\n  return replaceSharedMediaSearch(global, chatId, threadId, {\n    ...selectTabState(global, tabId).sharedMediaSearch.byChatThreadKey[chatThreadKey],\n    resultsByType: {\n      ...(selectTabState(global, tabId).sharedMediaSearch.byChatThreadKey[chatThreadKey] || {}).resultsByType,\n      [type]: {\n        foundIds,\n        totalCount,\n        nextOffsetId,\n      },\n    },\n  }, tabId);\n}\n\nexport function updateSharedMediaSearchResults<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  type: SharedMediaType,\n  newFoundIds: number[],\n  totalCount?: number,\n  nextOffsetId?: number,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const chatThreadKey = buildChatThreadKey(chatId, threadId);\n\n  const { resultsByType } = selectTabState(global, tabId).sharedMediaSearch.byChatThreadKey[chatThreadKey] || {};\n  const prevFoundIds = resultsByType?.[type] ? resultsByType[type]!.foundIds : [];\n  const foundIds = orderFoundIdsByDescending(unique(Array.prototype.concat(prevFoundIds, newFoundIds)));\n  const foundOrPrevFoundIds = areSortedArraysEqual(prevFoundIds, foundIds) ? prevFoundIds : foundIds;\n\n  return replaceSharedMediaSearchResults(\n    global,\n    chatId,\n    threadId,\n    type,\n    foundOrPrevFoundIds,\n    totalCount,\n    nextOffsetId,\n    tabId,\n  );\n}\n\nfunction orderFoundIdsByDescending(listedIds: number[]) {\n  return listedIds.sort((a, b) => b - a);\n}\n\nfunction orderFoundIdsByAscending(array: number[]) {\n  return array.sort((a, b) => a - b);\n}\n\nexport function mergeWithChatMediaSearchSegment(\n  foundIds: number[],\n  loadingState: LoadingState,\n  segment?: ChatMediaSearchSegment,\n)\n  : ChatMediaSearchSegment {\n  if (!segment) {\n    return {\n      foundIds,\n      loadingState,\n    };\n  }\n  const mergedFoundIds = orderFoundIdsByAscending(unique(Array.prototype.concat(segment.foundIds, foundIds)));\n  if (!areSortedArraysEqual(segment.foundIds, foundIds)) {\n    segment.foundIds = mergedFoundIds;\n  }\n  const mergedLoadingState : LoadingState = {\n    areAllItemsLoadedForwards: loadingState.areAllItemsLoadedForwards\n    || segment.loadingState.areAllItemsLoadedForwards,\n    areAllItemsLoadedBackwards: loadingState.areAllItemsLoadedBackwards\n    || segment.loadingState.areAllItemsLoadedBackwards,\n  };\n  segment.loadingState = mergedLoadingState;\n  return segment;\n}\n\nfunction mergeChatMediaSearchSegments(currentSegment: ChatMediaSearchSegment, segments: ChatMediaSearchSegment[]) {\n  return segments.reduce((acc, segment) => {\n    const hasIntersection = areSortedArraysIntersecting(segment.foundIds, currentSegment.foundIds);\n    if (hasIntersection) {\n      currentSegment = mergeWithChatMediaSearchSegment(\n        currentSegment.foundIds,\n        currentSegment.loadingState,\n        segment,\n      );\n    } else {\n      acc.push(segment);\n    }\n    return acc;\n  }, [] as ChatMediaSearchSegment[]);\n}\n\nexport function updateChatMediaSearchResults<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  currentSegment: ChatMediaSearchSegment,\n  searchParams: ChatMediaSearchParams,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const segments = mergeChatMediaSearchSegments(currentSegment, searchParams.segments);\n\n  return replaceChatMediaSearchResults(\n    global,\n    chatId,\n    threadId,\n    currentSegment,\n    segments,\n    tabId,\n  );\n}\n\nfunction removeIdFromSegment(id: number, segment: ChatMediaSearchSegment): ChatMediaSearchSegment {\n  const foundIds = segment.foundIds.filter((foundId) => foundId !== id);\n\n  return {\n    ...segment,\n    foundIds,\n  };\n}\n\nfunction removeIdsFromChatMediaSearchParams(\n  id: number,\n  searchParams: ChatMediaSearchParams,\n): ChatMediaSearchParams {\n  const currentSegment = removeIdFromSegment(id, searchParams.currentSegment);\n  const segments = searchParams.segments.map((segment) => removeIdFromSegment(id, segment));\n\n  return {\n    ...searchParams,\n    currentSegment,\n    segments,\n  };\n}\n\nexport function removeIdFromSearchResults<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  id: number,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const searchParams = selectChatMediaSearch(global, chatId, threadId, tabId);\n  if (!searchParams) return global;\n\n  const updatedSearchParams = removeIdsFromChatMediaSearchParams(id, searchParams);\n\n  return replaceChatMediaSearch(\n    global,\n    chatId,\n    threadId,\n    updatedSearchParams,\n    tabId,\n  );\n}\n\nfunction resetForwardsLoadingStateInParams(\n  searchParams: ChatMediaSearchParams,\n) {\n  searchParams.currentSegment.loadingState.areAllItemsLoadedForwards = false;\n  searchParams.segments.forEach((segment) => {\n    segment.loadingState.areAllItemsLoadedForwards = false;\n  });\n}\n\nexport function updateChatMediaLoadingState<T extends GlobalState>(\n  global: T,\n  newMessage: ApiMessage,\n  chatId: string,\n  threadId: ThreadId,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  if (!isMediaLoadableInViewer(newMessage)) {\n    return global;\n  }\n  const searchParams = selectChatMediaSearch(global, chatId, threadId, tabId);\n  if (!searchParams) return global;\n  resetForwardsLoadingStateInParams(searchParams);\n\n  return replaceChatMediaSearch(\n    global,\n    chatId,\n    threadId,\n    searchParams,\n    tabId,\n  );\n}\n\nexport function initializeChatMediaSearchResults<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const loadingState: LoadingState = {\n    areAllItemsLoadedForwards: false,\n    areAllItemsLoadedBackwards: false,\n  };\n  const currentSegment: ChatMediaSearchSegment = {\n    foundIds: [],\n    loadingState,\n  };\n  const segments: ChatMediaSearchSegment[] = [];\n\n  const isLoading = false;\n\n  return replaceChatMediaSearch(global, chatId, threadId, {\n    currentSegment,\n    segments,\n    isLoading,\n  }, tabId);\n}\n\nexport function setChatMediaSearchLoading<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  isLoading: boolean,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const chatThreadKey = buildChatThreadKey(chatId, threadId);\n  const searchParams = selectTabState(global, tabId).chatMediaSearch.byChatThreadKey[chatThreadKey];\n\n  if (!searchParams) {\n    return global;\n  }\n\n  return replaceChatMediaSearch(global, chatId, threadId, {\n    ...searchParams,\n    isLoading,\n  }, tabId);\n}\n\nexport function replaceChatMediaSearchResults<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  currentSegment: ChatMediaSearchSegment,\n  segments: ChatMediaSearchSegment[],\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const chatThreadKey = buildChatThreadKey(chatId, threadId);\n\n  return replaceChatMediaSearch(global, chatId, threadId, {\n    ...selectTabState(global, tabId).chatMediaSearch.byChatThreadKey[chatThreadKey],\n    currentSegment,\n    segments,\n  }, tabId);\n}\n\nfunction replaceChatMediaSearch<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  searchParams: ChatMediaSearchParams,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const chatThreadKey = buildChatThreadKey(chatId, threadId);\n\n  return updateTabState(global, {\n    chatMediaSearch: {\n      byChatThreadKey: {\n        ...selectTabState(global, tabId).chatMediaSearch.byChatThreadKey,\n        [chatThreadKey]: searchParams,\n      },\n    },\n  }, tabId);\n}\n","import type { ApiChat, ApiPeer, ApiUser } from '../../api/types';\nimport type { OldLangFn } from '../../hooks/useOldLang';\nimport type { CustomPeer } from '../../types';\n\nimport { SERVICE_NOTIFICATIONS_USER_ID } from '../../config';\nimport { getTranslationFn, type LangFn } from '../../util/localization';\nimport { prepareSearchWordsForNeedle } from '../../util/searchWords';\nimport { selectChat, selectPeer, selectUser } from '../selectors';\nimport { getGlobal } from '..';\nimport { getChatTitle, isUserId } from './chats';\nimport { getUserFirstOrLastName, getUserFullName } from './users';\n\nexport function isApiPeerChat(peer: ApiPeer): peer is ApiChat {\n  return 'title' in peer;\n}\n\nexport function isApiPeerUser(peer: ApiPeer): peer is ApiUser {\n  return !isApiPeerChat(peer);\n}\n\nexport function filterPeersByQuery({\n  ids,\n  query,\n  type = 'peer',\n} : {\n  ids: string[];\n  query: string | undefined;\n  type?: 'chat' | 'user' | 'peer';\n}) {\n  if (!query) {\n    return ids;\n  }\n  const global = getGlobal();\n  const lang = getTranslationFn();\n\n  const searchWords = prepareSearchWordsForNeedle(query);\n\n  const selectorFn = type === 'chat' ? selectChat : type === 'user' ? selectUser : selectPeer;\n\n  return ids.filter((id) => {\n    const peer = selectorFn(global, id);\n    if (!peer) {\n      return false;\n    }\n\n    const localizedTitle = isApiPeerChat(peer)\n      ? getChatTitle(lang, peer)\n      : id === global.currentUserId ? lang('SavedMessages') : undefined;\n    const isFoundInLocalized = localizedTitle ? searchWords(localizedTitle) : undefined;\n\n    const name = getPeerFullTitle(lang, peer);\n\n    return isFoundInLocalized\n      || (name && searchWords(name))\n      || Boolean(peer.usernames?.find(({ username }) => searchWords(username)));\n  });\n}\n\nexport function getPeerTypeKey(peer: ApiPeer) {\n  if (isApiPeerChat(peer)) {\n    if (peer.type === 'chatTypeBasicGroup' || peer.type === 'chatTypeSuperGroup') {\n      return 'ChatList.PeerTypeGroup';\n    }\n\n    if (peer.type === 'chatTypeChannel') {\n      return 'ChatList.PeerTypeChannel';\n    }\n\n    if (peer.type === 'chatTypePrivate') {\n      return 'ChatList.PeerTypeNonContact';\n    }\n\n    return undefined;\n  }\n\n  if (peer.id === SERVICE_NOTIFICATIONS_USER_ID) {\n    return 'ServiceNotifications';\n  }\n\n  if (peer.isSupport) {\n    return 'SupportStatus';\n  }\n\n  if (peer.type && peer.type === 'userTypeBot') {\n    return 'ChatList.PeerTypeBot';\n  }\n\n  if (peer.isContact) {\n    return 'ChatList.PeerTypeContact';\n  }\n\n  return 'ChatList.PeerTypeNonContactUser';\n}\n\nexport function getPeerTitle(lang: OldLangFn | LangFn, peer: ApiPeer | CustomPeer) {\n  if (!peer) return undefined;\n  if ('isCustomPeer' in peer) {\n    // TODO: Remove any after full migration to new lang\n    return peer.titleKey ? lang(peer.titleKey as any) : peer.title;\n  }\n  return isApiPeerUser(peer) ? getUserFirstOrLastName(peer) : getChatTitle(lang, peer);\n}\n\nexport function getPeerFullTitle(lang: OldLangFn | LangFn, peer: ApiPeer | CustomPeer) {\n  if (!peer) return undefined;\n  if ('isCustomPeer' in peer) {\n    // TODO: Remove any after full migration to new lang\n    return peer.titleKey ? lang(peer.titleKey as any) : peer.title;\n  }\n  return isApiPeerUser(peer) ? getUserFullName(peer) : getChatTitle(lang, peer);\n}\n\nexport function getMessageSenderName(lang: OldLangFn, chatId: string, sender?: ApiPeer) {\n  if (!sender || isUserId(chatId)) {\n    return undefined;\n  }\n\n  if (isApiPeerChat(sender)) {\n    if (chatId === sender.id) return undefined;\n\n    return sender.title;\n  }\n\n  if (sender.isSelf) {\n    return lang('FromYou');\n  }\n\n  return getUserFirstOrLastName(sender);\n}\n","function promisifyRequest(request) {\n    return new Promise((resolve, reject) => {\n        // @ts-ignore - file size hacks\n        request.oncomplete = request.onsuccess = () => resolve(request.result);\n        // @ts-ignore - file size hacks\n        request.onabort = request.onerror = () => reject(request.error);\n    });\n}\nfunction createStore(dbName, storeName) {\n    const request = indexedDB.open(dbName);\n    request.onupgradeneeded = () => request.result.createObjectStore(storeName);\n    const dbp = promisifyRequest(request);\n    return (txMode, callback) => dbp.then((db) => callback(db.transaction(storeName, txMode).objectStore(storeName)));\n}\nlet defaultGetStoreFunc;\nfunction defaultGetStore() {\n    if (!defaultGetStoreFunc) {\n        defaultGetStoreFunc = createStore('keyval-store', 'keyval');\n    }\n    return defaultGetStoreFunc;\n}\n/**\n * Get a value by its key.\n *\n * @param key\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction get(key, customStore = defaultGetStore()) {\n    return customStore('readonly', (store) => promisifyRequest(store.get(key)));\n}\n/**\n * Set a value with a key.\n *\n * @param key\n * @param value\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction set(key, value, customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => {\n        store.put(value, key);\n        return promisifyRequest(store.transaction);\n    });\n}\n/**\n * Set multiple values at once. This is faster than calling set() multiple times.\n * It's also atomic – if one of the pairs can't be added, none will be added.\n *\n * @param entries Array of entries, where each entry is an array of `[key, value]`.\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction setMany(entries, customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => {\n        entries.forEach((entry) => store.put(entry[1], entry[0]));\n        return promisifyRequest(store.transaction);\n    });\n}\n/**\n * Get multiple values by their keys\n *\n * @param keys\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction getMany(keys, customStore = defaultGetStore()) {\n    return customStore('readonly', (store) => Promise.all(keys.map((key) => promisifyRequest(store.get(key)))));\n}\n/**\n * Update a value. This lets you see the old value and update it as an atomic operation.\n *\n * @param key\n * @param updater A callback that takes the old value and returns a new value.\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction update(key, updater, customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => \n    // Need to create the promise manually.\n    // If I try to chain promises, the transaction closes in browsers\n    // that use a promise polyfill (IE10/11).\n    new Promise((resolve, reject) => {\n        store.get(key).onsuccess = function () {\n            try {\n                store.put(updater(this.result), key);\n                resolve(promisifyRequest(store.transaction));\n            }\n            catch (err) {\n                reject(err);\n            }\n        };\n    }));\n}\n/**\n * Delete a particular key from the store.\n *\n * @param key\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction del(key, customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => {\n        store.delete(key);\n        return promisifyRequest(store.transaction);\n    });\n}\n/**\n * Delete multiple keys at once.\n *\n * @param keys List of keys to delete.\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction delMany(keys, customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => {\n        keys.forEach((key) => store.delete(key));\n        return promisifyRequest(store.transaction);\n    });\n}\n/**\n * Clear all values in the store.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction clear(customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => {\n        store.clear();\n        return promisifyRequest(store.transaction);\n    });\n}\nfunction eachCursor(store, callback) {\n    store.openCursor().onsuccess = function () {\n        if (!this.result)\n            return;\n        callback(this.result);\n        this.result.continue();\n    };\n    return promisifyRequest(store.transaction);\n}\n/**\n * Get all keys in the store.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction keys(customStore = defaultGetStore()) {\n    return customStore('readonly', (store) => {\n        // Fast path for modern browsers\n        if (store.getAllKeys) {\n            return promisifyRequest(store.getAllKeys());\n        }\n        const items = [];\n        return eachCursor(store, (cursor) => items.push(cursor.key)).then(() => items);\n    });\n}\n/**\n * Get all values in the store.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction values(customStore = defaultGetStore()) {\n    return customStore('readonly', (store) => {\n        // Fast path for modern browsers\n        if (store.getAll) {\n            return promisifyRequest(store.getAll());\n        }\n        const items = [];\n        return eachCursor(store, (cursor) => items.push(cursor.value)).then(() => items);\n    });\n}\n/**\n * Get all entries in the store. Each entry is an array of `[key, value]`.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction entries(customStore = defaultGetStore()) {\n    return customStore('readonly', (store) => {\n        // Fast path for modern browsers\n        // (although, hopefully we'll get a simpler path some day)\n        if (store.getAll && store.getAllKeys) {\n            return Promise.all([\n                promisifyRequest(store.getAllKeys()),\n                promisifyRequest(store.getAll()),\n            ]).then(([keys, values]) => keys.map((key, i) => [key, values[i]]));\n        }\n        const items = [];\n        return customStore('readonly', (store) => eachCursor(store, (cursor) => items.push([cursor.key, cursor.value])).then(() => items));\n    });\n}\n\nexport { clear, createStore, del, delMany, entries, get, getMany, keys, promisifyRequest, set, setMany, update, values };\n","import {\n  clear,\n  createStore,\n  del,\n  delMany,\n  entries as getEntries,\n  get,\n  getMany,\n  keys as getKeys,\n  set,\n  setMany,\n  update,\n  values as getValues,\n} from 'idb-keyval';\n\nclass IdbStore {\n  public store: ReturnType<typeof createStore>;\n\n  constructor(name: string) {\n    this.store = createStore(name, 'store');\n  }\n\n  public set(key: string, value: any) {\n    return set(key, value, this.store);\n  }\n\n  public setMany(entries: [string, any][]) {\n    return setMany(entries, this.store);\n  }\n\n  public get<T = unknown>(key: string) {\n    return get<T>(key, this.store);\n  }\n\n  public getMany<T = unknown>(keys: string[]) {\n    return getMany<T>(keys, this.store);\n  }\n\n  public clear() {\n    return clear(this.store);\n  }\n\n  public del(key: string) {\n    return del(key, this.store);\n  }\n\n  public delMany(keys: string[]) {\n    return delMany(keys, this.store);\n  }\n\n  public entries() {\n    return getEntries(this.store);\n  }\n\n  public keys() {\n    return getKeys(this.store);\n  }\n\n  public values<T = unknown>() {\n    return getValues<T>(this.store);\n  }\n\n  public update<T = unknown>(key: string, updater: (oldValue: T | undefined) => T) {\n    return update(key, updater, this.store);\n  }\n}\n\nexport const MAIN_IDB_STORE = new IdbStore('tt-data');\nexport const PASSCODE_IDB_STORE = new IdbStore('tt-passcode');\nexport const CHATAI_IDB_STORE = new IdbStore('tt-chatai-data');\n","import {\n  type ApiFormattedText,\n  type ApiMessageEntityTimestamp,\n  ApiMessageEntityTypes,\n} from '../../api/types';\n\nimport { getSeconds } from './units';\n\nconst TIMESTAMP_RE = /\\b(?:(\\d{1,2}):)?([0-5]?\\d):([0-5]\\d)\\b/g;\n\nexport function addTimestampEntities(apiText: ApiFormattedText): ApiFormattedText {\n  const resultText = {\n    text: apiText.text,\n    entities: apiText.entities?.filter((e) => e.type !== ApiMessageEntityTypes.Timestamp) || [],\n  };\n\n  const text = resultText.text;\n\n  for (const match of text.matchAll(TIMESTAMP_RE)) {\n    const fullMatch = match[0];\n    const hourStr = match[1];\n    const minuteStr = match[2];\n    const secondStr = match[3];\n    const offset = match.index ?? 0;\n    const length = fullMatch.length;\n\n    const minutes = parseInt(minuteStr, 10);\n    const seconds = parseInt(secondStr, 10);\n\n    if (minutes > 59 || seconds > 59) {\n      continue;\n    }\n\n    let totalSeconds: number;\n    if (hourStr !== undefined) {\n      const hours = parseInt(hourStr, 10);\n      totalSeconds = getSeconds(hours, minutes, seconds);\n    } else {\n      totalSeconds = getSeconds(0, minutes, seconds);\n    }\n\n    let overlaps = false;\n    for (const entity of resultText.entities) {\n      if (offset < entity.offset + entity.length && offset + length > entity.offset) {\n        overlaps = true;\n        break;\n      }\n    }\n    if (overlaps) {\n      continue;\n    }\n\n    const newEntity: ApiMessageEntityTimestamp = {\n      type: ApiMessageEntityTypes.Timestamp,\n      offset,\n      length,\n      timestamp: totalSeconds,\n    };\n\n    let inserted = false;\n    for (let i = 0; i < resultText.entities.length; i++) {\n      if (offset < resultText.entities[i].offset) {\n        resultText.entities.splice(i, 0, newEntity);\n        inserted = true;\n        break;\n      }\n    }\n    if (!inserted) {\n      resultText.entities.push(newEntity);\n    }\n  }\n\n  return resultText;\n}\n\nexport function parseTimestampDuration(input: string): number | undefined {\n  input = input.trim();\n\n  if (!input.startsWith('-') && Number.isInteger(Number(input))) {\n    return parseInt(input, 10);\n  }\n\n  if (input.includes(':')) {\n    const parts = input.split(':');\n\n    if (parts.length === 2) {\n      const minutes = parseInt(parts[0], 10);\n      const seconds = parseInt(parts[1], 10);\n\n      if (\n        Number.isNaN(minutes) || Number.isNaN(seconds)\n        || minutes < 0 || seconds < 0 || seconds >= 60\n      ) {\n        return undefined;\n      }\n      return minutes * 60 + seconds;\n    }\n\n    if (parts.length === 3) {\n      const hours = parseInt(parts[0], 10);\n      const minutes = parseInt(parts[1], 10);\n      const seconds = parseInt(parts[2], 10);\n\n      if (\n        Number.isNaN(hours) || Number.isNaN(minutes) || Number.isNaN(seconds)\n        || hours < 0 || minutes < 0 || seconds < 0 || minutes >= 60 || seconds >= 60\n      ) {\n        return undefined;\n      }\n      return hours * 3600 + minutes * 60 + seconds;\n    }\n\n    return undefined;\n  }\n\n  const regex = /^(?:(\\d+)h)?(?:(\\d+)m)?(?:(\\d+)s)?$/i;\n  const match = input.match(regex);\n  if (!match) {\n    return undefined;\n  }\n\n  const hours = match[1] ? parseInt(match[1], 10) : 0;\n  const minutes = match[2] ? parseInt(match[2], 10) : 0;\n  const seconds = match[3] ? parseInt(match[3], 10) : 0;\n\n  if (\n    Number.isNaN(hours) || Number.isNaN(minutes) || Number.isNaN(seconds)\n    || minutes >= 60 || seconds >= 60\n  ) {\n    return undefined;\n  }\n  return hours * 3600 + minutes * 60 + seconds;\n}\n","import { LEGACY_PASSCODE_CACHE_NAME } from '../config';\nimport { PASSCODE_IDB_STORE } from './browser/idb';\nimport * as cacheApi from './cacheApi';\n\nconst IV_LENGTH = 12;\nconst SALT = 'harder better faster stronger';\n\nlet currentPasscodeHash: ArrayBuffer | undefined;\n\nexport class UnrecoverablePasscodeError extends Error {}\n\nexport function getPasscodeHash() {\n  return currentPasscodeHash;\n}\n\nexport function setPasscodeHash(passcodeHash: ArrayBuffer) {\n  currentPasscodeHash = passcodeHash;\n}\n\nexport async function setupPasscode(passcode: string) {\n  currentPasscodeHash = await sha256(passcode);\n}\n\nexport async function encryptSession(sessionJson?: string, globalJson?: string) {\n  if (!currentPasscodeHash) {\n    // eslint-disable-next-line no-console\n    console.error('[api/passcode] Missing current passcode');\n    throw new Error('[api/passcode] Missing current passcode');\n  }\n\n  await Promise.all([\n    (async () => {\n      if (!sessionJson) return;\n\n      const sessionEncrypted = await aesEncrypt(sessionJson, currentPasscodeHash);\n      await store('sessionEncrypted', sessionEncrypted);\n    })(),\n    (async () => {\n      if (!globalJson) return;\n\n      const globalEncrypted = await aesEncrypt(globalJson, currentPasscodeHash);\n      await store('globalEncrypted', globalEncrypted);\n    })(),\n  ]);\n}\n\nexport async function decryptSessionByCurrentHash() {\n  if (!currentPasscodeHash) {\n    // eslint-disable-next-line no-console\n    console.error('[api/passcode] Missing current passcode');\n    throw new Error('[api/passcode] Missing current passcode');\n  }\n\n  const [sessionEncrypted, globalEncrypted] = await Promise.all([\n    load('sessionEncrypted'),\n    load('globalEncrypted'),\n  ]);\n\n  if (!sessionEncrypted || !globalEncrypted) {\n    // eslint-disable-next-line no-console\n    console.error('[api/passcode] Missing required stored fields');\n    throw new Error('[api/passcode] Missing required stored fields');\n  }\n\n  try {\n    const [sessionJson, globalJson] = await Promise.all([\n      aesDecrypt(sessionEncrypted, currentPasscodeHash),\n      aesDecrypt(globalEncrypted, currentPasscodeHash),\n    ]);\n\n    return { sessionJson, globalJson };\n  } catch (err) {\n    // eslint-disable-next-line no-console\n    console.error('[api/passcode] Error decrypting session', err);\n    throw err;\n  }\n}\n\nexport async function decryptSession(passcode: string) {\n  const passcodeHash = await sha256(passcode);\n\n  const [sessionEncrypted, globalEncrypted] = await Promise.all([\n    load('sessionEncrypted'),\n    load('globalEncrypted'),\n  ]);\n\n  if (!sessionEncrypted || !globalEncrypted) {\n    // eslint-disable-next-line no-console\n    console.error('[api/passcode] Missing required stored fields');\n    throw new UnrecoverablePasscodeError('[api/passcode] Missing required stored fields');\n  }\n\n  try {\n    const [sessionJson, globalJson] = await Promise.all([\n      aesDecrypt(sessionEncrypted, passcodeHash),\n      aesDecrypt(globalEncrypted, passcodeHash),\n    ]);\n\n    currentPasscodeHash = passcodeHash;\n\n    return { sessionJson, globalJson };\n  } catch (err) {\n    // eslint-disable-next-line no-console\n    console.error('[api/passcode] Error decrypting session', err);\n    throw err;\n  }\n}\n\nexport function forgetPasscode() {\n  currentPasscodeHash = undefined;\n}\n\nexport function clearEncryptedSession() {\n  forgetPasscode();\n  PASSCODE_IDB_STORE.clear();\n  return cacheApi.clear(LEGACY_PASSCODE_CACHE_NAME);\n}\n\nfunction sha256(plaintext: string) {\n  return crypto.subtle.digest('SHA-256', new TextEncoder().encode(`${plaintext}${SALT}`));\n}\n\nfunction store(key: string, value: ArrayBuffer) {\n  const asArray = Array.from(new Uint8Array(value));\n  PASSCODE_IDB_STORE.set(key, asArray);\n}\n\nexport function hasEncryptedSession() {\n  return PASSCODE_IDB_STORE.get('sessionEncrypted');\n}\n\nasync function load(key: string) {\n  const cached = await PASSCODE_IDB_STORE.get<number[]>(key);\n  if (cached) {\n    const asArrayBuffer = new Uint8Array(cached).buffer;\n    return asArrayBuffer;\n  }\n  // Fallback for old data\n  return cacheApi.fetch(LEGACY_PASSCODE_CACHE_NAME, key, cacheApi.Type.ArrayBuffer);\n}\n\nasync function aesEncrypt(plaintext: string, pwHash: ArrayBuffer) {\n  const iv = crypto.getRandomValues(new Uint8Array(IV_LENGTH));\n  const alg = { name: 'AES-GCM', iv };\n  const key = await crypto.subtle.importKey('raw', pwHash, alg, false, ['encrypt']);\n  const ptUint8 = new TextEncoder().encode(plaintext);\n  const ctBuffer = await crypto.subtle.encrypt(alg, key, ptUint8);\n  const ct = new Uint8Array(ctBuffer);\n  const result = new Uint8Array(IV_LENGTH + ct.length);\n  result.set(iv, 0);\n  result.set(ct, IV_LENGTH);\n  return result.buffer;\n}\n\nasync function aesDecrypt(data: ArrayBuffer, pwHash: ArrayBuffer) {\n  const dataArray = new Uint8Array(data);\n  const iv = dataArray.slice(0, IV_LENGTH);\n  const alg = { name: 'AES-GCM', iv };\n  const key = await crypto.subtle.importKey('raw', pwHash, alg, false, ['decrypt']);\n  const ct = dataArray.slice(IV_LENGTH);\n  const plainBuffer = await crypto.subtle.decrypt(alg, key, ct);\n\n  return new TextDecoder().decode(plainBuffer);\n}\n","import type { ThemeKey } from '../types';\n\nimport { requestMutation } from '../lib/fasterdom/fasterdom';\nimport themeColors from '../styles/themes.json';\nimport { animate } from './animation';\nimport { lerp } from './math';\n\ntype RGBAColor = {\n  r: number;\n  g: number;\n  b: number;\n  a?: number;\n};\n\nlet isInitialized = false;\n\nconst DECIMAL_PLACES = 3;\nconst HEX_COLOR_REGEX = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})?$/i;\nconst DURATION_MS = 200;\nconst ENABLE_ANIMATION_DELAY_MS = 500;\nconst RGB_VARIABLES = new Set([\n  '--color-text',\n  '--color-primary-shade',\n  '--color-text-secondary',\n  '--color-accent-own',\n]);\n\nconst DISABLE_ANIMATION_CSS = `\n.no-animations #root *,\n.no-animations #root *::before,\n.no-animations #root *::after {\n  transition: none !important;\n}`;\n\nconst colors = (Object.keys(themeColors) as Array<keyof typeof themeColors>).map((property) => ({\n  property,\n  colors: [hexToRgb(themeColors[property][0]), hexToRgb(themeColors[property][1])],\n}));\n\nconst injectCss = (css: string) => {\n  const style = document.createElement('style');\n  style.textContent = css;\n  document.head.appendChild(style);\n  return () => {\n    document.head.removeChild(style);\n  };\n};\n\nconst switchTheme = (theme: ThemeKey, withAnimation: boolean) => {\n  const themeClassName = `theme-${theme}`;\n  if (document.documentElement.classList.contains(themeClassName)) {\n    return;\n  }\n  const isDarkTheme = theme === 'dark';\n  const shouldAnimate = isInitialized && withAnimation;\n  const startIndex = isDarkTheme ? 0 : 1;\n  const endIndex = isDarkTheme ? 1 : 0;\n  const startAt = Date.now();\n  const themeColorTag = document.querySelector('meta[name=\"theme-color\"]');\n\n  requestMutation(() => {\n    document.documentElement.classList.remove(`theme-${isDarkTheme ? 'light' : 'dark'}`);\n    let uninjectCss: (() => void) | undefined;\n    if (isInitialized) {\n      uninjectCss = injectCss(DISABLE_ANIMATION_CSS);\n      document.documentElement.classList.add('no-animations');\n    }\n    document.documentElement.classList.add(themeClassName);\n    if (themeColorTag) {\n      themeColorTag.setAttribute('content', isDarkTheme ? '#212121' : '#fff');\n    }\n\n    setTimeout(() => {\n      requestMutation(() => {\n        uninjectCss?.();\n        document.documentElement.classList.remove('no-animations');\n      });\n    }, ENABLE_ANIMATION_DELAY_MS);\n\n    isInitialized = true;\n\n    if (shouldAnimate) {\n      animate(() => {\n        const t = Math.min((Date.now() - startAt) / DURATION_MS, 1);\n\n        applyColorAnimationStep(startIndex, endIndex, transition(t));\n\n        return t < 1;\n      }, requestMutation);\n    } else {\n      applyColorAnimationStep(startIndex, endIndex);\n    }\n  });\n};\n\nfunction transition(t: number) {\n  return 1 - ((1 - t) ** 3.5);\n}\n\nexport function hexToRgb(hex: string): RGBAColor {\n  const result = HEX_COLOR_REGEX.exec(hex)!;\n\n  return {\n    r: parseInt(result[1], 16),\n    g: parseInt(result[2], 16),\n    b: parseInt(result[3], 16),\n    a: result[4] !== undefined ? parseInt(result[4], 16) : undefined,\n  };\n}\n\nexport function lerpRgb(start: RGBAColor, end: RGBAColor, interpolationRatio: number): RGBAColor {\n  const r = Math.round(lerp(start.r, end.r, interpolationRatio));\n  const g = Math.round(lerp(start.g, end.g, interpolationRatio));\n  const b = Math.round(lerp(start.b, end.b, interpolationRatio));\n  const a = start.a !== undefined\n    ? Math.round(lerp(start.a!, end.a!, interpolationRatio))\n    : undefined;\n\n  return {\n    r, g, b, a,\n  };\n}\n\nfunction applyColorAnimationStep(startIndex: number, endIndex: number, interpolationRatio: number = 1) {\n  colors.forEach(({ property, colors: propertyColors }) => {\n    const {\n      r, g, b, a,\n    } = lerpRgb(propertyColors[startIndex], propertyColors[endIndex], interpolationRatio);\n\n    const roundedA = a !== undefined ? Math.round((a / 255) * 10 ** DECIMAL_PLACES) / 10 ** DECIMAL_PLACES : undefined;\n\n    document.documentElement.style.setProperty(property, `rgb(${r},${g},${b}${roundedA ? `,${roundedA}` : ''})`);\n\n    if (RGB_VARIABLES.has(property)) {\n      document.documentElement.style.setProperty(`${property}-rgb`, `${r},${g},${b}`);\n    }\n  });\n}\n\nexport default switchTheme;\n","import type React from '../lib/teact/teact';\nimport { useLayoutEffect } from '../lib/teact/teact';\nimport { addExtraClass, setExtraStyles } from '../lib/teact/teact-dom';\n\nimport type { IAnchorPosition } from '../types';\n\nimport { requestForcedReflow } from '../lib/fasterdom/fasterdom';\nimport { useStateRef } from './useStateRef';\n\ninterface StaticPositionOptions {\n  anchor?: IAnchorPosition;\n  positionX?: 'left' | 'right';\n  positionY?: 'top' | 'bottom';\n  transformOriginX?: number;\n  transformOriginY?: number;\n  style?: string;\n  bubbleStyle?: string;\n}\n\ninterface DynamicPositionOptions {\n  anchor: IAnchorPosition;\n  getTriggerElement: () => HTMLElement | null;\n  getRootElement: () => HTMLElement | null;\n  getMenuElement: () => HTMLElement | null;\n  getLayout?: () => Layout;\n  withMaxHeight?: boolean;\n}\n\nexport type MenuPositionOptions =\n  StaticPositionOptions\n  | DynamicPositionOptions;\n\nexport interface Layout {\n  extraPaddingX?: number;\n  extraTopPadding?: number;\n  extraMarginTop?: number;\n  menuElMinWidth?: number;\n  deltaX?: number;\n  topShiftY?: number;\n  shouldAvoidNegativePosition?: boolean;\n  withPortal?: boolean;\n  isDense?: boolean; //  Allows you to place the menu as close to the edges of the area as possible\n}\n\nconst MENU_POSITION_VISUAL_COMFORT_SPACE_PX = 16;\nconst MENU_POSITION_BOTTOM_MARGIN = 12;\nconst EMPTY_RECT = {\n  width: 0, left: 0, height: 0, top: 0,\n};\n\nexport default function useMenuPosition(\n  isOpen: boolean,\n  containerRef: React.RefObject<HTMLDivElement>,\n  bubbleRef: React.RefObject<HTMLDivElement>,\n  options: MenuPositionOptions,\n) {\n  const optionsRef = useStateRef(options);\n\n  useLayoutEffect(() => {\n    if (!isOpen) return;\n\n    const options2 = optionsRef.current;\n\n    if (!('getTriggerElement' in options2)) {\n      applyStaticOptions(containerRef, bubbleRef, options2);\n    } else {\n      requestForcedReflow(() => {\n        const staticOptions = processDynamically(containerRef, bubbleRef, options2);\n\n        return () => {\n          applyStaticOptions(containerRef, bubbleRef, staticOptions);\n        };\n      });\n    }\n  }, [isOpen, containerRef, bubbleRef, optionsRef]);\n}\n\nfunction applyStaticOptions(\n  containerRef: React.RefObject<HTMLDivElement>,\n  bubbleRef: React.RefObject<HTMLDivElement>,\n  {\n    positionX = 'left',\n    positionY = 'top',\n    transformOriginX,\n    transformOriginY,\n    style,\n    bubbleStyle,\n  }: StaticPositionOptions,\n) {\n  const containerEl = containerRef.current!;\n  const bubbleEl = bubbleRef.current!;\n\n  if (style) {\n    containerEl.style.cssText = style;\n  }\n\n  if (bubbleStyle) {\n    bubbleEl.style.cssText = bubbleStyle;\n  }\n\n  if (positionX) {\n    addExtraClass(bubbleEl, positionX);\n  }\n\n  if (positionY) {\n    addExtraClass(bubbleEl, positionY);\n  }\n\n  setExtraStyles(bubbleEl, {\n    transformOrigin: [\n      transformOriginX ? `${transformOriginX}px` : positionX,\n      transformOriginY ? `${transformOriginY}px` : positionY,\n    ].join(' '),\n  });\n}\n\nfunction processDynamically(\n  containerRef: React.RefObject<HTMLDivElement>,\n  bubbleRef: React.RefObject<HTMLDivElement>,\n  {\n    anchor,\n    getRootElement,\n    getMenuElement,\n    getTriggerElement,\n    getLayout,\n    withMaxHeight,\n  }: DynamicPositionOptions,\n) {\n  const triggerEl = getTriggerElement()!;\n\n  let { x, y } = anchor;\n  const anchorX = x;\n  const anchorY = y;\n\n  const menuEl = getMenuElement();\n  const rootEl = getRootElement();\n\n  const {\n    extraPaddingX = 0,\n    extraTopPadding = 0,\n    extraMarginTop = 0,\n    topShiftY = 0,\n    menuElMinWidth = 0,\n    deltaX = 0,\n    shouldAvoidNegativePosition = false,\n    withPortal = false,\n    isDense = false,\n  } = getLayout?.() || {};\n\n  const marginTop = menuEl ? parseInt(getComputedStyle(menuEl).marginTop, 10) + extraMarginTop : undefined;\n  const { offsetWidth: menuElWidth, offsetHeight: menuElHeight } = menuEl || { offsetWidth: 0, offsetHeight: 0 };\n  const menuRect = menuEl ? {\n    width: Math.max(menuElWidth, menuElMinWidth),\n    height: menuElHeight + marginTop!,\n  } : EMPTY_RECT;\n\n  const rootRect = rootEl ? rootEl.getBoundingClientRect() : EMPTY_RECT;\n\n  let positionX: 'left' | 'right';\n  let positionY: 'top' | 'bottom';\n  if (isDense || (x + menuRect.width + extraPaddingX < rootRect.width + rootRect.left)) {\n    x += 3;\n    positionX = 'left';\n  } else if (x - menuRect.width - rootRect.left > 0) {\n    positionX = 'right';\n    x -= 3;\n  } else {\n    positionX = 'left';\n    x = 16;\n  }\n\n  x += deltaX;\n\n  const yWithTopShift = y + topShiftY;\n\n  if (isDense || (yWithTopShift + menuRect.height < rootRect.height + rootRect.top)) {\n    positionY = 'top';\n    y = yWithTopShift;\n  } else {\n    positionY = 'bottom';\n\n    if (y - menuRect.height < rootRect.top + extraTopPadding) {\n      y = rootRect.top + rootRect.height;\n    }\n  }\n\n  const triggerRect = triggerEl.getBoundingClientRect();\n\n  const addedYForPortalPositioning = (withPortal ? triggerRect.top : 0);\n  const addedXForPortalPositioning = (withPortal ? triggerRect.left : 0);\n\n  const leftWithPossibleNegative = Math.min(\n    x - triggerRect.left,\n    rootRect.width - menuRect.width - MENU_POSITION_VISUAL_COMFORT_SPACE_PX,\n  );\n  let left = (positionX === 'left'\n    ? (withPortal || shouldAvoidNegativePosition\n      ? Math.max(MENU_POSITION_VISUAL_COMFORT_SPACE_PX, leftWithPossibleNegative)\n      : leftWithPossibleNegative)\n    : (x - triggerRect.left)) + addedXForPortalPositioning;\n  let top = y - triggerRect.top + addedYForPortalPositioning;\n\n  if (isDense) {\n    left = Math.min(left, rootRect.width - menuRect.width - MENU_POSITION_VISUAL_COMFORT_SPACE_PX);\n    top = Math.min(top, rootRect.height - menuRect.height - MENU_POSITION_VISUAL_COMFORT_SPACE_PX);\n  }\n\n  // Avoid hiding external parts of menus on mobile devices behind the edges of the screen (ReactionSelector for example)\n  const addedXForMenuPositioning = menuElMinWidth ? Math.max(0, (menuElMinWidth - menuElWidth) / 2) : 0;\n  if (left - addedXForMenuPositioning < 0 && shouldAvoidNegativePosition) {\n    left = addedXForMenuPositioning + MENU_POSITION_VISUAL_COMFORT_SPACE_PX;\n  }\n\n  const offsetX = (anchorX + addedXForPortalPositioning - triggerRect.left) - left;\n  const offsetY = (anchorY + addedYForPortalPositioning - triggerRect.top) - top - (marginTop || 0);\n  const transformOriginX = positionX === 'left' ? offsetX : menuRect.width + offsetX;\n  const transformOriginY = positionY === 'bottom' ? menuRect.height + offsetY : offsetY;\n\n  const style = `left: ${left}px; top: ${top}px`;\n\n  let bubbleStyle;\n  if (withMaxHeight) {\n    const menuMaxHeight = rootRect.height - MENU_POSITION_BOTTOM_MARGIN - (marginTop || 0);\n    bubbleStyle = `max-height: ${menuMaxHeight}px;`;\n  }\n\n  return {\n    positionX,\n    positionY,\n    transformOriginX,\n    transformOriginY,\n    style,\n    bubbleStyle,\n  };\n}\n","import React, {\n  beginHeavyAnimation,\n  type FC, memo, useEffect, useRef,\n} from '../../lib/teact/teact';\n\nimport type { MenuPositionOptions } from '../../hooks/useMenuPosition';\n\nimport { IS_BACKDROP_BLUR_SUPPORTED } from '../../util/browser/windowEnvironment';\nimport buildClassName from '../../util/buildClassName';\nimport captureEscKeyListener from '../../util/captureEscKeyListener';\nimport { preventMessageInputBlurWithBubbling } from '../middle/helpers/preventMessageInputBlur';\n\nimport useAppLayout from '../../hooks/useAppLayout';\nimport useEffectWithPrevDeps from '../../hooks/useEffectWithPrevDeps';\nimport useHistoryBack from '../../hooks/useHistoryBack';\nimport useKeyboardListNavigation from '../../hooks/useKeyboardListNavigation';\nimport useLastCallback from '../../hooks/useLastCallback';\nimport useMenuPosition from '../../hooks/useMenuPosition';\nimport useShowTransition from '../../hooks/useShowTransition';\nimport useVirtualBackdrop from '../../hooks/useVirtualBackdrop';\n\nimport Portal from './Portal';\n\nimport './Menu.scss';\n\nexport type { MenuPositionOptions } from '../../hooks/useMenuPosition';\n\ntype OwnProps =\n  {\n    ref?: React.RefObject<HTMLDivElement>;\n    isOpen: boolean;\n    shouldCloseFast?: boolean;\n    id?: string;\n    className?: string;\n    bubbleClassName?: string;\n    ariaLabelledBy?: string;\n    autoClose?: boolean;\n    footer?: string;\n    noCloseOnBackdrop?: boolean;\n    backdropExcludedSelector?: string;\n    noCompact?: boolean;\n    onKeyDown?: (e: React.KeyboardEvent<any>) => void;\n    onCloseAnimationEnd?: () => void;\n    onClose: () => void;\n    onMouseEnter?: (e: React.MouseEvent<HTMLDivElement, MouseEvent>) => void;\n    onMouseEnterBackdrop?: (e: React.MouseEvent<HTMLDivElement, MouseEvent>) => void;\n    onMouseLeave?: (e: React.MouseEvent<HTMLDivElement, MouseEvent>) => void;\n    withPortal?: boolean;\n    children?: React.ReactNode;\n  }\n  & MenuPositionOptions;\n\nconst ANIMATION_DURATION = 200;\n\nconst Menu: FC<OwnProps> = ({\n  ref: externalRef,\n  shouldCloseFast,\n  isOpen,\n  id,\n  className,\n  bubbleClassName,\n  ariaLabelledBy,\n  children,\n  autoClose = false,\n  footer,\n  noCloseOnBackdrop = false,\n  backdropExcludedSelector,\n  noCompact,\n  onCloseAnimationEnd,\n  onClose,\n  onMouseEnter,\n  onMouseLeave,\n  withPortal,\n  onMouseEnterBackdrop,\n  ...positionOptions\n}) => {\n  const { isTouchScreen } = useAppLayout();\n\n  // eslint-disable-next-line no-null/no-null\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  const { ref: bubbleRef } = useShowTransition({\n    isOpen,\n    ref: externalRef,\n    onCloseAnimationEnd,\n  });\n\n  useMenuPosition(isOpen, containerRef, bubbleRef, positionOptions);\n\n  useEffect(\n    () => (isOpen ? captureEscKeyListener(onClose) : undefined),\n    [isOpen, onClose],\n  );\n\n  useHistoryBack({\n    isActive: isOpen,\n    onBack: onClose,\n    shouldBeReplaced: true,\n  });\n\n  useEffectWithPrevDeps(([prevIsOpen]) => {\n    if (isOpen || (!isOpen && prevIsOpen === true)) {\n      beginHeavyAnimation(ANIMATION_DURATION);\n    }\n  }, [isOpen]);\n\n  const handleKeyDown = useKeyboardListNavigation(bubbleRef, isOpen, autoClose ? onClose : undefined, undefined, true);\n\n  useVirtualBackdrop(\n    isOpen,\n    containerRef,\n    noCloseOnBackdrop ? undefined : onClose,\n    undefined,\n    backdropExcludedSelector,\n  );\n\n  const bubbleFullClassName = buildClassName(\n    'bubble menu-container custom-scroll',\n    footer && 'with-footer',\n    bubbleClassName,\n    shouldCloseFast && 'close-fast',\n  );\n\n  const handleClick = useLastCallback((e: React.MouseEvent<HTMLDivElement>) => {\n    e.stopPropagation();\n    if (autoClose) {\n      onClose();\n    }\n  });\n\n  const menu = (\n    <div\n      ref={containerRef}\n      id={id}\n      className={buildClassName(\n        'Menu',\n        !noCompact && !isTouchScreen && 'compact',\n        !IS_BACKDROP_BLUR_SUPPORTED && 'no-blur',\n        withPortal && 'in-portal',\n        className,\n      )}\n      aria-labelledby={ariaLabelledBy}\n      role={ariaLabelledBy ? 'menu' : undefined}\n      onKeyDown={isOpen ? handleKeyDown : undefined}\n      onMouseEnter={onMouseEnter}\n      onMouseLeave={isOpen ? onMouseLeave : undefined}\n    >\n      {isOpen && (\n        // This only prevents click events triggering on underlying elements\n        <div\n          className=\"backdrop\"\n          onMouseDown={preventMessageInputBlurWithBubbling}\n          onMouseEnter={onMouseEnterBackdrop}\n        />\n      )}\n      <div\n        role=\"presentation\"\n        ref={bubbleRef}\n        className={bubbleFullClassName}\n        onClick={handleClick}\n      >\n        {children}\n        {footer && <div className=\"footer\">{footer}</div>}\n      </div>\n    </div>\n  );\n\n  if (withPortal) {\n    return <Portal>{menu}</Portal>;\n  }\n\n  return menu;\n};\n\nexport default memo(Menu);\n","import type React from '../lib/teact/teact';\nimport { useMemo, useState } from '../lib/teact/teact';\n\nimport { areDeepEqual } from '../util/areDeepEqual';\nimport { isSafariPatchInProgress } from '../util/patchSafariProgressiveAudio';\nimport { debounce } from '../util/schedulers';\nimport useLastCallback from './useLastCallback';\n\ntype BufferingEvent = (e: Event | React.SyntheticEvent<HTMLMediaElement>) => void;\n\nconst MIN_READY_STATE = 3;\n// Avoid flickering when re-mounting previously buffered video\nconst DEBOUNCE = 200;\nconst MIN_ALLOWED_MEDIA_DURATION = 0.1; // Some video emojis have weird duration of 0.04 causing extreme amount of events\n\n/**\n * Time range relative to the duration [0, 1]\n */\nexport type BufferedRange = { start: number; end: number };\n\nconst useBuffering = (noInitiallyBuffered = false, onTimeUpdate?: AnyToVoidFunction, onBroken?: AnyToVoidFunction) => {\n  const [isBuffered, setIsBuffered] = useState(!noInitiallyBuffered);\n  const [isReady, setIsReady] = useState(false);\n  const [bufferedProgress, setBufferedProgress] = useState(0);\n  const [bufferedRanges, setBufferedRanges] = useState<BufferedRange[]>([]);\n\n  const setIsBufferedDebounced = useMemo(() => {\n    return debounce(setIsBuffered, DEBOUNCE, false, true);\n  }, []);\n\n  const handleBuffering = useLastCallback<BufferingEvent>((e) => {\n    const media = e.currentTarget as HTMLMediaElement;\n\n    if (media.duration < MIN_ALLOWED_MEDIA_DURATION) {\n      onBroken?.();\n      return;\n    }\n\n    if (e.type === 'timeupdate') {\n      onTimeUpdate?.(e);\n    }\n\n    if (!isSafariPatchInProgress(media)) {\n      if (media.buffered.length) {\n        const ranges = getTimeRanges(media.buffered, media.duration);\n        const bufferedLength = ranges.reduce((acc, { start, end }) => acc + end - start, 0);\n        setBufferedProgress(bufferedLength / media.duration);\n        setBufferedRanges((currentRanges) => {\n          return areDeepEqual(currentRanges, ranges) ? currentRanges : ranges;\n        });\n      }\n\n      setIsBufferedDebounced(media.readyState >= MIN_READY_STATE || media.currentTime > 0);\n      setIsReady((current) => current || media.readyState > MIN_READY_STATE);\n    }\n  });\n\n  const bufferingHandlers = {\n    onPLay: handleBuffering,\n    onLoadedData: handleBuffering,\n    onPlaying: handleBuffering,\n    onLoadStart: handleBuffering, // Needed for Safari to start\n    onPause: handleBuffering, // Needed for Chrome when seeking\n    onTimeUpdate: handleBuffering, // Needed for audio buffering progress\n    onProgress: handleBuffering, // Needed for video buffering progress\n  };\n\n  return {\n    isReady,\n    isBuffered,\n    bufferedProgress,\n    bufferedRanges,\n    bufferingHandlers,\n    checkBuffering(element: HTMLMediaElement) {\n      setIsBufferedDebounced(element.readyState >= MIN_READY_STATE);\n    },\n  };\n};\n\nfunction getTimeRanges(ranges: TimeRanges, duration: number) {\n  const result: BufferedRange[] = [];\n  for (let i = 0; i < ranges.length; i++) {\n    result.push({\n      start: ranges.start(i) / duration,\n      end: ranges.end(i) / duration,\n    });\n  }\n  return result;\n}\n\nexport default useBuffering;\n","export enum Actions {\n  HideMenu = 'HideMenu',\n  ShowMenu = 'ShowMenu',\n  ShowTranslateModal = 'ShowTranslateModal',\n  // store\n  ChatAIStoreReady = 'ChatAIStoreReady',\n\n  // global ai assistant\n  NewTextMessage = 'NewTextMessage',\n  AddUrgentMessage = 'AddUrgentMessage',\n  AddSummaryMessage = 'AddSummaryMessage',\n  // summary chats\n  UpdateSummaryChats = 'UpdateSummaryChats',\n  // google\n  CreateCalendarSuccess = 'CreateCalendarSuccess',\n  GoogleAuthSuccess = 'GoogleAuthSuccess',\n  UpdateGoogleToken = 'UpdateGoogleToken',\n  // room ai\n  AddRoomAIMessage = 'AddRoomAIMessage',\n  UpdateRoomAIUnreadCount = 'UpdateRoomAIUnreadCount',\n}\nclass EventEmitter {\n  private static instance: EventEmitter;\n\n  private events: { [key: string]: ((...args: any[]) => void)[] | undefined };\n\n  constructor() {\n    this.events = {};\n  }\n\n  on(event: string | number, listener: (...args: any[]) => void) {\n    if (!this.events[event]) {\n      this.events[event] = [];\n    }\n    this.events[event].push(listener);\n  }\n\n  emit(event: string | number, ...args: any[]) {\n    if (this.events[event]) {\n      this.events[event].forEach((listener: (...args: any[]) => void) => listener(...args));\n    }\n  }\n\n  off(event: string | number, listener: (...args: any[]) => void) {\n    if (!this.events[event]) return;\n\n    this.events[event] = this.events[event].filter(\n      (existingListener: any) => existingListener !== listener,\n    );\n  }\n\n  once(event: any, listener: (arg0: any) => void) {\n    const onceListener = (...args: [any]) => {\n      listener(...args);\n      this.off(event, onceListener);\n    };\n    this.on(event, onceListener);\n  }\n\n  public static getInstance(): EventEmitter {\n    if (!EventEmitter.instance) {\n      EventEmitter.instance = new EventEmitter();\n    }\n    return EventEmitter.instance;\n  }\n}\n\nconst eventEmitter = EventEmitter.getInstance();\nexport default eventEmitter;\n","import type { RefObject } from 'react';\nimport { resolveEventType } from '../lib/teact/dom-events';\nimport { onFullyIdle, useLayoutEffect } from '../lib/teact/teact';\n\nimport unloadVideo from '../util/browser/unloadVideo';\nimport { useStateRef } from './useStateRef';\n\n// Fix memory leak when unmounting video element\nexport default function useVideoCleanup(videoRef: RefObject<HTMLVideoElement>, handlers?: Record<string, AnyFunction>) {\n  const handlersRef = useStateRef(handlers);\n\n  useLayoutEffect(() => {\n    const videoEl = videoRef.current;\n    if (!videoEl) return undefined;\n\n    return () => {\n      // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n      const handlers2 = handlersRef.current;\n      if (handlers2) {\n        Object.entries(handlers2).forEach(([key, value]) => {\n          videoEl.removeEventListener(resolveEventType(key, videoEl), value, false);\n        });\n      }\n\n      // It may be slow (specifically on iOS), so we postpone it after unmounting\n      onFullyIdle(() => {\n        unloadVideo(videoEl);\n      });\n    };\n  }, [handlersRef, videoRef]);\n}\n","import { useRef } from '../lib/teact/teact';\n\n/**\n * @deprecated\n */\nfunction usePreviousDeprecated<T extends any>(next: T): T | undefined;\nfunction usePreviousDeprecated<T extends any>(next: T, shouldSkipUndefined: true): Exclude<T, undefined> | undefined;\n// eslint-disable-next-line max-len\nfunction usePreviousDeprecated<T extends any>(next: T, shouldSkipUndefined?: boolean): Exclude<T, undefined> | undefined;\nfunction usePreviousDeprecated<T extends any>(next: T, shouldSkipUndefined?: boolean) {\n  const ref = useRef<T>();\n  const { current } = ref;\n  if (!shouldSkipUndefined || next !== undefined) {\n    ref.current = next;\n  }\n\n  return current;\n}\n\nexport default usePreviousDeprecated;\n","import type { ApiPeerColors } from '../api/types';\n\nimport { PEER_COLOR_BG_ACTIVE_OPACITY, PEER_COLOR_BG_OPACITY, PEER_COLOR_GRADIENT_STEP } from '../config';\nimport { fastRaf } from './schedulers';\n\nconst GENERAL_VARIABLES = new Map<string, string>();\nconst LIGHT_VARIABLES = new Map<string, string>();\nconst DARK_VARIABLES = new Map<string, string>();\n\nconst style = document.createElement('style');\ndocument.head.appendChild(style);\n\nexport function setVariable(name: string, generalValue: string): void;\nexport function setVariable(name: string, lightValue: string, darkValue?: string): void;\nexport function setVariable(name: string, lightValueOrGeneral: string, darkValue?: string) {\n  if (!darkValue) {\n    GENERAL_VARIABLES.set(name, lightValueOrGeneral);\n    LIGHT_VARIABLES.delete(name);\n    DARK_VARIABLES.delete(name);\n  } else {\n    GENERAL_VARIABLES.delete(name);\n    LIGHT_VARIABLES.set(name, lightValueOrGeneral);\n    DARK_VARIABLES.set(name, darkValue);\n  }\n\n  scheduleVariableUpdate();\n}\n\nlet isUpdateScheduled = false;\nfunction scheduleVariableUpdate() {\n  if (isUpdateScheduled) return;\n  isUpdateScheduled = true;\n  fastRaf(updateVariables);\n}\n\nfunction updateVariables() {\n  const generalVariables = buildVariables(GENERAL_VARIABLES);\n  const lightVariables = buildVariables(LIGHT_VARIABLES);\n  const darkVariables = buildVariables(DARK_VARIABLES);\n\n  style.textContent = `\n    html {\n      ${generalVariables}\n    }\n\n    html.theme-light {\n      ${lightVariables}\n    }\n\n    html.theme-dark {\n      ${darkVariables}\n    }\n  `;\n}\n\nfunction buildVariables(map: Map<string, string>) {\n  return Array.from(map.entries()).map(([name, value]) => `--${name}: ${value};`).join(' ');\n}\n\nexport function updatePeerColors(\n  peerColors: ApiPeerColors['general'],\n) {\n  setPeerColor('0', ['#D45246']);\n  setPeerColor('1', ['#F68136']);\n  setPeerColor('2', ['#6C61DF']);\n  setPeerColor('3', ['#46BA43']);\n  setPeerColor('4', ['#5CAFFA']);\n  setPeerColor('5', ['#408ACF']);\n  setPeerColor('6', ['#D95574']);\n\n  Object.entries(peerColors).forEach(([key, value]) => {\n    if (!value.colors) return;\n    setPeerColor(key, value.colors, value.darkColors);\n  });\n}\n\nfunction setPeerColor(n: string, colors: string[], darkColors?: string[]) {\n  const mainLightColor = colors[0];\n  const mainDarkColor = darkColors?.[0];\n  if (!mainLightColor) return;\n\n  const lightBgColor = `${mainLightColor}${PEER_COLOR_BG_OPACITY}`;\n  const darkBgColor = mainDarkColor ? `${mainDarkColor}${PEER_COLOR_BG_OPACITY}` : undefined;\n\n  const lightBgActiveColor = `${mainLightColor}${PEER_COLOR_BG_ACTIVE_OPACITY}`;\n  const darkBgActiveColor = mainDarkColor ? `${mainDarkColor}${PEER_COLOR_BG_ACTIVE_OPACITY}` : undefined;\n\n  setVariable(`color-peer-${n}`, mainLightColor, mainDarkColor);\n  setVariable(`color-peer-bg-${n}`, lightBgColor, darkBgColor);\n  setVariable(`color-peer-bg-active-${n}`, lightBgActiveColor, darkBgActiveColor);\n\n  if (colors.length > 1) {\n    const lightGradientColors = colors.map((color, i) => (\n      `${color} ${i * PEER_COLOR_GRADIENT_STEP}px, ${color} ${(i + 1) * PEER_COLOR_GRADIENT_STEP}px`\n    ));\n    const darkGradientColors = darkColors?.map((color, i) => (\n      `${color} ${i * PEER_COLOR_GRADIENT_STEP}px, ${color} ${(i + 1) * PEER_COLOR_GRADIENT_STEP}px`\n    ));\n\n    const lightGradient = `repeating-linear-gradient(-45deg, ${lightGradientColors.join(', ')})`;\n    const darkGradient = darkGradientColors ? `repeating-linear-gradient(-45deg, ${darkGradientColors.join(', ')})`\n      : undefined;\n    setVariable(`color-peer-gradient-${n}`, lightGradient, darkGradient);\n  }\n}\n","import { ELECTRON_HOST_URL, IS_PACKAGED_ELECTRON } from '../config';\nimport { ACCOUNT_SLOT } from './multiaccount';\n\n// eslint-disable-next-line no-restricted-globals\nconst cacheApi = self.caches;\n\nconst SUFFIX = ACCOUNT_SLOT ? `_${ACCOUNT_SLOT}` : '';\n\nlet isSupported: boolean | undefined;\n\nexport async function isCacheApiSupported() {\n  if (!cacheApi) return false;\n\n  isSupported = isSupported ?? await cacheApi.has('test').then(() => true).catch(() => false);\n  return isSupported;\n}\n\nexport enum Type {\n  Text,\n  Blob,\n  Json,\n  ArrayBuffer,\n}\n\nexport async function fetch(\n  cacheName: string, key: string, type: Type, isHtmlAllowed = false,\n) {\n  if (!cacheApi) {\n    return undefined;\n  }\n\n  try {\n    // To avoid the error \"Request scheme 'webdocument' is unsupported\"\n    const request = IS_PACKAGED_ELECTRON\n      ? `${ELECTRON_HOST_URL}/${key.replace(/:/g, '_')}`\n      : new Request(key.replace(/:/g, '_'));\n    const cache = await cacheApi.open(`${cacheName}${SUFFIX}`);\n    const response = await cache.match(request);\n    if (!response) {\n      return undefined;\n    }\n\n    const contentType = response.headers.get('Content-Type');\n\n    switch (type) {\n      case Type.Text:\n        return await response.text();\n      case Type.Blob: {\n        // Ignore deprecated data-uri avatars\n        if (key.startsWith('avatar') && contentType && contentType.startsWith('text')) {\n          return undefined;\n        }\n\n        const blob = await response.blob();\n        const shouldRecreate = !blob.type || (!isHtmlAllowed && blob.type.includes('html'));\n        // iOS Safari fails to preserve `type` in cache\n        let resolvedType = blob.type || contentType;\n\n        if (!(shouldRecreate && resolvedType)) {\n          return blob;\n        }\n\n        // Prevent HTML-in-video attacks (for files that were cached before fix)\n        if (!isHtmlAllowed) {\n          resolvedType = resolvedType.replace(/html/gi, '');\n        }\n\n        return new Blob([blob], { type: resolvedType });\n      }\n      case Type.Json:\n        return await response.json();\n      case Type.ArrayBuffer:\n        return await response.arrayBuffer();\n      default:\n        return undefined;\n    }\n  } catch (err) {\n    // eslint-disable-next-line no-console\n    console.warn(err);\n    return undefined;\n  }\n}\n\nexport async function save(cacheName: string, key: string, data: AnyLiteral | Blob | ArrayBuffer | string) {\n  if (!cacheApi) {\n    return false;\n  }\n\n  try {\n    const cacheData = typeof data === 'string' || data instanceof Blob || data instanceof ArrayBuffer\n      ? data\n      : JSON.stringify(data);\n    // To avoid the error \"Request scheme 'webdocument' is unsupported\"\n    const request = IS_PACKAGED_ELECTRON\n      ? `${ELECTRON_HOST_URL}/${key.replace(/:/g, '_')}`\n      : new Request(key.replace(/:/g, '_'));\n    const response = new Response(cacheData);\n    const cache = await cacheApi.open(`${cacheName}${SUFFIX}`);\n    await cache.put(request, response);\n\n    return true;\n  } catch (err) {\n    // eslint-disable-next-line no-console\n    console.warn(err);\n    return false;\n  }\n}\n\nexport async function remove(cacheName: string, key: string) {\n  try {\n    if (!cacheApi) {\n      return undefined;\n    }\n\n    const cache = await cacheApi.open(`${cacheName}${SUFFIX}`);\n    return await cache.delete(key);\n  } catch (err) {\n    // eslint-disable-next-line no-console\n    console.warn(err);\n    return undefined;\n  }\n}\n\nexport async function clear(cacheName: string) {\n  try {\n    if (!cacheApi) {\n      return undefined;\n    }\n\n    return await cacheApi.delete(`${cacheName}${SUFFIX}`);\n  } catch (err) {\n    // eslint-disable-next-line no-console\n    console.warn(err);\n    return undefined;\n  }\n}\n","import React, {\n  memo, useMemo, useRef,\n} from '../../lib/teact/teact';\n\nimport type { ApiFormattedText, ApiMessage, ApiStory } from '../../api/types';\nimport type { ObserveFn } from '../../hooks/useIntersectionObserver';\nimport type { ThreadId } from '../../types';\nimport { ApiMessageEntityTypes } from '../../api/types';\n\nimport { CONTENT_NOT_SUPPORTED } from '../../config';\nimport { extractMessageText, stripCustomEmoji } from '../../global/helpers';\nimport trimText from '../../util/trimText';\nimport { insertTextEntity, renderTextWithEntities } from './helpers/renderTextWithEntities';\n\nimport useSyncEffect from '../../hooks/useSyncEffect';\nimport useUniqueId from '../../hooks/useUniqueId';\n\ninterface OwnProps {\n  messageOrStory: ApiMessage | ApiStory;\n  threadId?: ThreadId;\n  translatedText?: ApiFormattedText;\n  isForAnimation?: boolean;\n  emojiSize?: number;\n  highlight?: string;\n  asPreview?: boolean;\n  truncateLength?: number;\n  isProtected?: boolean;\n  observeIntersectionForLoading?: ObserveFn;\n  observeIntersectionForPlaying?: ObserveFn;\n  withTranslucentThumbs?: boolean;\n  shouldRenderAsHtml?: boolean;\n  inChatList?: boolean;\n  forcePlayback?: boolean;\n  focusedQuote?: string;\n  focusedQuoteOffset?: number;\n  isInSelectMode?: boolean;\n  canBeEmpty?: boolean;\n  maxTimestamp?: number;\n}\n\nconst MIN_CUSTOM_EMOJIS_FOR_SHARED_CANVAS = 3;\n\nfunction MessageText({\n  messageOrStory,\n  translatedText,\n  isForAnimation,\n  emojiSize,\n  highlight,\n  asPreview,\n  truncateLength,\n  isProtected,\n  observeIntersectionForLoading,\n  observeIntersectionForPlaying,\n  withTranslucentThumbs,\n  shouldRenderAsHtml,\n  inChatList,\n  forcePlayback,\n  focusedQuote,\n  focusedQuoteOffset,\n  isInSelectMode,\n  canBeEmpty,\n  maxTimestamp,\n  threadId,\n}: OwnProps) {\n  // eslint-disable-next-line no-null/no-null\n  const sharedCanvasRef = useRef<HTMLCanvasElement>(null);\n  // eslint-disable-next-line no-null/no-null\n  const sharedCanvasHqRef = useRef<HTMLCanvasElement>(null);\n\n  const textCacheBusterRef = useRef(0);\n\n  const formattedText = translatedText || extractMessageText(messageOrStory, inChatList);\n  const adaptedFormattedText = isForAnimation && formattedText ? stripCustomEmoji(formattedText) : formattedText;\n  const { text, entities } = adaptedFormattedText || {};\n\n  const entitiesWithFocusedQuote = useMemo(() => {\n    if (!text || !focusedQuote) return entities;\n\n    const index = text.indexOf(focusedQuote, focusedQuoteOffset);\n    const lendth = focusedQuote.length;\n    if (index >= 0) {\n      return insertTextEntity(entities || [], {\n        offset: index,\n        length: lendth,\n        type: ApiMessageEntityTypes.QuoteFocus,\n      });\n    }\n\n    return entities;\n  }, [text, entities, focusedQuote, focusedQuoteOffset]);\n\n  const containerId = useUniqueId();\n\n  useSyncEffect(() => {\n    textCacheBusterRef.current += 1;\n  }, [text, entitiesWithFocusedQuote]);\n\n  const withSharedCanvas = useMemo(() => {\n    const hasSpoilers = entitiesWithFocusedQuote?.some((e) => e.type === ApiMessageEntityTypes.Spoiler);\n    if (hasSpoilers) {\n      return false;\n    }\n\n    const customEmojisCount = entitiesWithFocusedQuote\n      ?.filter((e) => e.type === ApiMessageEntityTypes.CustomEmoji).length || 0;\n    return customEmojisCount >= MIN_CUSTOM_EMOJIS_FOR_SHARED_CANVAS;\n  }, [entitiesWithFocusedQuote]) || 0;\n\n  if (!text && !canBeEmpty) {\n    return <span className=\"content-unsupported\">{CONTENT_NOT_SUPPORTED}</span>;\n  }\n\n  return (\n    <>\n      {[\n        withSharedCanvas && <canvas ref={sharedCanvasRef} className=\"shared-canvas\" />,\n        withSharedCanvas && <canvas ref={sharedCanvasHqRef} className=\"shared-canvas\" />,\n        renderTextWithEntities({\n          text: trimText(text!, truncateLength),\n          entities: entitiesWithFocusedQuote,\n          highlight,\n          emojiSize,\n          shouldRenderAsHtml,\n          containerId,\n          asPreview,\n          isProtected,\n          observeIntersectionForLoading,\n          observeIntersectionForPlaying,\n          withTranslucentThumbs,\n          sharedCanvasRef,\n          sharedCanvasHqRef,\n          cacheBuster: textCacheBusterRef.current.toString(),\n          forcePlayback,\n          isInSelectMode,\n          maxTimestamp,\n          chatId: 'chatId' in messageOrStory ? messageOrStory.chatId : undefined,\n          messageId: messageOrStory.id,\n          threadId,\n        }),\n      ].flat().filter(Boolean)}\n    </>\n  );\n}\n\nexport default memo(MessageText);\n","// https://gist.github.com/paulirish/5d52fb081b3570c81e3a\n\nexport default {\n  Element: {\n    props: [\n      'clientLeft', 'clientTop', 'clientWidth', 'clientHeight',\n      'scrollWidth', 'scrollHeight', 'scrollLeft', 'scrollTop',\n    ] as const,\n    methods: [\n      'getClientRects', 'getBoundingClientRect',\n      'scrollBy', 'scrollTo', 'scrollIntoView', 'scrollIntoViewIfNeeded',\n    ] as const,\n  },\n  HTMLElement: {\n    props: [\n      'offsetLeft', 'offsetTop', 'offsetWidth', 'offsetHeight', 'offsetParent',\n      'innerText',\n    ] as const,\n    methods: ['focus'] as const,\n  },\n  window: {\n    props: [\n      'scrollX', 'scrollY',\n      'innerHeight', 'innerWidth',\n    ] as const,\n    methods: ['getComputedStyle'] as const,\n  },\n  VisualViewport: {\n    props: [\n      'height', 'width', 'offsetTop', 'offsetLeft',\n    ] as const,\n  },\n  Document: {\n    props: ['scrollingElement'] as const,\n    methods: ['elementFromPoint'] as const,\n  },\n  HTMLInputElement: {\n    methods: ['select'] as const,\n  },\n  MouseEvent: {\n    props: ['layerX', 'layerY', 'offsetX', 'offsetY'] as const,\n  },\n  Range: {\n    methods: ['getClientRects', 'getBoundingClientRect'] as const,\n  },\n};\n","import LAYOUT_CAUSES from './layoutCauses';\n\ntype Entities = keyof typeof LAYOUT_CAUSES;\ntype Phase =\n  'measure'\n  | 'mutate';\ntype ErrorHandler = (error: Error) => any;\n\n// eslint-disable-next-line no-console\nconst DEFAULT_ERROR_HANDLER = console.error;\n\nlet onError: ErrorHandler = DEFAULT_ERROR_HANDLER;\n\nconst nativeMethods = new Map<string, AnyFunction>();\n\nlet phase: Phase = 'measure';\nlet isStrict = false;\nlet observer: MutationObserver | undefined;\n\nexport function setPhase(newPhase: Phase) {\n  phase = newPhase;\n}\n\nexport function getPhase() {\n  return phase;\n}\n\nexport function enableStrict() {\n  if (isStrict) return;\n\n  isStrict = true;\n  setupLayoutDetectors();\n  setupMutationObserver();\n}\n\nexport function disableStrict() {\n  if (!isStrict) return;\n\n  clearMutationObserver();\n  clearLayoutDetectors();\n  isStrict = false;\n}\n\nexport function forceMeasure(cb: () => any) {\n  if (phase !== 'mutate') {\n    throw new Error('The current phase is \\'measure\\'');\n  }\n\n  phase = 'measure';\n  const result = cb();\n  phase = 'mutate';\n\n  return result;\n}\n\nconst forcedMutationAllowedFor = new Set<Node>();\n\nexport function forceMutation(cb: () => any, nodes: Node | Node[]) {\n  if (phase !== 'measure') {\n    throw new Error('The current phase is \\'mutate\\'');\n  }\n\n  if (isStrict) {\n    if (Array.isArray(nodes)) {\n      nodes.forEach((node) => {\n        forcedMutationAllowedFor.add(node);\n      });\n    } else {\n      forcedMutationAllowedFor.add(nodes);\n    }\n  }\n\n  return cb();\n}\n\nexport function setHandler(handler?: ErrorHandler) {\n  onError = handler || DEFAULT_ERROR_HANDLER;\n}\n\nfunction setupLayoutDetectors() {\n  Object.entries(LAYOUT_CAUSES).forEach(([name, causes]) => {\n    const entity = window[name as Entities];\n    if (!entity) return;\n    const prototype = typeof entity === 'object' ? entity : entity.prototype;\n\n    if ('props' in causes) {\n      causes.props.forEach((prop) => {\n        const nativeGetter = Object.getOwnPropertyDescriptor(prototype, prop)?.get;\n        if (!nativeGetter) {\n          return;\n        }\n\n        nativeMethods.set(`${name}#${prop}`, nativeGetter);\n\n        Object.defineProperty(prototype, prop, {\n          get() {\n            onMeasure(prop);\n\n            return nativeGetter.call(this);\n          },\n        });\n      });\n    }\n\n    if ('methods' in causes) {\n      causes.methods.forEach((method) => {\n        const nativeMethod = (prototype as any)[method]!;\n        nativeMethods.set(`${name}#${method}`, nativeMethod);\n\n        // eslint-disable-next-line func-names\n        (prototype as any)[method] = function (...args: any[]) {\n          onMeasure(method);\n\n          return nativeMethod.apply(this, args);\n        };\n      });\n    }\n  });\n}\n\nfunction clearLayoutDetectors() {\n  Object.entries(LAYOUT_CAUSES).forEach(([name, causes]) => {\n    const entity = window[name as Entities];\n    if (!entity) return;\n    const prototype = typeof entity === 'object' ? entity : entity.prototype;\n\n    if ('props' in causes) {\n      causes.props.forEach((prop) => {\n        const nativeGetter = nativeMethods.get(`${name}#${prop}`);\n        if (!nativeGetter) {\n          return;\n        }\n\n        Object.defineProperty(prototype, prop, { get: nativeGetter });\n      });\n    }\n\n    if ('methods' in causes) {\n      causes.methods.forEach((method) => {\n        (prototype as any)[method] = nativeMethods.get(`${name}#${method}`)!;\n      });\n    }\n  });\n\n  nativeMethods.clear();\n}\n\nfunction setupMutationObserver() {\n  observer = new MutationObserver((mutations) => {\n    if (phase !== 'mutate') {\n      mutations.forEach(({ target, type, attributeName }) => {\n        if (!document.contains(target)) {\n          return;\n        }\n\n        if (type === 'attributes' && attributeName === 'style') {\n          return;\n        }\n\n        if (forcedMutationAllowedFor.has(target)) {\n          return;\n        }\n\n        if (type === 'childList' && target instanceof HTMLElement && target.contentEditable) {\n          return;\n        }\n\n        if (attributeName?.startsWith('data-')) {\n          return;\n        }\n        // eslint-disable-next-line no-console\n        onError(new Error(`Unexpected mutation detected: \\`${type === 'attributes' ? attributeName : type}\\``));\n      });\n    }\n\n    forcedMutationAllowedFor.clear();\n  });\n\n  observer.observe(document.body, {\n    childList: true,\n    attributes: true,\n    subtree: true,\n    characterData: false,\n  });\n}\n\nfunction clearMutationObserver() {\n  observer?.disconnect();\n  observer = undefined;\n}\n\nfunction onMeasure(propName: string) {\n  if (phase !== 'measure') {\n    onError(new Error(`Unexpected measurement detected: \\`${propName}\\``));\n  }\n}\n","import type {\n  ApiDimensions, ApiMediaExtendedPreview, ApiPhoto, ApiSticker, ApiVideo,\n} from '../../../api/types';\n\nimport { STICKER_SIZE_INLINE_DESKTOP_FACTOR, STICKER_SIZE_INLINE_MOBILE_FACTOR } from '../../../config';\nimport { getPhotoInlineDimensions, getVideoDimensions } from '../../../global/helpers';\nimport { IS_TOUCH_ENV } from '../../../util/browser/windowEnvironment';\nimport windowSize from '../../../util/windowSize';\n\nexport const MEDIA_VIEWER_MEDIA_QUERY = '(max-height: 640px)';\nexport const REM = parseInt(getComputedStyle(document.documentElement).fontSize, 10);\nexport const ROUND_VIDEO_DIMENSIONS_PX = 240;\nexport const GIF_MIN_WIDTH = 300;\nexport const AVATAR_FULL_DIMENSIONS = { width: 640, height: 640 };\nexport const VIDEO_AVATAR_FULL_DIMENSIONS = { width: 800, height: 800 };\nexport const LIKE_STICKER_ID = '4986041492570112461';\n\nconst DEFAULT_MEDIA_DIMENSIONS: ApiDimensions = { width: 100, height: 100 };\nconst MOBILE_SCREEN_NO_AVATARS_MESSAGE_EXTRA_WIDTH_REM = 4.5;\nconst MOBILE_SCREEN_MESSAGE_EXTRA_WIDTH_REM = 7;\nconst MESSAGE_MAX_WIDTH_REM = 29;\nconst MESSAGE_OWN_MAX_WIDTH_REM = 30;\n\nlet cachedMaxWidthOwn: number | undefined;\nlet cachedMaxWidth: number | undefined;\nlet cachedMaxWidthNoAvatar: number | undefined;\n\nfunction getMaxMessageWidthRem(fromOwnMessage?: boolean, noAvatars?: boolean, isMobile?: boolean) {\n  const regularMaxWidth = fromOwnMessage ? MESSAGE_OWN_MAX_WIDTH_REM : MESSAGE_MAX_WIDTH_REM;\n  if (!isMobile) {\n    return regularMaxWidth;\n  }\n\n  const { width: windowWidth } = windowSize.get();\n\n  // @optimization Limitation: changing device screen width not supported\n  if (!cachedMaxWidthOwn) {\n    cachedMaxWidthOwn = Math.min(\n      MESSAGE_OWN_MAX_WIDTH_REM,\n      windowWidth / REM - MOBILE_SCREEN_NO_AVATARS_MESSAGE_EXTRA_WIDTH_REM,\n    );\n  }\n  if (!cachedMaxWidth) {\n    cachedMaxWidth = Math.min(\n      MESSAGE_MAX_WIDTH_REM,\n      windowWidth / REM - MOBILE_SCREEN_MESSAGE_EXTRA_WIDTH_REM,\n    );\n  }\n  if (!cachedMaxWidthNoAvatar) {\n    cachedMaxWidthNoAvatar = Math.min(\n      MESSAGE_MAX_WIDTH_REM,\n      windowWidth / REM - MOBILE_SCREEN_NO_AVATARS_MESSAGE_EXTRA_WIDTH_REM,\n    );\n  }\n\n  return fromOwnMessage\n    ? cachedMaxWidthOwn\n    : (noAvatars ? cachedMaxWidthNoAvatar : cachedMaxWidth);\n}\n\nexport function getAvailableWidth(\n  fromOwnMessage?: boolean,\n  isWebPageMedia?: boolean,\n  noAvatars?: boolean,\n  isMobile?: boolean,\n) {\n  const extraPaddingRem = isWebPageMedia ? 1.625 : 0;\n  const availableWidthRem = getMaxMessageWidthRem(fromOwnMessage, noAvatars, isMobile) - extraPaddingRem;\n\n  return availableWidthRem * REM;\n}\n\nfunction getAvailableHeight(isGif?: boolean, aspectRatio?: number) {\n  if (\n    isGif && aspectRatio\n    && aspectRatio >= 0.75 && aspectRatio <= 1.25\n  ) {\n    return 20 * REM;\n  }\n\n  return 27 * REM;\n}\n\nexport function calculateDimensionsForMessageMedia({\n  width,\n  height,\n  fromOwnMessage,\n  isWebPageMedia,\n  isGif,\n  noAvatars,\n  isMobile,\n}: {\n  width: number;\n  height: number;\n  fromOwnMessage?: boolean;\n  asForwarded?: boolean;\n  isWebPageMedia?: boolean;\n  isGif?: boolean;\n  noAvatars?: boolean;\n  isMobile?: boolean;\n}): ApiDimensions {\n  const aspectRatio = height / width;\n  const availableWidth = getAvailableWidth(fromOwnMessage, isWebPageMedia, noAvatars, isMobile);\n  const availableHeight = getAvailableHeight(isGif, aspectRatio);\n  const mediaWidth = isGif ? Math.max(GIF_MIN_WIDTH, width) : width;\n  const mediaHeight = isGif ? height * (mediaWidth / width) : height;\n\n  return calculateDimensions(availableWidth, availableHeight, mediaWidth, mediaHeight);\n}\n\nexport function getMediaViewerAvailableDimensions(withFooter: boolean, isVideo: boolean): ApiDimensions {\n  const mql = window.matchMedia(MEDIA_VIEWER_MEDIA_QUERY);\n  const { width: windowWidth, height: windowHeight } = windowSize.get();\n  let occupiedHeightRem = isVideo && mql.matches ? 10 : 8.25;\n  if (withFooter && !IS_TOUCH_ENV) {\n    occupiedHeightRem = mql.matches ? 10 : 12.5;\n  }\n  return {\n    width: windowWidth,\n    height: windowHeight - occupiedHeightRem * REM,\n  };\n}\n\nexport function calculateInlineImageDimensions(\n  photo: ApiPhoto,\n  fromOwnMessage?: boolean,\n  asForwarded?: boolean,\n  isWebPageMedia?: boolean,\n  noAvatars?: boolean,\n  isMobile?: boolean,\n) {\n  const { width, height } = getPhotoInlineDimensions(photo) || DEFAULT_MEDIA_DIMENSIONS;\n\n  return calculateDimensionsForMessageMedia({\n    width,\n    height,\n    fromOwnMessage,\n    asForwarded,\n    isWebPageMedia,\n    noAvatars,\n    isMobile,\n  });\n}\n\nexport function calculateVideoDimensions(\n  video: ApiVideo,\n  fromOwnMessage?: boolean,\n  asForwarded?: boolean,\n  isWebPageMedia?: boolean,\n  noAvatars?: boolean,\n  isMobile?: boolean,\n) {\n  const { width, height } = getVideoDimensions(video) || DEFAULT_MEDIA_DIMENSIONS;\n\n  return calculateDimensionsForMessageMedia({\n    width,\n    height,\n    fromOwnMessage,\n    asForwarded,\n    isWebPageMedia,\n    isGif: video.isGif,\n    noAvatars,\n    isMobile,\n  });\n}\n\nexport function calculateExtendedPreviewDimensions(\n  preview: ApiMediaExtendedPreview,\n  fromOwnMessage?: boolean,\n  asForwarded?: boolean,\n  isWebPageMedia?: boolean,\n  noAvatars?: boolean,\n  isMobile?: boolean,\n) {\n  const { width = DEFAULT_MEDIA_DIMENSIONS.width, height = DEFAULT_MEDIA_DIMENSIONS.height } = preview;\n\n  return calculateDimensionsForMessageMedia({\n    width,\n    height,\n    fromOwnMessage,\n    asForwarded,\n    isWebPageMedia,\n    noAvatars,\n    isMobile,\n  });\n}\n\nexport function getPictogramDimensions(): ApiDimensions {\n  return {\n    width: 2 * REM,\n    height: 2 * REM,\n  };\n}\n\nexport function getDocumentThumbnailDimensions(smaller?: boolean): ApiDimensions {\n  if (smaller) {\n    return {\n      width: 3 * REM,\n      height: 3 * REM,\n    };\n  }\n\n  return {\n    width: 3.375 * REM,\n    height: 3.375 * REM,\n  };\n}\n\nexport function getStickerDimensions(sticker: ApiSticker, isMobile?: boolean): ApiDimensions {\n  const { width } = sticker;\n  let { height } = sticker;\n\n  // For some reason this sticker has some weird `height` value\n  if (sticker.id === LIKE_STICKER_ID) {\n    height = width;\n  }\n\n  const aspectRatio = (height && width) && height / width;\n  const baseWidth = REM * (\n    isMobile\n      ? STICKER_SIZE_INLINE_MOBILE_FACTOR\n      : STICKER_SIZE_INLINE_DESKTOP_FACTOR\n  );\n  const calculatedHeight = aspectRatio ? baseWidth * aspectRatio : baseWidth;\n\n  if (aspectRatio && calculatedHeight > baseWidth) {\n    return {\n      width: Math.round(baseWidth / aspectRatio),\n      height: baseWidth,\n    };\n  }\n\n  return {\n    width: baseWidth,\n    height: calculatedHeight,\n  };\n}\n\nexport function calculateMediaViewerDimensions(\n  { width, height }: ApiDimensions, withFooter: boolean, isVideo: boolean = false,\n): ApiDimensions {\n  const { width: availableWidth, height: availableHeight } = getMediaViewerAvailableDimensions(withFooter, isVideo);\n\n  return calculateDimensions(availableWidth, availableHeight, width, height);\n}\n\nexport function calculateDimensions(\n  availableWidth: number,\n  availableHeight: number,\n  mediaWidth: number,\n  mediaHeight: number,\n): ApiDimensions {\n  const aspectRatio = mediaHeight / mediaWidth;\n  const calculatedWidth = Math.min(mediaWidth, availableWidth);\n  const calculatedHeight = Math.round(calculatedWidth * aspectRatio);\n\n  if (calculatedHeight > availableHeight) {\n    return {\n      width: Math.round(availableHeight / aspectRatio),\n      height: availableHeight,\n    };\n  }\n\n  return {\n    width: calculatedWidth,\n    height: Math.round(calculatedWidth * aspectRatio),\n  };\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"A72KeAmh\",\"icon\":\"eLEPgwPj\",\"title\":\"ZQJO2BKn\"};","import type { FC } from '../../lib/teact/teact';\nimport React, { memo } from '../../lib/teact/teact';\n\nimport type { ThreadId } from '../../types';\n\nimport { GENERAL_TOPIC_ID } from '../../config';\nimport buildClassName from '../../util/buildClassName';\nimport { getTopicDefaultIcon } from '../../util/forumColors';\nimport { getFirstLetters } from '../../util/textFormat';\nimport renderText from './helpers/renderText';\n\nimport Icon from './icons/Icon';\n\nimport styles from './TopicDefaultIcon.module.scss';\n\ntype OwnProps = {\n  className?: string;\n  letterClassName?: string;\n  topicId: ThreadId;\n  iconColor?: number;\n  title: string;\n  onClick?: NoneToVoidFunction;\n};\n\nconst TopicDefaultIcon: FC<OwnProps> = ({\n  className,\n  letterClassName,\n  topicId,\n  iconColor,\n  title,\n  onClick,\n}) => {\n  const iconSrc = getTopicDefaultIcon(iconColor);\n\n  if (topicId === GENERAL_TOPIC_ID) {\n    return (\n      <Icon\n        name=\"hashtag\"\n        className={buildClassName(styles.root, className, 'general-forum-icon')}\n        onClick={onClick}\n      />\n    );\n  }\n  return (\n    <div className={buildClassName(styles.root, className)} onClick={onClick}>\n      <img className={styles.icon} src={iconSrc} alt=\"\" draggable={false} />\n      <div className={buildClassName(styles.title, letterClassName, 'topic-icon-letter')}>\n        {renderText(getFirstLetters(title, 1))}\n      </div>\n    </div>\n  );\n};\n\nexport default memo(TopicDefaultIcon);\n","import type {\n  ApiAttachment,\n  ApiAudio,\n  ApiDimensions,\n  ApiDocument,\n  ApiGame,\n  ApiLocation,\n  ApiMediaExtendedPreview,\n  ApiMessage,\n  ApiMessageSearchType,\n  ApiPhoto,\n  ApiSticker,\n  ApiVideo,\n  ApiVoice,\n  ApiWebDocument,\n  MediaContainer,\n} from '../../api/types';\nimport type { ActiveDownloads } from '../../types';\nimport { ApiMediaFormat } from '../../api/types';\n\nimport {\n  IS_OPFS_SUPPORTED,\n  IS_OPUS_SUPPORTED,\n  IS_PROGRESSIVE_SUPPORTED,\n  IS_SAFARI,\n  MAX_BUFFER_SIZE,\n} from '../../util/browser/windowEnvironment';\nimport { getDocumentHasPreview } from '../../components/common/helpers/documentInfo';\nimport { getAttachmentMediaType, matchLinkInMessageText } from './messages';\n\nexport type MediaWithThumbs = ApiPhoto | ApiVideo | ApiDocument | ApiSticker | ApiMediaExtendedPreview;\nexport type DownloadableMedia = ApiPhoto | ApiVideo | ApiDocument | ApiSticker | ApiAudio | ApiVoice | ApiWebDocument;\n\ntype Target =\n  'micro'\n  | 'pictogram'\n  | 'inline'\n  | 'preview'\n  | 'full'\n  | 'download';\n\nexport function getMessageContent(message: MediaContainer) {\n  return message.content;\n}\n\nexport function hasMessageMedia(message: MediaContainer) {\n  return Boolean((\n    getMessagePhoto(message)\n    || getMessageVideo(message)\n    || getMessageDocument(message)\n    || getMessageSticker(message)\n    || getMessageContact(message)\n    || getMessagePollId(message)\n    || getMessageAction(message)\n    || getMessageAudio(message)\n    || getMessageVoice(message)\n  ));\n}\n\nexport function canEditMedia(message: MediaContainer) {\n  const {\n    photo, video, altVideos, audio, document, text, webPage, ...otherMedia\n  } = message.content;\n\n  return !video?.isRound && !Object.keys(otherMedia).length;\n}\n\nexport function getMessagePhoto(message: MediaContainer) {\n  return message.content.photo;\n}\n\nexport function getMessageActionPhoto(message: MediaContainer) {\n  return message.content.action?.type === 'suggestProfilePhoto' ? message.content.action.photo : undefined;\n}\n\nexport function getMessageVideo(message: MediaContainer) {\n  return message.content.video;\n}\n\nexport function getMessageRoundVideo(message: MediaContainer) {\n  const { video } = message.content;\n\n  return video?.isRound ? video : undefined;\n}\n\nexport function getMessageAction(message: MediaContainer) {\n  return message.content.action;\n}\n\nexport function getMessageAudio(message: MediaContainer) {\n  return message.content.audio;\n}\n\nexport function getMessageVoice(message: MediaContainer) {\n  return message.content.voice;\n}\n\nexport function getMessageSticker(message: MediaContainer) {\n  return message.content.sticker;\n}\n\nexport function getMessageDocument(message: MediaContainer) {\n  return message.content.document;\n}\n\nexport function getMessageWebPageDocument(message: MediaContainer) {\n  return getMessageWebPage(message)?.document;\n}\n\nexport function isDocumentPhoto(document: ApiDocument) {\n  return document.innerMediaType === 'photo';\n}\n\nexport function isDocumentVideo(document: ApiDocument) {\n  return document.innerMediaType === 'video';\n}\n\nexport function isMessageDocumentSticker(message: MediaContainer) {\n  const document = getMessageDocument(message);\n  return document ? document.mimeType === 'image/webp' : undefined;\n}\n\nexport function getMessageContact(message: MediaContainer) {\n  return message.content.contact;\n}\n\nexport function getMessagePollId(message: MediaContainer) {\n  return message.content.pollId;\n}\n\nexport function getMessageInvoice(message: MediaContainer) {\n  return message.content.invoice;\n}\n\nexport function getMessageLocation(message: MediaContainer) {\n  return message.content.location;\n}\n\nexport function getMessageWebPage(message: MediaContainer) {\n  return message.content.webPage;\n}\n\nexport function getMessagePaidMedia(message: MediaContainer) {\n  return message.content.paidMedia;\n}\n\nexport function getMessageWebPagePhoto(message: MediaContainer) {\n  return getMessageWebPage(message)?.photo;\n}\n\nexport function getMessageDocumentPhoto(message: MediaContainer) {\n  const document = getMessageDocument(message);\n  return document && isDocumentPhoto(document) ? document : undefined;\n}\n\nexport function getMessageWebPageVideo(message: MediaContainer) {\n  return getMessageWebPage(message)?.video;\n}\n\nexport function getMessageWebPageAudio(message: MediaContainer) {\n  return getMessageWebPage(message)?.audio;\n}\n\nexport function getMessageDocumentVideo(message: MediaContainer) {\n  const document = getMessageDocument(message);\n  return document && isDocumentVideo(document) ? document : undefined;\n}\n\nexport function getMessageDownloadableMedia(message: MediaContainer): DownloadableMedia | undefined {\n  return (\n    getMessagePhoto(message)\n    || getMessageVideo(message)\n    || getMessageDocument(message)\n    || getMessageSticker(message)\n    || getMessageAudio(message)\n    || getMessageVoice(message)\n    || getMessageWebPagePhoto(message)\n    || getMessageWebPageVideo(message)\n    || getMessageWebPageAudio(message)\n  );\n}\n\nfunction getMessageMediaThumbnail(message: MediaContainer) {\n  const media = getMessagePhoto(message)\n    || getMessageVideo(message)\n    || getMessageDocument(message)\n    || getMessageSticker(message)\n    || getMessageWebPagePhoto(message)\n    || getMessageWebPageVideo(message)\n    || getMessageInvoice(message)?.extendedMedia;\n\n  if (!media) {\n    return undefined;\n  }\n\n  return media.thumbnail;\n}\n\nexport function getMessageMediaThumbDataUri(message: MediaContainer) {\n  return getMessageMediaThumbnail(message)?.dataUri;\n}\n\nexport function getMediaThumbUri(media: MediaWithThumbs) {\n  return media.thumbnail?.dataUri;\n}\n\nexport function getMessageIsSpoiler(message: MediaContainer) {\n  const media = getMessagePhoto(message)\n    || getMessageVideo(message);\n\n  const invoiceMedia = getMessageInvoice(message)?.extendedMedia;\n  return Boolean(invoiceMedia || media?.isSpoiler);\n}\n\nexport function buildStaticMapHash(\n  geo: ApiLocation['geo'],\n  width: number,\n  height: number,\n  zoom: number,\n  scale: number,\n) {\n  const {\n    long, lat, accessHash, accuracyRadius,\n  } = geo;\n\n  // eslint-disable-next-line max-len\n  return `staticMap:${accessHash}?lat=${lat}&long=${long}&w=${width}&h=${height}&zoom=${zoom}&scale=${scale}&accuracyRadius=${accuracyRadius}`;\n}\n\nexport function getMessageMediaHash(\n  message: MediaContainer,\n  target: Target,\n) {\n  const {\n    video, sticker, audio, voice, document,\n  } = message.content;\n\n  const messagePhoto = getMessagePhoto(message) || getMessageWebPagePhoto(message);\n  const actionPhoto = getMessageActionPhoto(message);\n  const messageVideo = video || getMessageWebPageVideo(message);\n  const messageDocument = document || getMessageWebPageDocument(message);\n  const messageAudio = audio || getMessageWebPageAudio(message);\n\n  if (messageVideo) {\n    return getVideoMediaHash(messageVideo, target);\n  }\n\n  if (messagePhoto || actionPhoto) {\n    return getPhotoMediaHash(messagePhoto || actionPhoto!, target, Boolean(actionPhoto));\n  }\n\n  if (messageDocument) {\n    return getDocumentMediaHash(messageDocument, target);\n  }\n\n  if (sticker) {\n    return getStickerMediaHash(sticker, target);\n  }\n\n  if (messageAudio) {\n    return getAudioMediaHash(messageAudio, target);\n  }\n\n  if (voice) {\n    return getVoiceMediaHash(voice, target);\n  }\n\n  return undefined;\n}\n\nexport function getPhotoMediaHash(photo: ApiPhoto | ApiDocument, target: Target, isAction?: boolean) {\n  const base = `photo${photo.id}`;\n  const isVideo = photo.mediaType === 'photo' && photo.isVideo;\n\n  switch (target) {\n    case 'micro':\n    case 'pictogram':\n      return `${base}?size=${isAction ? 'a' : 'm'}`;\n    case 'inline':\n      return !hasMediaLocalBlobUrl(photo) ? `${base}?size=${isAction ? 'b' : 'x'}` : undefined;\n    case 'preview':\n      return `${base}?size=${isAction ? 'b' : 'x'}`;\n    case 'download':\n      return !isVideo ? base : getVideoProfilePhotoMediaHash(photo);\n    case 'full':\n    default:\n      return base;\n  }\n}\n\nexport function getProfilePhotoMediaHash(photo: ApiPhoto) {\n  return `photo${photo.id}?size=c`;\n}\n\nexport function getVideoProfilePhotoMediaHash(photo: ApiPhoto) {\n  if (!photo.isVideo) return undefined;\n  return `photo${photo.id}?size=u`;\n}\n\nexport function getVideoMediaHash(video: ApiVideo | ApiDocument, target: Target) {\n  const base = `document${video.id}`;\n\n  switch (target) {\n    case 'micro':\n    case 'pictogram':\n      return `${base}?size=m`;\n    case 'inline':\n      return !hasMediaLocalBlobUrl(video) ? appendProgressiveQueryParameters(video, base) : undefined;\n    case 'preview':\n      return `${base}?size=x`;\n    case 'download':\n      return `${base}?download`;\n    case 'full':\n    default:\n      return appendProgressiveQueryParameters(video, base);\n  }\n}\n\nexport function getVideoPreviewMediaHash(video: ApiVideo) {\n  return video.hasVideoPreview ? `document${video.id}?size=v` : undefined;\n}\n\nexport function getDocumentMediaHash(document: ApiDocument, target: Target) {\n  const base = `document${document.id}`;\n\n  switch (target) {\n    case 'micro':\n    case 'pictogram':\n    case 'inline':\n    case 'preview':\n      if (!getDocumentHasPreview(document) || hasMediaLocalBlobUrl(document)) {\n        return undefined;\n      }\n\n      return `${base}?size=m`;\n    case 'full':\n    case 'download':\n    default:\n      return base;\n  }\n}\n\nexport function getAudioMediaHash(audio: ApiAudio, target: Target) {\n  const base = `document${audio.id}`;\n\n  switch (target) {\n    case 'micro':\n    case 'pictogram':\n      return getAudioHasCover(audio) ? `${base}?size=m` : undefined;\n    case 'inline':\n      return appendProgressiveQueryParameters(audio, base);\n    case 'download':\n      return `${base}?download`;\n    default:\n      return base;\n  }\n}\n\nexport function getVoiceMediaHash(voice: ApiVoice, target: Target) {\n  const base = `document${voice.id}`;\n\n  switch (target) {\n    case 'micro':\n    case 'pictogram':\n      return undefined;\n    case 'download':\n      return `${base}?download`;\n    case 'inline':\n    default:\n      return base;\n  }\n}\n\nexport function getWebDocumentHash(webDocument?: ApiWebDocument) {\n  if (!webDocument) return undefined;\n  return `webDocument:${webDocument.url}`;\n}\n\nexport function getStickerMediaHash(sticker: ApiSticker, target: Target) {\n  const base = `document${sticker.id}`;\n\n  switch (target) {\n    case 'micro':\n    case 'pictogram':\n      if (!sticker.previewPhotoSizes?.some((size) => size.type === 's')) {\n        return getStickerMediaHash(sticker, 'preview');\n      }\n      return `${base}?size=s`;\n    case 'preview':\n      return `${base}?size=m`;\n    case 'download':\n      return `${base}?download`;\n    case 'inline':\n    default:\n      return base;\n  }\n}\n\nexport function getMediaHash(media: DownloadableMedia, target: Target) {\n  switch (media.mediaType) {\n    case 'photo':\n      return getPhotoMediaHash(media, target);\n    case 'video':\n      return getVideoMediaHash(media, target);\n    case 'document':\n      return getDocumentMediaHash(media, target);\n    case 'audio':\n      return getAudioMediaHash(media, target);\n    case 'voice':\n      return getVoiceMediaHash(media, target);\n    case 'sticker':\n      return getStickerMediaHash(media, target);\n    case 'webDocument':\n      return getWebDocumentHash(media);\n    default:\n      return undefined;\n  }\n}\n\nexport function getGamePreviewPhotoHash(game: ApiGame) {\n  const { photo } = game;\n\n  if (photo) {\n    return `photo${photo.id}?size=x`;\n  }\n\n  return undefined;\n}\n\nexport function getGamePreviewVideoHash(game: ApiGame) {\n  const { document } = game;\n\n  if (document) {\n    return `document${document.id}`;\n  }\n\n  return undefined;\n}\n\nexport function appendProgressiveQueryParameters(media: ApiAudio | ApiVideo | ApiDocument, base: string) {\n  if (IS_PROGRESSIVE_SUPPORTED && IS_SAFARI) {\n    const url = new URL(base, window.location.href);\n    url.searchParams.append('fileSize', media.size.toString());\n    url.searchParams.append('mimeType', media.mimeType);\n    return url.toString();\n  }\n\n  return base;\n}\n\nexport function getAudioHasCover(media: ApiAudio) {\n  return media.thumbnailSizes && media.thumbnailSizes.length > 0;\n}\n\nexport function getMediaFormat(\n  media: DownloadableMedia, target: Target,\n): ApiMediaFormat {\n  const isDocument = media.mediaType === 'document';\n  const hasInnerVideo = isDocument && media.innerMediaType === 'video';\n  const isVideo = media.mediaType === 'video' || hasInnerVideo;\n  const isAudio = media.mediaType === 'audio';\n  const isVoice = media.mediaType === 'voice';\n\n  const size = getMediaFileSize(media) || 0; // Media types that do not have `size` are smaller than `MAX_BUFFER_SIZE`\n\n  if (target === 'download') {\n    if (IS_PROGRESSIVE_SUPPORTED && size > MAX_BUFFER_SIZE && !IS_OPFS_SUPPORTED) {\n      return ApiMediaFormat.DownloadUrl;\n    }\n    return ApiMediaFormat.BlobUrl;\n  }\n\n  if (isVideo && IS_PROGRESSIVE_SUPPORTED && (\n    target === 'full' || target === 'inline'\n  )) {\n    return ApiMediaFormat.Progressive;\n  }\n\n  if (isAudio || isVoice) {\n    // Safari\n    if (isVoice && !IS_OPUS_SUPPORTED) {\n      return ApiMediaFormat.BlobUrl;\n    }\n\n    return ApiMediaFormat.Progressive;\n  }\n\n  return ApiMediaFormat.BlobUrl;\n}\n\nexport function getMediaFileSize(media: DownloadableMedia) {\n  return 'size' in media ? media.size : undefined;\n}\n\nexport function hasMediaLocalBlobUrl(media: ApiPhoto | ApiVideo | ApiDocument) {\n  if ('blobUrl' in media) {\n    return Boolean(media.blobUrl);\n  }\n\n  if ('previewBlobUrl' in media) {\n    return Boolean(media.previewBlobUrl);\n  }\n\n  return false;\n}\n\nexport function getChatMediaMessageIds(\n  messages: Record<number, ApiMessage>, listedIds: number[], isFromSharedMedia = false,\n) {\n  return getMessageContentIds(messages, listedIds, isFromSharedMedia ? 'media' : 'inlineMedia');\n}\n\nexport function getPhotoFullDimensions(photo: Pick<ApiPhoto, 'sizes' | 'thumbnail'>): ApiDimensions | undefined {\n  return (\n    photo.sizes.find((size) => size.type === 'w')\n    || photo.sizes.find((size) => size.type === 'y')\n    || getPhotoInlineDimensions(photo)\n  );\n}\n\nexport function getPhotoInlineDimensions(photo: Pick<ApiPhoto, 'sizes' | 'thumbnail'>): ApiDimensions | undefined {\n  return (\n    photo.sizes.find((size) => size.type === 'x')\n    || photo.sizes.find((size) => size.type === 'm')\n    || photo.sizes.find((size) => size.type === 's')\n    || photo.thumbnail\n  );\n}\n\nexport function getVideoDimensions(video: ApiVideo): ApiDimensions | undefined {\n  if (video.width && video.height) {\n    return video as ApiDimensions;\n  }\n\n  return undefined;\n}\n\nexport function getMediaTransferState(\n  progress?: number, isLoadNeeded = false, isUploading = false,\n) {\n  const isTransferring = isUploading || isLoadNeeded;\n  const transferProgress = Number(progress);\n\n  return {\n    isUploading, isTransferring, transferProgress,\n  };\n}\n\nexport function getMessageContentIds(\n  messages: Record<number, ApiMessage>, messageIds: number[], contentType: ApiMessageSearchType | 'inlineMedia',\n) {\n  let validator: Function;\n\n  switch (contentType) {\n    case 'media':\n      validator = (message: ApiMessage) => {\n        const video = getMessageVideo(message);\n        return getMessagePhoto(message) || (video && !video.isRound && !video.isGif);\n      };\n      break;\n\n    case 'documents':\n      validator = getMessageDocument;\n      break;\n\n    case 'links':\n      validator = (message: ApiMessage) => getMessageWebPage(message) || matchLinkInMessageText(message);\n      break;\n\n    case 'audio':\n      validator = getMessageAudio;\n      break;\n\n    case 'voice':\n      validator = (message: ApiMessage) => {\n        const video = getMessageVideo(message);\n        return getMessageVoice(message) || (video && video.isRound);\n      };\n      break;\n\n    case 'inlineMedia':\n      validator = (message: ApiMessage) => {\n        const video = getMessageVideo(message);\n        const document = getMessageDocument(message);\n        return (\n          getMessagePhoto(message)\n          || (video && !video.isRound && !video.isGif)\n          || (document && isDocumentPhoto(document))\n          || (document && isDocumentVideo(document))\n        );\n      };\n      break;\n\n    default:\n      return [] as Array<number>;\n  }\n\n  return messageIds.reduce((result, messageId) => {\n    if (messages[messageId] && validator(messages[messageId])) {\n      result.push(messageId);\n    }\n\n    return result;\n  }, [] as Array<number>);\n}\n\nexport function getMediaDuration(message: ApiMessage) {\n  const { audio, voice, video } = getMessageContent(message);\n  const media = audio || voice || video || getMessageWebPageVideo(message) || getMessageWebPageAudio(message);\n  if (!media) {\n    return undefined;\n  }\n\n  return media.duration;\n}\n\nexport function canReplaceMessageMedia(message: ApiMessage, attachment: ApiAttachment) {\n  const isPhotoOrVideo = Boolean(getMessagePhoto(message)\n    || getMessageWebPagePhoto(message) || Boolean(getMessageVideo(message)\n      || getMessageWebPageVideo(message)));\n  const isFile = Boolean(getMessageAudio(message)\n    || getMessageVoice(message) || getMessageDocument(message));\n\n  const fileType = getAttachmentMediaType(attachment);\n\n  return (\n    (isPhotoOrVideo && (fileType === 'photo' || fileType === 'video'))\n    || (isFile && (fileType === 'audio' || fileType === 'file'))\n  );\n}\n\nexport function isMediaLoadableInViewer(newMessage: ApiMessage) {\n  if (!newMessage.content) return false;\n  if (newMessage.content.photo) return true;\n  if (newMessage.content.video && !newMessage.content.video.isRound && !newMessage.content.video.isGif) return true;\n  return false;\n}\n\nexport function getMediaFilename(media: DownloadableMedia) {\n  if ('fileName' in media && media.fileName) {\n    return media.fileName;\n  }\n\n  if (media.mediaType === 'sticker') {\n    const extension = media.isLottie ? 'tgs' : media.isVideo ? 'webm' : 'webp';\n    return `${media.id}.${extension}`;\n  }\n\n  if (media.mediaType === 'photo') {\n    return `${media.id}.${media.isVideo ? 'mp4' : 'jpg'}`;\n  }\n\n  if (media.mediaType === 'voice') {\n    return `${media.id}.${IS_OPUS_SUPPORTED ? 'ogg' : 'wav'}`;\n  }\n\n  if ('id' in media && media.id) {\n    return media.id;\n  }\n\n  return `${media.mediaType}-${Math.random().toString(36).slice(4)}`;\n}\n\nexport function getIsDownloading(activeDownloads: ActiveDownloads, media: DownloadableMedia) {\n  const hash = getMediaHash(media, 'download');\n  if (!hash) return false;\n  return Boolean(activeDownloads[hash]);\n}\n\nexport function getTimestampableMedia(message: MediaContainer) {\n  const video = getMessageVideo(message) || getMessageWebPageVideo(message);\n  return (video && !video.isRound && !video.isGif ? video : undefined)\n    || getMessageAudio(message)\n    || getMessageVoice(message);\n}\n","import type { RefObject } from 'react';\nimport { useEffect, useRef } from '../lib/teact/teact';\n\nimport { IS_ELECTRON, IS_MAC_OS } from '../util/browser/windowEnvironment';\n\nconst DRAG_DISTANCE_THRESHOLD = 5;\n\nconst useElectronDrag = (ref: RefObject<HTMLDivElement>) => {\n  const isDragging = useRef(false);\n\n  const x = useRef(window.screenX);\n  const y = useRef(window.screenY);\n  const distance = useRef(0);\n\n  useEffect(() => {\n    const element: HTMLDivElement | null = ref.current;\n    if (!element || !(IS_ELECTRON && IS_MAC_OS)) return undefined;\n\n    const handleClick = (event: MouseEvent) => {\n      distance.current = 0;\n\n      if (isDragging.current) {\n        event.preventDefault();\n        event.stopPropagation();\n        isDragging.current = false;\n      }\n    };\n\n    const handleMousedown = (event: MouseEvent) => {\n      if (isDragging.current) {\n        event.preventDefault();\n        event.stopPropagation();\n      }\n    };\n\n    const handleDrag = (event: MouseEvent) => {\n      if (event.buttons === 1) {\n        distance.current += Math.sqrt((x.current - window.screenX) ** 2 + (y.current - window.screenY) ** 2);\n\n        x.current = window.screenX;\n        y.current = window.screenY;\n\n        if (!isDragging.current && distance.current > DRAG_DISTANCE_THRESHOLD) {\n          isDragging.current = true;\n        }\n      }\n    };\n\n    const handleDoubleClick = (event: MouseEvent) => {\n      if (event.currentTarget === event.target) {\n        window.electron?.handleDoubleClick();\n      }\n    };\n\n    element.addEventListener('click', handleClick);\n    element.addEventListener('mousedown', handleMousedown);\n    element.addEventListener('mousemove', handleDrag);\n    element.addEventListener('dblclick', handleDoubleClick);\n\n    return () => {\n      element.removeEventListener('click', handleClick);\n      element.removeEventListener('mouseup', handleMousedown);\n      element.removeEventListener('mousemove', handleDrag);\n      element.removeEventListener('dblclick', handleDoubleClick);\n    };\n  }, [ref]);\n};\n\nexport default useElectronDrag;\n","import QrPlane from '../../../assets/tgs/auth/QrPlane.tgs';\nimport BannedDuck from '../../../assets/tgs/BannedDuck.tgs';\nimport CameraFlip from '../../../assets/tgs/calls/CameraFlip.tgs';\nimport HandFilled from '../../../assets/tgs/calls/HandFilled.tgs';\nimport HandOutline from '../../../assets/tgs/calls/HandOutline.tgs';\nimport Speaker from '../../../assets/tgs/calls/Speaker.tgs';\nimport VoiceAllowTalk from '../../../assets/tgs/calls/VoiceAllowTalk.tgs';\nimport VoiceMini from '../../../assets/tgs/calls/VoiceMini.tgs';\nimport VoiceMuted from '../../../assets/tgs/calls/VoiceMuted.tgs';\nimport VoiceOutlined from '../../../assets/tgs/calls/VoiceOutlined.tgs';\nimport Flame from '../../../assets/tgs/general/Flame.tgs';\nimport Fragment from '../../../assets/tgs/general/Fragment.tgs';\nimport Mention from '../../../assets/tgs/general/Mention.tgs';\nimport PartyPopper from '../../../assets/tgs/general/PartyPopper.tgs';\nimport Invite from '../../../assets/tgs/invites/Invite.tgs';\nimport JoinRequest from '../../../assets/tgs/invites/Requests.tgs';\nimport LastSeen from '../../../assets/tgs/LastSeen.tgs';\nimport MonkeyClose from '../../../assets/tgs/monkeys/TwoFactorSetupMonkeyClose.tgs';\nimport MonkeyIdle from '../../../assets/tgs/monkeys/TwoFactorSetupMonkeyIdle.tgs';\nimport MonkeyPeek from '../../../assets/tgs/monkeys/TwoFactorSetupMonkeyPeek.tgs';\nimport MonkeyTracking from '../../../assets/tgs/monkeys/TwoFactorSetupMonkeyTracking.tgs';\nimport ReadTime from '../../../assets/tgs/ReadTime.tgs';\nimport Report from '../../../assets/tgs/Report.tgs';\nimport SearchingDuck from '../../../assets/tgs/SearchingDuck.tgs';\nimport Congratulations from '../../../assets/tgs/settings/Congratulations.tgs';\nimport DiscussionGroups from '../../../assets/tgs/settings/DiscussionGroupsDucks.tgs';\nimport Experimental from '../../../assets/tgs/settings/Experimental.tgs';\nimport FoldersAll from '../../../assets/tgs/settings/FoldersAll.tgs';\nimport FoldersNew from '../../../assets/tgs/settings/FoldersNew.tgs';\nimport FoldersShare from '../../../assets/tgs/settings/FoldersShare.tgs';\nimport Lock from '../../../assets/tgs/settings/Lock.tgs';\nimport StarReaction from '../../../assets/tgs/stars/StarReaction.tgs';\nimport StarReactionEffect from '../../../assets/tgs/stars/StarReactionEffect.tgs';\nimport Unlock from '../../../assets/tgs/Unlock.tgs';\n\nexport const LOCAL_TGS_URLS = {\n  MonkeyIdle,\n  MonkeyTracking,\n  MonkeyClose,\n  MonkeyPeek,\n  FoldersAll,\n  FoldersNew,\n  FoldersShare,\n  DiscussionGroups,\n  Lock,\n  CameraFlip,\n  HandFilled,\n  HandOutline,\n  Speaker,\n  VoiceAllowTalk,\n  VoiceMini,\n  VoiceMuted,\n  VoiceOutlined,\n  JoinRequest,\n  Invite,\n  QrPlane,\n  Congratulations,\n  Experimental,\n  PartyPopper,\n  Flame,\n  ReadTime,\n  Unlock,\n  LastSeen,\n  Mention,\n  Fragment,\n  StarReactionEffect,\n  StarReaction,\n  Report,\n  SearchingDuck,\n  BannedDuck,\n};\n","import type { ApiFormattedText } from '../../api/types';\nimport { ApiMessageEntityTypes } from '../../api/types';\n\nexport function getStickerHashById(stickerId: string, isPreview?: boolean) {\n  const base = `sticker${stickerId}`;\n  return !isPreview ? base : `${base}?size=m`;\n}\n\nexport function containsCustomEmoji(formattedText: ApiFormattedText) {\n  return formattedText.entities?.some((e) => e.type === ApiMessageEntityTypes.CustomEmoji);\n}\n\nexport function stripCustomEmoji(text: ApiFormattedText): ApiFormattedText {\n  if (!text.entities) return text;\n\n  const entities = text.entities.filter((entity) => entity.type !== ApiMessageEntityTypes.CustomEmoji);\n  return { ...text, entities };\n}\n","import type { ApiPeer, ApiUser, ApiUserStatus } from '../../api/types';\nimport type { OldLangFn } from '../../hooks/useOldLang';\n\nimport { ANONYMOUS_USER_ID, SERVICE_NOTIFICATIONS_USER_ID } from '../../config';\nimport { formatFullDate, formatTime } from '../../util/dates/dateFormat';\nimport { DAY } from '../../util/dates/units';\nimport { orderBy } from '../../util/iteratees';\nimport { formatPhoneNumber } from '../../util/phoneNumber';\nimport { getServerTime, getServerTimeOffset } from '../../util/serverTime';\n\nexport function getUserFirstOrLastName(user?: ApiUser) {\n  if (!user) {\n    return undefined;\n  }\n\n  switch (user.type) {\n    case 'userTypeBot':\n      return user.firstName;\n    case 'userTypeRegular': {\n      return user.firstName || user.lastName;\n    }\n\n    case 'userTypeDeleted':\n    case 'userTypeUnknown': {\n      return 'Deleted';\n    }\n\n    default:\n      return undefined;\n  }\n}\n\nexport function getUserFullName(user?: ApiUser) {\n  if (!user) {\n    return undefined;\n  }\n\n  if (isDeletedUser(user)) {\n    return 'Deleted Account';\n  }\n\n  switch (user.type) {\n    case 'userTypeBot':\n    case 'userTypeRegular': {\n      if (user.firstName && user.lastName) {\n        return `${user.firstName} ${user.lastName}`;\n      }\n\n      if (user.firstName) {\n        return user.firstName;\n      }\n\n      if (user.lastName) {\n        return user.lastName;\n      }\n\n      if (user.phoneNumber) {\n        return `+${formatPhoneNumber(user.phoneNumber)}`;\n      }\n\n      break;\n    }\n  }\n\n  return undefined;\n}\n\nexport function getUserStatus(\n  lang: OldLangFn, user: ApiUser, userStatus: ApiUserStatus | undefined,\n) {\n  if (user.id === SERVICE_NOTIFICATIONS_USER_ID) {\n    return lang('ServiceNotifications');\n  }\n\n  if (user.isSupport) {\n    return lang('SupportStatus');\n  }\n\n  if (user.type && user.type === 'userTypeBot') {\n    if (user.botActiveUsers) {\n      return lang('BotUsers', user.botActiveUsers, 'i');\n    }\n    return lang('Bot');\n  }\n\n  if (!userStatus) {\n    return '';\n  }\n\n  switch (userStatus.type) {\n    case 'userStatusEmpty': {\n      return lang('ALongTimeAgo');\n    }\n\n    case 'userStatusLastMonth': {\n      return lang('WithinAMonth');\n    }\n\n    case 'userStatusLastWeek': {\n      return lang('WithinAWeek');\n    }\n\n    case 'userStatusOffline': {\n      const { wasOnline } = userStatus;\n\n      if (!wasOnline) return lang('LastSeen.Offline');\n\n      const serverTimeOffset = getServerTimeOffset();\n      const now = new Date(Date.now() + serverTimeOffset * 1000);\n      const wasOnlineDate = new Date(wasOnline * 1000);\n\n      if (wasOnlineDate >= now) {\n        return lang('LastSeen.JustNow');\n      }\n\n      const diff = new Date(now.getTime() - wasOnlineDate.getTime());\n\n      // within a minute\n      if (diff.getTime() / 1000 < 60) {\n        return lang('LastSeen.JustNow');\n      }\n\n      // within an hour\n      if (diff.getTime() / 1000 < 60 * 60) {\n        const minutes = Math.floor(diff.getTime() / 1000 / 60);\n        return lang('LastSeen.MinutesAgo', minutes);\n      }\n\n      // today\n      const today = new Date();\n      today.setHours(0, 0, 0, 0);\n      const serverToday = new Date(today.getTime() + serverTimeOffset * 1000);\n      if (wasOnlineDate > serverToday) {\n        // up to 6 hours ago\n        if (diff.getTime() / 1000 < 6 * 60 * 60) {\n          const hours = Math.floor(diff.getTime() / 1000 / 60 / 60);\n          return lang('LastSeen.HoursAgo', hours);\n        }\n\n        // other\n        return lang('LastSeen.TodayAt', formatTime(lang, wasOnlineDate));\n      }\n\n      // yesterday\n      const yesterday = new Date();\n      yesterday.setDate(now.getDate() - 1);\n      yesterday.setHours(0, 0, 0, 0);\n      const serverYesterday = new Date(yesterday.getTime() + serverTimeOffset * 1000);\n      if (wasOnlineDate > serverYesterday) {\n        return lang('LastSeen.YesterdayAt', formatTime(lang, wasOnlineDate));\n      }\n\n      return lang('LastSeen.AtDate', formatFullDate(lang, wasOnlineDate));\n    }\n\n    case 'userStatusOnline': {\n      return lang('Online');\n    }\n\n    case 'userStatusRecently': {\n      return lang('Lately');\n    }\n\n    default:\n      return undefined;\n  }\n}\n\nexport function isUserOnline(user: ApiUser, userStatus?: ApiUserStatus, withSelfOnline = false) {\n  const { id, type } = user;\n\n  if (!userStatus) {\n    return false;\n  }\n\n  if (id === SERVICE_NOTIFICATIONS_USER_ID) {\n    return false;\n  }\n\n  if (user.isSelf && !withSelfOnline) {\n    return false;\n  }\n\n  return userStatus.type === 'userStatusOnline' && type !== 'userTypeBot';\n}\n\nexport function isDeletedUser(user: ApiUser) {\n  return (user.type === 'userTypeDeleted' || user.type === 'userTypeUnknown')\n    && user.id !== SERVICE_NOTIFICATIONS_USER_ID;\n}\n\nexport function isUserBot(user: ApiUser) {\n  return user.type === 'userTypeBot';\n}\n\nexport function getCanAddContact(user: ApiUser) {\n  return !user.isSelf && !user.isContact && !isUserBot(user) && user.id !== ANONYMOUS_USER_ID;\n}\n\nexport function sortUserIds(\n  userIds: string[],\n  usersById: Record<string, ApiUser>,\n  userStatusesById: Record<string, ApiUserStatus>,\n  priorityIds?: string[],\n) {\n  return orderBy(userIds, (id) => {\n    const now = getServerTime();\n\n    if (priorityIds && priorityIds.includes(id)) {\n      // Assuming that online status expiration date can't be as far as two days from now,\n      // this should place prioritized on top of the list.\n      // Then we subtract index of `id` in `priorityIds` to preserve selected order\n      return now + (48 * 60 * 60) - (priorityIds.length - priorityIds.indexOf(id));\n    }\n\n    const user = usersById[id];\n    const userStatus = userStatusesById[id];\n    if (!user || !userStatus) {\n      return 0;\n    }\n\n    if (userStatus.type === 'userStatusOnline') {\n      return userStatus.expires;\n    } else if (userStatus.type === 'userStatusOffline' && userStatus.wasOnline) {\n      return userStatus.wasOnline;\n    }\n\n    switch (userStatus.type) {\n      case 'userStatusRecently':\n        return now - DAY;\n      case 'userStatusLastWeek':\n        return now - DAY * 7;\n      case 'userStatusLastMonth':\n        return now - DAY * 7 * 30;\n      default:\n        return 0;\n    }\n  }, 'desc');\n}\n\nexport function getMainUsername(userOrChat: ApiPeer) {\n  return userOrChat.usernames?.find((u) => u.isActive)?.username;\n}\n\nexport function getPeerStoryHtmlId(userId: string) {\n  return `peer-story${userId}`;\n}\n","export const MEMO_EMPTY_ARRAY = [];\n","import { DEBUG } from '../config';\nimport { createCallbackManager } from './callbacks';\n\nexport enum Bundles {\n  Auth,\n  Main,\n  Extra,\n  Calls,\n  Stars,\n}\n\ninterface ImportedBundles {\n  [Bundles.Auth]: typeof import('../bundles/auth');\n  [Bundles.Main]: typeof import('../bundles/main');\n  [Bundles.Extra]: typeof import('../bundles/extra');\n  [Bundles.Calls]: typeof import('../bundles/calls');\n  [Bundles.Stars]: typeof import('../bundles/stars');\n}\n\ntype BundlePromises = {\n  [K in keyof ImportedBundles]: Promise<ImportedBundles[K]>\n};\n\nexport type BundleModules<B extends keyof ImportedBundles> = keyof ImportedBundles[B];\n\nconst LOAD_PROMISES: Partial<BundlePromises> = {};\nconst MEMORY_CACHE: Partial<ImportedBundles> = {};\n\nconst { addCallback, runCallbacks } = createCallbackManager();\n\nexport async function loadBundle<B extends Bundles>(bundleName: B) {\n  if (!LOAD_PROMISES[bundleName]) {\n    switch (bundleName) {\n      case Bundles.Auth:\n        LOAD_PROMISES[Bundles.Auth] = import(/* webpackChunkName: \"BundleAuth\" */ '../bundles/auth');\n        break;\n      case Bundles.Main:\n        if (DEBUG) {\n          // eslint-disable-next-line no-console\n          console.log('>>> START LOAD MAIN BUNDLE');\n        }\n\n        LOAD_PROMISES[Bundles.Main] = import(/* webpackChunkName: \"BundleMain\" */ '../bundles/main');\n        break;\n      case Bundles.Extra:\n        LOAD_PROMISES[Bundles.Extra] = import(/* webpackChunkName: \"BundleExtra\" */ '../bundles/extra');\n        break;\n      case Bundles.Calls:\n        LOAD_PROMISES[Bundles.Calls] = import(/* webpackChunkName: \"BundleCalls\" */ '../bundles/calls');\n        break;\n      case Bundles.Stars:\n        LOAD_PROMISES[Bundles.Stars] = import(/* webpackChunkName: \"BundleStars\" */ '../bundles/stars');\n        break;\n    }\n\n    (LOAD_PROMISES[bundleName] as Promise<ImportedBundles[B]>).then(runCallbacks);\n  }\n\n  const bundle = (await LOAD_PROMISES[bundleName]) as unknown as ImportedBundles[B];\n\n  if (!MEMORY_CACHE[bundleName]) {\n    MEMORY_CACHE[bundleName] = bundle;\n  }\n\n  return bundle;\n}\n\nexport async function loadModule<B extends Bundles>(bundleName: B) {\n  await loadBundle(bundleName);\n}\n\nexport function getModuleFromMemory<B extends Bundles, M extends BundleModules<B>>(\n  bundleName: B, moduleName: M,\n): ImportedBundles[B][M] | undefined {\n  const bundle = MEMORY_CACHE[bundleName] as ImportedBundles[B];\n\n  if (!bundle) {\n    return undefined;\n  }\n\n  return bundle[moduleName];\n}\n\nexport const addLoadListener = addCallback;\n","let serverTimeOffset = 0;\n\nexport function setServerTimeOffset(_serverTimeOffset: number) {\n  serverTimeOffset = _serverTimeOffset;\n}\n\nexport function getServerTimeOffset() {\n  return serverTimeOffset;\n}\n\nexport function getServerTime() {\n  return Math.floor(Date.now() / 1000) + serverTimeOffset;\n}\n","import { useEffect } from '../lib/teact/teact';\n\nimport type { BundleModules, Bundles } from '../util/moduleLoader';\n\nimport { addLoadListener, getModuleFromMemory, loadModule } from '../util/moduleLoader';\nimport useForceUpdate from './useForceUpdate';\n\nconst useModuleLoader = <B extends Bundles, M extends BundleModules<B>>(\n  bundleName: B, moduleName: M, noLoad = false, autoUpdate = false,\n) => {\n  const module = getModuleFromMemory(bundleName, moduleName);\n  const forceUpdate = useForceUpdate();\n\n  useEffect(() => {\n    if (!autoUpdate) {\n      return undefined;\n    }\n\n    return addLoadListener(forceUpdate);\n  }, [autoUpdate, forceUpdate]);\n\n  useEffect(() => {\n    if (!noLoad && !module) {\n      loadModule(bundleName).then(forceUpdate);\n    }\n  }, [bundleName, forceUpdate, module, moduleName, noLoad]);\n\n  return module;\n};\n\nexport default useModuleLoader;\n","/*\n * Thanks to Ace Monkey for this mind-blowing patch.\n */\n\nexport function patchSafariProgressiveAudio(audioEl: HTMLAudioElement) {\n  if (audioEl.dataset.patchedForSafari) {\n    return;\n  }\n\n  audioEl.addEventListener('play', () => {\n    const t = audioEl.currentTime;\n\n    audioEl.dataset.patchForSafariInProgress = 'true';\n    function onProgress() {\n      if (!audioEl.buffered.length) {\n        return;\n      }\n      audioEl.currentTime = audioEl.duration - 1;\n      audioEl.addEventListener('progress', () => {\n        delete audioEl.dataset.patchForSafariInProgress;\n        audioEl.currentTime = t;\n        if (audioEl.paused && !audioEl.dataset.preventPlayAfterPatch) {\n          audioEl.play();\n        }\n      }, { once: true });\n\n      audioEl.removeEventListener('progress', onProgress);\n    }\n\n    audioEl.addEventListener('progress', onProgress);\n  }, { once: true });\n\n  audioEl.dataset.patchedForSafari = 'true';\n}\n\nexport function isSafariPatchInProgress(audioEl: HTMLAudioElement) {\n  return Boolean(audioEl.dataset.patchForSafariInProgress);\n}\n","/* eslint-disable max-len */\nexport const languagePrompt = `\n    [实时语言雷达]\n        1. 语言指纹扫描：自动检测输入文本的\n            - 主要语种(支持92种语言置信度识别)\n            - 方言特征(如粤语/川普/美式英语)\n            - 混合语言比例(中英混杂度>30%触发混合模式)\n    [语境翻译官]\n        2. 根据语言特征自动匹配：\n            - 正式场合 → 学术英语/商务日语\n            - 社交场景 → 网络韩语/缩略中文\n            - 创意表达 → 方言梗/谐音梗\n            - 情感交流 → 方言安慰语/俚语拥抱\n    [文化调色盘]\n        3. 语言风格增强模块：\n            - 中文：加入\"绝绝子\"/\"破防了\"等年度热词\n            - 日语：自动转换敬体/简体(根据用户资料)\n            - 英语：切换正式/俚语模式(识别slang词汇)\n            - 方言：加载地域特色表达库(如东北话\"忽悠\"→上海话\"捣糨糊\")\n    [混合语处理器]\n        4. 跨语言对话解决方案：\n            - 中英夹杂 → 智能补全(\"这个idea超酷\"→\"这个idea真的超有创意\")\n            - 方言转译 → 标准语+注释(\"侬晓得伐？→ 你知道吗？(上海话)\")\n            - 代码切换 → 无缝过渡(\"今天meeting讨论了KPI→今天开会讨论了KPI\")\n`;\n\nexport const UrgentMessageCheckPrompt = `\n    ## 判断消息是不是紧急消息\n    ## 判断消息是不是重要消息\n    ## 重要消息定义\n        - 明确消息中涉及任务分配、关键决策、风险提示、时间敏感信息或高价值信息的内容   \n    ## 重要消息关键词\n       - 任务分配：任务、负责、分配、完成、执行、提交、整理、分析、制定、确认\n       - 关键决策：决策、需要、决定、评估、选择、优先级\n       - 风险提示：风险、注意、警告、问题、潜在、影响\n       - 时间敏感：截止、时间、日期、尽快、立即、马上、今天、明天、本周、下周\n       - 高价值信息：投资机会、收益、增长、危机、重大、关键\n    ## 紧急消息定义\n       - 明确消息中涉及明确的截止时间、需要立即响应、突发事件或高优先级任务的内容\n    ## 紧急消息关键词\n       - 立即响应：立即、马上、立刻、紧急、紧急任务、紧急处理\n       - 时间要求：截止、时间、日期、尽快、今天、明天、本周、下周\n       - 高优先级：高优先级、优先、务必、必须、务必完成\n    ## 总结重要或紧急消息的内容摘要(可包含发送者名称),非重要或者紧急消息直接过滤掉\n    ## 消息字段解释\n        - chatId: 房间ID\n        - messageId: 消息ID\n        - content: 消息内容\n        - senderName: 发送者名称\n    ## 输出格式规范\n        ## 去除所有空格和换行符,确保 JSON 结构紧凑\n        ## 代码块应使用 Markdown 代码块包裹\n        ## 校验JSON结构,确保所有JSON数据都有 <!-- json-start --> 和 <!-- json-end --> 标记\n        ## 示例格式\n         \\`\\`\\`json\n                <!-- json-start -->\n                    [\n                        {\n                            chatId: \"房间ID\",\n                            messageId: \"消息ID\",\n                            content: 内容摘要\"             \n                        }\n                    ]\n                <!-- json-end -->\n        \\`\\`\\`\n`;\n\nexport const DefaultUrgentTopic = {\n  id: 'default',\n  topicName: '默认紧急主题',\n  topicDescription: `\n    ## 判断消息是不是紧急消息\n    ## 判断消息是不是重要消息\n    ## 重要消息定义\n        - 明确消息中涉及任务分配、关键决策、风险提示、时间敏感信息或高价值信息的内容   \n    ## 重要消息关键词\n       - 任务分配：任务、负责、分配、完成、执行、提交、整理、分析、制定、确认\n       - 关键决策：决策、需要、决定、评估、选择、优先级\n       - 风险提示：风险、注意、警告、问题、潜在、影响\n       - 时间敏感：截止、时间、日期、尽快、立即、马上、今天、明天、本周、下周\n       - 高价值信息：投资机会、收益、增长、危机、重大、关键\n    ## 紧急消息定义\n       - 明确消息中涉及明确的截止时间、需要立即响应、突发事件或高优先级任务的内容\n    ## 紧急消息关键词\n       - 立即响应：立即、马上、立刻、紧急、紧急任务、紧急处理\n       - 时间要求：截止、时间、日期、尽快、今天、明天、本周、下周\n       - 高优先级：高优先级、优先、务必、必须、务必完成\n  `,\n  strongAlert: false,\n};\n\nexport const getIntelligentReplyByKnowledgePrompt = (knowledge:string) => {\n  return `\n    ## 角色设定\n        你是一个专业的智能知识管家，负责基于知识库内容进行检索回答。请严格遵守以下规则：\n    ## 知识库内容\n        ${knowledge}\n    ## 知识检索\n        - 使用精确匹配模式(无模糊扩展)\n        - 当相似度>95%时才返回知识库内容,否则回复的内容为空\n    ## 格式规范\n        ## 去除所有空格和换行符,确保 JSON 结构紧凑\n        ## 代码块应使用 Markdown 代码块包裹\n        ## 校验JSON结构,确保所有JSON数据都有 <!-- json-start --> 和 <!-- json-end --> 标记\n        ## 示例格式:\n            \\`\\`\\`json\n                <!-- json-start -->\n                    [\n                        {\n                            chatId: \"房间ID\",\n                            messageId: \"消息ID\",\n                            replyContent: \"回复的内容\"              \n                        }\n                    ]\n                <!-- json-end -->\n            \\`\\`\\`\n    ## 示例输出\n        \\`\\`\\`json\n            <!-- json-start -->\n                [\n                    {\n                        chatId: \"房间ID\",\n                        messageId: \"消息ID\",\n                        senderId: \"用户ID\",\n                        replyContent: \"Think of SendingNetwork as the swiss-army knife for decentralized and encrypted communications infrastructure. \"              \n                    }\n                ]\n            <!-- json-end -->\n        \\`\\`\\`\n`;\n};\n\nexport const UserPortraitPrompt = `\n    你是一位金融行为分析师，擅长通过对话文本解析用户多维特征。请根据以下框架分析输入数据，输出包含基础信息、关系定位、资产行为及兴趣特征的结构化画像：\n    # 基础信息推断\n        ## 年龄定位\n            - 使用\"学生党/刚毕业\"→18-24岁\n            - 提及\"子女教育/房贷\"→35-50岁\n        ## 性别识别：\n            - 讨论\"母婴产品\"→女性\n            - 引用\"电竞/硬件参数\"→男性\n        ## 地域判断：\n            - 提到\"沪牌政策\"→上海用户\n            - 使用\"支付宝/微信支付\"→中国大陆用户\n    # 关系定位模型\n        ## 合作伙伴：\n            - 包含\"对赌协议/股权分配\"等关键词\n            - 对话中出现\"王总/李董\"等职称\n        ## 投资人：\n            - 讨论\"IRR/ROI\"等财务指标\n            - 提及\"LP/GP\"关系\n        ## 同事：\n            - 使用\"周报/OKR\"等业务术语\n            - 非正式称呼(\"老张/小李\")\n    # 资产行为分析\n        ## 加密货币特征\n            - 持有资产:识别BTC/ETH等代币提及次数\n            - 操作风格:\"短线操作\"→交易型,\"三年以上未动\"→囤积型\n        ## 风险偏好分级\n            - \"愿意承担波动\"→激进型(风险评分7-10)\n            - \"只要保本\"→保守型(风险评分1-3)\n    # 示例输出 \n         \\`\\`\\`json\n            <!-- json-start -->\n                 {\n                    \"basic_info\": {\n                      \"age_group\": \"25-34岁\",\n                      \"gender\": \"男\",\n                      \"region\": \"北美地区\",\n                      \"language\": \"中英双语\"\n                    },\n                    \"relationship\": {\n                      \"type\": \"战略合作伙伴\",\n                      \"engagement_level\": \"高价值(年合作超500万)\"\n                    },\n                    \"financial_behavior\": {\n                      \"assets\": {\n                        \"crypto_holdings\": [\"BTC\", \"LINK\"],\n                        \"investment_style\": \"波段交易(持仓周期7-30天)\",\n                        \"risk_profile\": \"进取型(历史最大回撤承受力25%)\"\n                      },\n                    },\n                  }\n            <!-- json-end -->\n        \\`\\`\\`\n`;\n","import { useEffect, useRef } from '../lib/teact/teact';\n\nconst useEffectWithPrevDeps = <const T extends readonly any[]>(\n  cb: (args: T | readonly []) => void, dependencies: T, debugKey?: string,\n) => {\n  const prevDepsRef = useRef<T>();\n\n  return useEffect(() => {\n    const prevDeps = prevDepsRef.current;\n    prevDepsRef.current = dependencies;\n\n    return cb(prevDeps || []);\n    // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  }, dependencies, debugKey);\n};\n\nexport default useEffectWithPrevDeps;\n","import type { MediaContent } from '../../api/types';\nimport { ApiMessageEntityTypes } from '../../api/types';\n\nimport parseEmojiOnlyString from '../../util/emoji/parseEmojiOnlyString';\n\nexport function getEmojiOnlyCountForMessage(content: MediaContent, groupedId?: string): number | undefined {\n  if (!content.text) return undefined;\n  return (\n    !groupedId\n    && Object.keys(content).length === 1 // Only text is present\n    && !content.text.entities?.some((entity) => entity.type !== ApiMessageEntityTypes.CustomEmoji)\n    && parseEmojiOnlyString(content.text.text)\n  ) || undefined;\n}\n","import type {\n  ApiMessage, ApiPoll, ApiPollResult, ApiQuickReply, ApiSponsoredMessage, ApiThreadInfo,\n} from '../../api/types';\nimport type {\n  FocusDirection,\n  MessageList,\n  MessageListType,\n  ScrollTargetPosition,\n  TabThread,\n  Thread,\n  ThreadId,\n} from '../../types';\nimport type {\n  GlobalState, TabArgs, TabState,\n} from '../types';\nimport { MAIN_THREAD_ID } from '../../api/types';\n\nimport {\n  IS_MOCKED_CLIENT, IS_TEST, MESSAGE_LIST_SLICE, MESSAGE_LIST_VIEWPORT_LIMIT, TMP_CHAT_ID,\n} from '../../config';\nimport { areDeepEqual } from '../../util/areDeepEqual';\nimport { addTimestampEntities } from '../../util/dates/timestamp';\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport {\n  areSortedArraysEqual, excludeSortedArray, omit, omitUndefined, pick, pickTruthy, unique,\n} from '../../util/iteratees';\nimport { isLocalMessageId, type MessageKey } from '../../util/keys/messageKey';\nimport {\n  hasMessageTtl, isMediaLoadableInViewer, mergeIdRanges, orderHistoryIds, orderPinnedIds,\n} from '../helpers';\nimport { getEmojiOnlyCountForMessage } from '../helpers/getEmojiOnlyCountForMessage';\nimport {\n  selectChatMessage,\n  selectChatMessages,\n  selectChatScheduledMessages,\n  selectCurrentMessageIds,\n  selectCurrentMessageList,\n  selectListedIds,\n  selectMessageIdsByGroupId,\n  selectOutlyingLists,\n  selectPinnedIds,\n  selectPoll,\n  selectQuickReplyMessage,\n  selectScheduledIds,\n  selectScheduledMessage,\n  selectTabState,\n  selectThreadIdFromMessage,\n  selectThreadInfo,\n  selectViewportIds,\n} from '../selectors';\nimport { removeIdFromSearchResults } from './middleSearch';\nimport { updateTabState } from './tabs';\nimport { clearMessageTranslation } from './translations';\n\ntype MessageStoreSections = GlobalState['messages']['byChatId'][string];\n\nexport function updateCurrentMessageList<T extends GlobalState>(\n  global: T,\n  chatId: string | undefined,\n  threadId: ThreadId = MAIN_THREAD_ID,\n  type: MessageListType = 'thread',\n  shouldReplaceHistory?: boolean,\n  shouldReplaceLast?: boolean,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const { messageLists } = selectTabState(global, tabId);\n  let newMessageLists: MessageList[] = messageLists;\n  if (shouldReplaceHistory || (IS_TEST && !IS_MOCKED_CLIENT)) {\n    newMessageLists = chatId ? [{ chatId, threadId, type }] : [];\n  } else if (chatId) {\n    const current = messageLists[messageLists.length - 1];\n    if (current?.chatId === chatId && current.threadId === threadId && current.type === type) {\n      return global;\n    }\n\n    if (current && (current.chatId === TMP_CHAT_ID || shouldReplaceLast)) {\n      newMessageLists = [...messageLists.slice(0, -1), { chatId, threadId, type }];\n    } else {\n      const previous = messageLists[messageLists.length - 2];\n\n      if (previous?.chatId === chatId && previous.threadId === threadId && previous.type === type) {\n        newMessageLists = messageLists.slice(0, -1);\n      } else {\n        newMessageLists = [...messageLists, { chatId, threadId, type }];\n      }\n    }\n  } else {\n    newMessageLists = messageLists.slice(0, -1);\n  }\n\n  return updateTabState(global, {\n    messageLists: newMessageLists,\n  }, tabId);\n}\n\nfunction replaceChatMessages<T extends GlobalState>(global: T, chatId: string, newById: Record<number, ApiMessage>): T {\n  return updateMessageStore(global, chatId, {\n    byId: newById,\n  });\n}\n\nexport function updateTabThread<T extends GlobalState>(\n  global: T, chatId: string, threadId: ThreadId, threadUpdate: Partial<TabThread>,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const tabState = selectTabState(global, tabId);\n  const current = tabState.tabThreads[chatId]?.[threadId] || {};\n\n  return updateTabState(global, {\n    tabThreads: {\n      ...tabState.tabThreads,\n      [chatId]: {\n        ...tabState.tabThreads[chatId],\n        [threadId]: {\n          ...current,\n          ...threadUpdate,\n        },\n      },\n    },\n  }, tabId);\n}\n\nexport function updateThread<T extends GlobalState>(\n  global: T, chatId: string, threadId: ThreadId, threadUpdate: Partial<Thread> | undefined,\n): T {\n  if (!threadUpdate) {\n    return updateMessageStore(global, chatId, {\n      threadsById: omit(global.messages.byChatId[chatId]?.threadsById, [threadId]),\n    });\n  }\n\n  const current = global.messages.byChatId[chatId];\n\n  return updateMessageStore(global, chatId, {\n    threadsById: {\n      ...(current?.threadsById),\n      [threadId]: {\n        ...(current?.threadsById[threadId]),\n        ...threadUpdate,\n      },\n    },\n  });\n}\n\nexport function updateMessageStore<T extends GlobalState>(\n  global: T, chatId: string, update: Partial<MessageStoreSections>,\n): T {\n  const current = global.messages.byChatId[chatId] || { byId: {}, threadsById: {} };\n\n  return {\n    ...global,\n    messages: {\n      ...global.messages,\n      byChatId: {\n        ...global.messages.byChatId,\n        [chatId]: {\n          ...current,\n          ...update,\n        },\n      },\n    },\n  };\n}\n\nexport function replaceTabThreadParam<T extends GlobalState, K extends keyof TabThread>(\n  global: T, chatId: string, threadId: ThreadId, paramName: K, newValue: TabThread[K] | undefined,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  if (paramName === 'viewportIds') {\n    global = replaceThreadParam(\n      global, chatId, threadId, 'lastViewportIds', newValue as number[] | undefined,\n    );\n  }\n  return updateTabThread(global, chatId, threadId, { [paramName]: newValue }, tabId);\n}\n\nexport function replaceThreadParam<T extends GlobalState, K extends keyof Thread>(\n  global: T, chatId: string, threadId: ThreadId, paramName: K, newValue: Thread[K] | undefined,\n) {\n  return updateThread(global, chatId, threadId, { [paramName]: newValue });\n}\n\nexport function addMessages<T extends GlobalState>(\n  global: T, messages: ApiMessage[],\n): T {\n  const addedByChatId = messages.reduce((messagesByChatId, message: ApiMessage) => {\n    if (!messagesByChatId[message.chatId]) {\n      messagesByChatId[message.chatId] = {};\n    }\n    messagesByChatId[message.chatId][message.id] = message;\n\n    return messagesByChatId;\n  }, {} as Record<string, Record<number, ApiMessage>>);\n\n  Object.keys(addedByChatId).forEach((chatId) => {\n    global = addChatMessagesById(global, chatId, addedByChatId[chatId]);\n  });\n\n  return global;\n}\n\nexport function replaceMessages<T extends GlobalState>(\n  global: T, messages: ApiMessage[],\n): T {\n  const updatedByChatId = messages.reduce((messagesByChatId, message: ApiMessage) => {\n    if (!messagesByChatId[message.chatId]) {\n      messagesByChatId[message.chatId] = {};\n    }\n    messagesByChatId[message.chatId][message.id] = message;\n\n    return messagesByChatId;\n  }, {} as Record<string, Record<number, ApiMessage>>);\n\n  Object.keys(updatedByChatId).forEach((chatId) => {\n    const currentById = selectChatMessages(global, chatId) || {};\n    const newById = {\n      ...currentById,\n      ...updatedByChatId[chatId],\n    };\n    global = replaceChatMessages(global, chatId, newById);\n  });\n\n  return global;\n}\n\nexport function addChatMessagesById<T extends GlobalState>(\n  global: T, chatId: string, newById: Record<number, ApiMessage>,\n): T {\n  const byId = selectChatMessages(global, chatId);\n\n  if (byId && Object.keys(newById).every((newId) => Boolean(byId[Number(newId)]))) {\n    return global;\n  }\n\n  return replaceChatMessages(global, chatId, {\n    ...newById,\n    ...byId,\n  });\n}\n\nexport function updateChatMessage<T extends GlobalState>(\n  global: T, chatId: string, messageId: number, messageUpdate: Partial<ApiMessage>, withDeepCheck = false,\n): T {\n  const byId = selectChatMessages(global, chatId) || {};\n  const message = byId[messageId];\n\n  if (withDeepCheck && message) {\n    const updateKeys = Object.keys(messageUpdate) as (keyof ApiMessage)[];\n    if (areDeepEqual(pick(message, updateKeys), messageUpdate)) {\n      return global;\n    }\n  }\n\n  if (message && messageUpdate.isMediaUnread === false && hasMessageTtl(message)) {\n    if (message.content.voice) {\n      messageUpdate.content = {\n        action: {\n          mediaType: 'action',\n          type: 'expired',\n          isVoice: true,\n        },\n      };\n    } else if (message.content.video?.isRound) {\n      messageUpdate.content = {\n        action: {\n          mediaType: 'action',\n          type: 'expired',\n          isRoundVideo: true,\n        },\n      };\n    }\n  }\n\n  let emojiOnlyCount = message?.emojiOnlyCount;\n  let text = message?.content?.text;\n  if (messageUpdate.content) {\n    emojiOnlyCount = getEmojiOnlyCountForMessage(\n      messageUpdate.content, message?.groupedId || messageUpdate.groupedId,\n    );\n    text = messageUpdate.content.text ? addTimestampEntities(messageUpdate.content.text) : text;\n  }\n\n  const updatedMessage = omitUndefined({\n    ...message,\n    ...messageUpdate,\n    emojiOnlyCount,\n    text,\n  });\n\n  if (!updatedMessage.id) {\n    return global;\n  }\n\n  return replaceChatMessages(global, chatId, {\n    ...byId,\n    [messageId]: updatedMessage,\n  });\n}\n\nexport function updateScheduledMessage<T extends GlobalState>(\n  global: T, chatId: string, messageId: number, messageUpdate: Partial<ApiMessage>,\n): T {\n  const message = selectScheduledMessage(global, chatId, messageId)!;\n\n  let emojiOnlyCount = message?.emojiOnlyCount;\n  let text = message?.content?.text;\n  if (messageUpdate.content) {\n    emojiOnlyCount = getEmojiOnlyCountForMessage(\n      messageUpdate.content, message?.groupedId || messageUpdate.groupedId,\n    );\n    text = messageUpdate.content.text ? addTimestampEntities(messageUpdate.content.text) : text;\n  }\n\n  const updatedMessage = {\n    ...message,\n    ...messageUpdate,\n    emojiOnlyCount,\n    text,\n  };\n\n  if (!updatedMessage.id) {\n    return global;\n  }\n\n  return updateScheduledMessages(global, chatId, {\n    [messageId]: updatedMessage,\n  });\n}\n\nexport function updateQuickReplyMessage<T extends GlobalState>(\n  global: T, messageId: number, messageUpdate: Partial<ApiMessage>,\n): T {\n  const message = selectQuickReplyMessage(global, messageId);\n  const updatedMessage = {\n    ...message,\n    ...messageUpdate,\n  };\n\n  if (!updatedMessage.id) {\n    return global;\n  }\n\n  return updateQuickReplyMessages(global, {\n    [messageId]: updatedMessage,\n  });\n}\n\nexport function deleteQuickReplyMessages<T extends GlobalState>(\n  global: T, messageIds: number[],\n): T {\n  const byId = global.quickReplies.messagesById;\n  const newById = omit(byId, messageIds);\n  return {\n    ...global,\n    quickReplies: {\n      ...global.quickReplies,\n      messagesById: newById,\n    },\n  };\n}\n\nexport function deleteChatMessages<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  messageIds: number[],\n): T {\n  const byId = selectChatMessages(global, chatId);\n  if (!byId) {\n    return global;\n  }\n\n  orderHistoryIds(messageIds);\n  const updatedThreads = new Map<ThreadId, number[]>();\n  updatedThreads.set(MAIN_THREAD_ID, messageIds);\n\n  const mediaIdsToRemove: number[] = [];\n  messageIds.forEach((messageId) => {\n    const message = byId[messageId];\n    if (!message) return;\n    if (isMediaLoadableInViewer(message)) {\n      mediaIdsToRemove.push(messageId);\n    }\n    const threadId = selectThreadIdFromMessage(global, message);\n    if (!threadId || threadId === MAIN_THREAD_ID) {\n      return;\n    }\n    const threadMessages = updatedThreads.get(threadId) || [];\n    threadMessages.push(messageId);\n    updatedThreads.set(threadId, threadMessages);\n    global = clearMessageTranslation(global, chatId, messageId);\n  });\n\n  const deletedForwardedPosts = Object.values(pickTruthy(byId, messageIds)).filter(\n    ({ forwardInfo }) => forwardInfo?.isLinkedChannelPost,\n  );\n\n  updatedThreads.forEach((threadMessageIds, threadId) => {\n    const threadInfo = selectThreadInfo(global, chatId, threadId);\n\n    let listedIds = selectListedIds(global, chatId, threadId);\n    let pinnedIds = selectPinnedIds(global, chatId, threadId);\n    let outlyingLists = selectOutlyingLists(global, chatId, threadId);\n    let newMessageCount = threadInfo?.messagesCount;\n\n    if (listedIds) {\n      listedIds = excludeSortedArray(listedIds, threadMessageIds);\n    }\n\n    if (outlyingLists) {\n      outlyingLists = outlyingLists.map((list) => excludeSortedArray(list, threadMessageIds));\n    }\n\n    if (pinnedIds) {\n      pinnedIds = excludeSortedArray(pinnedIds, orderPinnedIds(threadMessageIds));\n    }\n\n    const nonLocalMessageCount = threadMessageIds.filter((id) => !isLocalMessageId(id)).length;\n    if (newMessageCount !== undefined) {\n      newMessageCount -= nonLocalMessageCount;\n    }\n\n    Object.values(global.byTabId).forEach(({ id: tabId }) => {\n      const tabState = selectTabState(global, tabId);\n      const activeDownloadsInChat = Object.entries(tabState.activeDownloads).filter(\n        ([, { originChatId, originMessageId }]) => originChatId === chatId && originMessageId,\n      );\n\n      activeDownloadsInChat.forEach(([mediaHash, context]) => {\n        if (messageIds.includes(context.originMessageId!)) {\n          global = cancelMessageMediaDownload(global, [mediaHash], tabId);\n        }\n      });\n\n      mediaIdsToRemove.forEach((mediaId) => {\n        global = removeIdFromSearchResults(global, chatId, threadId, mediaId, tabId);\n      });\n\n      const viewportIds = selectViewportIds(global, chatId, threadId, tabId);\n      if (!viewportIds) return;\n\n      const newViewportIds = excludeSortedArray(viewportIds, messageIds);\n      global = replaceTabThreadParam(\n        global,\n        chatId,\n        threadId,\n        'viewportIds',\n        newViewportIds.length === 0 ? undefined : newViewportIds,\n        tabId,\n      );\n    });\n\n    global = replaceThreadParam(global, chatId, threadId, 'listedIds', listedIds);\n    global = replaceThreadParam(global, chatId, threadId, 'outlyingLists', outlyingLists);\n    global = replaceThreadParam(global, chatId, threadId, 'pinnedIds', pinnedIds);\n\n    if (threadInfo && newMessageCount !== undefined) {\n      global = updateThreadInfo(global, chatId, threadId, {\n        messagesCount: newMessageCount,\n      });\n    }\n  });\n\n  if (deletedForwardedPosts.length) {\n    Object.values(global.byTabId).forEach(({ id: tabId }) => {\n      const currentMessageList = selectCurrentMessageList(global, tabId);\n      const canDeleteCurrentThread = currentMessageList && currentMessageList.chatId === chatId\n        && currentMessageList.type === 'thread';\n      const currentThreadId = currentMessageList?.threadId;\n\n      deletedForwardedPosts.forEach((message) => {\n        const { fromChatId, fromMessageId } = message.forwardInfo!;\n        const originalPost = selectChatMessage(global, fromChatId!, fromMessageId!);\n\n        if (canDeleteCurrentThread && currentThreadId === message.id) {\n          global = updateCurrentMessageList(global, chatId, undefined, undefined, undefined, undefined, tabId);\n        }\n        if (originalPost) {\n          global = updateThread(global, fromChatId!, fromMessageId!, undefined);\n        }\n      });\n    });\n  }\n\n  const newById = omit(byId, messageIds);\n  global = replaceChatMessages(global, chatId, newById);\n\n  return global;\n}\n\nexport function deleteChatScheduledMessages<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  messageIds: number[],\n): T {\n  const byId = selectChatScheduledMessages(global, chatId);\n  if (!byId) {\n    return global;\n  }\n  const newById = omit(byId, messageIds);\n\n  let scheduledIds = selectScheduledIds(global, chatId, MAIN_THREAD_ID);\n  if (scheduledIds) {\n    messageIds.forEach((messageId) => {\n      if (scheduledIds!.includes(messageId)) {\n        scheduledIds = scheduledIds!.filter((id) => id !== messageId);\n      }\n    });\n    global = replaceThreadParam(global, chatId, MAIN_THREAD_ID, 'scheduledIds', scheduledIds);\n\n    Object.entries(global.messages.byChatId[chatId].threadsById).forEach(([threadId, thread]) => {\n      if (thread.scheduledIds) {\n        const newScheduledIds = thread.scheduledIds.filter((id) => !messageIds.includes(id));\n        global = replaceThreadParam(global, chatId, Number(threadId), 'scheduledIds', newScheduledIds);\n      }\n    });\n  }\n\n  global = {\n    ...global,\n    scheduledMessages: {\n      byChatId: {\n        ...global.scheduledMessages.byChatId,\n        [chatId]: {\n          byId: newById,\n        },\n      },\n    },\n  };\n\n  return global;\n}\n\nexport function updateListedIds<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  idsUpdate: number[],\n): T {\n  const listedIds = selectListedIds(global, chatId, threadId);\n  const newIds = listedIds?.length\n    ? idsUpdate.filter((id) => !listedIds.includes(id))\n    : idsUpdate;\n\n  if (listedIds && !newIds.length) {\n    return global;\n  }\n\n  return replaceThreadParam(global, chatId, threadId, 'listedIds', orderHistoryIds([\n    ...(listedIds || []),\n    ...newIds,\n  ]));\n}\n\nexport function removeOutlyingList<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  list: number[],\n): T {\n  const outlyingLists = selectOutlyingLists(global, chatId, threadId);\n  if (!outlyingLists) {\n    return global;\n  }\n\n  const newOutlyingLists = outlyingLists.filter((l) => l !== list);\n\n  return replaceThreadParam(global, chatId, threadId, 'outlyingLists', newOutlyingLists);\n}\n\nexport function updateOutlyingLists<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  idsUpdate: number[],\n): T {\n  if (!idsUpdate.length) return global;\n\n  const outlyingLists = selectOutlyingLists(global, chatId, threadId);\n\n  const newOutlyingLists = mergeIdRanges(outlyingLists || [], idsUpdate);\n\n  return replaceThreadParam(global, chatId, threadId, 'outlyingLists', newOutlyingLists);\n}\n\nexport function addViewportId<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  newId: number,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const viewportIds = selectViewportIds(global, chatId, threadId, tabId) || [];\n  if (viewportIds.includes(newId)) {\n    return global;\n  }\n\n  const newIds = orderHistoryIds([\n    ...(\n      viewportIds.length < MESSAGE_LIST_VIEWPORT_LIMIT\n        ? viewportIds\n        : viewportIds.slice(-(MESSAGE_LIST_SLICE / 2))\n    ),\n    newId,\n  ]);\n\n  return replaceTabThreadParam(global, chatId, threadId, 'viewportIds', newIds, tabId);\n}\n\nexport function safeReplaceViewportIds<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  newViewportIds: number[],\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const currentIds = selectViewportIds(global, chatId, threadId, tabId) || [];\n  const newIds = orderHistoryIds(newViewportIds);\n\n  return replaceTabThreadParam(\n    global,\n    chatId,\n    threadId,\n    'viewportIds',\n    areSortedArraysEqual(currentIds, newIds) ? currentIds : newIds,\n    tabId,\n  );\n}\n\nexport function safeReplacePinnedIds<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  newPinnedIds: number[],\n): T {\n  const currentIds = selectPinnedIds(global, chatId, threadId) || [];\n  const newIds = orderPinnedIds(newPinnedIds);\n\n  return replaceThreadParam(\n    global,\n    chatId,\n    threadId,\n    'pinnedIds',\n    areSortedArraysEqual(currentIds, newIds) ? currentIds : newIds,\n  );\n}\n\nexport function updateThreadInfo<T extends GlobalState>(\n  global: T, chatId: string, threadId: ThreadId, update: Partial<ApiThreadInfo> | undefined,\n  doNotUpdateLinked?: boolean,\n): T {\n  const newThreadInfo = {\n    ...(selectThreadInfo(global, chatId, threadId) as ApiThreadInfo),\n    ...update,\n  } as ApiThreadInfo;\n\n  if (!doNotUpdateLinked && !newThreadInfo.isCommentsInfo) {\n    const linkedUpdate = pick(newThreadInfo, ['messagesCount', 'lastMessageId', 'lastReadInboxMessageId']);\n    if (newThreadInfo.fromChannelId && newThreadInfo.fromMessageId) {\n      global = updateThreadInfo(\n        global, newThreadInfo.fromChannelId, newThreadInfo.fromMessageId, linkedUpdate, true,\n      );\n    }\n  }\n\n  return replaceThreadParam(global, chatId, threadId, 'threadInfo', newThreadInfo);\n}\n\nexport function updateThreadInfos<T extends GlobalState>(\n  global: T, updates: Partial<ApiThreadInfo>[],\n): T {\n  updates.forEach((update) => {\n    global = updateThreadInfo(\n      global,\n      update.isCommentsInfo ? update.originChannelId! : update.chatId!,\n      update.isCommentsInfo ? update.originMessageId! : update.threadId!,\n      update,\n    );\n  });\n\n  return global;\n}\n\nexport function updateScheduledMessages<T extends GlobalState>(\n  global: T, chatId: string, newById: Record<number, ApiMessage>,\n): T {\n  const current = global.scheduledMessages.byChatId[chatId] || { byId: {}, hash: 0 };\n\n  return {\n    ...global,\n    scheduledMessages: {\n      byChatId: {\n        ...global.scheduledMessages.byChatId,\n        [chatId]: {\n          ...current,\n          byId: {\n            ...current.byId,\n            ...newById,\n          },\n        },\n      },\n    },\n  };\n}\n\nexport function updateQuickReplyMessages<T extends GlobalState>(\n  global: T, update: Record<number, ApiMessage>,\n): T {\n  return {\n    ...global,\n    quickReplies: {\n      ...global.quickReplies,\n      messagesById: {\n        ...global.quickReplies.messagesById,\n        ...update,\n      },\n    },\n  };\n}\n\nexport function updateFocusedMessage<T extends GlobalState>(\n  {\n    global,\n    chatId,\n    messageId,\n    threadId = MAIN_THREAD_ID,\n    noHighlight = false,\n    isResizingContainer = false,\n    quote,\n    quoteOffset,\n    scrollTargetPosition,\n  }: {\n    global: T;\n    chatId?: string;\n    messageId?: number;\n    threadId?: ThreadId;\n    noHighlight?: boolean;\n    isResizingContainer?: boolean;\n    quote?: string;\n    quoteOffset?: number;\n    scrollTargetPosition?: ScrollTargetPosition;\n  },\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateTabState(global, {\n    focusedMessage: {\n      ...selectTabState(global, tabId).focusedMessage,\n      chatId,\n      threadId,\n      messageId,\n      noHighlight,\n      isResizingContainer,\n      quote,\n      quoteOffset,\n      scrollTargetPosition,\n    },\n  }, tabId);\n}\n\nexport function updateSponsoredMessage<T extends GlobalState>(\n  global: T, chatId: string, message: ApiSponsoredMessage,\n): T {\n  return {\n    ...global,\n    messages: {\n      ...global.messages,\n      sponsoredByChatId: {\n        ...global.messages.sponsoredByChatId,\n        [chatId]: message,\n      },\n    },\n  };\n}\n\nexport function deleteSponsoredMessage<T extends GlobalState>(\n  global: T, chatId: string,\n): T {\n  const byChatId = global.messages.sponsoredByChatId;\n  if (!byChatId[chatId]) {\n    return global;\n  }\n\n  return {\n    ...global,\n    messages: {\n      ...global.messages,\n      sponsoredByChatId: omit(byChatId, [chatId]),\n    },\n  };\n}\n\nexport function updateFocusDirection<T extends GlobalState>(\n  global: T, direction?: FocusDirection,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateTabState(global, {\n    focusedMessage: {\n      ...selectTabState(global, tabId).focusedMessage,\n      direction,\n    },\n  }, tabId);\n}\n\nexport function enterMessageSelectMode<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  messageId?: number | number[],\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const messageIds = messageId ? Array.prototype.concat([], messageId) : [];\n\n  return updateTabState(global, {\n    selectedMessages: {\n      chatId,\n      messageIds,\n    },\n  }, tabId);\n}\n\nexport function toggleMessageSelection<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  messageListType: MessageListType,\n  messageId: number,\n  groupedId?: string,\n  childMessageIds?: number[],\n  withShift = false,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const { selectedMessages: oldSelectedMessages } = selectTabState(global, tabId);\n  if (groupedId) {\n    childMessageIds = selectMessageIdsByGroupId(global, chatId, groupedId);\n  }\n  const selectedMessageIds = childMessageIds || [messageId];\n  if (!oldSelectedMessages) {\n    return enterMessageSelectMode(global, chatId, selectedMessageIds, tabId);\n  }\n\n  const { messageIds } = oldSelectedMessages;\n\n  let newMessageIds;\n  const newSelectedMessageIds = selectedMessageIds.filter((id) => !messageIds.includes(id));\n  if (newSelectedMessageIds && !newSelectedMessageIds.length) {\n    newMessageIds = messageIds.filter((id) => !selectedMessageIds.includes(id));\n  } else if (withShift && messageIds.length) {\n    const viewportIds = selectCurrentMessageIds(global, chatId, threadId, messageListType, tabId)!;\n    const prevIndex = viewportIds.indexOf(messageIds[messageIds.length - 1]);\n    const currentIndex = viewportIds.indexOf(messageId);\n    const from = Math.min(prevIndex, currentIndex);\n    const to = Math.max(prevIndex, currentIndex);\n    const slice = viewportIds.slice(from, to + 1);\n    newMessageIds = unique([...messageIds, ...slice]);\n  } else {\n    newMessageIds = [...messageIds, ...newSelectedMessageIds];\n  }\n\n  if (!newMessageIds.length) {\n    return exitMessageSelectMode(global, tabId);\n  }\n\n  return updateTabState(global, {\n    selectedMessages: {\n      ...oldSelectedMessages,\n      messageIds: newMessageIds,\n    },\n  }, tabId);\n}\n\nexport function exitMessageSelectMode<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateTabState(global, {\n    selectedMessages: undefined,\n  }, tabId);\n}\n\nexport function updateThreadUnreadFromForwardedMessage<T extends GlobalState>(\n  global: T,\n  originMessage: ApiMessage,\n  chatId: string,\n  lastMessageId: number,\n  isDeleting?: boolean,\n): T {\n  const { channelPostId, fromChatId } = originMessage.forwardInfo || {};\n  if (channelPostId && fromChatId) {\n    const threadInfoOld = selectThreadInfo(global, chatId, channelPostId);\n    if (threadInfoOld) {\n      global = replaceThreadParam(global, chatId, channelPostId, 'threadInfo', {\n        ...threadInfoOld,\n        lastMessageId,\n        messagesCount: (threadInfoOld.messagesCount || 0) + (isDeleting ? -1 : 1),\n      });\n    }\n  }\n  return global;\n}\n\nexport function addActiveMediaDownload<T extends GlobalState>(\n  global: T,\n  mediaHash: string,\n  metadata: TabState['activeDownloads'][string],\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const tabState = selectTabState(global, tabId);\n\n  global = updateTabState(global, {\n    activeDownloads: {\n      ...tabState.activeDownloads,\n      [mediaHash]: metadata,\n    },\n  }, tabId);\n\n  return global;\n}\n\nexport function cancelMessageMediaDownload<T extends GlobalState>(\n  global: T,\n  mediaHashes: string[],\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const tabState = selectTabState(global, tabId);\n\n  const newActiveDownloads = omit(tabState.activeDownloads, mediaHashes);\n\n  global = updateTabState(global, {\n    activeDownloads: newActiveDownloads,\n  }, tabId);\n\n  return global;\n}\n\nexport function updateUploadByMessageKey<T extends GlobalState>(\n  global: T,\n  messageKey: MessageKey,\n  progress: number | undefined,\n) {\n  return {\n    ...global,\n    fileUploads: {\n      byMessageKey: progress !== undefined\n        ? {\n          ...global.fileUploads.byMessageKey,\n          [messageKey]: { progress },\n        }\n        : omit(global.fileUploads.byMessageKey, [messageKey]),\n    },\n  };\n}\n\nexport function updateQuickReplies<T extends GlobalState>(\n  global: T,\n  quickRepliesUpdate: Record<number, ApiQuickReply>,\n) {\n  return {\n    ...global,\n    quickReplies: {\n      ...global.quickReplies,\n      byId: {\n        ...global.quickReplies.byId,\n        ...quickRepliesUpdate,\n      },\n    },\n  };\n}\n\nexport function deleteQuickReply<T extends GlobalState>(\n  global: T,\n  quickReplyId: number,\n) {\n  return {\n    ...global,\n    quickReplies: {\n      ...global.quickReplies,\n      byId: omit(global.quickReplies.byId, [quickReplyId]),\n    },\n  };\n}\n\nexport function updatePoll<T extends GlobalState>(\n  global: T,\n  pollId: string,\n  pollUpdate: Partial<ApiPoll>,\n) {\n  const poll = selectPoll(global, pollId);\n\n  const oldResults = poll?.results;\n  let newResults = oldResults || pollUpdate.results;\n  if (poll && pollUpdate.results?.results) {\n    if (!poll.results || !pollUpdate.results.isMin) {\n      newResults = pollUpdate.results;\n    } else if (oldResults.results) {\n      // Update voters counts, but keep local `isChosen` values\n      newResults = {\n        ...pollUpdate.results,\n        results: pollUpdate.results.results.map((result) => ({\n          ...result,\n          isChosen: oldResults.results!.find((r) => r.option === result.option)?.isChosen,\n        })),\n        isMin: undefined,\n      };\n    }\n  }\n\n  const updatedPoll = {\n    ...poll,\n    ...pollUpdate,\n    results: newResults,\n  } satisfies ApiPoll;\n  if (!updatedPoll.id) {\n    return global;\n  }\n\n  return {\n    ...global,\n    messages: {\n      ...global.messages,\n      pollById: {\n        ...global.messages.pollById,\n        [pollId]: updatedPoll,\n      },\n    },\n  };\n}\n\nexport function updatePollVote<T extends GlobalState>(\n  global: T,\n  pollId: string,\n  peerId: string,\n  options: string[],\n) {\n  const poll = selectPoll(global, pollId);\n  if (!poll) {\n    return global;\n  }\n\n  const { recentVoterIds, totalVoters, results } = poll.results;\n  const newRecentVoterIds = recentVoterIds ? [...recentVoterIds] : [];\n  const newTotalVoters = totalVoters ? totalVoters + 1 : 1;\n  const newResults = results ? [...results] : [];\n\n  newRecentVoterIds.push(peerId);\n\n  options.forEach((option) => {\n    const targetOptionIndex = newResults.findIndex((result) => result.option === option);\n    const targetOption = newResults[targetOptionIndex];\n    const updatedOption: ApiPollResult = targetOption ? { ...targetOption } : { option, votersCount: 0 };\n\n    updatedOption.votersCount += 1;\n    if (peerId === global.currentUserId) {\n      updatedOption.isChosen = true;\n    }\n\n    if (targetOptionIndex) {\n      newResults[targetOptionIndex] = updatedOption;\n    } else {\n      newResults.push(updatedOption);\n    }\n  });\n\n  return updatePoll(global, pollId, {\n    results: {\n      ...poll.results,\n      recentVoterIds: newRecentVoterIds,\n      totalVoters: newTotalVoters,\n      results: newResults,\n    },\n  });\n}","// extracted by mini-css-extract-plugin\nexport default {\"thumb\":\"gYSfUe37\",\"thumb-opaque\":\"vbcXDDxa\",\"thumbOpaque\":\"vbcXDDxa\",\"no-transition\":\"AvU_FtMd\",\"noTransition\":\"AvU_FtMd\",\"media\":\"RrEzFxte\"};","import type { FC } from '../../lib/teact/teact';\nimport React, { memo, useMemo, useRef } from '../../lib/teact/teact';\nimport { getGlobal } from '../../global';\n\nimport type { ApiSticker } from '../../api/types';\nimport type { ObserveFn } from '../../hooks/useIntersectionObserver';\n\nimport { getStickerMediaHash } from '../../global/helpers';\nimport { selectIsAlwaysHighPriorityEmoji } from '../../global/selectors';\nimport { IS_ANDROID, IS_IOS, IS_WEBM_SUPPORTED } from '../../util/browser/windowEnvironment';\nimport buildClassName from '../../util/buildClassName';\nimport * as mediaLoader from '../../util/mediaLoader';\n\nimport useColorFilter from '../../hooks/stickers/useColorFilter';\nimport useCoordsInSharedCanvas from '../../hooks/useCoordsInSharedCanvas';\nimport useFlag from '../../hooks/useFlag';\nimport { useIsIntersecting } from '../../hooks/useIntersectionObserver';\nimport useMedia from '../../hooks/useMedia';\nimport useMediaTransition from '../../hooks/useMediaTransition';\nimport useMountAfterHeavyAnimation from '../../hooks/useMountAfterHeavyAnimation';\nimport useThumbnail from '../../hooks/useThumbnail';\nimport useUniqueId from '../../hooks/useUniqueId';\nimport useDevicePixelRatio from '../../hooks/window/useDevicePixelRatio';\n\nimport OptimizedVideo from '../ui/OptimizedVideo';\nimport AnimatedSticker from './AnimatedSticker';\n\nimport styles from './StickerView.module.scss';\n\ntype OwnProps = {\n  containerRef: React.RefObject<HTMLDivElement>;\n  sticker: ApiSticker;\n  thumbClassName?: string;\n  fullMediaHash?: string;\n  fullMediaClassName?: string;\n  isSmall?: boolean;\n  size?: number;\n  customColor?: string;\n  loopLimit?: number;\n  shouldLoop?: boolean;\n  shouldPreloadPreview?: boolean;\n  forceAlways?: boolean;\n  forceOnHeavyAnimation?: boolean;\n  observeIntersectionForLoading?: ObserveFn;\n  observeIntersectionForPlaying?: ObserveFn;\n  noLoad?: boolean;\n  noPlay?: boolean;\n  noVideoOnMobile?: boolean;\n  withSharedAnimation?: boolean;\n  sharedCanvasRef?: React.RefObject<HTMLCanvasElement>;\n  withTranslucentThumb?: boolean; // With shared canvas thumbs are opaque by default to provide better transition effect\n  onVideoEnded?: AnyToVoidFunction;\n  onAnimatedStickerLoop?: AnyToVoidFunction;\n};\n\nconst SHARED_PREFIX = 'shared';\nconst STICKER_SIZE = 24;\n\nconst StickerView: FC<OwnProps> = ({\n  containerRef,\n  sticker,\n  thumbClassName,\n  fullMediaHash,\n  fullMediaClassName,\n  isSmall,\n  size = STICKER_SIZE,\n  customColor,\n  loopLimit,\n  shouldLoop = false,\n  shouldPreloadPreview,\n  forceAlways,\n  forceOnHeavyAnimation,\n  observeIntersectionForLoading,\n  observeIntersectionForPlaying,\n  noLoad,\n  noPlay,\n  noVideoOnMobile,\n  withSharedAnimation,\n  withTranslucentThumb,\n  sharedCanvasRef,\n  onVideoEnded,\n  onAnimatedStickerLoop,\n}) => {\n  const {\n    id, isLottie, stickerSetInfo, emoji,\n  } = sticker;\n  const [isVideoBroken, markVideoBroken] = useFlag();\n  const isUnsupportedVideo = sticker.isVideo && (\n    !IS_WEBM_SUPPORTED\n    || (noVideoOnMobile && (IS_IOS || IS_ANDROID))\n  );\n  const isVideo = sticker.isVideo;\n  const isStatic = !isLottie && !isVideo;\n  const previewMediaHash = getStickerMediaHash(sticker, 'preview');\n\n  const dpr = useDevicePixelRatio();\n\n  const filterStyle = useColorFilter(customColor);\n\n  const isIntersectingForLoading = useIsIntersecting(containerRef, observeIntersectionForLoading);\n  const shouldLoad = isIntersectingForLoading && !noLoad;\n  const isIntersectingForPlaying = (\n    useIsIntersecting(containerRef, observeIntersectionForPlaying)\n    && isIntersectingForLoading\n  );\n  const shouldPlay = isIntersectingForPlaying && !noPlay;\n  const hasIntersectedForPlayingRef = useRef(isIntersectingForPlaying);\n  if (!hasIntersectedForPlayingRef.current && isIntersectingForPlaying) {\n    hasIntersectedForPlayingRef.current = true;\n  }\n\n  const cachedPreview = mediaLoader.getFromMemory(previewMediaHash);\n  const isReadyToMountFullMedia = useMountAfterHeavyAnimation(hasIntersectedForPlayingRef.current);\n  const shouldForcePreview = isUnsupportedVideo || (isStatic ? isSmall : noPlay);\n  const shouldLoadPreview = !customColor && !cachedPreview && (!isReadyToMountFullMedia || shouldForcePreview);\n  const previewMediaData = useMedia(previewMediaHash, !shouldLoadPreview);\n  const withPreview = shouldLoadPreview || cachedPreview;\n\n  const shouldSkipLoadingFullMedia = Boolean(shouldForcePreview || (\n    fullMediaHash === previewMediaHash && (cachedPreview || previewMediaData)\n  ));\n  const fullMediaData = useMedia(fullMediaHash || `sticker${id}`, !shouldLoad || shouldSkipLoadingFullMedia);\n  const shouldRenderFullMedia = isReadyToMountFullMedia && fullMediaData && !isVideoBroken;\n  const [isPlayerReady, markPlayerReady] = useFlag();\n  const isFullMediaReady = shouldRenderFullMedia && (isStatic || isPlayerReady);\n\n  const thumbDataUri = useThumbnail(sticker.thumbnail);\n  const thumbData = cachedPreview || previewMediaData || thumbDataUri;\n  const isThumbOpaque = sharedCanvasRef && !withTranslucentThumb;\n\n  const noCrossTransition = Boolean(isLottie && withPreview);\n  const thumbRef = useMediaTransition<HTMLImageElement>(thumbData && !isFullMediaReady, {\n    noCloseTransition: noCrossTransition,\n  });\n  const fullMediaRef = useMediaTransition<HTMLElement>(isFullMediaReady, {\n    noOpenTransition: noCrossTransition,\n  });\n\n  const coords = useCoordsInSharedCanvas(containerRef, sharedCanvasRef);\n\n  // Preload preview for Message Input and local message\n  useMedia(previewMediaHash, !shouldLoad || !shouldPreloadPreview);\n\n  const randomIdPrefix = useUniqueId();\n  const renderId = useMemo(() => ([\n    (withSharedAnimation ? SHARED_PREFIX : randomIdPrefix),\n    id,\n    size,\n    (withSharedAnimation ? customColor : undefined),\n    dpr,\n  ].filter(Boolean).join('_')\n  ), [id, size, customColor, dpr, withSharedAnimation, randomIdPrefix]);\n\n  return (\n    <>\n      <img\n        ref={thumbRef}\n        src={thumbData}\n        className={buildClassName(\n          styles.thumb,\n          noCrossTransition && styles.noTransition,\n          isThumbOpaque && styles.thumbOpaque,\n          thumbClassName,\n          'sticker-media',\n        )}\n        style={filterStyle}\n        alt=\"\"\n        draggable={false}\n      />\n      {shouldRenderFullMedia && (isLottie ? (\n        <AnimatedSticker\n          ref={fullMediaRef as React.RefObject<HTMLDivElement>}\n          key={renderId}\n          renderId={renderId}\n          size={size}\n          className={buildClassName(\n            styles.media,\n            (noCrossTransition || isThumbOpaque) && styles.noTransition,\n            fullMediaClassName,\n          )}\n          tgsUrl={fullMediaData}\n          play={shouldPlay}\n          noLoop={!shouldLoop}\n          forceOnHeavyAnimation={forceAlways || forceOnHeavyAnimation}\n          forceAlways={forceAlways}\n          isLowPriority={isSmall && !selectIsAlwaysHighPriorityEmoji(getGlobal(), stickerSetInfo)}\n          sharedCanvas={sharedCanvasRef?.current || undefined}\n          sharedCanvasCoords={coords}\n          onLoad={markPlayerReady}\n          onLoop={onAnimatedStickerLoop}\n          onEnded={onAnimatedStickerLoop}\n          color={customColor}\n        />\n      ) : isVideo ? (\n        <OptimizedVideo\n          ref={fullMediaRef as React.RefObject<HTMLVideoElement>}\n          canPlay={shouldPlay}\n          className={buildClassName(styles.media, fullMediaClassName, 'sticker-media')}\n          src={fullMediaData}\n          playsInline\n          muted\n          loop={shouldLoop && !loopLimit}\n          isPriority={forceAlways}\n          disablePictureInPicture\n          onReady={markPlayerReady}\n          onBroken={markVideoBroken}\n          onEnded={onVideoEnded}\n          style={filterStyle}\n        />\n      ) : (\n        <img\n          ref={fullMediaRef as React.RefObject<HTMLImageElement>}\n          className={buildClassName(styles.media, fullMediaClassName, 'sticker-media')}\n          src={fullMediaData}\n          alt={emoji}\n          style={filterStyle}\n          draggable={false}\n        />\n      ))}\n    </>\n  );\n};\n\nexport default memo(StickerView);\n","import { getIsHeavyAnimating, useEffect, useSignal } from '../lib/teact/teact';\n\nimport useDerivedState from './useDerivedState';\n\nexport default function useMountAfterHeavyAnimation(hasIntersected: boolean) {\n  const [getNoHeavyAnimation, setNoHeavyAnimation] = useSignal(false);\n\n  const $getIsHeavyAnimating = getIsHeavyAnimating;\n\n  // Animation is usually started right after the mount, so we use effect to check for it on the next frame\n  useEffect(() => {\n    if (!$getIsHeavyAnimating()) {\n      setNoHeavyAnimation(true);\n    }\n  }, [$getIsHeavyAnimating, setNoHeavyAnimation]);\n\n  return useDerivedState(() => (getNoHeavyAnimation() && hasIntersected), [getNoHeavyAnimation, hasIntersected]);\n}\n","import useShowTransitionDeprecated from './useShowTransitionDeprecated';\n\nexport default function useMediaTransitionDeprecated(mediaData?: unknown) {\n  const isMediaReady = Boolean(mediaData);\n  const { transitionClassNames } = useShowTransitionDeprecated(isMediaReady, undefined, isMediaReady, 'slow');\n\n  return transitionClassNames;\n}\n","import { useSignal } from '../lib/teact/teact';\n\nimport type { Signal } from '../util/signals';\n\nimport { useSignalEffect } from './useSignalEffect';\nimport { useStateRef } from './useStateRef';\nimport useSyncEffect from './useSyncEffect';\n\ntype SyncResolver<T> = () => T;\ntype AsyncResolver<T> = (setter: (newValue: T) => void) => void;\ntype Resolver<T> =\n  SyncResolver<T>\n  | AsyncResolver<T>;\n\nfunction useDerivedSignal<T>(resolver: SyncResolver<T>, dependencies: readonly any[]): Signal<T>;\nfunction useDerivedSignal<T>(resolver: AsyncResolver<T>, dependencies: readonly any[], isAsync: true): Signal<T>;\nfunction useDerivedSignal<T>(dependency: T): Signal<T>;\n\nfunction useDerivedSignal<T>(resolverOrDependency: Resolver<T> | T, dependencies?: readonly any[], isAsync = false) {\n  const resolver = dependencies ? resolverOrDependency as Resolver<T> : () => (resolverOrDependency as T);\n  dependencies ??= [resolverOrDependency];\n\n  const [getValue, setValue] = useSignal<T>();\n  const resolverRef = useStateRef(resolver);\n\n  function runCurrentResolver() {\n    const currentResolver = resolverRef.current;\n    if (isAsync) {\n      (currentResolver as AsyncResolver<T>)(setValue);\n    } else {\n      setValue((currentResolver as SyncResolver<T>)());\n    }\n  }\n\n  // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  useSyncEffect(runCurrentResolver, dependencies);\n\n  // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  useSignalEffect(runCurrentResolver, dependencies);\n\n  return getValue as Signal<T>;\n}\n\nexport default useDerivedSignal;\n","import type { TeactNode } from '../../lib/teact/teact';\n\nimport type {\n  ApiLanguage,\n  LangPackStringValue,\n  LangPackStringValueDeleted,\n  LangPackStringValuePlural,\n  LangPackStringValueRegular,\n} from '../../api/types';\nimport type { TextFilter } from '../../components/common/helpers/renderText';\nimport type {\n  LangPairPluralWithVariables,\n  LangPairWithVariables,\n  LangVariable,\n  PluralLangKey,\n  PluralLangKeyWithVariables,\n  RegularLangKey,\n  RegularLangKeyWithVariables,\n} from '../../types/language';\n\nexport interface LangFnOptionsRegular {\n  withNodes?: never;\n  withMarkdown?: never;\n  pluralValue?: never;\n}\n\nexport type LangFnOptionsWithPlural = Omit<LangFnOptionsRegular, 'pluralValue'> & {\n  pluralValue: number;\n};\n\nexport type LangFnOptions = LangFnOptionsRegular | LangFnOptionsWithPlural;\n\nexport interface AdvancedLangFnOptionsRegular {\n  withNodes: true;\n  withMarkdown?: boolean;\n  pluralValue?: never;\n  renderTextFilters?: TextFilter[];\n  specialReplacement?: Record<string, TeactNode>;\n}\n\nexport type AdvancedLangFnOptionsWithPlural = Omit<AdvancedLangFnOptionsRegular, 'pluralValue'> & {\n  pluralValue: number;\n};\n\nexport type AdvancedLangFnOptions = AdvancedLangFnOptionsRegular | AdvancedLangFnOptionsWithPlural;\n\ntype LangPairWithNodes = LangPairWithVariables<TeactNode | undefined>;\ntype LangPairPluralWithNodes = LangPairPluralWithVariables<TeactNode | undefined>;\n\ntype RegularLangFnParametersWithoutVariables = {\n  key: RegularLangKey;\n  variables?: undefined;\n  options?: LangFnOptions;\n};\n\ntype RegularLangFnParametersWithVariables<T = LangPairWithVariables> = {\n  [K in keyof T]: {\n    key: K;\n    variables: {\n      [key in keyof T[K]]: LangVariable | RegularLangFnParameters;\n    };\n    options?: LangFnOptions;\n  }\n}[keyof T];\n\ntype RegularLangFnPluralParameters = {\n  key: PluralLangKey;\n  variables?: undefined;\n  options: LangFnOptionsWithPlural;\n};\n\ntype RegularLangFnPluralParametersWithVariables<T = LangPairPluralWithVariables> = {\n  [K in keyof T]: {\n    key: K;\n    variables: {\n      [key in keyof T[K]]: LangVariable | RegularLangFnParameters;\n    };\n    options: LangFnOptionsWithPlural;\n  }\n}[keyof T];\n\nexport type RegularLangFnParameters =\n| RegularLangFnParametersWithoutVariables\n| RegularLangFnParametersWithVariables\n| RegularLangFnPluralParameters\n| RegularLangFnPluralParametersWithVariables;\n\ntype AdvancedLangFnParametersWithoutVariables = {\n  key: RegularLangKey;\n  variables?: undefined;\n  options: AdvancedLangFnOptions;\n};\n\ntype AdvancedLangFnParametersWithVariables<T = LangPairWithNodes> = {\n  [K in keyof T]: {\n    key: K;\n    variables: T[K];\n    options: AdvancedLangFnOptions;\n  }\n}[keyof T];\n\ntype AdvancedLangFnPluralParameters = {\n  key: PluralLangKey;\n  variables?: undefined;\n  options: AdvancedLangFnOptionsWithPlural;\n};\n\ntype AdvancedLangFnPluralParametersWithVariables<T = LangPairPluralWithNodes> = {\n  [K in keyof T]: {\n    key: K;\n    variables: T[K];\n    options: AdvancedLangFnOptionsWithPlural;\n  }\n}[keyof T];\n\nexport type AdvancedLangFnParameters =\n| AdvancedLangFnParametersWithoutVariables\n| AdvancedLangFnParametersWithVariables\n| AdvancedLangFnPluralParameters\n| AdvancedLangFnPluralParametersWithVariables;\n\nexport type LangFnParameters = RegularLangFnParameters | AdvancedLangFnParameters;\n\nexport type LangFn = {\n  <K extends RegularLangKey = RegularLangKey>(\n    key: K, variables?: undefined, options?: LangFnOptions,\n  ): string;\n  <K extends PluralLangKey = PluralLangKey>(\n    key: K, variables: undefined, options: LangFnOptionsWithPlural,\n  ): string;\n  <K extends RegularLangKeyWithVariables = RegularLangKeyWithVariables>(\n    key: K, variables: LangPairWithVariables[K], options?: LangFnOptions,\n  ): string;\n  <K extends PluralLangKeyWithVariables = PluralLangKeyWithVariables>(\n    key: K, variables: LangPairPluralWithVariables[K], options: LangFnOptionsWithPlural,\n  ): string;\n\n  <K extends RegularLangKey = RegularLangKey>(\n    key: K, variables?: undefined, options?: AdvancedLangFnOptions,\n  ): TeactNode;\n  <K extends PluralLangKey = PluralLangKey>(\n    key: K, variables: undefined, options: AdvancedLangFnOptionsWithPlural,\n  ): TeactNode;\n  <K extends RegularLangKeyWithVariables = RegularLangKeyWithVariables>(\n    key: K, variables: LangPairWithVariables<TeactNode | undefined>[K], options: AdvancedLangFnOptions,\n  ): TeactNode;\n  <K extends PluralLangKeyWithVariables = PluralLangKeyWithVariables>(\n    key: K, variables: LangPairPluralWithVariables<TeactNode | undefined>[K], options: AdvancedLangFnOptionsWithPlural,\n  ): TeactNode;\n\n  with: (params: LangFnParameters) => TeactNode;\n  withRegular: (params: RegularLangFnParameters) => string;\n  withAdvanced: (params: AdvancedLangFnParameters) => TeactNode;\n  region: (code: string) => string | undefined;\n  conjunction: (list: string[]) => string;\n  disjunction: (list: string[]) => string;\n  number: (value: number) => string;\n  internalFormatters: LangFormatters;\n  isRtl?: boolean;\n  rawCode: string;\n  code: string;\n  languageInfo: ApiLanguage;\n};\n\n// Allow basic polyfill\ntype ListFormat = Pick<Intl.ListFormat, 'format' | 'formatToParts'>;\n\nexport type LangFormatters = {\n  pluralRules: Intl.PluralRules;\n  region: Intl.DisplayNames;\n  conjunction: ListFormat;\n  disjunction: ListFormat;\n  number: Intl.NumberFormat;\n};\n\n/* GUARDS */\n\nexport function isDeletedLangString(string: LangPackStringValue): string is LangPackStringValueDeleted {\n  return typeof string === 'object' && 'isDeleted' in string;\n}\n\nexport function isRegularLangString(string: LangPackStringValue): string is LangPackStringValueRegular {\n  return typeof string === 'string';\n}\n\nexport function isPluralLangString(string: LangPackStringValue): string is LangPackStringValuePlural {\n  return !isRegularLangString(string) && !isDeletedLangString(string);\n}\n\nexport function isLangFnParam(object: unknown): object is LangFnParameters {\n  return Boolean(object) && typeof object === 'object' && 'key' in object! && !('type' in object);\n}\n\nexport function areAdvancedLangFnOptions(\n  params: LangFnOptions | AdvancedLangFnOptions,\n): params is AdvancedLangFnOptions {\n  return 'withNodes' in params && Boolean(params.withNodes);\n}\n","import type React from '../lib/teact/teact';\n\nconst stopEvent = (e: React.UIEvent | Event | React.FormEvent) => {\n  e.stopPropagation();\n  e.preventDefault();\n};\n\nexport default stopEvent;\n","import { throttle } from './schedulers';\n\nconst KEYS_TO_IGNORE = new Set([\n  'TeactMemoWrapper renders',\n  'TeactNContainer renders',\n  'Button renders',\n]);\nconst MIN_RENDERS_TO_SHOW = 5;\nconst MIN_DURATION_TO_SHOW = 2;\nconst BG_GREEN = ' style=\"background: lightgreen\"';\n\nlet counters: Record<string, {\n  value: number;\n  lastUpdateAt: number;\n}> = {};\n\nconst renderCountersThrottled = throttle(renderCounters, 500, false);\n\nlet loggerEl: HTMLDivElement;\n\nexport function debugToOverlay(text: string) {\n  if (!loggerEl) {\n    setupOverlay();\n  }\n\n  const date = new Date();\n  const dateFormatted = `${date.toLocaleTimeString()}.${date.getMilliseconds()}`;\n  const wasAtBottom = loggerEl.scrollTop + 10 >= loggerEl.scrollHeight - loggerEl.offsetHeight;\n\n  loggerEl.innerHTML += `${dateFormatted}: ${text}<br/>`;\n\n  if (wasAtBottom) {\n    loggerEl.scrollTop = loggerEl.scrollHeight;\n  }\n}\n\nexport function incrementOverlayCounter(key: string, value = 1) {\n  const now = Date.now();\n  if (!counters[key]) {\n    counters[key] = { value, lastUpdateAt: now };\n  } else {\n    counters[key].value += value;\n    counters[key].lastUpdateAt = now;\n  }\n\n  renderCountersThrottled();\n}\n\nexport function renderCounters() {\n  if (!loggerEl) {\n    setupOverlay();\n  }\n\n  const halfSecondAgo = Date.now() - 500;\n  const [maxRenders, maxDuration] = Object.entries(counters).reduce((acc, [key, { value }]) => {\n    if (KEYS_TO_IGNORE.has(key)) {\n      return acc;\n    }\n\n    if (key.includes('renders') && value > acc[0]) {\n      acc[0] = value;\n    }\n\n    if (key.includes('duration') && value > acc[1]) {\n      acc[1] = value;\n    }\n\n    return acc;\n  }, [0, 0]);\n\n  loggerEl.innerHTML = Object\n    .entries(counters)\n    .filter(([key, { value }]) => (\n      (!KEYS_TO_IGNORE.has(key)) && (\n        (key.includes('renders') && value > MIN_RENDERS_TO_SHOW)\n        || (key.includes('duration') && value > MIN_DURATION_TO_SHOW)\n      )\n    ))\n    .sort((a, b) => (\n      b[1].lastUpdateAt - a[1].lastUpdateAt\n    ))\n    .map(([key, { value, lastUpdateAt }]) => ([\n      `<div style=\"background: #ff0000${factorToHex(value / (key.includes('renders') ? maxRenders : maxDuration))}\">`,\n      `  <span${lastUpdateAt > halfSecondAgo ? BG_GREEN : ''}>${key}: ${Math.round(value)}</span>`,\n      '</div>',\n    ].join('\\n')))\n    .join('\\n');\n}\n\nfunction setupOverlay() {\n  loggerEl = document.createElement('div');\n  loggerEl.style.cssText = 'position: absolute; left: 0; bottom: 25px; z-index: 9998; width: 260px; height: 200px;'\n    + ' border: 1px solid #555; background: rgba(255, 255, 255, 0.9); overflow: auto; font-size: 10px;';\n  document.body.appendChild(loggerEl);\n\n  const clearEl = document.createElement('a');\n  clearEl.style.cssText = 'position: absolute; left: 222px; bottom: 198px; z-index: 9999; font-size: 20px; '\n    + 'cursor: pointer;';\n  clearEl.innerText = '🔄';\n  clearEl.addEventListener('click', () => {\n    counters = {};\n    renderCountersThrottled();\n  });\n  document.body.appendChild(clearEl);\n}\n\nfunction factorToHex(factor: number) {\n  return Math.round(255 * factor).toString(16).padStart(2, '0');\n}\n","import type { ReactElement } from 'react';\n\nimport { DEBUG, DEBUG_MORE } from '../../config';\nimport { logUnequalProps } from '../../util/arePropsShallowEqual';\nimport { incrementOverlayCounter } from '../../util/debugOverlay';\nimport { orderBy } from '../../util/iteratees';\nimport safeExec from '../../util/safeExec';\nimport { throttleWith } from '../../util/schedulers';\nimport { createSignal, isSignal, type Signal } from '../../util/signals';\nimport { requestMeasure, requestMutation } from '../fasterdom/fasterdom';\nimport { getIsBlockingAnimating } from './heavyAnimation';\n\nexport { getIsHeavyAnimating, beginHeavyAnimation, onFullyIdle } from './heavyAnimation';\n\nexport type Props = AnyLiteral;\nexport type FC<P extends Props = any> = (props: P) => any;\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport type FC_withDebug =\n  FC\n  & { DEBUG_contentComponentName?: string };\n\nexport enum VirtualType {\n  Empty,\n  Text,\n  Tag,\n  Component,\n  Fragment,\n}\n\ninterface VirtualElementEmpty {\n  type: VirtualType.Empty;\n  target?: Node;\n}\n\ninterface VirtualElementText {\n  type: VirtualType.Text;\n  target?: Node;\n  value: string;\n}\n\nexport interface VirtualElementTag {\n  type: VirtualType.Tag;\n  target?: HTMLElement | SVGElement;\n  tag: string;\n  props: Props;\n  children: VirtualElementChildren;\n}\n\nexport interface VirtualElementComponent {\n  type: VirtualType.Component;\n  componentInstance: ComponentInstance;\n  props: Props;\n  children: VirtualElementChildren;\n}\n\nexport interface VirtualElementFragment {\n  type: VirtualType.Fragment;\n  children: VirtualElementChildren;\n}\n\nexport type StateHookSetter<T> = (newValue: ((current: T) => T) | T) => void;\n\nexport interface RefObject<T = any> {\n  current: T;\n  onChange?: NoneToVoidFunction;\n}\n\nexport enum MountState {\n  Mounting,\n  Mounted,\n  Unmounted,\n}\n\ninterface ComponentInstance {\n  id: number;\n  $element: VirtualElementComponent;\n  Component: FC;\n  name: string;\n  props: Props;\n  renderedValue?: any;\n  mountState: MountState;\n  context?: Record<string, Signal<unknown>>;\n  hooks?: {\n    state?: {\n      cursor: number;\n      byCursor: {\n        value: any;\n        nextValue: any;\n        setter: StateHookSetter<any>;\n      }[];\n    };\n    effects?: {\n      cursor: number;\n      byCursor: {\n        dependencies?: readonly any[];\n        schedule?: NoneToVoidFunction;\n        cleanup?: NoneToVoidFunction;\n        releaseSignals?: NoneToVoidFunction;\n      }[];\n    };\n    memos?: {\n      cursor: number;\n      byCursor: {\n        value: any;\n        dependencies: any[];\n      }[];\n    };\n    refs?: {\n      cursor: number;\n      byCursor: RefObject[];\n    };\n  };\n  prepareForFrame?: () => void;\n  forceUpdate?: () => void;\n  onUpdate?: () => void;\n}\n\nexport type VirtualElement =\n  VirtualElementEmpty\n  | VirtualElementText\n  | VirtualElementTag\n  | VirtualElementComponent\n  | VirtualElementFragment;\nexport type VirtualElementParent =\n  VirtualElementTag\n  | VirtualElementComponent\n  | VirtualElementFragment;\nexport type VirtualElementChildren = VirtualElement[];\nexport type VirtualElementReal = Exclude<VirtualElement, VirtualElementComponent | VirtualElementFragment>;\n\n// Compatibility with JSX types\nexport type TeactNode =\n  ReactElement\n  | string\n  | number\n  | boolean\n  | TeactNode[];\n\ntype Effect = () => (NoneToVoidFunction | void);\ntype EffectCleanup = NoneToVoidFunction;\n\nexport type Context<T> = {\n  defaultValue?: T;\n  contextId: string;\n  Provider: FC<{ value: T; children: TeactNode }>;\n};\n\nconst Fragment = Symbol('Fragment');\n\nconst DEBUG_RENDER_THRESHOLD = 7;\nconst DEBUG_EFFECT_THRESHOLD = 7;\nconst DEBUG_SILENT_RENDERS_FOR = new Set(['TeactMemoWrapper', 'TeactNContainer', 'Button', 'ListItem', 'MenuItem']);\n\nlet contextCounter = 0;\n\nlet lastComponentId = 0;\nlet renderingInstance: ComponentInstance;\n\nexport function isParentElement($element: VirtualElement): $element is VirtualElementParent {\n  return (\n    $element.type === VirtualType.Tag\n    || $element.type === VirtualType.Component\n    || $element.type === VirtualType.Fragment\n  );\n}\n\nfunction createElement(\n  source: string | FC | typeof Fragment,\n  props: Props,\n  ...children: any[]\n): VirtualElementParent | VirtualElementChildren {\n  if (source === Fragment) {\n    return buildFragmentElement(children);\n  } else if (typeof source === 'function') {\n    return createComponentInstance(source, props || {}, children);\n  } else {\n    return buildTagElement(source, props || {}, children);\n  }\n}\n\nfunction buildFragmentElement(children: any[]): VirtualElementFragment {\n  return {\n    type: VirtualType.Fragment,\n    children: buildChildren(children, true),\n  };\n}\n\nfunction createComponentInstance(Component: FC, props: Props, children: any[]): VirtualElementComponent {\n  if (children?.length) {\n    props.children = children.length === 1 ? children[0] : children;\n  }\n\n  const componentInstance: ComponentInstance = {\n    id: -1,\n    $element: undefined as unknown as VirtualElementComponent,\n    Component,\n    name: Component.name,\n    props,\n    mountState: MountState.Unmounted,\n  };\n\n  componentInstance.$element = buildComponentElement(componentInstance);\n\n  return componentInstance.$element;\n}\n\nfunction buildComponentElement(\n  componentInstance: ComponentInstance,\n  children?: VirtualElementChildren,\n): VirtualElementComponent {\n  return {\n    type: VirtualType.Component,\n    componentInstance,\n    props: componentInstance.props,\n    children: children ? buildChildren(children, true) : [],\n  };\n}\n\nfunction buildTagElement(tag: string, props: Props, children: any[]): VirtualElementTag {\n  return {\n    type: VirtualType.Tag,\n    tag,\n    props,\n    children: buildChildren(children),\n  };\n}\n\nfunction buildChildren(children: any[], noEmpty = false): VirtualElement[] {\n  const cleanChildren = dropEmptyTail(children, noEmpty);\n  const newChildren = [];\n\n  for (let i = 0, l = cleanChildren.length; i < l; i++) {\n    const child = cleanChildren[i];\n    if (Array.isArray(child)) {\n      newChildren.push(...buildChildren(child, noEmpty));\n    } else {\n      newChildren.push(buildChildElement(child));\n    }\n  }\n\n  return newChildren;\n}\n\n// We only need placeholders in the middle of collection (to ensure other elements order).\nfunction dropEmptyTail(children: any[], noEmpty = false) {\n  let i = children.length - 1;\n\n  for (; i >= 0; i--) {\n    if (!isEmptyPlaceholder(children[i])) {\n      break;\n    }\n  }\n\n  if (i === children.length - 1) {\n    return children;\n  }\n\n  if (i === -1 && noEmpty) {\n    return children.slice(0, 1);\n  }\n\n  return children.slice(0, i + 1);\n}\n\nfunction isEmptyPlaceholder(child: any) {\n  return !child && child !== 0;\n}\n\nfunction buildChildElement(child: any): VirtualElement {\n  if (isEmptyPlaceholder(child)) {\n    return { type: VirtualType.Empty };\n  } else if (isParentElement(child)) {\n    return child;\n  } else {\n    return {\n      type: VirtualType.Text,\n      value: String(child),\n    };\n  }\n}\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\nconst DEBUG_components: AnyLiteral = { TOTAL: { name: 'TOTAL', renders: 0 } };\n// eslint-disable-next-line @typescript-eslint/naming-convention\nconst DEBUG_memos: Record<string, { key: string; calls: number; misses: number; hitRate: number }> = {};\nconst DEBUG_MEMOS_CALLS_THRESHOLD = 20;\n\ndocument.addEventListener('dblclick', () => {\n  // eslint-disable-next-line no-console\n  console.warn('COMPONENTS', orderBy(\n    Object\n      .values(DEBUG_components)\n      .map(({ avgRenderTime, ...state }) => {\n        return { ...state, ...(avgRenderTime !== undefined && { avgRenderTime: Number(avgRenderTime.toFixed(2)) }) };\n      }),\n    'renders',\n    'desc',\n  ));\n\n  // eslint-disable-next-line no-console\n  console.warn('MEMOS', orderBy(\n    Object\n      .values(DEBUG_memos)\n      .filter(({ calls }) => calls >= DEBUG_MEMOS_CALLS_THRESHOLD)\n      .map((state) => ({ ...state, hitRate: Number(state.hitRate.toFixed(2)) })),\n    'hitRate',\n    'asc',\n  ));\n});\n\nlet instancesPendingUpdate = new Set<ComponentInstance>();\nlet idsToExcludeFromUpdate = new Set<number>();\nlet pendingEffects = new Map<string, Effect>();\nlet pendingCleanups = new Map<string, EffectCleanup>();\nlet pendingLayoutEffects = new Map<string, Effect>();\nlet pendingLayoutCleanups = new Map<string, EffectCleanup>();\nlet areImmediateEffectsCaptured = false;\n\n/*\n  Order:\n  - component effect cleanups\n  - component effects\n  - measure tasks\n  - mutation tasks\n  - component updates\n  - component layout effect cleanups\n  - component layout effects\n  - forced layout measure tasks\n  - forced layout mutation tasks\n */\n\nconst runUpdatePassOnRaf = throttleWith(requestMeasure, () => {\n  if (getIsBlockingAnimating()) {\n    getIsBlockingAnimating.once(runUpdatePassOnRaf);\n    return;\n  }\n\n  const runImmediateEffects = captureImmediateEffects();\n\n  idsToExcludeFromUpdate = new Set();\n  const instancesToUpdate = Array\n    .from(instancesPendingUpdate)\n    .sort((a, b) => a.id - b.id);\n  instancesPendingUpdate = new Set();\n\n  const currentCleanups = pendingCleanups;\n  pendingCleanups = new Map();\n  currentCleanups.forEach((cb) => cb());\n\n  const currentEffects = pendingEffects;\n  pendingEffects = new Map();\n  currentEffects.forEach((cb) => cb());\n\n  requestMutation(() => {\n    instancesToUpdate.forEach(prepareComponentForFrame);\n    instancesToUpdate.forEach((instance) => {\n      if (idsToExcludeFromUpdate!.has(instance.id)) {\n        return;\n      }\n\n      forceUpdateComponent(instance);\n    });\n\n    runImmediateEffects?.();\n  });\n});\n\nexport function captureImmediateEffects() {\n  if (areImmediateEffectsCaptured) {\n    return undefined;\n  }\n\n  areImmediateEffectsCaptured = true;\n  return runCapturedImmediateEffects;\n}\n\nfunction runCapturedImmediateEffects() {\n  const currentLayoutCleanups = pendingLayoutCleanups;\n  pendingLayoutCleanups = new Map();\n  currentLayoutCleanups.forEach((cb) => cb());\n\n  const currentLayoutEffects = pendingLayoutEffects;\n  pendingLayoutEffects = new Map();\n  currentLayoutEffects.forEach((cb) => cb());\n\n  areImmediateEffectsCaptured = false;\n}\n\nexport function renderComponent(componentInstance: ComponentInstance) {\n  idsToExcludeFromUpdate.add(componentInstance.id);\n\n  const { Component, props } = componentInstance;\n  let newRenderedValue: any;\n\n  safeExec(() => {\n    renderingInstance = componentInstance;\n    if (componentInstance.hooks) {\n      if (componentInstance.hooks.state) {\n        componentInstance.hooks.state.cursor = 0;\n      }\n      if (componentInstance.hooks.effects) {\n        componentInstance.hooks.effects.cursor = 0;\n      }\n      if (componentInstance.hooks.memos) {\n        componentInstance.hooks.memos.cursor = 0;\n      }\n      if (componentInstance.hooks.refs) {\n        componentInstance.hooks.refs.cursor = 0;\n      }\n    }\n\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    let DEBUG_startAt: number | undefined;\n    if (DEBUG) {\n      const componentName = DEBUG_resolveComponentName(Component);\n      if (!DEBUG_components[componentName]) {\n        DEBUG_components[componentName] = {\n          name: componentName,\n          renders: 0,\n          avgRenderTime: 0,\n        };\n      }\n\n      if (DEBUG_MORE) {\n        if (!DEBUG_SILENT_RENDERS_FOR.has(componentName)) {\n          // eslint-disable-next-line no-console\n          console.log(`[Teact] Render ${componentName}`);\n        }\n      }\n\n      DEBUG_startAt = performance.now();\n    }\n\n    newRenderedValue = Component(props);\n\n    if (DEBUG) {\n      const duration = performance.now() - DEBUG_startAt!;\n      const componentName = DEBUG_resolveComponentName(Component);\n      if (duration > DEBUG_RENDER_THRESHOLD) {\n        // eslint-disable-next-line no-console\n        console.warn(`[Teact] Slow component render: ${componentName}, ${Math.round(duration)} ms`);\n      }\n\n      const { renders, avgRenderTime } = DEBUG_components[componentName];\n      DEBUG_components[componentName].avgRenderTime = (avgRenderTime * renders + duration) / (renders + 1);\n      DEBUG_components[componentName].renders++;\n      DEBUG_components.TOTAL.renders++;\n\n      if (DEBUG_MORE) {\n        incrementOverlayCounter(`${componentName} renders`);\n        incrementOverlayCounter(`${componentName} duration`, duration);\n      }\n    }\n  }, {\n    rescue: () => {\n      // eslint-disable-next-line no-console\n      console.error(`[Teact] Error while rendering component ${componentInstance.name}`, componentInstance);\n\n      newRenderedValue = componentInstance.renderedValue;\n    },\n  });\n\n  if (componentInstance.mountState === MountState.Mounted && newRenderedValue === componentInstance.renderedValue) {\n    return componentInstance.$element;\n  }\n\n  componentInstance.renderedValue = newRenderedValue;\n  const children = Array.isArray(newRenderedValue) ? newRenderedValue : [newRenderedValue];\n  componentInstance.$element = buildComponentElement(componentInstance, children);\n\n  return componentInstance.$element;\n}\n\nexport function hasElementChanged($old: VirtualElement, $new: VirtualElement) {\n  if (typeof $old !== typeof $new) {\n    return true;\n  } else if ($old.type !== $new.type) {\n    return true;\n  } else if ($old.type === VirtualType.Text && $new.type === VirtualType.Text) {\n    return $old.value !== $new.value;\n  } else if ($old.type === VirtualType.Tag && $new.type === VirtualType.Tag) {\n    return ($old.tag !== $new.tag) || ($old.props.key !== $new.props.key);\n  } else if ($old.type === VirtualType.Component && $new.type === VirtualType.Component) {\n    return (\n      $old.componentInstance.Component !== $new.componentInstance.Component\n    ) || (\n      $old.props.key !== $new.props.key\n    );\n  }\n\n  return false;\n}\n\nexport function mountComponent(componentInstance: ComponentInstance) {\n  componentInstance.id = ++lastComponentId;\n  componentInstance.mountState = MountState.Mounting;\n  renderComponent(componentInstance);\n  componentInstance.mountState = MountState.Mounted;\n  return componentInstance.$element;\n}\n\nexport function unmountComponent(componentInstance: ComponentInstance) {\n  if (componentInstance.mountState === MountState.Unmounted) {\n    return;\n  }\n\n  idsToExcludeFromUpdate.add(componentInstance.id);\n\n  if (componentInstance.hooks?.effects) {\n    for (const effect of componentInstance.hooks.effects.byCursor) {\n      if (effect.cleanup) {\n        safeExec(effect.cleanup);\n      }\n\n      effect.cleanup = undefined;\n      effect.releaseSignals?.();\n    }\n  }\n\n  componentInstance.mountState = MountState.Unmounted;\n\n  helpGc(componentInstance);\n}\n\n// We need to remove all references to DOM objects. We also clean all other references, just in case\nfunction helpGc(componentInstance: ComponentInstance) {\n  const {\n    effects, state, memos, refs,\n  } = componentInstance.hooks || {};\n\n  if (effects) {\n    for (const hook of effects.byCursor) {\n      hook.schedule = undefined as any;\n      hook.cleanup = undefined as any;\n      hook.releaseSignals = undefined as any;\n      hook.dependencies = undefined;\n    }\n  }\n\n  if (state) {\n    for (const hook of state.byCursor) {\n      hook.value = undefined;\n      hook.nextValue = undefined;\n      hook.setter = undefined as any;\n    }\n  }\n\n  if (memos) {\n    for (const hook of memos.byCursor) {\n      hook.value = undefined as any;\n      hook.dependencies = undefined as any;\n    }\n  }\n\n  if (refs) {\n    for (const hook of refs.byCursor) {\n      hook.current = undefined as any;\n      hook.onChange = undefined as any;\n    }\n  }\n\n  componentInstance.hooks = undefined as any;\n  componentInstance.$element = undefined as any;\n  componentInstance.renderedValue = undefined;\n  componentInstance.onUpdate = undefined;\n}\n\nfunction prepareComponentForFrame(componentInstance: ComponentInstance) {\n  if (componentInstance.mountState === MountState.Unmounted) {\n    return;\n  }\n\n  if (componentInstance.hooks?.state) {\n    for (const hook of componentInstance.hooks.state.byCursor) {\n      hook.value = hook.nextValue;\n    }\n  }\n}\n\nfunction forceUpdateComponent(componentInstance: ComponentInstance) {\n  if (componentInstance.mountState === MountState.Unmounted || !componentInstance.onUpdate) {\n    return;\n  }\n\n  const currentElement = componentInstance.$element;\n\n  renderComponent(componentInstance);\n\n  if (componentInstance.$element !== currentElement) {\n    componentInstance.onUpdate();\n  }\n}\n\nexport function useState<T>(): [T | undefined, StateHookSetter<T | undefined>];\nexport function useState<T>(initial: T, debugKey?: string): [T, StateHookSetter<T>];\nexport function useState<T>(initial?: T, debugKey?: string): [T, StateHookSetter<T>] {\n  if (!renderingInstance.hooks) {\n    renderingInstance.hooks = {};\n  }\n  if (!renderingInstance.hooks.state) {\n    renderingInstance.hooks.state = { cursor: 0, byCursor: [] };\n  }\n\n  const { cursor, byCursor } = renderingInstance.hooks.state;\n  const componentInstance = renderingInstance;\n\n  if (byCursor[cursor] === undefined) {\n    byCursor[cursor] = {\n      value: initial,\n      nextValue: initial,\n      setter: (newValue: ((current: T) => T) | T) => {\n        if (componentInstance.mountState === MountState.Unmounted) {\n          return;\n        }\n\n        if (typeof newValue === 'function') {\n          newValue = (newValue as (current: T) => T)(byCursor[cursor].nextValue);\n        }\n\n        if (byCursor[cursor].nextValue === newValue) {\n          return;\n        }\n\n        byCursor[cursor].nextValue = newValue;\n\n        instancesPendingUpdate.add(componentInstance);\n        runUpdatePassOnRaf();\n\n        if (DEBUG_MORE) {\n          // eslint-disable-next-line no-console\n          console.log(\n            '[Teact.useState]',\n            DEBUG_resolveComponentName(componentInstance.Component),\n            `State update at cursor #${cursor}${debugKey ? ` (${debugKey})` : ''}, next value: `,\n            byCursor[cursor].nextValue,\n          );\n        }\n      },\n    };\n  }\n\n  renderingInstance.hooks.state.cursor++;\n\n  return [\n    byCursor[cursor].value,\n    byCursor[cursor].setter,\n  ];\n}\n\nfunction useEffectBase(\n  isLayout: boolean,\n  effect: Effect,\n  dependencies?: readonly any[],\n  debugKey?: string,\n) {\n  if (!renderingInstance.hooks) {\n    renderingInstance.hooks = {};\n  }\n\n  if (!renderingInstance.hooks.effects) {\n    renderingInstance.hooks.effects = { cursor: 0, byCursor: [] };\n  }\n\n  const { cursor, byCursor } = renderingInstance.hooks.effects;\n  const effectConfig = byCursor[cursor];\n  const componentInstance = renderingInstance;\n\n  function schedule() {\n    scheduleEffect(componentInstance, cursor, effect, isLayout);\n  }\n\n  if (dependencies && effectConfig?.dependencies) {\n    if (dependencies.some((dependency, i) => dependency !== effectConfig.dependencies![i])) {\n      if (DEBUG && debugKey) {\n        const causedBy = dependencies.reduce((res, newValue, i) => {\n          const prevValue = effectConfig.dependencies![i];\n          if (newValue !== prevValue) {\n            res.push(`${i}: ${prevValue} => ${newValue}`);\n          }\n\n          return res;\n        }, []);\n\n        // eslint-disable-next-line no-console\n        console.log(`[Teact] Effect \"${debugKey}\" caused by dependencies.`, causedBy.join(', '));\n      }\n\n      schedule();\n    }\n  } else {\n    if (debugKey) {\n      // eslint-disable-next-line no-console\n      console.log(`[Teact] Effect \"${debugKey}\" caused by missing dependencies.`);\n    }\n\n    schedule();\n  }\n\n  function setupSignals() {\n    const cleanups = dependencies?.filter(isSignal).map((signal, i) => signal.subscribe(() => {\n      if (debugKey) {\n        // eslint-disable-next-line no-console\n        console.log(`[Teact] Effect \"${debugKey}\" caused by signal #${i} new value:`, signal());\n      }\n\n      byCursor[cursor].schedule!();\n    }));\n\n    if (!cleanups?.length) {\n      return undefined;\n    }\n\n    return () => {\n      for (const cleanup of cleanups) {\n        cleanup();\n      }\n    };\n  }\n\n  if (effectConfig) effectConfig.schedule = undefined; // Help GC\n\n  byCursor[cursor] = {\n    ...effectConfig,\n    dependencies,\n    schedule,\n  };\n\n  if (!effectConfig) {\n    byCursor[cursor].releaseSignals = setupSignals();\n  }\n\n  renderingInstance.hooks.effects.cursor++;\n}\n\nfunction scheduleEffect(\n  componentInstance: ComponentInstance,\n  cursor: number,\n  effect: Effect,\n  isLayout: boolean,\n) {\n  const { byCursor } = componentInstance.hooks!.effects!;\n  const cleanup = byCursor[cursor]?.cleanup;\n  const cleanupsContainer = isLayout ? pendingLayoutCleanups : pendingCleanups;\n  const effectsContainer = isLayout ? pendingLayoutEffects : pendingEffects;\n  const effectId = `${componentInstance.id}_${cursor}`;\n\n  if (cleanup) {\n    const runEffectCleanup = () => safeExec(() => {\n      if (componentInstance.mountState === MountState.Unmounted) {\n        return;\n      }\n\n      // eslint-disable-next-line @typescript-eslint/naming-convention\n      let DEBUG_startAt: number | undefined;\n      if (DEBUG) {\n        DEBUG_startAt = performance.now();\n      }\n\n      cleanup();\n\n      if (DEBUG) {\n        const duration = performance.now() - DEBUG_startAt!;\n        const componentName = DEBUG_resolveComponentName(componentInstance.Component);\n        if (duration > DEBUG_EFFECT_THRESHOLD) {\n          // eslint-disable-next-line no-console\n          console.warn(\n            `[Teact] Slow cleanup at effect cursor #${cursor}: ${componentName}, ${Math.round(duration)} ms`,\n          );\n        }\n      }\n    }, {\n      rescue: () => {\n        // eslint-disable-next-line no-console, max-len\n        console.error(`[Teact] Error in effect cleanup at cursor #${cursor} in ${componentInstance.name}`,\n          componentInstance);\n      },\n      always: () => {\n        byCursor[cursor].cleanup = undefined;\n      },\n    });\n\n    cleanupsContainer.set(effectId, runEffectCleanup);\n  }\n\n  const runEffect = () => safeExec(() => {\n    if (componentInstance.mountState === MountState.Unmounted) {\n      return;\n    }\n\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    let DEBUG_startAt: number | undefined;\n    if (DEBUG) {\n      DEBUG_startAt = performance.now();\n    }\n\n    const result = effect();\n    if (typeof result === 'function') {\n      byCursor[cursor].cleanup = result;\n    }\n\n    if (DEBUG) {\n      const duration = performance.now() - DEBUG_startAt!;\n      const componentName = DEBUG_resolveComponentName(componentInstance.Component);\n      if (duration > DEBUG_EFFECT_THRESHOLD) {\n        // eslint-disable-next-line no-console\n        console.warn(`[Teact] Slow effect at cursor #${cursor}: ${componentName}, ${Math.round(duration)} ms`);\n      }\n    }\n  }, {\n    rescue: () => {\n      // eslint-disable-next-line no-console\n      console.error(`[Teact] Error in effect at cursor #${cursor} in ${componentInstance.name}`, componentInstance);\n    },\n  });\n\n  effectsContainer.set(effectId, runEffect);\n\n  runUpdatePassOnRaf();\n}\n\nexport function useEffect(effect: Effect, dependencies?: readonly any[], debugKey?: string) {\n  return useEffectBase(false, effect, dependencies, debugKey);\n}\n\nexport function useLayoutEffect(effect: Effect, dependencies?: readonly any[], debugKey?: string) {\n  return useEffectBase(true, effect, dependencies, debugKey);\n}\n\nexport function useUnmountCleanup(cleanup: NoneToVoidFunction) {\n  if (!renderingInstance.hooks) {\n    renderingInstance.hooks = {};\n  }\n\n  if (!renderingInstance.hooks.effects) {\n    renderingInstance.hooks.effects = { cursor: 0, byCursor: [] };\n  }\n\n  const { cursor, byCursor } = renderingInstance.hooks.effects;\n\n  if (!byCursor[cursor]) {\n    byCursor[cursor] = {\n      cleanup,\n    };\n  }\n\n  renderingInstance.hooks.effects.cursor++;\n}\n\nexport function useMemo<T extends any>(\n  resolver: () => T,\n  dependencies: any[],\n  debugKey?: string,\n  debugHitRateKey?: string,\n): T {\n  if (!renderingInstance.hooks) {\n    renderingInstance.hooks = {};\n  }\n  if (!renderingInstance.hooks.memos) {\n    renderingInstance.hooks.memos = { cursor: 0, byCursor: [] };\n  }\n\n  const { cursor, byCursor } = renderingInstance.hooks.memos;\n  let { value } = byCursor[cursor] || {};\n\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  let DEBUG_state: typeof DEBUG_memos[string] | undefined;\n  if (DEBUG && debugHitRateKey) {\n    const instanceKey = `${debugHitRateKey}#${renderingInstance.id}`;\n\n    DEBUG_state = DEBUG_memos[instanceKey];\n    if (!DEBUG_state) {\n      DEBUG_state = {\n        key: instanceKey, calls: 0, misses: 0, hitRate: 0,\n      };\n      DEBUG_memos[instanceKey] = DEBUG_state;\n    }\n\n    DEBUG_state.calls++;\n    DEBUG_state.hitRate = (DEBUG_state.calls - DEBUG_state.misses) / DEBUG_state.calls;\n  }\n\n  if (\n    byCursor[cursor] === undefined\n    || dependencies.length !== byCursor[cursor].dependencies.length\n    || dependencies.some((dependency, i) => dependency !== byCursor[cursor].dependencies[i])\n  ) {\n    if (DEBUG) {\n      if (debugKey) {\n        const msg = `[Teact.useMemo] ${renderingInstance.name} (${debugKey}): Update is caused by:`;\n        if (!byCursor[cursor]) {\n          // eslint-disable-next-line no-console\n          console.log(`${msg} [first render]`);\n        } else {\n          logUnequalProps(byCursor[cursor].dependencies, dependencies, msg, debugKey);\n        }\n      }\n\n      if (DEBUG_state) {\n        DEBUG_state.misses++;\n        DEBUG_state.hitRate = (DEBUG_state.calls - DEBUG_state.misses) / DEBUG_state.calls;\n\n        if (\n          DEBUG_state.calls % 10 === 0\n          && DEBUG_state.calls >= DEBUG_MEMOS_CALLS_THRESHOLD\n          && DEBUG_state.hitRate < 0.25\n        ) {\n          // eslint-disable-next-line no-console\n          console.warn(\n            // eslint-disable-next-line max-len\n            `[Teact] ${DEBUG_state.key}: Hit rate is ${DEBUG_state.hitRate.toFixed(2)} for ${DEBUG_state.calls} calls`,\n          );\n        }\n      }\n    }\n\n    value = resolver();\n  }\n\n  byCursor[cursor] = {\n    value,\n    dependencies,\n  };\n\n  renderingInstance.hooks.memos.cursor++;\n\n  return value;\n}\n\nexport function useCallback<F extends AnyFunction>(newCallback: F, dependencies: any[], debugKey?: string): F {\n  // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  return useMemo(() => newCallback, dependencies, debugKey);\n}\n\nexport function useRef<T>(initial: T): RefObject<T>;\nexport function useRef<T>(): RefObject<T | undefined>; // TT way (empty is `undefined`)\nexport function useRef<T>(initial: null): RefObject<T | null>; // React way (empty is `null`)\n// eslint-disable-next-line no-null/no-null\nexport function useRef<T>(initial?: T | null) {\n  if (!renderingInstance.hooks) {\n    renderingInstance.hooks = {};\n  }\n  if (!renderingInstance.hooks.refs) {\n    renderingInstance.hooks.refs = { cursor: 0, byCursor: [] };\n  }\n\n  const { cursor, byCursor } = renderingInstance.hooks.refs;\n  if (!byCursor[cursor]) {\n    byCursor[cursor] = {\n      current: initial,\n    };\n  }\n\n  renderingInstance.hooks.refs.cursor++;\n\n  return byCursor[cursor];\n}\n\nexport function createContext<T>(defaultValue?: T): Context<T> {\n  const contextId = String(contextCounter++);\n\n  function TeactContextProvider(props: { value: T; children: TeactNode }) {\n    const [getValue, setValue] = useSignal(props.value ?? defaultValue);\n    // Create a new object to avoid mutations in the parent context\n    renderingInstance.context = { ...renderingInstance.context };\n\n    renderingInstance.context[contextId] = getValue;\n    setValue(props.value);\n    return props.children;\n  }\n\n  TeactContextProvider.DEBUG_contentComponentName = contextId;\n\n  const context = {\n    defaultValue,\n    contextId,\n    Provider: TeactContextProvider,\n  };\n\n  return context;\n}\n\nexport function useContextSignal<T>(context: Context<T>) {\n  const [getDefaultValue] = useSignal(context.defaultValue);\n\n  return renderingInstance.context?.[context.contextId] || getDefaultValue;\n}\n\nexport function useSignal<T>(initial?: T) {\n  const signalRef = useRef<ReturnType<typeof createSignal<T>>>();\n  signalRef.current ??= createSignal<T>(initial);\n  return signalRef.current;\n}\n\nexport function memo<T extends FC_withDebug>(Component: T, debugKey?: string) {\n  function TeactMemoWrapper(props: Props) {\n    return useMemo(\n      () => createElement(Component, props),\n      // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n      Object.values(props),\n      debugKey,\n      DEBUG_MORE ? DEBUG_resolveComponentName(renderingInstance.Component) : undefined,\n    );\n  }\n\n  TeactMemoWrapper.DEBUG_contentComponentName = DEBUG_resolveComponentName(Component);\n\n  return TeactMemoWrapper as T;\n}\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport function DEBUG_resolveComponentName(Component: FC_withDebug) {\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  const { name, DEBUG_contentComponentName } = Component;\n\n  if (name === 'TeactNContainer') {\n    return `container>${DEBUG_contentComponentName}`;\n  }\n\n  if (name === 'TeactMemoWrapper') {\n    return `memo>${DEBUG_contentComponentName}`;\n  }\n\n  if (name === 'TeactContextProvider') {\n    return `context>id${DEBUG_contentComponentName}`;\n  }\n\n  return name + (DEBUG_contentComponentName ? `>${DEBUG_contentComponentName}` : '');\n}\n\nexport default {\n  createElement,\n  Fragment,\n};","import {\n  getIsHeavyAnimating,\n  useCallback, useEffect, useMemo, useRef,\n} from '../lib/teact/teact';\n\nimport { createCallbackManager } from '../util/callbacks';\nimport useLastCallback from './useLastCallback';\n\nexport const startCallbacks = createCallbackManager();\nexport const endCallbacks = createCallbackManager();\n\ngetIsHeavyAnimating.subscribe(() => {\n  if (getIsHeavyAnimating()) {\n    startCallbacks.runCallbacks();\n  } else {\n    endCallbacks.runCallbacks();\n  }\n});\n\nexport default function useHeavyAnimation(\n  onStart?: AnyToVoidFunction,\n  onEnd?: AnyToVoidFunction,\n  isDisabled = false,\n) {\n  const lastOnStart = useLastCallback(onStart);\n  const lastOnEnd = useLastCallback(onEnd);\n\n  useEffect(() => {\n    if (isDisabled) {\n      return undefined;\n    }\n\n    if (getIsHeavyAnimating()) {\n      lastOnStart();\n    }\n\n    startCallbacks.addCallback(lastOnStart);\n    endCallbacks.addCallback(lastOnEnd);\n\n    return () => {\n      endCallbacks.removeCallback(lastOnEnd);\n      startCallbacks.removeCallback(lastOnStart);\n    };\n  }, [isDisabled, lastOnEnd, lastOnStart]);\n}\n\n// TODO → `onFullyIdle`?\nexport function useThrottleForHeavyAnimation<T extends AnyToVoidFunction>(afterHeavyAnimation: T, deps: unknown[]) {\n  // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  const fnMemo = useCallback(afterHeavyAnimation, deps);\n\n  const isScheduledRef = useRef(false);\n\n  return useMemo(() => {\n    return (...args: Parameters<T>) => {\n      if (!isScheduledRef.current) {\n        if (!getIsHeavyAnimating()) {\n          fnMemo(...args);\n          return;\n        }\n\n        isScheduledRef.current = true;\n\n        const removeCallback = endCallbacks.addCallback(() => {\n          fnMemo(...args);\n          removeCallback();\n          isScheduledRef.current = false;\n        });\n      }\n    };\n  }, [fnMemo]);\n}\n","import type { ThemeKey } from '../types';\n\nlet systemThemeCache: ThemeKey = (\n  window.matchMedia?.('(prefers-color-scheme: dark)').matches\n) ? 'dark' : 'light';\n\nlet themeChangeCallback: ((newTheme: ThemeKey) => void) | undefined;\n\nexport function getSystemTheme() {\n  return systemThemeCache;\n}\n\nfunction handleSystemThemeChange(e: MediaQueryListEventMap['change']) {\n  systemThemeCache = e.matches ? 'dark' : 'light';\n\n  themeChangeCallback?.(systemThemeCache);\n}\n\nexport function setSystemThemeChangeCallback(callback: (newTheme: ThemeKey) => void) {\n  themeChangeCallback = callback;\n}\n\nwindow.matchMedia('(prefers-color-scheme: dark)')\n  .addEventListener('change', handleSystemThemeChange);\n","import type { ThreadId, WebPageMediaSize } from '../../types';\nimport type {\n  ApiBotInlineMediaResult,\n  ApiBotInlineResult,\n  ApiWebDocument,\n} from './bots';\nimport type { ApiPeerColor } from './chats';\nimport type { ApiMessageAction } from './messageActions';\nimport type {\n  ApiLabeledPrice,\n} from './payments';\nimport type { ApiStarGiftUnique } from './stars';\nimport type {\n  ApiMessageStoryData, ApiStory, ApiWebPageStickerData, ApiWebPageStoryData,\n} from './stories';\nimport type { ApiInlineQueryPeerType } from './users';\n\nexport interface ApiDimensions {\n  width: number;\n  height: number;\n}\n\nexport interface ApiPhotoSize extends ApiDimensions {\n  type: 's' | 'm' | 'x' | 'y' | 'w';\n}\n\nexport interface ApiVideoSize extends ApiDimensions {\n  type: 'u' | 'v';\n  videoStartTs?: number;\n  size: number;\n}\n\nexport interface ApiThumbnail extends ApiDimensions {\n  dataUri: string;\n}\n\nexport interface ApiPhoto {\n  mediaType: 'photo';\n  id: string;\n  date: number;\n  thumbnail?: ApiThumbnail;\n  isVideo?: boolean;\n  sizes: ApiPhotoSize[];\n  videoSizes?: ApiVideoSize[];\n  blobUrl?: string;\n  isSpoiler?: boolean;\n}\n\nexport interface ApiSticker {\n  mediaType: 'sticker';\n  id: string;\n  stickerSetInfo: ApiStickerSetInfo;\n  emoji?: string;\n  isCustomEmoji?: boolean;\n  isLottie: boolean;\n  isVideo: boolean;\n  width?: number;\n  height?: number;\n  thumbnail?: ApiThumbnail;\n  previewPhotoSizes?: ApiPhotoSize[];\n  isPreloadedGlobally?: boolean;\n  hasEffect?: boolean;\n  isFree?: boolean;\n  shouldUseTextColor?: boolean;\n}\n\nexport interface ApiStickerSet {\n  isArchived?: true;\n  isEmoji?: true;\n  installedDate?: number;\n  id: string;\n  accessHash: string;\n  title: string;\n  hasThumbnail?: boolean;\n  hasStaticThumb?: boolean;\n  hasAnimatedThumb?: boolean;\n  hasVideoThumb?: boolean;\n  thumbCustomEmojiId?: string;\n  count: number;\n  stickers?: ApiSticker[];\n  packs?: Record<string, ApiSticker[]>;\n  covers?: ApiSticker[];\n  shortName: string;\n}\n\ntype ApiStickerSetInfoShortName = {\n  shortName: string;\n};\n\ntype ApiStickerSetInfoId = {\n  id: string;\n  accessHash: string;\n};\n\ntype ApiStickerSetInfoMissing = {\n  isMissing: true;\n};\n\nexport type ApiStickerSetInfo = ApiStickerSetInfoShortName | ApiStickerSetInfoId | ApiStickerSetInfoMissing;\n\nexport interface ApiVideo {\n  mediaType: 'video';\n  id: string;\n  mimeType: string;\n  duration: number;\n  fileName: string;\n  width?: number;\n  height?: number;\n  supportsStreaming?: boolean;\n  isRound?: boolean;\n  isGif?: boolean;\n  hasVideoPreview?: boolean;\n  isSpoiler?: boolean;\n  thumbnail?: ApiThumbnail;\n  previewPhotoSizes?: ApiPhotoSize[];\n  blobUrl?: string;\n  previewBlobUrl?: string;\n  size: number;\n  noSound?: boolean;\n  waveform?: number[];\n  timestamp?: number;\n}\n\nexport interface ApiAudio {\n  mediaType: 'audio';\n  id: string;\n  size: number;\n  mimeType: string;\n  fileName: string;\n  duration: number;\n  performer?: string;\n  title?: string;\n  thumbnailSizes?: ApiPhotoSize[];\n}\n\nexport interface ApiVoice {\n  mediaType: 'voice';\n  id: string;\n  duration: number;\n  waveform?: number[];\n  size: number;\n}\n\nexport interface ApiDocument {\n  mediaType: 'document';\n  id?: string;\n  fileName: string;\n  size: number;\n  timestamp?: number;\n  mimeType: string;\n  thumbnail?: ApiThumbnail;\n  previewPhotoSizes?: ApiPhotoSize[];\n  previewBlobUrl?: string;\n  innerMediaType?: 'photo' | 'video';\n  mediaSize?: ApiDimensions;\n}\n\nexport interface ApiContact {\n  mediaType: 'contact';\n  firstName: string;\n  lastName: string;\n  phoneNumber: string;\n  userId: string;\n}\n\nexport type ApiPaidMedia = {\n  mediaType: 'paidMedia';\n  starsAmount: number;\n} & ({\n  isBought?: true;\n  extendedMedia: BoughtPaidMedia[];\n} | {\n  isBought?: undefined;\n  extendedMedia: ApiMediaExtendedPreview[];\n});\n\nexport interface ApiPollAnswer {\n  text: ApiFormattedText;\n  option: string;\n}\n\nexport interface ApiPollResult {\n  isChosen?: true;\n  isCorrect?: true;\n  option: string;\n  votersCount: number;\n}\n\nexport interface ApiPoll {\n  mediaType: 'poll';\n  id: string;\n  summary: {\n    closed?: true;\n    isPublic?: true;\n    multipleChoice?: true;\n    quiz?: true;\n    question: ApiFormattedText;\n    answers: ApiPollAnswer[];\n    closePeriod?: number;\n    closeDate?: number;\n  };\n  results: {\n    isMin?: true;\n    results?: ApiPollResult[];\n    totalVoters?: number;\n    recentVoterIds?: string[];\n    solution?: string;\n    solutionEntities?: ApiMessageEntity[];\n  };\n}\n\nexport interface ApiInvoice {\n  prices: ApiLabeledPrice[];\n  totalAmount: number;\n  currency: string;\n  isTest?: boolean;\n  isRecurring?: boolean;\n  subscriptionPeriod?: number;\n  termsUrl?: string;\n  maxTipAmount?: number;\n  suggestedTipAmounts?: number[];\n  isNameRequested?: boolean;\n  isPhoneRequested?: boolean;\n  isEmailRequested?: boolean;\n  isShippingAddressRequested?: boolean;\n  isFlexible?: boolean;\n  isPhoneSentToProvider?: boolean;\n  isEmailSentToProvider?: boolean;\n}\n\nexport interface ApiMediaInvoice {\n  mediaType: 'invoice';\n  title: string;\n  description: string;\n  photo?: ApiWebDocument;\n  isTest?: boolean;\n  receiptMessageId?: number;\n  currency: string;\n  amount: number;\n  extendedMedia?: ApiMediaExtendedPreview;\n}\n\nexport interface ApiMediaExtendedPreview {\n  mediaType: 'extendedMediaPreview';\n  width?: number;\n  height?: number;\n  thumbnail?: ApiThumbnail;\n  duration?: number;\n}\n\nexport interface ApiPaymentCredentials {\n  id: string;\n  title: string;\n}\n\nexport interface ApiGeoPoint {\n  long: number;\n  lat: number;\n  accessHash: string;\n  accuracyRadius?: number;\n}\n\nexport interface ApiGeo {\n  mediaType: 'geo';\n  geo: ApiGeoPoint;\n}\n\nexport interface ApiVenue {\n  mediaType: 'venue';\n  geo: ApiGeoPoint;\n  title: string;\n  address: string;\n  provider: string;\n  venueId: string;\n  venueType: string;\n}\n\nexport interface ApiGeoLive {\n  mediaType: 'geoLive';\n  geo: ApiGeoPoint;\n  heading?: number;\n  period: number;\n}\n\nexport type ApiLocation = ApiGeo | ApiVenue | ApiGeoLive;\n\nexport type ApiGame = {\n  mediaType: 'game';\n  title: string;\n  description: string;\n  photo?: ApiPhoto;\n  shortName: string;\n  id: string;\n  accessHash: string;\n  document?: ApiDocument;\n};\n\nexport type ApiGiveaway = {\n  mediaType: 'giveaway';\n  quantity: number;\n  months?: number;\n  stars?: number;\n  untilDate: number;\n  isOnlyForNewSubscribers?: true;\n  countries?: string[];\n  channelIds: string[];\n  prizeDescription?: string;\n};\n\nexport type ApiGiveawayResults = {\n  mediaType: 'giveawayResults';\n  months?: number;\n  stars?: number;\n  untilDate: number;\n  isRefunded?: true;\n  isOnlyForNewSubscribers?: true;\n  channelId: string;\n  prizeDescription?: string;\n  winnersCount?: number;\n  winnerIds: string[];\n  additionalPeersCount?: number;\n  launchMessageId: number;\n  unclaimedCount: number;\n};\n\nexport type ApiNewPoll = {\n  summary: ApiPoll['summary'];\n  quiz?: {\n    correctAnswers: string[];\n    solution?: string;\n    solutionEntities?: ApiMessageEntity[];\n  };\n};\n\nexport interface ApiWebPage {\n  mediaType: 'webpage';\n  id: number;\n  url: string;\n  displayUrl: string;\n  type?: string;\n  siteName?: string;\n  title?: string;\n  description?: string;\n  photo?: ApiPhoto;\n  audio?: ApiAudio;\n  duration?: number;\n  document?: ApiDocument;\n  video?: ApiVideo;\n  story?: ApiWebPageStoryData;\n  gift?: ApiStarGiftUnique;\n  stickers?: ApiWebPageStickerData;\n  mediaSize?: WebPageMediaSize;\n  hasLargeMedia?: boolean;\n}\n\nexport type ApiReplyInfo = ApiMessageReplyInfo | ApiStoryReplyInfo;\n\nexport interface ApiMessageReplyInfo {\n  type: 'message';\n  replyToMsgId?: number;\n  replyToPeerId?: string;\n  replyFrom?: ApiMessageForwardInfo;\n  replyMedia?: MediaContent;\n  replyToTopId?: number;\n  isForumTopic?: true;\n  isQuote?: true;\n  quoteText?: ApiFormattedText;\n  quoteOffset?: number;\n}\n\nexport interface ApiStoryReplyInfo {\n  type: 'story';\n  peerId: string;\n  storyId: number;\n}\n\nexport interface ApiInputMessageReplyInfo {\n  type: 'message';\n  replyToMsgId: number;\n  replyToTopId?: number;\n  replyToPeerId?: string;\n  quoteText?: ApiFormattedText;\n  quoteOffset?: number;\n}\n\nexport interface ApiInputStoryReplyInfo {\n  type: 'story';\n  peerId: string;\n  storyId: number;\n}\n\nexport type ApiInputReplyInfo = ApiInputMessageReplyInfo | ApiInputStoryReplyInfo;\n\nexport interface ApiMessageForwardInfo {\n  date: number;\n  savedDate?: number;\n  isImported?: boolean;\n  isChannelPost: boolean;\n  channelPostId?: number;\n  isLinkedChannelPost?: boolean;\n  fromChatId?: string;\n  fromId?: string;\n  savedFromPeerId?: string;\n  isSavedOutgoing?: boolean;\n  fromMessageId?: number;\n  hiddenUserName?: string;\n  postAuthorTitle?: string;\n}\n\nexport interface ApiStoryForwardInfo {\n  fromPeerId?: string;\n  fromName?: string;\n  storyId?: number;\n  isModified?: boolean;\n}\n\nexport type ApiMessageEntityDefault = {\n  type: Exclude<\n  `${ApiMessageEntityTypes}`,\n  `${ApiMessageEntityTypes.Pre}` | `${ApiMessageEntityTypes.TextUrl}` | `${ApiMessageEntityTypes.MentionName}` |\n  `${ApiMessageEntityTypes.CustomEmoji}` | `${ApiMessageEntityTypes.Blockquote}` | `${ApiMessageEntityTypes.Timestamp}`\n  >;\n  offset: number;\n  length: number;\n};\n\nexport type ApiMessageEntityPre = {\n  type: ApiMessageEntityTypes.Pre;\n  offset: number;\n  length: number;\n  language?: string;\n};\n\nexport type ApiMessageEntityTextUrl = {\n  type: ApiMessageEntityTypes.TextUrl;\n  offset: number;\n  length: number;\n  url: string;\n};\n\nexport type ApiMessageEntityMentionName = {\n  type: ApiMessageEntityTypes.MentionName;\n  offset: number;\n  length: number;\n  userId: string;\n};\n\nexport type ApiMessageEntityBlockquote = {\n  type: ApiMessageEntityTypes.Blockquote;\n  offset: number;\n  length: number;\n  canCollapse?: boolean;\n};\n\nexport type ApiMessageEntityCustomEmoji = {\n  type: ApiMessageEntityTypes.CustomEmoji;\n  offset: number;\n  length: number;\n  documentId: string;\n};\n\n// Local entities\nexport type ApiMessageEntityTimestamp = {\n  type: ApiMessageEntityTypes.Timestamp;\n  offset: number;\n  length: number;\n  timestamp: number;\n};\n\nexport type ApiMessageEntityQuoteFocus = {\n  type: 'quoteFocus';\n  offset: number;\n  length: number;\n};\n\nexport type ApiMessageEntity = ApiMessageEntityDefault | ApiMessageEntityPre | ApiMessageEntityTextUrl |\nApiMessageEntityMentionName | ApiMessageEntityCustomEmoji | ApiMessageEntityBlockquote | ApiMessageEntityTimestamp |\nApiMessageEntityQuoteFocus;\n\nexport enum ApiMessageEntityTypes {\n  Bold = 'MessageEntityBold',\n  Blockquote = 'MessageEntityBlockquote',\n  BotCommand = 'MessageEntityBotCommand',\n  Cashtag = 'MessageEntityCashtag',\n  Code = 'MessageEntityCode',\n  Email = 'MessageEntityEmail',\n  Hashtag = 'MessageEntityHashtag',\n  Italic = 'MessageEntityItalic',\n  MentionName = 'MessageEntityMentionName',\n  Mention = 'MessageEntityMention',\n  Phone = 'MessageEntityPhone',\n  Pre = 'MessageEntityPre',\n  Strike = 'MessageEntityStrike',\n  TextUrl = 'MessageEntityTextUrl',\n  Url = 'MessageEntityUrl',\n  Underline = 'MessageEntityUnderline',\n  Spoiler = 'MessageEntitySpoiler',\n  CustomEmoji = 'MessageEntityCustomEmoji',\n  Timestamp = 'MessageEntityTimestamp',\n  QuoteFocus = 'MessageEntityQuoteFocus',\n  Unknown = 'MessageEntityUnknown',\n}\n\nexport interface ApiFormattedText {\n  text: string;\n  entities?: ApiMessageEntity[];\n}\n\nexport type MediaContent = {\n  text?: ApiFormattedText;\n  photo?: ApiPhoto;\n  video?: ApiVideo;\n  altVideos?: ApiVideo[];\n  document?: ApiDocument;\n  sticker?: ApiSticker;\n  contact?: ApiContact;\n  pollId?: string;\n  action?: ApiMessageAction;\n  webPage?: ApiWebPage;\n  audio?: ApiAudio;\n  voice?: ApiVoice;\n  invoice?: ApiMediaInvoice;\n  location?: ApiLocation;\n  game?: ApiGame;\n  storyData?: ApiMessageStoryData;\n  giveaway?: ApiGiveaway;\n  giveawayResults?: ApiGiveawayResults;\n  paidMedia?: ApiPaidMedia;\n  ttlSeconds?: number;\n};\nexport type MediaContainer = {\n  content: MediaContent;\n};\n\nexport type StatefulMediaContent = {\n  poll?: ApiPoll;\n  story?: ApiStory;\n};\n\nexport type BoughtPaidMedia = Pick<MediaContent, 'photo' | 'video'>;\n\nexport interface ApiMessage {\n  id: number;\n  chatId: string;\n  content: MediaContent;\n  date: number;\n  isOutgoing: boolean;\n  senderId?: string;\n  replyInfo?: ApiReplyInfo;\n  sendingState?: 'messageSendingStatePending' | 'messageSendingStateFailed';\n  forwardInfo?: ApiMessageForwardInfo;\n  isDeleting?: boolean;\n  previousLocalId?: number;\n  viewsCount?: number;\n  forwardsCount?: number;\n  isEdited?: boolean;\n  editDate?: number;\n  isMentioned?: boolean;\n  isMediaUnread?: boolean;\n  groupedId?: string;\n  isInAlbum?: boolean;\n  hasUnreadMention?: boolean;\n  inlineButtons?: ApiKeyboardButtons;\n  keyboardButtons?: ApiKeyboardButtons;\n  keyboardPlaceholder?: string;\n  isKeyboardSingleUse?: boolean;\n  isKeyboardSelective?: boolean;\n  viaBotId?: string;\n  viaBusinessBotId?: string;\n  postAuthorTitle?: string;\n  isScheduled?: boolean;\n  shouldHideKeyboardButtons?: boolean;\n  isHideKeyboardSelective?: boolean;\n  isFromScheduled?: boolean;\n  isSilent?: boolean;\n  isPinned?: boolean;\n  seenByDates?: Record<string, number>;\n  isProtected?: boolean;\n  isForwardingAllowed?: boolean;\n  transcriptionId?: string;\n  isTranscriptionError?: boolean;\n  emojiOnlyCount?: number;\n  reactors?: {\n    nextOffset?: string;\n    count: number;\n    reactions: ApiPeerReaction[];\n  };\n  reactions?: ApiReactions;\n  hasComments?: boolean;\n  readDate?: number;\n  savedPeerId?: string;\n  senderBoosts?: number;\n  factCheck?: ApiFactCheck;\n  effectId?: string;\n  isInvertedMedia?: true;\n  isVideoProcessingPending?: true;\n  areReactionsPossible?: true;\n  reportDeliveryUntilDate?: number;\n  paidMessageStars?: number;\n}\n\nexport interface ApiReactions {\n  canSeeList?: boolean;\n  areTags?: boolean;\n  results: ApiReactionCount[];\n  recentReactions?: ApiPeerReaction[];\n  topReactors?: ApiMessageReactor[];\n}\n\nexport interface ApiPeerReaction {\n  peerId: string;\n  reaction: ApiReaction;\n  isOwn?: boolean;\n  isBig?: boolean;\n  isUnread?: boolean;\n  addedDate: number;\n}\n\nexport interface ApiMessageReactor {\n  isTop?: true;\n  isMy?: true;\n  count: number;\n  isAnonymous?: true;\n  peerId?: string;\n}\n\nexport interface ApiReactionCount {\n  chosenOrder?: number;\n  count: number;\n  reaction: ApiReactionWithPaid;\n  localAmount?: number;\n  localIsPrivate?: boolean;\n  localPeerId?: string;\n  localPreviousChosenOrder?: number;\n}\n\nexport interface ApiAvailableReaction {\n  selectAnimation?: ApiDocument;\n  appearAnimation?: ApiDocument;\n  activateAnimation?: ApiDocument;\n  effectAnimation?: ApiDocument;\n  staticIcon?: ApiDocument;\n  centerIcon?: ApiDocument;\n  aroundAnimation?: ApiDocument;\n  reaction: ApiReactionEmoji;\n  title: string;\n  isInactive?: boolean;\n  isPremium?: boolean;\n}\n\nexport interface ApiAvailableEffect {\n  id: string;\n  emoticon: string;\n  staticIconId?: string;\n  effectAnimationId?: string;\n  effectStickerId: string;\n  isPremium?: boolean;\n}\n\ntype ApiChatReactionsAll = {\n  type: 'all';\n  areCustomAllowed?: true;\n};\n\ntype ApiChatReactionsSome = {\n  type: 'some';\n  allowed: ApiReaction[];\n};\n\nexport type ApiChatReactions = ApiChatReactionsAll | ApiChatReactionsSome;\n\nexport type ApiReactionEmoji = {\n  type: 'emoji';\n  emoticon: string;\n};\n\nexport type ApiReactionCustomEmoji = {\n  type: 'custom';\n  documentId: string;\n};\n\nexport type ApiReactionPaid = {\n  type: 'paid';\n};\n\nexport type ApiReaction = ApiReactionEmoji | ApiReactionCustomEmoji;\nexport type ApiReactionWithPaid = ApiReaction | ApiReactionPaid;\n\nexport type ApiReactionKey = `${string}-${string}` | 'paid' | 'unsupported';\n\nexport type ApiSavedReactionTag = {\n  reaction: ApiReaction;\n  title?: string;\n  count: number;\n};\n\nexport type ApiPaidReactionPrivacyType = ApiPaidReactionPrivacyDefault |\nApiPaidReactionPrivacyAnonymous | PaidReactionPrivacyPeer;\n\nexport type ApiPaidReactionPrivacyDefault = {\n  type: 'default';\n};\n\nexport type ApiPaidReactionPrivacyAnonymous = {\n  type: 'anonymous';\n};\n\nexport type PaidReactionPrivacyPeer = {\n  type: 'peer';\n  peerId: string;\n};\n\ninterface ApiBaseThreadInfo {\n  chatId: string;\n  messagesCount: number;\n  lastMessageId?: number;\n  lastReadInboxMessageId?: number;\n  recentReplierIds?: string[];\n}\n\nexport interface ApiCommentsInfo extends ApiBaseThreadInfo {\n  isCommentsInfo: true;\n  threadId?: never;\n  originChannelId: string;\n  originMessageId: number;\n}\n\nexport interface ApiMessageThreadInfo extends ApiBaseThreadInfo {\n  isCommentsInfo: false;\n  threadId: ThreadId;\n  // For linked messages in discussion\n  fromChannelId?: string;\n  fromMessageId?: number;\n}\n\nexport type ApiThreadInfo = ApiCommentsInfo | ApiMessageThreadInfo;\n\nexport type ApiMessageReportResult = {\n  type: 'reported';\n} | {\n  type: 'comment';\n  isOptional?: boolean;\n  option: string;\n} | {\n  type: 'selectOption';\n  title: string;\n  options: {\n    text: string;\n    option: string;\n  }[];\n};\n\nexport type ApiMessageOutgoingStatus = 'read' | 'succeeded' | 'pending' | 'failed';\n\nexport type ApiSponsoredMessage = {\n  chatId: string;\n  randomId: string;\n  isRecommended?: true;\n  expiresAt: number;\n  sponsorInfo?: string;\n  additionalInfo?: string;\n  buttonText?: string;\n  canReport?: true;\n  title: string;\n  url: string;\n  photo?: ApiPhoto;\n  content: MediaContent;\n  peerColor?: ApiPeerColor;\n};\n\n// KeyboardButtons\n\ninterface ApiKeyboardButtonSimple {\n  type: 'unsupported' | 'buy' | 'command' | 'requestPhone' | 'game';\n  text: string;\n}\n\ninterface ApiKeyboardButtonReceipt {\n  type: 'receipt';\n  receiptMessageId: number;\n}\n\ninterface ApiKeyboardButtonUrl {\n  type: 'url';\n  text: string;\n  url: string;\n}\n\ninterface ApiKeyboardButtonSimpleWebView {\n  type: 'simpleWebView';\n  text: string;\n  url: string;\n}\n\ninterface ApiKeyboardButtonWebView {\n  type: 'webView';\n  text: string;\n  url: string;\n}\n\ninterface ApiKeyboardButtonCallback {\n  type: 'callback';\n  text: string;\n  data: string;\n}\n\ninterface ApiKeyboardButtonRequestPoll {\n  type: 'requestPoll';\n  text: string;\n  isQuiz?: boolean;\n}\n\ninterface ApiKeyboardButtonSwitchBotInline {\n  type: 'switchBotInline';\n  text: string;\n  query: string;\n  isSamePeer?: boolean;\n}\n\ninterface ApiKeyboardButtonUserProfile {\n  type: 'userProfile';\n  text: string;\n  userId: string;\n}\n\ninterface ApiKeyboardButtonUrlAuth {\n  type: 'urlAuth';\n  text: string;\n  url: string;\n  buttonId: number;\n}\n\ninterface ApiKeyboardButtonCopy {\n  type: 'copy';\n  text: string;\n  copyText: string;\n}\n\nexport type ApiKeyboardButton = (\n  ApiKeyboardButtonSimple\n  | ApiKeyboardButtonReceipt\n  | ApiKeyboardButtonUrl\n  | ApiKeyboardButtonCallback\n  | ApiKeyboardButtonRequestPoll\n  | ApiKeyboardButtonSwitchBotInline\n  | ApiKeyboardButtonUserProfile\n  | ApiKeyboardButtonWebView\n  | ApiKeyboardButtonSimpleWebView\n  | ApiKeyboardButtonUrlAuth\n  | ApiKeyboardButtonCopy\n);\n\nexport type ApiKeyboardButtons = ApiKeyboardButton[][];\nexport type ApiReplyKeyboard = {\n  keyboardPlaceholder?: string;\n  isKeyboardSingleUse?: boolean;\n  isKeyboardSelective?: boolean;\n} & {\n  [K in 'inlineButtons' | 'keyboardButtons']?: ApiKeyboardButtons;\n};\n\nexport type ApiTranscription = {\n  text: string;\n  isPending?: boolean;\n  transcriptionId: string;\n};\n\nexport type ApiMessageSearchType = 'text' | 'media' | 'documents' | 'links' | 'audio' | 'voice' | 'profilePhoto';\nexport type ApiGlobalMessageSearchType = 'text' | 'channels' | 'media' | 'documents' | 'links' | 'audio' | 'voice';\nexport type ApiMessageSearchContext = 'all' | 'users' | 'groups' | 'channels';\n\nexport type ApiReportReason = 'spam' | 'violence' | 'pornography' | 'childAbuse'\n| 'copyright' | 'geoIrrelevant' | 'fake' | 'illegalDrugs' | 'personalDetails' | 'other';\n\nexport type ApiSendMessageAction = {\n  type: 'cancel' | 'typing' | 'recordAudio' | 'chooseSticker' | 'playingGame';\n};\n\nexport type ApiThemeParameters = {\n  bg_color: string;\n  text_color: string;\n  hint_color: string;\n  link_color: string;\n  button_color: string;\n  button_text_color: string;\n  secondary_bg_color: string;\n  header_bg_color: string;\n  accent_text_color: string;\n  section_bg_color: string;\n  section_header_text_color: string;\n  subtitle_text_color: string;\n  destructive_text_color: string;\n  section_separator_color: string;\n};\n\nexport type ApiBotApp = {\n  id: string;\n  accessHash: string;\n  title: string;\n  shortName: string;\n  description: string;\n  photo?: ApiPhoto;\n  document?: ApiDocument;\n};\n\nexport type ApiMessagesBotApp = ApiBotApp & {\n  isInactive?: boolean;\n  shouldRequestWriteAccess?: boolean;\n};\n\nexport type ApiQuickReply = {\n  id: number;\n  shortcut: string;\n  topMessageId: number;\n};\n\nexport type ApiFactCheck = {\n  shouldFetch?: true;\n  hash: string;\n  countryCode?: string;\n  text?: ApiFormattedText;\n};\n\nexport type ApiSponsoredMessageReportResult = {\n  type: 'reported' | 'hidden' | 'premiumRequired';\n} | {\n  type: 'selectOption';\n  title: string;\n  options: {\n    text: string;\n    option: string;\n  }[];\n};\n\nexport type ApiPreparedInlineMessage = {\n  queryId: string;\n  result: ApiBotInlineResult | ApiBotInlineMediaResult;\n  peerTypes: ApiInlineQueryPeerType[];\n  cacheTime: number;\n};\n\nexport const MAIN_THREAD_ID = -1;\n\n// `Symbol` can not be transferred from worker\nexport const MESSAGE_DELETED = 'MESSAGE_DELETED';","import { getGlobal } from '../global';\n\nimport {\n  APP_CODE_NAME,\n  DEBUG, IS_MOCKED_CLIENT,\n} from '../config';\nimport { IS_ELECTRON } from './browser/windowEnvironment';\nimport { hasStoredSession } from './sessions';\n\nconst WEBSYNC_URLS = [\n  't.me',\n  'telegram.me',\n].map((domain) => `https://${domain}/_websync_?`);\nconst WEBSYNC_VERSION = `${APP_VERSION} ${APP_CODE_NAME}`;\nconst WEBSYNC_KEY = 'tgme_sync';\nconst WEBSYNC_TIMEOUT = 86400;\n\nconst getTs = () => {\n  return Math.floor(Number(new Date()) / 1000);\n};\n\nconst saveSync = (authed: boolean) => {\n  const ts = getTs();\n  localStorage.setItem(WEBSYNC_KEY, JSON.stringify({\n    canRedirect: authed,\n    ts,\n  }));\n};\n\nlet lastTimeout: NodeJS.Timeout | undefined;\n\nexport const forceWebsync = (authed: boolean) => {\n  if (IS_MOCKED_CLIENT || IS_ELECTRON) return undefined;\n  const currentTs = getTs();\n\n  const { canRedirect, ts } = JSON.parse(localStorage.getItem(WEBSYNC_KEY) || '{}');\n\n  if (canRedirect !== authed || ts + WEBSYNC_TIMEOUT <= currentTs) {\n    return Promise.all(WEBSYNC_URLS.map((url) => {\n      return new Promise<void>((resolve, reject) => {\n        const script = document.createElement('script');\n\n        const removeElement = () => Boolean(document.body.removeChild(script));\n\n        script.src = url + new URLSearchParams({\n          authed: Number(authed).toString(),\n          version: WEBSYNC_VERSION,\n        });\n\n        document.body.appendChild(script);\n\n        script.onload = () => {\n          saveSync(authed);\n          removeElement();\n          if (lastTimeout) {\n            clearTimeout(lastTimeout);\n            lastTimeout = undefined;\n          }\n          startWebsync();\n          resolve();\n        };\n\n        script.onerror = () => {\n          removeElement();\n          reject();\n        };\n      });\n    }));\n  } else {\n    return Promise.resolve();\n  }\n};\n\nexport function stopWebsync() {\n  if (DEBUG || IS_ELECTRON) return;\n\n  if (lastTimeout) clearTimeout(lastTimeout);\n}\n\nexport function startWebsync() {\n  if (DEBUG || IS_ELECTRON) {\n    return;\n  }\n\n  if (lastTimeout !== undefined) return;\n  const currentTs = getTs();\n\n  const { ts } = JSON.parse(localStorage.getItem(WEBSYNC_KEY) || '{}');\n\n  const timeout = WEBSYNC_TIMEOUT - (currentTs - ts);\n\n  lastTimeout = setTimeout(() => {\n    const { authState } = getGlobal();\n\n    const authed = authState === 'authorizationStateReady' || hasStoredSession();\n    forceWebsync(authed);\n  }, Math.max(0, timeout * 1000));\n}\n\nexport function clearWebsync() {\n  localStorage.removeItem(WEBSYNC_KEY);\n}\n","import type { TeactNode } from '../../lib/teact/teact';\nimport React from '../../lib/teact/teact';\nimport { getActions } from '../../global';\n\nimport { ApiMessageEntityTypes } from '../../api/types';\n\nimport { ensureProtocol, getUnicodeUrl, isMixedScriptUrl } from '../../util/browser/url';\nimport buildClassName from '../../util/buildClassName';\n\nimport useLastCallback from '../../hooks/useLastCallback';\n\ntype OwnProps = {\n  url?: string;\n  text: string;\n  className?: string;\n  children?: TeactNode;\n  isRtl?: boolean;\n  shouldSkipModal?: boolean;\n};\n\nconst SafeLink = ({\n  url,\n  text,\n  className,\n  children,\n  isRtl,\n  shouldSkipModal,\n}: OwnProps) => {\n  const { openUrl } = getActions();\n\n  const content = children || text;\n  const isRegularLink = url === text;\n\n  const handleClick = useLastCallback((e: React.MouseEvent<HTMLAnchorElement, MouseEvent>) => {\n    if (!url) return true;\n\n    e.preventDefault();\n\n    const isTrustedLink = isRegularLink && !isMixedScriptUrl(url);\n    openUrl({ url, shouldSkipModal: shouldSkipModal || isTrustedLink });\n\n    return false;\n  });\n\n  if (!url) {\n    return undefined;\n  }\n\n  const classNames = buildClassName(\n    className || 'text-entity-link',\n    isRegularLink && 'word-break-all',\n  );\n\n  return (\n    <a\n      href={ensureProtocol(url)}\n      title={getUnicodeUrl(url)}\n      target=\"_blank\"\n      rel=\"noopener noreferrer\"\n      className={classNames}\n      onClick={handleClick}\n      dir={isRtl ? 'rtl' : 'auto'}\n      data-entity-type={ApiMessageEntityTypes.Url}\n    >\n      {content}\n    </a>\n  );\n};\n\nexport default SafeLink;\n","/**\n * A Map that has a limited size. When the limit is reached, the oldest entry is removed.\n * Ignores last access time, only cares about insertion order.\n */\nexport default class LimitedMap<K, V> {\n  private map: Map<K, V>;\n\n  private insertionQueue: Set<K>;\n\n  constructor(private limit: number) {\n    this.map = new Map();\n    this.insertionQueue = new Set<K>();\n  }\n\n  public get(key: K): V | undefined {\n    return this.map.get(key);\n  }\n\n  public set(key: K, value: V): this {\n    if (this.map.size === this.limit) {\n      const keyToRemove = Array.from(this.insertionQueue).shift();\n      if (keyToRemove) {\n        this.map.delete(keyToRemove);\n        this.insertionQueue.delete(keyToRemove);\n      }\n    }\n\n    this.map.set(key, value);\n    this.insertionQueue.add(key);\n\n    return this;\n  }\n\n  public has(key: K): boolean {\n    return this.map.has(key);\n  }\n\n  public delete(key: K): boolean {\n    const result = this.map.delete(key);\n    if (result) {\n      this.insertionQueue.delete(key);\n    }\n    return result;\n  }\n\n  public clear(): void {\n    this.map.clear();\n    this.insertionQueue.clear();\n  }\n\n  public forEach(callbackfn: (value: V, key: K, map: Map<K, V>) => void, thisArg?: any): void {\n    this.map.forEach(callbackfn, thisArg);\n  }\n\n  public get size(): number {\n    return this.map.size;\n  }\n\n  public get [Symbol.toStringTag](): string {\n    return this.map[Symbol.toStringTag];\n  }\n\n  public [Symbol.iterator](): IterableIterator<[K, V]> {\n    return this.map[Symbol.iterator]();\n  }\n\n  public entries(): IterableIterator<[K, V]> {\n    return this.map.entries();\n  }\n\n  public keys(): IterableIterator<K> {\n    return this.map.keys();\n  }\n\n  public values(): IterableIterator<V> {\n    return this.map.values();\n  }\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"fWE9Tkfe\",\"progress\":\"F0JPgXgb\",\"button\":\"B94KQ3c0\",\"symbol\":\"wapdILU7\",\"sparkle\":\"AS3Scly3\"};","import React, { memo } from '../../lib/teact/teact';\n\nimport buildClassName from '../../util/buildClassName';\nimport buildStyle from '../../util/buildStyle';\n\nimport styles from './Sparkles.module.scss';\n\ntype ButtonParameters = {\n  preset: 'button';\n};\n\ntype ProgressParameters = {\n  preset: 'progress';\n};\n\ntype PresetParameters = ButtonParameters | ProgressParameters;\n\ntype OwnProps = {\n  className?: string;\n  style?: string;\n} & PresetParameters;\n\nconst SYMBOL = '✦';\nconst ANIMATION_DURATION = 5;\n\n// Values are in percents\nconst BUTTON_POSITIONS = [{\n  x: 20,\n  y: 0,\n  size: 100,\n  durationShift: 10,\n}, {\n  x: 15,\n  y: 15,\n  size: 75,\n  durationShift: 70,\n}, {\n  x: 10,\n  y: 35,\n  size: 75,\n  durationShift: 90,\n}, {\n  x: 20,\n  y: 70,\n  size: 125,\n  durationShift: 30,\n}, {\n  x: 40,\n  y: 10,\n  size: 125,\n  durationShift: 0,\n}, {\n  x: 45,\n  y: 60,\n  size: 75,\n  durationShift: 60,\n}, {\n  x: 60,\n  y: -10,\n  size: 100,\n  durationShift: 20,\n}, {\n  x: 55,\n  y: 40,\n  size: 75,\n  durationShift: 60,\n}, {\n  x: 70,\n  y: 65,\n  size: 100,\n  durationShift: 90,\n}, {\n  x: 80,\n  y: 10,\n  size: 75,\n  durationShift: 30,\n}, {\n  x: 80,\n  y: 45,\n  size: 125,\n  durationShift: 0,\n}];\nconst PROGRESS_POSITIONS = generateRandomProgressPositions(100);\n\nconst Sparkles = ({\n  className,\n  style,\n  ...presetSettings\n}: OwnProps) => {\n  if (presetSettings.preset === 'button') {\n    return (\n      <div className={buildClassName(styles.root, styles.button, className)} style={style}>\n        {BUTTON_POSITIONS.map((position) => {\n          const shiftX = Math.cos(Math.atan2(-50 + position.y, -50 + position.x)) * 100;\n          const shiftY = Math.sin(Math.atan2(-50 + position.y, -50 + position.x)) * 100;\n          return (\n            <div\n              className={styles.symbol}\n              style={buildStyle(\n                `top: ${position.y}%`,\n                `left: ${position.x}%`,\n                `--_duration-shift: ${(-position.durationShift / 100) * ANIMATION_DURATION}s`,\n                `--_shift-x: ${shiftX}%`,\n                `--_shift-y: ${shiftY}%`,\n                `scale: ${position.size}%`,\n              )}\n            >\n              {SYMBOL}\n            </div>\n          );\n        })}\n      </div>\n    );\n  }\n\n  if (presetSettings.preset === 'progress') {\n    return (\n      <div className={buildClassName(styles.root, styles.progress, className)} style={style}>\n        {PROGRESS_POSITIONS.map((position) => {\n          return (\n            <div\n              className={styles.symbol}\n              style={buildStyle(\n                `top: ${position.y}%`,\n                `left: ${position.x}%`,\n                `--_shift-x: ${position.velocityX}%`,\n                `--_shift-y: ${position.velocityY}%`,\n                `scale: ${position.scale}%`,\n                `--_duration-shift: ${(-position.durationShift / 100) * ANIMATION_DURATION}s`,\n              )}\n            >\n              {SYMBOL}\n            </div>\n          );\n        })}\n      </div>\n    );\n  }\n\n  return undefined;\n};\n\nfunction generateRandomProgressPositions(count: number) {\n  const positions = [];\n  for (let i = 0; i < count; i++) {\n    positions.push({\n      x: Math.random() * 100,\n      y: Math.random() * 100,\n      velocityX: (Math.random() * 5 + 15) * 100,\n      velocityY: (Math.random() * 10 - 5) * 100,\n      scale: (Math.random() * 0.5 + 0.5) * 100,\n      durationShift: Math.random() * 100,\n    });\n  }\n  return positions;\n}\n\nexport default memo(Sparkles);\n","import copy from 'copy-to-clipboard';\n\nimport { DEBUG } from '../config';\n\nexport const CLIPBOARD_ITEM_SUPPORTED = window.navigator.clipboard && window.ClipboardItem;\n\nconst textCopyEl = document.createElement('textarea');\ntextCopyEl.setAttribute('readonly', '');\ntextCopyEl.tabIndex = -1;\ntextCopyEl.className = 'visually-hidden';\n\nexport const copyTextToClipboard = (str: string): void => {\n  copy(str);\n  // textCopyEl.value = str;\n  // document.body.appendChild(textCopyEl);\n  // const selection = document.getSelection();\n\n  // if (selection) {\n  //   // Store previous selection\n  //   const rangeToRestore = selection.rangeCount > 0 && selection.getRangeAt(0);\n  //   textCopyEl.select();\n  //   document.execCommand('copy');\n  //   // Restore the original selection\n  //   if (rangeToRestore) {\n  //     selection.removeAllRanges();\n  //     selection.addRange(rangeToRestore);\n  //   }\n  // }\n\n  // document.body.removeChild(textCopyEl);\n};\n\nexport const copyHtmlToClipboard = (html: string, text: string): void => {\n  if (!window.navigator.clipboard?.write) {\n    copyTextToClipboard(text);\n    return;\n  }\n\n  window.navigator.clipboard.write([\n    new ClipboardItem({\n      'text/plain': new Blob([text], { type: 'text/plain' }),\n      'text/html': new Blob([html], { type: 'text/html' }),\n    }),\n  ]);\n};\n\nexport const copyImageToClipboard = (imageUrl?: string) => {\n  if (!imageUrl) return;\n  const canvas = document.createElement('canvas');\n  const ctx = canvas.getContext('2d');\n  const imageEl = new Image();\n  imageEl.onload = (e: Event) => {\n    if (ctx && e.currentTarget) {\n      const img = e.currentTarget as HTMLImageElement;\n      canvas.width = img.width;\n      canvas.height = img.height;\n      ctx.drawImage(img, 0, 0, img.width, img.height);\n      canvas.toBlob(copyBlobToClipboard, 'image/png', 1);\n    }\n  };\n\n  imageEl.src = imageUrl;\n};\n\nexport const copyTextToClipboardFromPromise = async (\n  getTextPromise: Promise<string | undefined>,\n  onSuccess: NoneToVoidFunction,\n  onFailure: NoneToVoidFunction,\n) => {\n  const copyTextToClipboardFallback = async () => {\n    try {\n      const text = await getTextPromise;\n      if (text) {\n        copyTextToClipboard(text);\n      } else {\n        onFailure();\n      }\n      return Boolean(text);\n    } catch {\n      onFailure();\n      return false;\n    }\n  };\n  if (!CLIPBOARD_ITEM_SUPPORTED || !navigator.clipboard.write) {\n    if (await copyTextToClipboardFallback()) onSuccess();\n    return;\n  }\n  try {\n    let hasGetDataError = false;\n    const rejectGetDataError = () => Promise.reject(new Error('GET_DATA_ERROR'));\n\n    const clipboardTextItem = new ClipboardItem({\n      'text/plain': getTextPromise.then((text) => text || rejectGetDataError()).catch(() => {\n        hasGetDataError = true;\n        return '';\n      }),\n    });\n    await navigator.clipboard.write([clipboardTextItem]);\n    if (hasGetDataError) {\n      onFailure();\n      return;\n    }\n  } catch {\n    // Promises in ClipboardItem aren't supported in older Chrome versions\n    if (!await copyTextToClipboardFallback()) return;\n  }\n  onSuccess();\n};\n\nasync function copyBlobToClipboard(pngBlob: Blob | null) {\n  if (!pngBlob || !CLIPBOARD_ITEM_SUPPORTED) {\n    return;\n  }\n\n  try {\n    await window.navigator.clipboard.write?.([\n      new ClipboardItem({\n        [pngBlob.type]: pngBlob,\n      }),\n    ]);\n  } catch (error) {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.error(error);\n    }\n  }\n}\n","import React, { memo } from '../../lib/teact/teact';\n\nimport type { ApiPeer, ApiPeerColor } from '../../api/types';\n\nimport buildClassName from '../../util/buildClassName';\nimport { getApiPeerColorClass, getPeerColorClass } from './helpers/peerColor';\n\nimport EmojiIconBackground from './embedded/EmojiIconBackground';\n\nimport styles from './PeerColorWrapper.module.scss';\n\ninterface OwnProps extends React.HTMLAttributes<HTMLDivElement> {\n  ref?: React.RefObject<HTMLDivElement>;\n  peer?: ApiPeer;\n  peerColor?: ApiPeerColor;\n  noUserColors?: boolean;\n  shouldReset?: boolean;\n  className?: string;\n  emojiIconClassName?: string;\n  children: React.ReactNode;\n}\n\nfunction PeerColorWrapper({\n  peer, ref, peerColor, noUserColors,\n  shouldReset, className, emojiIconClassName,\n  children, ...otherProps\n}: OwnProps) {\n  const color = peerColor || peer?.color;\n\n  return (\n    <div\n      ref={ref}\n      className={buildClassName(\n        styles.root,\n        peer && getPeerColorClass(peer, noUserColors, shouldReset),\n        peerColor && getApiPeerColorClass(peerColor),\n        className,\n      )}\n      // eslint-disable-next-line react/jsx-props-no-spreading\n      {...otherProps}\n    >\n      {color?.backgroundEmojiId && (\n        <EmojiIconBackground\n          className={emojiIconClassName}\n          emojiDocumentId={color.backgroundEmojiId}\n        />\n      )}\n      {children}\n    </div>\n  );\n}\n\nexport default memo(PeerColorWrapper);\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"nRjVJOQv\"};","import type {\n  ApiAttachment,\n  ApiMessage,\n  ApiMessageEntityTextUrl,\n  ApiPeer,\n  ApiStory,\n  ApiTypeStory,\n} from '../../api/types';\nimport type {\n  ApiPoll, MediaContainer, StatefulMediaContent,\n} from '../../api/types/messages';\nimport type { ThreadId } from '../../types';\nimport type { GlobalState } from '../types';\nimport { ApiMessageEntityTypes, MAIN_THREAD_ID } from '../../api/types';\n\nimport {\n  CONTENT_NOT_SUPPORTED,\n  LOTTIE_STICKER_MIME_TYPE,\n  RE_LINK_TEMPLATE,\n  SERVICE_NOTIFICATIONS_USER_ID,\n  SUPPORTED_AUDIO_CONTENT_TYPES,\n  SUPPORTED_PHOTO_CONTENT_TYPES,\n  SUPPORTED_VIDEO_CONTENT_TYPES,\n  TME_LINK_PREFIX,\n  VERIFICATION_CODES_USER_ID,\n  VIDEO_STICKER_MIME_TYPE,\n} from '../../config';\nimport { areSortedArraysIntersecting, unique } from '../../util/iteratees';\nimport { isLocalMessageId } from '../../util/keys/messageKey';\nimport { getServerTime } from '../../util/serverTime';\nimport { getGlobal } from '../index';\nimport {\n  getCleanPeerId, isUserId,\n} from './chats';\nimport { getMainUsername } from './users';\n\nconst RE_LINK = new RegExp(RE_LINK_TEMPLATE, 'i');\n\nexport function getMessageHtmlId(messageId: number, index?: number) {\n  const parts = ['message', messageId.toString().replace('.', '-'), index].filter(Boolean);\n  return parts.join('-');\n}\n\nexport function getMessageOriginalId(message: ApiMessage) {\n  return message.previousLocalId || message.id;\n}\n\nexport function getMessageTranscription(message: ApiMessage) {\n  const { transcriptionId } = message;\n  // eslint-disable-next-line eslint-multitab-tt/no-immediate-global\n  const global = getGlobal();\n\n  return transcriptionId && global.transcriptions[transcriptionId]?.text;\n}\n\nexport function hasMessageText(message: MediaContainer) {\n  const {\n    action, text, sticker, photo, video, audio, voice, document, pollId, webPage, contact, invoice, location,\n    game, storyData, giveaway, giveawayResults, paidMedia,\n  } = message.content;\n\n  return Boolean(text) || !(\n    sticker || photo || video || audio || voice || document || contact || pollId || webPage || invoice || location\n    || game || storyData || giveaway || giveawayResults || paidMedia || action?.type === 'phoneCall'\n  );\n}\n\nexport function getMessageStatefulContent(global: GlobalState, message: ApiMessage): StatefulMediaContent {\n  const poll = message.content.pollId ? global.messages.pollById[message.content.pollId] : undefined;\n\n  const { peerId: storyPeerId, id: storyId } = message.content.storyData || {};\n  const story = storyId && storyPeerId ? global.stories.byPeerId[storyPeerId]?.byId[storyId] : undefined;\n\n  return groupStatefulContent({ poll, story });\n}\n\nexport function groupStatefulContent({\n  poll,\n  story,\n} : {\n  poll?: ApiPoll;\n  story?: ApiTypeStory;\n}) {\n  return {\n    poll,\n    story: story && 'content' in story ? story : undefined,\n  };\n}\n\nexport function getMessageText(message: MediaContainer) {\n  return hasMessageText(message) ? message.content.text || { text: CONTENT_NOT_SUPPORTED } : undefined;\n}\n\nexport function getMessageCustomShape(message: ApiMessage): boolean {\n  const {\n    text, sticker, photo, video, audio, voice,\n    document, pollId, webPage, contact, action,\n    game, invoice, location, storyData,\n  } = message.content;\n\n  if (sticker || (video?.isRound)) {\n    return true;\n  }\n\n  if (!text || photo || video || audio || voice || document || pollId || webPage || contact || action || game || invoice\n    || location || storyData) {\n    return false;\n  }\n\n  const hasOtherFormatting = text?.entities?.some((entity) => entity.type !== ApiMessageEntityTypes.CustomEmoji);\n\n  return Boolean(message.emojiOnlyCount && !hasOtherFormatting);\n}\n\nexport function getMessageSingleRegularEmoji(message: ApiMessage) {\n  const { text } = message.content;\n\n  if (text?.entities?.length || message.emojiOnlyCount !== 1) {\n    return undefined;\n  }\n\n  return text!.text;\n}\n\nexport function getMessageSingleCustomEmoji(message: ApiMessage): string | undefined {\n  const { text } = message.content;\n\n  if (text?.entities?.length !== 1\n    || text.entities[0].type !== ApiMessageEntityTypes.CustomEmoji\n    || message.emojiOnlyCount !== 1) {\n    return undefined;\n  }\n\n  return text.entities[0].documentId;\n}\n\nexport function getFirstLinkInMessage(message: ApiMessage) {\n  const { text } = message.content;\n\n  let match: RegExpMatchArray | null | undefined;\n  if (text?.entities) {\n    const firstTextUrl = text.entities.find((entity): entity is ApiMessageEntityTextUrl => (\n      entity.type === ApiMessageEntityTypes.TextUrl\n    ));\n    if (firstTextUrl) {\n      match = firstTextUrl.url.match(RE_LINK);\n    }\n\n    if (!match) {\n      const firstUrl = text.entities.find((entity) => entity.type === ApiMessageEntityTypes.Url);\n      if (firstUrl) {\n        const { offset, length } = firstUrl;\n        match = text.text.substring(offset, offset + length).match(RE_LINK);\n      }\n    }\n  }\n\n  if (!match && text) {\n    match = text.text.match(RE_LINK);\n  }\n\n  if (!match) {\n    return undefined;\n  }\n\n  return {\n    url: match[0],\n    domain: match[3],\n  };\n}\n\nexport function matchLinkInMessageText(message: ApiMessage) {\n  const { text } = message.content;\n  const match = text && text.text.match(RE_LINK);\n\n  if (!match) {\n    return undefined;\n  }\n\n  return {\n    url: match[0],\n    domain: match[3],\n  };\n}\n\nexport function isOwnMessage(message: ApiMessage) {\n  return message.isOutgoing;\n}\n\nexport function isReplyToMessage(message: ApiMessage) {\n  return Boolean(message.replyInfo?.type === 'message');\n}\n\nexport function isForwardedMessage(message: ApiMessage) {\n  return Boolean(message.forwardInfo || message.content.storyData);\n}\n\nexport function isActionMessage(message: ApiMessage) {\n  return Boolean(message.content.action);\n}\n\nexport function isServiceNotificationMessage(message: ApiMessage) {\n  return message.chatId === SERVICE_NOTIFICATIONS_USER_ID && Math.round(message.id) !== message.id;\n}\n\nexport function isAnonymousOwnMessage(message: ApiMessage) {\n  return Boolean(message.senderId) && !isUserId(message.senderId) && isOwnMessage(message);\n}\n\nexport function getSendingState(message: ApiMessage) {\n  if (!message.sendingState) {\n    return 'succeeded';\n  }\n\n  return message.sendingState === 'messageSendingStateFailed' ? 'failed' : 'pending';\n}\n\nexport function isMessageLocal(message: ApiMessage) {\n  return isLocalMessageId(message.id);\n}\n\nexport function isMessageFailed(message: ApiMessage) {\n  return message.sendingState === 'messageSendingStateFailed';\n}\n\nexport function isHistoryClearMessage(message: ApiMessage) {\n  return message.content.action && message.content.action.type === 'historyClear';\n}\n\nexport function isGeoLiveExpired(message: ApiMessage) {\n  const { location } = message.content;\n  if (location?.mediaType !== 'geoLive') return false;\n  return getServerTime() - (message.date || 0) >= location.period;\n}\n\nexport function isMessageTranslatable(message: ApiMessage, allowOutgoing?: boolean) {\n  const { text, game } = message.content;\n\n  const isLocal = isMessageLocal(message);\n  const isServiceNotification = isServiceNotificationMessage(message);\n  const isAction = isActionMessage(message);\n\n  return Boolean(text?.text.length && !message.emojiOnlyCount && !game && (allowOutgoing || !message.isOutgoing)\n    && !isLocal && !isServiceNotification && !isAction && !message.isScheduled);\n}\n\nexport function getMessageSingleInlineButton(message: ApiMessage) {\n  return message.inlineButtons?.length === 1\n    && message.inlineButtons[0].length === 1\n    && message.inlineButtons[0][0];\n}\n\nexport function orderHistoryIds(listedIds: number[]) {\n  return listedIds.sort((a, b) => a - b);\n}\n\nexport function orderPinnedIds(pinnedIds: number[]) {\n  return pinnedIds.sort((a, b) => b - a);\n}\n\nexport function mergeIdRanges(ranges: number[][], idsUpdate: number[]): number[][] {\n  let hasIntersection = false;\n  let newOutlyingLists = ranges.length ? ranges.map((list) => {\n    if (areSortedArraysIntersecting(list, idsUpdate) && !hasIntersection) {\n      hasIntersection = true;\n      return orderHistoryIds(unique(list.concat(idsUpdate)));\n    }\n    return list;\n  }) : [idsUpdate];\n\n  if (!hasIntersection) {\n    newOutlyingLists = newOutlyingLists.concat([idsUpdate]);\n  }\n\n  newOutlyingLists.sort((a, b) => a[0] - b[0]);\n\n  let length = newOutlyingLists.length;\n  for (let i = 0; i < length; i++) {\n    const array = newOutlyingLists[i];\n    const prevArray = newOutlyingLists[i - 1];\n\n    if (prevArray && (prevArray.includes(array[0]) || prevArray.includes(array[0] - 1))) {\n      newOutlyingLists[i - 1] = orderHistoryIds(unique(array.concat(prevArray)));\n      newOutlyingLists.splice(i, 1);\n\n      length--;\n      i--;\n    }\n  }\n\n  return newOutlyingLists;\n}\n\nexport function extractMessageText(message: ApiMessage | ApiStory, inChatList = false) {\n  const contentText = message.content.text;\n  if (!contentText) return undefined;\n\n  const { text } = contentText;\n  let { entities } = contentText;\n\n  if (text && 'chatId' in message) {\n    if (message.chatId === SERVICE_NOTIFICATIONS_USER_ID) {\n      const authCode = text.match(/^\\D*([\\d-]{5,7})\\D/)?.[1];\n      if (authCode) {\n        entities = [\n          ...entities || [],\n          {\n            type: inChatList ? ApiMessageEntityTypes.Spoiler : ApiMessageEntityTypes.Code,\n            offset: text.indexOf(authCode),\n            length: authCode.length,\n          },\n        ];\n        entities.sort((a, b) => (a.offset > b.offset ? 1 : -1));\n      }\n    }\n\n    if (inChatList && message.chatId === VERIFICATION_CODES_USER_ID && entities) {\n      // Wrap code entities in spoiler\n      const hasCodeEntities = entities.some((entity) => entity.type === ApiMessageEntityTypes.Code);\n      if (hasCodeEntities) {\n        const oldEntities = entities;\n        entities = [];\n\n        for (let i = 0; i < oldEntities.length; i++) {\n          const entity = oldEntities[i];\n          if (entity.type === ApiMessageEntityTypes.Code) {\n            entities.push({\n              type: ApiMessageEntityTypes.Spoiler,\n              offset: entity.offset,\n              length: entity.length,\n            });\n          }\n          entities.push(entity);\n        }\n      }\n    }\n  }\n\n  return { text, entities };\n}\n\nexport function isExpiredMessage(message: ApiMessage) {\n  return message.content.action?.type === 'expired';\n}\n\nexport function hasMessageTtl(message: ApiMessage) {\n  return message.content?.ttlSeconds !== undefined;\n}\n\nexport function getAttachmentMediaType(attachment: ApiAttachment) {\n  if (SUPPORTED_AUDIO_CONTENT_TYPES.has(attachment.mimeType)) {\n    return 'audio';\n  }\n\n  if (attachment.shouldSendAsFile) return 'file';\n\n  if (SUPPORTED_PHOTO_CONTENT_TYPES.has(attachment.mimeType)) {\n    return 'photo';\n  }\n\n  if (SUPPORTED_VIDEO_CONTENT_TYPES.has(attachment.mimeType)) {\n    return 'video';\n  }\n\n  return 'file';\n}\n\nexport function isUploadingFileSticker(attachment: ApiAttachment) {\n  return attachment ? (attachment.mimeType === 'image/webp' || attachment.mimeType === LOTTIE_STICKER_MIME_TYPE\n    || attachment.mimeType === VIDEO_STICKER_MIME_TYPE) : undefined;\n}\n\nexport function getMessageLink(peer: ApiPeer, topicId?: ThreadId, messageId?: number) {\n  const chatUsername = getMainUsername(peer);\n\n  const normalizedId = getCleanPeerId(peer.id);\n\n  const chatPart = chatUsername || `c/${normalizedId}`;\n  const topicPart = topicId && topicId !== MAIN_THREAD_ID ? `/${topicId}` : '';\n  const messagePart = messageId ? `/${messageId}` : '';\n  return `${TME_LINK_PREFIX}${chatPart}${topicPart}${messagePart}`;\n}\n\nexport function splitMessagesForForwarding(messages: ApiMessage[], limit: number): ApiMessage[][] {\n  const result: ApiMessage[][] = [];\n  let currentArr: ApiMessage[] = [];\n\n  // Group messages by `groupedId`\n  messages.reduce<ApiMessage[][]>((acc, message) => {\n    const lastGroup = acc[acc.length - 1];\n    if (message.groupedId && lastGroup?.[0]?.groupedId === message.groupedId) {\n      lastGroup.push(message);\n      return acc;\n    }\n\n    acc.push([message]);\n    return acc;\n  }, []).forEach((batch) => {\n    // Fit them into `limit` size\n    if (currentArr.length + batch.length > limit) {\n      result.push(currentArr);\n      currentArr = [];\n    }\n\n    currentArr.push(...batch);\n  });\n\n  if (currentArr.length) {\n    result.push(currentArr);\n  }\n\n  return result;\n}\n","import { useEffect, useLayoutEffect, useState } from '../../lib/teact/teact';\n\nimport useLastCallback from '../useLastCallback';\nimport useResizeObserver from '../useResizeObserver';\n\nconst UPDATE_DEBOUNCE = 50; // ms\n\n/**\n * @param property animateable property\n */\nexport default function useStyleObserver(\n  ref: React.RefObject<HTMLElement>,\n  property: string,\n  debounce = UPDATE_DEBOUNCE,\n  isDisabled?: boolean,\n) {\n  const [value, setValue] = useState<string | undefined>();\n\n  const updateValue = useLastCallback(() => {\n    if (!ref.current || isDisabled) {\n      setValue(undefined);\n      return;\n    }\n\n    const computedValue = getComputedStyle(ref.current).getPropertyValue(property).trim();\n    setValue(computedValue);\n  });\n\n  // Element does not receive `transitionend` event if parent has `display: none`.\n  // We will receive `resize` event when parent is shown again.\n  useResizeObserver(ref, updateValue, isDisabled);\n\n  useLayoutEffect(() => {\n    const el = ref.current;\n    if (!el || isDisabled) {\n      return undefined;\n    }\n\n    el.style.setProperty('transition', `${debounce}ms ${property} linear`, 'important');\n\n    return () => {\n      el.style.removeProperty('transition');\n    };\n  }, [debounce, isDisabled, property, ref]);\n\n  useEffect(() => {\n    const el = ref.current;\n    if (!el) {\n      return undefined;\n    }\n\n    updateValue();\n\n    if (isDisabled) {\n      return undefined;\n    }\n\n    function handleTransitionEnd(e: TransitionEvent) {\n      if (e.propertyName !== property) return;\n      updateValue();\n    }\n\n    el.addEventListener('transitionend', handleTransitionEnd);\n\n    return () => {\n      el.removeEventListener('transitionend', handleTransitionEnd);\n    };\n  }, [isDisabled, property, ref, updateValue]);\n\n  return value;\n}\n","import { useMemo } from '../../lib/teact/teact';\n\nimport { prepareHexColor } from '../../util/themeStyle';\nimport useStyleObserver from '../element/useStyleObserver';\n\nconst DEBOUNCE = 50; // ms\n\n// Style observer that returns hex color value of the property\nexport default function useDynamicColorListener(\n  ref: React.RefObject<HTMLElement>,\n  property = 'color',\n  isDisabled?: boolean,\n) {\n  const value = useStyleObserver(ref, property, DEBOUNCE, isDisabled);\n  const hexColor = useMemo(() => (value ? prepareHexColor(value) : undefined), [value]);\n\n  return hexColor;\n}\n","type Parts = (string | false | undefined)[];\ntype PartsWithGlobals = (string | false | undefined | string[])[];\ntype ClassNameBuilder =\n  ((elementName: string, ...modifiers: PartsWithGlobals) => string)\n  & Record<string, string>;\n\nexport default function buildClassName(...parts: Parts) {\n  return parts.filter(Boolean).join(' ');\n}\n\nexport function createClassNameBuilder(componentName: string) {\n  return ((elementName: string, ...modifiers: PartsWithGlobals) => {\n    const baseName = elementName === '&' ? componentName : `${componentName}__${elementName}`;\n\n    return modifiers.reduce<string[]>((acc, modifier) => {\n      if (modifier) {\n        // A bit hacky way to pass global class names\n        if (Array.isArray(modifier)) {\n          acc.push(...modifier);\n        } else {\n          acc.push(`${baseName}--${modifier}`);\n        }\n      }\n\n      return acc;\n    }, [baseName]).join(' ');\n  }) as ClassNameBuilder;\n}\n","import type { FC } from '../../lib/teact/teact';\nimport React, { memo, useRef, useState } from '../../lib/teact/teact';\nimport { getGlobal } from '../../global';\n\nimport type { ObserveFn } from '../../hooks/useIntersectionObserver';\nimport { ApiMessageEntityTypes } from '../../api/types';\n\nimport { selectIsAlwaysHighPriorityEmoji } from '../../global/selectors';\nimport buildClassName from '../../util/buildClassName';\nimport safePlay from '../../util/safePlay';\n\nimport useDynamicColorListener from '../../hooks/stickers/useDynamicColorListener';\nimport useLastCallback from '../../hooks/useLastCallback';\nimport useCustomEmoji from './hooks/useCustomEmoji';\n\nimport Sparkles from './Sparkles';\nimport StickerView from './StickerView';\n\nimport styles from './CustomEmoji.module.scss';\n\nimport blankImg from '../../assets/blank.png';\n\ntype OwnProps = {\n  ref?: React.RefObject<HTMLDivElement>;\n  documentId: string;\n  className?: string;\n  style?: string;\n  size?: number;\n  isBig?: boolean;\n  noPlay?: boolean;\n  noVideoOnMobile?: boolean;\n  loopLimit?: number;\n  isSelectable?: boolean;\n  withSharedAnimation?: boolean;\n  sharedCanvasRef?: React.RefObject<HTMLCanvasElement>;\n  sharedCanvasHqRef?: React.RefObject<HTMLCanvasElement>;\n  withTranslucentThumb?: boolean;\n  shouldPreloadPreview?: boolean;\n  forceOnHeavyAnimation?: boolean;\n  forceAlways?: boolean;\n  observeIntersectionForLoading?: ObserveFn;\n  observeIntersectionForPlaying?: ObserveFn;\n  onClick?: NoneToVoidFunction;\n  onAnimationEnd?: NoneToVoidFunction;\n  withSparkles?: boolean;\n  sparklesClassName?: string;\n  sparklesStyle?: string;\n};\n\nconst STICKER_SIZE = 20;\n\nconst CustomEmoji: FC<OwnProps> = ({\n  ref,\n  documentId,\n  className,\n  style,\n  size = STICKER_SIZE,\n  isBig,\n  noPlay,\n  noVideoOnMobile,\n  loopLimit,\n  isSelectable,\n  withSharedAnimation,\n  sharedCanvasRef,\n  sharedCanvasHqRef,\n  withTranslucentThumb,\n  shouldPreloadPreview,\n  forceAlways,\n  forceOnHeavyAnimation,\n  observeIntersectionForLoading,\n  observeIntersectionForPlaying,\n  onClick,\n  onAnimationEnd,\n  withSparkles,\n  sparklesStyle,\n  sparklesClassName,\n}) => {\n  // eslint-disable-next-line no-null/no-null\n  let containerRef = useRef<HTMLDivElement>(null);\n  if (ref) {\n    containerRef = ref;\n  }\n\n  // An alternative to `withGlobal` to avoid adding numerous global containers\n  const { customEmoji, canPlay } = useCustomEmoji(documentId);\n\n  const loopCountRef = useRef(0);\n  const [shouldPlay, setShouldPlay] = useState(true);\n\n  const hasCustomColor = customEmoji?.shouldUseTextColor;\n  const customColor = useDynamicColorListener(containerRef, undefined, !hasCustomColor);\n\n  const handleVideoEnded = useLastCallback((e) => {\n    if (!loopLimit) return;\n\n    loopCountRef.current += 1;\n\n    if (loopCountRef.current >= loopLimit) {\n      setShouldPlay(false);\n      e.currentTarget.currentTime = 0;\n    } else {\n      // Loop manually\n      safePlay(e.currentTarget);\n    }\n  });\n\n  const handleStickerLoop = useLastCallback(() => {\n    if (!loopLimit) return;\n\n    loopCountRef.current += 1;\n\n    if (loopCountRef.current >= loopLimit) {\n      setShouldPlay(false);\n    }\n  });\n\n  const isHq = customEmoji?.stickerSetInfo && selectIsAlwaysHighPriorityEmoji(getGlobal(), customEmoji.stickerSetInfo);\n\n  return (\n    <div\n      ref={containerRef}\n      className={buildClassName(\n        styles.root,\n        withSparkles && styles.withSparkles,\n        className,\n        'custom-emoji',\n        'emoji',\n      )}\n      onClick={onClick}\n      onAnimationEnd={onAnimationEnd}\n      data-entity-type={ApiMessageEntityTypes.CustomEmoji}\n      data-document-id={documentId}\n      data-alt={customEmoji?.emoji}\n      style={style}\n    >\n      {withSparkles && (\n        <Sparkles\n          className={buildClassName(\n            styles.sparkles,\n            sparklesClassName,\n          )}\n          style={sparklesStyle}\n          preset=\"button\"\n        />\n      )}\n      {isSelectable && (\n        <img\n          className={styles.highlightCatch}\n          src={blankImg}\n          alt={customEmoji?.emoji}\n          data-entity-type={ApiMessageEntityTypes.CustomEmoji}\n          data-document-id={documentId}\n          draggable={false}\n        />\n      )}\n      {!customEmoji ? (\n        <div className={buildClassName(styles.placeholder)} draggable={false} />\n      ) : (\n        <StickerView\n          containerRef={containerRef}\n          sticker={customEmoji}\n          isSmall={!isBig}\n          size={size}\n          noPlay={noPlay || !(shouldPlay && canPlay)}\n          noVideoOnMobile={noVideoOnMobile}\n          thumbClassName={styles.thumb}\n          fullMediaClassName={styles.media}\n          shouldLoop\n          loopLimit={loopLimit}\n          shouldPreloadPreview={shouldPreloadPreview || noPlay || !canPlay}\n          forceOnHeavyAnimation={forceOnHeavyAnimation}\n          forceAlways={forceAlways}\n          observeIntersectionForLoading={observeIntersectionForLoading}\n          observeIntersectionForPlaying={observeIntersectionForPlaying}\n          withSharedAnimation={withSharedAnimation}\n          sharedCanvasRef={isHq ? sharedCanvasHqRef : sharedCanvasRef}\n          withTranslucentThumb={withTranslucentThumb}\n          onVideoEnded={handleVideoEnded}\n          onAnimatedStickerLoop={handleStickerLoop}\n          customColor={customColor}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default memo(CustomEmoji);\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"CEFe1FhH\",\"withSparkles\":\"yjv4Sc_e\",\"sparkles\":\"iOlUvSI8\",\"placeholder\":\"DKi1177s\",\"thumb\":\"O_TaDxWg\",\"media\":\"wqju02hR\",\"highlight-catch\":\"a8dMNkh3\",\"highlightCatch\":\"a8dMNkh3\"};","import { CONTENT_TYPES_WITH_PREVIEW } from '../config';\nimport { pause } from './schedulers';\n\n// Polyfill for Safari: `File` is not available in web worker\nif (typeof File === 'undefined') {\n  // eslint-disable-next-line no-global-assign, no-restricted-globals, func-names\n  self.File = class extends Blob {\n    name: string;\n\n    constructor(fileBits: BlobPart[], fileName: string, options?: FilePropertyBag) {\n      if (options) {\n        const { type, ...rest } = options;\n        super(fileBits, { type });\n        Object.assign(this, rest);\n      } else {\n        super(fileBits);\n      }\n\n      this.name = fileName;\n    }\n  } as typeof File;\n}\n\nexport function blobToDataUri(blob: Blob): Promise<string> {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n\n    reader.onload = (e: ProgressEvent<FileReader>) => {\n      const { result } = e.target || {};\n      if (typeof result === 'string') {\n        resolve(result);\n      }\n\n      reject(new Error('Failed to read blob'));\n    };\n\n    reader.onerror = reject;\n    reader.readAsDataURL(blob);\n  });\n}\n\nexport function blobToFile(blob: Blob, fileName: string) {\n  return new File([blob], fileName, {\n    lastModified: Date.now(),\n    type: blob.type,\n  });\n}\n\nexport function preloadImage(url: string): Promise<HTMLImageElement> {\n  return new Promise((resolve, reject) => {\n    const img = new Image();\n    img.onload = () => resolve(img);\n    img.onerror = reject;\n    img.src = url;\n  });\n}\n\nexport function preloadVideo(url: string): Promise<HTMLVideoElement> {\n  return new Promise((resolve, reject) => {\n    const video = document.createElement('video');\n    video.volume = 0;\n    video.onloadedmetadata = () => resolve(video);\n    video.onerror = reject;\n    video.src = url;\n  });\n}\n\nexport async function createPosterForVideo(url: string): Promise<string | undefined> {\n  try {\n    const video = await preloadVideo(url);\n\n    return await Promise.race([\n      pause(2000) as Promise<undefined>,\n      new Promise<string | undefined>((resolve, reject) => {\n        video.onseeked = () => {\n          if (!video.videoWidth || !video.videoHeight) {\n            resolve(undefined);\n          }\n\n          const canvas = document.createElement('canvas');\n          canvas.width = video.videoWidth;\n          canvas.height = video.videoHeight;\n          const ctx = canvas.getContext('2d')!;\n          ctx.drawImage(video, 0, 0);\n\n          canvas.toBlob((blob) => {\n            resolve(blob ? URL.createObjectURL(blob) : undefined);\n          });\n        };\n        video.onerror = reject;\n        video.currentTime = Math.min(video.duration, 1);\n      }),\n    ]);\n  } catch (e) {\n    return undefined;\n  }\n}\n\nexport async function fetchBlob(blobUrl: string) {\n  const response = await fetch(blobUrl);\n  return response.blob();\n}\n\nexport async function fetchFile(blobUrl: string, fileName: string) {\n  const blob = await fetchBlob(blobUrl);\n  return blobToFile(blob, fileName);\n}\n\nexport function imgToCanvas(img: HTMLImageElement) {\n  const canvas = document.createElement('canvas');\n  canvas.width = img.width;\n  canvas.height = img.height;\n\n  const ctx = canvas.getContext('2d')!;\n  ctx.drawImage(img, 0, 0);\n\n  return canvas;\n}\n\nexport function hasPreview(file: File) {\n  return CONTENT_TYPES_WITH_PREVIEW.has(file.type);\n}\n\nexport function validateFiles(files: File[] | FileList | null): File[] | undefined {\n  if (!files?.length) {\n    return undefined;\n  }\n  return Array.from(files).map(fixMovMime).filter((file) => file.size);\n}\n\n// .mov MIME type not reported sometimes https://developer.mozilla.org/en-US/docs/Web/API/File/type#sect1\nfunction fixMovMime(file: File) {\n  const ext = file.name.split('.').pop()!;\n  if (!file.type && ext.toLowerCase() === 'mov') {\n    return new File([file], file.name, { type: 'video/quicktime' });\n  }\n  return file;\n}\n","type CollectionByKey<Member> = Record<number | string, Member>;\n\ntype OrderDirection =\n  'asc'\n  | 'desc';\n\ninterface OrderCallback<T> {\n  (member: T): any;\n}\n\nexport function buildCollectionByKey<T extends AnyLiteral>(collection: T[], key: keyof T) {\n  return collection.reduce((byKey: CollectionByKey<T>, member: T) => {\n    byKey[member[key]] = member;\n\n    return byKey;\n  }, {});\n}\n\nexport function buildCollectionByCallback<T extends AnyLiteral, K extends number | string, R extends unknown>(\n  collection: T[],\n  callback: (member: T) => [K, R],\n) {\n  return collection.reduce((byKey: Record<K, R>, member: T) => {\n    const [key, value] = callback(member);\n    byKey[key] = value;\n\n    return byKey;\n  }, {} as Record<K, R>);\n}\n\nexport function mapValues<R extends any, M extends any>(\n  byKey: CollectionByKey<M>,\n  callback: (member: M, key: string, index: number, originalByKey: CollectionByKey<M>) => R,\n): CollectionByKey<R> {\n  return Object.keys(byKey).reduce((newByKey: CollectionByKey<R>, key, index) => {\n    newByKey[key] = callback(byKey[key], key, index, byKey);\n    return newByKey;\n  }, {});\n}\n\nexport function pick<T, K extends keyof T>(object: T, keys: K[]) {\n  return keys.reduce((result, key) => {\n    result[key] = object[key];\n    return result;\n  }, {} as Pick<T, K>);\n}\n\nexport function pickTruthy<T, K extends keyof T>(object: T, keys: K[]) {\n  return keys.reduce((result, key) => {\n    if (object[key]) {\n      result[key] = object[key];\n    }\n\n    return result;\n  }, {} as Pick<T, K>);\n}\n\nexport function omit<T extends object, K extends keyof T>(object: T, keys: K[]): Omit<T, K> {\n  const stringKeys = new Set(keys.map(String));\n  const savedKeys = Object.keys(object)\n    .filter((key) => !stringKeys.has(key)) as Array<Exclude<keyof T, K>>;\n\n  return pick(object, savedKeys);\n}\n\nexport function omitUndefined<T extends object>(object: T): T {\n  return Object.keys(object).reduce((result, stringKey) => {\n    const key = stringKey as keyof T;\n    if (object[key] !== undefined) {\n      result[key as keyof T] = object[key];\n    }\n    return result;\n  }, {} as T);\n}\n\nexport function orderBy<T>(\n  collection: T[],\n  orderRule: (keyof T) | OrderCallback<T> | ((keyof T) | OrderCallback<T>)[],\n  mode: OrderDirection | [OrderDirection, OrderDirection] = 'asc',\n): T[] {\n  function compareValues(a: T, b: T, currentOrderRule: (keyof T) | OrderCallback<T>, isAsc: boolean) {\n    const aValue = (typeof currentOrderRule === 'function' ? currentOrderRule(a) : a[currentOrderRule]) || 0;\n    const bValue = (typeof currentOrderRule === 'function' ? currentOrderRule(b) : b[currentOrderRule]) || 0;\n\n    return isAsc ? aValue - bValue : bValue - aValue;\n  }\n\n  if (Array.isArray(orderRule)) {\n    const [mode1, mode2] = Array.isArray(mode) ? mode : [mode, mode];\n    const [orderRule1, orderRule2] = orderRule;\n    const isAsc1 = mode1 === 'asc';\n    const isAsc2 = mode2 === 'asc';\n\n    return collection.sort((a, b) => {\n      return compareValues(a, b, orderRule1, isAsc1) || compareValues(a, b, orderRule2, isAsc2);\n    });\n  }\n\n  const isAsc = mode === 'asc';\n  return collection.sort((a, b) => {\n    return compareValues(a, b, orderRule, isAsc);\n  });\n}\n\nexport function unique<T extends any>(array: T[]): T[] {\n  return Array.from(new Set(array));\n}\n\nexport function uniqueByField<T extends any>(array: T[], field: keyof T): T[] {\n  return [...new Map(array.map((item) => [item[field], item])).values()];\n}\n\nexport function compact<T extends any>(array: T[]) {\n  return array.filter(Boolean);\n}\n\nexport function areSortedArraysEqual(array1: any[], array2: any[]) {\n  if (array1.length !== array2.length) {\n    return false;\n  }\n\n  return array1.every((item, i) => item === array2[i]);\n}\n\nexport function areSortedArraysIntersecting(array1: any[], array2: any[]) {\n  return array1[0] <= array2[array2.length - 1] && array1[array1.length - 1] >= array2[0];\n}\nexport function isInsideSortedArrayRange(value:any, array: any[]) {\n  return array[0] <= value && value <= array[array.length - 1];\n}\n\nexport function findIntersectionWithSet<T>(array: T[], set: Set<T>): T[] {\n  return array.filter((a) => set.has(a));\n}\n/**\n * Exlude elements from base array. Both arrays should be sorted in same order\n * @param base\n * @param toExclude\n * @returns New array without excluded elements\n */\nexport function excludeSortedArray<T extends any>(base: T[], toExclude: T[]) {\n  if (!base?.length) return base;\n\n  const result: T[] = [];\n\n  let excludeIndex = 0;\n\n  for (let i = 0; i < base.length; i++) {\n    if (toExclude[excludeIndex] === base[i]) {\n      excludeIndex += 1;\n    } else {\n      result.push(base[i]);\n    }\n  }\n\n  return result;\n}\n\nexport function split<T extends any>(array: T[], chunkSize: number) {\n  const result: T[][] = [];\n  for (let i = 0; i < array.length; i += chunkSize) {\n    result.push(array.slice(i, i + chunkSize));\n  }\n\n  return result;\n}\n\nexport function partition<T extends unknown>(\n  array: T[], filter: (value: T, index: number, array: T[]) => boolean | undefined,\n): [T[], T[]] {\n  const pass: T[] = [];\n  const fail: T[] = [];\n\n  array.forEach((e, idx, arr) => (filter(e, idx, arr) ? pass : fail).push(e));\n\n  return [pass, fail];\n}\n\nexport function cloneDeep<T>(value: T): T {\n  if (!isObject(value)) {\n    return value;\n  }\n\n  if (Array.isArray(value)) {\n    return value.map(cloneDeep) as typeof value;\n  }\n\n  return Object.keys(value).reduce((acc, key) => {\n    acc[key as keyof T] = cloneDeep(value[key as keyof T]);\n    return acc;\n  }, {} as T);\n}\n\nexport function isLiteralObject(value: any): value is AnyLiteral {\n  return isObject(value) && !Array.isArray(value);\n}\n\nfunction isObject(value: any): value is object {\n  // eslint-disable-next-line no-null/no-null\n  return typeof value === 'object' && value !== null;\n}\n\nexport function findLast<T>(array: Array<T>, predicate: (value: T, index: number, obj: T[]) => boolean): T | undefined {\n  let cursor = array.length;\n\n  while (cursor--) {\n    if (predicate(array[cursor], cursor, array)) {\n      return array[cursor];\n    }\n  }\n\n  return undefined;\n}\n\nexport function compareFields<T>(a: T, b: T) {\n  return Number(b) - Number(a);\n}\n","import type { ThreadId, TopicsInfo } from '../../types';\nimport type { GlobalState } from '../types';\n\nexport function selectTopicsInfo<T extends GlobalState>(global: T, chatId: string): TopicsInfo | undefined {\n  return global.chats.topicsInfoById[chatId];\n}\n\nexport function selectTopics<T extends GlobalState>(global: T, chatId: string) {\n  return selectTopicsInfo(global, chatId)?.topicsById;\n}\n\nexport function selectTopic<T extends GlobalState>(global: T, chatId: string, threadId: ThreadId) {\n  return selectTopicsInfo(global, chatId)?.topicsById?.[threadId];\n}\n","type RLottieClass = typeof import('./RLottie').default;\n\nlet promise: Promise<RLottieClass>;\nlet RLottie: RLottieClass;\n\n// Time for the main interface to completely load\nconst LOTTIE_LOAD_DELAY = 3000;\n\nexport async function ensureRLottie() {\n  if (!promise) {\n    promise = import('./RLottie').then((module) => module.default);\n    RLottie = await promise;\n  }\n\n  return promise;\n}\n\nexport function getRLottie() {\n  return RLottie;\n}\n\nsetTimeout(ensureRLottie, LOTTIE_LOAD_DELAY);\n","import { addCallback } from '../../../lib/teact/teactn';\n\nimport type { LangCode } from '../../../types';\nimport type { ActionReturnType, GlobalState } from '../../types';\n\nimport { requestMutation } from '../../../lib/fasterdom/fasterdom';\nimport { IS_MULTIACCOUNT_SUPPORTED } from '../../../util/browser/globalEnvironment';\nimport {\n  IS_ANDROID, IS_ELECTRON, IS_IOS, IS_LINUX,\n  IS_MAC_OS, IS_SAFARI, IS_TOUCH_ENV, IS_WINDOWS,\n} from '../../../util/browser/windowEnvironment';\nimport { getCurrentTabId } from '../../../util/establishMultitabRole';\nimport { subscribe, unsubscribe } from '../../../util/notifications';\nimport { oldSetLanguage } from '../../../util/oldLangProvider';\nimport { decryptSessionByCurrentHash } from '../../../util/passcode';\nimport { applyPerformanceSettings } from '../../../util/perfomanceSettings';\nimport { hasStoredSession, storeSession } from '../../../util/sessions';\nimport switchTheme from '../../../util/switchTheme';\nimport { getSystemTheme, setSystemThemeChangeCallback } from '../../../util/systemTheme';\nimport { startWebsync, stopWebsync } from '../../../util/websync';\nimport { callApi } from '../../../api/gramjs';\nimport { clearCaching, setupCaching } from '../../cache';\nimport { addActionHandler, getGlobal, setGlobal } from '../../index';\nimport { updateSharedSettings } from '../../reducers';\nimport { updateTabState } from '../../reducers/tabs';\nimport {\n  selectCanAnimateInterface,\n  selectPerformanceSettings,\n  selectSettingsKeys,\n  selectTabState,\n  selectTheme,\n} from '../../selectors';\nimport { selectSharedSettings } from '../../selectors/sharedState';\nimport { destroySharedStatePort, initSharedState } from '../../shared/sharedStateConnector';\n\nconst HISTORY_ANIMATION_DURATION = 450;\n\nsetSystemThemeChangeCallback((theme) => {\n  // eslint-disable-next-line eslint-multitab-tt/no-immediate-global\n  let global = getGlobal();\n\n  if (!global.isInited || !selectSharedSettings(global).shouldUseSystemTheme) return;\n\n  global = updateSharedSettings(global, { theme });\n  setGlobal(global);\n});\n\naddActionHandler('switchMultitabRole', async (global, actions, payload): Promise<void> => {\n  const { isMasterTab, tabId = getCurrentTabId() } = payload;\n\n  if (isMasterTab === selectTabState(global, tabId).isMasterTab) {\n    callApi('broadcastLocalDbUpdateFull');\n    return;\n  }\n\n  global = updateTabState(global, {\n    isMasterTab,\n  }, tabId);\n  setGlobal(global, { forceSyncOnIOs: true });\n\n  if (!isMasterTab) {\n    void unsubscribe();\n    actions.destroyConnection();\n    stopWebsync();\n    destroySharedStatePort();\n    clearCaching();\n    actions.onSomeTabSwitchedMultitabRole();\n  } else {\n    if (global.passcode.hasPasscode && !global.passcode.isScreenLocked) {\n      const { sessionJson } = await decryptSessionByCurrentHash();\n      const session = JSON.parse(sessionJson);\n      storeSession(session);\n    }\n\n    if (hasStoredSession()) {\n      setupCaching();\n    }\n\n    global = getGlobal();\n    if (!global.passcode.hasPasscode || !global.passcode.isScreenLocked) {\n      if (global.connectionState === 'connectionStateReady') {\n        global = {\n          ...global,\n          connectionState: 'connectionStateConnecting',\n        };\n        setGlobal(global);\n      }\n      actions.initApi();\n    }\n\n    startWebsync();\n    if (IS_MULTIACCOUNT_SUPPORTED) {\n      initSharedState(global.sharedState);\n    }\n  }\n});\n\naddActionHandler('onSomeTabSwitchedMultitabRole', async (global): Promise<void> => {\n  if (global.passcode.hasPasscode && !global.passcode.isScreenLocked) {\n    const { sessionJson } = await decryptSessionByCurrentHash();\n    const session = JSON.parse(sessionJson);\n    storeSession(session);\n  }\n\n  callApi('broadcastLocalDbUpdateFull');\n});\n\naddActionHandler('initShared', (): ActionReturnType => {\n  startWebsync();\n});\n\naddActionHandler('initMain', (global): ActionReturnType => {\n  const { hasWebNotifications, hasPushNotifications } = selectSettingsKeys(global);\n  if (hasWebNotifications && hasPushNotifications) {\n    // Most of the browsers only show the notifications permission prompt after the first user gesture.\n    const events = ['click', 'keypress'];\n    const subscribeAfterUserGesture = () => {\n      void subscribe();\n      events.forEach((event) => {\n        document.removeEventListener(event, subscribeAfterUserGesture);\n      });\n    };\n    events.forEach((event) => {\n      document.addEventListener(event, subscribeAfterUserGesture, { once: true });\n    });\n  }\n});\n\naddCallback((global: GlobalState) => {\n  let isUpdated = false;\n  const tabState = selectTabState(global, getCurrentTabId());\n  if (!tabState?.shouldInit) return;\n\n  global = getGlobal();\n\n  global = updateTabState(global, {\n    shouldInit: false,\n  }, tabState.id);\n\n  const { messageTextSize, language, shouldUseSystemTheme } = selectSharedSettings(global);\n\n  const globalTheme = selectTheme(global);\n  const systemTheme = getSystemTheme();\n  const theme = shouldUseSystemTheme ? systemTheme : globalTheme;\n\n  const performanceType = selectPerformanceSettings(global);\n\n  void oldSetLanguage(language as LangCode, undefined, true);\n\n  requestMutation(() => {\n    document.documentElement.style.setProperty(\n      '--composer-text-size', `${Math.max(messageTextSize, IS_IOS ? 16 : 15)}px`,\n    );\n    document.documentElement.style.setProperty('--message-meta-height', `${Math.floor(messageTextSize * 1.3125)}px`);\n    document.documentElement.style.setProperty('--message-text-size', `${messageTextSize}px`);\n    document.documentElement.setAttribute('data-message-text-size', messageTextSize.toString());\n    document.body.classList.add('initial');\n    document.body.classList.add(IS_TOUCH_ENV ? 'is-touch-env' : 'is-pointer-env');\n    applyPerformanceSettings(performanceType);\n\n    if (IS_IOS) {\n      document.body.classList.add('is-ios');\n    } else if (IS_ANDROID) {\n      document.body.classList.add('is-android');\n    } else if (IS_MAC_OS) {\n      document.body.classList.add('is-macos');\n    } else if (IS_WINDOWS) {\n      document.body.classList.add('is-windows');\n    } else if (IS_LINUX) {\n      document.body.classList.add('is-linux');\n    }\n    if (IS_SAFARI) {\n      document.body.classList.add('is-safari');\n    }\n    if (IS_ELECTRON) {\n      document.body.classList.add('is-electron');\n    }\n  });\n\n  const canAnimate = selectCanAnimateInterface(global);\n\n  switchTheme(theme, canAnimate);\n  // Make sure global has the latest theme. Will cause `switchTheme` on change\n  global = updateSharedSettings(global, { theme });\n\n  startWebsync();\n\n  isUpdated = true;\n\n  if (isUpdated) setGlobal(global);\n});\n\naddActionHandler('setInstallPrompt', (global, actions, payload): ActionReturnType => {\n  const { canInstall, tabId = getCurrentTabId() } = payload;\n  return updateTabState(global, {\n    canInstall,\n  }, tabId);\n});\n\naddActionHandler('setIsUiReady', (global, actions, payload): ActionReturnType => {\n  const { uiReadyState, tabId = getCurrentTabId() } = payload!;\n\n  if (uiReadyState === 2) {\n    requestMutation(() => {\n      document.body.classList.remove('initial');\n    });\n  }\n\n  return updateTabState(global, {\n    uiReadyState,\n  }, tabId);\n});\n\naddActionHandler('setAuthPhoneNumber', (global, actions, payload): ActionReturnType => {\n  const { phoneNumber } = payload!;\n\n  return {\n    ...global,\n    authPhoneNumber: phoneNumber,\n  };\n});\n\naddActionHandler('setAuthRememberMe', (global, actions, payload): ActionReturnType => {\n  return {\n    ...global,\n    authRememberMe: Boolean(payload),\n  };\n});\n\naddActionHandler('clearAuthErrorKey', (global): ActionReturnType => {\n  return {\n    ...global,\n    authErrorKey: undefined,\n  };\n});\n\naddActionHandler('disableHistoryAnimations', (global, actions, payload): ActionReturnType => {\n  const { tabId = getCurrentTabId() } = payload || {};\n\n  setTimeout(() => {\n    global = getGlobal();\n    global = updateTabState(global, {\n      shouldSkipHistoryAnimations: false,\n    }, tabId);\n    setGlobal(global);\n\n    requestMutation(() => {\n      document.body.classList.remove('no-animate');\n    });\n  }, HISTORY_ANIMATION_DURATION);\n\n  global = updateTabState(global, {\n    shouldSkipHistoryAnimations: true,\n  }, tabId);\n  setGlobal(global, { forceSyncOnIOs: true });\n});","import type { TeactNode } from '../lib/teact/teact';\n\nimport type {\n  ApiAttachment,\n  ApiBotInlineMediaResult,\n  ApiBotInlineResult,\n  ApiBotInlineSwitchPm,\n  ApiBotInlineSwitchWebview,\n  ApiChat,\n  ApiChatInviteImporter,\n  ApiContact,\n  ApiDisallowedGiftsSettings,\n  ApiDocument,\n  ApiDraft,\n  ApiExportedInvite,\n  ApiFakeType,\n  ApiFormattedText,\n  ApiInputReplyInfo,\n  ApiLabeledPrice,\n  ApiLanguage,\n  ApiMediaFormat,\n  ApiMessage,\n  ApiMessageEntity,\n  ApiNewPoll,\n  ApiPeer,\n  ApiPhoto,\n  ApiReaction,\n  ApiReactionWithPaid,\n  ApiStarGiftRegular,\n  ApiStarsSubscription,\n  ApiStarsTransaction,\n  ApiSticker,\n  ApiStickerSet,\n  ApiStory,\n  ApiStorySkipped,\n  ApiThreadInfo,\n  ApiTopic,\n  ApiTypingStatus,\n  ApiVideo,\n} from '../api/types';\nimport type { DC_IDS } from '../config';\nimport type { SearchResultKey } from '../util/keys/searchResultKey';\nimport type { IconName } from './icons';\n\nexport type TextPart = TeactNode;\n\nexport type DcId = typeof DC_IDS[number];\n\nexport type SessionUserInfo = {\n  userId?: string;\n  firstName?: string;\n  lastName?: string;\n  phone?: string;\n  avatarUri?: string;\n  color?: number;\n  isPremium?: boolean;\n  emojiStatusId?: string;\n};\n\nexport type SharedSessionData = {\n  date?: number;\n  dcId: number;\n  isTest?: true;\n} & {\n  [K in `dc${DcId}_${'auth_key' | 'server_salt'}`]?: string;\n} & SessionUserInfo;\n\nexport type AccountInfo = {\n  isTest?: true;\n} & SessionUserInfo;\n\nexport enum LoadMoreDirection {\n  Backwards,\n  Forwards,\n  Around,\n}\n\nexport enum FocusDirection {\n  Up,\n  Down,\n  Static,\n}\n\nexport type ScrollTargetPosition = ScrollLogicalPosition | 'centerOrTop';\n\nexport interface IAlbum {\n  albumId: string;\n  messages: ApiMessage[];\n  isPaidMedia?: boolean;\n  mainMessage: ApiMessage;\n  captionMessage?: ApiMessage;\n  hasMultipleCaptions: boolean;\n  commentsMessage?: ApiMessage;\n}\n\nexport type ThreadId = string | number;\n\nexport type ThemeKey = 'light' | 'dark';\nexport type AnimationLevel = 0 | 1 | 2;\nexport type PerformanceTypeKey = (\n  'pageTransitions' | 'messageSendingAnimations' | 'mediaViewerAnimations'\n  | 'messageComposerAnimations' | 'contextMenuAnimations' | 'contextMenuBlur' | 'rightColumnAnimations'\n  | 'animatedEmoji' | 'loopAnimatedStickers' | 'reactionEffects' | 'stickerEffects' | 'autoplayGifs' | 'autoplayVideos'\n  | 'storyRibbonAnimations' | 'snapEffect'\n);\nexport type PerformanceType = {\n  [key in PerformanceTypeKey]: boolean;\n};\n\nexport interface IThemeSettings {\n  background?: string;\n  backgroundColor?: string;\n  patternColor?: string;\n  isBlurred?: boolean;\n}\n\nexport type LangCode = (\n  'en' | 'ar' | 'be' | 'ca' | 'nl' | 'fr' | 'de' | 'id' | 'it' | 'ko' | 'ms' | 'fa' | 'pl' | 'pt-br' | 'ru' | 'es'\n  | 'tr' | 'uk' | 'uz'\n);\n\nexport type TimeFormat = '24h' | '12h';\n\nexport interface AccountSettings {\n  hasWebNotifications: boolean;\n  hasPushNotifications: boolean;\n  hasContactJoinedNotifications?: boolean;\n  notificationSoundVolume: number;\n  canAutoLoadPhotoFromContacts: boolean;\n  canAutoLoadPhotoInPrivateChats: boolean;\n  canAutoLoadPhotoInGroups: boolean;\n  canAutoLoadPhotoInChannels: boolean;\n  canAutoLoadVideoFromContacts: boolean;\n  canAutoLoadVideoInPrivateChats: boolean;\n  canAutoLoadVideoInGroups: boolean;\n  canAutoLoadVideoInChannels: boolean;\n  canAutoLoadFileFromContacts: boolean;\n  canAutoLoadFileInPrivateChats: boolean;\n  canAutoLoadFileInGroups: boolean;\n  canAutoLoadFileInChannels: boolean;\n  autoLoadFileMaxSizeMb: number;\n  shouldSuggestStickers: boolean;\n  shouldSuggestCustomEmoji: boolean;\n  shouldUpdateStickerSetOrder: boolean;\n  hasPassword?: boolean;\n  isSensitiveEnabled?: boolean;\n  canChangeSensitive?: boolean;\n  shouldArchiveAndMuteNewNonContact?: boolean;\n  shouldNewNonContactPeersRequirePremium?: boolean;\n  nonContactPeersPaidStars?: number;\n  shouldDisplayGiftsButton?: boolean;\n  disallowedGifts?: ApiDisallowedGiftsSettings;\n  shouldHideReadMarks?: boolean;\n  canTranslate: boolean;\n  canTranslateChats: boolean;\n  translationLanguage?: string;\n  doNotTranslate: string[];\n  shouldPaidMessageAutoApprove: boolean;\n  autoTranslate?:boolean;\n  autoTranslateLanguage?: string;\n}\n\nexport interface SharedSettings {\n  shouldUseSystemTheme: boolean;\n  theme: ThemeKey;\n  themes: Partial<Record<ThemeKey, IThemeSettings>>;\n  language: string;\n  languages?: ApiLanguage[];\n  performance: PerformanceType;\n  messageTextSize: number;\n  animationLevel: AnimationLevel;\n  messageSendKeyCombo: 'enter' | 'ctrl-enter';\n  miniAppsCachedPosition?: Point;\n  miniAppsCachedSize?: Size;\n  timeFormat: TimeFormat;\n  wasTimeFormatSetManually: boolean;\n  isConnectionStatusMinimized: boolean;\n  canDisplayChatInTitle: boolean;\n  shouldForceHttpTransport?: boolean;\n  shouldAllowHttpTransport?: boolean;\n  shouldCollectDebugLogs?: boolean;\n  shouldDebugExportedSenders?: boolean;\n  shouldWarnAboutSvg?: boolean;\n  shouldSkipWebAppCloseConfirmation: boolean;\n  hasContactJoinedNotifications?: boolean;\n  hasWebNotifications: boolean;\n  hasPushNotifications: boolean;\n  notificationSoundVolume: number;\n}\n\nexport type IAnchorPosition = {\n  x: number;\n  y: number;\n};\n\nexport interface ShippingOption {\n  id: string;\n  title: string;\n  amount: number;\n  prices: ApiLabeledPrice[];\n}\n\nexport enum SettingsScreens {\n  Main,\n  EditProfile,\n  Notifications,\n  DataStorage,\n  Language,\n  ActiveSessions,\n  General,\n  GeneralChatBackground,\n  GeneralChatBackgroundColor,\n  Privacy,\n  PrivacyPhoneNumber,\n  PrivacyAddByPhone,\n  PrivacyLastSeen,\n  PrivacyProfilePhoto,\n  PrivacyBio,\n  PrivacyBirthday,\n  PrivacyGifts,\n  PrivacyPhoneCall,\n  PrivacyPhoneP2P,\n  PrivacyForwarding,\n  PrivacyVoiceMessages,\n  PrivacyMessages,\n  PrivacyGroupChats,\n  PrivacyPhoneNumberAllowedContacts,\n  PrivacyPhoneNumberDeniedContacts,\n  PrivacyLastSeenAllowedContacts,\n  PrivacyLastSeenDeniedContacts,\n  PrivacyProfilePhotoAllowedContacts,\n  PrivacyProfilePhotoDeniedContacts,\n  PrivacyBioAllowedContacts,\n  PrivacyBioDeniedContacts,\n  PrivacyBirthdayAllowedContacts,\n  PrivacyBirthdayDeniedContacts,\n  PrivacyGiftsAllowedContacts,\n  PrivacyGiftsDeniedContacts,\n  PrivacyPhoneCallAllowedContacts,\n  PrivacyPhoneCallDeniedContacts,\n  PrivacyPhoneP2PAllowedContacts,\n  PrivacyPhoneP2PDeniedContacts,\n  PrivacyForwardingAllowedContacts,\n  PrivacyForwardingDeniedContacts,\n  PrivacyVoiceMessagesAllowedContacts,\n  PrivacyVoiceMessagesDeniedContacts,\n  PrivacyGroupChatsAllowedContacts,\n  PrivacyGroupChatsDeniedContacts,\n  PrivacyBlockedUsers,\n  PrivacyNoPaidMessages,\n  Performance,\n  Folders,\n  FoldersCreateFolder,\n  FoldersEditFolder,\n  FoldersEditFolderFromChatList,\n  FoldersEditFolderInvites,\n  FoldersIncludedChats,\n  FoldersIncludedChatsFromChatList,\n  FoldersExcludedChats,\n  FoldersExcludedChatsFromChatList,\n  TwoFaDisabled,\n  TwoFaNewPassword,\n  TwoFaNewPasswordConfirm,\n  TwoFaNewPasswordHint,\n  TwoFaNewPasswordEmail,\n  TwoFaNewPasswordEmailCode,\n  TwoFaEnabled,\n  TwoFaChangePasswordCurrent,\n  TwoFaChangePasswordNew,\n  TwoFaChangePasswordConfirm,\n  TwoFaChangePasswordHint,\n  TwoFaTurnOff,\n  TwoFaRecoveryEmailCurrentPassword,\n  TwoFaRecoveryEmail,\n  TwoFaRecoveryEmailCode,\n  TwoFaCongratulations,\n  ActiveWebsites,\n  PasscodeDisabled,\n  PasscodeNewPasscode,\n  PasscodeNewPasscodeConfirm,\n  PasscodeEnabled,\n  PasscodeChangePasscodeCurrent,\n  PasscodeChangePasscodeNew,\n  PasscodeChangePasscodeConfirm,\n  PasscodeTurnOff,\n  PasscodeCongratulations,\n  Experimental,\n  Stickers,\n  QuickReaction,\n  CustomEmoji,\n  DoNotTranslate,\n  FoldersShare,\n}\n\nexport type StickerSetOrReactionsSetOrRecent = Pick<ApiStickerSet, (\n  'id' | 'accessHash' | 'title' | 'count' | 'stickers' | 'isEmoji' | 'installedDate' | 'isArchived' |\n  'hasThumbnail' | 'hasStaticThumb' | 'hasAnimatedThumb' | 'hasVideoThumb' | 'thumbCustomEmojiId'\n)> & { reactions?: ApiReactionWithPaid[] };\n\nexport enum LeftColumnContent {\n  ChatList,\n  AIKonwledge,\n  AITranslate,\n  GlobalSearch,\n  Settings,\n  Contacts,\n  Archived,\n  NewChannelStep1,\n  NewChannelStep2,\n  NewGroupStep1,\n  NewGroupStep2,\n}\n\nexport enum GlobalSearchContent {\n  ChatList,\n  ChannelList,\n  BotApps,\n  Media,\n  Links,\n  Files,\n  Music,\n  Voice,\n  AI,\n}\n\nexport enum RightColumnContent {\n  ChatInfo,\n  Management,\n  Statistics,\n  BoostStatistics,\n  MessageStatistics,\n  StoryStatistics,\n  StickerSearch,\n  GifSearch,\n  PollResults,\n  AddingMembers,\n  CreateTopic,\n  EditTopic,\n  MonetizationStatistics,\n  ChatAI,\n}\n\nexport type MediaViewerMedia = ApiPhoto | ApiVideo | ApiDocument;\n\nexport enum MediaViewerOrigin {\n  Inline,\n  ScheduledInline,\n  SharedMedia,\n  ProfileAvatar,\n  SettingsAvatar,\n  MiddleHeaderAvatar,\n  Album,\n  ScheduledAlbum,\n  SearchResult,\n  ChannelAvatar,\n  SuggestedAvatar,\n  StarsTransaction,\n  PreviewMedia,\n  SponsoredMessage,\n}\n\nexport enum StoryViewerOrigin {\n  StoryRibbon,\n  MiddleHeaderAvatar,\n  ChatList,\n  SearchResult,\n}\n\nexport enum AudioOrigin {\n  Inline,\n  SharedMedia,\n  Search,\n  OneTimeModal,\n}\n\nexport enum ChatCreationProgress {\n  Idle,\n  InProgress,\n  Complete,\n  Error,\n}\n\nexport enum ProfileEditProgress {\n  Idle,\n  InProgress,\n  Complete,\n  Error,\n}\n\nexport enum ManagementProgress {\n  Idle,\n  InProgress,\n  Complete,\n  Error,\n}\n\nexport interface ManagementState {\n  isActive: boolean;\n  nextScreen?: ManagementScreens;\n  checkedUsername?: string;\n  isUsernameAvailable?: boolean;\n  error?: string;\n  invites?: ApiExportedInvite[];\n  revokedInvites?: ApiExportedInvite[];\n  editingInvite?: ApiExportedInvite;\n  inviteInfo?: {\n    invite: ApiExportedInvite;\n    importers?: ApiChatInviteImporter[];\n    requesters?: ApiChatInviteImporter[];\n  };\n}\n\nexport enum NewChatMembersProgress {\n  Closed,\n  InProgress,\n  Loading,\n}\n\nexport type ProfileTabType =\n  | 'members'\n  | 'commonChats'\n  | 'media'\n  | 'previewMedia'\n  | 'documents'\n  | 'links'\n  | 'audio'\n  | 'voice'\n  | 'stories'\n  | 'storiesArchive'\n  | 'similarChannels'\n  | 'similarBots'\n  | 'dialogs'\n  | 'gifts';\nexport type SharedMediaType = 'media' | 'documents' | 'links' | 'audio' | 'voice';\nexport type MiddleSearchType = 'chat' | 'myChats' | 'channels';\nexport type MiddleSearchParams = {\n  requestedQuery?: string;\n  savedTag?: ApiReaction;\n  isHashtag?: boolean;\n  fetchingQuery?: string;\n  type: MiddleSearchType;\n  results?: MiddleSearchResults;\n};\nexport type MiddleSearchResults = {\n  query: string;\n  totalCount?: number;\n  nextOffsetId?: number;\n  nextOffsetPeerId?: string;\n  nextOffsetRate?: number;\n  foundIds?: SearchResultKey[];\n};\n\nexport interface LoadingState {\n  areAllItemsLoadedForwards: boolean;\n  areAllItemsLoadedBackwards: boolean;\n}\n\nexport interface ChatMediaSearchSegment {\n  foundIds: number[];\n  loadingState: LoadingState;\n}\n\nexport interface ChatMediaSearchParams {\n  currentSegment: ChatMediaSearchSegment;\n  segments: ChatMediaSearchSegment[];\n  isLoading: boolean;\n}\n\nexport enum ProfileState {\n  Profile,\n  SharedMedia,\n  MemberList,\n  GiftList,\n  StoryList,\n  SavedDialogs,\n}\n\nexport enum PaymentStep {\n  Checkout,\n  SavedPayments,\n  ConfirmPassword,\n  PaymentInfo,\n  ShippingInfo,\n  Shipping,\n  ConfirmPayment,\n}\n\nexport const UPLOADING_WALLPAPER_SLUG = 'UPLOADING_WALLPAPER_SLUG';\n\nexport enum ManagementScreens {\n  Initial,\n  ChatPrivacyType,\n  Discussion,\n  ChannelSubscribers,\n  GroupType,\n  GroupPermissions,\n  GroupRemovedUsers,\n  ChannelRemovedUsers,\n  GroupUserPermissionsCreate,\n  GroupUserPermissions,\n  ChatAdministrators,\n  GroupRecentActions,\n  ChatAdminRights,\n  ChatNewAdminRights,\n  GroupMembers,\n  GroupAddAdmins,\n  Invites,\n  EditInvite,\n  Reactions,\n  InviteInfo,\n  JoinRequests,\n}\n\nexport type ManagementType = 'user' | 'group' | 'channel' | 'bot';\n\nexport type EmojiKeywords = {\n  isLoading?: boolean;\n  version?: number;\n  keywords?: Record<string, string[]>;\n};\n\nexport type InlineBotSettings = {\n  id: string;\n  help?: string;\n  query?: string;\n  offset?: string;\n  canLoadMore?: boolean;\n  results?: (ApiBotInlineResult | ApiBotInlineMediaResult)[];\n  isGallery?: boolean;\n  switchPm?: ApiBotInlineSwitchPm;\n  switchWebview?: ApiBotInlineSwitchWebview;\n  cacheTime: number;\n};\n\nexport type CustomPeerType = 'premium' | 'toBeDistributed' | 'contacts' | 'nonContacts'\n| 'groups' | 'channels' | 'bots' | 'excludeMuted' | 'excludeArchived' | 'excludeRead' | 'stars';\n\nexport type CustomPeer = {\n  isCustomPeer: true;\n  key?: string | number;\n  subtitleKey?: string;\n  avatarIcon?: IconName;\n  isAvatarSquare?: boolean;\n  peerColorId?: number;\n  isVerified?: boolean;\n  fakeType?: ApiFakeType;\n  emojiStatusId?: string;\n  customPeerAvatarColor?: string;\n  withPremiumGradient?: boolean;\n  isPremium?: boolean;\n} & ({\n  titleKey: string;\n  title?: undefined;\n} | {\n  title: string;\n  titleKey?: undefined;\n});\n\nexport type UniqueCustomPeer<T = CustomPeerType> = CustomPeer & {\n  type: T;\n};\n\nexport type MessageListType =\n  'thread'\n  | 'pinned'\n  | 'scheduled';\n\nexport type ChatListType = 'active' | 'archived' | 'saved';\n\nexport interface MessageList {\n  chatId: string;\n  threadId: ThreadId;\n  type: MessageListType;\n}\n\nexport interface ActiveEmojiInteraction {\n  id: number;\n  x: number;\n  y: number;\n  messageId?: number;\n  startSize?: number;\n  animatedEffect?: string;\n  isReversed?: boolean;\n}\n\nexport type ActiveDownloads = Record<string, {\n  format: ApiMediaFormat;\n  filename: string;\n  size: number;\n  originChatId?: string;\n  originMessageId?: number;\n}>;\n\nexport type IDimensions = {\n  width: number;\n  height: number;\n};\n\nexport type StarsTransactionType = 'all' | 'inbound' | 'outbound';\nexport type StarsTransactionHistory = Record<StarsTransactionType, {\n  transactions: ApiStarsTransaction[];\n  nextOffset?: string;\n} | undefined>;\nexport type StarsSubscriptions = {\n  list: ApiStarsSubscription[];\n  nextOffset?: string;\n  isLoading?: boolean;\n};\n\nexport type ConfettiStyle = 'poppers' | 'top-down';\n\nexport type StarGiftInfo = {\n  peerId: string;\n  gift: ApiStarGiftRegular;\n  shouldHideName?: boolean;\n  message?: ApiFormattedText;\n  shouldUpgrade?: boolean;\n};\n\nexport interface TabThread {\n  scrollOffset?: number;\n  replyStack?: number[];\n  viewportIds?: number[];\n}\n\nexport interface Thread {\n  lastScrollOffset?: number;\n  lastViewportIds?: number[];\n  listedIds?: number[];\n  outlyingLists?: number[][];\n  pinnedIds?: number[];\n  scheduledIds?: number[];\n  editingId?: number;\n  editingScheduledId?: number;\n  editingDraft?: ApiFormattedText;\n  editingScheduledDraft?: ApiFormattedText;\n  draft?: ApiDraft;\n  noWebPage?: boolean;\n  threadInfo?: ApiThreadInfo;\n  firstMessageId?: number;\n  typingStatus?: ApiTypingStatus;\n}\n\nexport interface ServiceNotification {\n  id: number;\n  message: ApiMessage;\n  version?: string;\n  isUnread?: boolean;\n  isDeleted?: boolean;\n}\n\nexport interface TopicsInfo {\n  totalCount: number;\n  topicsById: Record<ThreadId, ApiTopic>;\n  listedTopicIds?: number[];\n  orderedPinnedTopicIds?: number[];\n}\n\nexport type TranslatedMessage = {\n  isPending?: boolean;\n  text?: ApiFormattedText;\n};\n\nexport type ChatTranslatedMessages = {\n  byLangCode: Record<string, Record<number, TranslatedMessage>>;\n};\n\nexport type ChatRequestedTranslations = {\n  toLanguage?: string;\n  manualMessages?: Record<number, string>;\n};\n\nexport type SimilarBotsInfo = {\n  similarBotsIds?: string[];\n  count: number;\n};\n\nexport type ConfettiParams = OptionalCombine<{\n  style?: ConfettiStyle;\n  withStars?: boolean;\n}, {\n  top?: number;\n  left?: number;\n  width?: number;\n  height?: number;\n}>;\n\nexport interface Size {\n  width: number;\n  height: number;\n}\n\nexport interface Point {\n  x: number;\n  y: number;\n}\n\nexport type WebPageMediaSize = 'large' | 'small';\n\nexport type StarGiftCategory = number | 'all' | 'limited' | 'stock';\n\nexport type CallSound = (\n  'join' | 'allowTalk' | 'leave' | 'connecting' | 'incoming' | 'end' | 'connect' | 'busy' | 'ringing'\n);\n\nexport type BotAppPermissions = {\n  geolocation?: boolean;\n};\n\nexport type GiftProfileFilterOptions = {\n  sortType: 'byDate' | 'byValue';\n  shouldIncludeUnlimited: boolean;\n  shouldIncludeLimited: boolean;\n  shouldIncludeUnique: boolean;\n  shouldIncludeDisplayed: boolean;\n  shouldIncludeHidden: boolean;\n};\n\nexport type SendMessageParams = {\n  chat?: ApiChat;\n  attachments?: ApiAttachment[];\n  lastMessageId?: number;\n  text?: string;\n  entities?: ApiMessageEntity[];\n  replyInfo?: ApiInputReplyInfo;\n  attachment?: ApiAttachment;\n  sticker?: ApiSticker;\n  story?: ApiStory | ApiStorySkipped;\n  gif?: ApiVideo;\n  poll?: ApiNewPoll;\n  contact?: ApiContact;\n  isSilent?: boolean;\n  scheduledAt?: number;\n  groupedId?: string;\n  noWebPage?: boolean;\n  sendAs?: ApiPeer;\n  shouldGroupMessages?: boolean;\n  shouldUpdateStickerSetOrder?: boolean;\n  wasDrafted?: boolean;\n  isInvertedMedia?: true;\n  effectId?: string;\n  webPageMediaSize?: WebPageMediaSize;\n  webPageUrl?: string;\n  starsAmount?: number;\n  isPending?: true;\n  messageList?: MessageList;\n  isReaction?: true; // Reaction to the story are sent in the form of a message\n  messagePriceInStars?: number;\n  localMessage?: ApiMessage;\n  forwardedLocalMessagesSlice?: ForwardedLocalMessagesSlice;\n  isForwarding?: boolean;\n  forwardParams?: ForwardMessagesParams;\n  isStoryReply?: boolean;\n};\n\nexport type ForwardedLocalMessagesSlice = {\n  messageIds: number[];\n  localMessages: ApiMessage[];\n};\n\nexport type ForwardMessagesParams = {\n  fromChat: ApiChat;\n  toChat: ApiChat;\n  toThreadId?: ThreadId;\n  messages: ApiMessage[];\n  isSilent?: boolean;\n  scheduledAt?: number;\n  sendAs?: ApiPeer;\n  withMyScore?: boolean;\n  noAuthors?: boolean;\n  noCaptions?: boolean;\n  isCurrentUserPremium?: boolean;\n  wasDrafted?: boolean;\n  lastMessageId?: number;\n  forwardedLocalMessagesSlice?: ForwardedLocalMessagesSlice;\n  messagePriceInStars?: number;\n};","import blue from '../assets/icons/forumTopic/blue.svg';\nimport green from '../assets/icons/forumTopic/green.svg';\nimport grey from '../assets/icons/forumTopic/grey.svg';\nimport red from '../assets/icons/forumTopic/red.svg';\nimport rose from '../assets/icons/forumTopic/rose.svg';\nimport violet from '../assets/icons/forumTopic/violet.svg';\nimport yellow from '../assets/icons/forumTopic/yellow.svg';\n\n// eslint-disable-next-line max-len\n// https://github.com/telegramdesktop/tdesktop/blob/1aece79a471d99a8b63d826b1bce1f36a04d7293/Telegram/SourceFiles/data/data_forum_topic.cpp#L50\nconst TOPIC_MAPPING: Record<number, [string, string]> = {\n  0x6FB9F0: [blue, 'blue'],\n  0xFFD67E: [yellow, 'yellow'],\n  0xCB86DB: [violet, 'violet'],\n  0x8EEE98: [green, 'green'],\n  0xFF93B2: [rose, 'rose'],\n  0xFB6F5F: [red, 'red'],\n};\n\nexport function getTopicColors() {\n  return Object.keys(TOPIC_MAPPING).map((key) => parseInt(key, 10));\n}\n\nexport function getTopicDefaultIcon(iconColor?: number) {\n  return (iconColor && TOPIC_MAPPING[iconColor as keyof typeof TOPIC_MAPPING][0]) || grey;\n}\n\nexport function getTopicColorCssVariable(iconColor?: number) {\n  const color = (iconColor && TOPIC_MAPPING[iconColor as keyof typeof TOPIC_MAPPING][1]) || 'grey';\n  return `--color-topic-${color}`;\n}\n","import type {\n  ApiAvailableReaction,\n  ApiChatReactions,\n  ApiMessage,\n  ApiReactionCount,\n  ApiReactionKey,\n  ApiReactions,\n  ApiReactionWithPaid,\n} from '../../api/types';\nimport type { GlobalState } from '../types';\n\nexport function getMessageRecentReaction(message: Partial<ApiMessage>) {\n  return message.isOutgoing ? message.reactions?.recentReactions?.[0] : undefined;\n}\nexport function checkIfHasUnreadReactions(global: GlobalState, reactions: ApiReactions) {\n  const { currentUserId } = global;\n  return reactions?.recentReactions?.some(\n    ({ isUnread, isOwn, peerId }) => isUnread && !isOwn && currentUserId !== peerId,\n  );\n}\n\nexport function areReactionsEmpty(reactions: ApiReactions) {\n  return !reactions.results.some(({ count, localAmount }) => count || localAmount);\n}\n\nexport function getReactionKey(reaction: ApiReactionWithPaid): ApiReactionKey {\n  switch (reaction.type) {\n    case 'emoji':\n      return `emoji-${reaction.emoticon}`;\n    case 'custom':\n      return `document-${reaction.documentId}`;\n    case 'paid':\n      return 'paid';\n    default: {\n      // Legacy reactions\n      const uniqueValue = (reaction as any).emoticon || (reaction as any).documentId;\n      return `unsupported-${uniqueValue}`;\n    }\n  }\n}\n\nexport function isSameReaction(first?: ApiReactionWithPaid, second?: ApiReactionWithPaid) {\n  if (first === second) {\n    return true;\n  }\n\n  if (!first || !second) {\n    return false;\n  }\n\n  return getReactionKey(first) === getReactionKey(second);\n}\n\nexport function canSendReaction(reaction: ApiReactionWithPaid, chatReactions: ApiChatReactions) {\n  if (chatReactions.type === 'all') {\n    return reaction.type === 'emoji' || chatReactions.areCustomAllowed;\n  }\n\n  if (chatReactions.type === 'some') {\n    return chatReactions.allowed.some((r) => isSameReaction(r, reaction));\n  }\n\n  return false;\n}\n\nexport function sortReactions<T extends ApiAvailableReaction | ApiReactionWithPaid>(\n  reactions: T[],\n  topReactions?: ApiReactionWithPaid[],\n): T[] {\n  return reactions.slice().sort((left, right) => {\n    const reactionOne = left ? ('reaction' in left ? left.reaction : left) as ApiReactionWithPaid : undefined;\n    const reactionTwo = right ? ('reaction' in right ? right.reaction : right) as ApiReactionWithPaid : undefined;\n\n    if (reactionOne?.type === 'paid') return -1;\n    if (reactionTwo?.type === 'paid') return 1;\n\n    const indexOne = topReactions?.findIndex((reaction) => isSameReaction(reaction, reactionOne)) || 0;\n    const indexTwo = topReactions?.findIndex((reaction) => isSameReaction(reaction, reactionTwo)) || 0;\n    return (\n      (indexOne > -1 ? indexOne : Infinity) - (indexTwo > -1 ? indexTwo : Infinity)\n    );\n  });\n}\n\nexport function getUserReactions(message: ApiMessage): ApiReactionWithPaid[] {\n  return message.reactions?.results?.filter((r): r is Required<ApiReactionCount> => isReactionChosen(r))\n    .sort((a, b) => a.chosenOrder - b.chosenOrder)\n    .map((r) => r.reaction) || [];\n}\n\nexport function isReactionChosen(reaction: ApiReactionCount) {\n  return reaction.chosenOrder !== undefined;\n}\n\nexport function updateReactionCount(reactionCount: ApiReactionCount[], newReactions: ApiReactionWithPaid[]) {\n  const results = reactionCount.map((current) => (\n    isReactionChosen(current) ? {\n      ...current,\n      chosenOrder: undefined,\n      count: current.count - 1,\n    } : current\n  )).filter(({ count }) => count > 0);\n\n  newReactions.forEach((reaction, i) => {\n    const existingIndex = results.findIndex((r) => isSameReaction(r.reaction, reaction));\n    if (existingIndex > -1) {\n      results[existingIndex] = {\n        ...results[existingIndex],\n        chosenOrder: i,\n        count: results[existingIndex].count + 1,\n      };\n    } else {\n      results.push({\n        reaction,\n        chosenOrder: i,\n        count: 1,\n      });\n    }\n  });\n\n  return results;\n}\n\nexport function addPaidReaction(\n  reactionCount: ApiReactionCount[], count: number, isAnonymous?: boolean, peerId?: string,\n): ApiReactionCount[] {\n  const results: ApiReactionCount[] = [];\n  const hasPaid = reactionCount.some((current) => current.reaction.type === 'paid');\n  if (hasPaid) {\n    reactionCount.forEach((current) => {\n      if (current.reaction.type === 'paid') {\n        results.push({\n          ...current,\n          localAmount: (current.localAmount || 0) + count,\n          chosenOrder: -1,\n          localIsPrivate: isAnonymous !== undefined ? isAnonymous : current.localIsPrivate,\n          localPeerId: peerId || current.localPeerId,\n          localPreviousChosenOrder: current.chosenOrder,\n        });\n        return;\n      }\n\n      results.push(current);\n    });\n\n    return results;\n  }\n\n  return [\n    {\n      reaction: { type: 'paid' },\n      count: 0,\n      chosenOrder: -1,\n      localAmount: count,\n      localIsPrivate: isAnonymous,\n      localPeerId: peerId,\n    },\n    ...reactionCount,\n  ];\n}\n","import type { ApiStory, ApiVideo } from '../../api/types';\n\nimport { getPhotoMediaHash, getVideoMediaHash } from './messageMedia';\n\ntype StorySize = 'pictogram' | 'preview' | 'full' | 'download';\nconst STORY_ALT_VIDEO_WIDTH = 480;\n\nexport function getStoryMediaHash(\n  story: ApiStory, size: StorySize, isAlt: true,\n): string | undefined;\nexport function getStoryMediaHash(story: ApiStory): string;\nexport function getStoryMediaHash(story: ApiStory, size: StorySize): string;\nexport function getStoryMediaHash(\n  story: ApiStory, size: StorySize = 'preview', isAlt?: boolean,\n) {\n  const isVideo = Boolean(story.content.video);\n\n  if (isVideo) {\n    if (isAlt && !story.content.altVideos) return undefined;\n    const media = isAlt ? getPreferredAlt(story.content.altVideos!) : story.content.video!;\n    return getVideoMediaHash(media, size);\n  }\n\n  return getPhotoMediaHash(story.content.photo!, size);\n}\n\nfunction getPreferredAlt(alts: ApiVideo[]) {\n  const alt = alts.reduce((prev, curr) => (\n    Math.abs((curr.width || 0) - STORY_ALT_VIDEO_WIDTH) < Math.abs((prev.width || 0) - STORY_ALT_VIDEO_WIDTH)\n      ? curr : prev\n  ));\n  return alt;\n}\n\nexport function getStoryKey(chatId: string, storyId: number) {\n  return `story${chatId}-${storyId}`;\n}\n","import type {\n  ApiInputPrivacyRules,\n  BotsPrivacyType,\n  PrivacyVisibility,\n} from '../../api/types';\nimport type { GlobalState } from '../types';\n\nimport { DEFAULT_LIMITS } from '../../config';\nimport { partition } from '../../util/iteratees';\nimport { clamp } from '../../util/math';\nimport { getAccountsInfo } from '../../util/multiaccount';\nimport { getGlobal } from '..';\nimport { isUserId } from './chats';\n\nexport function buildApiInputPrivacyRules(global: GlobalState, {\n  visibility,\n  isUnspecified,\n  allowedIds,\n  blockedIds,\n  shouldAllowPremium,\n  botsPrivacy,\n}: {\n  visibility: PrivacyVisibility;\n  isUnspecified?: boolean;\n  allowedIds: string[];\n  blockedIds: string[];\n  shouldAllowPremium?: true;\n  botsPrivacy: BotsPrivacyType;\n}): ApiInputPrivacyRules {\n  const {\n    users: { byId: usersById },\n    chats: { byId: chatsById },\n  } = global;\n\n  const [allowedUserIds, allowedChatIds] = partition(allowedIds, isUserId);\n  const [blockedUserIds, blockedChatIds] = partition(blockedIds, isUserId);\n\n  const rules: ApiInputPrivacyRules = {\n    visibility,\n    isUnspecified,\n    allowedUsers: allowedUserIds.map((userId) => usersById[userId]).filter(Boolean),\n    allowedChats: allowedChatIds.map((chatId) => chatsById[chatId]).filter(Boolean),\n    blockedUsers: blockedUserIds.map((userId) => usersById[userId]).filter(Boolean),\n    blockedChats: blockedChatIds.map((chatId) => chatsById[chatId]).filter(Boolean),\n    shouldAllowPremium,\n    botsPrivacy,\n  };\n\n  return rules;\n}\n\nexport function getCurrentMaxAccountCount() {\n  const limit = getGlobal().appConfig?.limits?.moreAccounts || DEFAULT_LIMITS.moreAccounts;\n  const accounts = getAccountsInfo();\n  const premiumCount = Object.values(accounts).filter((account) => account.isPremium).length;\n  // Each premium account increases the base limit by 1, up to the maximum limit.\n  const currentMaxCount = limit[0] + premiumCount;\n  return clamp(currentMaxCount, limit[0], limit[1]);\n}\n\nexport function getCurrentProdAccountCount() {\n  return Object.values(getAccountsInfo()).filter((account) => !account.isTest).length;\n}\n","import type { ApiDocument } from '../../../api/types';\n\nconst ONE_GIGABYTE = 1024 * 1024 * 1024;\nconst ONE_MEGABYTE = 1024 * 1024;\n\nexport function getFileSizeString(bytes: number) {\n  if (bytes > (ONE_GIGABYTE / 2)) {\n    return `${(bytes / ONE_GIGABYTE).toFixed(1)} GB`;\n  }\n  if (bytes > (ONE_MEGABYTE / 2)) {\n    return `${(bytes / ONE_MEGABYTE).toFixed(1)} MB`;\n  }\n  return `${(bytes / (1024)).toFixed(1)} KB`;\n}\n\nexport function getDocumentExtension(document: ApiDocument) {\n  const { fileName, mimeType } = document;\n\n  return getFileExtension(fileName, mimeType);\n}\n\nexport function getFileExtension(fileName: string, mimeType: string) {\n  if (fileName && fileName.indexOf('.') !== -1) {\n    return fileName.split('.').pop();\n  } else {\n    return mimeType.split('/').pop();\n  }\n}\n\nexport function getColorFromExtension(extension: string) {\n  switch (extension) {\n    case 'apk':\n    case 'xls':\n    case 'xlsx':\n    case 'ods':\n      return 'green';\n    case 'zip':\n    case 'rar':\n    case '7z':\n    case 'tar':\n    case 'gz':\n    case 'bz2':\n    case 'liz':\n    case 'lz4':\n    case 'lz5':\n    case 'xz':\n    case 'zst':\n    case 'wim':\n    case 'ppt':\n    case 'pptx':\n    case 'odp':\n      return 'orange';\n    case 'pdf':\n    case 'xps':\n      return 'red';\n    default:\n      return 'default';\n  }\n}\n\nexport function getDocumentHasPreview(document: ApiDocument) {\n  return Boolean(document.previewBlobUrl || document.thumbnail);\n}\n","export default function calcTextLineHeightAndCount(textContainer: HTMLElement) {\n  const lineHeight = parseInt(getComputedStyle(textContainer).lineHeight, 10);\n\n  const totalLines = textContainer.scrollHeight / lineHeight;\n\n  return {\n    totalLines,\n    lineHeight,\n  };\n}\n","import { useEffect } from '../lib/teact/teact';\n\nimport type { CallbackManager } from '../util/callbacks';\n\nimport { createCallbackManager } from '../util/callbacks';\nimport { useStateRef } from './useStateRef';\n\nconst elementObserverMap = new Map<HTMLElement, [ResizeObserver, CallbackManager]>();\n\nexport default function useResizeObserver(\n  ref: React.RefObject<HTMLElement> | undefined,\n  onResize: (entry: ResizeObserverEntry) => void,\n  isDisabled = false,\n) {\n  const onResizeRef = useStateRef(onResize);\n\n  useEffect(() => {\n    const el = ref?.current;\n    if (!el || isDisabled) {\n      return undefined;\n    }\n\n    const callback: ResizeObserverCallback = ([entry]) => {\n      // Ignore updates when element is not properly mounted (`display: none`)\n      if (entry.contentRect.width === 0 && entry.contentRect.height === 0) {\n        return;\n      }\n\n      onResizeRef.current(entry);\n    };\n\n    let [observer, callbackManager] = elementObserverMap.get(el) || [undefined, undefined];\n    if (!observer) {\n      callbackManager = createCallbackManager();\n      observer = new ResizeObserver(callbackManager.runCallbacks);\n      elementObserverMap.set(el, [observer, callbackManager]);\n      observer.observe(el);\n    }\n    callbackManager!.addCallback(callback);\n\n    return () => {\n      callbackManager!.removeCallback(callback);\n      if (!callbackManager!.hasCallbacks()) {\n        observer!.unobserve(el);\n        observer!.disconnect();\n        elementObserverMap.delete(el);\n      }\n    };\n  }, [isDisabled, onResizeRef, ref]);\n}\n","/* eslint-disable no-nested-ternary */\n/* eslint-disable no-bitwise */\n/* eslint-disable @typescript-eslint/naming-convention */\n\nconst utf16 = {\n  // The utf16-class is necessary to convert from javascripts internal character representation to unicode and back.\n  decode: (input) => {\n    const output = [];\n    let i = 0;\n    const len = input.length;\n    let value;\n    let extra;\n\n    while (i < len) {\n      value = input.charCodeAt(i++);\n      if ((value & 0xf800) === 0xd800) {\n        extra = input.charCodeAt(i++);\n        if ((value & 0xfc00) !== 0xd800 || (extra & 0xfc00) !== 0xdc00) {\n          throw new RangeError('UTF-16(decode): Illegal UTF-16 sequence');\n        }\n        value = ((value & 0x3ff) << 10) + (extra & 0x3ff) + 0x10000;\n      }\n      output.push(value);\n    }\n    return output;\n  },\n  encode: (input) => {\n    const output = [];\n    let i = 0;\n    const len = input.length;\n    let value;\n\n    while (i < len) {\n      value = input[i++];\n      if ((value & 0xf800) === 0xd800) {\n        throw new RangeError('UTF-16(encode): Illegal UTF-16 value');\n      }\n      if (value > 0xffff) {\n        value -= 0x10000;\n        output.push(String.fromCharCode(((value >>> 10) & 0x3ff) | 0xd800));\n        value = 0xdc00 | (value & 0x3ff);\n      }\n      output.push(String.fromCharCode(value));\n    }\n    return output.join('');\n  },\n};\n\n// Default parameters\nconst initial_n = 0x80;\nconst initial_bias = 72;\nconst delimiter = '\\x2D';\nconst base = 36;\nconst damp = 700;\nconst tmin = 1;\nconst tmax = 26;\nconst skew = 38;\nconst maxint = 0x7fffffff;\n\n// decode_digit(cp) returns the numeric value of a basic code\n// point (for use in representing integers) in the range 0 to\n// base-1, or base if cp is does not represent a value.\n\nfunction decode_digit(cp) {\n  return cp - 48 < 10 ? cp - 22 : cp - 65 < 26 ? cp - 65 : cp - 97 < 26 ? cp - 97 : base;\n}\n\n// ** Bias adaptation function **\nfunction adapt(delta, numpoints, firsttime) {\n  let k;\n  delta = firsttime ? Math.floor(delta / damp) : delta >> 1;\n  delta += Math.floor(delta / numpoints);\n\n  for (k = 0; delta > ((base - tmin) * tmax) >> 1; k += base) {\n    delta = Math.floor(delta / (base - tmin));\n  }\n  return Math.floor(k + ((base - tmin + 1) * delta) / (delta + skew));\n}\n\n// Main decode\nfunction decode(input, preserveCase) {\n  // Dont use utf16\n  const output = [];\n  const case_flags = [];\n  const input_length = input.length;\n\n  let n; let out; let i; let bias; let basic; let j; let ic; let oldi; let w; let k; let digit; let t; let len;\n\n  // Initialize the state:\n\n  n = initial_n;\n  i = 0;\n  bias = initial_bias;\n\n  // Handle the basic code points: Let basic be the number of input code\n  // points before the last delimiter, or 0 if there is none, then\n  // copy the first basic code points to the output.\n\n  basic = input.lastIndexOf(delimiter);\n  if (basic < 0) basic = 0;\n\n  for (j = 0; j < basic; ++j) {\n    if (preserveCase) case_flags[output.length] = input.charCodeAt(j) - 65 < 26;\n    if (input.charCodeAt(j) >= 0x80) {\n      throw new RangeError('Illegal input >= 0x80');\n    }\n    output.push(input.charCodeAt(j));\n  }\n\n  // Main decoding loop: Start just after the last delimiter if any\n  // basic code points were copied; start at the beginning otherwise.\n\n  for (ic = basic > 0 ? basic + 1 : 0; ic < input_length;) {\n    // ic is the index of the next character to be consumed,\n\n    // Decode a generalized variable-length integer into delta,\n    // which gets added to i. The overflow checking is easier\n    // if we increase i as we go, then subtract off its starting\n    // value at the end to obtain delta.\n    for (oldi = i, w = 1, k = base; ; k += base) {\n      if (ic >= input_length) {\n        throw RangeError('punycode_bad_input(1)');\n      }\n      digit = decode_digit(input.charCodeAt(ic++));\n\n      if (digit >= base) {\n        throw RangeError('punycode_bad_input(2)');\n      }\n      if (digit > Math.floor((maxint - i) / w)) {\n        throw RangeError('punycode_overflow(1)');\n      }\n      i += digit * w;\n      t = k <= bias ? tmin : k >= bias + tmax ? tmax : k - bias;\n      if (digit < t) {\n        break;\n      }\n      if (w > Math.floor(maxint / (base - t))) {\n        throw RangeError('punycode_overflow(2)');\n      }\n      w *= base - t;\n    }\n\n    out = output.length + 1;\n    bias = adapt(i - oldi, out, oldi === 0);\n\n    // i was supposed to wrap around from out to 0,\n    // incrementing n each time, so we'll fix that now:\n    if (Math.floor(i / out) > maxint - n) {\n      throw RangeError('punycode_overflow(3)');\n    }\n    n += Math.floor(i / out);\n    i %= out;\n\n    // Insert n at position i of the output:\n    // Case of last character determines uppercase flag:\n    if (preserveCase) {\n      case_flags.splice(i, 0, input.charCodeAt(ic - 1) - 65 < 26);\n    }\n\n    output.splice(i, 0, n);\n    i++;\n  }\n  if (preserveCase) {\n    for (i = 0, len = output.length; i < len; i++) {\n      if (case_flags[i]) {\n        output[i] = String.fromCharCode(output[i])\n          .toUpperCase()\n          .charCodeAt(0);\n      }\n    }\n  }\n  return utf16.encode(output);\n}\n\nfunction toUnicode(domain) {\n  const domain_array = domain.split('.');\n  const out = [];\n  for (let i = 0; i < domain_array.length; ++i) {\n    const s = domain_array[i];\n    out.push(s.match(/^xn--/) ? decode(s.slice(4)) : s);\n  }\n  return out.join('.');\n}\n\nexport default toUnicode;\n","import { DEBUG } from '../../config';\nimport convertPunycode from '../../lib/punycode';\n\nconst PROTOCOL_WHITELIST = new Set(['http:', 'https:', 'tg:', 'ton:', 'mailto:', 'tel:']);\nconst FALLBACK_PREFIX = 'https://';\n\nexport function ensureProtocol(url: string) {\n  try {\n    const parsedUrl = new URL(url);\n    // eslint-disable-next-line no-script-url\n    if (!PROTOCOL_WHITELIST.has(parsedUrl.protocol)) {\n      return `${FALLBACK_PREFIX}${url}`;\n    }\n\n    return url;\n  } catch (err) {\n    return `${FALLBACK_PREFIX}${url}`;\n  }\n}\n\nexport function getUnicodeUrl(url: string) {\n  const href = ensureProtocol(url);\n\n  try {\n    const parsedUrl = new URL(href);\n    const unicodeDomain = convertPunycode(parsedUrl.hostname);\n\n    try {\n      return decodeURI(parsedUrl.toString()).replace(parsedUrl.hostname, unicodeDomain);\n    } catch (err) { // URL contains invalid sequences, keep it as it is\n      return parsedUrl.toString().replace(parsedUrl.hostname, unicodeDomain);\n    }\n  } catch (error) {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.warn('SafeLink.getDecodedUrl error ', url, error);\n    }\n  }\n\n  return undefined;\n}\n\nexport function isMixedScriptUrl(url: string): boolean {\n  let domain;\n  try {\n    domain = convertPunycode(new URL(ensureProtocol(url)!).hostname);\n  } catch (e) {\n    return true; // If URL is invalid, treat it as mixed script\n  }\n\n  let hasLatin = false;\n  let hasNonLatin = false;\n\n  for (const char of Array.from(domain)) {\n    if (!/\\p{L}/u.test(char)) continue; // Ignore non-letter characters\n\n    if (/\\p{Script=Latin}/u.test(char)) {\n      hasLatin = true;\n    } else {\n      hasNonLatin = true;\n    }\n\n    if (hasLatin && hasNonLatin) return true;\n  }\n\n  return false;\n}\n","import { useEffect, useState } from '../lib/teact/teact';\nimport { getGlobal } from '../global';\n\nimport type { ApiUser } from '../api/types';\n\nimport { SESSION_ACCOUNT_PREFIX } from '../config';\nimport { getChatAvatarHash } from '../global/helpers';\nimport { selectIsSynced } from '../global/selectors';\nimport { preloadImage } from '../util/files';\nimport { resizeImage } from '../util/imageResize';\nimport { ACCOUNT_SLOT, getAccountsInfo, storeAccountData } from '../util/multiaccount';\nimport useSelector from './data/useSelector';\nimport useInterval from './schedulers/useInterval';\nimport useLastCallback from './useLastCallback';\nimport useMedia from './useMedia';\nimport useThrottledCallback from './useThrottledCallback';\n\nconst LOCAL_STORAGE_LISTENING_THROTTLE = 1000;\nconst REFRESH_INTERVAL = 1000 * 60;\nconst PREVIEW_SIZE = 72;\n\nexport default function useMultiaccountInfo(currentUser?: ApiUser) {\n  const isUpdater = Boolean(currentUser) && getGlobal().authRememberMe;\n  const isSynced = useSelector(selectIsSynced);\n\n  const [accountsInfo, setAccountsInfo] = useState(getAccountsInfo());\n\n  const avatarHash = currentUser && getChatAvatarHash(currentUser);\n  const avatarUrl = useMedia(avatarHash, !isUpdater);\n\n  const refresh = useThrottledCallback(() => {\n    setAccountsInfo(getAccountsInfo());\n  }, [], LOCAL_STORAGE_LISTENING_THROTTLE);\n\n  useEffect(() => {\n    if (!isUpdater || !isSynced) return;\n    storeAccountData(ACCOUNT_SLOT, {\n      userId: currentUser.id,\n      firstName: currentUser.firstName,\n      lastName: currentUser.lastName,\n      emojiStatusId: currentUser.emojiStatus?.documentId,\n      color: currentUser.color?.color,\n      isPremium: currentUser.isPremium,\n      phone: currentUser.phoneNumber,\n    });\n\n    refresh();\n  }, [\n    isUpdater, currentUser?.emojiStatus?.documentId, currentUser?.firstName, currentUser?.id, currentUser?.lastName,\n    currentUser?.color?.color, currentUser?.isPremium, currentUser?.phoneNumber, refresh, isSynced,\n  ]);\n\n  const updateAvatar = useLastCallback(async (url: string, abortSignal?: AbortSignal) => {\n    const resizedAvatar = await resizeImage(url, PREVIEW_SIZE, PREVIEW_SIZE);\n    const img = await preloadImage(resizedAvatar);\n    if (abortSignal?.aborted) return;\n    const canvas = document.createElement('canvas');\n    const ctx = canvas.getContext('2d')!;\n    canvas.width = img.width;\n    canvas.height = img.height;\n    ctx.drawImage(img, 0, 0);\n    const dataUrl = canvas.toDataURL('image/png');\n    storeAccountData(ACCOUNT_SLOT, { avatarUri: dataUrl });\n\n    refresh();\n  });\n\n  useEffect(() => {\n    if (!avatarUrl || !isUpdater || !isSynced) return undefined;\n    const controller = new AbortController();\n    updateAvatar(avatarUrl, controller.signal);\n\n    return () => {\n      controller.abort();\n    };\n  }, [avatarUrl, isSynced, isUpdater]);\n\n  // Storage event only thrown when other tabs change the storage\n  useInterval(refresh, REFRESH_INTERVAL);\n  useEffect(() => {\n    function handleStorageChange(e: StorageEvent) {\n      if (!e.key?.startsWith(SESSION_ACCOUNT_PREFIX)) return;\n      refresh();\n    }\n\n    window.addEventListener('storage', handleStorageChange);\n\n    return () => {\n      window.removeEventListener('storage', handleStorageChange);\n    };\n  }, [refresh]);\n\n  return accountsInfo;\n}\n","import type { ThreadId } from '../../types';\nimport type { GlobalState, TabArgs } from '../types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { buildChatThreadKey } from '../helpers/middleSearch';\nimport { selectCurrentMessageList } from './messages';\nimport { selectTabState } from './tabs';\n\nexport function selectCurrentMiddleSearch<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { chatId, threadId } = selectCurrentMessageList(global, tabId) || {};\n  if (!chatId || !threadId) {\n    return undefined;\n  }\n\n  const chatThreadKey = buildChatThreadKey(chatId, threadId);\n\n  return selectTabState(global, tabId).middleSearch.byChatThreadKey[chatThreadKey];\n}\n\nexport function selectCurrentSharedMediaSearch<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { chatId, threadId } = selectCurrentMessageList(global, tabId) || {};\n  if (!chatId || !threadId) {\n    return undefined;\n  }\n\n  const chatThreadKey = buildChatThreadKey(chatId, threadId);\n\n  return selectTabState(global, tabId).sharedMediaSearch.byChatThreadKey[chatThreadKey];\n}\n\nexport function selectCurrentChatMediaSearch<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { chatId, threadId } = selectCurrentMessageList(global, tabId) || {};\n  if (!chatId || !threadId) {\n    return undefined;\n  }\n\n  const chatThreadKey = buildChatThreadKey(chatId, threadId);\n\n  return selectTabState(global, tabId).chatMediaSearch.byChatThreadKey[chatThreadKey];\n}\n\nexport function selectChatMediaSearch<T extends GlobalState>(\n  global: T, chatId?: string, threadId?: ThreadId,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  if (!chatId || !threadId) {\n    return undefined;\n  }\n\n  const chatThreadKey = buildChatThreadKey(chatId, threadId);\n\n  return selectTabState(global, tabId).chatMediaSearch.byChatThreadKey[chatThreadKey];\n}\n","import {\n  useEffect, useMemo, useState,\n} from '../lib/teact/teact';\n\nimport { round } from '../util/math';\nimport useLastCallback from './useLastCallback';\nimport useResizeObserver from './useResizeObserver';\nimport useSharedIntersectionObserver from './useSharedIntersectionObserver';\nimport useThrottledCallback from './useThrottledCallback';\n\nconst THROTTLE_MS = 150;\n\nexport default function useCoordsInSharedCanvas(\n  containerRef: React.RefObject<HTMLDivElement>,\n  sharedCanvasRef?: React.RefObject<HTMLCanvasElement>,\n) {\n  const [x, setX] = useState<number>();\n  const [y, setY] = useState<number>();\n\n  const recalculate = useLastCallback(() => {\n    const container = containerRef.current;\n    const canvas = sharedCanvasRef?.current;\n    if (!container || !canvas) {\n      return;\n    }\n\n    // Wait until elements are properly mounted\n    if (!canvas.offsetWidth || !canvas.offsetHeight) {\n      return;\n    }\n\n    const target = container.classList.contains('sticker-set-cover') || container.classList.contains('sticker-reaction')\n      ? container\n      : container.querySelector('img')!;\n    if (!target) {\n      return;\n    }\n\n    const targetBounds = target.getBoundingClientRect();\n    const canvasBounds = canvas.getBoundingClientRect();\n\n    // Factor coords are used to support rendering while being rescaled (e.g. message appearance animation)\n    setX(round((targetBounds.left - canvasBounds.left) / canvasBounds.width, 4) || 0);\n    setY(round((targetBounds.top - canvasBounds.top) / canvasBounds.height, 4) || 0);\n  });\n\n  useEffect(recalculate, [recalculate]);\n\n  const throttledRecalculate = useThrottledCallback(recalculate, [recalculate], THROTTLE_MS);\n  useResizeObserver(sharedCanvasRef, throttledRecalculate);\n  useSharedIntersectionObserver(sharedCanvasRef, throttledRecalculate);\n\n  return useMemo(() => (x !== undefined && y !== undefined ? { x, y } : undefined), [x, y]);\n}\n","import { isLiteralObject, unique } from './iteratees';\n\nconst EQUAL = Symbol('EQUAL');\nconst DELETE = { __delete: true };\nconst DELETE_ALL_CHILDREN = { __deleteAllChildren: true };\n\ntype NestedDiff<T> = T extends object\n  ? { [K in keyof T]?: NestedDiff<T[K]> | typeof DELETE_ALL_CHILDREN | typeof DELETE | null } : T;\n\nexport type DiffObject<T> = T extends object\n  ? { [K in keyof T]?: NestedDiff<T[K]> } | typeof DELETE_ALL_CHILDREN\n  : T;\n\nexport function deepDiff<T extends any>(value1: T, value2: T): Partial<T> | typeof EQUAL | typeof DELETE_ALL_CHILDREN {\n  if (value1 === value2) {\n    return EQUAL;\n  }\n\n  const type1 = typeof value1;\n  const type2 = typeof value2;\n\n  if (type1 !== type2) {\n    return value2;\n  }\n\n  if (Array.isArray(value1) && Array.isArray(value2) && areSortedArraysDeepEqual(value1, value2)) {\n    return EQUAL;\n  }\n\n  if (!isLiteralObject(value1) || !isLiteralObject(value2)) {\n    return value2;\n  }\n\n  const object1 = value1 as AnyLiteral;\n  const object2 = value2 as AnyLiteral;\n  const keys1 = Object.keys(object1);\n  const keys2 = Object.keys(object2);\n\n  if (!keys2.length) {\n    return !keys1.length ? EQUAL : DELETE_ALL_CHILDREN;\n  }\n\n  const allKeys = unique(keys1.concat(keys2));\n\n  const diff = allKeys.reduce((acc: any, key) => {\n    const subValue1 = object1[key];\n    const subValue2 = object2[key];\n\n    if (!object2.hasOwnProperty(key)) {\n      acc[key] = DELETE;\n      return acc;\n    }\n\n    if (!object1!.hasOwnProperty(key)) {\n      acc[key] = subValue2;\n      return acc;\n    }\n\n    const subDiff = deepDiff(subValue1, subValue2);\n    if (subDiff !== EQUAL) {\n      acc[key] = subDiff;\n    }\n\n    return acc;\n  }, {});\n\n  if (Object.keys(diff).length === 0) {\n    return EQUAL;\n  }\n\n  return diff;\n}\n\nfunction areSortedArraysDeepEqual<T extends Array<any>>(array1: T, array2: T) {\n  if (array1.length !== array2.length) {\n    return false;\n  }\n\n  return array1.every((item, i) => deepDiff(item, array2[i]) === EQUAL);\n}","import type { ApiFormattedText } from '../../api/types';\nimport type { TranslatedMessage } from '../../types';\nimport type { GlobalState, TabArgs } from '../types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { omit } from '../../util/iteratees';\nimport { selectMessageTranslations, selectTabState } from '../selectors';\nimport { updateTabState } from './tabs';\n\nexport function updateMessageTranslation<T extends GlobalState>(\n  global: T, chatId: string, messageId: number, toLanguageCode: string, translation: Partial<TranslatedMessage>,\n) {\n  const translatedMessages = selectMessageTranslations(global, chatId, toLanguageCode);\n\n  return {\n    ...global,\n    translations: {\n      ...global.translations,\n      byChatId: {\n        ...global.translations.byChatId,\n        [chatId]: {\n          ...global.translations.byChatId[chatId],\n          byLangCode: {\n            ...global.translations.byChatId[chatId]?.byLangCode,\n            [toLanguageCode]: {\n              ...translatedMessages,\n              [messageId]: {\n                ...translatedMessages[messageId],\n                ...translation,\n              },\n            },\n          },\n        },\n      },\n    },\n  };\n}\n\nexport function clearMessageTranslation<T extends GlobalState>(\n  global: T, chatId: string, messageId: number,\n) {\n  const chatTranslations = global.translations.byChatId[chatId];\n  if (!chatTranslations) return global;\n\n  const { byLangCode } = chatTranslations;\n  const newByLangCode = Object.keys(byLangCode).reduce((acc, langCode) => {\n    const newTranslatedMessages = omit(byLangCode[langCode], [messageId]);\n    if (Object.keys(newTranslatedMessages).length) {\n      acc[langCode] = newTranslatedMessages;\n    }\n\n    return acc;\n  }, {} as Record<string, Record<number, TranslatedMessage>>);\n\n  return {\n    ...global,\n    translations: {\n      ...global.translations,\n      byChatId: {\n        ...global.translations.byChatId,\n        [chatId]: {\n          ...chatTranslations,\n          byLangCode: newByLangCode,\n        },\n      },\n    },\n  };\n}\n\nexport function updateMessageTranslations<T extends GlobalState>(\n  global: T, chatId: string, messageIds: number[], toLanguageCode: string, translations: ApiFormattedText[],\n) {\n  messageIds.forEach((messageId, index) => {\n    global = updateMessageTranslation(global, chatId, messageId, toLanguageCode, {\n      text: translations[index],\n      isPending: false,\n    });\n  });\n\n  return global;\n}\n\nexport function updateRequestedChatTranslation<T extends GlobalState>(\n  global: T, chatId: string, toLanguageCode?: string, ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const tabState = selectTabState(global, tabId);\n  global = updateTabState(global, {\n    requestedTranslations: {\n      ...tabState.requestedTranslations,\n      byChatId: {\n        ...tabState.requestedTranslations.byChatId,\n        [chatId]: {\n          toLanguage: toLanguageCode,\n        },\n      },\n    },\n  }, tabId);\n\n  return global;\n}\n\nexport function removeRequestedChatTranslation<T extends GlobalState>(\n  global: T, chatId: string, ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const tabState = selectTabState(global, tabId);\n\n  global = updateTabState(global, {\n    requestedTranslations: {\n      ...tabState.requestedTranslations,\n      byChatId: omit(tabState.requestedTranslations.byChatId, [chatId]),\n    },\n  }, tabId);\n\n  return global;\n}\n\nexport function updateRequestedMessageTranslation<T extends GlobalState>(\n  global: T, chatId: string, messageId: number, toLanguageCode: string, ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const tabState = selectTabState(global, tabId);\n  global = updateTabState(global, {\n    requestedTranslations: {\n      ...tabState.requestedTranslations,\n      byChatId: {\n        ...tabState.requestedTranslations.byChatId,\n        [chatId]: {\n          ...tabState.requestedTranslations.byChatId[chatId],\n          manualMessages: {\n            ...tabState.requestedTranslations.byChatId[chatId]?.manualMessages,\n            [messageId]: toLanguageCode,\n          },\n        },\n      },\n    },\n  }, tabId);\n\n  return global;\n}\n\nexport function removeRequestedMessageTranslation<T extends GlobalState>(\n  global: T, chatId: string, messageId: number, ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const tabState = selectTabState(global, tabId);\n\n  const manualMessages = tabState.requestedTranslations.byChatId[chatId]?.manualMessages;\n  if (!manualMessages) return global;\n\n  const newManualMessages = omit(manualMessages, [messageId]);\n\n  global = updateTabState(global, {\n    requestedTranslations: {\n      ...tabState.requestedTranslations,\n      byChatId: {\n        ...tabState.requestedTranslations.byChatId,\n        [chatId]: {\n          ...tabState.requestedTranslations.byChatId[chatId],\n          manualMessages: newManualMessages,\n        },\n      },\n    },\n  }, tabId);\n\n  return global;\n}\n","type Parts = (string | false | undefined)[];\n\nexport default function buildStyle(...parts: Parts) {\n  return parts.filter(Boolean).join(';');\n}\n","/* eslint-disable no-null/no-null */\n/* eslint-disable no-console */\nimport type { Message } from 'ai';\n\nimport type { StoreName } from './chatai-store';\nimport type ChataiDB from './chatai-store';\n\nexport interface StoreMessage extends Message {\n  chatId: string;\n  timestamp: number;\n}\nclass MessageStore {\n  private storeName: StoreName = 'message';\n\n  private db: IDBDatabase | null = null;\n\n  private chataiStoreManager:ChataiDB;\n\n  constructor(private dbManager: ChataiDB) {\n    this.db = dbManager.db;\n    this.chataiStoreManager = dbManager;\n  }\n\n  async storeMessage(message: StoreMessage): Promise<void> {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding contact:', error);\n      return;\n    }\n\n    const transaction = db.transaction([this.storeName], 'readwrite');\n    const store = transaction.objectStore(this.storeName);\n\n    const request = store.put(message);\n\n    request.onsuccess = () => {\n      console.log(`Message ${message.id} stored successfully`);\n    };\n\n    request.onerror = (event: Event) => {\n      console.error(\n        `Error storing message ${message.id}:`,\n        (event.target as IDBRequest).error,\n      );\n    };\n  }\n\n  async storeMessages(messages: StoreMessage[]): Promise<void> {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding contact:', error);\n      return;\n    }\n\n    const transaction = db.transaction([this.storeName], 'readwrite');\n    const store = transaction.objectStore(this.storeName);\n\n    messages.forEach((message) => {\n      const request = store.put(message);\n\n      request.onsuccess = () => {\n        console.log(`Message ${message.id} stored successfully`);\n      };\n\n      request.onerror = (event: Event) => {\n        console.error(\n          `Error storing message ${message.id}:`,\n          (event.target as IDBRequest).error,\n        );\n      };\n    });\n\n    transaction.oncomplete = () => {\n      console.log('All messages stored successfully');\n    };\n\n    transaction.onerror = (event: Event) => {\n      console.error(\n        'Error storing messages:',\n        (event.target as IDBRequest).error,\n      );\n    };\n  }\n\n  /** 📌 分页查询某个房间的消息（按 `time` 倒序） */\n  async getMessages(\n    chatId: string,\n    lastTime: number | undefined,\n    pageSize: number,\n  ): Promise<{ messages: any[]; lastTime: number | undefined ;hasMore:boolean }> {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding contact:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readonly');\n      const store = tx.objectStore(this.storeName);\n      const index = store.index('chatId_timestamp');\n\n      // 🔥 查询指定房间的消息，按 `time` 倒序\n      const range = lastTime !== undefined\n        ? IDBKeyRange.bound([chatId, 0], [chatId, lastTime], false, true) // 限制 chatId，从 lastTime 之前查\n        : IDBKeyRange.bound([chatId, 0], [chatId, Number.MAX_SAFE_INTEGER]); // 查询全部\n\n      const request = index.openCursor(range, 'prev'); // 🔥 逆序取数据\n      const messages: any[] = [];\n      let count = 0;\n      let newLastTime: number | undefined;\n\n      request.onsuccess = (event) => {\n        const cursor = (event.target as IDBRequest).result;\n        if (cursor && count < pageSize) {\n          messages.unshift(cursor.value);\n          newLastTime = cursor.value.timestamp; // 记录最后一条的时间\n          count++;\n          cursor.continue();\n        } else {\n          resolve({ messages, lastTime: newLastTime, hasMore: count === pageSize });\n        }\n      };\n\n      request.onerror = () => reject(new Error('Failed to fetch messages'));\n    });\n  }\n\n  async getAllMessages(): Promise<StoreMessage[]> {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding contact:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readonly');\n      const store = tx.objectStore(this.storeName);\n      const request = store.getAll();\n\n      request.onsuccess = () => {\n        resolve(request.result);\n      };\n      request.onerror = () => reject(new Error('Failed to fetch messages'));\n    });\n  }\n\n  async delMessage(id: string): Promise<void> {\n    let db: IDBDatabase;\n    try {\n      db = await this.chataiStoreManager.getDB();\n    } catch (error) {\n      console.error('Error adding contact:', error);\n      return Promise.reject(error);\n    }\n    return new Promise((resolve, reject) => {\n      const tx = db.transaction(this.storeName, 'readwrite');\n      const store = tx.objectStore(this.storeName);\n      const request = store.delete(id);\n\n      request.onsuccess = () => {\n        console.log(`Deleted record with key: ${id}`);\n        resolve();\n      };\n      request.onerror = () => reject(new Error('Failed to delete record'));\n    });\n  }\n}\n\nexport function parseMessage2StoreMessage(\n  chatId: string,\n  messages: Message[],\n): StoreMessage[] {\n  const copyedMessages = JSON.parse(JSON.stringify(messages));\n  copyedMessages.forEach((message: Message) => {\n    (message as StoreMessage).chatId = chatId;\n    (message as StoreMessage).timestamp = new Date(\n      message.createdAt as Date,\n    ).getTime();\n  });\n  return copyedMessages as StoreMessage[];\n}\n\nexport function parseStoreMessage2Message(messages: StoreMessage[]): Message[] {\n  const copyedMessages = JSON.parse(JSON.stringify(messages));\n  copyedMessages.forEach((message: StoreMessage) => {\n    delete (message as any).chatId;\n    delete (message as any).timestamp;\n  });\n  return copyedMessages as Message[];\n}\n\nexport default MessageStore;\n","import { ApiMessage } from \"../../../api/types\";\nimport { getActions, getGlobal, setGlobal } from \"../../../global\";\nimport { selectBot, selectChat } from \"../../../global/selectors\";\nimport {\n  ChataiStores,\n  GLOBAL_AI_TAG,\n  GLOBAL_AICHATFOLDERS_LAST_TIME,\n} from \"../store\";\nimport { validateAndFixJsonStructure } from \"../utils/util\";\nimport { isSystemBot } from \"../../../global/helpers\";\nimport {\n  AI_FOLDER_ID,\n  PRESET_FOLDER_ID,\n  SERVICE_NOTIFICATIONS_USER_ID,\n  UNREAD_FOLDER_ID,\n} from \"../../../config\";\nimport { getAITags } from \"./tag-filter\";\nimport { intersection } from \"lodash\";\n\nexport interface AIChatFolder {\n  id?: string;\n  chatId: number;\n  chatTitle?: string;\n  categoryTag: string[];\n  presetTag: string[];\n  AITag: string;\n}\nexport const AI_CHATFOLDERS_LOG_PRE = \"aiChatFoldersTask----\";\nexport const AI_CHATFOLDERS_LIST = [\n  \"Friend\",\n  \"Community\",\n  \"Work\",\n  \"Unrend\",\n  \"Spam\",\n  \"Preset\",\n  \"AI\",\n];\n\nexport const formatJSONContent = (content: string) => {\n  try {\n    const result = validateAndFixJsonStructure(content.trim());\n    if (result.valid) {\n      if (result.fixedJson) {\n        return JSON.parse(result.fixedJson);\n      } else {\n        console.error(\"json parse error\", result.error);\n      }\n    } else {\n      console.error(\"json parse error\", result.error);\n    }\n  } catch (error) {\n    console.error(\"json parse error\", error);\n    return null;\n  }\n};\n\nexport function sleep(ms: number) {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\nasync function chatAIChatFolders(body: string) {\n  const res = await fetch(\n    \"https://telegpt-three.vercel.app/classify-generate\",\n    {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body,\n    }\n  );\n  const resJson = await res.json();\n  const jsonString =  resJson?.text?.replaceAll('\\n', '')?.replace('```json', '')?.replace('```', '')?.trim();\n  try {\n    return JSON.parse(jsonString);\n  } catch (error) {\n    return [];\n  }\n  // return formatJSONContent(resJson?.text);\n}\n\nexport async function saveAiChatFolders(list: AIChatFolder[]) {\n  let global = getGlobal();\n\n  let activeAITag: string[] =\n    global?.chatFolders?.aiChatFolders?.activeAITag ?? [];\n  let allAiChatFolders: AIChatFolder[] = [];\n  list.forEach(async (item) => {\n    const chat = selectChat(global, item.chatId + \"\");\n    const classifyItem = {\n      id: item.chatId + \"\",\n      chatTitle: chat?.title,\n      ...item,\n    };\n    allAiChatFolders.push(classifyItem);\n    ChataiStores.aIChatFolders?.addAIChatFolder(classifyItem);\n  });\n  const aiAllTags = getAITags();\n  activeAITag = intersection(aiAllTags, activeAITag);\n  ChataiStores.general?.set(GLOBAL_AI_TAG, activeAITag);\n  global = {\n    ...global,\n    chatFolders: {\n      ...global.chatFolders,\n      aiChatFolders: {\n        ...global.chatFolders?.aiChatFolders,\n        list: allAiChatFolders,\n        activeAITag,\n      },\n    },\n  };\n  setGlobal(global);\n}\n\nexport function groupAiChatFoldersRes(list: AIChatFolder[]) {\n  let data: { [key: string]: number[] } = {};\n  AI_CHATFOLDERS_LIST.forEach((item) => {\n    const listIds = list\n      .filter((o) => o?.categoryTag?.indexOf(item) >= 0)\n      ?.map((i) => i?.chatId);\n    if (listIds?.length) {\n      data[item] = listIds;\n    }\n  });\n\n  return data;\n}\n\nexport async function batchAiChatFolders(\n  chatMessages: { [key: string]: ApiMessage[] },\n  batchSize: number\n) {\n  const chatKeys = Object.keys(chatMessages);\n  let res: AIChatFolder[] = [];\n  for (let i = 0; i < chatKeys.length; i += batchSize) {\n    const batchKeys = chatKeys.slice(i, i + batchSize);\n    const chatMsgs = batchKeys.map((chatId) => {\n      return {\n        chatId,\n        messages: chatMessages[chatId]\n          .map((message) => message.content.text?.text ?? \"\")\n          .filter((item) => item !== null),\n      };\n    });\n    if (chatMsgs.length) {\n      const aiRes = await chatAIChatFolders(\n        JSON.stringify({\n          messages: chatMsgs,\n          flag: true\n        })\n      );\n      res = res.concat(aiRes);\n    }\n  }\n\n  return res;\n}\n\nexport async function deleteAiChatFolders() {\n  const { deleteChatFolder } = getActions();\n\n  const res = await ChataiStores.folder?.getAllFolders();\n  for (let i = 0; i < (res || [])?.length; i++) {\n    const folderInfoDb = res?.[i];\n    if (folderInfoDb && folderInfoDb?.from === \"AI\") {\n      // 删除AI分类\n      console.log(\n        AI_CHATFOLDERS_LOG_PRE + \"delete: \" + folderInfoDb?.id,\n        new Date()\n      );\n      await deleteChatFolder?.({ id: Number(folderInfoDb?.id) });\n      await sleep(3000);\n    }\n  }\n  ChataiStores.general?.delete(GLOBAL_AICHATFOLDERS_LAST_TIME);\n}\n\nexport function isChatBot(chatId: string) {\n  const global = getGlobal();\n  return (\n    isSystemBot(chatId) ||\n    chatId === SERVICE_NOTIFICATIONS_USER_ID ||\n    selectBot(global, chatId)\n  );\n}\n\nexport async function sortChatFolder() {\n  const global = getGlobal();\n  let ids =\n    Object.keys(global.chatFolders.byId)?.map((item) => Number(item)) || [];\n  if (ids?.length) {\n    ids = [0, ...ids];\n  }\n  console.log(AI_CHATFOLDERS_LOG_PRE + \"sort: \", ids);\n  await getActions().sortChatFolders({ folderIds: ids });\n}\n\nexport function filterAIFolder(ids: number[] | undefined) {\n  return ids?.filter(\n    (id) =>\n      id !== AI_FOLDER_ID && id !== PRESET_FOLDER_ID && id !== UNREAD_FOLDER_ID\n  );\n}\n","import { IS_TEST, PRODUCTION_HOSTNAME } from '../../config';\n\nexport function getPlatform() {\n  const { userAgent, platform } = window.navigator;\n\n  const iosPlatforms = ['iPhone', 'iPad', 'iPod'];\n  if (\n    iosPlatforms.indexOf(platform) !== -1\n    // For new IPads with M1 chip and IPadOS platform returns \"MacIntel\"\n    || (platform === 'MacIntel' && ('maxTouchPoints' in navigator && navigator.maxTouchPoints > 2))\n  ) return 'iOS';\n\n  const macosPlatforms = ['Macintosh', 'MacIntel', 'MacPPC', 'Mac68K'];\n  if (macosPlatforms.indexOf(platform) !== -1) return 'macOS';\n\n  const windowsPlatforms = ['Win32', 'Win64', 'Windows', 'WinCE'];\n  if (windowsPlatforms.indexOf(platform) !== -1) return 'Windows';\n\n  if (/Android/.test(userAgent)) return 'Android';\n\n  if (/Linux/.test(platform)) return 'Linux';\n\n  return undefined;\n}\n\nexport const IS_PRODUCTION_HOST = window.location.host === PRODUCTION_HOSTNAME;\nexport const PLATFORM_ENV = getPlatform();\nexport const IS_MAC_OS = PLATFORM_ENV === 'macOS';\nexport const IS_WINDOWS = PLATFORM_ENV === 'Windows';\nexport const IS_LINUX = PLATFORM_ENV === 'Linux';\nexport const IS_IOS = PLATFORM_ENV === 'iOS';\nexport const IS_ANDROID = PLATFORM_ENV === 'Android';\nexport const IS_MOBILE = IS_IOS || IS_ANDROID;\nexport const IS_SAFARI = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\nexport const IS_YA_BROWSER = navigator.userAgent.includes('YaBrowser');\nexport const IS_FIREFOX = navigator.userAgent.toLowerCase().includes('firefox')\n  || navigator.userAgent.toLowerCase().includes('iceweasel')\n  || navigator.userAgent.toLowerCase().includes('icecat');\nexport const IS_ELECTRON = Boolean(window.electron);\n\nexport enum MouseButton {\n  Main = 0,\n  Auxiliary = 1,\n  Secondary = 2,\n  Fourth = 3,\n  Fifth = 4,\n}\n\nexport const IS_PWA = (\n  window.matchMedia('(display-mode: standalone)').matches\n  || (window.navigator as any).standalone\n  || document.referrer.includes('android-app://')\n);\n\nexport const IS_APP = IS_PWA || IS_ELECTRON;\n\nexport const IS_TOUCH_ENV = window.matchMedia('(pointer: coarse)').matches;\nexport const IS_VOICE_RECORDING_SUPPORTED = Boolean(\n  window.navigator.mediaDevices && 'getUserMedia' in window.navigator.mediaDevices && (\n    window.AudioContext || (window as any).webkitAudioContext\n  ),\n);\nexport const IS_EMOJI_SUPPORTED = PLATFORM_ENV && (IS_MAC_OS || IS_IOS) && isLastEmojiVersionSupported();\n\nexport const IS_SERVICE_WORKER_SUPPORTED = 'serviceWorker' in navigator;\n\n// Remove in mid-late 2025 when Chromium 132 is no longer a problem\n// https://issues.chromium.org/issues/390581541\nconst chromeVersion = navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./)?.[2];\nconst hasBrokenServiceWorkerStreaming = chromeVersion && Number(chromeVersion) === 132;\n// TODO Consider failed service worker\nexport const IS_PROGRESSIVE_SUPPORTED = IS_SERVICE_WORKER_SUPPORTED && !hasBrokenServiceWorkerStreaming;\nexport const IS_OPUS_SUPPORTED = Boolean((new Audio()).canPlayType('audio/ogg; codecs=opus'));\nexport const IS_CANVAS_FILTER_SUPPORTED = (\n  !IS_TEST && 'filter' in (document.createElement('canvas').getContext('2d') || {})\n);\nexport const IS_REQUEST_FULLSCREEN_SUPPORTED = 'requestFullscreen' in document.createElement('div');\nexport const ARE_CALLS_SUPPORTED = !IS_FIREFOX; // https://bugzilla.mozilla.org/show_bug.cgi?id=1923416\nexport const LAYERS_ANIMATION_NAME = IS_ANDROID ? 'slideFade' : IS_IOS ? 'slideLayers' : 'pushSlide';\n\nexport const IS_WAVE_TRANSFORM_SUPPORTED = !IS_MOBILE\n  && !IS_FIREFOX // https://bugzilla.mozilla.org/show_bug.cgi?id=1808785\n  && !IS_SAFARI; // https://bugs.webkit.org/show_bug.cgi?id=245510\nexport const IS_SNAP_EFFECT_SUPPORTED = !IS_MOBILE\n  && !IS_FIREFOX // https://bugzilla.mozilla.org/show_bug.cgi?id=1896504\n  && !IS_SAFARI;\nexport const IS_FLUID_BACKGROUND_SUPPORTED = !IS_FIREFOX;\n\nconst TEST_VIDEO = document.createElement('video');\n\nexport const IS_WEBM_SUPPORTED = Boolean(TEST_VIDEO.canPlayType('video/webm; codecs=\"vp9\"').replace('no', ''));\n\nexport const MASK_IMAGE_DISABLED = true;\nexport const IS_OPFS_SUPPORTED = Boolean(navigator.storage?.getDirectory);\nif (IS_OPFS_SUPPORTED) {\n  // Clear old contents\n  (async () => {\n    try {\n      const directory = await navigator.storage.getDirectory();\n      await directory.removeEntry('downloads', { recursive: true });\n    } catch {\n      // Ignore\n    }\n  })();\n}\n\nexport const IS_OFFSET_PATH_SUPPORTED = CSS.supports('offset-rotate: 0deg');\nexport const IS_BACKDROP_BLUR_SUPPORTED = CSS.supports('backdrop-filter: blur()')\n  || CSS.supports('-webkit-backdrop-filter: blur()');\nexport const IS_INSTALL_PROMPT_SUPPORTED = 'onbeforeinstallprompt' in window;\nexport const IS_OPEN_IN_NEW_TAB_SUPPORTED = !(IS_PWA && IS_MOBILE);\nexport const IS_TRANSLATION_SUPPORTED = !IS_TEST;\nexport const IS_VIEW_TRANSITION_SUPPORTED = 'ViewTransition' in window;\n\nexport const MESSAGE_LIST_SENSITIVE_AREA = 750;\n\nexport const SCROLLBAR_WIDTH = (() => {\n  const el = document.createElement('div');\n  el.style.cssText = 'overflow:scroll; visibility:hidden; position:absolute;';\n  el.classList.add('custom-scroll');\n  document.body.appendChild(el);\n  const width = el.offsetWidth - el.clientWidth;\n  el.remove();\n\n  document.documentElement.style.setProperty('--scrollbar-width', `${width}px`);\n\n  return width;\n})();\n\nexport const MAX_BUFFER_SIZE = (IS_MOBILE ? 512 : 2000) * 1024 ** 2; // 512 OR 2000 MB\n\nfunction isLastEmojiVersionSupported() {\n  const ALLOWABLE_CALCULATION_ERROR_SIZE = 5;\n  const inlineEl = document.createElement('span');\n  inlineEl.classList.add('emoji-test-element');\n  document.body.appendChild(inlineEl);\n\n  inlineEl.innerText = '🇨🇶'; // Emoji from 16.0 version\n  const newEmojiWidth = inlineEl.offsetWidth;\n  inlineEl.innerText = '❤️'; // Emoji from 1.0 version\n  const legacyEmojiWidth = inlineEl.offsetWidth;\n\n  document.body.removeChild(inlineEl);\n\n  return Math.abs(newEmojiWidth - legacyEmojiWidth) < ALLOWABLE_CALCULATION_ERROR_SIZE;\n}\n\nexport const IS_GEOLOCATION_SUPPORTED = 'geolocation' in navigator;\n\nexport const getGeolocationStatus = async () => {\n  try {\n    const permissionStatus = await navigator.permissions.query({ name: 'geolocation' });\n\n    if (permissionStatus.state === 'granted' || permissionStatus.state === 'prompt') {\n      const geolocation = await new Promise<GeolocationCoordinates>((resolve, reject) => {\n        navigator.geolocation.getCurrentPosition(\n          (position) => resolve(position.coords),\n          (error) => reject(error),\n        );\n      });\n      return { accessRequested: true, accessGranted: true, geolocation };\n    }\n    if (permissionStatus.state === 'denied') {\n      return { accessRequested: true, accessGranted: false };\n    }\n  } catch (error) {\n    return { accessRequested: false, accessGranted: false };\n  }\n\n  return { accessRequested: false, accessGranted: false };\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"link\":\"swBnOk1h\",\"isPrimary\":\"Jz1SC8nz\"};","import type { FC } from '../../lib/teact/teact';\nimport React from '../../lib/teact/teact';\n\nimport buildClassName from '../../util/buildClassName';\n\nimport useLastCallback from '../../hooks/useLastCallback';\n\nimport styles from './Link.module.scss';\n\ntype OwnProps = {\n  children: React.ReactNode;\n  className?: string;\n  isRtl?: boolean;\n  isPrimary?: boolean;\n  withMultilineFix?: boolean;\n  onClick?: (e: React.MouseEvent<HTMLAnchorElement>) => void;\n};\n\nconst Link: FC<OwnProps> = ({\n  children, isPrimary, className, isRtl, withMultilineFix, onClick,\n}) => {\n  const handleClick = useLastCallback((e: React.MouseEvent<HTMLAnchorElement>) => {\n    e.preventDefault();\n    onClick!(e);\n  });\n\n  return (\n    <a\n      href=\"#\"\n      className={buildClassName('Link', styles.link, className, isPrimary && styles.isPrimary)}\n      dir={!withMultilineFix ? (isRtl ? 'rtl' : 'auto') : undefined}\n      onClick={onClick ? handleClick : undefined}\n    >\n      {children}\n    </a>\n  );\n};\n\nexport default Link;\n","import type { TeactNode } from '../../lib/teact/teact';\n\nimport type { LangFn } from './types';\n\nconst UNIQUE_PLACEHOLDER_PREFIX = '$PLACEHOLDER-';\n\nexport function conjuctionWithNodes(langFn: LangFn, nodes: TeactNode[]) {\n  const placeholders = nodes.map((node, i) => `${UNIQUE_PLACEHOLDER_PREFIX}${i}`);\n  const replaced = langFn.internalFormatters.conjunction.formatToParts(placeholders);\n  const result: TeactNode[] = [];\n  replaced.forEach((part) => {\n    if (part.type === 'literal') {\n      result.push(part.value);\n      return;\n    }\n\n    const index = Number(part.value.slice(UNIQUE_PLACEHOLDER_PREFIX.length));\n    result.push(nodes[index]);\n  });\n\n  return result;\n}\n\nexport function disjunctionWithNodes(langFn: LangFn, nodes: TeactNode[]) {\n  const placeholders = nodes.map((node, i) => `${UNIQUE_PLACEHOLDER_PREFIX}${i}`);\n  const replaced = langFn.internalFormatters.disjunction.formatToParts(placeholders);\n  const result: TeactNode[] = [];\n  replaced.forEach((part) => {\n    if (part.type === 'literal') {\n      result.push(part.value);\n      return;\n    }\n\n    const index = Number(part.value.slice(UNIQUE_PLACEHOLDER_PREFIX.length));\n    result.push(nodes[index]);\n  });\n\n  return result;\n}\n","import React, { memo, type TeactNode } from '../../../lib/teact/teact';\nimport { getActions, getGlobal, withGlobal } from '../../../global';\n\nimport type { ApiChat, ApiMessage, ApiPeer } from '../../../api/types';\n\nimport {\n  GENERAL_TOPIC_ID,\n  SERVICE_NOTIFICATIONS_USER_ID,\n  TME_LINK_PREFIX,\n} from '../../../config';\nimport {\n  getMessageInvoice, getMessageText, isChatChannel,\n} from '../../../global/helpers';\nimport { getPeerTitle } from '../../../global/helpers/peers';\nimport { getMessageReplyInfo } from '../../../global/helpers/replies';\nimport {\n  selectChat,\n  selectChatMessage,\n  selectPeer,\n  selectSender,\n  selectThreadIdFromMessage,\n  selectTopic,\n} from '../../../global/selectors';\nimport { ensureProtocol } from '../../../util/browser/url';\nimport { formatDateTimeToString, formatShortDuration } from '../../../util/dates/dateFormat';\nimport { formatCurrency } from '../../../util/formatCurrency';\nimport { formatStarsAsText } from '../../../util/localization/format';\nimport { conjuctionWithNodes } from '../../../util/localization/utils';\nimport renderText from '../../common/helpers/renderText';\nimport { renderTextWithEntities } from '../../common/helpers/renderTextWithEntities';\nimport {\n  getCallMessageKey,\n  getPinnedMediaValue,\n  renderMessageLink,\n  renderPeerLink,\n  translateWithYou,\n} from './helpers/messageActions';\n\nimport useLang from '../../../hooks/useLang';\nimport useLastCallback from '../../../hooks/useLastCallback';\n\nimport CustomEmoji from '../../common/CustomEmoji';\nimport TopicDefaultIcon from '../../common/TopicDefaultIcon';\nimport Link from '../../ui/Link';\n\nimport styles from './ActionMessage.module.scss';\n\ntype OwnProps = {\n  message: ApiMessage;\n  isInsideTopic?: boolean;\n  asPreview?: boolean;\n};\n\ntype StateProps = {\n  currentUserId?: string;\n  sender?: ApiPeer;\n  replyMessage?: ApiMessage;\n  chat?: ApiChat;\n};\n\nconst NBSP = '\\u00A0';\nconst DEFAULT_TOPIC_ICON_ID = '0';\n\nconst UNSUPPORTED_LANG_KEY = 'ActionUnsupported';\n\nconst ActionMessageText = ({\n  message,\n  currentUserId,\n  sender,\n  chat,\n  replyMessage,\n  isInsideTopic,\n  asPreview,\n}: OwnProps & StateProps) => {\n  const {\n    openThread,\n    openTelegramLink,\n    openUrl,\n  } = getActions();\n  const { chatId, isOutgoing } = message;\n  const action = message.content.action!;\n\n  const lang = useLang();\n\n  function renderStrong(text: TeactNode) {\n    if (asPreview) return text;\n    return <span className={styles.strong}>{text}</span>;\n  }\n\n  const renderActionText = useLastCallback(() => {\n    const global = getGlobal();\n\n    const isChannel = chat && isChatChannel(chat);\n    const isServiceNotificationsChat = chatId === SERVICE_NOTIFICATIONS_USER_ID;\n    const isSavedMessages = chatId === currentUserId;\n\n    const senderTitle = sender && getPeerTitle(lang, sender);\n    const chatTitle = chat && getPeerTitle(lang, chat);\n\n    const userFallbackText = lang('ActionFallbackUser');\n    const chatFallbackText = lang('ActionFallbackChat');\n    const channelFallbackText = lang('ActionFallbackChannel');\n\n    const senderLink = renderPeerLink(sender?.id, senderTitle || userFallbackText, asPreview);\n    const chatLink = renderPeerLink(chat?.id, chatTitle || chatFallbackText, asPreview);\n\n    switch (action.type) {\n      case 'pinMessage': {\n        if (replyMessage) {\n          const formattedText = getMessageText(replyMessage);\n          if (formattedText) {\n            const textLink = renderMessageLink(\n              replyMessage,\n              renderTextWithEntities({\n                text: formattedText.text,\n                entities: formattedText.entities,\n                asPreview: true,\n              }),\n              asPreview,\n            );\n\n            return translateWithYou(\n              lang, 'ActionPinnedText', isOutgoing, { text: textLink, from: senderLink },\n            );\n          }\n\n          const mediaValue = getPinnedMediaValue(lang, replyMessage);\n          if (mediaValue) {\n            const messageLink = renderMessageLink(replyMessage, mediaValue, asPreview);\n            return translateWithYou(\n              lang, 'ActionPinnedMedia', isOutgoing, { from: senderLink, media: messageLink },\n            );\n          }\n        }\n\n        return translateWithYou(\n          lang,\n          'ActionPinnedNotFound',\n          isOutgoing,\n          { from: senderLink },\n        );\n      }\n\n      case 'gameScore': {\n        const { score } = action;\n\n        const gameTitle = replyMessage?.content.game?.title;\n        const gameLink = gameTitle && renderMessageLink(replyMessage, renderText(gameTitle), asPreview);\n\n        if (gameLink) {\n          return translateWithYou(\n            lang,\n            'ActionGameScore',\n            isOutgoing,\n            { from: senderLink, count: score, game: gameLink },\n            { pluralValue: score },\n          );\n        }\n\n        return translateWithYou(\n          lang, 'ActionGameScoreNoGame', isOutgoing, { from: senderLink, count: score }, { pluralValue: score },\n        );\n      }\n\n      case 'chatJoinedByLink':\n        return lang('ActionUserJoinedByLink', { from: senderLink }, { withNodes: true });\n\n      case 'chatJoinedByRequest':\n        return translateWithYou(lang, 'ActionJoinedByRequest', isOutgoing, { from: senderLink });\n\n      case 'channelJoined': {\n        const { isViaRequest, inviterId } = action;\n        const inviter = inviterId ? selectPeer(global, inviterId) : undefined;\n        if (inviter && inviterId !== currentUserId) {\n          const inviterLink = renderPeerLink(inviterId, getPeerTitle(lang, inviter) || userFallbackText, asPreview);\n          return lang('ActionAddYou', { from: inviterLink }, { withNodes: true });\n        }\n\n        return lang(isViaRequest ? 'ActionChannelJoinedByRequestChannelYou' : 'ActionChannelJoinedYou');\n      }\n\n      case 'chatEditTitle': {\n        const { title } = action;\n        if (isChannel) return lang('ActionChangedTitleChannel', { title });\n        return translateWithYou(lang, 'ActionChangedTitle', isOutgoing, { title, from: senderLink });\n      }\n\n      case 'chatDeletePhoto':\n        return isChannel ? lang('ActionRemovedPhotoChannel')\n          : translateWithYou(lang, 'ActionRemovedPhoto', isOutgoing, { from: senderLink });\n\n      case 'chatEditPhoto':\n        return isChannel ? lang('ActionChangedPhotoChannel')\n          : translateWithYou(lang, 'ActionChangedPhoto', isOutgoing, { from: senderLink });\n\n      case 'chatCreate': {\n        const { title } = action;\n        return lang('ActionCreatedChat', { title, from: senderLink }, { withNodes: true });\n      }\n\n      case 'channelCreate': {\n        const { title } = action;\n        return isChannel ? lang('ActionCreatedChannel')\n          : translateWithYou(lang, 'ActionCreatedChat', isOutgoing, { title, from: senderLink });\n      }\n\n      case 'chatMigrateTo': {\n        const { channelId } = action;\n        const channel = selectChat(global, channelId)!;\n        const channelLink = renderPeerLink(channelId, getPeerTitle(lang, channel)!, asPreview);\n        return lang('ActionMigratedTo', { chat: channelLink }, { withNodes: true });\n      }\n\n      case 'channelMigrateFrom': {\n        const { chatId: originalChatId, title } = action;\n        const originalChatLink = renderPeerLink(originalChatId, title || chatFallbackText, asPreview);\n        return lang('ActionMigratedFrom', { chat: originalChatLink }, { withNodes: true });\n      }\n\n      case 'topicCreate': {\n        const { title, iconColor, iconEmojiId } = action;\n\n        const topicId = selectThreadIdFromMessage(global, message);\n\n        const topicLink = (\n          <Link\n            className={styles.topicLink}\n            // eslint-disable-next-line react/jsx-no-bind\n            onClick={() => openThread({ chatId, threadId: topicId })}\n          >\n            {iconEmojiId ? <CustomEmoji documentId={iconEmojiId} isSelectable />\n              : <TopicDefaultIcon topicId={topicId} title={title} iconColor={iconColor} />}\n            {NBSP}\n            {renderText(title)}\n          </Link>\n        );\n        return lang('ActionTopicCreated', { topic: topicLink }, { withNodes: true });\n      }\n\n      case 'topicEdit': {\n        const {\n          iconEmojiId, isClosed, isHidden, title,\n        } = action;\n\n        const topicId = selectThreadIdFromMessage(global, message);\n        const currentTopic = selectTopic(global, chatId, topicId);\n        const topicLink = (\n          <Link\n            className={styles.topicLink}\n            // eslint-disable-next-line react/jsx-no-bind\n            onClick={() => openThread({ chatId, threadId: topicId })}\n          >\n            {iconEmojiId && iconEmojiId !== DEFAULT_TOPIC_ICON_ID\n              ? <CustomEmoji documentId={iconEmojiId} isSelectable />\n              : (\n                <TopicDefaultIcon\n                  topicId={topicId}\n                  title={title || currentTopic?.title || lang('ActionTopicPlaceholder')}\n                  iconColor={currentTopic?.iconColor}\n                />\n              )}\n            {topicId !== GENERAL_TOPIC_ID && NBSP}\n            {renderText(title || currentTopic?.title || lang('ActionTopicPlaceholder'))}\n          </Link>\n        );\n\n        const topicPlaceholderLink = (\n          <Link\n            className={styles.topicLink}\n            // eslint-disable-next-line react/jsx-no-bind\n            onClick={() => openThread({ chatId, threadId: topicId })}\n          >\n            {lang('ActionTopicPlaceholder')}\n          </Link>\n        );\n\n        if (isClosed !== undefined) {\n          if (isInsideTopic) {\n            return lang(isClosed ? 'ActionTopicClosedInside' : 'ActionTopicReopenedInside');\n          }\n\n          return lang(\n            isClosed ? 'ActionTopicClosed' : 'ActionTopicReopened',\n            { from: senderLink, topic: topicLink },\n            { withNodes: true },\n          );\n        }\n\n        if (isHidden !== undefined) {\n          if (isInsideTopic) {\n            return lang(isHidden ? 'ActionTopicHiddenInside' : 'ActionTopicUnhiddenInside');\n          }\n          return lang(\n            isHidden ? 'ActionTopicHidden' : 'ActionTopicUnhidden',\n            { topic: topicLink },\n            { withNodes: true },\n          );\n        }\n\n        if (title && iconEmojiId) {\n          return lang(\n            'ActionTopicIconAndRenamed',\n            {\n              from: senderLink,\n              link: topicPlaceholderLink,\n              topic: topicLink,\n            },\n            { withNodes: true },\n          );\n        }\n\n        if (title === undefined) {\n          if (!iconEmojiId || iconEmojiId === DEFAULT_TOPIC_ICON_ID) {\n            return lang(\n              'ActionTopicIconRemoved', { from: senderLink, link: topicPlaceholderLink }, { withNodes: true },\n            );\n          }\n          return lang(\n            'ActionTopicIconChanged',\n            {\n              from: senderLink,\n              link: topicPlaceholderLink,\n              emoji: <CustomEmoji documentId={iconEmojiId} loopLimit={2} />,\n            },\n            { withNodes: true },\n          );\n        }\n\n        return lang('ActionTopicRenamed', { from: senderLink, link: topicPlaceholderLink, title }, { withNodes: true });\n      }\n\n      case 'boostApply':\n        return translateWithYou(\n          lang,\n          'ActionBoostApply',\n          isOutgoing,\n          { from: senderLink, count: action.boosts },\n          { pluralValue: action.boosts },\n        );\n\n      case 'chatAddUser': {\n        const { userIds } = action;\n\n        if (sender?.id === userIds[0]) {\n          return translateWithYou(lang, 'ActionUserJoined', isOutgoing, { from: senderLink });\n        }\n\n        if (userIds.length === 1) {\n          const user = selectPeer(global, userIds[0]);\n          const userTitle = (user && getPeerTitle(lang, user)) || userFallbackText;\n          const userLink = renderPeerLink(user?.id, userTitle, asPreview);\n          return translateWithYou(lang, 'ActionAddUser', isOutgoing, { from: senderLink, user: userLink });\n        }\n\n        const users = userIds.map((userId) => selectPeer(global, userId)).filter(Boolean);\n\n        if (!users.length) {\n          return translateWithYou(lang, 'ActionAddUser', isOutgoing, { from: senderLink, user: userFallbackText });\n        }\n\n        const userLinks = users.map((user) => (\n          renderPeerLink(user.id, getPeerTitle(lang, user) || userFallbackText, asPreview)\n        ));\n\n        return translateWithYou(\n          lang, 'ActionAddUsersMany', isOutgoing, { from: senderLink, users: conjuctionWithNodes(lang, userLinks) },\n        );\n      }\n\n      case 'chatDeleteUser': {\n        const { userId } = action;\n        if (sender?.id === userId) {\n          return translateWithYou(lang, 'ActionUserLeft', isOutgoing, { from: senderLink });\n        }\n\n        const user = selectPeer(global, userId);\n        const userTitle = (user && getPeerTitle(lang, user)) || userFallbackText;\n        const userLink = renderPeerLink(user?.id, userTitle, asPreview);\n        return translateWithYou(lang, 'ActionKickUser', isOutgoing, { from: senderLink, user: userLink });\n      }\n\n      case 'botAllowed': {\n        const {\n          app, domain, isAttachMenu, isFromRequest,\n        } = action;\n        if (isAttachMenu) return lang('ActionAttachMenuBotAllowed');\n        if (isFromRequest) return lang('ActionWebappBotAllowed');\n        if (app) {\n          const link = sender?.usernames?.length\n            && `${TME_LINK_PREFIX + sender.usernames[0].username}/${app.shortName}`;\n          const appLink = link\n            // eslint-disable-next-line react/jsx-no-bind\n            ? <Link onClick={() => openTelegramLink({ url: link })}>{app.title}</Link>\n            : lang('ActionBotAppPlaceholder');\n          return lang('ActionBotAllowedFromApp', { app: appLink }, { withNodes: true });\n        }\n\n        if (!domain) return lang(UNSUPPORTED_LANG_KEY);\n\n        const url = ensureProtocol(domain)!;\n        // eslint-disable-next-line react/jsx-no-bind\n        const link = <Link onClick={() => openUrl({ url })}>{domain}</Link>;\n        return lang('ActionBotAllowedFromDomain', { domain: link }, { withNodes: true });\n      }\n\n      case 'giveawayLaunch': {\n        const { stars } = action;\n\n        if (stars) {\n          return lang(\n            isChannel ? 'ActionGiveawayStarsStarted' : 'ActionGiveawayStarsStartedGroup',\n            { from: senderLink, amount: renderStrong(formatStarsAsText(lang, stars)) },\n            { withNodes: true },\n          );\n        }\n\n        return lang(\n          isChannel ? 'ActionGiveawayStarted' : 'ActionGiveawayStartedGroup',\n          { from: senderLink },\n          { withNodes: true },\n        );\n      }\n\n      case 'giveawayResults': {\n        const { winnersCount, isStars, unclaimedCount } = action;\n        if (!winnersCount) return lang('ActionGiveawayResultsNone');\n        if (unclaimedCount) {\n          return lang(isStars ? 'ActionGiveawayResultsStarsSome' : 'ActionGiveawayResultsSome');\n        }\n\n        return lang(\n          isStars ? 'ActionGiveawayResultsStars' : 'ActionGiveawayResults',\n          { count: winnersCount },\n          { pluralValue: winnersCount },\n        );\n      }\n\n      case 'giftStars':\n      case 'giftPremium': {\n        const {\n          amount, currency, cryptoAmount, cryptoCurrency,\n        } = action;\n\n        const price = formatCurrency(lang, amount, currency, { asFontIcon: true });\n        const cryptoPrice = cryptoAmount ? formatCurrency(lang, cryptoAmount, cryptoCurrency!) : undefined;\n\n        const cost = cryptoPrice ? lang('ActionCostCrypto', { price, cryptoPrice }, { withNodes: true }) : price;\n\n        if (isServiceNotificationsChat) {\n          return lang('ActionGiftTextCostAnonymous', { cost }, { withNodes: true });\n        }\n        return translateWithYou(\n          lang, 'ActionGiftTextCost', isOutgoing, { from: senderLink, cost: renderStrong(cost) },\n        );\n      }\n\n      case 'prizeStars':\n      case 'giftCode': {\n        return lang('ActionGiftTextUnknown');\n      }\n\n      case 'groupCall': {\n        const { duration } = action;\n        const durationText = duration ? formatShortDuration(lang, duration) : undefined;\n        if (durationText) {\n          if (isChannel) {\n            return lang('ActionGroupCallFinishedChannel', { duration: durationText });\n          }\n          return lang(\n            'ActionGroupCallFinishedGroup', { from: senderLink, duration: durationText }, { withNodes: true },\n          );\n        }\n\n        if (isChannel) return lang('ActionGroupCallStartedChannel');\n        return lang('ActionGroupCallStartedGroup', { from: senderLink }, { withNodes: true });\n      }\n\n      case 'groupCallScheduled': {\n        const { scheduleDate } = action;\n        const formattedDate = formatDateTimeToString(scheduleDate * 1000, lang.code, true);\n\n        if (isChannel) return lang('ActionGroupCallScheduledChannel', { date: formattedDate });\n        return lang('ActionGroupCallScheduledGroup', { from: senderLink, date: formattedDate }, { withNodes: true });\n      }\n\n      case 'inviteToGroupCall': {\n        const { userIds } = action;\n\n        if (userIds.length === 1) {\n          const user = selectPeer(global, userIds[0]);\n          const userTitle = (user && getPeerTitle(lang, user)) || userFallbackText;\n          const userLink = renderPeerLink(user?.id, userTitle, asPreview);\n          return translateWithYou(lang, 'ActionVideoInvited', isOutgoing, { from: senderLink, user: userLink });\n        }\n\n        const users = userIds.map((userId) => selectPeer(global, userId)).filter(Boolean);\n\n        if (!users.length) {\n          return translateWithYou(\n            lang, 'ActionVideoInvited', isOutgoing, { from: senderLink, user: userFallbackText },\n          );\n        }\n\n        const userLinks = users.map((user) => (\n          renderPeerLink(user.id, getPeerTitle(lang, user) || userFallbackText, asPreview)\n        ));\n\n        return translateWithYou(\n          lang, 'ActionVideoInvitedMany', isOutgoing, { from: senderLink, users: conjuctionWithNodes(lang, userLinks) },\n        );\n      }\n\n      case 'paymentSent': {\n        const {\n          currency, totalAmount, isRecurringInit, isRecurringUsed,\n        } = action;\n\n        const cost = renderStrong(formatCurrency(lang, totalAmount, currency, { asFontIcon: true }));\n        const invoice = replyMessage && getMessageInvoice(replyMessage);\n        const invoiceTitle = invoice?.title;\n\n        if (isRecurringUsed) {\n          return lang('ActionPaymentUsedRecurring', { amount: cost }, { withNodes: true });\n        }\n\n        if (!invoiceTitle) {\n          if (isRecurringInit) {\n            return lang('ActionPaymentInitRecurring', { amount: cost, user: chatLink }, { withNodes: true });\n          }\n\n          return lang('ActionPaymentDone', { amount: cost, user: chatLink }, { withNodes: true });\n        }\n\n        if (isRecurringInit) {\n          return lang(\n            'ActionPaymentInitRecurringFor',\n            { amount: cost, user: chatLink, invoice: renderMessageLink(replyMessage!, invoiceTitle, asPreview) },\n            { withNodes: true },\n          );\n        }\n\n        return lang(\n          'ActionPaymentDoneFor',\n          { amount: cost, user: chatLink, invoice: renderMessageLink(replyMessage!, invoiceTitle, asPreview) },\n          { withNodes: true },\n        );\n      }\n\n      case 'paymentRefunded': {\n        const { currency, totalAmount, peerId } = action;\n        const peer = selectPeer(global, peerId);\n        const peerTitle = (peer && getPeerTitle(lang, peer)) || userFallbackText;\n        const peerLink = renderPeerLink(peer?.id, peerTitle, asPreview);\n        const amount = formatCurrency(lang, totalAmount, currency, { asFontIcon: true });\n\n        return lang('ActionPaymentRefunded', { peer: peerLink, amount }, { withNodes: true });\n      }\n\n      case 'starGift': {\n        const {\n          gift, alreadyPaidUpgradeStars, peerId, savedId, fromId,\n        } = action;\n        const isToChannel = Boolean(peerId && savedId);\n\n        const fromPeer = fromId ? selectPeer(global, fromId) : sender;\n        const fromTitle = (fromPeer && getPeerTitle(lang, fromPeer)) || userFallbackText;\n        const fromLink = renderPeerLink(fromPeer?.id, fromTitle, asPreview);\n\n        const starsAmount = gift.stars + (alreadyPaidUpgradeStars || 0);\n        const cost = renderStrong(formatStarsAsText(lang, starsAmount));\n\n        if (isToChannel) {\n          const channelPeer = selectPeer(global, peerId!);\n          const isYou = fromPeer?.id === currentUserId;\n\n          const channelTitle = (channelPeer && getPeerTitle(lang, channelPeer)) || channelFallbackText;\n          const channelLink = renderPeerLink(peerId, channelTitle, asPreview);\n          return translateWithYou(\n            lang, 'ActionStarGiftSentChannel', isYou, { user: fromLink, channel: channelLink, cost },\n          );\n        }\n\n        if (isServiceNotificationsChat) {\n          return lang('ActionStarGiftReceivedAnonymous', { cost }, { withNodes: true });\n        }\n\n        if (isSavedMessages) {\n          return lang('ActionStarGiftSelfBought', { cost }, { withNodes: true });\n        }\n\n        if (isOutgoing) {\n          return lang('ActionStarGiftSent', { cost }, { withNodes: true });\n        }\n\n        return lang('ActionStarGiftReceived', { user: senderLink, cost }, { withNodes: true });\n      }\n\n      case 'starGiftUnique': {\n        const {\n          isTransferred, isUpgrade, savedId, peerId, fromId,\n        } = action;\n\n        const isToChannel = Boolean(peerId && savedId);\n\n        const fromPeer = fromId ? selectPeer(global, fromId) : sender;\n        const fromTitle = (fromPeer && getPeerTitle(lang, fromPeer)) || userFallbackText;\n        const fromLink = renderPeerLink(fromPeer?.id, fromTitle, asPreview);\n\n        if (isToChannel) {\n          const channelPeer = selectPeer(global, peerId!);\n          const isYou = fromPeer?.id === currentUserId;\n          const isAnonymous = fromPeer?.id === SERVICE_NOTIFICATIONS_USER_ID;\n\n          const channelTitle = (channelPeer && getPeerTitle(lang, channelPeer)) || channelFallbackText;\n          const channelLink = renderPeerLink(peerId, channelTitle, asPreview);\n\n          if (isUpgrade) {\n            return translateWithYou(\n              lang, 'ActionStarGiftUpgradedChannel', isYou, { user: fromLink, channel: channelLink },\n            );\n          }\n\n          if (isTransferred) {\n            if (isAnonymous) {\n              return lang('ActionStarGiftTransferredUnknownChannel', { channel: channelLink }, { withNodes: true });\n            }\n\n            return translateWithYou(\n              lang, 'ActionStarGiftTransferredChannel', isYou, { user: fromLink, channel: channelLink },\n            );\n          }\n        }\n\n        if (isSavedMessages) {\n          if (isUpgrade) return lang('ActionStarGiftUpgradedSelf');\n          if (isTransferred) return lang('ActionStarGiftTransferredSelf');\n        }\n\n        if (isUpgrade) {\n          if (isOutgoing) {\n            return lang('ActionStarGiftUpgradedMine', { user: chatLink }, { withNodes: true });\n          }\n\n          if (isSavedMessages) {\n            return lang('ActionStarGiftUpgradedSelf');\n          }\n\n          return lang('ActionStarGiftUpgradedUser', { user: senderLink }, { withNodes: true });\n        }\n\n        if (isTransferred) {\n          if (sender?.id === SERVICE_NOTIFICATIONS_USER_ID) {\n            return lang('ActionStarGiftTransferredUnknown');\n          }\n\n          if (isSavedMessages) {\n            return lang('ActionStarGiftTransferredSelf');\n          }\n\n          if (isOutgoing) {\n            return lang('ActionStarGiftTransferredMine', { user: chatLink }, { withNodes: true });\n          }\n\n          return lang('ActionStarGiftTransferred', { user: senderLink }, { withNodes: true });\n        }\n\n        if (isOutgoing) {\n          return lang('ActionGiftUniqueSent');\n        }\n\n        return lang('ActionGiftUniqueReceived', { user: senderLink }, { withNodes: true });\n      }\n\n      case 'suggestProfilePhoto': {\n        const actionPeer = (isOutgoing ? chat : sender)!;\n        const actionPeerLink = renderPeerLink(\n          actionPeer.id, getPeerTitle(lang, actionPeer) || userFallbackText, asPreview,\n        );\n\n        return translateWithYou(lang, 'ActionSuggestedPhoto', isOutgoing, { user: actionPeerLink });\n      }\n\n      case 'webViewDataSent':\n        return lang('ActionWebviewDataDone', { text: action.text });\n\n      case 'expired': {\n        const { isRoundVideo, isVoice } = action;\n        if (isVoice) return lang('ActionExpiredVoice');\n        if (isRoundVideo) return lang('ActionExpiredVideo');\n\n        return lang(UNSUPPORTED_LANG_KEY);\n      }\n\n      case 'historyClear':\n        return lang('ActionHistoryCleared');\n\n      case 'screenshotTaken':\n        return translateWithYou(lang, 'ActionScreenshotTaken', isOutgoing, { from: senderLink });\n\n      case 'contactSignUp':\n        return lang('ActionUserRegistered', { from: senderLink }, { withNodes: true });\n\n      case 'customAction':\n        return action.message;\n\n      case 'paidMessagesPrice': {\n        const { stars } = action;\n        if (stars === 0) {\n          return lang('ActionPaidMessageGroupPriceFree');\n        }\n        return lang('ActionPaidMessageGroupPrice', {\n          stars: formatStarsAsText(lang, stars),\n        }, { withNodes: true, withMarkdown: true });\n      }\n\n      case 'paidMessagesRefunded': {\n        const { stars } = action;\n        const user = selectPeer(global, chatId);\n        const userTitle = (user && getPeerTitle(lang, user)) || userFallbackText;\n\n        const key = isOutgoing\n          ? 'ApiMessageActionPaidMessagesRefundedOutgoing'\n          : 'ApiMessageActionPaidMessagesRefundedIncoming';\n\n        return lang(key, {\n          stars: formatStarsAsText(lang, stars),\n          user: renderPeerLink(user?.id, userTitle),\n        }, { withNodes: true, withMarkdown: true });\n      }\n\n      case 'phoneCall': // Rendered as a regular message, but considered an action for the summary\n        return lang(getCallMessageKey(action, isOutgoing));\n      default:\n        return lang(UNSUPPORTED_LANG_KEY);\n    }\n  });\n\n  return renderActionText();\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global, { message }): StateProps => {\n    const chat = selectChat(global, message.chatId);\n    const sender = selectSender(global, message);\n\n    const { replyToMsgId, replyToPeerId } = getMessageReplyInfo(message) || {};\n    const replyMessage = replyToMsgId\n      ? selectChatMessage(global, replyToPeerId || message.chatId, replyToMsgId) : undefined;\n\n    return {\n      currentUserId: global.currentUserId,\n      replyMessage,\n      chat,\n      sender,\n    };\n  },\n)(ActionMessageText));\n","/* eslint-disable no-console */\n/* eslint-disable no-null/no-null */\nimport { v4 as uuidv4 } from 'uuid';\n\nimport type { ApiMessage } from '../../../api/types/messages';\nimport type { SummaryStoreMessage } from '../store/summary-store';\nimport type { UrgentTopic } from '../store/urgent-topic-store';\n\nimport eventEmitter, { Actions } from '../lib/EventEmitter';\nimport GlobalSummaryBadge from '../globalSummary/global-summary-badge';\nimport { DefaultUrgentTopic } from '../prompt';\nimport { ChataiStores } from '../store';\nimport { URGENT_CHATS } from '../store/general-store';\nimport { sendGAEvent } from '../utils/analytics';\n\nfunction getStrongAlertPhoneNumber(\n  data: Array<{\n    chatId: string;\n    messageId: string;\n    content: string;\n    matchUrgentTopicIds: string[];\n  }>,\n  topics: Array<UrgentTopic>,\n) {\n  if (data instanceof Array && data.length > 0) {\n    const mergedUniqueTopicIds = Array.from(\n      // eslint-disable-next-line @typescript-eslint/no-shadow\n      new Set(data.flatMap((item) => item.matchUrgentTopicIds)),\n    );\n    const phoneNumber = topics.find(\n      (topic) => mergedUniqueTopicIds.includes(topic.id) && topic.strongAlert,\n    )?.phoneNumber;\n    return phoneNumber || null;\n  }\n  return null;\n}\n\nclass UrgentCheckTask {\n  private static instance: UrgentCheckTask | undefined;\n\n  private pendingMessages: ApiMessage[] = [];\n\n  private urgentChats: string[] = [];\n\n  private urgentChatsInitialized: boolean = false;\n\n  private timmer: NodeJS.Timeout | undefined;\n\n  initTask() {\n    if (this.timmer) {\n      clearInterval(this.timmer);\n    }\n    this.timmer = setInterval(() => {\n      this.checkUrgentMessage();\n    }, 1000 * 60 * 5); // 每5分钟检查一次\n  }\n\n  static getTextWithoutEntities(text: string, entities: any[]): string {\n    const ranges = entities.map((entity) => ({\n      start: entity.offset,\n      length: entity.length,\n    }));\n    const sortedRanges = ranges.sort((a, b) => b.start - a.start);\n\n    // eslint-disable-next-line @typescript-eslint/no-shadow\n    for (const { start, length } of sortedRanges) {\n      text = text.slice(0, start) + text.slice(start + length);\n    }\n    return text;\n  }\n\n  checkUrgentMessage() {\n    if (!this.pendingMessages.length) return;\n    console.log('checkUrgentMessage', this.pendingMessages);\n    const messages = this.pendingMessages.map((item) => {\n      return {\n        chatId: item.chatId,\n        senderId: item.senderId,\n        messageId: item.id,\n        content: item.content.text?.text,\n      };\n    });\n    ChataiStores.urgentTopic?.getAllUrgentTopic().then((topics) => {\n      topics.unshift(DefaultUrgentTopic);\n      fetch('https://telegpt-three.vercel.app/urgent-message-check', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          messages,\n          urgentTopics: topics,\n        }),\n      })\n        .then((response) => response.json())\n        .then((data) => {\n          console.log('urgent check response', data);\n          const matchs = data?.data || [];\n          if (matchs.length > 0) {\n            const newMessage: SummaryStoreMessage = {\n              timestamp: new Date().getTime(),\n              content: JSON.stringify(matchs),\n              id: uuidv4(),\n              createdAt: new Date(),\n              role: 'assistant',\n              annotations: [\n                {\n                  type: 'urgent-message-check',\n                },\n              ],\n            };\n            ChataiStores.summary?.storeMessage(newMessage);\n            eventEmitter.emit(Actions.AddUrgentMessage, newMessage);\n            GlobalSummaryBadge.increaseUnreadCount();\n            // check strong alert\n            try {\n              const strongAlertPhoneNumber = getStrongAlertPhoneNumber(matchs, topics);\n              if (strongAlertPhoneNumber) {\n                fetch(`https://telegpt-three.vercel.app/voice-call?phoneNumber=${strongAlertPhoneNumber}`, {\n                  method: 'GET',\n                });\n                sendGAEvent('call_reminder');\n              }\n            } catch (e) {\n              console.log('error', e);\n            }\n          }\n        });\n    });\n    this.clearPendingMessages();\n  }\n\n  updateUrgentChats(chats: string[]) {\n    this.urgentChats = chats;\n    this.pendingMessages = this.pendingMessages.filter((item) => chats.includes(item.chatId));\n    console.log('checkUrgentMessage', this.pendingMessages);\n  }\n\n  getUrgentChats(): Promise<string[]> {\n    return new Promise((resolve) => {\n      if (this.urgentChatsInitialized) {\n        resolve(this.urgentChats);\n      } else {\n        this.urgentChatsInitialized = true;\n        ChataiStores.general\n          ?.get(URGENT_CHATS)\n          .then((chats) => {\n            this.urgentChats = chats || [];\n            resolve(chats || []);\n          })\n          .catch(() => {\n            resolve([]);\n          });\n      }\n    });\n  }\n\n  async addNewMessage(message: ApiMessage) {\n    const urgentChats = (await this.getUrgentChats()) || [];\n    if (urgentChats.length === 0 || urgentChats.includes(message.chatId)) {\n      this.pendingMessages.push(message);\n    }\n  }\n\n  clearPendingMessages() {\n    this.pendingMessages = [];\n  }\n\n  getPendingMessages() {\n    return this.pendingMessages;\n  }\n\n  public static getInstance() {\n    if (!UrgentCheckTask.instance) {\n      UrgentCheckTask.instance = new UrgentCheckTask();\n    }\n    return UrgentCheckTask.instance;\n  }\n}\n\nexport const urgentCheckTask = UrgentCheckTask.getInstance();\n","// Copyright Twitter Inc. Licensed under MIT\n// https://github.com/twitter/twemoji-parser/blob/master/LICENSE.md\n// Emoji 16.0.0 support was taken here https://github.com/jdecked/twemoji-parser\n// Version ab019e0 14.04.2025\n\nconst vs16RegExp = /\\uFE0F/g;\n// avoid using a string literal like `\\u200D` here because minifiers expand it inline\nconst zeroWidthJoiner = String.fromCharCode(0x200d);\n\nexport function removeVS16s(rawEmoji) {\n  return rawEmoji.indexOf(zeroWidthJoiner) < 0 ? rawEmoji.replace(vs16RegExp, '') : rawEmoji;\n}\n\n// Default Twemoji regex was modified here.\n// An exception for ascii emoji has been added to the beginning of the regular string: 🅰🅱🅾🅿.\n// UTF-16 endcoding are `\\ud83c\\udd70`, `\\ud83c\\udd71`, `\\ud83c\\udd7e` and `\\ud83c\\udd7f`.\n// These emojis in the graphic version must end with the `\\ufe0f` symbol.\n// Therefore, they should be excluded from the regular expression.\n// You must remove next substring `\\udd70\\udd71\\udd7e\\udd7f` from the middle of the regex on every update.\n\n// This file is generated by source/emoji/scripts/generate.sh\n// eslint-disable-next-line max-len\nexport default /(?:\\ud83c[\\udd70\\udd71\\udd7e\\udd7f]\\ufe0f)|(?:\\ud83d\\udc68\\ud83c\\udffb\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc68\\ud83c\\udffc\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc68\\ud83c\\udffd\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc68\\ud83c\\udffe\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc68\\ud83c\\udfff\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffb\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffb\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc69\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffc\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffc\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc69\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffd\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffd\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc69\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffe\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffe\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc69\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udfff\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udfff\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc69\\ud83c[\\udffb-\\udfff]|\\ud83e\\uddd1\\ud83c\\udffb\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83e\\uddd1\\ud83c[\\udffc-\\udfff]|\\ud83e\\uddd1\\ud83c\\udffc\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83e\\uddd1\\ud83c[\\udffb\\udffd-\\udfff]|\\ud83e\\uddd1\\ud83c\\udffd\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83e\\uddd1\\ud83c[\\udffb\\udffc\\udffe\\udfff]|\\ud83e\\uddd1\\ud83c\\udffe\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83e\\uddd1\\ud83c[\\udffb-\\udffd\\udfff]|\\ud83e\\uddd1\\ud83c\\udfff\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83e\\uddd1\\ud83c[\\udffb-\\udffe]|\\ud83d\\udc68\\ud83c\\udffb\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc68\\ud83c\\udffb\\u200d\\ud83e\\udd1d\\u200d\\ud83d\\udc68\\ud83c[\\udffc-\\udfff]|\\ud83d\\udc68\\ud83c\\udffc\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc68\\ud83c\\udffc\\u200d\\ud83e\\udd1d\\u200d\\ud83d\\udc68\\ud83c[\\udffb\\udffd-\\udfff]|\\ud83d\\udc68\\ud83c\\udffd\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc68\\ud83c\\udffd\\u200d\\ud83e\\udd1d\\u200d\\ud83d\\udc68\\ud83c[\\udffb\\udffc\\udffe\\udfff]|\\ud83d\\udc68\\ud83c\\udffe\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc68\\ud83c\\udffe\\u200d\\ud83e\\udd1d\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udffd\\udfff]|\\ud83d\\udc68\\ud83c\\udfff\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc68\\ud83c\\udfff\\u200d\\ud83e\\udd1d\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udffe]|\\ud83d\\udc69\\ud83c\\udffb\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffb\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc69\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffb\\u200d\\ud83e\\udd1d\\u200d\\ud83d\\udc68\\ud83c[\\udffc-\\udfff]|\\ud83d\\udc69\\ud83c\\udffb\\u200d\\ud83e\\udd1d\\u200d\\ud83d\\udc69\\ud83c[\\udffc-\\udfff]|\\ud83d\\udc69\\ud83c\\udffc\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffc\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc69\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffc\\u200d\\ud83e\\udd1d\\u200d\\ud83d\\udc68\\ud83c[\\udffb\\udffd-\\udfff]|\\ud83d\\udc69\\ud83c\\udffc\\u200d\\ud83e\\udd1d\\u200d\\ud83d\\udc69\\ud83c[\\udffb\\udffd-\\udfff]|\\ud83d\\udc69\\ud83c\\udffd\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffd\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc69\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffd\\u200d\\ud83e\\udd1d\\u200d\\ud83d\\udc68\\ud83c[\\udffb\\udffc\\udffe\\udfff]|\\ud83d\\udc69\\ud83c\\udffd\\u200d\\ud83e\\udd1d\\u200d\\ud83d\\udc69\\ud83c[\\udffb\\udffc\\udffe\\udfff]|\\ud83d\\udc69\\ud83c\\udffe\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffe\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc69\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffe\\u200d\\ud83e\\udd1d\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udffd\\udfff]|\\ud83d\\udc69\\ud83c\\udffe\\u200d\\ud83e\\udd1d\\u200d\\ud83d\\udc69\\ud83c[\\udffb-\\udffd\\udfff]|\\ud83d\\udc69\\ud83c\\udfff\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udfff\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc69\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udfff\\u200d\\ud83e\\udd1d\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udffe]|\\ud83d\\udc69\\ud83c\\udfff\\u200d\\ud83e\\udd1d\\u200d\\ud83d\\udc69\\ud83c[\\udffb-\\udffe]|\\ud83e\\uddd1\\ud83c\\udffb\\u200d\\u2764\\ufe0f\\u200d\\ud83e\\uddd1\\ud83c[\\udffc-\\udfff]|\\ud83e\\uddd1\\ud83c\\udffb\\u200d\\ud83e\\udd1d\\u200d\\ud83e\\uddd1\\ud83c[\\udffb-\\udfff]|\\ud83e\\uddd1\\ud83c\\udffc\\u200d\\u2764\\ufe0f\\u200d\\ud83e\\uddd1\\ud83c[\\udffb\\udffd-\\udfff]|\\ud83e\\uddd1\\ud83c\\udffc\\u200d\\ud83e\\udd1d\\u200d\\ud83e\\uddd1\\ud83c[\\udffb-\\udfff]|\\ud83e\\uddd1\\ud83c\\udffd\\u200d\\u2764\\ufe0f\\u200d\\ud83e\\uddd1\\ud83c[\\udffb\\udffc\\udffe\\udfff]|\\ud83e\\uddd1\\ud83c\\udffd\\u200d\\ud83e\\udd1d\\u200d\\ud83e\\uddd1\\ud83c[\\udffb-\\udfff]|\\ud83e\\uddd1\\ud83c\\udffe\\u200d\\u2764\\ufe0f\\u200d\\ud83e\\uddd1\\ud83c[\\udffb-\\udffd\\udfff]|\\ud83e\\uddd1\\ud83c\\udffe\\u200d\\ud83e\\udd1d\\u200d\\ud83e\\uddd1\\ud83c[\\udffb-\\udfff]|\\ud83e\\uddd1\\ud83c\\udfff\\u200d\\u2764\\ufe0f\\u200d\\ud83e\\uddd1\\ud83c[\\udffb-\\udffe]|\\ud83e\\uddd1\\ud83c\\udfff\\u200d\\ud83e\\udd1d\\u200d\\ud83e\\uddd1\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc68\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc68|\\ud83d\\udc69\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d[\\udc68\\udc69]|\\ud83e\\udef1\\ud83c\\udffb\\u200d\\ud83e\\udef2\\ud83c[\\udffc-\\udfff]|\\ud83e\\udef1\\ud83c\\udffc\\u200d\\ud83e\\udef2\\ud83c[\\udffb\\udffd-\\udfff]|\\ud83e\\udef1\\ud83c\\udffd\\u200d\\ud83e\\udef2\\ud83c[\\udffb\\udffc\\udffe\\udfff]|\\ud83e\\udef1\\ud83c\\udffe\\u200d\\ud83e\\udef2\\ud83c[\\udffb-\\udffd\\udfff]|\\ud83e\\udef1\\ud83c\\udfff\\u200d\\ud83e\\udef2\\ud83c[\\udffb-\\udffe]|\\ud83d\\udc68\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc68|\\ud83d\\udc69\\u200d\\u2764\\ufe0f\\u200d\\ud83d[\\udc68\\udc69]|\\ud83e\\uddd1\\u200d\\ud83e\\udd1d\\u200d\\ud83e\\uddd1|\\ud83d\\udc6b\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc6c\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc6d\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc8f\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc91\\ud83c[\\udffb-\\udfff]|\\ud83e\\udd1d\\ud83c[\\udffb-\\udfff]|\\ud83d[\\udc6b-\\udc6d\\udc8f\\udc91]|\\ud83e\\udd1d)|(?:\\ud83d[\\udc68\\udc69]|\\ud83e\\uddd1)(?:\\ud83c[\\udffb-\\udfff])?\\u200d(?:\\u2695\\ufe0f|\\u2696\\ufe0f|\\u2708\\ufe0f|\\ud83c[\\udf3e\\udf73\\udf7c\\udf84\\udf93\\udfa4\\udfa8\\udfeb\\udfed]|\\ud83d[\\udcbb\\udcbc\\udd27\\udd2c\\ude80\\ude92]|\\ud83e[\\uddaf-\\uddb3\\uddbc\\uddbd])(?:\\u200d\\u27a1\\ufe0f)?|(?:\\ud83c[\\udfcb\\udfcc]|\\ud83d[\\udd74\\udd75]|\\u26f9)((?:\\ud83c[\\udffb-\\udfff]|\\ufe0f)\\u200d[\\u2640\\u2642]\\ufe0f(?:\\u200d\\u27a1\\ufe0f)?)|(?:\\ud83c[\\udfc3\\udfc4\\udfca]|\\ud83d[\\udc6e\\udc70\\udc71\\udc73\\udc77\\udc81\\udc82\\udc86\\udc87\\ude45-\\ude47\\ude4b\\ude4d\\ude4e\\udea3\\udeb4-\\udeb6]|\\ud83e[\\udd26\\udd35\\udd37-\\udd39\\udd3d\\udd3e\\uddb8\\uddb9\\uddcd-\\uddcf\\uddd4\\uddd6-\\udddd])(?:\\ud83c[\\udffb-\\udfff])?\\u200d[\\u2640\\u2642]\\ufe0f(?:\\u200d\\u27a1\\ufe0f)?|(?:\\ud83d\\udc68\\u200d\\ud83d\\udc68\\u200d\\ud83d\\udc66\\u200d\\ud83d\\udc66|\\ud83d\\udc68\\u200d\\ud83d\\udc68\\u200d\\ud83d\\udc67\\u200d\\ud83d[\\udc66\\udc67]|\\ud83d\\udc68\\u200d\\ud83d\\udc69\\u200d\\ud83d\\udc66\\u200d\\ud83d\\udc66|\\ud83d\\udc68\\u200d\\ud83d\\udc69\\u200d\\ud83d\\udc67\\u200d\\ud83d[\\udc66\\udc67]|\\ud83d\\udc69\\u200d\\ud83d\\udc69\\u200d\\ud83d\\udc66\\u200d\\ud83d\\udc66|\\ud83d\\udc69\\u200d\\ud83d\\udc69\\u200d\\ud83d\\udc67\\u200d\\ud83d[\\udc66\\udc67]|\\ud83e\\uddd1\\u200d\\ud83e\\uddd1\\u200d\\ud83e\\uddd2\\u200d\\ud83e\\uddd2|\\ud83d\\udc68\\u200d\\ud83d\\udc66\\u200d\\ud83d\\udc66|\\ud83d\\udc68\\u200d\\ud83d\\udc67\\u200d\\ud83d[\\udc66\\udc67]|\\ud83d\\udc68\\u200d\\ud83d\\udc68\\u200d\\ud83d[\\udc66\\udc67]|\\ud83d\\udc68\\u200d\\ud83d\\udc69\\u200d\\ud83d[\\udc66\\udc67]|\\ud83d\\udc69\\u200d\\ud83d\\udc66\\u200d\\ud83d\\udc66|\\ud83d\\udc69\\u200d\\ud83d\\udc67\\u200d\\ud83d[\\udc66\\udc67]|\\ud83d\\udc69\\u200d\\ud83d\\udc69\\u200d\\ud83d[\\udc66\\udc67]|\\ud83e\\uddd1\\u200d\\ud83e\\uddd1\\u200d\\ud83e\\uddd2|\\ud83e\\uddd1\\u200d\\ud83e\\uddd2\\u200d\\ud83e\\uddd2|\\ud83c\\udff3\\ufe0f\\u200d\\u26a7\\ufe0f|\\ud83c\\udff3\\ufe0f\\u200d\\ud83c\\udf08|\\ud83d\\ude36\\u200d\\ud83c\\udf2b\\ufe0f|\\u26d3\\ufe0f\\u200d\\ud83d\\udca5|\\u2764\\ufe0f\\u200d\\ud83d\\udd25|\\u2764\\ufe0f\\u200d\\ud83e\\ude79|\\ud83c\\udf44\\u200d\\ud83d\\udfeb|\\ud83c\\udf4b\\u200d\\ud83d\\udfe9|\\ud83c\\udff4\\u200d\\u2620\\ufe0f|\\ud83d\\udc15\\u200d\\ud83e\\uddba|\\ud83d\\udc26\\u200d\\ud83d\\udd25|\\ud83d\\udc3b\\u200d\\u2744\\ufe0f|\\ud83d\\udc41\\u200d\\ud83d\\udde8|\\ud83d\\udc68\\u200d\\ud83d[\\udc66\\udc67]|\\ud83d\\udc69\\u200d\\ud83d[\\udc66\\udc67]|\\ud83d\\udc6f\\u200d\\u2640\\ufe0f|\\ud83d\\udc6f\\u200d\\u2642\\ufe0f|\\ud83d\\ude2e\\u200d\\ud83d\\udca8|\\ud83d\\ude35\\u200d\\ud83d\\udcab|\\ud83d\\ude42\\u200d\\u2194\\ufe0f|\\ud83d\\ude42\\u200d\\u2195\\ufe0f|\\ud83e\\udd3c\\u200d\\u2640\\ufe0f|\\ud83e\\udd3c\\u200d\\u2642\\ufe0f|\\ud83e\\uddd1\\u200d\\ud83e\\uddd2|\\ud83e\\uddde\\u200d\\u2640\\ufe0f|\\ud83e\\uddde\\u200d\\u2642\\ufe0f|\\ud83e\\udddf\\u200d\\u2640\\ufe0f|\\ud83e\\udddf\\u200d\\u2642\\ufe0f|\\ud83d\\udc08\\u200d\\u2b1b|\\ud83d\\udc26\\u200d\\u2b1b)|[#*0-9]\\ufe0f?\\u20e3|(?:[©®\\u2122\\u265f]\\ufe0f)|(?:\\ud83c[\\udc04\\ude02\\ude1a\\ude2f\\ude37\\udf21\\udf24-\\udf2c\\udf36\\udf7d\\udf96\\udf97\\udf99-\\udf9b\\udf9e\\udf9f\\udfcd\\udfce\\udfd4-\\udfdf\\udff3\\udff5\\udff7]|\\ud83d[\\udc3f\\udc41\\udcfd\\udd49\\udd4a\\udd6f\\udd70\\udd73\\udd76-\\udd79\\udd87\\udd8a-\\udd8d\\udda5\\udda8\\uddb1\\uddb2\\uddbc\\uddc2-\\uddc4\\uddd1-\\uddd3\\udddc-\\uddde\\udde1\\udde3\\udde8\\uddef\\uddf3\\uddfa\\udecb\\udecd-\\udecf\\udee0-\\udee5\\udee9\\udef0\\udef3]|[\\u203c\\u2049\\u2139\\u2194-\\u2199\\u21a9\\u21aa\\u231a\\u231b\\u2328\\u23cf\\u23ed-\\u23ef\\u23f1\\u23f2\\u23f8-\\u23fa\\u24c2\\u25aa\\u25ab\\u25b6\\u25c0\\u25fb-\\u25fe\\u2600-\\u2604\\u260e\\u2611\\u2614\\u2615\\u2618\\u2620\\u2622\\u2623\\u2626\\u262a\\u262e\\u262f\\u2638-\\u263a\\u2640\\u2642\\u2648-\\u2653\\u2660\\u2663\\u2665\\u2666\\u2668\\u267b\\u267f\\u2692-\\u2697\\u2699\\u269b\\u269c\\u26a0\\u26a1\\u26a7\\u26aa\\u26ab\\u26b0\\u26b1\\u26bd\\u26be\\u26c4\\u26c5\\u26c8\\u26cf\\u26d1\\u26d3\\u26d4\\u26e9\\u26ea\\u26f0-\\u26f5\\u26f8\\u26fa\\u26fd\\u2702\\u2708\\u2709\\u270f\\u2712\\u2714\\u2716\\u271d\\u2721\\u2733\\u2734\\u2744\\u2747\\u2757\\u2763\\u2764\\u27a1\\u2934\\u2935\\u2b05-\\u2b07\\u2b1b\\u2b1c\\u2b50\\u2b55\\u3030\\u303d\\u3297\\u3299])(?:\\ufe0f|(?!\\ufe0e))|(?:(?:\\ud83c[\\udfcb\\udfcc]|\\ud83d[\\udd74\\udd75\\udd90]|\\ud83e\\udef0|[\\u261d\\u26f7\\u26f9\\u270c\\u270d])(?:\\ufe0f|(?!\\ufe0e))|(?:\\ud83c\\udfc3|\\ud83d\\udeb6|\\ud83e\\uddce)(?:\\ud83c[\\udffb-\\udfff])?(?:\\u200d\\u27a1\\ufe0f)?|(?:\\ud83c[\\udf85\\udfc2\\udfc4\\udfc7\\udfca]|\\ud83d[\\udc42\\udc43\\udc46-\\udc50\\udc66-\\udc69\\udc6e\\udc70-\\udc78\\udc7c\\udc81-\\udc83\\udc85-\\udc87\\udcaa\\udd7a\\udd95\\udd96\\ude45-\\ude47\\ude4b-\\ude4f\\udea3\\udeb4\\udeb5\\udec0\\udecc]|\\ud83e[\\udd0c\\udd0f\\udd18-\\udd1c\\udd1e\\udd1f\\udd26\\udd30-\\udd39\\udd3d\\udd3e\\udd77\\uddb5\\uddb6\\uddb8\\uddb9\\uddbb\\uddcd\\uddcf\\uddd1-\\udddd\\udec3-\\udec5\\udef1-\\udef8]|[\\u270a\\u270b]))(?:\\ud83c[\\udffb-\\udfff])?|(?:\\ud83c\\udff4\\udb40\\udc67\\udb40\\udc62\\udb40\\udc65\\udb40\\udc6e\\udb40\\udc67\\udb40\\udc7f|\\ud83c\\udff4\\udb40\\udc67\\udb40\\udc62\\udb40\\udc73\\udb40\\udc63\\udb40\\udc74\\udb40\\udc7f|\\ud83c\\udff4\\udb40\\udc67\\udb40\\udc62\\udb40\\udc77\\udb40\\udc6c\\udb40\\udc73\\udb40\\udc7f|\\ud83c\\udde6\\ud83c[\\udde8-\\uddec\\uddee\\uddf1\\uddf2\\uddf4\\uddf6-\\uddfa\\uddfc\\uddfd\\uddff]|\\ud83c\\udde7\\ud83c[\\udde6\\udde7\\udde9-\\uddef\\uddf1-\\uddf4\\uddf6-\\uddf9\\uddfb\\uddfc\\uddfe\\uddff]|\\ud83c\\udde8\\ud83c[\\udde6\\udde8\\udde9\\uddeb-\\uddee\\uddf0-\\uddf7\\uddfa-\\uddff]|\\ud83c\\udde9\\ud83c[\\uddea\\uddec\\uddef\\uddf0\\uddf2\\uddf4\\uddff]|\\ud83c\\uddea\\ud83c[\\udde6\\udde8\\uddea\\uddec\\udded\\uddf7-\\uddfa]|\\ud83c\\uddeb\\ud83c[\\uddee-\\uddf0\\uddf2\\uddf4\\uddf7]|\\ud83c\\uddec\\ud83c[\\udde6\\udde7\\udde9-\\uddee\\uddf1-\\uddf3\\uddf5-\\uddfa\\uddfc\\uddfe]|\\ud83c\\udded\\ud83c[\\uddf0\\uddf2\\uddf3\\uddf7\\uddf9\\uddfa]|\\ud83c\\uddee\\ud83c[\\udde8-\\uddea\\uddf1-\\uddf4\\uddf6-\\uddf9]|\\ud83c\\uddef\\ud83c[\\uddea\\uddf2\\uddf4\\uddf5]|\\ud83c\\uddf0\\ud83c[\\uddea\\uddec-\\uddee\\uddf2\\uddf3\\uddf5\\uddf7\\uddfc\\uddfe\\uddff]|\\ud83c\\uddf1\\ud83c[\\udde6-\\udde8\\uddee\\uddf0\\uddf7-\\uddfb\\uddfe]|\\ud83c\\uddf2\\ud83c[\\udde6\\udde8-\\udded\\uddf0-\\uddff]|\\ud83c\\uddf3\\ud83c[\\udde6\\udde8\\uddea-\\uddec\\uddee\\uddf1\\uddf4\\uddf5\\uddf7\\uddfa\\uddff]|\\ud83c\\uddf4\\ud83c\\uddf2|\\ud83c\\uddf5\\ud83c[\\udde6\\uddea-\\udded\\uddf0-\\uddf3\\uddf7-\\uddf9\\uddfc\\uddfe]|\\ud83c\\uddf6\\ud83c\\udde6|\\ud83c\\uddf7\\ud83c[\\uddea\\uddf4\\uddf8\\uddfa\\uddfc]|\\ud83c\\uddf8\\ud83c[\\udde6-\\uddea\\uddec-\\uddf4\\uddf7-\\uddf9\\uddfb\\uddfd-\\uddff]|\\ud83c\\uddf9\\ud83c[\\udde6\\udde8\\udde9\\uddeb-\\udded\\uddef-\\uddf4\\uddf7\\uddf9\\uddfb\\uddfc\\uddff]|\\ud83c\\uddfa\\ud83c[\\udde6\\uddec\\uddf2\\uddf3\\uddf8\\uddfe\\uddff]|\\ud83c\\uddfb\\ud83c[\\udde6\\udde8\\uddea\\uddec\\uddee\\uddf3\\uddfa]|\\ud83c\\uddfc\\ud83c[\\uddeb\\uddf8]|\\ud83c\\uddfd\\ud83c\\uddf0|\\ud83c\\uddfe\\ud83c[\\uddea\\uddf9]|\\ud83c\\uddff\\ud83c[\\udde6\\uddf2\\uddfc]|\\ud83c[\\udccf\\udd8e\\udd91-\\udd9a\\udde6-\\uddff\\ude01\\ude32-\\ude36\\ude38-\\ude3a\\ude50\\ude51\\udf00-\\udf20\\udf2d-\\udf35\\udf37-\\udf7c\\udf7e-\\udf84\\udf86-\\udf93\\udfa0-\\udfc1\\udfc5\\udfc6\\udfc8\\udfc9\\udfcf-\\udfd3\\udfe0-\\udff0\\udff4\\udff8-\\udfff]|\\ud83d[\\udc00-\\udc3e\\udc40\\udc44\\udc45\\udc51-\\udc65\\udc6a\\udc6f\\udc79-\\udc7b\\udc7d-\\udc80\\udc84\\udc88-\\udc8e\\udc90\\udc92-\\udca9\\udcab-\\udcfc\\udcff-\\udd3d\\udd4b-\\udd4e\\udd50-\\udd67\\udda4\\uddfb-\\ude44\\ude48-\\ude4a\\ude80-\\udea2\\udea4-\\udeb3\\udeb7-\\udebf\\udec1-\\udec5\\uded0-\\uded2\\uded5-\\uded7\\udedc-\\udedf\\udeeb\\udeec\\udef4-\\udefc\\udfe0-\\udfeb\\udff0]|\\ud83e[\\udd0d\\udd0e\\udd10-\\udd17\\udd20-\\udd25\\udd27-\\udd2f\\udd3a\\udd3c\\udd3f-\\udd45\\udd47-\\udd76\\udd78-\\uddb4\\uddb7\\uddba\\uddbc-\\uddcc\\uddd0\\uddde-\\uddff\\ude70-\\ude7c\\ude80-\\ude89\\ude8f-\\udec2\\udec6\\udece-\\udedc\\udedf-\\udee9]|[\\u23e9-\\u23ec\\u23f0\\u23f3\\u267e\\u26ce\\u2705\\u2728\\u274c\\u274e\\u2753-\\u2755\\u2795-\\u2797\\u27b0\\u27bf\\ue50a])|\\ufe0f/g;","import { addCallback } from '../../lib/teact/teactn';\nimport { getGlobal } from '../../global';\n\nimport type { GlobalState } from '../../global/types';\nimport type { Signal, SignalSetter } from '../../util/signals';\n\nimport { createSignal } from '../../util/signals';\nimport useSyncEffect from '../useSyncEffect';\n\n/*\n  This hook is a more performant variation of the standard React `useSelector` hook. It allows to:\n  a) Avoid multiple subscriptions to global updates by leveraging a single selector reference.\n  b) Return a signal instead of forcing a component update right away.\n */\n\ntype Selector<T extends unknown> = (global: GlobalState) => T;\n\ninterface State<T extends unknown> {\n  clientsCount: number;\n  getter: Signal<T>;\n  setter: SignalSetter;\n}\n\nconst bySelector = new Map<Selector<unknown>, State<unknown>>();\n\naddCallback((global: GlobalState) => {\n  for (const [selector, { setter }] of bySelector) {\n    setter(selector(global));\n  }\n});\n\nfunction useSelectorSignal<T extends unknown>(selector: Selector<T>): Signal<T> {\n  let state = bySelector.get(selector);\n  if (!state) {\n    const [getter, setter] = createSignal(selector(getGlobal()));\n    state = { clientsCount: 0, getter, setter };\n    bySelector.set(selector, state);\n  }\n\n  useSyncEffect(() => {\n    const state2 = bySelector.get(selector)!;\n\n    state2.clientsCount++;\n\n    return () => {\n      state2.clientsCount--;\n\n      if (!state2.clientsCount) {\n        bySelector.delete(selector);\n      }\n    };\n  }, [selector]);\n\n  return state.getter as Signal<T>;\n}\n\nexport default useSelectorSignal;\n","import { type TeactNode } from '../lib/teact/teact';\n\nexport function replaceWithTeact(\n  input: string, searchValue: string | RegExp, replaceValue: TeactNode,\n) {\n  const parts = input.split(searchValue);\n  const [firstElement, ...rest] = parts;\n\n  return rest.reduce((acc: TeactNode[], curr: string): TeactNode[] => (\n    acc.concat(replaceValue, curr)\n  ), [firstElement]).filter(Boolean);\n}\n\nexport function replaceInStringsWithTeact(\n  input: TeactNode[], searchValue: string | RegExp, replaceValue: TeactNode,\n) {\n  return input.flatMap((curr: TeactNode) => {\n    if (typeof curr === 'string') return replaceWithTeact(curr, searchValue, replaceValue);\n    return curr;\n  }, []);\n}\n","import type { ApiError, ApiFieldError } from '../api/types';\n\nimport { DEBUG } from '../config';\n\nconst READABLE_ERROR_MESSAGES: Record<string, string> = {\n  CHAT_RESTRICTED: 'You can\\'t send messages in this chat, you were restricted',\n  CHAT_SEND_POLL_FORBIDDEN: 'You can\\'t create polls in this chat',\n  CHAT_SEND_STICKERS_FORBIDDEN: 'You can\\'t send stickers in this chat',\n  CHAT_SEND_GIFS_FORBIDDEN: 'You can\\'t send gifs in this chat',\n  CHAT_SEND_MEDIA_FORBIDDEN: 'You can\\'t send media in this chat',\n  CHAT_LINK_EXISTS: 'The chat is public, you can\\'t hide the history to new users',\n  // eslint-disable-next-line max-len\n  SLOWMODE_WAIT_X: 'Slowmode is enabled in this chat: you must wait for the specified number of seconds before sending another message to the chat.',\n  USER_BANNED_IN_CHANNEL: 'You\\'re banned from sending messages in supergroups / channels',\n  USER_IS_BLOCKED: 'You were blocked by this user',\n  YOU_BLOCKED_USER: 'You blocked this user',\n  IMAGE_PROCESS_FAILED: 'Failure while processing image',\n  MEDIA_EMPTY: 'The provided media object is invalid',\n  MEDIA_GROUPED_INVALID: 'Failed to replace album media',\n  MEDIA_NEW_INVALID: 'Failed to replace new media',\n  MESSAGE_NOT_MODIFIED: 'Message not modified. The new content is identical to the current one.',\n  MEDIA_INVALID: 'Media invalid',\n  PASSWORD_HASH_INVALID: 'Incorrect password',\n  PHOTO_EXT_INVALID: 'The extension of the photo is invalid',\n  PHOTO_INVALID_DIMENSIONS: 'The photo dimensions are invalid',\n  PHOTO_SAVE_FILE_INVALID: 'Internal issues, try again later',\n  // eslint-disable-next-line max-len\n  MESSAGE_DELETE_FORBIDDEN: 'You can\\'t delete one of the messages you tried to delete, most likely because it is a service message.',\n  MESSAGE_POLL_CLOSED: 'Poll closed',\n  MESSAGE_EDIT_TIME_EXPIRED: 'You can\\'t edit this message anymore.',\n  PINNED_DIALOGS_TOO_MUCH: 'Sorry, you can only pin 5 chats to the top',\n  CHANNEL_PRIVATE: 'This channel is private',\n  MEDIA_CAPTION_TOO_LONG: 'The provided caption is too long',\n  ADDRESS_STREET_LINE1_INVALID: 'The address you provided is not valid',\n  ADDRESS_STREET_LINE2_INVALID: 'The address you provided is not valid',\n  ADDRESS_CITY_INVALID: 'The city you provided is not valid',\n  ADDRESS_COUNTRY_INVALID: 'The country you provided is not valid',\n  ADDRESS_POSTCODE_INVALID: 'The postcode you provided is not valid',\n  ADDRESS_STATE_INVALID: 'The state you provided is not valid',\n  REQ_INFO_NAME_INVALID: 'The name you provided is not valid',\n  REQ_INFO_PHONE_INVALID: 'The phone you provided is not valid',\n  REQ_INFO_EMAIL_INVALID: 'The email you provided is not valid',\n  // TODO Bring back after fixing the weird bug\n  // CHANNEL_INVALID: 'An error occurred. Please try again later',\n  LINK_NOT_MODIFIED: 'This discussion is already linked to the channel',\n  MESSAGE_TOO_LONG: 'Message is too long',\n\n  // Non-API errors\n  // eslint-disable-next-line max-len\n  SERVICE_WORKER_DISABLED: 'Service Worker is disabled. Streaming media may not be supported. Try reloading the page without holding <Shift> key',\n  // eslint-disable-next-line max-len\n  MESSAGE_TOO_LONG_PLEASE_REMOVE_CHARACTERS: 'The provided message is too long. Please remove {EXTRA_CHARS_COUNT} character{PLURAL_S}.',\n  // eslint-disable-next-line max-len\n  FRESH_RESET_AUTHORISATION_FORBIDDEN: 'You can’t logout other sessions if less than 24 hours have passed since you logged on the current session',\n\n  BOTS_TOO_MUCH: 'There are too many bots in this chat/channel',\n  BOT_GROUPS_BLOCKED: 'This bot can\\'t be added to groups',\n  USERS_TOO_MUCH: 'The maximum number of users has been exceeded',\n  USER_CHANNELS_TOO_MUCH: 'One of the users you tried to add is already in too many channels/supergroups',\n  USER_KICKED: 'This user was kicked from this supergroup/channel',\n  USER_NOT_MUTUAL_CONTACT: 'The provided user is not a mutual contact',\n  USER_PRIVACY_RESTRICTED: 'The user\\'s privacy settings do not allow you to do this',\n  INVITE_HASH_EMPTY: 'The invite hash is empty',\n  INVITE_HASH_EXPIRED: 'The invite link has expired',\n  INVITE_HASH_INVALID: 'The invite hash is invalid',\n  CHANNELS_TOO_MUCH: 'You have joined too many channels/supergroups',\n  USER_ALREADY_PARTICIPANT: 'You already in the group',\n  SCHEDULE_DATE_INVALID: 'Invalid schedule date provided',\n  WALLPAPER_DIMENSIONS_INVALID: 'The wallpaper dimensions are invalid, please select another file',\n  ADMINS_TOO_MUCH: 'There are too many admins',\n  ADMIN_RANK_EMOJI_NOT_ALLOWED: 'An admin rank cannot contain emojis',\n  ADMIN_RANK_INVALID: 'The specified admin rank is invalid',\n  FRESH_CHANGE_ADMINS_FORBIDDEN: 'You were just elected admin, you can\\'t add or modify other admins yet',\n  INPUT_USER_DEACTIVATED: 'Can\\'t do this action to a deleted account',\n  BOT_PRECHECKOUT_TIMEOUT: 'The request for payment has expired',\n  PROVIDER_ACCOUNT_TIMEOUT: 'Request to the payment provider has expired',\n\n  STARGIFT_CONVERT_TOO_OLD: 'This gift no longer can be converted to Stars',\n  SUBSCRIPTION_ALREADY_ACTIVE: 'You are already subscribed',\n\n  PEERS_LIST_EMPTY: 'No chats are added to the list',\n\n  PAID_MEDIA_FORBIDDEN: 'You can\\'t send paid media in this chat',\n\n  USER_DISALLOWED_STARGIFTS: 'User is not accepting gifts',\n};\n\nif (DEBUG) {\n  READABLE_ERROR_MESSAGES.CHAT_WRITE_FORBIDDEN = 'You can\\'t write in this chat';\n  READABLE_ERROR_MESSAGES.CHAT_ADMIN_REQUIRED = 'You must be an admin in this chat to do this';\n}\n\nexport const SHIPPING_ERRORS: Record<string, ApiFieldError> = {\n  ADDRESS_STREET_LINE1_INVALID: {\n    field: 'streetLine1',\n    message: 'Incorrect street address',\n  },\n  ADDRESS_STREET_LINE2_INVALID: {\n    field: 'streetLine2',\n    message: 'Incorrect street address',\n  },\n  ADDRESS_CITY_INVALID: {\n    field: 'city',\n    message: 'Incorrect city',\n  },\n  ADDRESS_COUNTRY_INVALID: {\n    field: 'countryIso2',\n    message: 'Incorrect country',\n  },\n  ADDRESS_POSTCODE_INVALID: {\n    field: 'postCode',\n    message: 'Incorrect post code',\n  },\n  ADDRESS_STATE_INVALID: {\n    field: 'state',\n    message: 'Incorrect state',\n  },\n  REQ_INFO_NAME_INVALID: {\n    field: 'fullName',\n    message: 'Incorrect name',\n  },\n  REQ_INFO_PHONE_INVALID: {\n    field: 'phone',\n    message: 'Incorrect phone',\n  },\n  REQ_INFO_EMAIL_INVALID: {\n    field: 'email',\n    message: 'Incorrect email',\n  },\n};\n\nconst FINAL_PAYMENT_ERRORS = new Set([\n  'BOT_PRECHECKOUT_FAILED',\n  'PAYMENT_FAILED',\n]);\n\nexport default function getReadableErrorText(error: ApiError) {\n  const { message, isSlowMode, textParams } = error;\n  // Currently, Telegram API doesn't return `SLOWMODE_WAIT_X` error as described in the docs\n  if (isSlowMode) {\n    const extraPartIndex = message.indexOf(' (caused by');\n    return extraPartIndex > 0 ? message.substring(0, extraPartIndex) : message;\n  }\n  let errorMessage = READABLE_ERROR_MESSAGES[message];\n  if (errorMessage && textParams) {\n    errorMessage = Object.keys(textParams).reduce((acc, current) => {\n      return acc.replace(current, textParams[current]);\n    }, errorMessage as string);\n  }\n  return errorMessage;\n}\n\nexport function getShippingError(error: ApiError): ApiFieldError | undefined {\n  return SHIPPING_ERRORS[error.message];\n}\n\nexport function shouldClosePaymentModal(error: ApiError): boolean {\n  return FINAL_PAYMENT_ERRORS.has(error.message);\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + chunkId + \".\" + {\"26\":\"7f208c203ceecc4d8d9c\",\"59\":\"28fc60b08d114434750a\",\"61\":\"b54a3634f27538855b75\",\"69\":\"29e96675611021fc18ce\",\"90\":\"1bf1e87c9fd2552af9dc\",\"103\":\"24b92b0b320e97c60706\",\"194\":\"2288f7fe44ca76bc899c\",\"244\":\"21611f9035cdb781f597\",\"304\":\"6b1ee1d6b3f467ba3205\",\"313\":\"3fbe50cc4dde934cfd22\",\"356\":\"585fcb2f0abd742999dc\",\"373\":\"3dbd97e51201abe20303\",\"387\":\"63b7a20e3475559459a9\",\"400\":\"42925b23d4976680f632\",\"405\":\"58375636d81348e78571\",\"409\":\"4812ff8357bee87e890f\",\"433\":\"64c26100943350c22332\",\"453\":\"d5700b90d0c300f90122\",\"482\":\"fc8580e0eea7d6e83cbd\",\"562\":\"156b379bf2024b97c006\",\"564\":\"a359a5b8ee0b33eebeae\",\"633\":\"4a6a911b77c7cbdbe22b\",\"676\":\"4c185b507e3ea4da96f3\",\"683\":\"b9d29fd30cf26bb12d7b\",\"695\":\"bd83d5375c4b8928a375\",\"768\":\"331a502714764edb415f\",\"835\":\"856cd5aaa588852d9e63\",\"947\":\"b45eb1b1d5c5b5daea6c\",\"970\":\"49bf1be694adab9cb238\",\"996\":\"2ce73189bcfe04245feb\",\"1006\":\"7928fd736c5a62cd72b7\",\"1022\":\"e745329f3668d56bf4f0\",\"1095\":\"3db94ab9911911f7ec67\",\"1105\":\"345c775d4619145ca085\",\"1164\":\"9a425fdbd287f848585c\",\"1168\":\"bad2da0abaa427d5c4cc\",\"1184\":\"4a9732a467ce3b050057\",\"1215\":\"a31720f30f9e0878b2e1\",\"1348\":\"d26291e92c748781fff3\",\"1350\":\"81c0ee087feeca3893b5\",\"1387\":\"3c1a89591ee550b3859c\",\"1401\":\"fd9c0fafd85732a73bfb\",\"1465\":\"45d4f79a5892dc26e7ba\",\"1516\":\"ceddb222b80669a9e28b\",\"1575\":\"1151db571e520773c407\",\"1586\":\"bb8e6dc0ebb64d95f673\",\"1620\":\"d5d024d76a5199c3d068\",\"1692\":\"e502449c3f6b7b8404d4\",\"1700\":\"fbb8b7e2fede14d0efae\",\"1775\":\"c3644f6486c7de86072d\",\"1780\":\"d36b8e78a31f45224ffc\",\"1877\":\"511b6164e081bbe40277\",\"2057\":\"4d21078ecf64a1b35ec4\",\"2118\":\"37d7454a6e996b69177e\",\"2158\":\"b3cde9b4a26b8691da1c\",\"2164\":\"eb8bdce6c8e8b8ba4ba8\",\"2225\":\"fff1b803e401bcb8e409\",\"2230\":\"dcc0d2c30f8513b05aa6\",\"2394\":\"04aee85a2e9a9309d90e\",\"2440\":\"f881e742fe4f5ef68ea0\",\"2448\":\"5029cd87c1660d0add4e\",\"2498\":\"31ac696c3aff77afb7c4\",\"2651\":\"b1be8925a2f011ed34a1\",\"2663\":\"2229d10ae4604bbba33e\",\"2670\":\"ba04dfd99986b3d35b6d\",\"2715\":\"ffeaa979c476cb23a0d7\",\"2729\":\"5d16798084468d0c721e\",\"2800\":\"83144f2dd20353ca7a5a\",\"2801\":\"28fdb876737dc9f03cba\",\"2856\":\"9c90f1cacd5303232514\",\"2857\":\"dfa1fefefb90e0b42919\",\"2859\":\"e8d547bfb015cb36dbec\",\"2916\":\"db4c29b6030b04fde91b\",\"2990\":\"65e0c76d2f65178f23f4\",\"3080\":\"c7a3b4e976ceca864548\",\"3325\":\"545e44233e40dd1a69bd\",\"3363\":\"30eb689639008b18b2e7\",\"3405\":\"ae1094e8ba7821654113\",\"3499\":\"0d91c04cea301d7db274\",\"3524\":\"449cb83f709ebc7c8c24\",\"3564\":\"f6589b006aab41c0a8b4\",\"3715\":\"9c92ed175d28baaf7914\",\"3731\":\"7dcfa968daa81ad138d2\",\"3745\":\"b0ac932f39a096ddec27\",\"3747\":\"98a152555465d68a9a89\",\"3759\":\"841736a0d20d8c4439dd\",\"3787\":\"704503c2122084173f7c\",\"3813\":\"60d8e95e7ad8f91f79f9\",\"3906\":\"64ba57bb100e0d4a7120\",\"3981\":\"671217bebcebf630a61f\",\"4008\":\"97f6a5469d57d0702774\",\"4019\":\"f5739ef1b5190c8bba2f\",\"4020\":\"26bf8634def5ebe101f0\",\"4102\":\"a8553d04f62fe4611719\",\"4128\":\"1c24b9a1f673fd09325d\",\"4134\":\"be43db504581c543fdb0\",\"4180\":\"5cdfd3e2d85f578e9ef0\",\"4204\":\"6c3c41d1c9663cfaf5db\",\"4230\":\"3bec9538fbd4082b4190\",\"4326\":\"16735d217d4bf478dfb9\",\"4336\":\"a67d5d613be4486bd561\",\"4383\":\"6d44dcbf90fe35b454fa\",\"4435\":\"0f8fe704813a6313d7a9\",\"4448\":\"a9182b747fa845a2323e\",\"4484\":\"fd3bba66786362b29476\",\"4550\":\"8ff479c8bdf7db3a2f15\",\"4765\":\"ea51f981aea478d0024c\",\"4785\":\"398f059679c783497d14\",\"4878\":\"9819fb8ba541250148fc\",\"4903\":\"4e9f9277de5d16b457fd\",\"4917\":\"85c88c31be50490e4675\",\"4940\":\"533a15685f431cc75439\",\"5032\":\"90c88ec8f580f9bdb21e\",\"5046\":\"f90328b4d2f5bae9bfb2\",\"5060\":\"5f1fc24903dee87155d1\",\"5073\":\"2ef57c07064e80306f4f\",\"5078\":\"18e7740b1080330aa1ec\",\"5116\":\"829bc535e428bae35243\",\"5148\":\"2026dbb9882abc085bee\",\"5193\":\"4b5399da91db26a505ed\",\"5246\":\"45fa498e6f0762571f77\",\"5260\":\"bb3676a05b02fbfd3073\",\"5269\":\"e1b21bcf9cc07b9b7da5\",\"5336\":\"24255493079073e0f70c\",\"5345\":\"b890ad1196b3c38a95da\",\"5361\":\"7927b9d4ec39a1a4980f\",\"5429\":\"f169146fc583feb0ac11\",\"5434\":\"b2e4f36b1e0acf82b176\",\"5438\":\"2fd1144c38a44f7b0d57\",\"5499\":\"a29353824e344d3f48d0\",\"5525\":\"307baf592f78bfff77a1\",\"5628\":\"315410f8e8539b6dee31\",\"5719\":\"c88c163e430fea0bb68c\",\"5735\":\"16d4e446ba241ac72c15\",\"5819\":\"c76cbe6ff1b35824aa9f\",\"5962\":\"cb8553bbb2b49bb62a3f\",\"6047\":\"3387fc1bcdda9d61f37c\",\"6058\":\"b4f96bfa886f6fa6750b\",\"6167\":\"2684e2c0752250bf05cd\",\"6168\":\"37f20379ca46f066c3a7\",\"6241\":\"2a880fae6cfff8df5d49\",\"6265\":\"bd5db15d5a7cc161053b\",\"6272\":\"0b8dbe8a4079f552736e\",\"6308\":\"1a425a099ee9f2e8908a\",\"6338\":\"e1bc8c7db937cade311a\",\"6441\":\"7e70dbdeb1d3578e908c\",\"6442\":\"8e4f2ea5cdf1261a9d28\",\"6473\":\"3ca15f76d8a5dabe349f\",\"6685\":\"6a217875c89e186509f2\",\"6686\":\"33f06ed4de5f45e3abf2\",\"6708\":\"fb1e434c608fec027734\",\"6726\":\"02411ffa61aa3ee56f3a\",\"6802\":\"0977b1c7a6cc094cebf0\",\"6827\":\"be8b9379ffaa527c4cdd\",\"6860\":\"af21c5c9cfa15d65721e\",\"6869\":\"5ea5e8246aa52f873e25\",\"6930\":\"53dac769fe0da162d129\",\"6947\":\"2aba81f73012065341b3\",\"7001\":\"57cd29fa970f3fa8285a\",\"7120\":\"2aa6d9d14b8e5397d4b5\",\"7244\":\"03ab1c6794c47eddd6db\",\"7276\":\"1bf32e665468bbdc842a\",\"7283\":\"12483e9bb6ecfadc0b6c\",\"7321\":\"806240a5aa495ce610ae\",\"7357\":\"bafd579b75036863b0d2\",\"7405\":\"b313a350be944e11eddb\",\"7424\":\"5b0f689ea4bf2aedfcd1\",\"7487\":\"a599c3590b20c8daa010\",\"7499\":\"5673515969adc401e630\",\"7561\":\"10f0c8ae7896349733ab\",\"7586\":\"7aea140d6ba8b58e5175\",\"7594\":\"a72b18f81cdd78a2155c\",\"7612\":\"dbf3c814066a3e29d868\",\"7617\":\"3fb7ef70541a40e2d6b2\",\"7643\":\"8dae8306553c2c398a9d\",\"7688\":\"9ea900f45decc515467b\",\"7738\":\"1b241d63744fee517637\",\"7768\":\"2f10cdf6394878682258\",\"7854\":\"1cf88b67909653a26d5a\",\"7880\":\"38103f90b6835d057052\",\"7901\":\"c76f2eff3639e969330e\",\"7939\":\"6e8ea52601623c2758ee\",\"7972\":\"93dc81d9421c7aebdfff\",\"7978\":\"25cf6194f0363c299394\",\"8043\":\"93f82e7480b4b328fdcd\",\"8062\":\"32dfd8cc4ca0639323b1\",\"8100\":\"bc7c6277f67154311998\",\"8114\":\"582e652c4403d7bb99ec\",\"8142\":\"5c11d40e1231d768acce\",\"8150\":\"6f6b1ccc524b41668a71\",\"8169\":\"7d78ff22ce43513a2388\",\"8201\":\"04864f2a3b12820a69f8\",\"8213\":\"4dd8c82e7aaeed44b984\",\"8214\":\"a1f6db9e404fbf3f09b9\",\"8233\":\"19d67cd962ee72960aef\",\"8287\":\"e246ccf6a476d82bd6b3\",\"8308\":\"688b4c12136a9dba0621\",\"8349\":\"f376b12fba655b1fff60\",\"8393\":\"2a93e9584570b7fb0439\",\"8590\":\"b1e381fdf71016e2a572\",\"8602\":\"391f41367336663370cc\",\"8804\":\"7da8f2accb1a36ad26b4\",\"8843\":\"c4b03d15d9dd7ce1e1ca\",\"8892\":\"75ccd0171cb2888b3bdb\",\"8924\":\"34ded1d076d553a11afb\",\"8980\":\"c04f1c4129098449e070\",\"9004\":\"a1faf8dd3139f4576fa7\",\"9030\":\"9c6866236d423f78fd6e\",\"9072\":\"40fad55916dae8b22355\",\"9141\":\"9749f9e5e4c13586fe06\",\"9183\":\"5e9385ae0d773ada87d1\",\"9238\":\"d4c41e6be296f3862db3\",\"9250\":\"58c5944c4c38f0080b48\",\"9287\":\"b99d72ce9355c7ce7e2a\",\"9295\":\"b1b3a50beb53db572253\",\"9359\":\"519e26be54aafb965100\",\"9375\":\"c2165719e3a0044020b4\",\"9451\":\"2ce27de06068d7ffc88d\",\"9549\":\"88b307bdcfd4e0c04db1\",\"9623\":\"5d9fffd1e2e1ee2cdac8\",\"9677\":\"4f839fd5aec235d04188\",\"9689\":\"8e1cebdf8e68ed62dd68\",\"9710\":\"f80ec1d365ec2a40aaa1\",\"9722\":\"e85f2756789786ffa228\",\"9753\":\"0a6c39040bf132d98ffd\",\"9761\":\"ab1e9dd2da3261da33cd\",\"9849\":\"3da3e2358db3d6680236\",\"9869\":\"1e323db5e1a36e9cd1be\",\"9998\":\"d0b55186192f26a89966\"}[chunkId] + \".js\";\n};","// This function allow to reference async chunks\n__webpack_require__.miniCssF = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + ({\"2394\":\"BundleCalls\",\"4765\":\"shared-components\",\"6930\":\"BundleStars\",\"7405\":\"BundleAuth\",\"7768\":\"BundleMain\",\"9451\":\"BundleExtra\"}[chunkId] || chunkId) + \".\" + {\"1184\":\"4a9732a467ce3b050057\",\"1350\":\"81c0ee087feeca3893b5\",\"2394\":\"04aee85a2e9a9309d90e\",\"4765\":\"ea51f981aea478d0024c\",\"6930\":\"53dac769fe0da162d129\",\"7321\":\"806240a5aa495ce610ae\",\"7405\":\"b313a350be944e11eddb\",\"7643\":\"8dae8306553c2c398a9d\",\"7768\":\"2f10cdf6394878682258\",\"9451\":\"2ce27de06068d7ffc88d\"}[chunkId] + \".css\";\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","if (typeof document === \"undefined\") return;\nvar createStylesheet = (chunkId, fullhref, oldTag, resolve, reject) => {\n\tvar linkTag = document.createElement(\"link\");\n\n\tlinkTag.rel = \"stylesheet\";\n\tlinkTag.type = \"text/css\";\n\tif (__webpack_require__.nc) {\n\t\tlinkTag.nonce = __webpack_require__.nc;\n\t}\n\tvar onLinkComplete = (event) => {\n\t\t// avoid mem leaks.\n\t\tlinkTag.onerror = linkTag.onload = null;\n\t\tif (event.type === 'load') {\n\t\t\tresolve();\n\t\t} else {\n\t\t\tvar errorType = event && event.type;\n\t\t\tvar realHref = event && event.target && event.target.href || fullhref;\n\t\t\tvar err = new Error(\"Loading CSS chunk \" + chunkId + \" failed.\\n(\" + errorType + \": \" + realHref + \")\");\n\t\t\terr.name = \"ChunkLoadError\";\n\t\t\terr.code = \"CSS_CHUNK_LOAD_FAILED\";\n\t\t\terr.type = errorType;\n\t\t\terr.request = realHref;\n\t\t\tif (linkTag.parentNode) linkTag.parentNode.removeChild(linkTag)\n\t\t\treject(err);\n\t\t}\n\t}\n\tlinkTag.onerror = linkTag.onload = onLinkComplete;\n\tlinkTag.href = fullhref;\n\n\n\tif (oldTag) {\n\t\toldTag.parentNode.insertBefore(linkTag, oldTag.nextSibling);\n\t} else {\n\t\tdocument.head.appendChild(linkTag);\n\t}\n\treturn linkTag;\n};\nvar findStylesheet = (href, fullhref) => {\n\tvar existingLinkTags = document.getElementsByTagName(\"link\");\n\tfor(var i = 0; i < existingLinkTags.length; i++) {\n\t\tvar tag = existingLinkTags[i];\n\t\tvar dataHref = tag.getAttribute(\"data-href\") || tag.getAttribute(\"href\");\n\t\tif(tag.rel === \"stylesheet\" && (dataHref === href || dataHref === fullhref)) return tag;\n\t}\n\tvar existingStyleTags = document.getElementsByTagName(\"style\");\n\tfor(var i = 0; i < existingStyleTags.length; i++) {\n\t\tvar tag = existingStyleTags[i];\n\t\tvar dataHref = tag.getAttribute(\"data-href\");\n\t\tif(dataHref === href || dataHref === fullhref) return tag;\n\t}\n};\nvar loadStylesheet = (chunkId) => {\n\treturn new Promise((resolve, reject) => {\n\t\tvar href = __webpack_require__.miniCssF(chunkId);\n\t\tvar fullhref = __webpack_require__.p + href;\n\t\tif(findStylesheet(href, fullhref)) return resolve();\n\t\tcreateStylesheet(chunkId, fullhref, null, resolve, reject);\n\t});\n}\n// object to store loaded CSS chunks\nvar installedCssChunks = {\n\t8792: 0\n};\n\n__webpack_require__.f.miniCss = (chunkId, promises) => {\n\tvar cssChunks = {\"1184\":1,\"1350\":1,\"2394\":1,\"4765\":1,\"6930\":1,\"7321\":1,\"7405\":1,\"7643\":1,\"7768\":1,\"9451\":1};\n\tif(installedCssChunks[chunkId]) promises.push(installedCssChunks[chunkId]);\n\telse if(installedCssChunks[chunkId] !== 0 && cssChunks[chunkId]) {\n\t\tpromises.push(installedCssChunks[chunkId] = loadStylesheet(chunkId).then(() => {\n\t\t\tinstalledCssChunks[chunkId] = 0;\n\t\t}, (e) => {\n\t\t\tdelete installedCssChunks[chunkId];\n\t\t\tthrow e;\n\t\t}));\n\t}\n};\n\n// no hmr\n\n// no prefetching\n\n// no preloaded","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t8792: 0\n};\n\n__webpack_require__.f.j = (chunkId, promises) => {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise((resolve, reject) => (installedChunkData = installedChunks[chunkId] = [resolve, reject]));\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = (event) => {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunktelegram_t\"] = self[\"webpackChunktelegram_t\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","__webpack_require__.nc = undefined;","import { getActions } from '../global';\n\nimport { DEBUG, DEBUG_MORE, IS_TEST } from '../config';\nimport { IS_ANDROID, IS_IOS, IS_SERVICE_WORKER_SUPPORTED } from './browser/windowEnvironment';\nimport { formatShareText } from './deeplink';\nimport { validateFiles } from './files';\nimport { notifyClientReady, playNotifySoundDebounced } from './notifications';\n\ntype WorkerAction = {\n  type: string;\n  payload: Record<string, any>;\n};\n\nconst IGNORE_WORKER_PATH = '/k/';\n\nfunction handleWorkerMessage(e: MessageEvent) {\n  const action: WorkerAction = e.data;\n  if (DEBUG_MORE) {\n    // eslint-disable-next-line no-console\n    console.log('[SW] Message from worker', action);\n  }\n  if (!action.type) return;\n  const dispatch = getActions();\n  const payload = action.payload;\n  switch (action.type) {\n    case 'focusMessage':\n      dispatch.focusMessage?.(payload as any);\n      break;\n    case 'playNotificationSound':\n      playNotifySoundDebounced(action.payload.id);\n      break;\n    case 'share':\n      dispatch.openChatWithDraft({\n        text: formatShareText(payload.url, payload.text, payload.title),\n        files: validateFiles(payload.files),\n      });\n      break;\n  }\n}\n\nfunction subscribeToWorker() {\n  navigator.serviceWorker.removeEventListener('message', handleWorkerMessage);\n  navigator.serviceWorker.addEventListener('message', handleWorkerMessage);\n  // Notify web worker that client is ready to receive messages\n  notifyClientReady();\n}\n\nif (IS_SERVICE_WORKER_SUPPORTED) {\n  window.addEventListener('load', async () => {\n    try {\n      const controller = navigator.serviceWorker.controller;\n      if (!controller || controller.scriptURL.includes(IGNORE_WORKER_PATH)) {\n        const registrations = await navigator.serviceWorker.getRegistrations();\n        const ourRegistrations = registrations.filter((r) => !r.scope.includes(IGNORE_WORKER_PATH));\n        if (ourRegistrations.length) {\n          if (DEBUG) {\n            // eslint-disable-next-line no-console\n            console.log('[SW] Hard reload detected, re-enabling Service Worker');\n          }\n          await Promise.all(ourRegistrations.map((r) => r.unregister()));\n        }\n      }\n\n      await navigator.serviceWorker.register(new URL('../serviceWorker', import.meta.url));\n\n      if (DEBUG) {\n        // eslint-disable-next-line no-console\n        console.log('[SW] ServiceWorker registered');\n      }\n\n      await navigator.serviceWorker.ready;\n\n      // Wait for registration to be available\n      await navigator.serviceWorker.getRegistration();\n\n      if (navigator.serviceWorker.controller) {\n        if (DEBUG) {\n          // eslint-disable-next-line no-console\n          console.log('[SW] ServiceWorker ready');\n        }\n        subscribeToWorker();\n      } else {\n        if (DEBUG) {\n          // eslint-disable-next-line no-console\n          console.error('[SW] ServiceWorker not available');\n        }\n\n        if (!IS_IOS && !IS_ANDROID && !IS_TEST) {\n          getActions().showDialog?.({ data: { message: 'SERVICE_WORKER_DISABLED', hasErrorKey: true } });\n        }\n      }\n    } catch (err) {\n      if (DEBUG) {\n        // eslint-disable-next-line no-console\n        console.error('[SW] ServiceWorker registration failed: ', err);\n      }\n    }\n  });\n  window.addEventListener('focus', async () => {\n    await navigator.serviceWorker.ready;\n    subscribeToWorker();\n  });\n}\n","import { addCallback } from '../lib/teact/teactn';\n\nimport type { GlobalState } from './types';\n\nimport { getServerTime } from '../util/serverTime';\nimport { removePeerStory } from './reducers';\nimport { selectTabState } from './selectors';\nimport { getGlobal, setGlobal } from '.';\n\nconst STORY_EXPIRATION_INTERVAL = 2 * 60 * 1000; // 2 min\n\nlet intervals: number[] = [];\n\nlet prevGlobal: GlobalState | undefined;\n\naddCallback((global: GlobalState) => {\n  const previousGlobal = prevGlobal;\n  prevGlobal = global;\n\n  const isCurrentMaster = selectTabState(global)?.isMasterTab;\n  const isPreviousMaster = previousGlobal && selectTabState(previousGlobal)?.isMasterTab;\n  if (isCurrentMaster === isPreviousMaster) return;\n\n  if (isCurrentMaster && !isPreviousMaster) {\n    startIntervals();\n  } else {\n    stopIntervals();\n  }\n});\n\nfunction startIntervals() {\n  if (intervals.length) return;\n  intervals.push(window.setInterval(checkStoryExpiration, STORY_EXPIRATION_INTERVAL));\n}\n\nfunction stopIntervals() {\n  intervals.forEach((interval) => clearInterval(interval));\n  intervals = [];\n}\n\nfunction checkStoryExpiration() {\n  // eslint-disable-next-line eslint-multitab-tt/no-immediate-global\n  let global = getGlobal();\n  if (!global.isInited) return;\n\n  const serverTime = getServerTime();\n\n  Object.values(global.stories.byPeerId).forEach((peerStories) => {\n    const stories = Object.values(peerStories.byId);\n    stories.forEach((story) => {\n      if (!('expireDate' in story)) return;\n      if (story.expireDate > serverTime) return;\n      if ('isInProfile' in story && story.isInProfile) return;\n      if ('isPublic' in story && !story.isPublic) return;\n\n      global = removePeerStory(global, story.peerId, story.id);\n    });\n  });\n\n  setGlobal(global);\n}\n","import type { GlobalState } from '../global/types';\n\nimport { IS_MOCKED_CLIENT } from '../config';\nimport { loadCache, loadCachedSharedState } from '../global/cache';\nimport {\n  getGlobal, setGlobal,\n} from '../global/index';\nimport { INITIAL_GLOBAL_STATE } from '../global/initialState';\nimport { updatePasscodeSettings } from '../global/reducers';\nimport { cloneDeep } from './iteratees';\nimport { clearStoredSession } from './sessions';\n\nexport async function initGlobal(force: boolean = false, prevGlobal?: GlobalState) {\n  prevGlobal = prevGlobal || getGlobal();\n  if (!force && 'byTabId' in prevGlobal) {\n    return;\n  }\n\n  const initial = cloneDeep(INITIAL_GLOBAL_STATE);\n  const cache = await loadCache(initial);\n  let global = cache || initial;\n  if (IS_MOCKED_CLIENT) global.authState = 'authorizationStateReady';\n\n  const { hasPasscode, isScreenLocked } = global.passcode;\n  if (hasPasscode && !isScreenLocked) {\n    global = updatePasscodeSettings(global, {\n      isScreenLocked: true,\n    });\n\n    clearStoredSession();\n  }\n\n  if (force) {\n    global.byTabId = prevGlobal.byTabId;\n  }\n\n  if (!cache) { // Try loading shared state separately\n    const storedSharedState = await loadCachedSharedState();\n    if (storedSharedState) {\n      global.sharedState = storedSharedState;\n    }\n  }\n\n  setGlobal(global);\n}\n","import './intervals';\n\nimport type { ActionReturnType, GlobalState } from './types';\n\nimport { IS_MULTIACCOUNT_SUPPORTED } from '../util/browser/globalEnvironment';\nimport { isCacheApiSupported } from '../util/cacheApi';\nimport { getCurrentTabId, reestablishMasterToSelf } from '../util/establishMultitabRole';\nimport { initGlobal } from '../util/init';\nimport { cloneDeep } from '../util/iteratees';\nimport { isLocalMessageId } from '../util/keys/messageKey';\nimport { Bundles, loadBundle } from '../util/moduleLoader';\nimport { parseLocationHash } from '../util/routing';\nimport { updatePeerColors } from '../util/theme';\nimport { initializeChatMediaSearchResults } from './reducers/middleSearch';\nimport { updateTabState } from './reducers/tabs';\nimport { initSharedState } from './shared/sharedStateConnector';\nimport { initCache } from './cache';\nimport {\n  addActionHandler, getGlobal, setGlobal,\n} from './index';\nimport { INITIAL_TAB_STATE } from './initialState';\nimport { replaceTabThreadParam, replaceThreadParam } from './reducers';\nimport { selectTabState, selectThreadParam } from './selectors';\n\ninitCache();\n\naddActionHandler('initShared', async (prevGlobal, actions, payload): Promise<void> => {\n  const { force } = payload || {};\n  await initGlobal(force, prevGlobal);\n});\n\naddActionHandler('init', (global, actions, payload): ActionReturnType => {\n  const { tabId = getCurrentTabId(), isMasterTab } = payload || {};\n\n  const initialTabState = cloneDeep(INITIAL_TAB_STATE);\n  initialTabState.id = tabId;\n  initialTabState.isChatInfoShown = Boolean(global.lastIsChatInfoShown);\n  initialTabState.audioPlayer.playbackRate = global.audioPlayer.lastPlaybackRate;\n  initialTabState.audioPlayer.isPlaybackRateActive = global.audioPlayer.isLastPlaybackRateActive;\n  initialTabState.mediaViewer.playbackRate = global.mediaViewer.lastPlaybackRate;\n\n  global = {\n    ...global,\n    byTabId: {\n      ...global.byTabId,\n      [tabId]: initialTabState,\n    },\n  };\n\n  if (isMasterTab) {\n    initialTabState.isMasterTab = true;\n  }\n\n  if (IS_MULTIACCOUNT_SUPPORTED && initialTabState.isMasterTab) {\n    initSharedState(global.sharedState);\n  }\n\n  Object.keys(global.messages.byChatId).forEach((chatId) => {\n    const threadsById = global.messages.byChatId[chatId].threadsById;\n    Object.keys(threadsById).forEach((thread) => {\n      const threadId = Number(thread);\n      const lastViewportIds = selectThreadParam(global, chatId, threadId, 'lastViewportIds');\n      // Check if migration from previous version is faulty\n      if (!lastViewportIds?.every((id) => isLocalMessageId(id) || global.messages.byChatId[chatId]?.byId[id])) {\n        global = replaceThreadParam(global, chatId, threadId, 'lastViewportIds', undefined);\n        return;\n      }\n      global = initializeChatMediaSearchResults(global, chatId, threadId, tabId);\n      global = replaceTabThreadParam(\n        global,\n        chatId,\n        threadId,\n        'viewportIds',\n        lastViewportIds,\n        tabId,\n      );\n    });\n  });\n\n  // Temporary state fix\n  Object.keys(global.messages.byChatId).forEach((chatId) => {\n    const threadsById = global.messages.byChatId[chatId].threadsById;\n    const fixedThreadsById = Object.keys(threadsById).reduce((acc, key) => {\n      const t = threadsById[Number(key)];\n      acc[Number(key)] = {\n        ...t,\n        listedIds: t.lastViewportIds,\n      };\n      return acc;\n    }, {} as GlobalState['messages']['byChatId'][string]['threadsById']);\n\n    global = {\n      ...global,\n      messages: {\n        ...global.messages,\n        byChatId: {\n          ...global.messages.byChatId,\n          [chatId]: {\n            ...global.messages.byChatId[chatId],\n            threadsById: fixedThreadsById,\n          },\n        },\n      },\n    };\n  });\n\n  const parsedMessageList = parseLocationHash(global.currentUserId);\n\n  if (global.authState !== 'authorizationStateReady'\n    && !global.passcode.hasPasscode && !global.passcode.isScreenLocked) {\n    Object.values(global.byTabId).forEach(({ id: otherTabId }) => {\n      if (otherTabId === tabId) return;\n      global = updateTabState(global, {\n        isInactive: true,\n      }, otherTabId);\n    });\n  }\n\n  isCacheApiSupported().then((isSupported) => {\n    global = getGlobal();\n    global.isCacheApiSupported = isSupported;\n    setGlobal(global);\n  });\n\n  if (global.peerColors) {\n    updatePeerColors(global.peerColors.general);\n  }\n\n  return updateTabState(global, {\n    messageLists: parsedMessageList ? [parsedMessageList] : initialTabState.messageLists,\n  }, tabId);\n});\n\naddActionHandler('requestMasterAndCallAction', async (\n  global, actions, payload,\n): Promise<void> => {\n  const { tabId = getCurrentTabId() } = payload;\n\n  if (selectTabState(global, tabId).isMasterTab) {\n    const { action, payload: actionPayload } = payload;\n    // @ts-ignore\n    actions[action](actionPayload);\n    return;\n  }\n\n  if (global.phoneCall || global.groupCalls.activeGroupCallId) {\n    await loadBundle(Bundles.Calls);\n    if ('hangUp' in actions) actions.hangUp({ tabId });\n    if ('leaveGroupCall' in actions) actions.leaveGroupCall({ tabId });\n  } else {\n    reestablishMasterToSelf();\n  }\n\n  global = getGlobal();\n  global = updateTabState(global, {\n    multitabNextAction: payload,\n  }, tabId);\n  setGlobal(global);\n});\n\naddActionHandler('clearMultitabNextAction', (global, actions, payload): ActionReturnType => {\n  const { tabId = getCurrentTabId() } = payload || {};\n\n  return updateTabState(global, {\n    multitabNextAction: undefined,\n  }, tabId);\n});\n","import { IS_IOS } from './browser/windowEnvironment';\nimport { animate } from './animation';\nimport { fastRaf } from './schedulers';\n\nconst TEST_INTERVAL = 5000; // 5 sec\nconst FRAMES_TO_TEST = 10;\nconst REDUCED_FPS = 35;\n\nlet isImproved = false;\n\nexport function betterView() {\n  if (!IS_IOS) return;\n\n  let interval: number | undefined;\n  let lastFocusAt = Date.now();\n\n  function setupInterval() {\n    if (interval || isImproved) return;\n\n    interval = window.setInterval(testAndImprove, TEST_INTERVAL);\n  }\n\n  window.addEventListener('focus', () => {\n    const now = Date.now();\n    if (now - lastFocusAt < 100) return; // iOS triggers two `focus` events for some reason\n    lastFocusAt = now;\n\n    setupInterval();\n    testAndImprove();\n  });\n\n  window.addEventListener('blur', () => {\n    clearInterval(interval);\n    interval = undefined;\n  });\n\n  if (document.hasFocus()) {\n    setupInterval();\n    testAndImprove();\n  }\n}\n\nasync function testAndImprove() {\n  const fps = await testFps();\n  if (fps <= REDUCED_FPS) {\n    improveView();\n  }\n}\n\nfunction testFps() {\n  return new Promise<number>((resolve) => {\n    const frames: number[] = [];\n    let lastFrameAt = performance.now();\n\n    animate(() => {\n      const now = performance.now();\n      frames.push(now - lastFrameAt);\n      lastFrameAt = now;\n\n      if (frames.length === FRAMES_TO_TEST) {\n        const mean = frames.sort()[Math.floor(frames.length / 2)];\n        resolve(Math.round(1000 / mean));\n        return false;\n      }\n\n      return true;\n    }, fastRaf);\n  });\n}\n\nfunction improveView() {\n  isImproved = true;\n\n  const containerEl = document.createElement('div');\n  containerEl.style.cssText = 'position: absolute; top: 0; left: 0; width: 0; height: 100%; overflow: hidden;';\n\n  const boosterEl = document.createElement('div');\n  const height = window.screen.height * 1.5;\n  boosterEl.style.cssText = `width: 0; height: ${height}px; transform: translateX(100%); transition: transform 100ms;`;\n  boosterEl.innerHTML = '&nbsp;';\n\n  containerEl.appendChild(boosterEl);\n  document.body.appendChild(containerEl);\n\n  requestAnimationFrame(() => {\n    boosterEl.addEventListener('transitionend', () => {\n      containerEl.remove();\n    });\n\n    boosterEl.style.transform = '';\n  });\n}\n","import type { FC } from '../../lib/teact/teact';\nimport React from '../../lib/teact/teact';\n\nimport { Bundles } from '../../util/moduleLoader';\n\nimport useModuleLoader from '../../hooks/useModuleLoader';\n\nimport Loading from '../ui/Loading';\n\nconst AuthCodeAsync: FC = () => {\n  const AuthCode = useModuleLoader(Bundles.Auth, 'AuthCode');\n\n  return AuthCode ? <AuthCode /> : <Loading />;\n};\n\nexport default AuthCodeAsync;\n","import type { FC } from '../../lib/teact/teact';\nimport React from '../../lib/teact/teact';\n\nimport { Bundles } from '../../util/moduleLoader';\n\nimport useModuleLoader from '../../hooks/useModuleLoader';\n\nimport Loading from '../ui/Loading';\n\nconst AuthPasswordAsync: FC = () => {\n  const AuthPassword = useModuleLoader(Bundles.Auth, 'AuthPassword');\n\n  return AuthPassword ? <AuthPassword /> : <Loading />;\n};\n\nexport default AuthPasswordAsync;\n","const SITE_FONTS = ['400 1em Roboto', '500 1em Roboto', \"500 1em 'Numbers Rounded'\"];\n\nexport default function preloadFonts() {\n  if ('fonts' in document) {\n    return Promise.all(SITE_FONTS.map((font) => document.fonts.load(font)));\n  }\n\n  return undefined;\n}\n","import { getAccountSlotUrl } from '../../../util/multiaccount';\n\nexport function navigateBack() {\n  const currentUrl = new URL(window.location.href);\n  const referrer = document.referrer ? new URL(document.referrer) : undefined;\n  if (referrer?.origin === currentUrl.origin && referrer.pathname === currentUrl.pathname) {\n    window.history.back(); // Return to previous account with it's state\n    return;\n  }\n\n  const url = getAccountSlotUrl(1);\n  window.location.href = url;\n}\n","import type { LangCode } from '../../../types';\n\nexport function getSuggestedLanguage() {\n  let suggestedLanguage = navigator.language.toLowerCase();\n\n  if (suggestedLanguage && suggestedLanguage !== 'pt-br') {\n    suggestedLanguage = suggestedLanguage.substr(0, 2);\n  }\n\n  return suggestedLanguage as LangCode;\n}\n","import { useEffect, useState } from '../lib/teact/teact';\n\nimport type { RegularLangKey } from '../types/language';\n\nimport { LANG_PACK } from '../config';\nimport { callApi } from '../api/gramjs';\nimport useLastCallback from './useLastCallback';\n\nexport default function useLangString(key: RegularLangKey, langCode?: string) {\n  const [value, setValue] = useState<string | undefined>(undefined);\n\n  const fetchLangString = useLastCallback(async () => {\n    if (!langCode) return undefined;\n\n    const result = await callApi('fetchLangStrings', {\n      langCode,\n      langPack: LANG_PACK,\n      keys: [key],\n    });\n    const langString = result?.strings[key];\n    if (!langString || typeof langString !== 'string') return undefined;\n    return langString;\n  });\n\n  useEffect(() => {\n    fetchLangString().then(setValue);\n  }, [key, langCode]);\n\n  return value;\n}\n","import type { FC } from '../../lib/teact/teact';\nimport React, {\n  memo, useCallback, useRef, useState,\n} from '../../lib/teact/teact';\nimport { withGlobal } from '../../global';\n\nimport type { ApiCountryCode } from '../../api/types';\n\nimport { ANIMATION_END_DELAY } from '../../config';\nimport { IS_EMOJI_SUPPORTED } from '../../util/browser/windowEnvironment';\nimport buildClassName from '../../util/buildClassName';\nimport { isoToEmoji } from '../../util/emoji/emoji';\nimport { prepareSearchWordsForNeedle } from '../../util/searchWords';\nimport renderText from '../common/helpers/renderText';\n\nimport useLang from '../../hooks/useLang';\nimport useSyncEffect from '../../hooks/useSyncEffect';\n\nimport DropdownMenu from '../ui/DropdownMenu';\nimport MenuItem from '../ui/MenuItem';\nimport Spinner from '../ui/Spinner';\n\nimport './CountryCodeInput.scss';\n\ntype StateProps = {\n  phoneCodeList: ApiCountryCode[];\n};\n\ntype OwnProps = {\n  id: string;\n  value?: ApiCountryCode;\n  isLoading?: boolean;\n  onChange: (value: ApiCountryCode) => void;\n};\n\nconst MENU_HIDING_DURATION = 200 + ANIMATION_END_DELAY;\nconst SELECT_TIMEOUT = 50;\n\nconst CountryCodeInput: FC<OwnProps & StateProps> = ({\n  id,\n  value,\n  isLoading,\n  onChange,\n  phoneCodeList,\n}) => {\n  const lang = useLang();\n  // eslint-disable-next-line no-null/no-null\n  const inputRef = useRef<HTMLInputElement>(null);\n\n  const [filter, setFilter] = useState<string | undefined>();\n  const [filteredList, setFilteredList] = useState<ApiCountryCode[]>([]);\n\n  const updateFilter = useCallback((filterValue?: string) => {\n    setFilter(filterValue);\n    setFilteredList(getFilteredList(phoneCodeList, filterValue));\n  }, [phoneCodeList]);\n\n  useSyncEffect(([prevPhoneCodeList]) => {\n    if (!prevPhoneCodeList?.length && phoneCodeList.length) {\n      setFilteredList(getFilteredList(phoneCodeList, filter));\n    }\n  }, [phoneCodeList, filter]);\n\n  const handleChange = useCallback((country: ApiCountryCode) => {\n    onChange(country);\n\n    setTimeout(() => updateFilter(undefined), MENU_HIDING_DURATION);\n  }, [onChange, updateFilter]);\n\n  const handleInput = useCallback((e: React.FormEvent<HTMLInputElement>) => {\n    updateFilter(e.currentTarget.value);\n  }, [updateFilter]);\n\n  const handleInputKeyDown = useCallback((e: React.KeyboardEvent<HTMLInputElement>) => {\n    if (e.keyCode !== 8) {\n      return;\n    }\n\n    const target = e.currentTarget;\n    if (value && filter === undefined) {\n      target.value = '';\n    }\n\n    updateFilter(target.value);\n  }, [filter, updateFilter, value]);\n\n  const CodeInput: FC<{ onTrigger: () => void; isOpen?: boolean }> = useCallback(({ onTrigger, isOpen }) => {\n    const handleTrigger = () => {\n      if (isOpen) {\n        return;\n      }\n\n      setTimeout(() => {\n        inputRef.current!.select();\n      }, SELECT_TIMEOUT);\n\n      onTrigger();\n\n      const formEl = document.getElementById('auth-phone-number-form')!;\n      formEl.scrollTo({ top: formEl.scrollHeight, behavior: 'smooth' });\n    };\n\n    const handleCodeInput = (e: React.FormEvent<HTMLInputElement>) => {\n      handleInput(e);\n      handleTrigger();\n    };\n\n    const emoji = value && IS_EMOJI_SUPPORTED && renderText(isoToEmoji(value.iso2), ['hq_emoji']);\n    const name = value?.name || value?.defaultName || '';\n    const inputValue = filter ?? [emoji, name].filter(Boolean).join(' ');\n\n    return (\n      <div className={buildClassName('input-group', value && 'touched')}>\n        <input\n          ref={inputRef}\n          className={buildClassName('form-control', isOpen && 'focus')}\n          type=\"text\"\n          id={id}\n          value={inputValue}\n          autoComplete=\"off\"\n          onClick={handleTrigger}\n          onFocus={handleTrigger}\n          onInput={handleCodeInput}\n          onKeyDown={handleInputKeyDown}\n        />\n        <label>{lang('LoginSelectCountryTitle')}</label>\n        {isLoading ? (\n          <Spinner color=\"black\" />\n        ) : (\n          <i onClick={handleTrigger} className={buildClassName('css-icon-down', isOpen && 'open')} />\n        )}\n      </div>\n    );\n  }, [filter, handleInput, handleInputKeyDown, id, isLoading, lang, value]);\n\n  return (\n    <DropdownMenu\n      className=\"CountryCodeInput\"\n      trigger={CodeInput}\n    >\n      {filteredList\n        .map((country: ApiCountryCode) => (\n          <MenuItem\n            key={`${country.iso2}-${country.countryCode}`}\n            className={value && country.iso2 === value.iso2 ? 'selected' : ''}\n            // eslint-disable-next-line react/jsx-no-bind\n            onClick={() => handleChange(country)}\n          >\n            <span className=\"country-flag\">{renderText(isoToEmoji(country.iso2), ['hq_emoji'])}</span>\n            <span className=\"country-name\">{country.name || country.defaultName}</span>\n            <span className=\"country-code\">+{country.countryCode}</span>\n          </MenuItem>\n        ))}\n      {!filteredList.length && (\n        <MenuItem\n          key=\"no-results\"\n          className=\"no-results\"\n          disabled\n        >\n          <span>{lang('CountryNone')}</span>\n        </MenuItem>\n      )}\n    </DropdownMenu>\n  );\n};\n\nfunction getFilteredList(countryList: ApiCountryCode[], filter = ''): ApiCountryCode[] {\n  if (!filter.length) {\n    return countryList;\n  }\n\n  const searchWords = prepareSearchWordsForNeedle(filter);\n\n  return countryList.filter((country) => (\n    searchWords(country.defaultName) || (country.name && searchWords(country.name))\n  ));\n}\n\nexport default memo(withGlobal<OwnProps>(\n  (global): StateProps => {\n    const { countryList: { phoneCodes: phoneCodeList } } = global;\n    return {\n      phoneCodeList,\n    };\n  },\n)(CountryCodeInput));\n","import type { ChangeEvent } from 'react';\nimport type { FC } from '../../lib/teact/teact';\nimport React, {\n  memo, useEffect, useLayoutEffect, useMemo, useRef, useState,\n} from '../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../global';\n\nimport type { ApiCountryCode } from '../../api/types';\nimport type { GlobalState } from '../../global/types';\n\nimport { requestMeasure } from '../../lib/fasterdom/fasterdom';\nimport { IS_SAFARI, IS_TOUCH_ENV } from '../../util/browser/windowEnvironment';\nimport { preloadImage } from '../../util/files';\nimport preloadFonts from '../../util/fonts';\nimport { pick } from '../../util/iteratees';\nimport { getAccountSlotUrl } from '../../util/multiaccount';\nimport { oldSetLanguage } from '../../util/oldLangProvider';\nimport { formatPhoneNumber, getCountryCodeByIso, getCountryFromPhoneNumber } from '../../util/phoneNumber';\nimport { navigateBack } from './helpers/backNavigation';\nimport { getSuggestedLanguage } from './helpers/getSuggestedLanguage';\n\nimport useFlag from '../../hooks/useFlag';\nimport useLang from '../../hooks/useLang';\nimport useLangString from '../../hooks/useLangString';\nimport useLastCallback from '../../hooks/useLastCallback';\nimport useMultiaccountInfo from '../../hooks/useMultiaccountInfo';\n\nimport Icon from '../common/icons/Icon';\nimport Button from '../ui/Button';\nimport Checkbox from '../ui/Checkbox';\nimport InputText from '../ui/InputText';\nimport Loading from '../ui/Loading';\nimport CountryCodeInput from './CountryCodeInput';\n\nimport monkeyPath from '../../assets/monkey.svg';\n\ntype StateProps = Pick<GlobalState, (\n  'connectionState' | 'authState' |\n  'authPhoneNumber' | 'authIsLoading' |\n  'authIsLoadingQrCode' | 'authErrorKey' |\n  'authRememberMe' | 'authNearestCountry'\n)> & {\n  language?: string;\n  phoneCodeList: ApiCountryCode[];\n};\n\nconst MIN_NUMBER_LENGTH = 7;\n\nlet isPreloadInitiated = false;\n\nconst AuthPhoneNumber: FC<StateProps> = ({\n  connectionState,\n  authState,\n  authPhoneNumber,\n  authIsLoading,\n  authIsLoadingQrCode,\n  authErrorKey,\n  authRememberMe,\n  authNearestCountry,\n  phoneCodeList,\n  language,\n}) => {\n  const {\n    setAuthPhoneNumber,\n    setAuthRememberMe,\n    loadNearestCountry,\n    loadCountryList,\n    clearAuthErrorKey,\n    goToAuthQrCode,\n    setSharedSettingOption,\n  } = getActions();\n\n  const lang = useLang();\n  // eslint-disable-next-line no-null/no-null\n  const inputRef = useRef<HTMLInputElement>(null);\n  const suggestedLanguage = getSuggestedLanguage();\n\n  const isConnected = connectionState === 'connectionStateReady';\n  const continueText = useLangString('AuthContinueOnThisLanguage', suggestedLanguage);\n  const [country, setCountry] = useState<ApiCountryCode | undefined>();\n  const [phoneNumber, setPhoneNumber] = useState<string | undefined>();\n  const [isTouched, setIsTouched] = useState(false);\n  const [lastSelection, setLastSelection] = useState<[number, number] | undefined>();\n  const [isLoading, markIsLoading, unmarkIsLoading] = useFlag();\n\n  const accountsInfo = useMultiaccountInfo();\n  const hasActiveAccount = Object.values(accountsInfo).length > 0;\n  const phoneNumberSlots = useMemo(() => (\n    Object.entries(accountsInfo)\n      .reduce((acc, [key, { phone }]) => {\n        if (phone) acc[phone] = Number(key);\n        return acc;\n      }, {} as Record<string, number>)\n  ), [accountsInfo]);\n\n  const fullNumber = country ? `+${country.countryCode} ${phoneNumber || ''}` : phoneNumber;\n  const canSubmit = fullNumber && fullNumber.replace(/[^\\d]+/g, '').length >= MIN_NUMBER_LENGTH;\n\n  useEffect(() => {\n    if (!IS_TOUCH_ENV) {\n      inputRef.current!.focus();\n    }\n  }, [country]);\n\n  useEffect(() => {\n    if (isConnected && !authNearestCountry) {\n      loadNearestCountry();\n    }\n  }, [isConnected, authNearestCountry]);\n\n  useEffect(() => {\n    if (isConnected) {\n      loadCountryList({ langCode: language });\n    }\n  }, [isConnected, language]);\n\n  useEffect(() => {\n    if (authNearestCountry && phoneCodeList && !country && !isTouched) {\n      setCountry(getCountryCodeByIso(phoneCodeList, authNearestCountry));\n    }\n  }, [country, authNearestCountry, isTouched, phoneCodeList]);\n\n  const parseFullNumber = useLastCallback((newFullNumber: string) => {\n    if (!newFullNumber.length) {\n      setPhoneNumber('');\n    }\n\n    const suggestedCountry = phoneCodeList && getCountryFromPhoneNumber(phoneCodeList, newFullNumber);\n\n    // Any phone numbers should be allowed, in some cases ignoring formatting\n    const selectedCountry = !country\n    || (suggestedCountry && suggestedCountry.iso2 !== country.iso2)\n    || (!suggestedCountry && newFullNumber.length)\n      ? suggestedCountry\n      : country;\n\n    if (!country || !selectedCountry || (selectedCountry && selectedCountry.iso2 !== country.iso2)) {\n      setCountry(selectedCountry);\n    }\n    setPhoneNumber(formatPhoneNumber(newFullNumber, selectedCountry));\n  });\n\n  const handleLangChange = useLastCallback(() => {\n    markIsLoading();\n\n    void oldSetLanguage(suggestedLanguage, () => {\n      unmarkIsLoading();\n\n      setSharedSettingOption({ language: suggestedLanguage });\n    });\n  });\n\n  useEffect(() => {\n    if (phoneNumber === undefined && authPhoneNumber) {\n      parseFullNumber(authPhoneNumber);\n    }\n  }, [authPhoneNumber, phoneNumber, parseFullNumber]);\n\n  useLayoutEffect(() => {\n    if (inputRef.current && lastSelection) {\n      inputRef.current.setSelectionRange(...lastSelection);\n    }\n  }, [lastSelection]);\n\n  const isJustPastedRef = useRef(false);\n  const handlePaste = useLastCallback(() => {\n    isJustPastedRef.current = true;\n    requestMeasure(() => {\n      isJustPastedRef.current = false;\n    });\n  });\n\n  const handleBackNavigation = useLastCallback(() => {\n    navigateBack();\n  });\n\n  const handleCountryChange = useLastCallback((value: ApiCountryCode) => {\n    setCountry(value);\n    setPhoneNumber('');\n  });\n\n  const handlePhoneNumberChange = useLastCallback((e: ChangeEvent<HTMLInputElement>) => {\n    if (authErrorKey) {\n      clearAuthErrorKey();\n    }\n\n    // This is for further screens. We delay it until user input to speed up the initial loading.\n    if (!isPreloadInitiated) {\n      isPreloadInitiated = true;\n      preloadFonts();\n      void preloadImage(monkeyPath);\n    }\n\n    const { value, selectionStart, selectionEnd } = e.target;\n    setLastSelection(\n      selectionStart && selectionEnd && selectionEnd < value.length\n        ? [selectionStart, selectionEnd]\n        : undefined,\n    );\n\n    setIsTouched(true);\n\n    const shouldFixSafariAutoComplete = (\n      IS_SAFARI && country && fullNumber !== undefined\n      && value.length - fullNumber.length > 1 && !isJustPastedRef.current\n    );\n    parseFullNumber(shouldFixSafariAutoComplete ? `${country!.countryCode} ${value}` : value);\n  });\n\n  const handleKeepSessionChange = useLastCallback((e: ChangeEvent<HTMLInputElement>) => {\n    setAuthRememberMe(e.target.checked);\n  });\n\n  function handleSubmit(event: React.FormEvent<HTMLFormElement>) {\n    event.preventDefault();\n\n    if (authIsLoading) {\n      return;\n    }\n\n    const adaptedPhoneNumber = fullNumber?.replace(/[^\\d]/g, '');\n    if (adaptedPhoneNumber && phoneNumberSlots[adaptedPhoneNumber]) {\n      window.location.replace(getAccountSlotUrl(phoneNumberSlots[adaptedPhoneNumber]));\n      return;\n    }\n\n    if (canSubmit) {\n      setAuthPhoneNumber({ phoneNumber: fullNumber });\n    }\n  }\n\n  const handleGoToAuthQrCode = useLastCallback(() => {\n    goToAuthQrCode();\n  });\n\n  const isAuthReady = authState === 'authorizationStateWaitPhoneNumber';\n\n  return (\n    <div id=\"auth-phone-number-form\" className=\"custom-scroll\">\n      {hasActiveAccount && (\n        <Button size=\"smaller\" round color=\"translucent\" className=\"auth-close\" onClick={handleBackNavigation}>\n          <Icon name=\"close\" />\n        </Button>\n      )}\n      <div className=\"auth-form\">\n        <div id=\"logo\" />\n        <h1>{lang('AuthTitle')}</h1>\n        <p className=\"note\">{lang('StartText')}</p>\n        <form className=\"form\" action=\"\" onSubmit={handleSubmit}>\n          <CountryCodeInput\n            id=\"sign-in-phone-code\"\n            value={country}\n            isLoading={!authNearestCountry && !country}\n            onChange={handleCountryChange}\n          />\n          <InputText\n            ref={inputRef}\n            id=\"sign-in-phone-number\"\n            label={lang('LoginPhonePlaceholder')}\n            value={fullNumber}\n            error={authErrorKey && lang.withRegular(authErrorKey)}\n            inputMode=\"tel\"\n            onChange={handlePhoneNumberChange}\n            onPaste={IS_SAFARI ? handlePaste : undefined}\n          />\n          <Checkbox\n            id=\"sign-in-keep-session\"\n            label={lang('AuthKeepSignedIn')}\n            checked={Boolean(authRememberMe)}\n            onChange={handleKeepSessionChange}\n          />\n          {canSubmit && (\n            isAuthReady ? (\n              <Button size=\"smaller\" type=\"submit\" ripple isLoading={authIsLoading}>{lang('LoginNext')}</Button>\n            ) : (\n              <Loading />\n            )\n          )}\n          {isAuthReady && (\n            <Button size=\"smaller\" isText ripple isLoading={authIsLoadingQrCode} onClick={handleGoToAuthQrCode}>\n              {lang('LoginQRLogin')}\n            </Button>\n          )}\n          {suggestedLanguage && suggestedLanguage !== language && continueText && (\n            <Button size=\"smaller\" isText isLoading={isLoading} onClick={handleLangChange}>{continueText}</Button>\n          )}\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default memo(withGlobal(\n  (global): StateProps => {\n    const {\n      sharedState: { settings: { language } },\n      countryList: { phoneCodes: phoneCodeList },\n    } = global;\n\n    return {\n      ...pick(global, [\n        'connectionState',\n        'authState',\n        'authPhoneNumber',\n        'authIsLoading',\n        'authIsLoadingQrCode',\n        'authErrorKey',\n        'authRememberMe',\n        'authNearestCountry',\n      ]),\n      language,\n      phoneCodeList,\n    };\n  },\n)(AuthPhoneNumber));","import React, {\n  memo, useLayoutEffect, useRef,\n} from '../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../global';\n\nimport type { GlobalState } from '../../global/types';\n\nimport { STRICTERDOM_ENABLED } from '../../config';\nimport { disableStrict, enableStrict } from '../../lib/fasterdom/stricterdom';\nimport { selectSharedSettings } from '../../global/selectors/sharedState';\nimport buildClassName from '../../util/buildClassName';\nimport { oldSetLanguage } from '../../util/oldLangProvider';\nimport { LOCAL_TGS_URLS } from '../common/helpers/animatedAssets';\nimport { navigateBack } from './helpers/backNavigation';\nimport { getSuggestedLanguage } from './helpers/getSuggestedLanguage';\n\nimport useAsync from '../../hooks/useAsync';\nimport useFlag from '../../hooks/useFlag';\nimport useLang from '../../hooks/useLang';\nimport useLangString from '../../hooks/useLangString';\nimport useLastCallback from '../../hooks/useLastCallback';\nimport useMediaTransitionDeprecated from '../../hooks/useMediaTransitionDeprecated';\nimport useMultiaccountInfo from '../../hooks/useMultiaccountInfo';\n\nimport AnimatedIcon from '../common/AnimatedIcon';\nimport Icon from '../common/icons/Icon';\nimport Button from '../ui/Button';\nimport Loading from '../ui/Loading';\n\nimport blankUrl from '../../assets/blank.png';\n\ntype StateProps =\n  Pick<GlobalState, 'connectionState' | 'authState' | 'authQrCode'>\n  & {\n    language?: string;\n  };\n\nconst DATA_PREFIX = 'tg://login?token=';\nconst QR_SIZE = 280;\nconst QR_PLANE_SIZE = 54;\nconst QR_CODE_MUTATION_DURATION = 50; // The library is asynchronous and we need to wait for its mutation code\n\nlet qrCodeStylingPromise: Promise<typeof import('qr-code-styling')>;\n\nfunction ensureQrCodeStyling() {\n  if (!qrCodeStylingPromise) {\n    qrCodeStylingPromise = import('qr-code-styling');\n  }\n  return qrCodeStylingPromise;\n}\n\nconst AuthCode = ({\n  connectionState,\n  authState,\n  authQrCode,\n  language,\n}: StateProps) => {\n  const {\n    returnToAuthPhoneNumber,\n    setSharedSettingOption,\n  } = getActions();\n\n  const suggestedLanguage = getSuggestedLanguage();\n  const lang = useLang();\n  // eslint-disable-next-line no-null/no-null\n  const qrCodeRef = useRef<HTMLDivElement>(null);\n\n  const isConnected = connectionState === 'connectionStateReady';\n  const continueText = useLangString('AuthContinueOnThisLanguage', suggestedLanguage);\n  const [isLoading, markIsLoading, unmarkIsLoading] = useFlag();\n  const [isQrMounted, markQrMounted, unmarkQrMounted] = useFlag();\n\n  const accountsInfo = useMultiaccountInfo();\n  const hasActiveAccount = Object.values(accountsInfo).length > 0;\n\n  const { result: qrCode } = useAsync(async () => {\n    const QrCodeStyling = (await ensureQrCodeStyling()).default;\n    return new QrCodeStyling({\n      width: QR_SIZE,\n      height: QR_SIZE,\n      image: blankUrl,\n      margin: 10,\n      type: 'svg',\n      dotsOptions: {\n        type: 'rounded',\n      },\n      cornersSquareOptions: {\n        type: 'extra-rounded',\n      },\n      imageOptions: {\n        imageSize: 0.4,\n        margin: 8,\n      },\n      qrOptions: {\n        errorCorrectionLevel: 'M',\n      },\n    });\n  }, []);\n\n  const transitionClassNames = useMediaTransitionDeprecated(isQrMounted);\n\n  useLayoutEffect(() => {\n    if (!authQrCode || !qrCode) {\n      return () => {\n        unmarkQrMounted();\n      };\n    }\n\n    if (!isConnected) {\n      return undefined;\n    }\n\n    const container = qrCodeRef.current!;\n    const data = `${DATA_PREFIX}${authQrCode.token}`;\n\n    if (STRICTERDOM_ENABLED) {\n      disableStrict();\n    }\n\n    qrCode.update({\n      data,\n    });\n\n    if (!isQrMounted) {\n      qrCode.append(container);\n      markQrMounted();\n    }\n\n    if (STRICTERDOM_ENABLED) {\n      setTimeout(() => {\n        enableStrict();\n      }, QR_CODE_MUTATION_DURATION);\n    }\n\n    return undefined;\n  }, [isConnected, authQrCode, isQrMounted, markQrMounted, unmarkQrMounted, qrCode]);\n\n  const handleBackNavigation = useLastCallback(() => {\n    navigateBack();\n  });\n\n  const handleLangChange = useLastCallback(() => {\n    markIsLoading();\n\n    void oldSetLanguage(suggestedLanguage, () => {\n      unmarkIsLoading();\n\n      setSharedSettingOption({ language: suggestedLanguage });\n    });\n  });\n\n  const handleReturnToAuthPhoneNumber = useLastCallback(() => {\n    returnToAuthPhoneNumber();\n  });\n\n  const isAuthReady = authState === 'authorizationStateWaitQrCode';\n\n  return (\n    <div id=\"auth-qr-form\" className=\"custom-scroll\">\n      {hasActiveAccount && (\n        <Button size=\"smaller\" round color=\"translucent\" className=\"auth-close\" onClick={handleBackNavigation}>\n          <Icon name=\"close\" />\n        </Button>\n      )}\n      <div className=\"auth-form qr\">\n        <div className=\"qr-outer\">\n          <div\n            className={buildClassName('qr-inner', transitionClassNames)}\n            key=\"qr-inner\"\n          >\n            <div\n              key=\"qr-container\"\n              className=\"qr-container\"\n              ref={qrCodeRef}\n              style={`width: ${QR_SIZE}px; height: ${QR_SIZE}px`}\n            />\n            <AnimatedIcon\n              tgsUrl={LOCAL_TGS_URLS.QrPlane}\n              size={QR_PLANE_SIZE}\n              className=\"qr-plane\"\n              nonInteractive\n              noLoop={false}\n            />\n          </div>\n          {!isQrMounted && <div className=\"qr-loading\"><Loading /></div>}\n        </div>\n        <h1>{lang('LoginQRTitle')}</h1>\n        <ol>\n          <li><span>{lang('LoginQRHelp1')}</span></li>\n          <li><span>{lang('LoginQRHelp2', undefined, { withNodes: true, withMarkdown: true })}</span></li>\n          <li><span>{lang('LoginQRHelp3')}</span></li>\n        </ol>\n        {isAuthReady && (\n          <Button size=\"smaller\" isText onClick={handleReturnToAuthPhoneNumber}>{lang('LoginQRCancel')}</Button>\n        )}\n        {suggestedLanguage && suggestedLanguage !== language && continueText && (\n          <Button size=\"smaller\" isText isLoading={isLoading} onClick={handleLangChange}>{continueText}</Button>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default memo(withGlobal(\n  (global): StateProps => {\n    const {\n      connectionState, authState, authQrCode,\n    } = global;\n\n    const { language } = selectSharedSettings(global);\n\n    return {\n      connectionState,\n      authState,\n      authQrCode,\n      language,\n    };\n  },\n)(AuthCode));","import type { FC } from '../../lib/teact/teact';\nimport React from '../../lib/teact/teact';\n\nimport { Bundles } from '../../util/moduleLoader';\n\nimport useModuleLoader from '../../hooks/useModuleLoader';\n\nimport Loading from '../ui/Loading';\n\nconst AuthRegisterAsync: FC = () => {\n  const AuthRegister = useModuleLoader(Bundles.Auth, 'AuthRegister');\n\n  return AuthRegister ? <AuthRegister /> : <Loading />;\n};\n\nexport default AuthRegisterAsync;\n","import '../../global/actions/initial';\n\nimport type { FC } from '../../lib/teact/teact';\nimport React, { memo, useRef } from '../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../global';\n\nimport type { GlobalState } from '../../global/types';\n\nimport { PLATFORM_ENV } from '../../util/browser/windowEnvironment';\n\nimport useCurrentOrPrev from '../../hooks/useCurrentOrPrev';\nimport useElectronDrag from '../../hooks/useElectronDrag';\nimport useHistoryBack from '../../hooks/useHistoryBack';\n\nimport Transition from '../ui/Transition';\nimport AuthCode from './AuthCode.async';\nimport AuthPassword from './AuthPassword.async';\nimport AuthPhoneNumber from './AuthPhoneNumber';\nimport AuthQrCode from './AuthQrCode';\nimport AuthRegister from './AuthRegister.async';\n\nimport './Auth.scss';\n\ntype StateProps = Pick<GlobalState, 'authState'>;\n\nconst Auth: FC<StateProps> = ({\n  authState,\n}) => {\n  const {\n    returnToAuthPhoneNumber, goToAuthQrCode,\n  } = getActions();\n\n  const isMobile = PLATFORM_ENV === 'iOS' || PLATFORM_ENV === 'Android';\n\n  const handleChangeAuthorizationMethod = () => {\n    if (!isMobile) {\n      goToAuthQrCode();\n    } else {\n      returnToAuthPhoneNumber();\n    }\n  };\n\n  useHistoryBack({\n    isActive: (!isMobile && authState === 'authorizationStateWaitPhoneNumber')\n      || (isMobile && authState === 'authorizationStateWaitQrCode'),\n    onBack: handleChangeAuthorizationMethod,\n  });\n\n  // eslint-disable-next-line no-null/no-null\n  const containerRef = useRef<HTMLDivElement>(null);\n  useElectronDrag(containerRef);\n\n  // For animation purposes\n  const renderingAuthState = useCurrentOrPrev(\n    authState !== 'authorizationStateReady' ? authState : undefined,\n    true,\n  );\n\n  function getScreen() {\n    switch (renderingAuthState) {\n      case 'authorizationStateWaitCode':\n        return <AuthCode />;\n      case 'authorizationStateWaitPassword':\n        return <AuthPassword />;\n      case 'authorizationStateWaitRegistration':\n        return <AuthRegister />;\n      case 'authorizationStateWaitPhoneNumber':\n        return <AuthPhoneNumber />;\n      case 'authorizationStateWaitQrCode':\n        return <AuthQrCode />;\n      default:\n        return isMobile ? <AuthPhoneNumber /> : <AuthQrCode />;\n    }\n  }\n\n  function getActiveKey() {\n    switch (renderingAuthState) {\n      case 'authorizationStateWaitCode':\n        return 0;\n      case 'authorizationStateWaitPassword':\n        return 1;\n      case 'authorizationStateWaitRegistration':\n        return 2;\n      case 'authorizationStateWaitPhoneNumber':\n        return 3;\n      case 'authorizationStateWaitQrCode':\n        return 4;\n      default:\n        return isMobile ? 3 : 4;\n    }\n  }\n\n  return (\n    <Transition activeKey={getActiveKey()} name=\"fade\" className=\"Auth\" ref={containerRef}>\n      {getScreen()}\n    </Transition>\n  );\n};\n\nexport default memo(withGlobal(\n  (global): StateProps => {\n    return {\n      authState: global.authState,\n    };\n  },\n)(Auth));\n","// extracted by mini-css-extract-plugin\nexport default {\"bg\":\"ThfRMqwq\"};","// extracted by mini-css-extract-plugin\nexport default {\"mask\":\"U9MowLv_\",\"main\":\"RcG6eRZw\",\"left\":\"oL7XcRwI\",\"middle\":\"LYe7IaQO\",\"right\":\"wYSGQZXX\",\"blank\":\"kN2M6u9m\"};","import type { FC } from '../../lib/teact/teact';\nimport React from '../../lib/teact/teact';\nimport { getActions, getGlobal, withGlobal } from '../../global';\n\nimport type { TabState } from '../../global/types';\nimport { ApiMediaFormat } from '../../api/types';\n\nimport { getChatAvatarHash } from '../../global/helpers/chats'; // Direct import for better module splitting\nimport { selectIsRightColumnShown, selectTabState } from '../../global/selectors';\nimport buildClassName from '../../util/buildClassName';\nimport { preloadImage } from '../../util/files';\nimport preloadFonts from '../../util/fonts';\nimport { localizationReadyPromise } from '../../util/localization';\nimport * as mediaLoader from '../../util/mediaLoader';\nimport { Bundles, loadModule } from '../../util/moduleLoader';\nimport { pause } from '../../util/schedulers';\n\nimport useEffectOnce from '../../hooks/useEffectOnce';\nimport useFlag from '../../hooks/useFlag';\nimport useShowTransitionDeprecated from '../../hooks/useShowTransitionDeprecated';\n\n// Workaround for incorrect bundling by Webpack: force including in the main chunk\nimport '../ui/Modal.scss';\nimport './Avatar.scss';\nimport appStyles from '../App.module.scss';\nimport styles from './UiLoader.module.scss';\n\nimport lockPreviewPath from '../../assets/lock.png';\nimport monkeyPath from '../../assets/monkey.svg';\nimport spoilerMaskPath from '../../assets/spoilers/mask.svg';\nimport telegramLogoPath from '../../assets/telegram-logo.svg';\n\nexport type UiLoaderPage =\n  'main'\n  | 'lock'\n  | 'inactive'\n  | 'authCode'\n  | 'authPassword'\n  | 'authPhoneNumber'\n  | 'authQrCode';\n\ntype OwnProps = {\n  page?: UiLoaderPage;\n  children: React.ReactNode;\n  isMobile?: boolean;\n};\n\ntype StateProps = Pick<TabState, 'uiReadyState' | 'shouldSkipHistoryAnimations'> & {\n  isRightColumnShown?: boolean;\n  leftColumnWidth?: number;\n};\n\nconst MAX_PRELOAD_DELAY = 700;\nconst SECOND_STATE_DELAY = 1000;\nconst AVATARS_TO_PRELOAD = 10;\n\nfunction preloadAvatars() {\n  const { listIds, byId } = getGlobal().chats;\n  if (!listIds.active) {\n    return undefined;\n  }\n\n  return Promise.all(listIds.active.slice(0, AVATARS_TO_PRELOAD).map((chatId) => {\n    const chat = byId[chatId];\n    if (!chat) {\n      return undefined;\n    }\n\n    const avatarHash = getChatAvatarHash(chat);\n    if (!avatarHash) {\n      return undefined;\n    }\n\n    return mediaLoader.fetch(avatarHash, ApiMediaFormat.BlobUrl);\n  }));\n}\n\nconst preloadTasks = {\n  main: () => Promise.all([\n    loadModule(Bundles.Main)\n      .then(preloadFonts),\n    preloadAvatars(),\n    preloadImage(spoilerMaskPath),\n    localizationReadyPromise,\n  ]),\n  authPhoneNumber: () => Promise.all([\n    preloadFonts(),\n    preloadImage(telegramLogoPath),\n  ]),\n  authCode: () => preloadImage(monkeyPath),\n  authPassword: () => preloadImage(monkeyPath),\n  authQrCode: preloadFonts,\n  lock: () => Promise.all([\n    preloadFonts(),\n    preloadImage(lockPreviewPath),\n  ]),\n  inactive: () => {\n  },\n};\n\nconst UiLoader: FC<OwnProps & StateProps> = ({\n  page,\n  children,\n  isRightColumnShown,\n  shouldSkipHistoryAnimations,\n  leftColumnWidth,\n}) => {\n  const { setIsUiReady } = getActions();\n\n  const [isReady, markReady] = useFlag();\n  const {\n    shouldRender: shouldRenderMask, transitionClassNames,\n  } = useShowTransitionDeprecated(!isReady, undefined, true);\n\n  useEffectOnce(() => {\n    let timeout: number | undefined;\n\n    const safePreload = async () => {\n      try {\n        await preloadTasks[page!]();\n      } catch (err) {\n        // Do nothing\n      }\n    };\n\n    Promise.race([\n      pause(MAX_PRELOAD_DELAY),\n      page ? safePreload() : Promise.resolve(),\n    ]).then(() => {\n      markReady();\n      setIsUiReady({ uiReadyState: 1 });\n\n      timeout = window.setTimeout(() => {\n        setIsUiReady({ uiReadyState: 2 });\n      }, SECOND_STATE_DELAY);\n    });\n\n    return () => {\n      if (timeout) {\n        clearTimeout(timeout);\n        timeout = undefined;\n      }\n\n      setIsUiReady({ uiReadyState: 0 });\n    };\n  });\n\n  return (\n    <>\n      {children}\n      {shouldRenderMask && !shouldSkipHistoryAnimations && Boolean(page) && (\n        <div className={buildClassName(styles.mask, transitionClassNames)}>\n          {page === 'main' ? (\n            <div className={styles.main}>\n              <div\n                className={styles.left}\n                style={leftColumnWidth ? `width: ${leftColumnWidth}px` : undefined}\n              />\n              <div className={buildClassName(styles.middle, appStyles.bg)} />\n              {isRightColumnShown && <div className={styles.right} />}\n            </div>\n          ) : (page === 'inactive' || page === 'lock') ? (\n            <div className={buildClassName(styles.blank, appStyles.bg)} />\n          ) : (\n            <div className={styles.blank} />\n          )}\n        </div>\n      )}\n    </>\n  );\n};\n\nexport default withGlobal<OwnProps>(\n  (global, { isMobile }): StateProps => {\n    const tabState = selectTabState(global);\n\n    return {\n      shouldSkipHistoryAnimations: tabState.shouldSkipHistoryAnimations,\n      uiReadyState: tabState.uiReadyState,\n      isRightColumnShown: selectIsRightColumnShown(global, isMobile),\n      leftColumnWidth: global.leftColumnWidth,\n    };\n  },\n)(UiLoader);\n","import type { FC } from '../../lib/teact/teact';\nimport React, { useCallback } from '../../lib/teact/teact';\n\nimport useHistoryBack from '../../hooks/useHistoryBack';\n\nimport Button from '../ui/Button';\n\nimport './AppInactive.scss';\n\nimport appInactivePath from '../../assets/app-inactive.png';\n\nconst AppInactive: FC = () => {\n  const handleReload = useCallback(() => {\n    window.location.reload();\n  }, []);\n\n  useHistoryBack({\n    isActive: true,\n    onBack: handleReload,\n    shouldResetUrlHash: true,\n  });\n\n  return (\n    <div id=\"AppInactive\">\n      <div className=\"content\">\n        <img src={appInactivePath} alt=\"\" />\n        <h3 className=\"title\">Such error, many tabs</h3>\n        <div className=\"description\">\n          Telegram supports only one active tab with the app.\n          <br />\n          Please reload this page to continue using this tab or close it.\n        </div>\n        <div className=\"actions\">\n          <Button isText ripple onClick={handleReload}>\n            Reload app\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default AppInactive;\n","import type { FC } from '../../lib/teact/teact';\nimport React from '../../lib/teact/teact';\n\nimport type { OwnProps } from './LockScreen';\n\nimport { Bundles } from '../../util/moduleLoader';\n\nimport useModuleLoader from '../../hooks/useModuleLoader';\n\nconst LockScreenAsync: FC<OwnProps> = (props) => {\n  const { isLocked } = props;\n  const LockScreen = useModuleLoader(Bundles.Main, 'LockScreen', !isLocked);\n\n  // eslint-disable-next-line react/jsx-props-no-spreading\n  return LockScreen ? <LockScreen {...props} /> : undefined;\n};\n\nexport default LockScreenAsync;\n","import type { FC } from '../../lib/teact/teact';\nimport React from '../../lib/teact/teact';\n\nimport type { OwnProps } from './Main';\n\nimport { Bundles } from '../../util/moduleLoader';\n\nimport useModuleLoader from '../../hooks/useModuleLoader';\n\nconst MainAsync: FC<OwnProps> = (props) => {\n  const Main = useModuleLoader(Bundles.Main, 'Main');\n\n  // eslint-disable-next-line react/jsx-props-no-spreading\n  return Main ? <Main {...props} /> : undefined;\n};\n\nexport default MainAsync;\n","import type { FC } from '../lib/teact/teact';\nimport React, { useEffect, useLayoutEffect } from '../lib/teact/teact';\nimport { withGlobal } from '../global';\n\nimport type { GlobalState } from '../global/types';\nimport type { ThemeKey } from '../types';\nimport type { UiLoaderPage } from './common/UiLoader';\n\nimport {\n  DARK_THEME_BG_COLOR, INACTIVE_MARKER, LIGHT_THEME_BG_COLOR, PAGE_TITLE,\n} from '../config';\nimport { selectTabState, selectTheme } from '../global/selectors';\nimport { IS_INSTALL_PROMPT_SUPPORTED, PLATFORM_ENV } from '../util/browser/windowEnvironment';\nimport buildClassName from '../util/buildClassName';\nimport { setupBeforeInstallPrompt } from '../util/installPrompt';\nimport { ACCOUNT_SLOT, getAccountsInfo, getAccountSlotUrl } from '../util/multiaccount';\nimport { hasEncryptedSession } from '../util/passcode';\nimport { getInitialLocationHash, parseInitialLocationHash } from '../util/routing';\nimport { checkSessionLocked, hasStoredSession } from '../util/sessions';\nimport { updateSizes } from '../util/windowSize';\nimport { setChataiStoreBuilderCurrentUserId } from './chatAssistant/store';\n\nimport useAppLayout from '../hooks/useAppLayout';\nimport useFlag from '../hooks/useFlag';\nimport usePreviousDeprecated from '../hooks/usePreviousDeprecated';\n\n// import Test from './test/TestLocale';\nimport Auth from './auth/Auth';\nimport UiLoader from './common/UiLoader';\nimport AppInactive from './main/AppInactive';\nimport LockScreen from './main/LockScreen.async';\nimport Main from './main/Main.async';\nimport Transition from './ui/Transition';\n\nimport styles from './App.module.scss';\n\ntype StateProps = {\n  authState: GlobalState['authState'];\n  isScreenLocked?: boolean;\n  hasPasscode?: boolean;\n  isInactiveAuth?: boolean;\n  hasWebAuthTokenFailed?: boolean;\n  isTestServer?: boolean;\n  theme: ThemeKey;\n};\n\nenum AppScreens {\n  auth,\n  main,\n  lock,\n  inactive,\n}\n\nconst TRANSITION_RENDER_COUNT = Object.keys(AppScreens).length / 2;\nconst INACTIVE_PAGE_TITLE = `${PAGE_TITLE} ${INACTIVE_MARKER}`;\n\nconst App: FC<StateProps> = ({\n  authState,\n  isScreenLocked,\n  hasPasscode,\n  isInactiveAuth,\n  hasWebAuthTokenFailed,\n  isTestServer,\n  theme,\n}) => {\n  const [isInactive, markInactive, unmarkInactive] = useFlag(false);\n  const { isMobile } = useAppLayout();\n  const isMobileOs = PLATFORM_ENV === 'iOS' || PLATFORM_ENV === 'Android';\n\n  useEffect(() => {\n    if (IS_INSTALL_PROMPT_SUPPORTED) {\n      setupBeforeInstallPrompt();\n    }\n  }, []);\n\n  useEffect(() => {\n    const hash = getInitialLocationHash();\n    // If there is no stored session on first slot, navigate to any other slot with stored session\n    if (!hasStoredSession() && !ACCOUNT_SLOT && !hash) {\n      const accounts = getAccountsInfo();\n      Object.keys(accounts)\n        .map(Number)\n        .sort((a, b) => b - a)\n        .forEach((key) => {\n          const slot = Number(key);\n          const account = accounts[slot];\n          if (account) {\n            const url = getAccountSlotUrl(slot);\n            window.location.href = `${url}#${hash || 'login'}`;\n          }\n        });\n    }\n\n    // TODO[Passcode]: Remove when multiacc passcode is implemented\n    const checkMultiaccPasscode = async () => {\n      if (checkSessionLocked() && ACCOUNT_SLOT && await hasEncryptedSession()) {\n        const url = getAccountSlotUrl(1);\n        window.location.href = url;\n      }\n    };\n    checkMultiaccPasscode();\n  }, []);\n\n  // Prevent drop on elements that do not accept it\n  useEffect(() => {\n    const body = document.body;\n    const handleDrag = (e: DragEvent) => {\n      e.preventDefault();\n      if (!e.dataTransfer) return;\n      if (!(e.target as HTMLElement).dataset.dropzone) {\n        e.dataTransfer.dropEffect = 'none';\n      } else {\n        e.dataTransfer.dropEffect = 'copy';\n      }\n    };\n    const handleDrop = (e: DragEvent) => {\n      e.preventDefault();\n    };\n    body.addEventListener('drop', handleDrop);\n    body.addEventListener('dragover', handleDrag);\n    body.addEventListener('dragenter', handleDrag);\n\n    return () => {\n      body.removeEventListener('drop', handleDrop);\n      body.removeEventListener('dragover', handleDrag);\n      body.removeEventListener('dragenter', handleDrag);\n    };\n  }, []);\n\n  // return <Test />;\n\n  let activeKey: number;\n  let page: UiLoaderPage | undefined;\n\n  if (isInactive) {\n    activeKey = AppScreens.inactive;\n  } else if (isScreenLocked) {\n    page = 'lock';\n    activeKey = AppScreens.lock;\n  } else if (authState) {\n    switch (authState) {\n      case 'authorizationStateWaitPhoneNumber':\n        page = 'authPhoneNumber';\n        activeKey = AppScreens.auth;\n        break;\n      case 'authorizationStateWaitCode':\n        page = 'authCode';\n        activeKey = AppScreens.auth;\n        break;\n      case 'authorizationStateWaitPassword':\n        page = 'authPassword';\n        activeKey = AppScreens.auth;\n        break;\n      case 'authorizationStateWaitRegistration':\n        activeKey = AppScreens.auth;\n        break;\n      case 'authorizationStateWaitQrCode':\n        page = 'authQrCode';\n        activeKey = AppScreens.auth;\n        break;\n      case 'authorizationStateClosed':\n      case 'authorizationStateClosing':\n      case 'authorizationStateLoggingOut':\n      case 'authorizationStateReady':\n        page = 'main';\n        activeKey = AppScreens.main;\n        break;\n    }\n  } else if (hasStoredSession()) {\n    page = 'main';\n    activeKey = AppScreens.main;\n  } else if (hasPasscode) {\n    activeKey = AppScreens.lock;\n  } else {\n    page = isMobileOs ? 'authPhoneNumber' : 'authQrCode';\n    activeKey = AppScreens.auth;\n  }\n\n  if (activeKey !== AppScreens.lock\n    && activeKey !== AppScreens.inactive\n    && activeKey !== AppScreens.main\n    && parseInitialLocationHash()?.tgWebAuthToken\n    && !hasWebAuthTokenFailed) {\n    page = 'main';\n    activeKey = AppScreens.main;\n  }\n\n  useEffect(() => {\n    updateSizes();\n  }, []);\n\n  useEffect(() => {\n    if (isInactiveAuth) {\n      document.title = INACTIVE_PAGE_TITLE;\n      markInactive();\n    } else {\n      document.title = PAGE_TITLE;\n      unmarkInactive();\n    }\n  }, [isInactiveAuth, markInactive, unmarkInactive]);\n\n  const prevActiveKey = usePreviousDeprecated(activeKey);\n\n  // eslint-disable-next-line consistent-return\n  function renderContent() {\n    switch (activeKey) {\n      case AppScreens.auth:\n        return <Auth />;\n      case AppScreens.main:\n        return <Main isMobile={isMobile} />;\n      case AppScreens.lock:\n        return <LockScreen isLocked={isScreenLocked} />;\n      case AppScreens.inactive:\n        return <AppInactive />;\n    }\n  }\n\n  useLayoutEffect(() => {\n    document.body.classList.add(styles.bg);\n  }, []);\n\n  useLayoutEffect(() => {\n    document.body.style.setProperty(\n      '--theme-background-color',\n      theme === 'dark' ? DARK_THEME_BG_COLOR : LIGHT_THEME_BG_COLOR,\n    );\n  }, [theme]);\n\n  return (\n    <UiLoader page={page} isMobile={isMobile}>\n      <Transition\n        name=\"fade\"\n        activeKey={activeKey}\n        shouldCleanup\n        className={buildClassName(\n          'full-height',\n          (activeKey === AppScreens.auth || prevActiveKey === AppScreens.auth) && 'is-auth',\n        )}\n        renderCount={TRANSITION_RENDER_COUNT}\n      >\n        {renderContent}\n      </Transition>\n      {activeKey === AppScreens.auth && isTestServer && <div className=\"test-server-badge\">Test server</div>}\n    </UiLoader>\n  );\n};\n\nexport default withGlobal(\n  (global): StateProps => {\n    const { currentUserId } = global;\n    if (currentUserId) {\n      setChataiStoreBuilderCurrentUserId(currentUserId);\n    }\n    return {\n      authState: global.authState,\n      isScreenLocked: global.passcode?.isScreenLocked,\n      hasPasscode: global.passcode?.hasPasscode,\n      isInactiveAuth: selectTabState(global).isInactive,\n      hasWebAuthTokenFailed: global.hasWebAuthTokenFailed || global.hasWebAuthTokenPasswordRequired,\n      theme: selectTheme(global),\n      isTestServer: global.config?.isTestServer,\n    };\n  },\n)(App);\n","import './util/handleError';\nimport './util/setupServiceWorker';\nimport './global/init';\n\nimport React from './lib/teact/teact';\nimport TeactDOM from './lib/teact/teact-dom';\nimport {\n  getActions, getGlobal,\n} from './global';\n\nimport {\n  DEBUG, STRICTERDOM_ENABLED,\n} from './config';\nimport { enableStrict, requestMutation } from './lib/fasterdom/fasterdom';\nimport { selectTabState } from './global/selectors';\nimport { selectSharedSettings } from './global/selectors/sharedState';\nimport { betterView } from './util/betterView';\nimport { requestGlobal, subscribeToMultitabBroadcastChannel } from './util/browser/multitab';\nimport { establishMultitabRole, subscribeToMasterChange } from './util/establishMultitabRole';\nimport { initGlobal } from './util/init';\nimport { initLocalization } from './util/localization';\nimport { MULTITAB_STORAGE_KEY } from './util/multiaccount';\nimport { checkAndAssignPermanentWebVersion } from './util/permanentWebVersion';\nimport { onBeforeUnload } from './util/schedulers';\nimport updateWebmanifest from './util/updateWebmanifest';\nimport { initChatAI } from './components/chatAssistant/utils/init';\n\nimport App from './components/App';\n\nimport './styles/index.css';\nimport './assets/fonts/roboto.css';\nimport './styles/index.scss';\n\nif (STRICTERDOM_ENABLED) {\n  enableStrict();\n}\n\ninit();\n\nasync function init() {\n  if (DEBUG) {\n    // eslint-disable-next-line no-console\n    console.log('>>> INIT');\n  }\n\n  if (!(window as any).isCompatTestPassed) return;\n\n  checkAndAssignPermanentWebVersion();\n\n  await window.electron?.restoreLocalStorage();\n\n  subscribeToMultitabBroadcastChannel();\n  await requestGlobal(APP_VERSION);\n  localStorage.setItem(MULTITAB_STORAGE_KEY, '1');\n  onBeforeUnload(() => {\n    const global = getGlobal();\n    if (Object.keys(global.byTabId).length === 1) {\n      localStorage.removeItem(MULTITAB_STORAGE_KEY);\n    }\n  });\n\n  await initGlobal();\n  getActions().init();\n\n  getActions().updateShouldEnableDebugLog();\n  getActions().updateShouldDebugExportedSenders();\n\n  const global = getGlobal();\n\n  initLocalization(selectSharedSettings(global).language, true);\n\n  initChatAI();\n\n  subscribeToMasterChange((isMasterTab) => {\n    getActions()\n      .switchMultitabRole({ isMasterTab }, { forceSyncOnIOs: true });\n  });\n  const shouldReestablishMasterToSelf = getGlobal().authState !== 'authorizationStateReady';\n  establishMultitabRole(shouldReestablishMasterToSelf);\n\n  if (DEBUG) {\n    // eslint-disable-next-line no-console\n    console.log('>>> START INITIAL RENDER');\n  }\n\n  requestMutation(() => {\n    updateWebmanifest();\n\n    TeactDOM.render(\n      <App />,\n      document.getElementById('root')!,\n    );\n\n    betterView();\n  });\n\n  if (DEBUG) {\n    // eslint-disable-next-line no-console\n    console.log('>>> FINISH INITIAL RENDER');\n  }\n\n  if (DEBUG) {\n    document.addEventListener('dblclick', () => {\n      // eslint-disable-next-line no-console\n      console.warn('TAB STATE', selectTabState(getGlobal()));\n      // eslint-disable-next-line no-console\n      console.warn('GLOBAL STATE', getGlobal());\n    });\n  }\n}\n\nonBeforeUnload(() => {\n  const actions = getActions();\n  actions.leaveGroupCall?.({ isPageUnload: true });\n  actions.hangUp?.({ isPageUnload: true });\n});\n","import { getActions } from '../../../global';\n\nimport { CHATAI_IDB_STORE } from '../../../util/browser/idb';\nimport { aiChatFoldersTask } from \"../ai-task/ai-chatfolders-task\"\nimport { globalSummaryTask } from '../ai-task/global-summary-task';\nimport { intelligentReplyTask } from '../ai-task/intelligent-reply-task';\nimport { urgentCheckTask } from '../ai-task/urgent-check-task';\nimport { TOOLS_SCHEDULE_MEETING_ID, TOOLS_SEARCH_GROUP_ID, TOOLS_SEARCH_USER_ID } from '../variables';\nimport { toolsEmbeddingStore } from '../vector-store';\n\nexport const initChatAI = () => {\n  // init data\n  CHATAI_IDB_STORE.get('auto-translate-language').then((language) => {\n    getActions().setSettingOption({ autoTranslateLanguage: language as string || 'en' });\n    getActions().setSettingOption({ translationLanguage: language as string || 'en' });\n  });\n  CHATAI_IDB_STORE.get('auto-translate').then((value) => {\n    getActions().setSettingOption({ autoTranslate: value as boolean || false });\n  });\n  // init global summary\n  globalSummaryTask.initTask();\n  // init intelligent reply task\n  intelligentReplyTask.initTask();\n  // init urgent alert task\n  urgentCheckTask.initTask();\n  // check tools embedding\n  // const scheduleMeetEmbedding = await ;\n  toolsEmbeddingStore.getText(TOOLS_SCHEDULE_MEETING_ID).then((res:any) => {\n    if (!res) {\n      toolsEmbeddingStore.addText('约会，安排会议，创建会议，schedule meeting', TOOLS_SCHEDULE_MEETING_ID, {});\n    }\n  });\n  toolsEmbeddingStore.getText(TOOLS_SEARCH_GROUP_ID).then((res:any) => {\n    if (!res) {\n      toolsEmbeddingStore.addText('searching for group/chanel/team/channel', TOOLS_SEARCH_GROUP_ID, {});\n    }\n  });\n  toolsEmbeddingStore.getText(TOOLS_SEARCH_USER_ID).then((res:any) => {\n    if (!res) {\n      toolsEmbeddingStore.addText('searching for a user/person/peer', TOOLS_SEARCH_USER_ID, {});\n    }\n  });\n  // init ai chat folders task\n  aiChatFoldersTask.initTask();\n};\n","// Original idea was found here\n// https://medium.com/@alshakero/how-to-setup-your-web-app-manifest-dynamically-using-javascript-f7fbee899a61\n\nimport { DEBUG } from '../config';\nimport { IS_MAC_OS } from './browser/windowEnvironment';\n\nexport default function updateWebmanifest() {\n  if (!IS_MAC_OS) {\n    return;\n  }\n\n  const manifest = document.getElementById('the-manifest-placeholder');\n  if (!manifest) {\n    return;\n  }\n\n  const url = `site_apple${DEBUG ? '_dev' : ''}.webmanifest`;\n  manifest.setAttribute('href', url);\n}\n"],"names":["leafPrototypes","getProto","inProgress","dataWebpackPrefix","useCurrentOrPrev","current","shouldSkipUndefined","shouldForceCurrent","prev","usePreviousDeprecated","RE_NOT_LETTER","e","searchWords","haystack","needle","needleWords","toLowerCase","split","haystackLower","length","includes","haystackWords","every","needleWord","some","haystackWord","startsWith","prepareSearchWordsForNeedle","useThrottledCallback","fn","deps","msOrSchedulerFn","noFirst","fnMemo","useCallback","useMemo","throttle","throttleWith","selectCurrentViewedStory","global","tabId","getCurrentTabId","storyViewer","peerId","storyId","selectTabState","selectIsStoryViewerOpen","Boolean","selectPeerStories","stories","byPeerId","selectPeerStory","byId","selectPinnedStories","pinnedIds","map","id","filter","s","isInProfile","selectPeerFirstUnreadStoryId","peerStories","lastReadId","orderedIds","lastReadIndex","findIndex","selectPeerFirstStoryId","selectStoryListForViewer","isSingleStory","isSinglePeer","isPrivate","isArchive","currentStoryId","peerIds","storyIdsByPeerId","peer","selectPeer","story","isUnread","storyIds","getPeerStoryIdsForViewer","undefined","orderedPeerIds","active","archived","areStoriesHidden","currentPeerId","push","storySourceProp","slice","indexOf","error","showError","window","addEventListener","handleErrorEvent","DEBUG","isCurrentTabMaster","alert","getErrorMessage","throttleError","err","handleError","console","ErrorEvent","message","preventDefault","reason","DEBUG_ALERT_MSG","stack","FUNC_ERROR_TEXT","HASH_UNDEFINED","PLACEHOLDER","WRAP_PARTIAL_FLAG","WRAP_ARY_FLAG","INFINITY","MAX_SAFE_INTEGER","NAN","MAX_ARRAY_LENGTH","wrapFlags","argsTag","arrayTag","boolTag","dateTag","errorTag","funcTag","genTag","mapTag","numberTag","objectTag","promiseTag","regexpTag","setTag","stringTag","symbolTag","weakMapTag","arrayBufferTag","dataViewTag","float32Tag","float64Tag","int8Tag","int16Tag","int32Tag","uint8Tag","uint8ClampedTag","uint16Tag","uint32Tag","reEmptyStringLeading","reEmptyStringMiddle","reEmptyStringTrailing","reEscapedHtml","reUnescapedHtml","reHasEscapedHtml","RegExp","source","reHasUnescapedHtml","reEscape","reEvaluate","reInterpolate","reIsDeepProp","reIsPlainProp","rePropName","reRegExpChar","reHasRegExpChar","reTrimStart","reWhitespace","reWrapComment","reWrapDetails","reSplitDetails","reAsciiWord","reForbiddenIdentifierChars","reEscapeChar","reEsTemplate","reFlags","reIsBadHex","reIsBinary","reIsHostCtor","reIsOctal","reIsUint","reLatin","reNoMatch","reUnescapedString","rsAstralRange","rsComboRange","rsComboMarksRange","rsDingbatRange","rsLowerRange","rsUpperRange","rsVarRange","rsBreakRange","rsMathOpRange","rsAstral","rsBreak","rsCombo","rsDigits","rsDingbat","rsLower","rsMisc","rsFitz","rsNonAstral","rsRegional","rsSurrPair","rsUpper","rsZWJ","rsMiscLower","rsMiscUpper","rsOptContrLower","rsOptContrUpper","reOptMod","rsModifier","rsOptVar","rsSeq","join","rsEmoji","rsSymbol","reApos","reComboMark","reUnicode","reUnicodeWord","reHasUnicode","reHasUnicodeWord","contextProps","templateCounter","typedArrayTags","cloneableTags","stringEscapes","freeParseFloat","parseFloat","freeParseInt","parseInt","freeGlobal","g","Object","freeSelf","self","root","Function","freeExports","exports","nodeType","freeModule","module","moduleExports","freeProcess","process","nodeUtil","require","types","binding","nodeIsArrayBuffer","isArrayBuffer","nodeIsDate","isDate","nodeIsMap","isMap","nodeIsRegExp","isRegExp","nodeIsSet","isSet","nodeIsTypedArray","isTypedArray","apply","func","thisArg","args","call","arrayAggregator","array","setter","iteratee","accumulator","index","value","arrayEach","arrayEachRight","arrayEvery","predicate","arrayFilter","resIndex","result","arrayIncludes","baseIndexOf","arrayIncludesWith","comparator","arrayMap","Array","arrayPush","values","offset","arrayReduce","initAccum","arrayReduceRight","arraySome","asciiSize","baseProperty","baseFindKey","collection","eachFunc","key","baseFindIndex","fromIndex","fromRight","strictIndexOf","baseIsNaN","baseIndexOfWith","baseMean","baseSum","object","basePropertyOf","baseReduce","baseTimes","n","baseTrim","string","trimmedEndIndex","replace","baseUnary","baseValues","props","cacheHas","cache","has","charsStartIndex","strSymbols","chrSymbols","charsEndIndex","deburrLetter","escapeHtmlChar","escapeStringChar","chr","hasUnicode","test","mapToArray","size","forEach","overArg","transform","arg","replaceHolders","placeholder","setToArray","set","setToPairs","stringSize","lastIndex","unicodeSize","stringToArray","match","unicodeToArray","asciiToArray","charAt","unescapeHtmlChar","_","runInContext","context","uid","defaults","pick","Date","Error","Math","String","TypeError","arrayProto","prototype","funcProto","objectProto","coreJsData","funcToString","toString","hasOwnProperty","idCounter","maskSrcKey","exec","keys","IE_PROTO","nativeObjectToString","objectCtorString","oldDash","reIsNative","Buffer","Symbol","Uint8Array","allocUnsafe","getPrototype","getPrototypeOf","objectCreate","create","propertyIsEnumerable","splice","spreadableSymbol","isConcatSpreadable","symIterator","iterator","symToStringTag","toStringTag","defineProperty","getNative","ctxClearTimeout","clearTimeout","ctxNow","now","ctxSetTimeout","setTimeout","nativeCeil","ceil","nativeFloor","floor","nativeGetSymbols","getOwnPropertySymbols","nativeIsBuffer","isBuffer","nativeIsFinite","isFinite","nativeJoin","nativeKeys","nativeMax","max","nativeMin","min","nativeNow","nativeParseInt","nativeRandom","random","nativeReverse","reverse","DataView","Map","Promise","Set","WeakMap","nativeCreate","metaMap","realNames","dataViewCtorString","toSource","mapCtorString","promiseCtorString","setCtorString","weakMapCtorString","symbolProto","symbolValueOf","valueOf","symbolToString","lodash","isObjectLike","isArray","LazyWrapper","LodashWrapper","wrapperClone","baseCreate","proto","isObject","baseLodash","chainAll","this","__wrapped__","__actions__","__chain__","__index__","__values__","__dir__","__filtered__","__iteratees__","__takeCount__","__views__","Hash","entries","clear","entry","ListCache","MapCache","SetCache","__data__","add","Stack","data","arrayLikeKeys","inherited","isArr","isArg","isArguments","isBuff","isType","skipIndexes","isIndex","arraySample","baseRandom","arraySampleSize","shuffleSelf","copyArray","baseClamp","arrayShuffle","assignMergeValue","eq","baseAssignValue","assignValue","objValue","assocIndexOf","baseAggregator","baseEach","baseAssign","copyObject","baseAt","paths","skip","get","number","lower","upper","baseClone","bitmask","customizer","isDeep","isFlat","isFull","constructor","input","initCloneArray","tag","getTag","isFunc","cloneBuffer","initCloneObject","getSymbolsIn","copySymbolsIn","keysIn","baseAssignIn","getSymbols","copySymbols","symbol","Ctor","cloneArrayBuffer","dataView","buffer","byteOffset","byteLength","cloneDataView","cloneTypedArray","regexp","cloneRegExp","initCloneByTag","stacked","subValue","getAllKeysIn","getAllKeys","baseConformsTo","baseDelay","wait","baseDifference","isCommon","valuesLength","outer","computed","valuesIndex","templateSettings","pop","getMapData","pairs","LARGE_ARRAY_SIZE","createBaseEach","baseForOwn","baseEachRight","baseForOwnRight","baseEvery","baseExtremum","isSymbol","baseFilter","baseFlatten","depth","isStrict","isFlattenable","baseFor","createBaseFor","baseForRight","baseFunctions","isFunction","baseGet","path","castPath","toKey","baseGetAllKeys","keysFunc","symbolsFunc","baseGetTag","isOwn","unmasked","getRawTag","objectToString","baseGt","other","baseHas","baseHasIn","baseIntersection","arrays","othLength","othIndex","caches","maxLength","Infinity","seen","baseInvoke","parent","last","baseIsArguments","baseIsEqual","equalFunc","objIsArr","othIsArr","objTag","othTag","objIsObj","othIsObj","isSameTag","equalArrays","name","convert","isPartial","equalByTag","objIsWrapped","othIsWrapped","objUnwrapped","othUnwrapped","objProps","objLength","objStacked","othStacked","skipCtor","othValue","compared","objCtor","othCtor","equalObjects","baseIsEqualDeep","baseIsMatch","matchData","noCustomizer","srcValue","COMPARE_PARTIAL_FLAG","baseIsNative","baseIteratee","identity","baseMatchesProperty","baseMatches","property","baseKeys","isPrototype","baseLt","baseMap","isArrayLike","getMatchData","matchesStrictComparable","isKey","isStrictComparable","hasIn","baseMerge","srcIndex","mergeFunc","safeGet","newValue","isTyped","isArrayLikeObject","isPlainObject","toPlainObject","baseMergeDeep","baseNth","baseOrderBy","iteratees","orders","getIteratee","criteria","sort","objCriteria","othCriteria","ordersLength","compareAscending","compareMultiple","baseSortBy","basePickBy","baseSet","basePullAll","basePullAt","indexes","previous","baseUnset","baseRepeat","baseRest","start","setToString","overRest","baseSample","baseSampleSize","nested","baseSetData","baseSetToString","constant","baseShuffle","baseSlice","end","baseSome","baseSortedIndex","retHighest","low","high","mid","baseSortedIndexBy","valIsNaN","valIsNull","valIsSymbol","valIsUndefined","othIsDefined","othIsNull","othIsReflexive","othIsSymbol","setLow","baseSortedUniq","baseToNumber","baseToString","baseUniq","createSet","seenIndex","baseUpdate","updater","baseWhile","isDrop","baseWrapperValue","actions","action","baseXor","baseZipObject","assignFunc","valsLength","castArrayLikeObject","castFunction","stringToPath","castRest","castSlice","copy","arrayBuffer","typedArray","valIsDefined","valIsReflexive","composeArgs","partials","holders","isCurried","argsIndex","argsLength","holdersLength","leftIndex","leftLength","rangeLength","isUncurried","composeArgsRight","holdersIndex","rightIndex","rightLength","isNew","createAggregator","initializer","createAssigner","assigner","sources","guard","isIterateeCall","iterable","createCaseFirst","methodName","trailing","createCompounder","callback","words","deburr","createCtor","arguments","thisBinding","createFind","findIndexFunc","createFlow","flatRest","funcs","prereq","thru","wrapper","getFuncName","funcName","getData","isLaziable","plant","createHybrid","partialsRight","holdersRight","argPos","ary","arity","isAry","isBind","isBindKey","isFlip","getHolder","holdersCount","countHolders","newHolders","createRecurry","arrLength","oldArray","reorder","createInverter","toIteratee","baseInverter","createMathOperation","operator","defaultValue","createOver","arrayFunc","createPadding","chars","charsLength","createRange","step","toFinite","baseRange","createRelationalOperation","toNumber","wrapFunc","isCurry","newData","setData","setWrapToString","createRound","precision","toInteger","pair","noop","createToPairs","baseToPairs","createWrap","srcBitmask","newBitmask","isCombo","mergeData","createCurry","createPartial","createBind","customDefaultsAssignIn","customDefaultsMerge","customOmitClone","arrStacked","arrValue","flatten","otherFunc","type","getValue","stubArray","hasPath","hasFunc","isLength","ArrayBuffer","resolve","ctorString","isMaskable","stubFalse","otherArgs","shortOut","reference","details","insertWrapDetails","updateWrapDetails","getWrapDetails","count","lastCalled","stamp","remaining","rand","memoize","charCodeAt","quote","subString","clone","difference","differenceBy","differenceWith","findLastIndex","head","intersection","mapped","intersectionBy","intersectionWith","pull","pullAll","pullAt","union","unionBy","unionWith","unzip","group","unzipWith","without","xor","xorBy","xorWith","zip","zipWith","chain","interceptor","wrapperAt","countBy","find","findLast","forEachRight","groupBy","invokeMap","keyBy","partition","sortBy","before","bind","bindKey","WRAP_BIND_FLAG","debounce","options","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","leading","maxing","invokeFunc","time","shouldInvoke","timeSinceLastCall","timerExpired","trailingEdge","timeWaiting","remainingWait","debounced","isInvoking","leadingEdge","cancel","flush","defer","delay","resolver","memoized","Cache","negate","overArgs","transforms","funcsLength","partial","partialRight","rearg","gt","gte","isError","isInteger","isNumber","isString","lt","lte","toArray","next","done","iteratorToArray","remainder","toLength","isBinary","assign","assignIn","assignInWith","assignWith","at","propsIndex","propsLength","defaultsDeep","mergeWith","invert","invertBy","invoke","nativeKeysIn","isProto","baseKeysIn","merge","omit","CLONE_DEEP_FLAG","basePick","pickBy","prop","toPairs","toPairsIn","camelCase","word","capitalize","upperFirst","kebabCase","lowerCase","lowerFirst","snakeCase","startCase","upperCase","toUpperCase","pattern","hasUnicodeWord","unicodeWords","asciiWords","attempt","bindAll","methodNames","flow","flowRight","method","methodOf","mixin","over","overEvery","overSome","basePropertyDeep","range","rangeRight","augend","addend","divide","dividend","divisor","multiply","multiplier","multiplicand","round","subtract","minuend","subtrahend","after","castArray","chunk","compact","concat","cond","conforms","baseConforms","properties","curry","curryRight","drop","dropRight","dropRightWhile","dropWhile","fill","baseFill","flatMap","flatMapDeep","flatMapDepth","flattenDeep","flattenDepth","flip","fromPairs","functions","functionsIn","initial","mapKeys","mapValues","matches","matchesProperty","nthArg","omitBy","once","orderBy","propertyOf","pullAllBy","pullAllWith","reject","remove","rest","sampleSize","setWith","shuffle","sortedUniq","sortedUniqBy","separator","limit","spread","tail","take","takeRight","takeRightWhile","takeWhile","tap","toPath","isArrLike","unary","uniq","uniqBy","uniqWith","unset","update","updateWith","valuesIn","wrap","zipObject","zipObjectDeep","entriesIn","extend","extendWith","clamp","cloneDeep","cloneDeepWith","cloneWith","conformsTo","defaultTo","endsWith","target","position","escape","escapeRegExp","findKey","findLastKey","forIn","forInRight","forOwn","forOwnRight","inRange","baseInRange","isBoolean","isElement","isEmpty","isEqual","isEqualWith","isMatch","isMatchWith","isNaN","isNative","isNil","isNull","isSafeInteger","isUndefined","isWeakMap","isWeakSet","lastIndexOf","strictLastIndexOf","maxBy","mean","meanBy","minBy","stubObject","stubString","stubTrue","nth","noConflict","pad","strLength","padEnd","padStart","radix","floating","temp","reduce","reduceRight","repeat","sample","sortedIndex","sortedIndexBy","sortedIndexOf","sortedLastIndex","sortedLastIndexBy","sortedLastIndexOf","sum","sumBy","template","settings","isEscaping","isEvaluating","imports","importsKeys","importsValues","interpolate","reDelimiters","evaluate","sourceURL","escapeValue","interpolateValue","esTemplateValue","evaluateValue","variable","times","toLower","toSafeInteger","toUpper","trim","trimEnd","trimStart","truncate","omission","search","substring","newEnd","unescape","uniqueId","prefix","each","eachRight","first","VERSION","isFilter","takeName","dropName","checkIteratee","isTaker","lodashFunc","retUnwrapped","isLazy","useLazy","isHybrid","isUnwrapped","onlyLazy","chainName","dir","isRight","view","getView","iterLength","takeCount","iterIndex","commit","wrapped","toJSON","Portal","containerSelector","className","children","elementRef","useRef","document","createElement","useLayoutEffect","container","querySelector","element","classList","appendChild","TeactDOM","render","removeChild","SPOILER_CHARS","TRUNCATED_SUMMARY_LENGTH","getMessageSummaryText","lang","statefulContent","noEmoji","truncateLength","isExtended","emoji","getMessageSummaryEmoji","getMessageSummaryDescription","trimText","getMessageTextWithSpoilers","transcription","getMessageTranscription","textWithoutTranscription","getMessageText","text","entities","content","accText","ApiMessageEntityTypes","Spoiler","spoiler","generateBrailleSpoiler","substr","photo","video","audio","voice","sticker","pollId","paidMedia","groupedId","getMediaContentTypeDescription","getSummaryDescription","truncatedText","mediaContent","contact","invoice","location","game","storyData","giveaway","giveawayResults","poll","summary","hasUsedTruncatedText","boughtExtendedMedia","isBought","extendedMedia","previewExtendedMedia","isPaidMediaAlbum","isPaidMediaSingleVideo","duration","isPaidMediaSinglePhoto","isGif","title","performer","getMessageAudioCaption","fileName","renderTextWithEntities","question","asPreview","description","mediaType","winnersCount","CONTENT_NOT_SUPPORTED","promptInstall","setupBeforeInstallPrompt","async","prompt","userChoice","outcome","getActions","setInstallPrompt","canInstall","getPromptInstall","translateWithYou","isYou","variables","pluralValue","asText","isMarkdown","withNodes","getPinnedMediaValue","getMessageContent","isRound","renderPeerLink","renderText","React","Link","buildClassName","styles","peerLink","strong","onClick","stopPropagation","openChat","withMultilineFix","IS_SAFARI","renderMessageLink","targetMessage","messageLink","focusMessage","chatId","messageId","getCallMessageKey","isOutgoing","isMissed","isCancelled","isVideo","WORKER_NAME","WorkerGlobalScope","globalThis","ACCOUNT_SLOT","Number","URLSearchParams","ACCOUNT_QUERY","IS_MULTIACCOUNT_SUPPORTED","url","slot","URL","searchParams","slotNumber","getAccountSlot","href","DATA_BROADCAST_CHANNEL_NAME","DATA_BROADCAST_CHANNEL_PREFIX","ESTABLISH_BROADCAST_CHANNEL_NAME","ESTABLISH_BROADCAST_CHANNEL_PREFIX","MULTITAB_STORAGE_KEY","MULTITAB_LOCALSTORAGE_KEY_PREFIX","GLOBAL_STATE_CACHE_KEY","GLOBAL_STATE_CACHE_PREFIX","getAccountsInfo","accountInfo","i","MULTIACCOUNT_MAX_SLOTS","info","getAccountInfo","sessionData","loadSlotSession","userId","avatarUri","color","emojiStatusId","firstName","lastName","isPremium","isTest","phone","JSON","parse","localStorage","getItem","SESSION_ACCOUNT_PREFIX","dcId","storeAccountData","currentSlotData","updatedSharedData","writeSlotSession","setItem","stringify","getAccountSlotUrl","forLogin","delete","hash","versionChannel","BroadcastChannel","postMessage","version","APP_VERSION","event","semverCompare","reload","a","b","localeCompare","numeric","sensitivity","caseFirst","DEFAULT_SIZE","memo","play","noLoop","noTransition","nonInteractive","onLoad","otherProps","isAnimationLoaded","markAnimationLoaded","useFlag","transitionClassNames","useMediaTransitionDeprecated","handleLoad","useLastCallback","playKey","setPlayKey","useState","handleClick","AnimatedSticker","_extends","SIMPLE_MARKDOWN_REGEX","part","filters","params","textParts","divEl","innerText","innerHTML","escapeHtml","EMOJI_REGEX","replaceEmojis","addLineBreaks","highlight","queryPosition","newParts","addLinks","replaceSimpleMarkdown","markdownPostProcessor","IS_EMOJI_SUPPORTED","parts","fixNonStandardEmoji","emojis","emojiResult","code","nativeToUnifiedExtendedWithCache","src","IS_PACKAGED_ELECTRON","BASE_URL","isLoaded","LOADED_EMOJIS","alt","draggable","handleEmojiLoad","splittenParts","line","trimmedLine","trimLeft","indentLength","fromCharCode","RE_LINK","RE_LINK_TEMPLATE","RE_MENTION_TEMPLATE","allowOnlyTgLinks","links","nextLink","shift","MentionLink","username","isDeepLink","SafeLink","postProcessor","postProcess","entityResult","entity","areLinesWrapping","lines","lineHeight","getComputedStyle","lineHeightParsed","clientHeight","onUpdateConnectionState","connectionState","getGlobal","tabState","isMasterTab","multitabNextAction","payload","clearMultitabNextAction","setGlobal","isSynced","channelStackIds","byTabId","tab","messageLists","messageList","chat","chats","isChatChannel","isChatSuperGroup","unique","requestChannelDifference","signOut","forceInitApi","addActionHandler","oldSetLanguage","selectSharedSettings","language","onUpdateApiReady","wasAuthReady","authState","authorizationState","authIsLoading","forceWebsync","isLoggingOut","authIsCodeViaApp","isCodeViaApp","authHint","hint","noReset","hasWebAuthTokenPasswordRequired","authIsLoadingQrCode","authQrCode","qrCode","updateTabState","isInactive","onUpdateAuthorizationState","authErrorKey","errorKey","onUpdateAuthorizationError","clearWebTokenAuth","hasWebAuthTokenFailed","onUpdateWebAuthTokenFailed","authRememberMe","mainDcId","config","isTestServer","saveSession","onUpdateSession","setServerTimeOffset","serverTimeOffset","onUpdateServerTimeOffset","setChataiStoreBuilderCurrentUserId","currentUser","currentUserFullInfo","updateUser","currentUserId","updateUserFullInfo","updateSessionUserId","onUpdateCurrentUser","initApi","sync","isFetchingDifference","isFetching","paymentShippingError","getShippingError","addPaymentError","shouldClosePaymentModal","closePaymentModal","showDialog","showNotification","getDeviceToken","subscription","endpoint","checkIfPushSupported","IS_SERVICE_WORKER_SUPPORTED","IS_ELECTRON","ServiceWorkerRegistration","Notification","permission","warn","checkIfNotificationsSupported","expirationTime","soundPlayedDelay","soundPlayedIds","notificationSound","Audio","playNotifySound","volume","notificationSoundVolume","selectSettingsKeys","currentVolume","setAttribute","playNotifySoundDebounced","requestPermission","unsubscribeFromPush","deleteDeviceToken","deviceToken","callApi","unsubscribe","log","serviceWorkerRegistration","navigator","serviceWorker","ready","pushManager","getSubscription","isSubscriptionFailed","checkIfOfflinePushFailed","subscribe","setDeviceToken","updateWebNotificationSettings","hasWebNotifications","hasPushNotifications","subscribedAt","checkIfShouldResubscribe","userVisibleOnly","DOMException","ABORT_ERR","NOT_SUPPORTED_ERR","getAvatar","imageHash","getChatAvatarHash","mediaData","mediaLoader","ApiMediaFormat","BlobUrl","notifyAboutCall","user","hasFocus","icon","body","getUserFullName","badge","vibrate","notification","oldTranslate","onclick","close","focus","notifyAboutMessage","isReaction","isChatMuted","getIsChatMuted","selectNotifyDefaults","selectNotifyException","topic","selectTopicFromMessage","topicMutedUntil","notifySettings","mutedUntil","isMuted","getServerTime","shouldIgnoreMute","isMentioned","shouldNotifyAboutMessage","isNotJoined","isListed","selectIsChatWithSelf","IS_TOUCH_ENV","selectCurrentMessageList","checkIfShouldNotify","isChatSilent","getIsChatSilent","isSilent","hasSound","areNotificationsSupported","activeReaction","getMessageRecentReaction","reaction","customEmojis","customEmoji","documentId","buildCollectionByKey","loadCustomEmoji","senderId","hasReaction","isScreenLocked","passcode","messageSenderChat","selectChat","messageSenderUser","selectUser","isSelf","getPrivateChatUserId","getShouldShowMessagePreview","isChat","senderName","getMessageSenderName","jsxToHtml","MessageSummary","textContent","emoticon","getReactionEmoji","APP_NAME","getChatTitle","getNotificationContent","controller","shouldReplaceHistory","dispatch","onshow","closeMessageNotifications","IS_TEST","notifyClientReady","useSignalEffect","effect","dependencies","isFirstRun","dependency","isSignal","useUnmountCleanup","cleanupEffect","useIntersectionObserver","rootRef","throttleMs","throttleScheduler","debounceMs","shouldSkipFirst","margin","threshold","isDisabled","rootCallback","controllerRef","rootCallbackRef","freezeFlagsRef","onUnfreezeRef","freeze","unfreeze","useHeavyAnimation","useEffect","observer","disconnect","destroy","observe","targetCallback","callbacks","entriesAccumulator","observerCallback","observerCallbackSync","from","callbackManager","runCallbacks","IntersectionObserver","rootMargin","addCallback","createCallbackManager","removeCallback","hasCallbacks","initController","unobserve","useOnIntersect","targetRef","lastCallback","useIsIntersecting","isIntersecting","setIsIntersecting","arePropsShallowEqual","currentProps","newProps","currentKeys","currentKeysLength","logUnequalProps","msg","debugKey","jsx","fragment","AUTO_END_TIMEOUT","counter","counterBlocking","getIsAnimating","setIsAnimating","createSignal","getIsBlockingAnimating","setIsBlockingAnimating","getIsHeavyAnimating","beginHeavyAnimation","isBlocking","timeout","onEnd","hasEnded","onFullyIdle","cb","onIdle","requestMeasure","throttleWithFullyIdle","chatBot","isSystemBot","selectBot","isRestricted","isChatGroup","intelligentReplyTask","addNewMessage","urgentCheckTask","HEALTH_CHECK_TIMEOUT","HEALTH_CHECK_MIN_DELAY","NO_QUEUE_BEFORE_INIT","worker","requestStates","requestStatesByCallback","pendingPayloads","savedLocalDb","users","documents","stickerSets","photos","webDocuments","commonBoxState","channelPtsById","subscribeToMasterChange","isMasterTabNew","channel","postMessagesOnTickEnd","throttleWithTickEnd","payloads","postMessageOnTickEnd","initApiOnMasterTab","initialArgs","token","updateCallback","localApiRequestsQueue","apiRequestsQueue","isInited","onUpdate","Worker","DEBUG_startAt","performance","updates","sendToAIAgent","handleMethodResponse","handleMethodCallback","IGNORE_UNHANDLED_ERRORS","sendBeacon","logDebugMessage","level","subscribeToWorker","platform","ensureWorkerPing","makeRequest","then","request","fnName","deferred","catch","callApiLocal","updateLocalDb","updateFullLocalDb","callApiOnMasterTab","setShouldEnableDebugLog","isEnabled","Deferred","promise","generateUniqueId","requestState","withCallback","finally","makeRequestToMaster","cancelApiProgress","progressCallback","isCanceled","cancelApiProgressMaster","hasMessageText","eventEmitter","emit","Actions","NewTextMessage","ChatAIMessageQuene","date","messageContent","chatType","isUserId","messageEmbeddingStore","addText","timestamp","toISOString","response","callbackArgs","DEBUG_payload","startedAt","isResolved","race","pause","terminate","STAR_PATH","GoldStarIcon","randomId","mask1Id","mask2Id","gradient1Id","gradient2Id","gradient3Id","svg","width","height","viewBox","style","maskUnits","x","y","d","mask","x1","y1","x2","y2","gradientUnits","PremiumStarIcon","RegularStarIcon","StarIcon","validSvgRandomId","useUniqueId","clickable","renderIcon","IntelligentReplyTask","_defineProperty","initTask","timmer","clearInterval","setInterval","intelligentResponse","getTextWithoutEntities","sortedRanges","pendingMessages","item","vectorSearchResults","knowledgeEmbeddingStore","similaritySearch","query","similarItems","score","threadId","replyInfo","replyToMsgId","replyToPeerId","saveReplyDraft","draft","isLocalOnly","sendMessage","metadata","answer","clearDraft","sendGAEvent","clearPendingMessages","getPendingMessages","getInstance","instance","resolved","NON_BUBBLEABLE_EVENTS","documentEventCounters","delegationRegistryByEventType","delegatedEventTypesByElement","propName","handler","asCapture","eventType","resolveEventType","canUseEventDelegation","handleEvent","resolveDelegationRegistry","existing","newSet","resolveDelegatedEventTypes","addDelegatedListener","removeEventListener","removeDelegatedListener","tagName","realEventType","removeAllDelegatedListeners","eventTypes","realEvent","events","furtherCallsPrevented","Proxy","p","Reflect","parentNode","documentListenersCount","delegatedHandlersCount1","acc","delegationRegistriesCount","delegatedHandlersCount2","delegationRegistry","delegationElementsCount","delegatedEventTypesCount","useKeyboardListNavigation","isOpen","onSelectWithEnter","itemSelector","noCaptureFocus","focusedIndex","setFocusedIndex","requestMutation","tabIndex","keyCode","focusedElement","activeElement","elementChildren","querySelectorAll","newIndex","prevGlobal","updatePageTitle","updateShouldDebugExportedSenders","updateShouldEnableDebugLog","oldGlobal","oldSharedSettings","sharedSettings","prevPerformance","peerColors","prevPeerColors","updatePeerColors","general","applyPerformanceSettings","theme","withAnimation","selectCanAnimateInterface","switchTheme","timeFormat","setTimeFormat","messageTextSize","documentElement","setProperty","IS_IOS","canDisplayChatInTitle","shouldForceHttpTransport","shouldAllowHttpTransport","updateSharedSettings","shouldDebugExportedSenders","shouldCollectDebugLogs","initDebugConsole","disableDebugConsole","replaceSettings","updateThemeSettings","screen","foldersAction","nextSettingsScreen","nextFoldersAction","folderId","isOnlyInvites","chatFolder","selectChatFolder","requestNextSettingsScreen","SettingsScreens","FoldersEditFolderInvites","FoldersEditFolderFromChatList","noRequestNextScreen","isChatList","FoldersShare","shareFolderScreen","isFromSettings","openEditChatFolder","MIN_USERNAME_LENGTH","MIN_UPDATE_USERNAME_LENGTH","MAX_USERNAME_LENGTH","USERNAME_REGEX","isUsernameValid","isUpdating","minUsernameLength","captureEscKeyListener","captureKeyboardListener","onEsc","typed","typify","withGlobal","formatInteger","formatIntegerCompact","views","formatPercent","fractionDigits","toFixed","getFirstLetters","withCache","phrase","FILE_SIZE_UNITS","formatFileSize","bytes","decimals","ESTABLISH_TIMEOUT","addCallbackTokenDied","runCallbacksTokenDied","collectedTokens","isEstablished","initialEstablishment","masterToken","reestablishToken","isWaitingForMaster","handleMessage","currentPasscodeHash","setPasscodeHash","hasGaveUpMaster","shouldGiveUpMaster","getPasscodeHash","tokenDied","prevLength","l","establishMultitabRole","shouldReestablishMasterToSelf","reestablishMasterToSelf","signalTokenDead","signalPasscodeHash","getAllMultitabTokens","subscribeToTokenDied","initialEstablishmentPromise","idRef","DEFAULT_CHAT_LISTS","replaceChatListIds","newIds","listIds","replaceChatListLoadingParameters","nextOffsetId","nextOffsetPeerId","nextOffsetDate","loadingParameters","updateChatLastMessageId","lastMessageId","listType","lastMessageIds","updateChatsLastMessageId","messageIds","addChatListIds","idsUpdate","replaceChats","newById","addUnreadMentions","ids","shouldUpdateCount","prevChatUnreadMentions","unreadMentions","updatedUnreadMentions","updateChat","unreadMentionsCount","removeUnreadMentions","removedCount","chatUpdate","noOmitUnreadReactionCount","withDeepCheck","updateKeys","areDeepEqual","updatedChat","getUpdatedChat","updateChatFullInfo","fullInfoUpdate","currentFullInfo","selectChatFullInfo","updatedFullInfo","fullInfoById","replaceChatFullInfo","fullInfo","updateChats","updatedById","addChats","isUpdated","addedById","existingChat","newChat","membersCountChanged","membersCount","isMin","accessHash","omitProps","usernames","omitUndefined","updateChatListType","ARCHIVED_FOLDER_ID","currentListIds","listTypeKey","currentFolderList","updateChatListSecondaryInfo","totalCountKey","orderedPinnedIds","totalCount","totalChatCount","leaveChat","leftChatId","removeChatFromChatLists","joinInfo","addChatMembers","membersToAdd","currentMembers","members","newMemberIds","m","updatedMembers","currentIds","updatedIds","areSortedArraysEqual","adminMembers","isAdmin","isOwner","adminMembersById","replaceSimilarChannels","similarChannelIds","similarChannelsById","toggleSimilarChannels","similarChannels","isExpanded","addSimilarBots","similarBotsIds","similarBotsById","selection","getSelection","rangeCount","ranges","getRangeAt","blur","removeAllRanges","addRange","useDebouncedCallback","ms","noLast","formatCurrency","totalPrice","currency","price","getCurrencyExp","STARS_CURRENCY_CODE","formatStarsAsIcon","asFont","asFontIcon","iconClassName","formatCurrencyAsString","locale","shouldOmitFractions","Intl","NumberFormat","minimumFractionDigits","maximumFractionDigits","format","DETECT_UP_TO","MAX_LENGTH","parseEmojiOnlyString","textWithoutNewlines","countIfEmojiOnly","matchAll","currentIndex","WEEKDAYS_FULL","MONTHS_FULL_LOWERCASE","month","MIN_SEARCH_YEAR","MAX_DAY_IN_MONTH","MAX_MONTH_IN_YEAR","MILLISECONDS_IN_DAY","isToday","getDayStartAt","getDayStart","datetime","setHours","getTime","toYearMonth","getFullYear","getMonth","toIsoString","getDate","formatTime","hours","getHours","marker","getMinutes","formatPastTimeShort","alwaysShowTime","today","weekAgo","setDate","weekday","getDay","noYear","formattedDate","formatDateToString","formatFullDate","formatMonthAndYear","isShort","formatCountdown","secondsLeft","days","getDays","formatMediaDuration","formatCountdownShort","msLeft","formatLocationLastUpdate","currentTime","lastUpdated","seconds","formatRelativePastTime","lastUpdatedDate","yesterday","formatPastDatetime","pastTime","minutes","formatTimeDuration","showLast","durationRecords","labels","t","label","idx","modulus","out","formatHumanDate","noWeekdays","isUpperFirst","limitBefore","limitAhead","formatWeekday","day","weekDay","formatMediaDateTime","maxValue","maxHours","maxMinutes","formatVoiceRecordDuration","durationInMs","milliseconds","formatDayToStringWithCache","dayStartAt","monthFormat","noDay","toLocaleString","year","formatDateTimeToString","noSeconds","hour","minute","second","hourCycle","formatDateAtTime","formatShortDuration","isValidDate","parseDateString","matchStringDate","matchEuropeStringDate","matchNumberDate","dateParts","monthIndex","timestampPlusDay","str","formatRegistrationMonth","dateString","DateTimeFormat","ref","useStateRef","updateStickerSearch","resultIds","stickerSearch","updateStickerSets","category","sets","updatedSets","stickerSet","stickers","setsById","regularSetIds","setIds","updateCustomEmojiSets","flat","addedSetIds","added","updateStickerSet","stickerSetId","currentStickerSet","isCustomEmoji","isEmoji","addedSets","installedDate","isArchived","customEmojiById","updateGifSearch","results","nextOffset","currentResults","gifSearch","newResults","gif","replaceAnimatedEmojis","animatedEmojis","updateStickersForEmoji","remoteStickers","allStickers","selectStickersForEmoji","uniqueIds","forEmoji","updateCustomEmojiForEmoji","localStickers","selectCustomEmojiForEmoji","updateRecentStatusCustomEmojis","statusRecent","rebuildStickersForEmoji","replaceUsers","updateContactList","updatedUsers","userIds","contactUserIds","contactList","contactUserIdsFromUpdate","isContact","userUpdate","updatedUser","getUpdatedUser","updateUsers","addUsers","existingUser","newUser","deleteContact","MEMO_EMPTY_ARRAY","updateUserSearch","searchStatePartial","userSearch","updateUserSearchFetchingStatus","newState","fetchingStatus","updateUserBlockedState","isBlocked","replaceUserStatuses","statusesById","userFullInfo","updateUserCommonChats","commonChats","commonChatsById","addUserStatuses","closeNewContactDialog","newContact","updateMissingInvitedUsers","missingUsers","inviteViaLinkModal","updateBotAppPermissions","botId","permissions","botAppPermissionsById","replacePeerSavedGifts","gifts","savedGifts","giftsByPeerId","updateGlobalSearch","globalSearch","updateGlobalSearchContent","currentContent","updateGlobalSearchResults","newFoundMessages","nextOffsetRate","resultsByType","newFoundMessagesById","getSearchResultKey","foundIdsForType","foundIds","newId","updateGlobalSearchFetchingStatus","messages","prevFoundIds","newFoundIds","foundOrPrevFoundIds","updateManagementProgress","progress","management","updateManagement","byChatId","newSettings","byKey","sharedState","updateSharedState","themes","addNotifyExceptions","notifyExceptionById","replaceNotifyExceptions","addNotifyException","notifyException","updateNotifyDefaults","peerType","notifyDefaults","addBlockedUser","contactId","blocked","removeBlockedUser","updateTwoFaSettings","twoFaSettings","updatePasscodeSettings","clearPasscodeSettings","clearGlobalForLockScreen","withTabState","INITIAL_GLOBAL_STATE","clearSharedStateForLockScreen","INITIAL_TAB_STATE","shouldUseSystemTheme","animationLevel","INITIAL_SHARED_STATE","updatePayment","payment","updateStarsPayment","starPayment","selectStarsPayment","starsPayment","updateShippingOptions","shippingOptions","setRequestInfoId","requestId","setPaymentStep","setStripeCardInfo","cardInfo","stripeCredentials","setSmartGlocalCardInfo","smartGlocalCredentials","setConfirmPaymentUrl","confirmPaymentUrl","setReceipt","receipt","clearPayment","clearStarPayment","closeInvoice","isPaymentModalOpen","isExtendedMedia","updateStarsBalance","balance","stars","appendStarsTransactions","transactions","history","newTypeObject","appendStarsSubscriptions","subscriptions","newObject","list","updateStarsSubscriptionLoading","isLoading","openStarsTransactionModal","transaction","starsTransactionModal","openStarsTransactionFromReceipt","transactionId","amount","totalAmount","nanos","updateStatistics","statistics","updateMessageStatistics","currentMessage","currentStory","updateStoryStatistics","updateStatisticsGraph","updateChannelMonetizationStatistics","monetization","updateVerifyMonetizationModal","monetizationVerificationModal","updatePeer","peerUpdate","updatePeerFullInfo","peerFullInfoUpdate","updatePeerPhotosIsLoading","profilePhotos","selectPeerPhotos","replacePeerPhotos","peers","profilePhotosById","updatePeerPhotos","newPhotos","shouldInvalidateCache","currentPhotos","profilePhoto","fallbackPhoto","personalPhoto","unshift","currentPhotoArray","uniqueByField","deletePeerPhoto","photoId","isFromActionMessage","isChannel","selectUserFullInfo","chatFullInfo","isAvatar","avatarPhotoId","nextAvatarPhoto","newProfilePhoto","addStories","newStoriesByPeerId","updatedByPeerId","newPeerStories","profileIds","lastUpdatedAt","updateOrderedStoriesPeerIds","addStoriesForPeer","newStories","newPinnedIds","addToArchive","archiveIds","deletedIds","updatedOrderedIds","updatedArchiveIds","updatedProfileIds","expireDate","appConfig","storyChangelogUserId","updatePeerLastUpdatedAt","updatePeerStoriesFullyLoaded","isFullyLoaded","updateLastReadStoryForPeer","hasUnreadStories","updateLastViewedStoryForPeer","lastViewedId","lastViewedByPeerIds","updatePeersWithStories","storiesByPeerId","hasStories","maxStoryId","updateStoryViews","viewModal","newViews","updateStoryViewsLoading","removePeerStory","newOrderedIds","newProfileIds","lastStoryId","previousStoryId","newLastReadId","isDeleted","updateStoriesForPeer","updateSentStoryReaction","reactionsCount","reactions","r","chosenOrder","updateReactionCount","newReactionsCount","updatePeerStory","sentReaction","storyUpdate","updatePeerStoryViews","viewsUpdate","updatePeerProfileStory","updatePeerStoriesHidden","areHidden","updatePeerIds","newOrderedPeerIds","compare","peerIdA","peerIdB","peerA","peerB","diffCurrentUser","compareFields","luaA","orderedA","lriA","hasUnreadA","luaB","orderedB","lriB","hasUnreadB","diffUnread","diffPremium","updateStealthMode","stealthMode","updateTopicsStore","topicsInfoById","updateListedTopicIds","topicIds","listedIds","selectTopicsInfo","listedTopicIds","updateTopics","topicsCount","topics","oldTopics","selectTopics","newTopics","topicsById","updateThread","firstMessageId","updateThreadInfo","updateTopic","topicId","selectTopic","updatedTopic","deleteTopic","replacePinnedTopicIds","pinnedTopicIds","orderedPinnedTopicIds","deselectCurrent","clipboardToIE11Formatting","debug","reselectPrevious","mark","success","ariaHidden","all","top","clip","whiteSpace","webkitUserSelect","MozUserSelect","msUserSelect","userSelect","clipboardData","clearData","onCopy","selectNodeContents","execCommand","copyKey","userAgent","removeRange","renderId","tgsUrl","playSegment","speed","quality","isLowPriority","forceAlways","forceOnHeavyAnimation","sharedCanvas","sharedCanvasCoords","onEnded","onLoop","containerRef","viewId","animation","setAnimation","animationRef","isFirstRender","shouldUseColorFilter","colorFilter","useColorFilter","playRef","playSegmentRef","rgbColor","shouldForceOnHeavyAnimation","canInitialize","markCanInitialize","unmarkCanInitialize","useSyncEffect","hexToRgb","isUnmountedRef","init","offsetWidth","offsetHeight","newAnimation","getRLottie","coords","setSpeed","ensureRLottie","throttledInit","useSharedIntersectionObserver","setColor","removeView","playAnimation","shouldRestart","isFrozen","playAnimationOnRaf","pauseAnimation","isPlaying","useEffectWithPrevDeps","prevNoLoop","setNoLoop","prevSharedCanvasCoords","setSharedCanvasCoords","changeData","usePriorityPlaybackCheck","useBackgroundMode","buildStyle","isPriorityPlaybackActive","isBackgroundModeActive","Icon","role","ariaLabel","character","Blockquote","canBeCollapsible","isToggleDisabled","isCollapsed","isCollapsible","setIsCollapsed","useCollapsibleLines","canExpand","handleExpand","handleToggle","PRETTY_BY_ALIAS","js","javascript","ts","typescript","python","py","go","rust","c","cpp","fortran","f90","f","java","sql","swift","kotlin","ruby","rb","php","perl","bash","sh","markdown","cs","json","yaml","yml","solidity","sol","tl","CodeOverlay","noCopy","onWordWrapToggle","windowSize","useWindowSize","useOldLang","isWordWrap","setIsWordWrap","withWordWrapButton","setWithWordWrapButton","checkWordWrap","isWrap","parentElement","handleCopy","copyTextToClipboard","handleWordWrapClick","contentClass","overlayClass","wrapClass","CodeBlock","setWordWrap","highlighted","useAsync","lib","default","handleWordWrapToggle","blockClass","PeerColorWrapper","codeLanguage","Pre","revealByContainerId","createClassNameBuilder","containerId","contentRef","isRevealed","revealSpoiler","stopEvent","reveal","HQ_EMOJI_THRESHOLD","emojiSize","shouldRenderAsHtml","isProtected","observeIntersectionForLoading","observeIntersectionForPlaying","withTranslucentThumbs","sharedCanvasRef","sharedCanvasHqRef","cacheBuster","forcePlayback","noCustomEmojiPlayback","isInSelectMode","maxTimestamp","renderMessagePart","deleteLineBreakAfterPre","organizedEntities","organizedEntityIndexes","organizedEntity","organizeEntity","organizedIndexes","organizedIndex","organizeEntities","renderEntity","textPartStart","textPartEnd","isLastEntity","renderResult","nestedEntities","textBefore","textBeforeLength","entityStartIndex","entityEndIndex","entityContent","nestedEntityContent","nestedIndex","nestedEntity","nestedEntityIndex","nestedResult","nestedEntityEndIndex","newEntity","rawEntityText","renderedContent","Bold","Italic","Underline","Code","Strike","MentionName","Url","TextUrl","getLinkUrl","CustomEmoji","buildCustomEmojiHtmlFromEntity","processEntityAsHtml","entityText","renderNestedMessagePart","isSelectable","withSharedAnimation","withTranslucentThumb","noPlay","canCollapse","BotCommand","handleBotCommandClick","Hashtag","handleHashtagClick","Cashtag","handleCodeClick","Email","rel","Mention","Phone","Timestamp","openMediaFromTimestamp","handleTimecodeClick","QuoteFocus","processEntity","textAfter","arrayIndex","getTextWithEntitiesAsHtml","formattedText","focusedQuote","insertTextEntity","resultEntities","newEntityStart","newEntityEnd","existingEntity","existingEntityStart","existingEntityEnd","parsedEntity","isChanged","sendBotCommand","command","currentTarget","hashtag","openChatByUsername","onChatChanged","searchHashtag","selectPollFromMessage","translatedText","inChatList","extractedText","extractMessageText","hasPoll","getMessagePollId","isAction","isActionMessage","groupStatefulContent","summaryText","trimmedText","Fragment","ActionMessageText","MessageText","messageOrStory","resolverOrSignal","isAsync","valueRef","forceUpdate","useForceUpdate","resolverRef","runCurrentResolver","isSync","currentResolver","fnCache","cacheKey","cached","selectCurrentChat","selectChatMessages","selectChatScheduledMessages","scheduledMessages","selectTabThreadParam","tabThreads","selectThreadParam","selectThread","messageInfo","threadsById","selectListedIds","selectOutlyingListByMessageId","outlyingLists","selectOutlyingLists","selectCurrentMessageIds","messageListType","selectViewportIds","selectPinnedIds","selectScheduledIds","selectScrollOffset","selectLastScrollOffset","selectEditingId","selectEditingDraft","selectEditingScheduledId","MAIN_THREAD_ID","selectEditingScheduledDraft","selectDraft","selectNoWebPage","selectThreadInfo","selectFirstMessageId","selectReplyStack","selectThreadMessagesCount","threadInfo","messagesCount","isForum","GENERAL_TOPIC_ID","selectThreadByMessage","selectThreadIdFromMessage","selectIsMessageInCurrentMessageList","currentMessageList","selectIsViewportNewest","viewportIds","isSavedDialog","getIsSavedDialog","selectChatLastMessageId","isLocalMessageId","selectChatMessage","chatMessages","selectScheduledMessage","selectQuickReplyMessage","quickReplies","messagesById","selectEditingMessage","selectFocusedMessageId","focusedChatId","focusedMessage","selectIsMessageFocused","currentThreadId","focusedId","previousLocalId","selectIsMessageUnread","lastReadOutboxMessageId","isMessageLocal","selectOutgoingStatus","isScheduledList","getSendingState","selectSender","areProfilesShown","getSendersFromSelectedMessages","selectSenderFromMessage","selectSenderFromHeader","header","fromId","selectForwardedSender","forwardInfo","isChannelPost","fromChatId","hiddenUserName","savedFromPeerId","selectPoll","pollById","MAX_MESSAGES_TO_DELETE_OWNER_TOPIC","selectCanDeleteTopic","isCreator","getHasAdminRight","thread","selectCanDeleteOwnerTopic","selectSavedDialogIdFromMessage","savedPeerId","ANONYMOUS_USER_ID","savedDialogId","replyToTopId","isForumTopic","getMessageReplyInfo","isChatBasicGroup","selectCanReplyToMessage","isForbidden","isLocal","isServiceNotification","isServiceNotificationMessage","isMessageThread","isCommentsInfo","fromChannelId","getCanPostInChat","messageTopic","isClosed","selectCanForwardMessage","hasTtl","hasMessageTtl","webPage","isChatProtected","selectIsChatProtected","isStoryForwardForbidden","noForwards","isForwardingAllowed","selectAllowedMessageActionsSlow","isChatWithSelf","isBasicGroup","isSuperGroup","isBotChat","isFailed","isMessageFailed","isOwnMessage","isForwarded","isForwardedMessage","isDocumentSticker","isMessageDocumentSticker","isBoostMessage","hasChatPinPermission","isUserRightBanned","hasPinPermission","isMessageEditable","editTimeLimit","viaBotId","canReply","canReplyGlobally","canPin","canUnpin","pinnedMessageIds","canNotDeleteBoostMessage","canDelete","canReport","canDeleteForAll","hasMessageEditRight","canEdit","hasSticker","hasFavoriteSticker","selectIsStickerFavorite","canFaveSticker","canUnfaveSticker","canCopy","canCopyLink","canSelect","canDownload","canSaveGif","canRevote","closed","quiz","isChosen","canClosePoll","noOptions","ability","selectCanDeleteSelectedMessages","selectedMessageIds","selectedMessages","messageIdList","API_GENERAL_ID_LIMIT","messageActions","selectCanDeleteMessages","selectCanReportSelectedMessages","selectCanDownloadSelectedMessages","selectActiveDownloads","activeDownloads","selectUploadProgress","fileUploads","byMessageKey","getMessageKey","selectRealLastReadId","lastReadInboxMessageId","unreadCount","selectFirstUnreadId","lastReadServiceNotificationId","SERVICE_NOTIFICATIONS_USER_ID","serviceNotifications","findAfterLastReadId","isFromScheduled","found","selectIsForwardModalOpen","isShareMessageModalShown","selectCommonBoxChatId","fromLastMessage","isCommonBoxChat","selectIsInSelectMode","selectIsMessageSelected","selectForwardedMessageIdsByGroupId","fromMessageId","selectMessageIdsByGroupId","selectIsDocumentGroupSelected","selectedIds","groupIds","selectSelectedMessagesCount","selectNewestMessageWithBotKeyboardButtons","keyboardButtons","shouldHideKeyboardButtons","isKeyboardSelective","replyToMessageId","replyMessage","selectShouldDisplayReplyKeyboard","replyHideMessageId","isHideKeyboardSelective","selectShouldHideReplyKeyboard","selectCanAutoLoadMedia","sender","isPhoto","getMessagePhoto","getMessageWebPagePhoto","getMessageVideo","getMessageWebPageVideo","isFile","getMessageAudio","getMessageVoice","getMessageDocument","canAutoLoadPhotoFromContacts","canAutoLoadPhotoInPrivateChats","canAutoLoadPhotoInGroups","canAutoLoadPhotoInChannels","canAutoLoadVideoFromContacts","canAutoLoadVideoInPrivateChats","canAutoLoadVideoInGroups","canAutoLoadVideoInChannels","canAutoLoadFileFromContacts","canAutoLoadFileInPrivateChats","canAutoLoadFileInGroups","canAutoLoadFileInChannels","canAutoLoadMedia","canAutoLoadMediaFromContacts","canAutoLoadMediaInPrivateChats","canAutoLoadMediaInGroups","canAutoLoadMediaInChannels","isMediaFromContact","selectLastServiceNotification","maxId","selectIsMessageProtected","getMessagePaidMedia","selectHasProtectedMessage","selectCanForwardMessages","selectSponsoredMessage","sponsoredByChatId","expiresAt","selectDefaultReaction","defaultReaction","chatReactions","enabledReactions","canSendReaction","selectMaxUserReactions","selectIsCurrentUserPremium","maxUserReactionsPremium","maxUserReactionsDefault","selectVisibleUsers","selectShouldSchedule","selectCanScheduleUntilOnline","paidMessagesStars","selectPeerPaidMessagesStars","selectUserStatus","wasOnline","selectMessageCustomEmojiSets","selectCustomEmojis","doc","stickerSetInfo","shortName","selectForwardsContainVoiceMessages","forwardMessages","selectChatTranslations","translations","selectMessageTranslations","toLanguageCode","byLangCode","selectRequestedMessageTranslationLanguage","requestedInChat","requestedTranslations","toLanguage","manualMessages","selectReplyCanBeSentToChat","toChatId","fromRealChatId","isExpiredMessage","selectForwardsCanBeSentToChat","getAllowedAttachmentOptions","isVoice","isRoundVideo","isAudio","isDocument","isSticker","isPlainText","canSendVoices","canSendRoundVideos","canSendStickers","canSendDocuments","canSendAudios","canSendVideos","canSendPhotos","canSendGifs","canSendPlainText","сheckMessageSendingDenied","selectTopicLink","getMessageLink","selectMessageReplyInfo","additionalReplyInfo","isMainThread","selectReplyMessage","selectMessageTimestampableDuration","noReplies","timestampableMedia","getTimestampableMedia","replyTimestampableMedia","selectMessageLastPlaybackTimestamp","playbackByChatId","SEARCH_ENGINE_REGEX","PERMANENT_VERSION_KEY","CLIENT_VERSION","setPermanentWebVersion","switchPermanentWebVersion","clearWebsync","skipLockOnUnload","WEB_VERSION_BASE","checkAndAssignPermanentWebVersion","hostname","PRODUCTION_HOSTNAME","referrer","host","currentVersion","getPermanentWebVersion","hasTest","shouldRedirect","Checkbox","labelText","subLabel","checked","disabled","withIcon","blocking","permissionGroup","rightIcon","onlyInput","nestedCheckbox","nestedCheckboxCount","nestedOptionList","leftElement","onChange","onCheck","onClickLabel","labelRef","showNested","setShowNested","handleChange","toggleNested","labelClassName","isRtl","Button","Spinner","nestedOptions","nestedOption","currentInstance","animateSingle","tick","schedulerFn","cancelSingleAnimation","dumbCb","animate","animateInstantly","timingFunctions","linear","easeIn","easeOut","easeInOut","sin","PI","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","animateNumber","timing","to","t0","t1","applyStyles","css","selectUserCommonChats","selectIsUserBlocked","selectIsCurrentUserFrozen","freezeUntilDate","selectIsPremiumPurchaseBlocked","isPremiumPurchaseBlocked","selectIsGiveawayGiftsPurchaseAvailable","isGiveawayGiftsPurchaseAvailable","selectUserByPhoneNumber","phoneNumber","phoneNumberCleaned","isUserBot","selectBotAppPermissions","getBotCoverMediaHash","convertToApiChatType","getWebAppKey","webApp","requestUrl","appName","REPLIES_USER_ID","VERIFICATION_CODES_USER_ID","INITIAL_PERFORMANCE_STATE_MAX","animatedEmoji","autoplayGifs","autoplayVideos","contextMenuAnimations","contextMenuBlur","loopAnimatedStickers","mediaViewerAnimations","messageComposerAnimations","messageSendingAnimations","pageTransitions","reactionEffects","rightColumnAnimations","stickerEffects","storyRibbonAnimations","snapEffect","INITIAL_PERFORMANCE_STATE_MID","INITIAL_PERFORMANCE_STATE_MIN","IOS_DEFAULT_MESSAGE_TEXT_SIZE_PX","IS_MAC_OS","MACOS_DEFAULT_MESSAGE_TEXT_SIZE_PX","DEFAULT_MESSAGE_TEXT_SIZE_PX","ANIMATION_LEVEL_DEFAULT","messageSendKeyCombo","shouldSkipWebAppCloseConfirmation","wasTimeFormatSetManually","isConnectionStatusMinimized","shouldWarnAboutSvg","isInitial","cacheVersion","attachMenu","bots","isAppUpdateAvailable","isElectronUpdateAvailable","shouldShowContextMenuHint","audioPlayer","lastPlaybackRate","DEFAULT_PLAYBACK_RATE","mediaViewer","countryList","phoneCodes","previewMediaByBotId","saved","hasNext","hasNextInArchive","groupCalls","attachmentSettings","shouldCompress","shouldSendGrouped","isInvertedMedia","webPageMediaSize","chatFolders","invites","recentEmojis","recentCustomEmojis","defaultTags","topReactions","recentReactions","effectReactions","availableEffectById","recent","favorite","greeting","premium","featured","lastRendered","emojiKeywords","gifs","topPeers","topInlineBots","topBotApps","activeSessions","byHash","orderedHashes","activeWebSessions","autoLoadFileMaxSizeMb","shouldSuggestStickers","shouldSuggestCustomEmoji","shouldPaidMessageAutoApprove","shouldUpdateStickerSetOrder","shouldArchiveAndMuteNewNonContact","shouldNewNonContactPeersRequirePremium","disallowedGifts","nonContactPeersPaidStars","shouldHideReadMarks","canTranslate","canTranslateChats","doNotTranslate","privacy","botVerificationShownPeerIds","light","isBlurred","patternColor","DEFAULT_PATTERN_COLOR","dark","DARK_THEME_PATTERN_COLOR","trustedBotIds","transcriptions","archiveSettings","isMinimized","isHidden","isLeftColumnShown","isChatInfoShown","newChatMembersProgress","NewChatMembersProgress","Closed","uiReadyState","shouldInit","activeChatFolder","inlineBots","byUsername","webApps","openedWebApps","openedOrderedKeys","sessionKeys","modalState","isModalOpen","isMoreAppsTabActive","middleSearch","byChatThreadKey","sharedMediaSearch","chatMediaSearch","DEFAULT_GIFT_PROFILE_FILTER_OPTIONS","isRibbonShown","DEFAULT_VOLUME","playbackRate","isWebAppsCloseConfirmationModalOpen","replyingMessage","pollResults","notifications","dialogs","activeReactions","pollModal","isPaymentMessageConfirmDialogOpen","DB_NAME","keyPath","autoIncrement","knowledge","summaryTemplate","urgentTopic","folder","aIChatFolders","initDB","indexedDB","open","onupgradeneeded","db","STORE_CONFIG","storeName","objectStoreNames","contains","store","createObjectStore","indexName","createIndex","onsuccess","onerror","getDB","dbManager","chataiStoreManager","getAllSummaryTemplate","objectStore","getAll","getSummaryTemplate","deleteSummaryTemplate","addSummaryTemplate","put","getAllAIChatFolders","getAIChatFolder","deleteAIChatFolder","addAIChatFolder","aiChatFolder","getContact","addContact","getAllFolders","getFolder","deleteFolder","addFolder","getKnowledge","getAllKnowledge","addKnowledge","deleteKnowledge","getAllUrgentTopic","getUrgentTopic","deleteUrgentTopic","addUrgentTopic","addUrgentTopics","urgentTopics","oncomplete","getUser","addUser","dbVersion","GLOBAL_SUMMARY_LAST_TIME","GLOBAL_SUMMARY_READ_TIME","GLOBAL_AICHATFOLDERS_LAST_TIME","GLOBAL_AICHATFOLDERS_TIP_SHOW","GLOBAL_PRESET_TAG","GLOBAL_AI_TAG","ChataiStores","_currentUserId","ChataiStoreManager","SummaryStore","MessageStore","ContactStore","UsersStore","GeneralStore","KnowledgeStore","SummaryTemplateStore","UrgentTopicStore","FolderStore","AIChatFoldersStore","ChatAIStoreReady","downloadAllSummarys","getAllMessages","res","blob","Blob","link","createObjectURL","download","click","revokeObjectURL","ChataiMessageStore","initChataiStores","GLOBAL_SUMMARY_CHATID","isSerena","selectPeerFullInfo","selectChatListLoadingParameters","selectIsChatWithBot","selectChatUser","selectSupportChat","isSupport","selectChatOnlineCount","MEMBERS_LOAD_SLICE","onlineCount","isUserOnline","selectIsTrustedBot","selectChatType","selectIsChatBotNotStarted","lastMessage","selectChatLastMessage","isHistoryClearMessage","selectAreActiveChatsLoaded","selectIsChatListed","targetList","selectChatListType","selectIsChatPinned","ALL_FOLDER_ID","SAVED_FOLDER_ID","chatFoldersById","pinnedChatIds","selectChatByUsername","usernameLowered","selectIsServiceChatReady","selectSendAs","sendAsId","selectRequestedDraft","requestedDraft","files","selectRequestedDraftFiles","filterChatIdsByType","chatIds","selectCanInviteToChat","migratedTo","isJoinRequest","selectCanShareFolder","groups","channels","contacts","nonContacts","includedChatIds","excludeArchived","excludeMuted","excludeRead","excludedChatIds","selectShouldDetectChatLanguage","isSavedMessages","IS_TRANSLATION_SUPPORTED","selectCanTranslateChat","selectRequestedChatTranslationLanguage","isLanguageDetectable","detectedLanguage","selectSimilarChannelIds","selectSimilarBotsIds","realChatId","MINUTE","HOUR","DAY","roundDown","getSeconds","useLayoutEffectWithPrevDeps","prevDepsRef","prevDeps","CLOSE_DURATION","useShowTransition","noMountTransition","noOpenTransition","noCloseTransition","closeDuration","shouldForceOpen","onCloseAnimationEnd","localRef","closingTimeoutRef","getState","setState","useSignal","optionsRef","onCloseEndLast","useSyncEffectWithPrevDeps","prevIsOpen","applyClassNames","addExtraClass","state","shouldRender","hasOpenClass","isClosing","toggleExtraClass","withShouldRender","useDerivedState","getIsClosing","useDerivedSignal","performanceType","toggle","SIGNAL_MARK","obj","unsubscribesByEffect","currentEffect","effects","unsubscribes","unsub","parseMessage2SummaryStoreMessage","copyedMessages","createdAt","parseSummaryStoreMessage2Message","storeMessage","storeMessages","getMessages","lastTime","pageSize","IDBKeyRange","bound","openCursor","newLastTime","cursor","continue","hasMore","delMessage","DropdownMenu","trigger","bubbleClassName","transformOriginX","transformOriginY","positionX","positionY","footer","forceOpen","onOpen","onClose","onTransitionEnd","onMouseEnterBackdrop","onHide","autoClose","menuRef","setIsOpen","handleClose","triggerComponent","onTrigger","isMenuOpen","onKeyDown","menu","toggleIsOpen","Menu","BACKDROP_CLASSNAME","useVirtualBackdrop","ignoreRightClick","excludedClosestSelector","button","hasActiveViewTransition","closest","useThumbnail","media","thumbDataUri","getMessageMediaThumbDataUri","dataUri","selectTheme","uri","value1","value2","type1","isArray1","array1","array2","member1","object1","object2","keys1","key1","EMOJI_EXCEPTIONS","regex","replacement","isCharIcon","customIcon","destructive","withWrap","onContextMenu","clickArg","withPreventDefaultOnMouseDown","isTouchScreen","useAppLayout","handleKeyDown","handleMouseDown","fullClassName","origin","onMouseDown","buildChatThreadKey","LUMA_THRESHOLD","scaleImage","image","ratio","outputType","img","Image","onload","scale","resizeImage","steppedScale","bitmap","createImageBitmap","resizeWidth","resizeHeight","resizeQuality","averageColor","getAverageColor","fillColor","getColorLuma","canvas","ctx2D","getContext","fillStyle","fillRect","ctx","transferFromImageBitmap","drawImage","toBlob","oc","octx","mul","cur","globalCompositeOperation","randomUUID","crypto","getRandomValues","rnds8","byteToHex","buf","rnds","rng","RangeError","arr","unsafeStringify","AI_CHATFOLDERS_INTERVAL_TIME","AIChatFoldersTask","classifyChatMessageByCount","runAIChatFolders","batchAiChatFolders","AI_CHATFOLDERS_LOG_PRE","saveAiChatFolders","groupedRes","groupAiChatFoldersRes","updateChatFolder","sortedKeys","addChatFolder","editChatFolder","deleteAiChatFolders","folderTitle","desc","existDb","globalFolders","existFolder","o","exist","folderUpdate","sleep","sortChatFolder","AI_CHATFOLDERS_LIST","folderIds","PRESET_FOLDER_ID","AI_FOLDER_ID","UNREAD_FOLDER_ID","sortChatFolders","aiChatFolders","getOrderedIds","isChatBot","chatLastMessageId","roomMsgs","fetchChatMessageByCount","offsetId","addOffset","sliceSize","maxCount","aiChatFoldersTask","ANIMATION_END_DELAY","waitForTransitionEnd","node","propertyName","fallbackMs","waitForEndEvent","waitForAnimationEnd","animationName","detailedName","isHandled","cleanup","handleAnimationEnd","TransitionEvent","AnimationEvent","PATH_BASE","pathname","historyUniqueSessionId","historyState","historyCursor","isAlteringHistory","deferredHistoryOperations","deferredPopstateOperations","isSafariGestureAnimation","handleTouchEnd","applyDeferredHistoryOperations","goOperations","op","stateOperations","goCount","delta","processStateOperations","deferHistoryOperation","historyOperation","resetHistory","onBack","back","replaceState","cleanupClosed","alreadyClosedCount","countClosed","cleanupTrashedState","isAnimationDisabled","disableHistoryAnimations","useHistoryBack","isActive","shouldBeReplaced","shouldResetUrlHash","lastOnBack","indexRef","wasReplaced","pushState","forceReplace","shouldReplace","previousRecord","markReplaced","processBack","useEffectOnce","prevIsActive","TEST_getHistoryState","TEST_getHistoryCursor","touches","pageX","innerWidth","previousUniqueSessionId","updateAppBadge","setAppBadge","getStoryReplyInfo","bio","about","profileEdit","ProfileEditProgress","InProgress","shouldUsernameUpdate","u","isEditable","Complete","loadFullUser","withPhotos","isFallback","Idle","checkedUsername","isUsernameAvailable","loadedWallpapers","wallpapers","file","previewBlobUrl","slug","UPLOADING_WALLPAPER_SLUG","mimeType","wallpaper","firstWallpaper","withLocalMedia","blockedIds","isOnlyStories","signUpNotification","hasContactJoinedNotifications","shouldShowPreviews","MAX_INT_32","oldSettings","languages","phoneNumberSettings","addByPhoneSettings","lastSeenSettings","profilePhotoSettings","forwardsSettings","chatInviteSettings","phoneCallSettings","phoneP2PSettings","voiceMessagesSettings","bioSettings","birthdaySettings","giftsSettings","noPaidMessagesSettings","rules","addByPhone","lastSeen","forwards","chatInvite","phoneCall","phoneP2P","voiceMessages","birthday","noPaidMessages","privacyKey","visibility","onSuccess","buildApiInputPrivacyRules","allowedIds","allowUserIds","allowChatIds","blockUserIds","blockChatIds","botsPrivacy","isAllowList","isPremiumAllowed","isUnspecified","shouldAllowPremium","isSensitiveEnabled","langCode","authNearestCountry","COUNTRIES_WITH_12H_TIME_FORMAT","setSharedSettingOption","nearestCountryCode","requestActionTimeout","APP_CONFIG_REFETCH_INTERVAL","isAppConfigLoaded","generalHash","colors","timezones","globalSettings","shouldDisplayGiftsButton","shouldUpdateUsersSettings","loadFullChat","loadUser","prevUsernames","sortedUsernames","currentUsername","getChatNotifySettings","getNotificationPeerType","DEFINITION_MAP","defs","addSvgDefinition","htmlElement","createElementNS","SVG_NAMESPACE","appendElement","removeSvgDefinition","selectManagement","selectCurrentManagementType","selectCanManage","canAddContact","getCanAddContact","isBot","isAnonymousForwardsChat","isChatAdmin","selectStatistics","selectIsMediaViewerOpen","isAvatarView","standaloneMedia","isSponsoredMessage","selectRightColumnContentKey","isMobile","editTopicPanel","RightColumnContent","EditTopic","createTopicPanel","CreateTopic","PollResults","currentManagement","selectCurrentManagement","Management","isStatisticsShown","currentMessageId","MessageStatistics","StoryStatistics","currentChatId","canViewStatistics","selectIsStatisticsShown","Statistics","boostStatistics","BoostStatistics","monetizationStatistics","MonetizationStatistics","StickerSearch","GifSearch","AddingMembers","isChatAIShown","ChatAI","ChatInfo","selectIsRightColumnShown","selectThemeValues","themeKey","selectIsForumPanelOpen","forumPanelChatId","selectIsForumPanelClosed","selectIsReactionPickerOpen","reactionPicker","selectPerformanceSettings","selectPerformanceSettingsValue","selectCanAutoPlayMedia","canAutoPlayVideos","canAutoPlayGifs","asGif","selectShouldLoopStickers","selectCanPlayAnimatedEmojis","selectIsContextMenuTranslucent","selectIsSynced","selectCanAnimateSnapEffect","IS_SNAP_EFFECT_SUPPORTED","selectWebApp","selectActiveWebApp","activeWebAppKey","selectCurrentGlobalSearchQuery","selectPaymentInputInvoice","inputInvoice","selectPaymentRequestId","selectProviderPublishableKey","form","nativeParams","publishableKey","selectProviderPublicToken","publicToken","selectStripeCredentials","selectSmartGlocalCredentials","selectCanUseGiftProfileAdminFilter","selectCanUseGiftProfileFilter","selectGiftProfileFilter","selectLanguageCode","selectCanSetPasscode","accounts","selectTranslationLanguage","translationLanguage","selectNewNoncontactPeersRequirePremium","selectNonContactPeersPaidStars","selectShouldHideReadMarks","MONTH_EMOTICON","STAR_EMOTICON","selectCurrentStickerSearch","selectCurrentGifSearch","selectStickerSet","stickersForEmoji","packs","cleanEmoji","isCurrentUserPremium","addedCustomSets","customEmojiForEmoji","isFree","selectCustomEmojiForEmojis","selectIsSetPremium","selectAnimatedEmoji","cleanedEmoji","selectRestrictedEmoji","restrictedEmoji","selectAnimatedEmojiEffect","animatedEmojiEffects","selectAnimatedEmojiSound","emojiSounds","selectIsAlwaysHighPriorityEmoji","defaultEmojiStatusesStickerSetId","RESTRICTED_EMOJI_SET_ID","selectGiftStickerForDuration","premiumGifts","selectGiftStickerForStars","starCount","selectSharedState","setTrigger","APP_CODE_NAME","RELEASE_DATETIME","PRODUCTION_URL","IS_MOCKED_CLIENT","IS_BETA","PAID_MESSAGES_PURPOSE","DEBUG_MORE","DEBUG_LOG_FILENAME","STRICTERDOM_ENABLED","BOT_VERIFICATION_PEERS_LIMIT","BETA_CHANGELOG_URL","ELECTRON_HOST_URL","PAGE_TITLE","INACTIVE_MARKER","DEBUG_PAYMENT_SMART_GLOCAL","SESSION_LEGACY_USER_KEY","LEGACY_PASSCODE_CACHE_NAME","GLOBAL_STATE_CACHE_DISABLED","SHARED_STATE_CACHE_KEY","GLOBAL_STATE_CACHE_USER_LIST_LIMIT","GLOBAL_STATE_CACHE_CHAT_LIST_LIMIT","GLOBAL_STATE_CACHE_ARCHIVED_CHAT_LIST_LIMIT","GLOBAL_STATE_CACHE_CUSTOM_EMOJI_LIMIT","IS_SCREEN_LOCKED_CACHE_KEY","MEDIA_CACHE_DISABLED","MEDIA_CACHE_NAME","MEDIA_CACHE_NAME_AVATARS","MEDIA_PROGRESSIVE_CACHE_NAME","CUSTOM_BG_CACHE_NAME","LANG_CACHE_NAME","AUTODOWNLOAD_FILESIZE_MB_LIMITS","DC_IDS","isBigScreen","innerHeight","MIN_PASSWORD_LENGTH","MESSAGE_LIST_SLICE","MESSAGE_LIST_VIEWPORT_LIMIT","ARCHIVE_MINIMIZED_HEIGHT","CHAT_HEIGHT_PX","TOPIC_HEIGHT_PX","PEER_PICKER_ITEM_HEIGHT_PX","CHAT_LIST_SLICE","CHAT_LIST_LOAD_SLICE","SHARED_MEDIA_SLICE","CHAT_MEDIA_SLICE","MESSAGE_SEARCH_SLICE","GLOBAL_SEARCH_SLICE","GLOBAL_TOPIC_SEARCH_SLICE","MEMBERS_SLICE","PROFILE_SENSITIVE_AREA","TOPIC_LIST_SENSITIVE_AREA","STATISTICS_PUBLIC_FORWARDS_LIMIT","STORY_VIEWS_MIN_SEARCH","STORY_MIN_REACTIONS_SORT","STORY_VIEWS_MIN_CONTACTS_FILTER","MEDIA_TIMESTAMP_SAVE_MINIMUM_DURATION","GLOBAL_SUGGESTED_CHANNELS_ID","TOPICS_SLICE","TOPICS_SLICE_SECOND_LOAD","TOP_CHAT_MESSAGES_PRELOAD_LIMIT","DEFAULT_CHARGE_FOR_MESSAGES","MINIMUM_CHARGE_FOR_MESSAGES","DEFAULT_MAXIMUM_CHARGE_FOR_MESSAGES","PLAYBACK_RATE_FOR_AUDIO_MIN_DURATION","ANIMATION_LEVEL_CUSTOM","ANIMATION_LEVEL_MIN","ANIMATION_LEVEL_MED","ANIMATION_LEVEL_MAX","PREVIEW_AVATAR_COUNT","DRAFT_DEBOUNCE","SEND_MESSAGE_ACTION_INTERVAL","GENERAL_REFETCH_INTERVAL","EDITABLE_INPUT_ID","EDITABLE_INPUT_MODAL_ID","EDITABLE_STORY_INPUT_ID","EDITABLE_INPUT_CSS_SELECTOR","EDITABLE_INPUT_MODAL_CSS_SELECTOR","EDITABLE_STORY_INPUT_CSS_SELECTOR","CUSTOM_APPENDIX_ATTRIBUTE","MESSAGE_CONTENT_CLASS_NAME","MESSAGE_CONTENT_SELECTOR","VIEW_TRANSITION_CLASS_NAME","RESIZE_HANDLE_CLASS_NAME","RESIZE_HANDLE_SELECTOR","SNAP_EFFECT_CONTAINER_ID","SNAP_EFFECT_ID","STARS_ICON_PLACEHOLDER","MIN_SCREEN_WIDTH_FOR_STATIC_RIGHT_COLUMN","MIN_SCREEN_WIDTH_FOR_STATIC_LEFT_COLUMN","MOBILE_SCREEN_MAX_WIDTH","MOBILE_SCREEN_LANDSCAPE_MAX_WIDTH","MOBILE_SCREEN_LANDSCAPE_MAX_HEIGHT","TMP_CHAT_ID","ANIMATION_WAVE_MIN_INTERVAL","MESSAGE_APPEARANCE_DELAY","SCROLL_MIN_DURATION","SCROLL_MAX_DURATION","SCROLL_MAX_DISTANCE","SCROLL_SHORT_TRANSITION_MAX_DISTANCE","LOCK_SCREEN_ANIMATION_DURATION_MS","STICKER_SIZE_INLINE_DESKTOP_FACTOR","STICKER_SIZE_INLINE_MOBILE_FACTOR","STICKER_SIZE_AUTH","STICKER_SIZE_AUTH_MOBILE","STICKER_SIZE_PICKER","EMOJI_SIZE_PICKER","COMPOSER_EMOJI_SIZE_PICKER","STICKER_SIZE_GENERAL_SETTINGS","STICKER_SIZE_PICKER_HEADER","STICKER_PICKER_MAX_SHARED_COVERS","STICKER_SIZE_SEARCH","STICKER_SIZE_MODAL","EMOJI_SIZE_MODAL","STICKER_SIZE_TWO_FA","STICKER_SIZE_PASSCODE","STICKER_SIZE_DISCUSSION_GROUPS","STICKER_SIZE_FOLDER_SETTINGS","STICKER_SIZE_INLINE_BOT_RESULT","STICKER_SIZE_JOIN_REQUESTS","STICKER_SIZE_INVITES","EMOJI_STATUS_LOOP_LIMIT","EMOJI_SIZES","TOP_SYMBOL_SET_ID","POPULAR_SYMBOL_SET_ID","RECENT_SYMBOL_SET_ID","COLLECTIBLE_STATUS_SET_ID","FAVORITE_SYMBOL_SET_ID","EFFECT_STICKERS_SET_ID","EFFECT_EMOJIS_SET_ID","CHAT_STICKER_SET_ID","DEFAULT_TOPIC_ICON_STICKER_ID","DEFAULT_STATUS_ICON_ID","EMOJI_IMG_REGEX","BASE_EMOJI_KEYWORD_LANG","MENU_TRANSITION_DURATION","SLIDE_TRANSITION_DURATION","BIRTHDAY_NUMBERS_SET","RESTRICTED_EMOJI_SET","GIF_MIME_TYPE","LOTTIE_STICKER_MIME_TYPE","VIDEO_STICKER_MIME_TYPE","SUPPORTED_PHOTO_CONTENT_TYPES","SUPPORTED_VIDEO_CONTENT_TYPES","SUPPORTED_AUDIO_CONTENT_TYPES","CONTENT_TYPES_WITH_PREVIEW","SUPPORTED_TRANSLATION_LANGUAGES","RE_TG_LINK","RE_TME_LINK","RE_TELEGRAM_LINK","TME_LINK_PREFIX","BOT_FATHER_USERNAME","USERNAME_PURCHASE_ERROR","MESSAGE_ID_REQUIRED_ERROR","PURCHASE_USERNAME","TME_WEB_DOMAINS","LANG_PACK","API_CHAT_TYPES","HEART_REACTION","CHANNEL_ID_LENGTH","MAX_MEDIA_FILES_FOR_ALBUM","MAX_ACTIVE_PINNED_CHATS","SCHEDULED_WHEN_ONLINE","LANG_PACKS","FEEDBACK_URL","FAQ_URL","PRIVACY_URL","MINI_APP_TOS_URL","FRESH_AUTH_PERIOD","GIVEAWAY_BOOST_PER_PREMIUM","GIVEAWAY_MAX_ADDITIONAL_CHANNELS","GIVEAWAY_MAX_ADDITIONAL_USERS","GIVEAWAY_MAX_ADDITIONAL_COUNTRIES","FRAGMENT_PHONE_CODE","FRAGMENT_PHONE_LENGTH","LIGHT_THEME_BG_COLOR","DARK_THEME_BG_COLOR","PEER_COLOR_BG_OPACITY","PEER_COLOR_BG_ACTIVE_OPACITY","PEER_COLOR_GRADIENT_STEP","MAX_UPLOAD_FILEPART_SIZE","MAX_UNIQUE_REACTIONS","GROUP_CALL_VOLUME_MULTIPLIER","GROUP_CALL_DEFAULT_VOLUME","DEFAULT_LIMITS","uploadMaxFileparts","stickersFaved","savedGifs","dialogFiltersChats","dialogFilters","dialogFolderPinned","captionLength","channelsPublic","aboutLength","chatlistInvites","chatlistJoined","recommendedChannels","savedDialogsPinned","moreAccounts","DEFAULT_MAX_MESSAGE_LENGTH","ONE_TIME_MEDIA_TTL_SECONDS","PREMIUM_FEATURE_SECTIONS","PREMIUM_BOTTOM_VIDEOS","PREMIUM_LIMITS_ORDER","sortType","shouldIncludeUnlimited","shouldIncludeLimited","shouldIncludeUnique","shouldIncludeDisplayed","shouldIncludeHidden","savedCallback","tabStatePartial","deepMerge","isLiteralObject","oldValue","__delete","reduceDiff","diff","__deleteAllChildren","startCallbacks","endCallbacks","dispatchPriorityPlaybackEvent","onStart","lastOnStart","lastOnEnd","getPeerColorClass","noUserColors","shouldReset","peerColorId","getPeerColorCount","getPeerColorKey","getApiPeerColorClass","cleanupRef","SVG_MAP","SvgColorFilter","filterId","xmlns","getFilterId","referenceCount","removeReference","isUsed","asValue","prepareStyle","setValue","SUMMARY_CHATS","URGENT_CHATS","shouldRunFirst","shouldRunLast","waitingTimeout","interval","isPending","_args","onTickEnd","waiting","rafPromise","fastRaf","FAST_RAF_TIMEOUT_FALLBACK_MS","fastRafCallbacks","fastRafFallbackCallbacks","fastRafFallbackTimeout","onTickEndCallbacks","withTimeoutFallback","requestAnimationFrame","currentCallbacks","currentTimeoutCallbacks","IDLE_TIMEOUT","onIdleCallbacks","beforeUnloadCallbacks","requestIdleCallback","deadline","timeRemaining","onBeforeUnload","isLast","DEBUG_currentRandomId","currentGlobal","DEBUG_invalidateGlobalOnTickEnd","actionHandlers","containers","mapStateToProps","ownProps","mappedProps","activateContainer","newMappedProps","DEBUG_componentName","DEBUG_updates","updateTime","runCallbacksThrottled","setUntypedGlobal","newGlobal","forceOutdated","DEBUG_randomId","forceSyncOnIOs","getUntypedGlobal","getUntypedActions","actionQueue","addUntypedActionHandler","handleAction","withUntypedGlobal","activationFn","Component","TeactNContainer","DEBUG_contentComponentName","DEBUG_resolveComponentName","stuckTo","stickTo","useMediaTransition","isMediaReady","createListener","matchMedia","devicePixelRatio","useDevicePixelRatio","dpr","setDpr","useLang","addLocalizationCallback","getTranslationFn","THROTTLE","initialWidth","initialHeight","setWidth","setHeight","isResizing","setIsResizing","setIsResizingDebounced","throttledSetIsResizing","throttledSetSize","newWidth","newHeight","handleResize","unloadVideo","removeAttribute","firstChild","load","ICON_POSITIONS","inline","block","opacity","EMOJI_SIZE","REM","EmojiIconBackground","emojiDocumentId","canvasRef","emojiImage","setEmojiImage","useCustomEmoji","previewMediaHash","getStickerMediaHash","previewUrl","useMedia","customColor","useDynamicColorListener","preloadAfterHeavyAnimation","useThrottleForHeavyAnimation","preloadImage","updateCanvas","clearRect","save","globalAlpha","translate","restore","tintColor","isLottie","updateCanvasAfterHeavyAnimation","updateCanvasSize","parentWidth","parentHeight","contentRect","useResizeObserver","getBoundingClientRect","InputText","readOnly","autoComplete","inputMode","teactExperimentControlled","onInput","onKeyPress","onBlur","onPaste","htmlFor","TOOLS_SCHEDULE_MEETING_ID","TOOLS_SEARCH_GROUP_ID","TOOLS_SEARCH_USER_ID","CLASSES","ACTIVE_SLIDE_CLASS_NAME","TO_SLIDE_CLASS_NAME","DISABLEABLE_ANIMATIONS","activeKey","nextKey","direction","renderCount","shouldRestoreHeight","shouldCleanup","cleanupExceptionKey","cleanupOnlyKey","shouldWrap","wrapExceptionKey","slideClassName","withSwipeControl","isBlockingAnimation","onStop","currentKeyRef","shouldDisableAnimation","rendersRef","prevActiveKey","isAnimatingRef","isSwipeJustCancelledRef","hasActiveKeyChanged","isBackwards","isSlideOptimized","prevActiveIndex","activeIndex","childNodes","childElements","el","childElement","setExtraStyles","transition","toSlide","fromSlide","HTMLElement","removeExtraClass","endHeavyAnimation","requestForcedReflow","forceReflow","performSlideOptimized","onAnimationEnd","watchedNode","giveUpAnimationEnd","allowSwipeControlForTransition","clientWidth","flexBasis","asFastList","renders","contents","rendered","teactOrderKey","teactFastList","getIsVideoPlaying","paused","ended","readyState","mediaEl","updateCacheThrottled","updateCache","updateCacheForced","unsubscribeFromBeforeUnload","isCaching","isRemovingCache","cacheGlobal","MAIN_IDB_STORE","cacheSharedState","loadCachedSharedState","removeGlobalFromCache","del","removeSharedStateFromCache","cacheIsScreenLocked","initCache","setupCaching","resetCache","removeItem","clearCaching","loadCache","initialState","cachedFromLocalStorage","timeEnd","migrateCache","readCache","hasPasscode","hasStoredSession","untypedCached","limits","darkPeerColors","miniAppsCachedPosition","miniAppsCachedSize","unsafeMigrateCache","force","forceUpdateCache","noEncrypt","serializedGlobal","serializeGlobal","encryptSession","reduceGlobal","availableReactions","lastIsChatInfoShown","getIsMobile","reduceCustomEmojis","reduceUsers","reduceChats","reduceMessages","reduceSettings","reduceChatFolders","reduceGroupCalls","idsToSave","currentChatIds","visibleUserIds","chatStoriesUserIds","attachBotIds","recentlyFoundChatIds","pickTruthy","messagesChatIds","replyPeer","forumPanelChatIds","chatIdsToSave","openedChatThreadIds","tabChatId","pollIdsToSave","openedThreadIds","commentThreadIds","originMessageId","threadIds","threadsToSave","viewportIdsToSave","lastViewportIds","topicLastMessageIds","savedLastMessageIds","lastMessageIdsToSave","typingStatus","cleanedById","cleanedMessage","blobUrl","isPreloadedGlobally","omitLocalMedia","localAmount","omitLocalPaidReactions","lastPremiumBandwithNotificationDate","activeGroupCallId","RippleEffect","ripples","setRipples","cleanUpDebounced","rippleSize","clientX","clientY","parseLine","separatorIndex","isEscaped","isInsideString","char","FALLBACK_LANG_CODE","FALLBACK_VERSION","FALLBACK_TRANSLATE_URL","LANGPACK_STORE_PREFIX","FORMATTERS_FALLBACK_LANG","TRANSLATION_CACHE","LimitedMap","formatters","langPack","fallbackLangPack","translationFn","createTranslationFn","areCallbacksScheduled","scheduleCallbacks","localizationReady","loadCachedLangData","cacheLangData","notifyLangpackUpdate","fallbackLoadPromise","loadFallbackPack","forLocalScript","fileData","readFileSync","rawStrings","readStrings","strings","clearKey","pluralSuffix","knownValue","stringsCount","nativeName","pluralCode","translatedCount","translationsUrl","readFallbackStrings","fallbackData","updateLanguage","fetchDifference","fromVersion","applyLangPackDifference","keysToRemove","newLangPack","updateLangPack","newLang","createFormatters","listFormatFallback","items","formatToParts","createListFormat","IS_INTL_LIST_FORMAT_SUPPORTED","ListFormat","pluralRules","PluralRules","region","DisplayNames","conjunction","disjunction","initLocalization","canLoadFromServer","cachedData","loadAndChangeLanguage","refreshFromCache","shouldCheckCache","changeLanguage","remoteLanguage","requestLangPackDifference","newLanguage","remoteLangPack","baseLangCode","areAdvancedLangFnOptions","processTranslationAdvanced","processTranslation","rawCode","with","withRegular","withAdvanced","of","internalFormatters","languageInfo","getString","langKey","langPackStringValue","initialStrings","isDeletedLangString","select","isPluralLangString","finalString","valueAsString","variableEntries","tempResult","specialReplacement","replaceInStringsWithTeact","withMarkdown","renderTextFilters","curr","preparedValue","localizationReadyPromise","num","isBetween","lerp","interpolationRatio","roundToNearestEven","currentWindowSize","updateSizes","handleOrientationChange","visualViewport","pageTop","vh","getIsKeyboardVisible","mediaQueryCache","isTablet","isLandscape","getIsTablet","getIsWebAppsFullscreenSupported","handleMediaQueryChange","isDesktop","mobileQuery","tabletQuery","landscapeQuery","isTouchScreenQuery","initMediaQueryCache","selectCanGift","bot","isDeletedUser","areStarGiftsAvailable","selectPeerSavedGifts","isChatWithUser","ELIGIBLE_HOSTNAMES","tryParseDeepLink","correctUrl","ensureProtocol","queryParams","getQueryParams","pathParams","getPathParams","len","boost","getHttpDeepLinkType","single","comment","buildPublicMessageLink","commentId","channelId","buildPrivateMessageLink","buildShareLink","buildChatFolderLink","buildLoginCodeLink","buildPublicUsernameOrBotLink","startApp","startapp","mode","startAttach","startattach","attach","choose","buildPrivateChannelLink","buildBusinessChatLink","buildChatBoostLink","isPrivateChannel","buildGiftUniqueLink","parseHttpLink","urlToParse","IS_BAD_URL_PARSER","domain","post","bot_id","scope","public_key","nonce","getTgDeepLinkType","publicKey","callbackUrl","buildTelegramPassportLink","callback_url","appname","buildPremiumReferrerLink","buildPremiumMultigiftLink","parseTgLink","parseDeepLink","getUsernameFromDeepLink","deepLink","isSingle","parseTimestampDuration","toChannelId","decodeURI","fromEntries","elementObserverMap","refOrElement","onIntersectionChange","onIntersectionChangeLast","offsetParent","LOAD_QUEUE","RENDER_HISTORY","loadFromQueue","queue","queueToLoad","otherQueue","LIMIT_PER_REQUEST","loadCustomEmojis","updateLastRendered","updateLastRenderedCustomEmojis","notifyCustomEmojiRender","emojiId","addCustomEmojiInputRenderCallback","setCustomEmoji","canPlay","setCanPlay","handleGlobalChange","addCustomEmojiCallback","removeCustomEmojiCallback","initialLocationHash","parseInitialLocationHash","hasTestParam","tgWebAuthTest","accountsInfo","accountIds","apiUpdate","PLATFORM_ENV","loadStoredSession","isWebmSupported","IS_WEBM_SUPPORTED","maxBufferSize","MAX_BUFFER_SIZE","webAuthToken","tgWebAuthToken","tgWebAuthDcId","mockScenario","isTestServerRequested","password","videoTs","ManagementProgress","storeSession","clearStoredSession","hangUp","leaveGroupCall","resetInitialLocationHash","resetLocationHash","reset","clearEncryptedSession","cacheApi","destroySharedStatePort","PASSCODE_IDB_STORE","langCachePrefix","langCacheVersion","initShared","otherTabId","sessionJson","globalJson","forgetPasscode","invalidAttemptsCount","timeoutUntil","formatStarsAsText","containerClassName","hex2rgb","param","rgb2hex","p0","p1","p2","rgb2hsb","h","v","hsb2rgb","q","defaultRGB","rgb","naturalHeight","naturalWidth","getImageData","blockSize","getPatternColor","hue","saturation","k","hsl2rgb","convertToRGBA","getTextColor","DEBUG_DURATION_LIMIT","initials","buildInitials","prepared","DEBUG_getFolderManager","updateFolderManagerThrottled","updateFolderManager","inited","updateFolders","orderedIdsByFolderId","getPinnedChatsCount","pinnedCountByFolderId","getChatsCount","chatsCountByFolderId","getUnreadCounters","unreadCountersByFolderId","getUnreadChatsByFolderId","unreadChatIdsByFolderId","getAllNotificationsCount","notificationsCount","getOrderKey","isForSaved","chatSummariesById","orderInSaved","orderInAll","addOrderedIdsCallback","addChatsCountCallback","addUnreadChatsByFolderIdCallback","addUnreadCountersCallback","DEBUG_startedAt","isAllFolderChanged","isMainFolderChanged","isArchivedFolderChanged","isSavedFolderChanged","isAllFullyLoadedChanged","isAllFolderFullyLoaded","isArchivedFullyLoadedChanged","isArchivedFolderFullyLoaded","isSavedFolderFullyLoadedChanged","isSavedFolderFullyLoaded","areFoldersChanged","foldersById","areChatsChanged","chatsById","areSavedLastMessageIdsChanged","lastSavedMessageIds","areAllLastMessageIdsChanged","lastAllMessageIds","areTopicsChanged","areUsersChanged","usersById","areNotifyDefaultsChanged","areNotifyExceptionsChanged","notifyExceptions","affectedFolderIds","emptyFolderIds","folderSummariesById","updateFullyLoaded","updateResults","prevAllFolderListIds","allFolderListIds","prevArchivedFolderListIds","archivedFolderListIds","prevSavedFolderListIds","savedFolderListIds","newChatsById","newUsersById","newAllLastMessageIds","newSavedLastMessageIds","newNotifyDefaults","newNotifyExceptions","folderSummaries","newAllFolderListIds","newArchivedFolderListIds","newSavedFolderListIds","newGeneralIds","allIds","newFolderIds","currentSummary","isRemovedFromAll","isRemovedFromSaved","newSummary","chatUnreadCount","chatUnreadMentionsCount","hasUnreadMark","userInfo","shouldHideServiceChat","creationDate","draftDate","lastMessageInSaved","isListedInAll","isListedInSaved","isUserContact","buildChatSummary","chatSummary","folderSummary","isChatInFolder","buildChatFolderIds","currentFolderIds","folderIdsByChatId","deletedFolderIds","currentFolderIdsSet","newFolderIdsSet","currentFolderOrderedIds","chatIdsByFolderId","isOrderedListJustPatched","updateListsForChat","newListIds","currentPinnedIds","allFolderPinnedIds","savedFolderPinnedIds","archivedFolderPinnedIds","changedFolders","buildFolderSummaryFromMainList","newFoldersById","buildFolderSummary","wasUnreadCountersChanged","wasChatsCountChanged","wasUnreadChatsChanged","pinnedCount","newPinnedCount","prevOrderedIds","isSavedFolder","sortedPinnedIds","allListIds","sortedNotPinnedIds","chatId1","chatId2","buildFolderOrderedIds","currentOrderedIds","currentPinnedCount","currentChatsCount","newChatsCount","currentUnreadCounters","newUnreadCounters","chatsCount","buildFolderUnreadCounters","currentUnreadChats","newUnreadChats","buildFolderByUnreadChats","newInitials","SAFE_EXEC_ENABLED","safeExec","rescue","always","shouldIgnoreError","SwipeDirection","IOS_SCREEN_EDGE_THRESHOLD","SWIPE_DIRECTION_THRESHOLD","SWIPE_DIRECTION_TOLERANCE","MOVE_THRESHOLD","SWIPE_THRESHOLD_DEFAULT","RELEASE_WHEEL_ZOOM_DELAY","RELEASE_WHEEL_DRAG_DELAY","getDistance","hypot","pageY","getTouchCenter","lastClickTime","lethargy","stability","tolerance","lastUpDeltas","lastDownDeltas","deltasTimestamp","check","lastDelta","originalEvent","wheelDelta","deltaY","detail","isInertia","lastDeltas","lastDeltasOld","lastDeltasNew","oldSum","newSum","oldAverage","newAverage","abs","IS_WINDOWS","captureEvents","captureEvent","hasMoved","hasSwiped","isZooming","initialDistance","wheelZoom","initialZoom","initialDragOffset","isDragCanceled","initialSwipeAxis","initialTouchCenter","minZoom","maxZoom","onCapture","includedClosestSelector","withNativeDrag","withCursor","onDrag","onMove","onRelease","passive","selectorToPreventScroll","scrollable","overflow","onDoubleClick","centerX","centerY","newWindowSize","onZoom","endDistance","touchCenter","dragOffsetX","dragOffsetY","zoomFactor","initialCenterX","initialCenterY","currentCenterX","currentCenterY","shouldPreventScroll","onSwipe","xAbs","yAbs","swipeThreshold","axis","currentSwipeAxis","offsets","Left","Right","Up","Down","processSwipe","releaseWheelDrag","releaseWheelZoom","onWheelCapture","onWheel","doubleTapZoom","is","deltaX","ctrlKey","metaKeyPressed","metaKey","shiftKey","zoom","onWheelZoom","isUserEvent","sign","dx","dy","onWheelDrag","withWheelDrag","isNotPassive","useShowTransitionDeprecated","onCloseTransitionEnd","noFirstOpenTransition","setIsClosed","closeTimeoutRef","hasOpenClassName","setHasOpenClassName","shouldHaveOpenClassName","hasShownClass","filterPresetTag","activePresetTag","allAiChatFolders","presetTag","filterAITag","activeAITag","AITag","getAITags","EXCLUDE_EMOJIS","ISO_FLAGS_OFFSET","unifiedToNative","unified","codePoints","fromCodePoint","dataset","nativeToUnified","removeVS16s","uncompressEmoji","emojiData","categories","j","emojiRaw","names","native","isoToEmoji","iso","codePointAt","keyToHandlerName","Enter","Backspace","Delete","Esc","Escape","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Tab","handlers","onEnter","onDelete","onBackspace","onUp","onDown","onLeft","onRight","onTab","captureKeyboardListeners","hasActiveHandlers","handlerName","currentEventHandlers","releaseKeyboardListener","keyHandlers","eventName","gtag","Loading","backgroundColor","preventMessageInputBlur","withBubbling","preventMessageInputBlurWithBubbling","processDeepLink","parsedLink","openPrivateChannel","parseChooseParameter","startParam","originalParts","resolveBusinessChatLink","openPremiumModal","openGiftRecipientPicker","processBoostParameters","usernameOrId","openUniqueGiftBySlug","protocol","checkChatInvite","openChatByPhoneNumber","openStickerSet","joinVoiceChatByLink","openInvoice","openChatWithDraft","checkChatlistInvite","openStoryViewerByUsername","checkGiftCode","openStarsBalanceModal","voicechat","livestream","inviteHash","invite","urlParam","formatShareText","purpose","balanceNeeded","topup","sharedWorker","synced","lastSharedState","initSharedState","localState","SharedWorker","port","onMessage","sendToWorker","onGlobalChange","deepDiff","updateGlobal","scheduledEvents","sendOnTickEnd","INERTIA_DURATION","INERTIA_EASING","swipeOffsets","cancelCurrentReleaseAnimation","isSwipeActive","captureControlledSwipe","onSwipeLeftStart","onSwipeRightStart","onCancel","currentSlide","nextSlide","onCancelForTransition","targetPosition","getAnimations","KeyframeEffect","keyframe","getKeyframes","extractPositionFromTransform","extractAnimationEndPosition","currentDirection","animationTimingFunction","initialPositionPx","distance","units","dragOffset","newProgress","updateAnimationProgress","onCancelForClient","isRevertSwipe","releaseProgress","elements","getTiming","transformRule","userOrChat","closeStoryViewer","setShouldCloseRightColumn","setIsLoading","setError","setResult","wasCancelled","parseSearchResultKey","GlobalSummaryBadge","updateRoomData","roomAIData","parsedData","currentData","UpdateRoomAIUnreadCount","getUnreadCount","increaseUnreadCount","WINDOW_RESIZE_LINE_RECALC_DEBOUNCE","maxLinesBeforeCollapse","cutoutRef","isFirstRenderRef","cutoutHeightRef","setIsCollapsible","maxHeight","recalculateTextLines","totalLines","calcTextLineHeightAndCount","debouncedRecalcTextLines","windowWidth","checkSessionLocked","slotData","legacyAuthJson","userAuth","dcID","newSlotData","storeLegacySession","loadStoredLegacySession","SAMPLE_RATE","BIT_DEPTH","oggToWav","opusData","Response","decoderWorker","wavWorker","onmessage","buffers","page","wavBitDepth","wavSampleRate","decoderSampleRate","outputBufferSampleRate","pages","asCacheApiType","Type","Text","DownloadUrl","Progressive","PROGRESSIVE_URL_PREFIX","DOWNLOAD_URL_PREFIX","MAX_MEDIA_RETRIES","memoryCache","fetchPromises","progressCallbacks","cancellableCallbacks","fetch","mediaFormat","isHtmlAllowed","onProgress","callbackUniqueId","IS_PROGRESSIVE_SUPPORTED","getProgressiveUrl","base","getDownloadUrl","fetchFromCacheOrRemote","activeCallbacks","getFromMemory","cancelProgress","parentCallback","retryNumber","cacheName","IS_OPUS_SUPPORTED","prepareMedia","makeOnProgress","remote","getRetryTimeout","dataBlob","fetchBlob","fullSize","INPUT_CUSTOM_EMOJI_SELECTOR","buildCustomEmojiHtml","isPlaceholder","getInputCustomEmojiParams","shouldUseTextColor","rawText","getCustomEmojiSize","maxEmojisInLine","langProvider","MULTITAB_ESTABLISH_TIMEOUT","resolveGlobalPromise","isFirstGlobalResolved","lastBroadcastDiffGlobal","isBroadcastDiffScheduled","subscribeToMultitabBroadcastChannel","appVersion","batchedUpdates","localDb","argsWithCallback","refreshLangPackFromCache","requestGlobal","resolveWithoutGlobal","extractCurrentThemeParams","getPropertyHexColor","secondaryTextColor","bgColor","textColor","buttonColor","buttonTextColor","linkColor","hintColor","secondaryBgColor","sectionSeparatorColor","bg_color","text_color","hint_color","link_color","button_color","button_text_color","secondary_bg_color","header_bg_color","accent_text_color","section_bg_color","section_header_text_color","subtitle_text_color","destructive_text_color","section_separator_color","validateHexColor","getPropertyValue","prepareHexColor","GlobalSummaryTask","unreadMessages","summaryChatIds","summaryChats","firstUnreadId","roomUnreadMsgs","fetchChatUnreadMessage","startSummary","executeTask","initSummaryChats","on","updateSummarySettings","globalSummaryLastTime","summaryMessageByDeadline","summaryAllUnreadMessages","customizationTemplate","updateSummaryDefineTemplate","updateSummaryChats","autoTranslateLanguage","summaryTime","toTimestamp","getAlignedExecutionTimestamp","chatName","summaryInfo","summaryStartTime","summaryEndTime","summaryMessageCount","headers","definePrompt","newMessage","uuidv4","annotations","AddSummaryMessage","fetchChatMessageByDeadline","mergeUnreadSummarys","lastReadTime","unreadSummaryCount","getSummaryChats","summaryChatsInitialized","globalSummaryTask","SUBSTITUTION_REGEX","PLURAL_OPTIONS","PLURAL_RULES","en","ar","be","n10","n100","ca","v0","de","es","fa","fi","fr","it","hr","i10","i100","f10","f100","hu","ko","nb","nl","pl","ru","sk","sr","tr","uk","uz","currentLangCode","currentTimeFormat","createLangFn","cacheValue","importFallbackLangPack","langString","preferredPluralOption","optionIndex","getPluralOption","otherValue","translationSlices","initialValue","processTemplate","withFallback","Json","sourceLangPacks","fetchRemote","langInfo","langName","instanceOfAny","constructors","idbProxyableTypes","cursorAdvanceMethods","transactionDoneMap","transformCache","reverseTransformCache","idbProxyTraps","receiver","IDBTransaction","replaceTraps","transformCachableValue","IDBCursor","advance","continuePrimaryKey","unwrap","tx","unlisten","complete","cacheDonePromiseForTransaction","IDBDatabase","IDBObjectStore","IDBIndex","IDBRequest","promisifyRequest","readMethods","writeMethods","cachedMethods","getMethod","targetFuncName","useIndex","isWrite","oldTraps","advanceMethodProps","methodMap","advanceResults","ittrProxiedCursorToOriginalProxy","cursorIteratorTraps","cachedFunc","iterate","proxiedCursor","isIteratorProp","asyncIterator","matchesCriteria","getObjectSizeInMB","VectorStorage","dbName","maxSizeInMB","debounceTime","openaiModel","embedTextsFn","embedTexts","openaiApiKey","openAIApiKey","loadFromIndexDbStorage","vector","vectorMag","addDocuments","updateText","updateDocument","deleteText","getText","addTexts","texts","metadatas","docs","filterOptions","includeValues","queryEmbedding","embedText","queryMagnitude","calculateMagnitude","filteredDocuments","include","exclude","filterDocuments","calculateSimilarityScores","updateHitCounters","removeDocsLRU","embedding","upgrade","terminated","openPromise","oldVersion","newVersion","openDB","documentStore","newDocuments","newVectors","calcVectorMagnitude","addToIndexDbStorage","model","Authorization","ok","status","sqrt","val","queryVector","dotProduct","magnitudeA","normalizeScore","hits","saveToIndexDbStorage","embeddings","vectorStoreMap","getVectorStore","toolsEmbeddingStore","INPUT_WAITING_CUSTOM_EMOJI_IDS","renderCallbacks","loaded","processMessageInputForCustomEmoji","checkInputCustomEmojiLoad","callInputRenderHandlers","getCustomEmojiMediaDataForInput","isPreview","mediaHash","getStickerHashById","fetchAndProcess","placeholderSrc","shouldUseStaticFallback","blankSrc","buildMessageKey","getMessageServerKey","msgId","parseMessageKey","blurCallbacks","focusCallbacks","isFocused","onFocus","lastOnBlur","lastOnFocus","DEBUG_LEVELS","ORIGINAL_FUNCTIONS","DEBUG_LOGS","getDebugLogs","FILTERED_ATTRIBUTES","HTML_ATTRIBUTES","CONTROLLABLE_TAGS","MAPPED_ATTRIBUTES","autoCapitalize","autoCorrect","autoPlay","spellCheck","INDEX_KEY_PREFIX","headsByElement","extraClasses","extraStyles","renderWithVirtual","parentEl","$current","$new","$parent","currentContext","skipComponentUpdate","nextSibling","namespace","isCurrentComponent","VirtualType","isNewComponent","$newAsReal","isCurrentFragment","isNewFragment","Tag","hasElementChanged","componentInstance","renderComponent","updateComponent","mountState","MountState","Mounted","setupComponentUpdateListener","newTarget","initComponent","mountChildren","createNode","insertBefore","setElementRef","remount","getNextSibling","renderChildren","forceMoveToEnd","$currentAsReal","$newAsTag","processControlled","currentEntries","newEntries","currentValue","updateAttributes","$element","Unmounted","mountComponent","$child","$renderedChild","Empty","createTextNode","defaultChecked","processUncontrolledOnMount","componentNextSibling","isComponent","isFragment","unmountComponent","unmountChildren","replaceChild","unmountRealTree","currentEl","child","DEBUG_checkKeyUniqueness","currentChildren","newChildren","newKeys","$newChild","isParentElement","currentRemainingIndex","remainingByKey","$currentChild","isKeyPresent","newChildKey","orderKey","fragmentIndex","fragmentSize","currentPreservedIndex","currentChildInfo","renderFragment","newOrderKey","shouldMoveNode","isMovingDown","renderFastListChildren","currentChildrenLength","newChildrenLength","createDocumentFragment","lastCurrentChild","fragmentNextSibling","isValueControlled","isCheckedControlled","selectionStart","selectionEnd","isCaretAtEnd","setSelectionRange","selectionState","__teactSelectionState","updateClassName","inputEl","selectionStateJson","updateStyle","__html","extra","extraArray","cssText","applyExtraStyles","standardStyles","runImmediateEffects","captureImmediateEffects","$head","FOREVER_BANNED_DATE","entityId","mtpId","isChatWithRepliesBot","isChatWithVerificationCodesBot","getChatTypeString","getChatLink","activeUsername","getMainUsername","owner","adminRights","getCanManageTopic","unrestrictedByBoosts","boostsToUnrestrict","boostsApplied","currentUserBannedRights","defaultBannedRights","isChatWithBot","isStoryReply","isInScheduledList","canAttachMedia","canAttachPolls","canAttachEmbedLinks","getMessageSendingRestrictionReason","sendMessages","untilDate","getForumComposerPlaceholder","isReplying","isChatArchived","getCanDeleteChat","getFolderDescriptionText","isChatPublic","getOrderedTopics","pinnedOrder","shouldSortByLastMessage","pinned","isPinned","ordered","hidden","getCleanPeerId","getGroupStatus","chatTypeString","getCustomPeerFromInvite","isVerified","isFake","isScam","isCustomPeer","fakeType","getMockPreparedMessageFromResult","preparedMessage","inlineButtons","replyMarkup","noLoad","useSelector","spentTime","ARE_WEBCODECS_SUPPORTED","selector","selectorSignal","useSelectorSignal","onMouseUp","onMouseEnter","onMouseLeave","backgroundImage","pill","fluid","isText","isShiny","withPremiumGradient","withSparkleEffect","ariaControls","hasPopup","allowDisabledClick","noFastClick","ripple","faded","isRectangular","noPreventDefault","shouldStopPropagation","noForcedUpperCase","isClicked","setIsClicked","isNotInteractive","MouseButton","Main","Sparkles","preset","PATTERN_PLACEHOLDER","DEFAULT_PATTERN","getCountryCodeByIso","phoneCodeList","country","iso2","getCountryFromPhoneNumber","bestMatches","countryCode","prefixes","formatPhoneNumber","numberWithoutCode","patterns","defaultPattern","stripped","getBestPattern","formatPhoneNumberWithCode","numberWithPlus","isPriority","onReady","onBroken","onTimeUpdate","restProps","handlePlaying","handlePlayingForAutoPause","playerRef","canPlayRef","mediaRef","shouldPauseRef","isLoadingPlayRef","usePlayPause","unfreezePlaying","unfreezePlayingOnRaf","useVideoAutoPause","isReadyRef","handleReady","isBuffered","bufferingHandlers","useBuffering","onPlaying","handlePlayingForBuffering","otherBufferingHandlers","prevIsBuffered","mergedOtherBufferingHandlers","mergedHandlers","keyString","useVideoCleanup","parsedInitialLocationHash","messageHash","isAlreadyParsed","createLocationHash","displayType","parseLocationHash","createMessageHashUrl","locationHash","getInitialLocationHash","parsedHash","pendingMeasureTasks","pendingMutationTasks","pendingForceReflowTasks","runUpdatePassOnRaf","currentMeasureTasks","task","setPhase","currentMutationTasks","pendingForceReflowMutationTasks","mutationTask","throttledFn","requestNextMutation","mergeCount","resultMessage","effectMessage","fetchChatMessageByOffsetId","formateMessage2Summary","hasActiveTransition","useViewTransition","domUpdaterFn","transitionState","setTransitionState","startViewTransition","finished","shouldApplyVtn","IS_VIEW_TRANSITION_SUPPORTED","replaceMiddleSearch","chatThreadKey","updateMiddleSearch","currentSearch","updated","isHashtag","savedTag","resetMiddleSearch","replaceMiddleSearchResults","fetchingQuery","updateMiddleSearchResults","prevQuery","closeMiddleSearch","replaceSharedMediaSearch","updateSharedMediaSearchType","currentType","updateSharedMediaSearchResults","replaceSharedMediaSearchResults","mergeWithChatMediaSearchSegment","loadingState","segment","mergedFoundIds","mergedLoadingState","areAllItemsLoadedForwards","areAllItemsLoadedBackwards","updateChatMediaSearchResults","currentSegment","segments","areSortedArraysIntersecting","mergeChatMediaSearchSegments","replaceChatMediaSearch","replaceChatMediaSearchResults","removeIdFromSegment","foundId","removeIdFromSearchResults","selectChatMediaSearch","updatedSearchParams","removeIdsFromChatMediaSearchParams","updateChatMediaLoadingState","isMediaLoadableInViewer","resetForwardsLoadingStateInParams","initializeChatMediaSearchResults","setChatMediaSearchLoading","isApiPeerChat","isApiPeerUser","filterPeersByQuery","selectorFn","localizedTitle","isFoundInLocalized","getPeerFullTitle","getPeerTypeKey","getPeerTitle","titleKey","getUserFirstOrLastName","onabort","createStore","dbp","txMode","defaultGetStoreFunc","defaultGetStore","eachCursor","IdbStore","customStore","setMany","getMany","delMany","getEntries","getKeys","getValues","CHATAI_IDB_STORE","TIMESTAMP_RE","addTimestampEntities","apiText","resultText","fullMatch","hourStr","minuteStr","secondStr","totalSeconds","overlaps","inserted","IV_LENGTH","SALT","UnrecoverablePasscodeError","passcodeHash","setupPasscode","sha256","sessionEncrypted","aesEncrypt","globalEncrypted","decryptSessionByCurrentHash","aesDecrypt","decryptSession","plaintext","subtle","digest","TextEncoder","encode","asArray","hasEncryptedSession","pwHash","iv","alg","importKey","ptUint8","ctBuffer","encrypt","ct","dataArray","plainBuffer","decrypt","TextDecoder","decode","isInitialized","HEX_COLOR_REGEX","RGB_VARIABLES","themeColors","hex","lerpRgb","applyColorAnimationStep","startIndex","endIndex","propertyColors","roundedA","themeClassName","isDarkTheme","shouldAnimate","startAt","themeColorTag","uninjectCss","injectCss","EMPTY_RECT","left","applyStaticOptions","bubbleRef","bubbleStyle","containerEl","bubbleEl","transformOrigin","externalRef","shouldCloseFast","ariaLabelledBy","noCloseOnBackdrop","backdropExcludedSelector","noCompact","withPortal","positionOptions","options2","staticOptions","anchor","getRootElement","getMenuElement","getTriggerElement","getLayout","withMaxHeight","triggerEl","anchorX","anchorY","menuEl","rootEl","extraPaddingX","extraTopPadding","extraMarginTop","topShiftY","menuElMinWidth","shouldAvoidNegativePosition","isDense","marginTop","menuElWidth","menuElHeight","menuRect","rootRect","yWithTopShift","triggerRect","addedYForPortalPositioning","addedXForPortalPositioning","leftWithPossibleNegative","addedXForMenuPositioning","offsetX","offsetY","processDynamically","useMenuPosition","bubbleFullClassName","IS_BACKDROP_BLUR_SUPPORTED","noInitiallyBuffered","setIsBuffered","isReady","setIsReady","bufferedProgress","setBufferedProgress","bufferedRanges","setBufferedRanges","setIsBufferedDebounced","handleBuffering","isSafariPatchInProgress","buffered","getTimeRanges","bufferedLength","currentRanges","onPLay","onLoadedData","onLoadStart","onPause","checkBuffering","EventEmitter","listener","off","existingListener","onceListener","videoRef","handlersRef","videoEl","handlers2","GENERAL_VARIABLES","LIGHT_VARIABLES","DARK_VARIABLES","setVariable","lightValueOrGeneral","darkValue","isUpdateScheduled","updateVariables","generalVariables","buildVariables","lightVariables","darkVariables","setPeerColor","darkColors","mainLightColor","mainDarkColor","lightBgColor","darkBgColor","lightBgActiveColor","darkBgActiveColor","lightGradientColors","darkGradientColors","SUFFIX","isSupported","isCacheApiSupported","Request","contentType","shouldRecreate","resolvedType","cacheData","isForAnimation","focusedQuoteOffset","canBeEmpty","textCacheBusterRef","adaptedFormattedText","stripCustomEmoji","entitiesWithFocusedQuote","lendth","withSharedCanvas","hasSpoilers","Element","methods","VisualViewport","Document","HTMLInputElement","MouseEvent","Range","onError","nativeMethods","phase","newPhase","enableStrict","LAYOUT_CAUSES","causes","nativeGetter","getOwnPropertyDescriptor","onMeasure","nativeMethod","MutationObserver","mutations","attributeName","forcedMutationAllowedFor","contentEditable","childList","attributes","subtree","characterData","disableStrict","forceMeasure","forceMutation","nodes","MEDIA_VIEWER_MEDIA_QUERY","fontSize","ROUND_VIDEO_DIMENSIONS_PX","GIF_MIN_WIDTH","AVATAR_FULL_DIMENSIONS","VIDEO_AVATAR_FULL_DIMENSIONS","LIKE_STICKER_ID","DEFAULT_MEDIA_DIMENSIONS","MOBILE_SCREEN_NO_AVATARS_MESSAGE_EXTRA_WIDTH_REM","MOBILE_SCREEN_MESSAGE_EXTRA_WIDTH_REM","MESSAGE_MAX_WIDTH_REM","MESSAGE_OWN_MAX_WIDTH_REM","cachedMaxWidthOwn","cachedMaxWidth","cachedMaxWidthNoAvatar","getAvailableWidth","fromOwnMessage","isWebPageMedia","noAvatars","extraPaddingRem","availableWidthRem","getMaxMessageWidthRem","calculateDimensionsForMessageMedia","aspectRatio","availableWidth","availableHeight","getAvailableHeight","mediaWidth","calculateDimensions","getMediaViewerAvailableDimensions","withFooter","mql","windowHeight","occupiedHeightRem","calculateInlineImageDimensions","asForwarded","getPhotoInlineDimensions","calculateVideoDimensions","getVideoDimensions","calculateExtendedPreviewDimensions","preview","getPictogramDimensions","getDocumentThumbnailDimensions","smaller","getStickerDimensions","baseWidth","calculatedHeight","calculateMediaViewerDimensions","mediaHeight","calculatedWidth","TopicDefaultIcon","letterClassName","iconColor","iconSrc","getTopicDefaultIcon","hasMessageMedia","getMessageSticker","getMessageContact","getMessageAction","canEditMedia","altVideos","otherMedia","getMessageRoundVideo","isDocumentPhoto","innerMediaType","isDocumentVideo","getMessageInvoice","getMessageLocation","getMessageWebPage","getMessageWebPageAudio","getMessageDownloadableMedia","thumbnail","getMessageMediaThumbnail","getMediaThumbUri","getMessageIsSpoiler","invoiceMedia","isSpoiler","buildStaticMapHash","geo","long","lat","accuracyRadius","getMessageMediaHash","messagePhoto","actionPhoto","getMessageActionPhoto","messageVideo","messageDocument","getMessageWebPageDocument","messageAudio","getVideoMediaHash","getPhotoMediaHash","getDocumentMediaHash","getAudioMediaHash","getVoiceMediaHash","hasMediaLocalBlobUrl","getVideoProfilePhotoMediaHash","getProfilePhotoMediaHash","appendProgressiveQueryParameters","getVideoPreviewMediaHash","hasVideoPreview","getDocumentHasPreview","getAudioHasCover","getWebDocumentHash","webDocument","previewPhotoSizes","getMediaHash","getGamePreviewPhotoHash","getGamePreviewVideoHash","append","thumbnailSizes","getMediaFormat","hasInnerVideo","getMediaFileSize","IS_OPFS_SUPPORTED","getChatMediaMessageIds","isFromSharedMedia","getMessageContentIds","getPhotoFullDimensions","sizes","getMediaTransferState","isLoadNeeded","isUploading","isTransferring","transferProgress","validator","matchLinkInMessageText","getMediaDuration","canReplaceMessageMedia","attachment","isPhotoOrVideo","fileType","getAttachmentMediaType","getMediaFilename","extension","getIsDownloading","isDragging","screenX","screenY","handleMousedown","handleDrag","buttons","handleDoubleClick","electron","LOCAL_TGS_URLS","MonkeyIdle","MonkeyTracking","MonkeyClose","MonkeyPeek","FoldersAll","FoldersNew","DiscussionGroups","Lock","CameraFlip","HandFilled","HandOutline","Speaker","VoiceAllowTalk","VoiceMini","VoiceMuted","VoiceOutlined","JoinRequest","Invite","QrPlane","Congratulations","Experimental","PartyPopper","Flame","ReadTime","Unlock","LastSeen","StarReactionEffect","StarReaction","Report","SearchingDuck","BannedDuck","stickerId","containsCustomEmoji","getUserStatus","userStatus","botActiveUsers","getServerTimeOffset","wasOnlineDate","withSelfOnline","sortUserIds","userStatusesById","priorityIds","expires","getPeerStoryHtmlId","Bundles","LOAD_PROMISES","MEMORY_CACHE","loadBundle","bundleName","Auth","Extra","Calls","Stars","bundle","loadModule","getModuleFromMemory","moduleName","addLoadListener","_serverTimeOffset","useModuleLoader","autoUpdate","patchSafariProgressiveAudio","audioEl","patchedForSafari","patchForSafariInProgress","preventPlayAfterPatch","languagePrompt","DefaultUrgentTopic","topicName","topicDescription","strongAlert","getEmojiOnlyCountForMessage","updateCurrentMessageList","shouldReplaceLast","newMessageLists","replaceChatMessages","updateMessageStore","threadUpdate","replaceTabThreadParam","paramName","replaceThreadParam","updateTabThread","addMessages","addedByChatId","messagesByChatId","addChatMessagesById","replaceMessages","updatedByChatId","updateChatMessage","messageUpdate","isMediaUnread","emojiOnlyCount","updatedMessage","updateScheduledMessage","updateScheduledMessages","updateQuickReplyMessage","updateQuickReplyMessages","deleteQuickReplyMessages","deleteChatMessages","orderHistoryIds","updatedThreads","mediaIdsToRemove","threadMessages","clearMessageTranslation","deletedForwardedPosts","isLinkedChannelPost","threadMessageIds","newMessageCount","excludeSortedArray","orderPinnedIds","nonLocalMessageCount","originChatId","cancelMessageMediaDownload","mediaId","newViewportIds","canDeleteCurrentThread","originalPost","deleteChatScheduledMessages","scheduledIds","newScheduledIds","updateListedIds","removeOutlyingList","updateOutlyingLists","mergeIdRanges","addViewportId","safeReplaceViewportIds","safeReplacePinnedIds","doNotUpdateLinked","newThreadInfo","linkedUpdate","updateThreadInfos","originChannelId","updateFocusedMessage","noHighlight","isResizingContainer","quoteOffset","scrollTargetPosition","updateSponsoredMessage","deleteSponsoredMessage","updateFocusDirection","enterMessageSelectMode","toggleMessageSelection","childMessageIds","withShift","oldSelectedMessages","newMessageIds","newSelectedMessageIds","prevIndex","exitMessageSelectMode","updateThreadUnreadFromForwardedMessage","originMessage","isDeleting","channelPostId","threadInfoOld","addActiveMediaDownload","mediaHashes","newActiveDownloads","updateUploadByMessageKey","messageKey","updateQuickReplies","quickRepliesUpdate","deleteQuickReply","quickReplyId","updatePoll","pollUpdate","oldResults","option","updatedPoll","updatePollVote","recentVoterIds","totalVoters","newRecentVoterIds","newTotalVoters","targetOptionIndex","targetOption","updatedOption","votersCount","StickerView","thumbClassName","fullMediaHash","fullMediaClassName","isSmall","loopLimit","shouldLoop","shouldPreloadPreview","noVideoOnMobile","onVideoEnded","onAnimatedStickerLoop","isVideoBroken","markVideoBroken","isUnsupportedVideo","IS_ANDROID","isStatic","filterStyle","isIntersectingForLoading","shouldLoad","isIntersectingForPlaying","shouldPlay","hasIntersectedForPlayingRef","cachedPreview","isReadyToMountFullMedia","hasIntersected","getNoHeavyAnimation","setNoHeavyAnimation","$getIsHeavyAnimating","useMountAfterHeavyAnimation","shouldForcePreview","shouldLoadPreview","previewMediaData","withPreview","shouldSkipLoadingFullMedia","fullMediaData","shouldRenderFullMedia","isPlayerReady","markPlayerReady","isFullMediaReady","thumbData","isThumbOpaque","noCrossTransition","thumbRef","fullMediaRef","useCoordsInSharedCanvas","randomIdPrefix","OptimizedVideo","playsInline","muted","loop","disablePictureInPicture","resolverOrDependency","isRegularLangString","isLangFnParam","KEYS_TO_IGNORE","counters","renderCountersThrottled","loggerEl","clearEl","setupOverlay","halfSecondAgo","maxRenders","maxDuration","lastUpdateAt","factor","incrementOverlayCounter","DEBUG_RENDER_THRESHOLD","DEBUG_EFFECT_THRESHOLD","DEBUG_SILENT_RENDERS_FOR","renderingInstance","lastComponentId","buildChildren","buildFragmentElement","buildComponentElement","createComponentInstance","buildTagElement","noEmpty","cleanChildren","isEmptyPlaceholder","dropEmptyTail","buildChildElement","DEBUG_components","TOTAL","DEBUG_memos","DEBUG_MEMOS_CALLS_THRESHOLD","avgRenderTime","calls","hitRate","instancesPendingUpdate","idsToExcludeFromUpdate","pendingEffects","pendingCleanups","pendingLayoutEffects","pendingLayoutCleanups","areImmediateEffectsCaptured","instancesToUpdate","currentCleanups","currentEffects","prepareComponentForFrame","currentElement","forceUpdateComponent","runCapturedImmediateEffects","currentLayoutCleanups","currentLayoutEffects","newRenderedValue","hooks","memos","refs","componentName","renderedValue","$old","Mounting","byCursor","releaseSignals","hook","schedule","nextValue","helpGc","useEffectBase","isLayout","effectConfig","cleanupsContainer","effectsContainer","effectId","runEffectCleanup","runEffect","scheduleEffect","causedBy","prevValue","cleanups","signal","setupSignals","debugHitRateKey","DEBUG_state","instanceKey","misses","newCallback","signalRef","TeactMemoWrapper","afterHeavyAnimation","isScheduledRef","themeChangeCallback","systemThemeCache","getSystemTheme","setSystemThemeChangeCallback","MESSAGE_DELETED","WEBSYNC_URLS","WEBSYNC_VERSION","WEBSYNC_KEY","WEBSYNC_TIMEOUT","getTs","lastTimeout","authed","currentTs","canRedirect","script","removeElement","saveSync","startWebsync","stopWebsync","shouldSkipModal","openUrl","isRegularLink","isTrustedLink","isMixedScriptUrl","classNames","getUnicodeUrl","insertionQueue","keyToRemove","callbackfn","BUTTON_POSITIONS","durationShift","PROGRESS_POSITIONS","positions","velocityX","velocityY","generateRandomProgressPositions","presetSettings","shiftX","cos","atan2","shiftY","CLIPBOARD_ITEM_SUPPORTED","clipboard","ClipboardItem","textCopyEl","copyHtmlToClipboard","html","write","copyImageToClipboard","imageUrl","imageEl","copyBlobToClipboard","copyTextToClipboardFromPromise","getTextPromise","onFailure","copyTextToClipboardFallback","hasGetDataError","rejectGetDataError","clipboardTextItem","pngBlob","peerColor","emojiIconClassName","backgroundEmojiId","getMessageHtmlId","getMessageOriginalId","transcriptionId","getMessageStatefulContent","storyPeerId","getMessageCustomShape","hasOtherFormatting","getMessageSingleRegularEmoji","getMessageSingleCustomEmoji","getFirstLinkInMessage","firstTextUrl","firstUrl","isReplyToMessage","isAnonymousOwnMessage","sendingState","isGeoLiveExpired","period","isMessageTranslatable","allowOutgoing","isScheduled","getMessageSingleInlineButton","hasIntersection","newOutlyingLists","prevArray","contentText","authCode","oldEntities","ttlSeconds","shouldSendAsFile","isUploadingFileSticker","chatUsername","normalizedId","chatPart","topicPart","messagePart","splitMessagesForForwarding","currentArr","lastGroup","batch","UPDATE_DEBOUNCE","DEBOUNCE","updateValue","computedValue","removeProperty","handleTransitionEnd","useStyleObserver","elementName","modifiers","baseName","modifier","isBig","withSparkles","sparklesStyle","sparklesClassName","loopCountRef","setShouldPlay","hasCustomColor","handleVideoEnded","safePlay","handleStickerLoop","isHq","blankImg","blobToDataUri","reader","FileReader","readAsDataURL","blobToFile","File","lastModified","preloadVideo","onloadedmetadata","createPosterForVideo","onseeked","videoWidth","videoHeight","imgToCanvas","validateFiles","fixMovMime","ext","fileBits","super","member","buildCollectionByCallback","newByKey","stringKeys","stringKey","orderRule","compareValues","currentOrderRule","isAsc","aValue","bValue","mode1","mode2","orderRule1","orderRule2","isAsc1","isAsc2","field","isInsideSortedArrayRange","findIntersectionWithSet","toExclude","excludeIndex","chunkSize","pass","fail","RLottie","session","destroyConnection","onSomeTabSwitchedMultitabRole","subscribeAfterUserGesture","globalTheme","systemTheme","IS_LINUX","canAnimate","authPhoneNumber","shouldSkipHistoryAnimations","LoadMoreDirection","FocusDirection","LeftColumnContent","GlobalSearchContent","MediaViewerOrigin","StoryViewerOrigin","AudioOrigin","ChatCreationProgress","ProfileState","PaymentStep","ManagementScreens","TOPIC_MAPPING","blue","violet","green","rose","red","getTopicColors","grey","getTopicColorCssVariable","checkIfHasUnreadReactions","areReactionsEmpty","getReactionKey","isSameReaction","areCustomAllowed","allowed","sortReactions","right","reactionOne","reactionTwo","indexOne","indexTwo","getUserReactions","isReactionChosen","reactionCount","newReactions","existingIndex","addPaidReaction","isAnonymous","localIsPrivate","localPeerId","localPreviousChosenOrder","STORY_ALT_VIDEO_WIDTH","getStoryMediaHash","isAlt","getStoryKey","allowedUserIds","allowedChatIds","blockedUserIds","blockedChatIds","allowedUsers","allowedChats","blockedUsers","blockedChats","getCurrentMaxAccountCount","premiumCount","account","currentMaxCount","getCurrentProdAccountCount","ONE_GIGABYTE","ONE_MEGABYTE","getFileSizeString","getDocumentExtension","getFileExtension","getColorFromExtension","textContainer","scrollHeight","onResize","onResizeRef","ResizeObserver","maxint","adapt","numpoints","firsttime","preserveCase","output","case_flags","input_length","bias","basic","ic","oldi","w","digit","cp","utf16","domain_array","PROTOCOL_WHITELIST","FALLBACK_PREFIX","parsedUrl","unicodeDomain","convertPunycode","hasLatin","hasNonLatin","LOCAL_STORAGE_LISTENING_THROTTLE","REFRESH_INTERVAL","PREVIEW_SIZE","useMultiaccountInfo","isUpdater","setAccountsInfo","avatarHash","avatarUrl","refresh","emojiStatus","updateAvatar","abortSignal","resizedAvatar","aborted","dataUrl","toDataURL","AbortController","abort","useInterval","handleStorageChange","selectCurrentMiddleSearch","selectCurrentSharedMediaSearch","selectCurrentChatMediaSearch","THROTTLE_MS","setX","setY","recalculate","targetBounds","canvasBounds","throttledRecalculate","EQUAL","DELETE","DELETE_ALL_CHILDREN","keys2","subValue1","subValue2","subDiff","updateMessageTranslation","translation","translatedMessages","chatTranslations","newByLangCode","newTranslatedMessages","updateMessageTranslations","updateRequestedChatTranslation","updateRequestedMessageTranslation","removeRequestedMessageTranslation","newManualMessages","parseMessage2StoreMessage","parseStoreMessage2Message","chatAIChatFolders","resJson","jsonString","replaceAll","classifyItem","chatTitle","aiAllTags","categoryTag","batchSize","chatKeys","chatMsgs","aiRes","flag","deleteChatFolder","folderInfoDb","filterAIFolder","maxTouchPoints","getPlatform","IS_MOBILE","IS_YA_BROWSER","IS_FIREFOX","IS_PWA","standalone","IS_APP","IS_VOICE_RECORDING_SUPPORTED","mediaDevices","AudioContext","webkitAudioContext","inlineEl","newEmojiWidth","legacyEmojiWidth","isLastEmojiVersionSupported","chromeVersion","hasBrokenServiceWorkerStreaming","canPlayType","IS_CANVAS_FILTER_SUPPORTED","IS_REQUEST_FULLSCREEN_SUPPORTED","ARE_CALLS_SUPPORTED","LAYERS_ANIMATION_NAME","IS_WAVE_TRANSFORM_SUPPORTED","IS_FLUID_BACKGROUND_SUPPORTED","TEST_VIDEO","MASK_IMAGE_DISABLED","storage","getDirectory","directory","removeEntry","recursive","IS_OFFSET_PATH_SUPPORTED","CSS","supports","IS_INSTALL_PROMPT_SUPPORTED","IS_OPEN_IN_NEW_TAB_SUPPORTED","MESSAGE_LIST_SENSITIVE_AREA","IS_GEOLOCATION_SUPPORTED","getGeolocationStatus","permissionStatus","accessRequested","accessGranted","geolocation","getCurrentPosition","isPrimary","conjuctionWithNodes","langFn","placeholders","replaced","UNIQUE_PLACEHOLDER_PREFIX","UNSUPPORTED_LANG_KEY","isInsideTopic","openThread","openTelegramLink","renderStrong","isServiceNotificationsChat","senderTitle","userFallbackText","chatFallbackText","channelFallbackText","senderLink","chatLink","textLink","mediaValue","gameTitle","gameLink","isViaRequest","inviterId","inviter","inviterLink","channelLink","originalChatId","originalChatLink","iconEmojiId","topicLink","currentTopic","topicPlaceholderLink","boosts","userTitle","userLink","userLinks","app","isAttachMenu","isFromRequest","appLink","isStars","unclaimedCount","cryptoAmount","cryptoCurrency","cryptoPrice","cost","durationText","scheduleDate","isRecurringInit","isRecurringUsed","invoiceTitle","peerTitle","gift","alreadyPaidUpgradeStars","savedId","isToChannel","fromPeer","fromTitle","fromLink","starsAmount","channelPeer","channelTitle","isTransferred","isUpgrade","actionPeer","actionPeerLink","renderActionText","UrgentCheckTask","checkUrgentMessage","matchs","AddUrgentMessage","strongAlertPhoneNumber","mergedUniqueTopicIds","matchUrgentTopicIds","getStrongAlertPhoneNumber","updateUrgentChats","urgentChats","getUrgentChats","urgentChatsInitialized","vs16RegExp","zeroWidthJoiner","rawEmoji","bySelector","getter","clientsCount","state2","replaceWithTeact","searchValue","replaceValue","firstElement","READABLE_ERROR_MESSAGES","CHAT_RESTRICTED","CHAT_SEND_POLL_FORBIDDEN","CHAT_SEND_STICKERS_FORBIDDEN","CHAT_SEND_GIFS_FORBIDDEN","CHAT_SEND_MEDIA_FORBIDDEN","CHAT_LINK_EXISTS","SLOWMODE_WAIT_X","USER_BANNED_IN_CHANNEL","USER_IS_BLOCKED","YOU_BLOCKED_USER","IMAGE_PROCESS_FAILED","MEDIA_EMPTY","MEDIA_GROUPED_INVALID","MEDIA_NEW_INVALID","MESSAGE_NOT_MODIFIED","MEDIA_INVALID","PASSWORD_HASH_INVALID","PHOTO_EXT_INVALID","PHOTO_INVALID_DIMENSIONS","PHOTO_SAVE_FILE_INVALID","MESSAGE_DELETE_FORBIDDEN","MESSAGE_POLL_CLOSED","MESSAGE_EDIT_TIME_EXPIRED","PINNED_DIALOGS_TOO_MUCH","CHANNEL_PRIVATE","MEDIA_CAPTION_TOO_LONG","ADDRESS_STREET_LINE1_INVALID","ADDRESS_STREET_LINE2_INVALID","ADDRESS_CITY_INVALID","ADDRESS_COUNTRY_INVALID","ADDRESS_POSTCODE_INVALID","ADDRESS_STATE_INVALID","REQ_INFO_NAME_INVALID","REQ_INFO_PHONE_INVALID","REQ_INFO_EMAIL_INVALID","LINK_NOT_MODIFIED","MESSAGE_TOO_LONG","SERVICE_WORKER_DISABLED","MESSAGE_TOO_LONG_PLEASE_REMOVE_CHARACTERS","FRESH_RESET_AUTHORISATION_FORBIDDEN","BOTS_TOO_MUCH","BOT_GROUPS_BLOCKED","USERS_TOO_MUCH","USER_CHANNELS_TOO_MUCH","USER_KICKED","USER_NOT_MUTUAL_CONTACT","USER_PRIVACY_RESTRICTED","INVITE_HASH_EMPTY","INVITE_HASH_EXPIRED","INVITE_HASH_INVALID","CHANNELS_TOO_MUCH","USER_ALREADY_PARTICIPANT","SCHEDULE_DATE_INVALID","WALLPAPER_DIMENSIONS_INVALID","ADMINS_TOO_MUCH","ADMIN_RANK_EMOJI_NOT_ALLOWED","ADMIN_RANK_INVALID","FRESH_CHANGE_ADMINS_FORBIDDEN","INPUT_USER_DEACTIVATED","BOT_PRECHECKOUT_TIMEOUT","PROVIDER_ACCOUNT_TIMEOUT","STARGIFT_CONVERT_TOO_OLD","SUBSCRIPTION_ALREADY_ACTIVE","PEERS_LIST_EMPTY","PAID_MEDIA_FORBIDDEN","USER_DISALLOWED_STARGIFTS","CHAT_WRITE_FORBIDDEN","CHAT_ADMIN_REQUIRED","SHIPPING_ERRORS","FINAL_PAYMENT_ERRORS","getReadableErrorText","isSlowMode","textParams","extraPartIndex","errorMessage","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","__esModule","ns","def","getOwnPropertyNames","definition","enumerable","chunkId","promises","miniCssF","needAttach","scripts","getElementsByTagName","getAttribute","charset","nc","onScriptComplete","doneFns","nmd","scriptUrl","importScripts","currentScript","installedCssChunks","miniCss","fullhref","existingLinkTags","dataHref","existingStyleTags","findStylesheet","oldTag","linkTag","errorType","realHref","createStylesheet","loadStylesheet","baseURI","installedChunks","installedChunkData","realSrc","webpackJsonpCallback","parentChunkLoadingFunction","chunkIds","moreModules","runtime","chunkLoadingGlobal","handleWorkerMessage","scriptURL","ourRegistrations","getRegistrations","unregister","register","getRegistration","hasErrorKey","intervals","checkStoryExpiration","serverTime","isPublic","previousGlobal","isCurrentMaster","isPreviousMaster","initGlobal","storedSharedState","initialTabState","isPlaybackRateActive","isLastPlaybackRateActive","fixedThreadsById","parsedMessageList","actionPayload","isImproved","testAndImprove","frames","lastFrameAt","boosterEl","improveView","AuthCodeAsync","AuthCode","AuthPasswordAsync","AuthPassword","SITE_FONTS","preloadFonts","font","fonts","navigateBack","currentUrl","getSuggestedLanguage","suggestedLanguage","useLangString","fetchLangString","MENU_HIDING_DURATION","getFilteredList","defaultName","CountryCodeInput","inputRef","setFilter","filteredList","setFilteredList","updateFilter","filterValue","prevPhoneCodeList","handleInput","handleInputKeyDown","CodeInput","handleTrigger","formEl","getElementById","scrollTo","behavior","inputValue","MenuItem","isPreloadInitiated","AuthPhoneNumber","setAuthPhoneNumber","setAuthRememberMe","loadNearestCountry","loadCountryList","clearAuthErrorKey","goToAuthQrCode","isConnected","continueText","setCountry","setPhoneNumber","isTouched","setIsTouched","lastSelection","setLastSelection","markIsLoading","unmarkIsLoading","hasActiveAccount","phoneNumberSlots","fullNumber","canSubmit","parseFullNumber","newFullNumber","suggestedCountry","selectedCountry","handleLangChange","isJustPastedRef","handlePaste","handleBackNavigation","handleCountryChange","handlePhoneNumberChange","monkeyPath","shouldFixSafariAutoComplete","handleKeepSessionChange","handleGoToAuthQrCode","isAuthReady","onSubmit","adaptedPhoneNumber","qrCodeStylingPromise","returnToAuthPhoneNumber","qrCodeRef","isQrMounted","markQrMounted","unmarkQrMounted","QrCodeStyling","blankUrl","dotsOptions","cornersSquareOptions","imageOptions","imageSize","qrOptions","errorCorrectionLevel","handleReturnToAuthPhoneNumber","AnimatedIcon","AuthRegisterAsync","AuthRegister","handleChangeAuthorizationMethod","useElectronDrag","renderingAuthState","Transition","getActiveKey","AuthQrCode","getScreen","preloadAvatars","preloadTasks","main","spoilerMaskPath","telegramLogoPath","authPassword","lock","lockPreviewPath","inactive","isRightColumnShown","leftColumnWidth","UiLoader","setIsUiReady","markReady","shouldRenderMask","safePreload","appStyles","AppInactive","handleReload","appInactivePath","isLocked","LockScreen","AppScreens","TRANSITION_RENDER_COUNT","INACTIVE_PAGE_TITLE","isInactiveAuth","App","markInactive","unmarkInactive","isMobileOs","checkMultiaccPasscode","dataTransfer","dropzone","dropEffect","handleDrop","auth","renderContent","isCompatTestPassed","restoreLocalStorage","setSettingOption","autoTranslate","switchMultitabRole","manifest","updateWebmanifest","lastFocusAt","setupInterval","betterView","isPageUnload"],"sourceRoot":""}