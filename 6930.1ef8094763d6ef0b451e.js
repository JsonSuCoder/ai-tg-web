"use strict";(self.webpackChunkTeleGPT=self.webpackChunkTeleGPT||[]).push([[6930],{87009:(e,t,a)=>{a.r(t),a.d(t,{ChatRefundModal:()=>Sa,GiftInfoModal:()=>jt,GiftModal:()=>Dt,GiftRecipientPicker:()=>Ft,GiftResalePriceComposerModal:()=>Xt,GiftStatusInfoModal:()=>ra,GiftTransferModal:()=>ba,GiftUpgradeModal:()=>ta,GiftWithdrawModal:()=>ca,PaidReactionModal:()=>Xe,PriceConfirmModal:()=>Na,StarPaymentModal:()=>fe,StarsBalanceModal:()=>me,StarsGiftModal:()=>v,StarsGiftingPickerModal:()=>w,StarsSubscriptionModal:()=>Me,StarsTransactionInfoModal:()=>Pe});var r=a(84051),n=a(13439),i=a(70636),s=a(60919),o=a(87357),l=a(17142),c=a(4961),m=a(14),d=a(17712),u=a(59030),A=a(21849),p=a(54746),f=a(84685),y=a(64493),g=a(22337),h=a(1526);const E={modalDialog:"MFXAwnxJ",content:"Sl6xVf1R",main:"bTN9Jeph",headerInfo:"c6MiyJgW",logo:"StGLWvzb",logoBackground:"SyTXSfml",description:"kFe3mIZo",section:"BgfHkWd2",header:"zMtAGfXs",starHeaderText:"q3v8orGj",hiddenHeader:"bq3FnXT0",closeButton:"bDsDTkbe",avatar:"jK36xUj4",center:"v1PckUQn",secondaryInfo:"TDWSRfP9"},b=a.p+"GoldStar.fb6812e915ddfe27f504.svg",S=a.p+"stars-bg.dee4c4b73c7d21c2ec73.png",v=(0,r.ph)((0,n.EK)((e,{modal:t})=>({user:t?.forUserId?(0,s.mBe)(e,t.forUserId):void 0}))(({modal:e,user:t})=>{const{closeStarsGiftModal:a,openInvoice:s,requestConfetti:v}=(0,n.ko)(),N=(0,r.li)(),k=Boolean(e?.isOpen),C=(0,m.A)(e),I=(0,u.A)(),[G,P]=(0,r.J0)(),[w,B]=(0,r.J0)(!0);(0,r.vJ)(()=>{k||B(!0)},[k]);const M=(0,d.A)(()=>{const e=N.current;if(e&&k){const{top:t,left:a,width:r,height:n}=e.querySelector(".modal-content").getBoundingClientRect();v({top:t,left:a,width:r,height:n,withStars:!0})}});(0,r.vJ)(()=>{C?.isCompleted&&M()},[C,M]);const T=(0,d.A)(e=>{C&&(P(e),s(t?{type:"starsgift",userId:t.id,stars:e.stars,currency:e.currency,amount:e.amount}:{type:"stars",stars:e.stars,currency:e.currency,amount:e.amount}))}),U=(0,d.A)(()=>{a()}),R=(0,r.Kr)(()=>{const e=I("lng_credits_summary_options_about").split("{link}");return[e[0],r.Ay.createElement(f.A,{url:I("StarsTOSLink"),text:I("lng_credits_summary_options_about_link")}),e[1]]},[I]);return r.Ay.createElement(g.A,{className:(0,o.A)(E.modalDialog),contentClassName:E.content,dialogRef:N,isSlim:!0,onClose:U,isOpen:k},r.Ay.createElement("div",{className:(0,o.A)(E.main,"custom-scroll"),onScroll:function(e){const{scrollTop:t}=e.currentTarget;B(t<=150)}},r.Ay.createElement(y.A,{round:!0,size:"smaller",className:E.closeButton,color:"translucent",onClick:()=>a(),ariaLabel:I("Close")},r.Ay.createElement(p.A,{name:"close"})),r.Ay.createElement("div",{className:(0,o.A)(E.header,w&&E.hiddenHeader)},r.Ay.createElement("h2",{className:E.starHeaderText},I(t?"GiftStarsTitle":"Star.List.GetStars"))),r.Ay.createElement("div",{className:E.headerInfo},t?r.Ay.createElement(r.Ay.Fragment,null,r.Ay.createElement(A.A,{size:100,peer:t,className:E.avatar}),r.Ay.createElement("img",{className:E.logoBackground,src:S,alt:"",draggable:!1})):r.Ay.createElement(r.Ay.Fragment,null,r.Ay.createElement("img",{className:E.logo,src:b,alt:"",draggable:!1}),r.Ay.createElement("img",{className:E.logoBackground,src:S,alt:"",draggable:!1}))),r.Ay.createElement("h2",{className:(0,o.A)(E.headerText,E.center)},C?.isCompleted?t?(0,c.A)(I("Notification.StarsGift.SentYou",(0,l.Ad)(G.amount,G.currency,I.code)),["simple_markdown"]):(0,c.A)(I("StarsAcquiredInfo",G?.stars),["simple_markdown"]):I(t?"GiftStarsTitle":"Star.List.GetStars")),r.Ay.createElement("p",{className:E.description},t?(0,c.A)(I("ActionGiftStarsSubtitle",(0,i.F9)(I,t)),["simple_markdown"]):I("Stars.Purchase.GetStarsInfo")),r.Ay.createElement("div",{className:E.section},r.Ay.createElement(h.A,{options:C?.starsGiftOptions,onClick:T}),r.Ay.createElement("div",{className:E.secondaryInfo},R))))}));var N=a(31481),k=a(90709),C=a(87894),I=a(79582),G=a(54960),P=a(34642);const w=(0,r.ph)((0,n.EK)(e=>{const{chats:{listIds:t},currentUserId:a}=e;return{userIds:e.contactList?.userIds,activeListIds:t.active,archivedListIds:t.archived,currentUserId:a}})(({isOpen:e,currentUserId:t,activeListIds:a,archivedListIds:s,userIds:o})=>{const{closeStarsGiftingPickerModal:l,openStarsGiftModal:c}=(0,n.ko)(),m=(0,u.A)(),[A,p]=(0,r.J0)(""),f=(0,r.Kr)(()=>{const e=(0,n.mS)().users.byId,r=(0,C.Am)([...o||[],...a||[],...s||[]]),l=(0,i.PU)({ids:r,query:A,type:"user"});return(0,I.A)(l.filter(a=>{const r=e[a];return!(!r||r.isSupport||(0,k.tv)(r)||(0,k.PL)(r)||a===t||a===N.zv8)}))},[t,A,o,a,s]),y=(0,d.A)(e=>{e?.length&&(c({forUserId:e}),l())});return r.Ay.createElement(P.A,{className:"s3k01dTm",isOpen:e,onClose:l,title:m("GiftStarsTitle"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0,confirmButtonText:m("Continue"),onEnter:l},r.Ay.createElement(G.A,{className:"cuI2eDIY",itemIds:f,filterValue:A,filterPlaceholder:m("Search"),onFilterChange:p,isSearchable:!0,withDefaultPadding:!0,withStatus:!0,onSelectedIdChange:y}))}));var B=a(30708),M=a(31460),T=a(37661),U=a(39351),R=a(46222),x=a(24680),D=a(41036),F=a(38777),O=a(86046),L=a(81949),K=a(9267);const V={root:"TtE8LQNJ",minimal:"nkV4JXHc",transition:"nXQS4E59",main:"JuWZY1ds",container:"mnhBs1uK",section:"lYkNd_gb",lastSection:"f749AI4g",sectionTitle:"FF8gm7MP",hint:"Rs8WXoOz",tos:"Vu6blJk9",topUpButton:"dc_DZoVF",tonBalanceContainer:"lorbW9II",tonBalance:"h2Fs3tOv",tonIconBalance:"Ut6GidJP",tonInUsd:"FdcdsB4l",tonIconLogo:"_hCjjyEv",description:"teXilLxe",header:"fnhXotO2",starHeaderText:"iUwego5s",botItem:"AhxcrKWn",hiddenHeader:"DZk6d6hF",closeButton:"piD1PXHW",addStarsButton:"dqnGL2uh",addStarsIcon:"w9Db2eiK",balanceBlock:"Yk0OQBKC",balanceInfo:"p2dW9NOV",smallerText:"rUnPcfmE",balanceBottom:"F5BTkZ9G",modalBalance:"t8tMrx3y",starButton:"oOt4VBD2",paymentContent:"OReEUNTV",paymentImages:"oKorQYTC",paymentPhoto:"HGTrEtUF",avatarStar:"Wu10dXoa",paymentImageBackground:"os8jb_qv",paymentButton:"VzR5cibf",paymentButtonStar:"Uhg7yWxK",transactions:"Qvc0fTTH",subscriptions:"IX5BhCUF",tabs:"KZVEyKOX",disclaimer:"bpVifdwH",amountBadge:"BPM7LKwo",loadMore:"TKmZjMyd",loadMoreIcon:"buepwtN1"},z=(0,r.ph)(({balance:e,className:t,withAddButton:a})=>{const i=(0,U.A)(),{openStarsBalanceModal:s}=(0,n.ko)();return r.Ay.createElement("div",{className:(0,o.A)(V.balanceBlock,t)},r.Ay.createElement("div",{className:V.balanceInfo},r.Ay.createElement("span",{className:V.smallerText},i("StarsBalance")),r.Ay.createElement("div",{className:V.balanceBottom},e?.currency===N.ykW?r.Ay.createElement(r.Ay.Fragment,null,r.Ay.createElement(p.A,{name:"toncoin"}),void 0!==e?(0,l.UL)(e.amount,e.currency):"…"):r.Ay.createElement(r.Ay.Fragment,null,r.Ay.createElement(K.A,{type:"gold",size:"middle"}),void 0!==e&&e.currency===N.OUy?(0,O.ZF)(i,e):"…",a&&r.Ay.createElement(L.A,{className:V.addStarsButton,onClick:()=>s({})},r.Ay.createElement(p.A,{className:V.addStarsIcon,name:"add"}))))))});var H=a(17663),q=a(14242),J=a(63527);const W={root:"ZXnbeQxP",info:"zLaaDX3c",status:"HbF2qTB2",statusPricing:"AveGvpdV",amount:"_CBiOQcv",title:"k9ZIv5Pd",description:"FlRlxMx2",subtitle:"YN2J8dw6",statusPeriod:"MRrP7Oew",statusEnded:"pRHwfr8m",preview:"t6Syyhzd",subscriptionStar:"ftlbevPm"},_=(0,r.ph)(({subscription:e})=>{const{openStarsSubscriptionModal:t}=(0,n.ko)(),{peerId:a,pricing:o,until:l,isCancelled:m,title:p,photo:f}=e,y=(0,u.A)(),g=(0,J.A)(function(e){return t=>(0,s.PVB)(t,e)}(a)),h=(0,d.A)(()=>{t({subscription:e})});if(!g)return;const E=l<Date.now()/1e3,b=(0,H.A)(1e3*l,y.code,!0,"long");return r.Ay.createElement("div",{className:W.root,onClick:h},r.Ay.createElement("div",{className:W.preview},r.Ay.createElement(A.A,{size:"medium",peer:g}),r.Ay.createElement(K.A,{className:W.subscriptionStar,type:"gold",size:"small"})),r.Ay.createElement("div",{className:W.info},r.Ay.createElement("h3",{className:W.title},(0,c.A)((0,i.F9)(y,g)||"")),p&&r.Ay.createElement("p",{className:W.subtitle},f&&r.Ay.createElement(A.A,{webPhoto:f,size:"micro"}),(0,c.A)(p)),r.Ay.createElement("p",{className:W.description},y(E?"StarsSubscriptionExpired":m?"StarsSubscriptionExpires":"StarsSubscriptionRenews",b))),r.Ay.createElement("div",{className:W.status},m||E?r.Ay.createElement("div",{className:W.statusEnded},y(E?"StarsSubscriptionStatusExpired":"StarsSubscriptionStatusCancelled")):r.Ay.createElement(r.Ay.Fragment,null,r.Ay.createElement("div",{className:W.statusPricing},r.Ay.createElement(K.A,{className:W.star,type:"gold",size:"adaptive"}),r.Ay.createElement("span",{className:W.amount},(0,q.Sm)(o.amount))),r.Ay.createElement("div",{className:W.statusPeriod},y("StarsParticipantSubscriptionPerMonth")))))});var j=a(58968),Q=a(66833);function X(e,t,a){if(a.paidMessages)return t("PaidMessageTransaction",{count:a.paidMessages},{withNodes:!0,pluralValue:a.paidMessages});if(a.isGiftResale)return Y(a.amount)?t("StarGiftSaleTransaction"):t("StarGiftPurchaseTransaction");if(a.isPostsSearch)return t("PostsSearchTransaction");if(a.starRefCommision)return e("StarTransactionCommission",(0,q.l9)(a.starRefCommision));if(a.isGiftUpgrade)return e("Gift2TransactionUpgraded");if(a.extendedMedia)return e("StarMediaPurchase");if(a.subscriptionPeriod)return a.title||e("StarSubscriptionPurchase");if(a.isReaction)return e("StarsReactionsSent");if(a.giveawayPostId)return e("StarsGiveawayPrizeReceived");if(a.isMyGift)return e("StarsGiftSent");if(a.isGift)return a.amount.currency===N.ykW?t("TonGiftReceived"):e("StarsGiftReceived");if(a.starGift)return Y(a.amount)?e("Gift2TransactionSent"):e("Gift2ConvertedTitle");const r=a.peer&&(0,O.MA)(a)&&(0,O.Pc)(a)||void 0;return r?r.title||e(r.titleKey):a.title}function Y(e){return e.currency===N.OUy?(t=e).amount?t.amount<0:t.nanos<0:e.amount<0;var t}var $=a(79577),Z=a(40558),ee=a(62587),te=a(27860);const ae={root:"jQkp75Gb",preview:"OYGSN3PF",count:"KX1yz2Jy",thumb:"EvinKr5k",noOutline:"KSAAsUDv",itemCount1:"GxDajfX_",itemCount2:"jXuZoxq8",itemCount3:"TPn3XGHJ",blurry:"hWZuxLS8",full:"w56QPFhl",fadeIn:"ds43W8Wq"};function re({boughtMedia:e,index:t,className:a}){const n=e.video||e.photo,i=(0,k.VO)(n,"pictogram"),s=(0,k.VD)(n),l=(0,ee.A)(i);return r.Ay.createElement("div",{className:(0,o.A)(ae.thumb,void 0!==t&&`stars-transaction-media-${t}`,a)},s&&r.Ay.createElement("img",{className:ae.blurry,src:s,alt:""}),l&&r.Ay.createElement("img",{className:ae.full,src:l,alt:""}))}const ne=(0,r.ph)(({media:e,className:t,isTransactionPreview:a,onClick:n})=>{const i=Math.min(e.length,a?2:3),s="mediaType"in e[0];return r.Ay.createElement("div",{className:(0,o.A)(ae.root,ae[`itemCount${i}`],a&&ae.preview,t),dir:"rtl",onClick:n},e.slice(0,i).reverse().map((e,t,n)=>{const i=n.length-t-1;return"mediaType"in e?r.Ay.createElement(te.A,{className:ae.thumb,isVisible:!0,width:e.width,height:e.height,thumbDataUri:e.thumbnail?.dataUri}):r.Ay.createElement(re,{className:(0,o.A)(a&&i>0&&ae.noOutline),boughtMedia:e,index:i})}),s&&r.Ay.createElement("div",{className:ae.count},r.Ay.createElement(p.A,{name:"stars-lock"}),e.length>1?e.length:""))}),ie={root:"aHAxv_Jg",info:"oyYrn3II",stars:"K5lc75ku",amount:"QLQPuLAr",title:"e0pK8CJ_",description:"xbERdDMQ",date:"l6CwQ0Ev",positive:"P_42_ZWR",negative:"TGjnLJfH",preview:"cnjGihOT",subscriptionStar:"z43YvnDX",uniqueGiftBackground:"eNvzMw2p",giftSticker:"U3dqmnM4"},se=(0,r.ph)(({transaction:e,className:t})=>{const{openStarsTransactionModal:a}=(0,n.ko)(),{date:l,amount:m,photo:f,peer:y,extendedMedia:g,subscriptionPeriod:h}=e,E=(0,U.A)(),b=(0,u.A)(),S="peer"===y.type?y.id:void 0,v=(0,J.A)(function(e){return t=>e?(0,s.PVB)(t,e):void 0}(S)),k=e.starGift,C="starGiftUnique"===k?.type,I=k&&(0,Q.yQ)(k),G=(0,r.Kr)(()=>{let t,a,r,n=X(b,E,e);if((0,O.MA)(e)){const a=(0,O.Pc)(e);n=a.title||b(a.titleKey),t=b(a.subtitleKey),r=a}else t=v&&(0,i.F9)(b,v),r=v||j.lw;return e.isGiftUpgrade&&"starGiftUnique"===e.starGift?.type&&(t=E("GiftUnique",{title:e.starGift.title,number:e.starGift.number})),e.isGiftResale&&"starGiftUnique"===e.starGift?.type&&(t=E("GiftUnique",{title:e.starGift.title,number:e.starGift.number})),e.isPostsSearch&&(n=X(b,E,e),t=void 0),e.photo&&(r=void 0),e.isRefund&&(a=b("StarsRefunded")),e.hasFailed&&(a=b("StarsFailed")),e.isPending&&(a=b("StarsPending")),{title:n,description:t,avatarPeer:r,status:a}},[b,E,v,e]),P=(0,r.Kr)(()=>{if(C){const{backdrop:e}=(0,Q.uc)(k),t=[e.centerColor,e.edgeColor];return r.Ay.createElement(r.Ay.Fragment,null,r.Ay.createElement(Z.A,{className:ie.uniqueGiftBackground,backgroundColors:t}),r.Ay.createElement($.A,{className:ie.giftSticker,sticker:I,size:36,play:!1}))}return I?r.Ay.createElement($.A,{className:ie.giftSticker,sticker:I,size:36,play:!1}):g?r.Ay.createElement(ne,{media:g,isTransactionPreview:!0}):r.Ay.createElement(r.Ay.Fragment,null,r.Ay.createElement(A.A,{size:"medium",webPhoto:f,peer:G.avatarPeer}),Boolean(h)&&r.Ay.createElement(K.A,{className:ie.subscriptionStar,type:"gold",size:"small"}))},[C,g,f,G.avatarPeer,h,k,I]),w=(0,d.A)(()=>{a({transaction:e})}),B=Y(m)?ie.negative:ie.positive;return r.Ay.createElement("div",{className:(0,o.A)(ie.root,t),onClick:w},r.Ay.createElement("div",{className:ie.preview},P),r.Ay.createElement("div",{className:ie.info},r.Ay.createElement("h3",{className:ie.title},G.title),G.description&&r.Ay.createElement("p",{className:ie.description},(0,c.A)(G.description)),r.Ay.createElement("p",{className:ie.date},(0,H.L2)(1e3*l,b.code,!0),G.status&&` — (${G.status})`)),r.Ay.createElement("div",{className:ie.stars},r.Ay.createElement("span",{className:(0,o.A)(ie.amount,B)},(0,O.hk)(E,m)),m.currency===N.OUy&&r.Ay.createElement(K.A,{className:ie.star,type:"gold",size:"adaptive"}),m.currency===N.ykW&&r.Ay.createElement(p.A,{name:"toncoin",className:B})))}),oe=["all","inbound","outbound"],le=["StarsTransactionsAll","StarsTransactionsIncoming","StarsTransactionsOutgoing"],ce="StarsTransactionItem",me=(0,r.ph)((0,n.EK)((e,{modal:t})=>({shouldForceHeight:t?.currency===N.ykW?Boolean(e.ton?.history?.all?.transactions.length):Boolean(e.stars?.history?.all?.transactions.length),starsBalanceState:e.stars,tonBalanceState:e.ton,canBuyPremium:!(0,s.n_C)(e),tonUsdRate:e.appConfig?.tonUsdRate||N.kgD,tonTopupUrl:e.appConfig?.tonTopupUrl||N.BJU,animationLevel:(0,B.l)(e).animationLevel}))(({modal:e,starsBalanceState:t,tonBalanceState:a,canBuyPremium:m,shouldForceHeight:A,tonUsdRate:E,tonTopupUrl:b,animationLevel:S})=>{const{closeStarsBalanceModal:v,loadStarsTransactions:C,loadStarsSubscriptions:I,openStarsGiftingPickerModal:G,openInvoice:P,openUrl:w}=(0,n.ko)(),B=e?.currency||N.OUy,O=B===N.ykW?a:t,{balance:L,history:K}=O||{},{subscriptions:H}=B===N.OUy&&t||{},q=(0,u.A)(),J=(0,U.A)(),[W,j]=(0,r.J0)(!0),[Q,X]=(0,r.J0)(0),[Y,$,Z]=(0,T.A)(),ee=Boolean(e&&(t||a)),{originStarsPayment:te,originReaction:ae,originGift:re,topup:ne}=e||{},ie=te||ae||re||ne,me=te?.form?.invoice?.totalAmount||te?.subscriptionInfo?.subscriptionPricing?.amount||ae?.amount||re?.gift.stars||ne?.balanceNeeded,de=me?me-(L?.amount||0):void 0,ue=(0,r.Kr)(()=>{const e=(0,n.mS)();if(ae){const t=(0,s.hds)(e,ae.chatId);if(!t)return;return q("StarsNeededTextReactions",(0,k.Js)(q,t))}if(te){const t=te.form?.botId?(0,s.mBe)(e,te.form.botId):void 0;if(!t)return;return q("StarsNeededText",(0,k.Yg)(t))}if(re){const t=(0,s.mBe)(e,re.peerId);if(!t)return;return q("StarsNeededTextGift",(0,i.F9)(J,t))}return"subs"===ne?.purpose?q("StarsNeededTextLink"):ne?.purpose===N.D3m?J("StarsNeededTextSendPaidMessages",void 0,{withMarkdown:!0,withNodes:!0}):void 0},[ae,te,re,ne?.purpose,J,q]),Ae=Boolean(K?.all?.transactions.length&&!ie),pe=!ie,fe=(0,r.Kr)(()=>{const e=K?.all?.transactions.length||0;return 1==e?"35.5rem":2==e?"39.25rem":3==e?"43rem":"45rem"},[K?.all?.transactions.length]),ye=(0,r.Kr)(()=>le.map(e=>({title:J(e)})),[J]);(0,r.vJ)(()=>{ee||(j(!0),X(0),Z())},[ee]),(0,r.vJ)(()=>{ie?$():Z()},[ie]);const ge=(0,r.Kr)(()=>{if(!ee)return;const e=q("lng_credits_summary_options_about").split("{link}");return[e[0],r.Ay.createElement(f.A,{url:q("StarsTOSLink"),text:q("lng_credits_summary_options_about_link")}),e[1]]},[ee,q]),he=(0,d.A)(()=>{C({type:oe[Q],isTon:B===N.ykW})}),Ee=(0,d.A)(()=>{I()}),be=(0,d.A)(()=>{G({})}),Se=(0,d.A)(e=>{P({type:"stars",stars:e.stars,currency:e.currency,amount:e.amount})}),ve=(0,d.A)(()=>{w({url:b,shouldSkipModal:!0})});return r.Ay.createElement(g.A,{className:(0,o.A)(V.root,!A&&!Y&&V.minimal),isOpen:ee,onClose:v,dialogStyle:`--modal-height: ${fe}`},r.Ay.createElement("div",{className:(0,o.A)(V.main,"custom-scroll"),onScroll:function(e){const{scrollTop:t}=e.currentTarget;j(t<=150)}},r.Ay.createElement(y.A,{round:!0,size:"smaller",className:V.closeButton,color:"translucent",onClick:()=>v(),ariaLabel:J("Close")},r.Ay.createElement(p.A,{name:"close"})),B!==N.ykW&&r.Ay.createElement(z,{balance:L,className:V.modalBalance}),r.Ay.createElement("div",{className:(0,o.A)(V.header,W&&V.hiddenHeader)},r.Ay.createElement("h2",{className:V.starHeaderText},q("TelegramStars"))),r.Ay.createElement("div",{className:V.section},B===N.ykW?(()=>{const e=(0,l.UL)(L?.amount||0,N.ykW);return r.Ay.createElement(r.Ay.Fragment,null,r.Ay.createElement(F.A,{model:"speeding-diamond",color:"blue",title:J("CurrencyTon"),description:J("DescriptionAboutTon"),isDisabled:!ee}),r.Ay.createElement("div",{className:V.tonBalanceContainer},r.Ay.createElement("div",{className:V.tonBalance},r.Ay.createElement(p.A,{name:"toncoin",className:V.tonIconBalance}),e),Boolean(E)&&r.Ay.createElement("span",{className:V.tonInUsd},`≈ ${(0,l.Ad)((0,l.C)(L?.amount||0,E,!0),"USD",J.code)}`)),r.Ay.createElement(y.A,{className:V.topUpButton,onClick:ve,fluid:!0},J("ButtonTopUpViaFragment")))})():r.Ay.createElement(r.Ay.Fragment,null,r.Ay.createElement(F.A,{model:"swaying-star",color:"gold",title:de?q("StarsNeededTitle",me):q("TelegramStars"),description:(0,c.A)(ue||q("TelegramStarsInfo"),["simple_markdown","emoji"]),isDisabled:!ee}),m&&!Y&&r.Ay.createElement(y.A,{className:V.starButton,onClick:$,fluid:!0},q("Star.List.BuyMoreStars")),m&&!Y&&pe&&r.Ay.createElement(y.A,{isText:!0,noForcedUpperCase:!0,className:V.starButton,fluid:!0,onClick:be},q("TelegramStarsGift")),Y&&t?.topupOptions&&r.Ay.createElement(h.A,{starsNeeded:de,options:t.topupOptions,onClick:Se}))),Y&&r.Ay.createElement("div",{className:V.tos},ge),B===N.ykW&&r.Ay.createElement("div",{className:V.hint},J("TonModalHint")),Ae&&Boolean(H?.list.length)&&r.Ay.createElement("div",{className:V.section},r.Ay.createElement("h3",{className:V.sectionTitle},q("StarMySubscriptions")),r.Ay.createElement("div",{className:V.subscriptions},H?.list.map(e=>r.Ay.createElement(_,{key:e.id,subscription:e})),H?.nextOffset&&r.Ay.createElement(y.A,{isText:!0,disabled:H.isLoading,size:"smaller",noForcedUpperCase:!0,className:V.loadMore,onClick:Ee},r.Ay.createElement(p.A,{name:"down",className:V.loadMoreIcon}),q("StarMySubscriptionsExpand")))),Ae&&r.Ay.createElement("div",{className:V.container},r.Ay.createElement("div",{className:V.lastSection},r.Ay.createElement(D.Ay,{name:(0,M.P)("slideOptimized",S,void 0,J.isRtl),activeKey:Q,renderCount:le.length,shouldRestoreHeight:!0,className:V.transition},r.Ay.createElement(R.A,{onLoadMore:he,items:K?.[oe[Q]]?.transactions,scrollContainerClosest:`.${V.main}`,itemSelector:`.${ce}`,className:V.transactions,noFastList:!0,noScrollRestoreOnTop:!0},K?.[oe[Q]]?.transactions.map(e=>r.Ay.createElement(se,{key:`${e.id}-${e.isRefund}`,transaction:e,className:ce}))))),r.Ay.createElement(x.A,{className:V.tabs,tabClassName:V.tab,activeTab:Q,tabs:ye,onSwitchTab:X}))))}));var de=a(48775),ue=a(29886),Ae=a(84991),pe=a(10187);const fe=(0,r.ph)((0,n.EK)((e,{modal:t})=>{const a=t?.form?.botId?(0,s.mBe)(e,t.form.botId):void 0,r="message"===t?.inputInvoice?.type?t.inputInvoice:void 0,n=r?(0,s.O5q)(e,r.chatId,r.messageId):void 0,i=r?(0,s.hds)(e,r.chatId):void 0,o=n?.content.paidMedia;return{bot:a,starsBalanceState:e.stars,paidMediaMessage:o?n:void 0,paidMediaChat:o?i:void 0}})(({modal:e,bot:t,starsBalanceState:a,paidMediaMessage:i,paidMediaChat:s})=>{const{closeStarsPaymentModal:l,openStarsBalanceModal:m,sendStarPaymentForm:p}=(0,n.ko)(),[h,E,b]=(0,T.A)(),v=Boolean(e?.inputInvoice&&a),N=(0,ue.A)(e),C=e||N,{form:I,subscriptionInfo:G}=C||{},P=I?.invoice?.totalAmount||G?.subscriptionPricing?.amount,w=Boolean(I?.invoice.subscriptionPeriod),B=!G?.subscriptionPricing,M=I?.photo,R=(0,u.A)(),x=(0,U.A)();(0,r.vJ)(()=>{v||b()},[v]);const D=(0,r.Kr)(()=>{if(!C?.inputInvoice)return"";const e=(0,k.Yg)(t),a=R("Stars.Intro.PurchasedText.Stars",P);if(i){const e=i.content.paidMedia.extendedMedia,t=e.every(e=>!e.duration),r=e.every(e=>Boolean(e.duration)),n=R(t?"Stars.Transfer.Photos":r?"Stars.Transfer.Videos":"Media",e.length),o=(0,k.Js)(R,s);return R("Stars.Transfer.UnlockInfo",[n,o,a])}return G?x("StarsSubscribeText",{chat:G.title,amount:P},{withNodes:!0,withMarkdown:!0,pluralValue:P}):w?x("StarsSubscribeBotText",{name:I.title,amount:P,bot:e},{pluralValue:P}):R("Stars.Transfer.Info",[I.title,e,a])},[C?.inputInvoice,t,R,P,i,G,w,I,s,x]),F=(0,r.Kr)(()=>{if(G)return x("StarsSubscribeInfo",{link:r.Ay.createElement(f.A,{url:x("StarsSubscribeInfoLink"),text:x("StarsSubscribeInfoLinkText")})},{withNodes:!0})},[G,x]),O=(0,r.Kr)(()=>{if(G)return(0,k.nr)(G)},[G]),L=(0,d.A)(()=>{const t=a?.balance;void 0!==P&&void 0!==t&&(P>t.amount?m({originStarsPayment:e}):(p({}),E()))});return r.Ay.createElement(g.A,{contentClassName:V.paymentContent,isOpen:v,hasAbsoluteCloseButton:!0,isSlim:!0,onClose:l},r.Ay.createElement(z,{balance:a?.balance,className:V.modalBalance}),r.Ay.createElement("div",{className:V.paymentImages,dir:R.isRtl?"ltr":"rtl"},i?r.Ay.createElement(ne,{media:i.content.paidMedia.extendedMedia}):O?r.Ay.createElement(r.Ay.Fragment,null,r.Ay.createElement(A.A,{className:V.paymentPhoto,peer:O,size:"giant"}),r.Ay.createElement(K.A,{type:"gold",size:"adaptive",className:V.avatarStar})):r.Ay.createElement(Ae.A,{peer:M?void 0:t,avatarWebPhoto:M,avatarSize:"giant",badgeIcon:"star",badgeText:(0,q.Sm)(P),badgeClassName:V.amountBadge,className:V.paymentPhoto}),r.Ay.createElement("img",{className:V.paymentImageBackground,src:S,alt:"",draggable:!1})),r.Ay.createElement("h2",{className:V.headerText},R(O?"StarsSubscribeTitle":"StarsConfirmPurchaseTitle")),B&&r.Ay.createElement(pe.A,{className:V.botItem,peerId:I?.botId}),r.Ay.createElement("div",{className:V.description},(0,c.A)(D,["simple_markdown","emoji"])),r.Ay.createElement(y.A,{className:V.paymentButton,size:"smaller",onClick:L,isLoading:h},x(w?"StarsSubscribeBotButtonMonth":"StarsPay",{amount:(0,de.U2)(x,P,{asFont:!0})},{withNodes:!0})),Boolean(F)&&r.Ay.createElement("div",{className:(0,o.A)(V.disclaimer,V.smallerText)},F))}));var ye=a(89925),ge=a(85982),he=a(97040),Ee=a(70046),be=a(96454),Se=a(95807),ve=a(537);const Ne=(0,r.ph)(({modelAttribute:e,backdropAttribute:t,patternAttribute:a,title:i,subtitle:s,subtitlePeer:l,className:c,resellPrice:m})=>{const{openChat:d}=(0,n.ko)(),u=(0,U.A)(),[A,f,y]=(0,T.A)(),g=(0,ve.A)([e,t,a]),h=t?.textColor,E=(0,r.Kr)(()=>{const e=[t.centerColor,t.edgeColor],n=t.patternColor;return r.Ay.createElement(Z.A,{className:"UvhsGZLf",backgroundColors:e,patternColor:n,patternIcon:a.sticker})},[t,a]);return r.Ay.createElement("div",{className:(0,o.A)("irv1C8bo",c)},r.Ay.createElement(D.Ay,{className:"Tu6_OHoq",slideClassName:(0,o.A)("interactive-gift","iUTKLzTN"),activeKey:g,direction:1,name:"zoomBounceSemiFade"},E,r.Ay.createElement($.A,{className:"a1ASgPwu",sticker:e.sticker,size:120,noLoop:!A,onMouseEnter:be.TF?void 0:f,onMouseLeave:be.TF?void 0:y})),i&&r.Ay.createElement("h1",{className:"ECTvfOda"},i),Boolean(s)&&r.Ay.createElement("div",{className:(0,o.A)("S6JwvHWD",l&&"V7kDVPLm"),style:(0,Se.A)(h&&`color: ${h}`),onClick:()=>{l&&d({id:l.id})}},s),m&&r.Ay.createElement("p",{className:"zTVWZg63"},r.Ay.createElement("span",null,(0,O.hk)(u,m)),"XTR"===m.currency&&r.Ay.createElement(K.A,{type:"gold",size:"middle"}),"TON"===m.currency&&r.Ay.createElement(p.A,{name:"toncoin"})))}),ke="qBOIq6Jn",Ce="sso9uZM6",Ie="NuWOY7ED",Ge=[0,-50],Pe=(0,r.ph)((0,n.EK)((e,{modal:t})=>{const a="peer"===t?.transaction?.peer?.type&&t.transaction.peer.id,r=a?(0,s.PVB)(e,a):void 0,n=e.appConfig?.starsPaidMessageCommissionPermille,i=t?.transaction.amount,o=t?.transaction.isGift?i?.currency===N.OUy?(0,s.WLj)(e,i?.amount):(0,s.OD9)(e,i?.amount):void 0;return{peer:r,canPlayAnimatedEmojis:(0,s.BWX)(e),topSticker:o,paidMessageCommission:n}})(({modal:e,peer:t,canPlayAnimatedEmojis:a,topSticker:i,paidMessageCommission:s})=>{const{showNotification:l,openMediaViewer:c,closeStarsTransactionModal:m}=(0,n.ko)(),y=(0,U.A)(),g=(0,u.A)(),{transaction:h}=e||{},E=(0,r.li)(),b=(0,d.A)(()=>{const e=h?.extendedMedia;e&&c({origin:ye.TQ.StarsTransaction,standaloneMedia:e.flatMap(e=>Object.values(e))})}),S=(0,d.A)(()=>{E.current?.()}),v=(0,d.A)(e=>{E.current=e}),C=(0,r.Kr)(()=>{if(!h)return;const{giveawayPostId:e,photo:n,amount:c,isGiftUpgrade:m,starGift:d,isGiftResale:u,starRefCommision:E}=h,C=h?.starGift,I="starGiftUnique"===C?.type,G=h?.starGift?(0,Q.yQ)(h.starGift):i,P=I?(0,Q.uc)(C):void 0,w=h.peer&&(0,O.MA)(h)&&(0,O.Pc)(h)||void 0,B="peer"===h.peer?.type?h.peer.id:void 0,M=h.peer&&g(function(e){switch(e.type){case"appStore":return"AppStore";case"playMarket":return"PlayMarket";case"fragment":return"Fragment";case"premiumBot":return"StarsTransactionBot";case"ads":return"StarsTransactionAds";case"api":return"Stars.Intro.Transaction.TelegramBotApi.Subtitle";default:return"Stars.Transaction.Unsupported.Title"}}(h.peer)),T=X(g,y,h),U=t&&h.messageId&&!m?(0,k.yt)(t,void 0,h.messageId):void 0,R=t&&e?(0,k.yt)(t,void 0,e):void 0,x=h.extendedMedia,D=x?.length||0,F=x?.every(e=>!e.video),L=x?.every(e=>!e.photo),V=g(F?"Stars.Transfer.Photos":L?"Stars.Transfer.Videos":"Media",D),z=h.description||(m&&"starGiftUnique"===d?.type?d.title:void 0)||(x?V:void 0),J=!x&&!G&&!h.isPostsSearch,W=n?void 0:!(0,O.MA)(h)&&t||w,_=I&&r.Ay.createElement("div",{className:(0,o.A)(ke,"ApoQz22o")},r.Ay.createElement(Ne,{backdropAttribute:P.backdrop,patternAttribute:P.pattern,modelAttribute:P.model,title:C.title,subtitle:y("GiftInfoCollectible",{number:C.number}),resellPrice:h.amount})),j=Y(c)?"xDyq9cc0":"jvBZSrpd",Z=r.Ay.createElement("div",{className:ke},x&&r.Ay.createElement(ne,{className:(0,o.A)("C5r59yiV","transaction-media-preview"),media:x,onClick:b}),!x&&G&&r.Ay.createElement($.A,{key:h.id,sticker:G,play:a,noLoop:!0}),J&&r.Ay.createElement(A.A,{className:"hcrszlpT",peer:W,webPhoto:n,size:"giant",onMouseMove:S}),!G&&!h.isPostsSearch&&r.Ay.createElement(he.A,{className:(0,o.A)("nML8IQqX"),color:"gold",onRequestAnimation:v,centerShift:Ge}),Boolean(T)&&r.Ay.createElement("h1",{className:"ZZAj3hj7"},T),r.Ay.createElement("p",{className:Ie},z),r.Ay.createElement("p",{className:Ce},r.Ay.createElement("span",{className:(0,o.A)(Ce,j)},(0,O.hk)(y,c)),c.currency===N.OUy&&r.Ay.createElement(K.A,{type:"gold",size:"middle"}),"TON"===c.currency&&r.Ay.createElement(p.A,{name:"toncoin",className:j}),h.isRefund&&r.Ay.createElement("p",{className:"sxWAwxTd"},y("Refunded"))),Boolean(h.paidMessages&&h.starRefCommision&&s)&&r.Ay.createElement("p",{className:Ie},y("PaidMessageTransactionDescription",{percent:(0,q.l9)(s/10)},{withNodes:!0,withMarkdown:!0}))),ee=[];let te;h&&E&&!h.paidMessages&&!u&&ee.push([g("StarsTransaction.StarRefReason.Title"),g("StarsTransaction.StarRefReason.Program")]),m&&ee.push([g("StarGiftReason"),g("StarGiftReasonUpgrade")]),u&&ee.push([g("StarGiftReason"),Y(h.amount)?y("StarGiftSaleTransaction"):y("StarGiftPurchaseTransaction")]),te=m?g("Stars.Transaction.GiftFrom"):Y(c)||h.isMyGift?g("Stars.Transaction.To"):!h.starRefCommision||h.paidMessages||u?g(B?"Star.Transaction.From":"Stars.Transaction.Via"):g("StarsTransaction.StarRefReason.Miniapp"),h.isPostsSearch||ee.push([te,B?{chatId:B}:M||""]),h.starRefCommision&&h.paidMessages&&ee.push([y("PaidMessageTransactionTotal"),(0,de.U2)(y,h.amount.amount/((100-h.starRefCommision)/100),{asFont:!1,className:"cU5QlvwL",containerClassName:"Z2YALGgl"})]),U&&ee.push([g("Stars.Transaction.Reaction.Post"),r.Ay.createElement(f.A,{url:U,text:U})]),R&&h.amount.currency===N.OUy&&(ee.push([g("BoostReason"),r.Ay.createElement(f.A,{url:R,text:g("Giveaway")})]),ee.push([g("Gift"),g("Stars",h.amount,"i")])),h.id&&ee.push([g("Stars.Transaction.Id"),r.Ay.createElement(r.Ay.Fragment,null,r.Ay.createElement("div",{className:"tMF8VIOM",onClick:()=>{(0,ge.eM)(h.id),l({message:g("StarsTransactionIDCopied")})}},h.id),r.Ay.createElement(p.A,{className:"voCttFzS",name:"copy"}))]),ee.push([g("Stars.Transaction.Date"),(0,H.L2)(1e3*h.date,g.code,!0)]);const ae=g("lng_credits_box_out_about").split("{link}");return{header:I?_:Z,tableData:ee,footer:r.Ay.createElement("span",{className:"KgzPpgS6"},ae[0],r.Ay.createElement(f.A,{url:g("StarsTOSLink"),text:g("lng_credits_summary_options_about_link")}),ae[1])}},[h,g,y,t,a,i,s,v]),I=(0,ue.A)(C)||C;return r.Ay.createElement(Ee.A,{isOpen:Boolean(h),className:"IzhfRIWu",hasBackdrop:"starGiftUnique"===h?.starGift?.type,header:I?.header,tableData:I?.tableData,footer:I?.footer,buttonText:g("OK"),onClose:m})})),we="oBLHWBtJ",Be=[0,-50],Me=(0,r.ph)((0,n.EK)((e,{modal:t})=>{const a=t?.subscription.peerId;return{peer:a?(0,s.PVB)(e,a):void 0}})(({modal:e,peer:t})=>{const{closeStarsSubscriptionModal:a,fulfillStarsSubscription:s,changeStarsSubscription:l,checkChatInvite:c,loadStarStatus:m,openInvoice:p}=(0,n.ko)(),g=(0,u.A)(),h=(0,U.A)(),{subscription:E}=e||{},b=(0,r.li)(),S=(0,d.A)(()=>{b.current?.()}),v=(0,d.A)(e=>{b.current=e}),k=(0,r.Kr)(()=>{if(!E)return"hidden";if(E.canRefulfill)return"refulfill";const e=E.until>Date.now()/1e3;if(e&&!E.isCancelled)return"cancel";if(e&&E.isCancelled)return"renew";const t=E.chatInviteHash||E.invoiceSlug;return!e&&t?"restart":"ok"},[E]),C=(0,d.A)(()=>{if(E){switch(k){case"refulfill":s({id:E.id});break;case"restart":E.chatInviteHash?c({hash:E.chatInviteHash}):E.invoiceSlug&&p({type:"slug",slug:E.invoiceSlug}),m();break;case"renew":l({id:E.id,isCancelled:!1});break;case"cancel":l({id:E.id,isCancelled:!0})}a()}}),I=(0,r.Kr)(()=>{if(!E||!t)return;const{pricing:e,until:a,isCancelled:n,canRefulfill:s,photo:l,title:c,hasBotCancelled:m}=E,d=(0,i.mO)(t),u=r.Ay.createElement("div",{className:"E3R22yAI"},r.Ay.createElement("div",{className:"wuTMXDP9"},r.Ay.createElement(A.A,{peer:l?void 0:t,webPhoto:l,size:"giant",onMouseMove:S}),r.Ay.createElement(K.A,{className:"enRetSny",type:"gold",size:"adaptive"})),r.Ay.createElement(he.A,{className:(0,o.A)("zGCayu45"),color:"gold",onRequestAnimation:v,centerShift:Be}),r.Ay.createElement("h1",{className:"qdydQHgc"},c||g("StarsSubscriptionTitle")),r.Ay.createElement("p",{className:"FI6rEJlK"},h("StarsPerMonth",{amount:e.amount},{withNodes:!0,specialReplacement:{[N.Cyx]:r.Ay.createElement(K.A,{className:"J8HIcN6k",size:"adaptive",type:"gold"})}}))),p=[];p.push([g(d?"StarsSubscriptionBot":"StarsSubscriptionChannel"),{chatId:t.id}]),c&&p.push([g("StarsSubscriptionBotProduct"),c]);const b=a<Date.now()/1e3;p.push([g(b?"StarsSubscriptionUntilExpired":n?"StarsSubscriptionUntilExpires":"StarsSubscriptionUntilRenews"),(0,H.L2)(1e3*a,g.code,!0)]);const I=h("StarsTransactionTOS",{link:r.Ay.createElement(f.A,{url:h("StarsTransactionTOSLink"),text:h("StarsTransactionTOSLinkText")})},{withNodes:!0});return{header:u,tableData:p,footer:r.Ay.createElement("span",{className:"GMWMuWCr"},r.Ay.createElement("p",{className:we},I),n&&r.Ay.createElement("p",{className:"nkwiG25Q"},g(m?"StarsSubscriptionBotCancelledText":"StarsSubscriptionCancelledText")),s&&r.Ay.createElement("p",{className:we},g("StarsSubscriptionRefulfillInfo",(0,H.L2)(1e3*a,g.code,!0))),!n&&!s&&b&&r.Ay.createElement("p",{className:we},g("StarsSubscriptionExpiredInfo",(0,H.L2)(1e3*a,g.code,!0))),!n&&!s&&!b&&r.Ay.createElement("p",{className:we},g("StarsSubscriptionCancelInfo",(0,H.L2)(1e3*a,g.code,!0))),"hidden"!==k&&r.Ay.createElement(y.A,{size:"smaller",color:"cancel"===k?"danger":"primary",isText:"cancel"===k,onClick:C},g("cancel"===k?"StarsSubscriptionCancel":"refulfill"===k?"StarsSubscriptionRefulfill":"restart"===k?"StarsSubscriptionAgain":"renew"===k?"StarsSubscriptionRenew":"OK")))}},[k,h,g,t,E]),G=(0,ue.A)(I)||I;return r.Ay.createElement(Ee.A,{isOpen:Boolean(E),className:"eR_RZfGB",header:G?.header,tableData:G?.tableData,footer:G?.footer,onClose:a})}));var Te=a(43874),Ue=a(34431),Re=a(19806),xe=a(22699),De=a(24433),Fe=a(32581),Oe=a(66644),Le=a(15283),Ke=a(93545),Ve=a(68292),ze=a(85118);const He={root:"CuBAw2yg",slider:"euOOAbZi",sparkles:"_L1YQTIP",progress:"kwK0cNPX",floatingBadgeWrapper:"uvlMoXj0",floatingBadge:"BGSDWAYc",floatingBadgeText:"qqQan8uF",floatingBadgeTriangle:"mIdJOmsB"},qe=[50,100,500,1e3,2e3,5e3,1e4];function Je(e,t){const a=e.findIndex(e=>t<=e),r=e[a-1]||1,n=e[a]||e[e.length-1];return a+(t-r)/(n-r)}function We(e,t){const a=Math.floor(t),r=e[a-1]||1,n=r+((e[a]||e[e.length-1])-r)*(t-a);return Math.round(n)}const _e=(0,r.ph)(({maxValue:e,defaultValue:t,className:a,onChange:n})=>{const i=(0,r.li)(),s=(0,r.Kr)(()=>{const t=[];for(let a=0;a<qe.length;a++)if(qe[a]<e&&t.push(qe[a]),qe[a]>=e){t.push(e);break}return t},[e]),[l,c]=(0,r.J0)(0);(0,Le.A)(()=>{c(Je(s,t))});const m=(0,d.A)(()=>{const e=i.current;if(!e)return;const t=e.parentElement;(0,Oe.YS)(()=>{const a=t.offsetLeft+e.offsetWidth/2,r=t.offsetLeft+t.offsetWidth-e.offsetWidth/2;(0,Oe.RK)(()=>{t.style.setProperty("--_min-x",`${a}px`),t.style.setProperty("--_max-x",`${r}px`)})})});(0,Ke.A)(i,m);const u=(0,d.A)(e=>{const t=Number(e.currentTarget.value);c(t),n(We(s,t))});return r.Ay.createElement("div",{className:(0,o.A)(He.root,a),style:"--progress: "+l/s.length},r.Ay.createElement("div",{className:He.floatingBadgeWrapper},r.Ay.createElement("div",{className:He.floatingBadge,ref:i},r.Ay.createElement("div",{className:He.floatingBadgeText},r.Ay.createElement(p.A,{name:"star",className:He.floatingBadgeIcon}),r.Ay.createElement(Ve.A,{text:(0,q.Sm)(We(s,l))})),r.Ay.createElement("svg",{className:He.floatingBadgeTriangle,width:"28",height:"28",viewBox:"0 0 28 28",fill:"none"},r.Ay.createElement("defs",null,r.Ay.createElement("linearGradient",{id:"StarBadgeTriangle",x1:"0",x2:"1",y1:"0",y2:"0"},r.Ay.createElement("stop",{offset:"-50%","stop-color":"#FFAA00"}),r.Ay.createElement("stop",{offset:"150%","stop-color":"#FFCD3A"}))),r.Ay.createElement("path",{d:"m 28,4 v 9 c 0.0089,7.283278 -3.302215,5.319646 -6.750951,8.589815 l -5.8284,5.82843 c -0.781,0.78105 -2.0474,0.78104 -2.8284,0 L 6.7638083,21.589815 C 2.8288652,17.959047 0.04527024,20.332086 0,13 V 4 C 0,4 0.00150581,0.97697493 3,1 5.3786658,1.018266 22.594519,0.9142007 25,1 c 2.992326,0.1067311 3,3 3,3 z",fill:"url(#StarBadgeTriangle)"})))),r.Ay.createElement("div",{className:He.progress},r.Ay.createElement(ze.A,{preset:"progress",className:He.sparkles})),r.Ay.createElement("input",{className:He.slider,type:"range",min:0,max:s.length,defaultValue:Je(s,t),step:"any",onChange:u}))}),je={content:"RdhRpsCn",title:"yzbjj73U",slider:"xePPMXOI",description:"BlpfdOtK",itemInfo:"nS9V516D",itemTitle:"sH5Nukjy",itemSubtitle:"dHlNODTI",itemIcon:"H_iHihXU",sendAsPeerButtonAvatar:"_mjvLELm",sendAsPeerMenuButton:"zxsRaWYV",buttonDownIcon:"zrwUUELS",sendAsPeerMenuBubble:"X1PB6mhQ",sendAsPeerMenu:"Px1MDij9",sendAsPeersMenuContainer:"Al1nfhHJ",headerControlPanel:"vu90kSL_",separator:"uhQLUjmo",checkBox:"Mc3bVeF0",topLabel:"bnou4CpV",top:"QludQDKR",topBadge:"JBF9pTUK",buttonStar:"NJJFuym9",topPeer:"Ty4Ud_Rd",disclaimer:"KRvkHeo1"},Qe={avatarIcon:"author-hidden",customPeerAvatarColor:"#9eaab5",isCustomPeer:!0,titleKey:"StarsReactionAnonymous"},Xe=(0,r.ph)((0,n.EK)((e,{modal:t})=>{const a=t&&(0,s.hds)(e,t.chatId),r=t&&(0,s.O5q)(e,t.chatId,t.messageId),n=e.stars?.balance,i=e.appConfig?.paidReactionMaxAmount||2500,o=e.settings.paidReactionPrivacy,l=a?.sendPaidReactionsAsPeerIds,c=e.currentUserId;return{chat:a,message:r,starBalance:n,maxAmount:i,defaultPrivacy:o,sendPaidReactionsAsPeerIds:l,currentUserId:c,currentUser:(0,s.mBe)(e,c)}})(({modal:e,chat:t,message:a,maxAmount:l,starBalance:m,defaultPrivacy:h,sendPaidReactionsAsPeerIds:E,currentUserId:b,currentUser:S})=>{const{closePaidReactionModal:v,addLocalPaidReaction:k,loadSendPaidReactionsAs:C}=(0,n.ko)(),[I,G]=(0,r.J0)(50),[P,w,B]=(0,T.A)(),[M,R]=(0,r.J0)(!0),[x,D]=(0,r.J0)(b),F=t?.id,O=x?(0,s.PVB)((0,n.mS)(),x):S,L=(0,u.A)(),{isMobile:K}=(0,Te.Ay)(),V=(0,U.A)(),H=(0,d.A)(e=>{R(!e.target.checked)}),J=(0,d.A)(e=>{G(e),w()});(0,r.vJ)(()=>{F&&!E&&C({chatId:F})},[F,E]);const W=(0,r.Kr)(()=>{const e=E?.map(e=>e.id).filter(e=>e!==F);return e?.unshift(b),e},[E,F,b]),_=W&&W.length>1;(0,r.vJ)(()=>{e||B()},[e]),(0,r.vJ)(()=>{const e=a?.reactions?.topReactors?.find(e=>e.isMy);if(e)return R(Boolean(e.isAnonymous)),void(e.peerId&&D(e.peerId));R("anonymous"===h?.type||!1),"peer"===h?.type&&W?.includes(h.peerId)?D(h.peerId):D(b)},[h,a?.reactions?.topReactors,W,b]);const j=(0,d.A)(()=>{e&&(k({chatId:e.chatId,messageId:e.messageId,count:I,isPrivate:M,peerId:M||x===b?void 0:x,shouldIgnoreDefaultPrivacy:!0}),v())}),Q=(0,d.A)(e=>{R(!1),D(e)}),X=(0,d.A)(e=>{const t=(0,s.PVB)((0,n.mS)(),e),a=x===e&&!M;if(t)return r.Ay.createElement(De.A,{onClick:()=>Q(e)},r.Ay.createElement(A.A,{size:"small",peer:t}),r.Ay.createElement("div",{className:(0,o.A)(je.itemInfo)},r.Ay.createElement(Ue.A,{className:je.itemTitle,peer:t,noFake:!0,noVerified:!0}),r.Ay.createElement("span",{className:je.itemSubtitle},(0,i.mO)(t)?V("PeerPersonalAccount"):V("PeerChannel"))),r.Ay.createElement(p.A,{className:je.itemIcon,name:a?"check":"placeholder"}))}),Y=(0,r.Kr)(()=>({onTrigger:e,isOpen:t})=>r.Ay.createElement(y.A,{ripple:!K,size:"smaller",color:"translucent",className:(0,o.A)(je.sendAsPeerMenuButton,t?"active":""),onClick:e,ariaLabel:V("AccDescrOpenMenu2")},r.Ay.createElement(A.A,{className:je.sendAsPeerButtonAvatar,size:"mini",peer:M?Qe:O}),r.Ay.createElement(p.A,{name:"down",className:je.buttonDownIcon})),[K,V,O,M]),$=(0,r.Kr)(()=>{if(_)return r.Ay.createElement(xe.A,{className:(0,o.A)(je.sendAsPeerMenu,"with-menu-transitions"),bubbleClassName:je.sendAsPeerMenuBubble,trigger:Y,positionX:"right",autoClose:!0},W.map(e=>X(e)))},[Y,W,_]),Z=(0,r.Kr)(()=>{const e=(0,n.mS)(),t=a?.reactions?.topReactors;if(!t)return;const r=[];let i=!1,o=0;if(t.forEach(t=>{const a=t.peerId?(0,s.PVB)(e,t.peerId):void 0;if(!a&&!t.isAnonymous&&!t.isMy)return;if(t.isMy&&(o=t.count),t.isMy&&(t.peerId!==x||t.isAnonymous&&!M))return;const n=x===t.peerId||M&&t.isAnonymous;n&&(i=!0),r.push({amount:t.count,localAmount:n&&P?I:0,isMy:t.isMy,isAnonymous:t.isAnonymous,user:a})}),!i){const t=(0,s.PVB)(e,x);r.push({amount:o,localAmount:P?I:0,isMy:!0,user:t})}return r.sort((e,t)=>t.amount+t.localAmount-(e.amount+e.localAmount)),r.slice(0,3)},[P,a?.reactions?.topReactors,I,x,M]),ee=t&&(0,i.F9)(L,t);return r.Ay.createElement(g.A,{isOpen:Boolean(e),onClose:v,isSlim:!0,hasAbsoluteCloseButton:!0,contentClassName:je.content,isLowStackPriority:!0},r.Ay.createElement("div",{className:je.sendAsPeersMenuContainer},$),r.Ay.createElement("div",{className:je.headerControlPanel},r.Ay.createElement(z,{balance:m,className:je.modalBalance,withAddButton:!0})),r.Ay.createElement(_e,{className:je.slider,defaultValue:50,maxValue:l,onChange:J}),r.Ay.createElement("h3",{className:je.title},L("StarsReactionTitle")),r.Ay.createElement("div",{className:je.description},(0,c.A)(L("StarsReactionText",ee),["simple_markdown","emoji"])),r.Ay.createElement(Fe.A,null,Z&&r.Ay.createElement("div",{className:je.topLabel},L("StarsReactionTopSenders"))),Z&&r.Ay.createElement("div",{className:je.top},Z.map(e=>{const t=(0,q.Sm)(e.amount+e.localAmount),a=e.isAnonymous||!e.user||e.isMy&&M?Qe:e.user,n="isCustomPeer"in a?L(a.titleKey):a&&(0,i.F9)(L,a);return r.Ay.createElement(Ae.A,{className:je.topPeer,key:`${e.user?.id||"anonymous"}-${t}`,peer:a,badgeText:t,badgeIcon:"star",badgeClassName:je.topBadge,text:n})})),Z&&r.Ay.createElement(Fe.A,{className:je.separator}),r.Ay.createElement(Re.A,{className:(0,o.A)(je.checkBox,"dialog-checkbox"),checked:!M,onChange:H,label:L("StarsReactionShowMeInTopSenders")}),r.Ay.createElement(y.A,{size:"smaller",onClick:j},V("SendPaidReaction",{amount:I},{withNodes:!0,specialReplacement:{[N.Cyx]:r.Ay.createElement(p.A,{className:je.buttonStar,name:"star"})}})),r.Ay.createElement("p",{className:je.disclaimer},V("StarsReactionTerms",{link:r.Ay.createElement(f.A,{text:V("StarsReactionLinkText"),url:V("StarsReactionLink")})},{withNodes:!0})))}));var Ye=a(37836),$e=a(5912),Ze=a(23174),et=a(65632),tt=a(20333),at=a(36143),rt=a(96530),nt=a(22720),it=a(63152),st=a(94079);const ot="zZUpGRSI",lt="zAee80Dv",ct="nTPAv1ci",mt=(0,r.ph)((0,n.EK)((e,{peerId:t})=>{const a=(0,s.SJA)(e),{stars:r}=e,{isBlurred:n,patternColor:i,background:o,backgroundColor:l}=(0,s.Gyz)(e,a)||{},c=(0,s.PVB)(e,t),m=(0,s.WA9)(e,t),d=(0,s.vGo)(e,t),u=e.currentUserId===t,A=!u&&d?.disallowedGifts?.shouldDisallowUniqueStarGifts,p=!u&&d?.disallowedGifts?.shouldDisallowLimitedStarGifts,f=(0,s.nTw)(e);return{starBalance:r?.balance,peer:c,theme:a,isBackgroundBlurred:n,patternColor:i,customBackground:o,backgroundColor:l,captionLimit:e.appConfig?.starGiftMaxMessageLength,currentUserId:e.currentUserId,isPaymentFormLoading:f.isPaymentFormLoading,paidMessagesStars:m,areUniqueStarGiftsDisallowed:A,shouldDisallowLimitedStarGifts:p}})(function({gift:e,giftByStars:t,peerId:a,peer:s,captionLimit:c,theme:m,isBackgroundBlurred:u,patternColor:A,backgroundColor:p,customBackground:f,currentUserId:g,isPaymentFormLoading:h,starBalance:E,paidMessagesStars:b,areUniqueStarGiftsDisallowed:S,shouldDisallowLimitedStarGifts:v}){const{sendStarGift:N,sendPremiumGiftByStars:k,openInvoice:C,openGiftUpgradeModal:I,openStarsBalanceModal:G}=(0,n.ko)(),P=(0,U.A)(),[w,B]=(0,r.J0)(""),[M,T]=(0,r.J0)(!1),[R,x]=(0,r.J0)(!1),[D,F]=(0,r.J0)(!1),O=(0,et.A)(m,f);(0,r.vJ)(()=>{v&&x(!0)},[v,R]);const L="id"in e&&"starGift"===e.type,K="months"in e,V=t&&"amount"in t,z=s&&(0,i.mO)(s),H=a===g,q=(0,r.Kr)(()=>{if(K){const a=D&&V?t:e;return{id:-1,chatId:"0",isOutgoing:!1,senderId:g,date:Math.floor(Date.now()/1e3),content:{action:{mediaType:"action",type:"giftPremium",amount:a.amount,currency:a.currency,months:e.months,message:w?{text:w}:void 0}}}}if(L)return{id:-1,chatId:"0",isOutgoing:!1,senderId:g,date:Math.floor(Date.now()/1e3),content:{action:{mediaType:"action",type:"starGift",message:w?.length?{text:w}:void 0,isNameHidden:M||void 0,starsToConvert:e.starsToConvert,canUpgrade:R||void 0,alreadyPaidUpgradeStars:R?e.upgradeStars:void 0,gift:e,peerId:a,fromId:g}}}},[g,e,w,L,M,R,a,D,V,t,K]),J=(0,d.A)(e=>{B(e.target.value)}),W=(0,d.A)(()=>{T(!M)}),_=(0,d.A)(()=>{x(!R)}),j=(0,d.A)(()=>{V&&F(!D)}),Q=(0,d.A)(()=>{L&&I({giftId:e.id,peerId:a})}),X=(0,d.A)(()=>{G({})}),Y=(0,d.A)(()=>{L?N({peerId:a,shouldHideName:M,gift:e,message:w?{text:w}:void 0,shouldUpgrade:R}):D&&V?k({userId:a,months:t.months,amount:t.amount,message:w?{text:w}:void 0}):K&&C({type:"giftcode",userIds:[a],currency:e.currency,amount:e.amount,option:e,message:w?{text:w}:void 0})}),$=V&&E&&E.amount>t.amount,Z=(0,o.A)("ZORVRSG3","soDpW2YR",f&&"Eny_G3JI",p&&"TkJZPU2u",f&&u&&"M6k91TdM");if((L||K)&&q)return r.Ay.createElement("div",{className:(0,o.A)("jKOG0It6","custom-scroll")},r.Ay.createElement("div",{className:(0,o.A)("CB1mxsgp","MessageList"),inert:!0,style:(0,Se.A)(`--pattern-color: ${A}`,p&&`--theme-background-color: ${p}`)},r.Ay.createElement("div",{className:Z,style:O?`--custom-background: ${O}`:void 0}),r.Ay.createElement(at.A,{key:L?e.id:K?e.months:void 0,message:q,threadId:Ze.l3,appearanceOrder:0})),function(){const a=c?c-w.length:void 0,n=(0,i.F9)(P,s);return r.Ay.createElement("div",{className:"Y68CEIKn"},!b&&r.Ay.createElement(st.A,{className:"o5r2IPoA",onChange:J,value:w,label:P("GiftMessagePlaceholder"),maxLength:c,maxLengthIndicator:a&&a<50?a.toString():void 0}),$&&r.Ay.createElement(nt.A,{className:ot,narrow:!0,ripple:!0,onClick:j},r.Ay.createElement("span",null,P("GiftPremiumPayWithStars",{stars:(0,de.U2)(P,t.amount,{className:lt})},{withNodes:!0})),r.Ay.createElement(it.A,{checked:D,onChange:j,label:P("GiftPremiumPayWithStarsAcc")})),V&&E&&r.Ay.createElement("div",{className:ct},P("GiftPremiumDescriptionYourBalance",{stars:(0,de.U2)(P,E.amount,{className:lt}),link:r.Ay.createElement(rt.A,{isPrimary:!0,onClick:X},P("GetMoreStarsLinkText"))},{withNodes:!0,withMarkdown:!0})),L&&Boolean(e.upgradeStars)&&!S&&r.Ay.createElement(nt.A,{className:ot,narrow:!0,ripple:!0,onClick:_,disabled:v},r.Ay.createElement("span",null,P("GiftMakeUnique",{stars:(0,de.U2)(P,e.upgradeStars,{className:lt})},{withNodes:!0})),r.Ay.createElement(it.A,{checked:R,onChange:_,label:P("GiftMakeUniqueAcc")})),L&&Boolean(e.upgradeStars)&&!S&&r.Ay.createElement("div",{className:ct},z?P("GiftMakeUniqueDescription",{user:n,link:r.Ay.createElement(rt.A,{isPrimary:!0,onClick:Q},P("GiftMakeUniqueLink"))},{withNodes:!0}):P("GiftMakeUniqueDescriptionChannel",{peer:n,link:r.Ay.createElement(rt.A,{isPrimary:!0,onClick:Q},P("GiftMakeUniqueLink"))},{withNodes:!0})),L&&r.Ay.createElement(nt.A,{className:ot,narrow:!0,ripple:!0,onClick:W},r.Ay.createElement("span",null,P("GiftHideMyName")),r.Ay.createElement(it.A,{checked:M,onChange:W,label:P("GiftHideMyName")})),L&&r.Ay.createElement("div",{className:ct},H?P("GiftHideNameDescriptionSelf"):z?P("GiftHideNameDescription",{receiver:n}):P("GiftHideNameDescriptionChannel")))}(),r.Ay.createElement("div",{className:"ATowWJ60"}),function(){const a=D&&V?(0,de.U2)(P,t.amount,{asFont:!0}):L?(0,de.U2)(P,e.stars+(R?e.upgradeStars:0),{asFont:!0}):K?(0,l.vv)(P,e.amount,e.currency):void 0;return r.Ay.createElement("div",{className:"jxWZSvet"},L&&Boolean(e.availabilityRemains)&&r.Ay.createElement(tt.A,{isPrimary:!0,progress:e.availabilityRemains/e.availabilityTotal,rightText:P("GiftSoldCount",{count:e.availabilityTotal-e.availabilityRemains}),leftText:P("GiftLeftCount",{count:e.availabilityRemains}),className:"mWzLu0c0"}),r.Ay.createElement(y.A,{className:"IDuhjrne",size:"smaller",onClick:Y,isLoading:h},P("GiftSend",{amount:a},{withNodes:!0})))}())}));var dt=a(87049);const ut="G1mBmzxs",At="a8no5WH0",pt="DvJLTVFU",ft=(0,r.ph)((0,n.EK)((e,{option:t})=>({sticker:(0,s.t0O)(e,t.months),canPlayAnimatedEmojis:(0,s.BWX)(e)}))(function({sticker:e,canPlayAnimatedEmojis:t,baseMonthAmount:a,option:n,optionByStars:i,onClick:s}){const{months:o,amount:c,currency:m}=n,u=(0,U.A)(),A=(0,d.A)(()=>{s(n)}),p=Math.floor(c/o),f=a&&a>p?Math.ceil(100-p/(a/100)):void 0;return r.Ay.createElement("div",{className:ut,tabIndex:0,role:"button",onClick:A},r.Ay.createElement($.A,{sticker:e,play:t,noLoop:!0,nonInteractive:!0,size:86}),function(){const e=12===o?u("Years",{count:1},{pluralValue:1}):u("Months",{count:o},{pluralValue:o});return r.Ay.createElement("div",{className:"rn9aWFNA"},e)}(),r.Ay.createElement("div",{className:"q4_ydkAx"},u("PremiumGiftDescription")),r.Ay.createElement(y.A,{className:At,nonInteractive:!0,size:"tiny",pill:!0,fluid:!0},(0,l.Ad)(c,m)),i&&r.Ay.createElement("div",{className:"QB5SI7ta"},u("GiftPremiumStarsPrice",{stars:(0,de.U2)(u,i.amount,{className:"jgnEfoeM"})},{withNodes:!0,withMarkdown:!0})),Boolean(f)&&r.Ay.createElement(dt.A,{color:"purple",text:u("GiftDiscount",{percent:f})}))}));var yt=a(82855);const gt=(0,r.ph)((0,n.EK)(e=>({isCurrentUserPremium:(0,s.g29)(e)}))(function({gift:e,observeIntersection:t,onClick:a,isResale:i,isCurrentUserPremium:s}){const{openGiftInfoModal:l,openPremiumModal:c,showNotification:m}=(0,n.ko)(),u=(0,r.li)(),A=(0,r.li)(),p=(0,U.A)(),[f,g]=(0,r.J0)(!1),[h,E,b]=(0,T.A)(),S=(0,Q.yQ)(e),v="starGiftUnique"===e.type,k=v?e:void 0,C=v?void 0:e,I=v?function(t){if(!t)return{amount:0,currency:N.OUy};if("starGiftUnique"===e.type&&e.resaleTonOnly){const e=t.find(e=>e.currency===N.ykW);if(e)return e}return t.find(e=>e.currency===N.OUy)}(k?.resellPrice):{amount:C?.stars||0,currency:N.OUy},G=I?.currency||N.OUy,P=C?.resellMinStars,w=!v&&i&&P?p.number(P)+"+":I?.amount||0,B=!v&&Boolean(C?.isLimited),M=!v&&Boolean(C?.isSoldOut),R=Boolean(e?.requirePremium),x=Boolean(C?.limitedPerUser&&!C?.perUserRemains),D=C?.perUserTotal,F=(0,d.A)(()=>{!M||i?x?m({message:p("NotificationGiftsLimit",{count:D},{withMarkdown:!0,withNodes:!0})}):!R||s?a(e,i?"resell":"original"):c({gift:e}):l({gift:e})}),O=(0,r.Kr)(()=>{const{backdrop:t,pattern:a}=(0,Q.uc)(e)||{};if(!t||!a)return;const n=[t.centerColor,t.edgeColor],i=t.patternColor;return r.Ay.createElement(Z.A,{className:"Nkotr8Q4",backgroundColors:n,patternColor:i,patternIcon:a.sticker})},[e]),L=v?e.number:0,K=(0,r.Kr)(()=>{if(v){const{backdrop:t}=(0,Q.uc)(e)||{};if(!t)return;return r.Ay.createElement(dt.A,{color:[t.centerColor,t.edgeColor],text:p("GiftSavedNumber",{number:L})})}return R?r.Ay.createElement(dt.A,{color:"orange",text:p("LimitPremium")}):i?r.Ay.createElement(dt.A,{color:"green",text:p("GiftRibbonResale")}):M?r.Ay.createElement(dt.A,{color:"red",text:p("GiftSoldOut")}):B?r.Ay.createElement(dt.A,{color:"blue",text:p("GiftLimited")}):void 0},[v,i,e,M,B,p,L,R]);return(0,$e.mv)(u,t,e=>{const t=e.isIntersecting;g(t)}),r.Ay.createElement("div",{ref:u,className:(0,o.A)("interactive-gift",ut,"f5ArEO1S","starGiftItem",R&&"NBYIITte"),tabIndex:0,role:"button",onClick:F,onMouseEnter:be.TF?void 0:E,onMouseLeave:be.TF?void 0:b},O,r.Ay.createElement("div",{ref:A,className:"rUSoeQXb",style:"width: 90px; height: 90px"},S&&r.Ay.createElement(yt.A,{observeIntersectionForPlaying:t,observeIntersectionForLoading:t,containerRef:A,sticker:S,size:90,shouldLoop:h,shouldPreloadPreview:!0})),r.Ay.createElement(y.A,{className:At,nonInteractive:!0,size:"tiny",color:v?"bluredStarsBadge":"stars",withSparkleEffect:f,pill:!0,fluid:!0},G===N.ykW?(0,de.Ms)(p,w||0,{shouldConvertFromNanos:!0,className:pt}):(0,de.U2)(p,w||0,{asFont:!0,className:pt})),K)}));var ht=a(58443),Et=a(96374),bt=a(64489);const St={root:"tJK1W0pJ",transition:"pP8TxefR",content:"o3V1HqbL",resaleScreenRoot:"Vce_TsJO",main:"cVXqeu9P",giftSection:"v4eKefwN",section:"EqfarEYb",resaleStarGiftsContainer:"RSFcSNGL",starGiftsContainer:"OQX3GZl5",premiumGiftsGallery:"n40m3BK2",header:"iqqoyRgW",resaleHeader:"cJRBgg9B",resaleHeaderContentContainer:"OXYQmfGK",headerSlide:"BTWhJUQB",headerText:"lLRmbpIu",hiddenHeader:"XgGzn1cQ",resaleHeaderText:"bp_KPx8I",commonHeaderText:"ybZo03if",resaleHeaderDescription:"XefHUFm1",closeButton:"r_Y5uG1T",balance:"soqAknia",avatars:"N_7tYJKr",avatar:"_3hY4vIep",logoBackground:"ieK4TzSb",center:"Ey5gX40t",description:"ZioU5h_k",starGiftsDescription:"gFgzS8pV",boostIcon:"Qi2YR6Dz",optionBottom:"RTbClMKE",secondaryInfo:"g0R9GSNq",footer:"J3Gju3bv",starGiftsTransition:"kB6IyXqS",notFoundGiftsRoot:"UqnRlJ1n",notFoundGiftsDescription:"g0VbwIG_",notFoundGiftsLink:"j2zPEQr8"},vt=(0,r.ph)((0,n.EK)(e=>{const{starGifts:t}=e,{resaleGifts:a}=(0,s.nTw)(e),r=a?.giftId?t?.byId[a.giftId]:void 0,n=a.filter,i=a.isAllLoaded,o=a.isLoading,l=a.updateIteration;return{resellGifts:a.gifts,gift:r,filter:n,areGiftsAllLoaded:i,areGiftsLoading:o,updateIteration:l}})(({resellGifts:e,gift:t,filter:a,areGiftsAllLoaded:i,areGiftsLoading:s,updateIteration:l,onGiftClick:c})=>{const{loadResaleGifts:m,updateResaleGiftsFilter:u}=(0,n.ko)(),A=(0,r.li)(),p=(0,U.A)(),f=(0,r.Kr)(()=>e?.map(e=>e.id),[e]),y=Boolean(a?.modelAttributes?.length||a?.patternAttributes?.length||a?.backdropAttributes?.length),g=(0,d.A)(()=>{t&&m({giftId:t.id})}),h=Boolean(!e||0===e.length),[E,b]=(0,Et.A)(g,f,!t,N.bcN),{observe:S}=(0,$e.BL)({rootRef:A,throttleMs:200}),v=(0,d.A)(()=>{u({filter:{...a,modelAttributes:[],backdropAttributes:[],patternAttributes:[]}})});return r.Ay.createElement("div",{ref:A,className:(0,o.A)(St.resaleScreenRoot,"custom-scroll")},r.Ay.createElement(D.Ay,{name:"zoomFade",activeKey:l},h&&i&&r.Ay.createElement("div",{className:St.notFoundGiftsRoot},r.Ay.createElement(bt.A,{size:160,tgsUrl:ht.w.SearchingDuck,nonInteractive:!0,noLoop:!0}),r.Ay.createElement("div",{className:St.notFoundGiftsDescription},p("ResellGiftsNoFound")),y&&r.Ay.createElement(rt.A,{className:St.notFoundGiftsLink,onClick:v},p("ResellGiftsClearFilters"))),r.Ay.createElement(R.A,{className:(0,o.A)(St.resaleStarGiftsContainer),items:E,onLoadMore:b,itemSelector:".starGiftItem",noFastList:!0,preloadBackwards:N.bcN,scrollContainerClosest:`.${St.resaleScreenRoot}`},e?.map(e=>r.Ay.createElement(gt,{key:e.id,gift:e,observeIntersection:S,isResale:!0,onClick:c})))))}));var Nt=a(10722),kt=a(71429),Ct=a(36393),It=a(76023),Gt=a(87094);const Pt=1.5*It.$,wt=(0,r.ph)((0,n.EK)(e=>({theme:(0,s.SJA)(e)}))(({className:e,type:t,sticker:a,observeIntersectionForLoading:n,observeIntersectionForPlaying:i,theme:s})=>{const l=(0,r.li)(),c=(0,Gt.A)(l,void 0,"pattern"!==t);return r.Ay.createElement("div",{ref:l,className:(0,o.A)("KLFLR9ji",e),style:`width: ${Pt}px; height: ${Pt}px`},r.Ay.createElement(yt.A,{containerRef:l,sticker:a,size:Pt,shouldPreloadPreview:!0,observeIntersectionForLoading:n,observeIntersectionForPlaying:i,thumbClassName:"fCL5rY2D",customColor:c}))})),Bt={root:"_VgmQnUg",buttonsContainer:"IDlp6U6g",itemIcon:"yuctLnuR",sticker:"VT562JS0",backdropAttributeMenuItemText:"D50wFfRL",menuItemStickerText:"THcGWXSA",menuItemText:"L6EVE2Ux",backdrop:"A29QNxKb",menuItemIcon:"GL4rVsev",item:"qiYcBOYc",menuContentContainer:"EDsBn29z",menu:"ISaNdBwd",left:"e4Kkh_MR",right:"Kz_nCGC3"},Mt=(0,r.ph)((0,n.EK)(e=>{const{resaleGifts:t}=(0,s.nTw)(e);return{attributes:t.attributes,counters:t.counters,filter:t.filter}})(({attributes:e,counters:t,filter:a,dialogRef:i})=>{const s=(0,U.A)(),{updateResaleGiftsFilter:l}=(0,n.ko)(),[c,m]=(0,r.J0)(""),[u,A]=(0,r.J0)(""),[f,y]=(0,r.J0)(""),g=(0,r.Kr)(()=>{const a={model:[],pattern:[],backdrop:[]};for(const r of t??[]){const{attribute:t}=r;if(!r.count)continue;const n=e?.find(e=>"backdrop"===e.type&&"backdrop"===t.type?e.backdropId===t.backdropId:("model"===e.type&&"model"===t.type||"pattern"===e.type&&"pattern"===t.type)&&e.sticker.id===t.documentId);"backdrop"===n?.type&&a.backdrop.push(n),"model"===n?.type&&a.model.push(n),"pattern"===n?.type&&a.pattern.push(n)}return a},[e,t]),h=(0,r.Kr)(()=>{const e=(e,t)=>t.trim()?e.filter(e=>Boolean(e.name?.toLowerCase().includes(t.toLowerCase()))):e;return{model:e(g.model,c),pattern:e(g.pattern,f),backdrop:e(g.backdrop,u)}},[g,c,u,f]),E=(0,r.li)(),{isContextMenuOpen:b,contextMenuAnchor:S,handleContextMenu:v,handleContextMenuClose:N,handleContextMenuHide:k}=(0,Nt.A)(i),C=(0,d.A)(()=>E.current),I=(0,r.li)(),{isContextMenuOpen:G,contextMenuAnchor:P,handleContextMenu:w,handleContextMenuClose:B,handleContextMenuHide:M}=(0,Nt.A)(i),T=(0,d.A)(()=>I.current),R=(0,r.li)(),{isContextMenuOpen:x,contextMenuAnchor:D,handleContextMenu:F,handleContextMenuClose:O,handleContextMenuHide:L}=(0,Nt.A)(i),K=(0,d.A)(()=>R.current),V=(0,r.li)(),{isContextMenuOpen:z,contextMenuAnchor:H,handleContextMenu:q,handleContextMenuClose:J,handleContextMenuHide:W}=(0,Nt.A)(i),_=(0,d.A)(()=>V.current),j=(0,r.Kr)(()=>{const e=a.sortType;return({onTrigger:t,isOpen:a})=>r.Ay.createElement("div",{className:Bt.item,onClick:t},"byDate"===e&&s("ValueGiftSortByDate"),"byNumber"===e&&s("ValueGiftSortByNumber"),"byPrice"===e&&s("ValueGiftSortByPrice"),r.Ay.createElement(p.A,{name:"dropdown-arrows",className:Bt.itemIcon}))},[s,a]),Q=(0,r.Kr)(()=>{const e=a?.modelAttributes?.length||0;return({onTrigger:t,isOpen:a})=>r.Ay.createElement("div",{className:Bt.item,onClick:t},0===e&&s("GiftAttributeModel"),e>0&&s("GiftAttributeModelPlural",{count:e},{pluralValue:e}),r.Ay.createElement(p.A,{name:"dropdown-arrows",className:Bt.itemIcon}))},[s,a]),X=(0,r.Kr)(()=>{const e=a?.backdropAttributes?.length||0;return({onTrigger:t,isOpen:a})=>r.Ay.createElement("div",{className:Bt.item,onClick:t},0===e&&s("GiftAttributeBackdrop"),e>0&&s("GiftAttributeBackdropPlural",{count:e},{pluralValue:e}),r.Ay.createElement(p.A,{name:"dropdown-arrows",className:Bt.itemIcon}))},[s,a]),Y=(0,r.Kr)(()=>{const e=a?.patternAttributes?.length||0;return({onTrigger:t,isOpen:a})=>r.Ay.createElement("div",{className:Bt.item,onClick:t},0===e&&s("GiftAttributeSymbol"),e>0&&s("GiftAttributeSymbolPlural",{count:e},{pluralValue:e}),r.Ay.createElement(p.A,{name:"dropdown-arrows",className:Bt.itemIcon}))},[s,a]),$=(0,d.A)(e=>{l({filter:{...a,sortType:e}})}),ee=(0,d.A)(()=>{l({filter:{...a,modelAttributes:[]}})}),te=(0,d.A)(()=>{l({filter:{...a,patternAttributes:[]}})}),ae=(0,d.A)(()=>{l({filter:{...a,backdropAttributes:[]}})}),re=(0,d.A)(e=>{if(!t)return;const r=a.modelAttributes||[],n=t.find(t=>"model"===t.attribute.type&&t.attribute.documentId===e.sticker.id)?.attribute;if(!n)return;const i=r.some(e=>e.documentId===n.documentId)?r.filter(e=>e.documentId!==n.documentId):[...r,n];l({filter:{...a,modelAttributes:i}})}),ne=(0,d.A)(e=>{if(!t)return;const r=a.patternAttributes||[],n=t.find(t=>"pattern"===t.attribute.type&&t.attribute.documentId===e.sticker.id)?.attribute;if(!n)return;const i=r.some(e=>e.documentId===n.documentId)?r.filter(e=>e.documentId!==n.documentId):[...r,n];l({filter:{...a,patternAttributes:i}})}),ie=(0,d.A)(e=>{if(!t)return;const r=a.backdropAttributes||[],n=t.find(t=>"backdrop"===t.attribute.type&&t.attribute.backdropId===e.backdropId)?.attribute;if(!n)return;const i=r.some(e=>e.backdropId===n.backdropId)?r.filter(e=>e.backdropId!==n.backdropId):[...r,n];l({filter:{...a,backdropAttributes:i}})}),se=(0,r.hb)(()=>{m("")},[]),oe=(0,r.hb)(()=>{A("")},[]),le=(0,r.hb)(()=>{y("")},[]),ce=(0,d.A)(e=>{e.stopPropagation(),e.preventDefault()}),me=(0,r.li)(),{observe:de}=(0,$e.BL)({rootRef:me,isDisabled:!P});return r.Ay.createElement("div",{className:Bt.root},Boolean(S)&&r.Ay.createElement(kt.A,{isOpen:b,anchor:S,ref:E,className:(0,o.A)(Bt.menu,Bt.left,"with-menu-transitions"),getMenuElement:C,autoClose:!0,onClose:N,onCloseAnimationEnd:k,positionX:"left"},r.Ay.createElement(r.Ay.Fragment,null,r.Ay.createElement(De.A,{icon:"sort-by-price",onClick:()=>{$("byPrice")}},r.Ay.createElement("div",{className:Bt.menuItemText},s("GiftSortByPrice")),r.Ay.createElement(p.A,{className:Bt.menuItemIcon,name:"byPrice"===a?.sortType?"check":"placeholder"})),r.Ay.createElement(De.A,{icon:"sort-by-date",onClick:()=>{$("byDate")}},r.Ay.createElement("div",{className:Bt.menuItemText},s("GiftSortByDate")),r.Ay.createElement(p.A,{className:Bt.menuItemIcon,name:"byDate"===a?.sortType?"check":"placeholder"})),r.Ay.createElement(De.A,{icon:"sort-by-number",onClick:()=>{$("byNumber")}},r.Ay.createElement("div",{className:Bt.menuItemText},s("GiftSortByNumber")),r.Ay.createElement(p.A,{className:Bt.menuItemIcon,name:"byNumber"===a?.sortType?"check":"placeholder"})))),Boolean(P)&&r.Ay.createElement(kt.A,{isOpen:G,anchor:P,ref:I,className:(0,o.A)(Bt.menu,Bt.left,"with-menu-transitions"),getMenuElement:T,autoClose:!0,onClose:B,onCloseAnimationEnd:M},function(){const e=h.model,t=a.modelAttributes??[],n=0===t.length;return r.Ay.createElement("div",{className:Bt.menuContentContainer,ref:me},r.Ay.createElement(Ct.A,{onClick:ce,className:Bt.search,value:c,onChange:m,onReset:se,placeholder:s("Search")}),r.Ay.createElement(De.A,{icon:"select",onClick:ee,disabled:n},s("ContextMenuItemSelectAll")),e.map(e=>{const a=n||t.some(t=>t.documentId===e.sticker.id);return r.Ay.createElement(De.A,{key:e.name,onClick:()=>{re(e)}},r.Ay.createElement(wt,{className:Bt.sticker,sticker:e.sticker,type:"model",observeIntersectionForLoading:de,observeIntersectionForPlaying:de}),r.Ay.createElement("div",{className:Bt.menuItemStickerText},e.name),r.Ay.createElement(p.A,{className:Bt.menuItemIcon,name:a?"check":"placeholder"}))}))}()),Boolean(D)&&r.Ay.createElement(kt.A,{isOpen:x,anchor:D,ref:R,className:(0,o.A)(Bt.menu,Bt.right,"with-menu-transitions"),getMenuElement:K,autoClose:!0,onClose:O,onCloseAnimationEnd:L,positionX:"right"},function(){const e=h.backdrop,t=a.backdropAttributes??[],n=0===t.length;return r.Ay.createElement("div",{className:Bt.menuContentContainer},r.Ay.createElement(Ct.A,{onClick:ce,className:Bt.search,value:u,onChange:A,onReset:oe,placeholder:s("Search")}),r.Ay.createElement(De.A,{icon:"select",onClick:ae,disabled:n},s("ContextMenuItemSelectAll")),e.map(e=>{const a=n||t.some(t=>t.backdropId===e.backdropId);return r.Ay.createElement(De.A,{key:e.name,onClick:()=>{ie(e)}},r.Ay.createElement(Z.A,{className:Bt.backdrop,backgroundColors:[e.centerColor,e.edgeColor],patternColor:e.patternColor}),r.Ay.createElement("div",{className:Bt.backdropAttributeMenuItemText},e.name),r.Ay.createElement(p.A,{className:Bt.menuItemIcon,name:a?"check":"placeholder"}))}))}()),Boolean(H)&&r.Ay.createElement(kt.A,{isOpen:z,anchor:H,ref:V,className:(0,o.A)(Bt.menu,Bt.right,"with-menu-transitions"),getMenuElement:_,autoClose:!0,onClose:J,onCloseAnimationEnd:W},function(){const e=h.pattern,t=a.patternAttributes??[],n=0===t.length;return r.Ay.createElement("div",{className:Bt.menuContentContainer},r.Ay.createElement(Ct.A,{onClick:ce,className:Bt.search,value:f,onChange:y,onReset:le,placeholder:s("Search")}),r.Ay.createElement(De.A,{icon:"select",onClick:te,disabled:n},s("ContextMenuItemSelectAll")),e.map(e=>{const a=n||t.some(t=>t.documentId===e.sticker.id);return r.Ay.createElement(De.A,{key:e.name,onClick:()=>{ne(e)}},r.Ay.createElement(wt,{className:Bt.sticker,sticker:e.sticker,type:"pattern"}),r.Ay.createElement("div",{className:Bt.menuItemStickerText},e.name),r.Ay.createElement(p.A,{className:Bt.menuItemIcon,name:a?"check":"placeholder"}))}))}()),r.Ay.createElement("div",{className:Bt.buttonsContainer},r.Ay.createElement(j,{onTrigger:v,isOpen:b}),r.Ay.createElement(Q,{onTrigger:w,isOpen:G}),r.Ay.createElement(X,{onTrigger:F,isOpen:x}),r.Ay.createElement(Y,{onTrigger:q,isOpen:z})))}));var Tt=a(36838);const Ut=(0,r.ph)((0,n.EK)(e=>{const{starGifts:t}=e;return{idsByCategory:t?.idsByCategory}})(({idsByCategory:e,onCategoryChanged:t,areLimitedStarGiftsDisallowed:a})=>{const n=(0,r.li)(),i=(0,U.A)(),s=(0,r.Kr)(()=>e&&Object.keys(e).filter(e=>"all"!==e&&"limited"!==e).map(Number).sort((e,t)=>e-t),[e]),l=e&&e.resale.length>0,[c,m]=(0,r.J0)("all");function d(e){return r.Ay.createElement("div",{className:(0,o.A)("dO7FKYY4",c===e&&"B2lEJk1v"),onClick:()=>function(e){m(e),t(e)}(e)},Number.isInteger(e)&&r.Ay.createElement(K.A,{className:"Pb7AU805",type:"gold",size:"middle"}),function(e){return"all"===e?i("AllGiftsCategory"):"stock"===e?i("StockGiftsCategory"):"limited"===e?i("LimitedGiftsCategory"):"resale"===e?i("GiftCategoryResale"):e}(e))}return(0,Tt.A)(n,void 0,!0),r.Ay.createElement("div",{ref:n,className:(0,o.A)("cUjwvN00","no-scrollbar")},d("all"),!a&&d("limited"),!a&&l&&d("resale"),d("stock"),s?.map(d))})),Rt=[0,-50],xt=(0,Ye.nF)(e=>e(),200,!0),Dt=(0,r.ph)((0,n.EK)((e,{modal:t})=>{const{starGifts:a,stars:r,currentUserId:n}=e,i=t?.forPeerId?(0,s.PVB)(e,t.forPeerId):void 0,o=Boolean(n&&t?.forPeerId===n),l=i?(0,s.vGo)(e,i?.id):void 0,{resaleGifts:c}=(0,s.nTw)(e),m=c.count,d=!1!==c.isLoading;return{boostPerSentGift:e.appConfig?.boostsPerSentGift,starGiftsById:a?.byId,starGiftIdsByCategory:a?.idsByCategory,starBalance:r?.balance,peer:i,isSelf:o,disallowedGifts:l?.disallowedGifts,resaleGiftsCount:m,areResaleGiftsLoading:d}})(({modal:e,starGiftsById:t,starGiftIdsByCategory:a,starBalance:s,peer:l,isSelf:c,disallowedGifts:p,resaleGiftsCount:h,areResaleGiftsLoading:E})=>{const{closeGiftModal:b,openGiftInfoModal:S,resetResaleGifts:v,loadResaleGifts:C}=(0,n.ko)(),I=(0,r.li)(),G=(0,r.li)(),P=(0,r.li)(),w=(0,r.li)(),B=Boolean(e),M=(0,m.A)(e),T=l&&(0,i.mO)(l)?l:void 0,R=l&&(0,i.vj)(l)?l:void 0,[x,F]=(0,r.J0)(),[O,L]=(0,r.J0)(),[K,V]=(0,r.J0)(!1),[H,q]=(0,r.J0)(!1),[J,W]=(0,r.J0)(!1),[_,j]=(0,r.J0)("all"),Q=(0,r.li)(),X=(0,r.Kr)(()=>{if(!p)return;const{shouldDisallowPremiumGifts:e,...t}=p;return!c&&Object.values(t).every(Boolean)},[c,p]),Y=!c&&p?.shouldDisallowUnlimitedStarGifts,$=!c&&p?.shouldDisallowLimitedStarGifts,Z=(0,u.A)(),ee=(0,U.A)(),te=M?.gifts,ae=(0,r.Kr)(()=>te?.sort((e,t)=>e.months-t.months).filter(e=>1===e.users&&e.currency!==N.OUy),[te]),re=(0,r.Kr)(()=>{const e=new Map;return ae?(ae.forEach(t=>{const a=te?.find(e=>e.currency===N.OUy&&e.months===t.months);a&&e.set(t,a)}),e):e},[te,ae]),ne=(0,r.Kr)(()=>ae?.reduce((e,t)=>e.amount<t.amount?e:t),[ae]),{observe:ie}=(0,$e.BL)({rootRef:w,throttleMs:200,isDisabled:!B}),se=Boolean(O)&&!x,oe=Boolean(x),le=se||oe||K,ce=oe?J:H;(0,r.vJ)(()=>{O&&C({giftId:O.id})},[O]),(0,r.vJ)(()=>{B||(V(!1),F(void 0),L(void 0),j("all"))},[B]);const me=(0,d.A)(e=>{if(oe)return;const t=e.currentTarget;xt(()=>{const{scrollTop:e}=t;if(V(e>150),G.current&&P.current){const{top:e}=P.current.getBoundingClientRect(),{top:t}=G.current.getBoundingClientRect();q(e-t<=0)}})}),de=ee("GiftPremiumDescription",{user:(0,k.Yg)(T),link:r.Ay.createElement(f.A,{text:ee("GiftPremiumDescriptionLinkCaption"),url:ee("GiftPremiumDescriptionLink")})},{withNodes:!0}),ue=R?ee("StarGiftDescriptionChannel",{peer:(0,i.F9)(ee,R)},{withNodes:!0,withMarkdown:!0}):c?ee("StarGiftDescriptionSelf",void 0,{withNodes:!0,renderTextFilters:["br"]}):ee("StarGiftDescription",{user:(0,k.Yg)(T)},{withNodes:!0,withMarkdown:!0}),Ae=(0,d.A)((e,t)=>{if("resell"===t){if(!("id"in e))return;return se?void S({gift:e,recipientId:M?.forPeerId}):void L(e)}F(e),W("id"in e)}),pe=(0,d.A)(e=>{j(e)}),fe=(0,d.A)(()=>{F(void 0),L(void 0),v(),b()}),ye=(0,d.A)(()=>{if(se)return L(void 0),void v();oe?F(void 0):fe()}),ge=(0,d.A)(()=>{Q.current?.()}),Ee=(0,d.A)(e=>{Q.current=e}),be=oe||se,Se=(0,o.A)("animated-close-icon",be&&"state-back");return r.Ay.createElement(g.A,{dialogRef:I,onClose:fe,isOpen:B,isSlim:!0,contentClassName:St.content,className:(0,o.A)(St.modalDialog,St.root),isLowStackPriority:!0},r.Ay.createElement(y.A,{className:St.closeButton,round:!0,color:"translucent",size:"smaller",onClick:ye,ariaLabel:Z(be?"Common.Back":"Common.Close")},r.Ay.createElement("div",{className:Se})),r.Ay.createElement(z,{className:St.balance,balance:s,withAddButton:!0}),r.Ay.createElement("div",{className:(0,o.A)(St.header,se&&St.resaleHeader,!le&&St.hiddenHeader)},r.Ay.createElement(D.Ay,{name:"slideVerticalFade",activeKey:le?se?1:ce?2:3:0,slideClassName:St.headerSlide},function(){if(le){if(se){const e=E&&!h;return r.Ay.createElement("div",{className:St.resaleHeaderContentContainer},r.Ay.createElement("h2",{className:St.resaleHeaderText},O.title),e&&r.Ay.createElement("div",{className:St.resaleHeaderDescription},ee("Loading")),!e&&void 0!==h&&r.Ay.createElement("div",{className:St.resaleHeaderDescription},ee("HeaderDescriptionResaleGifts",{count:h},{withNodes:!0,withMarkdown:!0,pluralValue:h})),r.Ay.createElement(Mt,{dialogRef:I}))}return r.Ay.createElement("h2",{className:St.commonHeaderText},ee(ce?c?"StarsGiftHeaderSelf":"StarsGiftHeader":"GiftPremiumHeader"))}}())),r.Ay.createElement(D.Ay,{ref:G,className:St.transition,name:"pushSlide",activeKey:oe?1:se?2:0},!oe&&!se&&r.Ay.createElement("div",{ref:w,className:(0,o.A)(St.main,"custom-scroll"),onScroll:me},r.Ay.createElement("div",{className:St.avatars},r.Ay.createElement(A.A,{className:St.avatar,size:100,peer:l,onMouseMove:ge}),r.Ay.createElement(he.A,{className:St.logoBackground,color:"gold",centerShift:Rt,onRequestAnimation:Ee})),!c&&!R&&!p?.shouldDisallowPremiumGifts&&r.Ay.createElement(r.Ay.Fragment,null,r.Ay.createElement("h2",{className:(0,o.A)(St.headerText,St.center)},ee("GiftPremiumHeader")),r.Ay.createElement("p",{className:(0,o.A)(St.description,St.center)},de),r.Ay.createElement("div",{className:St.premiumGiftsGallery},ae?.map(e=>r.Ay.createElement(ft,{option:e,optionByStars:re.get(e),baseMonthAmount:ne?Math.floor(ne.amount/ne.months):void 0,onClick:Ae})))),!X&&r.Ay.createElement(r.Ay.Fragment,null,r.Ay.createElement("h2",{ref:P,className:(0,o.A)(St.headerText,St.center)},ee(c?"StarsGiftHeaderSelf":"StarsGiftHeader")),r.Ay.createElement("p",{className:(0,o.A)(St.description,St.starGiftsDescription,St.center)},ue),r.Ay.createElement(Ut,{areLimitedStarGiftsDisallowed:$,onCategoryChanged:pe}),r.Ay.createElement(D.Ay,{name:"zoomFade",activeKey:(ve=_,"all"===ve?0:"limited"===ve?1:"resale"===ve?2:"stock"===ve?3:ve+3),className:St.starGiftsTransition},function(){const e=a?.[_]?.filter(e=>{const a=t?.[e];if(!a)return!1;const{isLimited:r,isSoldOut:n,upgradeStars:i}=a;return Y&&!$?r:$&&!Y?!r&&!n:!Y||!$||Boolean(r&&Boolean(i))});return r.Ay.createElement("div",{className:St.starGiftsContainer},t&&e?.flatMap(e=>{const a=t[e],n="stock"!==_&&Boolean(a.availabilityResale),i="resale"!==_&&n&&!a.isSoldOut,s=[r.Ay.createElement(gt,{key:e,gift:a,observeIntersection:ie,isResale:n&&!i,onClick:Ae})];return i&&s.push(r.Ay.createElement(gt,{key:`resale_${e}`,isResale:!0,gift:a,observeIntersection:ie,onClick:Ae})),s}))}()))),se&&O&&r.Ay.createElement(vt,{onGiftClick:Ae}),oe&&M?.forPeerId&&r.Ay.createElement(mt,{gift:x,giftByStars:re.get(x),peerId:M.forPeerId})));var ve}));const Ft=(0,r.ph)((0,n.EK)(e=>{const{currentUserId:t}=e;return{currentUserId:t,userIds:e.contactList?.userIds}})(({modal:e,currentUserId:t,userIds:a})=>{const{closeGiftRecipientPicker:o,openGiftModal:l}=(0,n.ko)(),c=(0,u.A)(),m=e,[A,p]=(0,r.J0)(""),f=(0,r.Kr)(()=>{const e=(0,n.mS)(),r=a?a.concat(t):void 0,o=r?(0,i.PU)({ids:r,query:A}):[];return(0,I.A)((0,C.Am)(o).filter(t=>(0,s.X2D)(e,t)),void 0,[t])},[t,A,a]),y=(0,d.A)(e=>{l({forUserId:e}),o()});return r.Ay.createElement(P.A,{className:"W3JMs1YE",isOpen:m,onClose:o,title:c("GiftTelegramPremiumOrStarsTitle"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0},r.Ay.createElement(G.A,{className:"wOipz1Y_",itemIds:f,filterValue:A,filterPlaceholder:c("Search"),onSelectedIdChange:y,onFilterChange:p,isSearchable:!0,withDefaultPadding:!0,withStatus:!0,forceShowSelf:!0}))}));var Ot=a(79089),Lt=a(80140),Kt=a(18501),Vt=a(25404);const zt={root:"Ef0cKSqQ",giftPreview:"IvuNzslN",backdrop:"dNukis4X",arrow:"oufsMLLF"},Ht=4*It.$,qt=3*It.$,Jt=(0,r.ph)(({peer:e,gift:t})=>{const a=(0,r.Kr)(()=>(0,Q.uc)(t),[t]);if(a)return r.Ay.createElement("div",{className:zt.root},r.Ay.createElement("div",{className:zt.giftPreview},r.Ay.createElement(Z.A,{className:zt.backdrop,backgroundColors:[a.backdrop.centerColor,a.backdrop.edgeColor],patternColor:a.backdrop?.patternColor,patternIcon:a.pattern?.sticker}),r.Ay.createElement($.A,{className:zt.sticker,size:qt,sticker:a.model?.sticker})),r.Ay.createElement(p.A,{name:"next",className:zt.arrow}),r.Ay.createElement(A.A,{peer:e,size:Ht,className:zt.avatar}))});var Wt=a(94189);const _t={modal:"nnublcCk",checkBox:"fjE0wGvw",checkBoxDescription:"tepUTe4z",upgradeIcon:"lgyInH5K",header:"p7FTs7_p",title:"pIbzzTir",description:"CCPfr26t",soldOut:"kjWcRp4W",headerSplitButton:"XOMI_4PO",headerButton:"WA0INleU",giftResalePriceContainer:"BN8gf5y6",starAmountIcon:"_5guecUe",giftResalePriceStar:"H_q8o2vY",left:"aOhTHZlf",right:"rJOB1u5Q",footer:"bho0GTYt",footerDescription:"VUylTszM",unknown:"zDauXmpS",giftValue:"w_E4LkUj",uniqueAttribute:"OJQnkf17",uniqueGift:"I6o_pGAm",modalHeader:"ie9tImaj",modalCloseButton:"p38RBGdC",ownerAddress:"DavMRg4Q",copyIcon:"SLX5tX8C"},jt=(0,r.ph)((0,n.EK)((e,{modal:t})=>{const a=t?.gift,r=a&&"gift"in a,n=e.currentUserId,o=r&&a.fromId,l=o?(0,s.PVB)(e,o):void 0,c=t?.peerId?(0,s.PVB)(e,t.peerId):void 0,m=c&&(0,i.vj)(c)?c:void 0,d=m&&(0,k.ub)(m,"postMessages"),u=(0,s.mBe)(e,n),A=t?.recipientId&&n!==t.recipientId?(0,s.PVB)(e,t.recipientId):void 0,p=u?.emojiStatus,f=e.collectibleEmojiStatuses?.statuses,y=r?a.gift:a,g="starGiftUnique"===y?.type&&y.releasedByPeerId;return{fromPeer:l,targetPeer:c,releasedByPeer:g?(0,s.PVB)(e,g):void 0,currentUserId:n,starGiftMaxConvertPeriod:e.appConfig?.starGiftMaxConvertPeriod,tonExplorerUrl:e.appConfig?.tonExplorerUrl,hasAdminRights:d,currentUserEmojiStatus:p,collectibleEmojiStatuses:f,currentUser:u,recipientPeer:A}})(({modal:e,fromPeer:t,targetPeer:a,releasedByPeer:l,currentUserId:c,starGiftMaxConvertPeriod:g,hasAdminRights:h,currentUserEmojiStatus:E,collectibleEmojiStatuses:b,tonExplorerUrl:S,currentUser:v,recipientPeer:k})=>{const{closeGiftInfoModal:C,changeGiftVisibility:I,convertGiftToStars:G,openChatWithInfo:P,focusMessage:w,openGiftUpgradeModal:B,showNotification:M,buyStarGift:R,closeGiftModal:x}=(0,n.ko)(),[D,F,O]=(0,T.A)(),K=(0,U.A)(),V=(0,u.A)(),[z,J]=(0,r.J0)(!1),[W,_]=(0,r.J0)(!1),X=Boolean(e),Y=(0,m.A)(e),Z=(0,m.A)(t),ee=(0,m.A)(a),te=ee&&(0,i.vj)(ee),{gift:ae}=Y||{},re=ae&&"gift"in ae,ne=re?ae:void 0,ie=ne?.fromId===c,se=ne&&g&&ne.date+g-(0,Lt.Fm)()||0,oe=Math.ceil(se/60/60/24),le=re?ae.gift:ae,ce=le&&(0,Q.yQ)(le),me=se>0&&Boolean(ne?.starsToConvert),ue=le&&"starGiftUnique"===le.type,Ae=ue?le:void 0,pe=(0,r.Kr)(()=>{if(le&&"starGiftUnique"===le.type){if(l){const e=`@${(0,Ot.Kl)(l)}`||(0,i.F9)(K,l),t=(0,i.mO)(l)?K("ActionFallbackUser"):K("ActionFallbackChannel");return K("GiftInfoCollectibleBy",{number:le.number,owner:e||t},{withNodes:!0,withMarkdown:!0})}return K("GiftInfoCollectible",{number:le.number})}},[le,l,K]),fe=Boolean(ne?.upgradeMsgId),ye=!fe&&ne?.inputGift&&(te?h:ee?.id===c);function he(e){if(!ue)return;const t=le.resellPrice;return t?le?.resaleTonOnly||e?t.find(e=>e.currency===N.ykW):t.find(e=>e.currency===N.OUy):void 0}const be=he(),Se=he(W),ve="starGiftUnique"===le?.type&&le.ownerId!==c&&Boolean(be),ke=(()=>{if(!ue)return;const{ownerName:e,ownerId:t}=le,a=(0,n.mS)(),r=t?(0,s.PVB)(a,t):void 0;return r?(0,i.F9)(K,r):e})(),Ce=(0,d.A)(()=>{C()}),Ie=(0,d.A)(()=>{const e=ie?ee:Z;if(!ne?.upgradeMsgId||!e)return;const{upgradeMsgId:t}=ne;w({chatId:e.id,messageId:t}),Ce()}),Ge=(0,d.A)(()=>{const{inputGift:e,isUnsaved:t}=ne;I({gift:e,shouldUnsave:!t}),Ce()}),Pe=(0,d.A)(()=>{const{inputGift:e}=ne;G({gift:e}),O(),Ce()}),we=(0,d.A)(()=>{ne&&B({giftId:ne.gift.id,gift:ne})}),Be=(0,d.A)(()=>{"starGiftUnique"===le?.type&&he()&&J(!0)}),Me=(0,d.A)(()=>{J(!1)}),Te=(0,d.A)(()=>{const e=k||v,t=he(W);e&&t&&"starGiftUnique"===le?.type&&(Me(),x(),R({peerId:e.id,slug:le.slug,price:t}))}),Ue=(0,r.Kr)(()=>le&&(0,Q.uc)(le),[le]),De=(0,r.Kr)(()=>({onTrigger:e})=>r.Ay.createElement("div",{className:(0,o.A)(_t.headerButton,_t.left),tabIndex:0,role:"button","aria-haspopup":"menu","aria-label":K("AriaMoreButton"),onClick:e},r.Ay.createElement(p.A,{name:"more",className:_t.icon})),[K]),Fe=(0,d.A)(()=>ve?r.Ay.createElement(y.A,{noForcedUpperCase:!0,size:"smaller",onClick:Be},K("ButtonBuyGift",{stars:be?.currency===N.ykW?(0,de.Ms)(K,be.amount,{shouldConvertFromNanos:!0}):(0,de.U2)(K,be?.amount,{asFont:!0})},{withNodes:!0})):fe?r.Ay.createElement(y.A,{size:"smaller",onClick:Ie},K("GiftInfoViewUpgraded")):ye&&ne?.alreadyPaidUpgradeStars&&!ne.upgradeMsgId?r.Ay.createElement(y.A,{size:"smaller",isShiny:!0,onClick:we},K("GiftInfoUpgradeForFree"),r.Ay.createElement(p.A,{name:"arrow-down-circle",className:_t.upgradeIcon})):ye&&ne.canUpgrade&&!ne.upgradeMsgId?r.Ay.createElement(y.A,{size:"smaller",isShiny:!0,onClick:we},K("GiftInfoUpgrade"),r.Ay.createElement(p.A,{name:"arrow-down-circle",className:_t.upgradeIcon})):r.Ay.createElement(y.A,{size:"smaller",onClick:Ce},K("OK"))),Oe=(0,r.Kr)(()=>{if(!le)return;let e="";return"starGift"===le.type&&(le.firstSaleDate&&(e+=`${K("GiftInfoFirstSale")} ${(0,H.L2)(1e3*le.firstSaleDate,K.code,!0)}`),le.lastSaleDate&&(e+="\n",e+=`${K("GiftInfoLastSale")} ${(0,H.L2)(1e3*le.lastSaleDate,K.code,!0)}`)),e},[le,K]),Le=(0,r.Kr)(()=>{if(!ae||!le)return;const{fromId:e,isNameHidden:t,starsToConvert:a,isUnsaved:c,isConverted:m,upgradeMsgId:d}=ne||{},u=me&&Boolean(a),y=t&&ee,g=(()=>{if(!ne)return K("GiftInfoSoldOutDescription");if(!te){if(ne.upgradeMsgId)return K("GiftInfoDescriptionUpgraded");if(ye&&ne.canUpgrade&&ne.alreadyPaidUpgradeStars&&!ne.upgradeMsgId)return K("GiftInfoDescriptionUpgrade");if(ne.canUpgrade&&ye)return ye?K("GiftInfoDescriptionFreeUpgrade"):K("GiftInfoPeerDescriptionFreeUpgradeOut",{peer:(0,i.F9)(K,ee)});if(ye||ie)return m&&u?ye?K("GiftInfoDescriptionConverted",{amount:a},{pluralValue:a,withNodes:!0,withMarkdown:!0}):K("GiftInfoPeerDescriptionOutConverted",{amount:a,peer:(0,i.F9)(K,ee)},{pluralValue:a,withNodes:!0,withMarkdown:!0}):ne.canUpgrade&&ye?u?K("GiftInfoDescriptionUpgrade",{amount:a},{pluralValue:a,withNodes:!0,withMarkdown:!0}):K("GiftInfoDescriptionUpgradeRegular"):ye?u?K("GiftInfoDescription",{amount:a},{withNodes:!0,withMarkdown:!0,pluralValue:a}):K("GiftInfoDescriptionRegular"):u?K("GiftInfoPeerDescriptionOut",{amount:a,peer:(0,i.F9)(K,ee)},{withNodes:!0,withMarkdown:!0,pluralValue:a}):K("GiftInfoPeerDescriptionOutRegular",{peer:(0,i.F9)(K,ee)})}})(),h=r.Ay.createElement(xe.A,{className:"with-menu-transitions",trigger:De,positionX:"right"},r.Ay.createElement(Vt.A,{peerId:Y.peerId,gift:ae,canManage:ye,collectibleEmojiStatuses:b,currentUserEmojiStatus:E})),v=r.Ay.createElement("div",{className:_t.modalHeader},Boolean(be?.amount)&&r.Ay.createElement("div",{className:_t.giftResalePriceContainer},be.currency===N.ykW?(0,de.Ms)(K,be.amount,{className:_t.giftResalePriceStar,shouldConvertFromNanos:!0}):(0,de.U2)(K,be.amount,{asFont:!0,className:_t.giftResalePriceStar})),r.Ay.createElement("div",{className:_t.headerSplitButton},X&&h,r.Ay.createElement("div",{className:(0,o.A)(_t.headerButton,_t.right),tabIndex:0,role:"button","aria-haspopup":"menu","aria-label":K("Close"),onClick:Ce},r.Ay.createElement(p.A,{name:"close",className:(0,o.A)(_t.icon,_t.moreIcon)})))),k=ue&&r.Ay.createElement("div",{className:(0,o.A)(_t.header,_t.uniqueGift)},r.Ay.createElement(Ne,{backdropAttribute:Ue.backdrop,patternAttribute:Ue.pattern,modelAttribute:Ue.model,title:le.title,subtitle:pe,subtitlePeer:l})),I=r.Ay.createElement("div",{className:_t.header},r.Ay.createElement($.A,{className:_t.giftSticker,sticker:ce,size:120}),r.Ay.createElement("h1",{className:_t.title},ue?le.title:K(ne?ye?"GiftInfoReceived":"GiftInfoTitle":"GiftInfoSoldOutTitle")),Boolean(g)&&r.Ay.createElement("p",{className:(0,o.A)(_t.description,!ne&&"starGift"===le?.type&&_t.soldOut)},g)),G=[];if("starGift"===le.type){(e||t)&&G.push([K("GiftInfoFrom"),e?{chatId:e}:r.Ay.createElement(r.Ay.Fragment,null,r.Ay.createElement(A.A,{size:"small",peer:j.I5}),r.Ay.createElement("span",{className:_t.unknown},V(j.I5.titleKey)))]),ne?.date&&G.push([K("GiftInfoDate"),r.Ay.createElement("span",{title:Oe},(0,H.L2)(1e3*ne.date,K.code,!0))]),le.firstSaleDate&&!ne&&G.push([K("GiftInfoFirstSale"),(0,H.L2)(1e3*le.firstSaleDate,K.code,!0)]),le.lastSaleDate&&!ne&&G.push([K("GiftInfoLastSale"),(0,H.L2)(1e3*le.lastSaleDate,K.code,!0)]);const n=le.stars+(ne?.alreadyPaidUpgradeStars||0);G.push([K("GiftInfoValue"),r.Ay.createElement("div",{className:_t.giftValue},(0,de.U2)(K,n,{className:_t.starAmountIcon}),ye&&me&&Boolean(a)&&r.Ay.createElement(L.A,{onClick:F},K("GiftInfoConvert",{amount:a},{pluralValue:a})))]),le.availabilityTotal&&G.push([K("GiftInfoAvailability"),K("GiftInfoAvailabilityValue",{count:le.availabilityRemains||0,total:le.availabilityTotal},{pluralValue:le.availabilityRemains||0})]),le.upgradeStars&&!d&&G.push([K("GiftInfoStatus"),r.Ay.createElement("div",{className:_t.giftValue},K("GiftInfoStatusNonUnique"))]),ne?.message&&G.push([void 0,(0,Kt.fd)(ne.message)])}if(ue){const{ownerName:e,ownerAddress:t,ownerId:a}=le,o=a?(0,s.PVB)((0,n.mS)(),a):void 0,{model:l,backdrop:c,pattern:m,originalDetails:d}=Ue||{};if(t?G.push([K("GiftInfoOwner"),r.Ay.createElement("span",{className:_t.ownerAddress,onClick:()=>{(0,ge.eM)(t),M({message:{key:"WalletAddressCopied"},icon:"copy"})}},t,r.Ay.createElement(p.A,{className:_t.copyIcon,name:"copy"}))]):(o||e)&&G.push([K("GiftInfoOwner"),a?{chatId:a,withEmojiStatus:!0}:e||""]),l&&G.push([K("GiftAttributeModel"),r.Ay.createElement("span",{className:_t.uniqueAttribute},l.name,r.Ay.createElement(L.A,null,(0,q.l9)(l.rarityPercent)))]),c&&G.push([K("GiftAttributeBackdrop"),r.Ay.createElement("span",{className:_t.uniqueAttribute},c.name,r.Ay.createElement(L.A,null,(0,q.l9)(c.rarityPercent)))]),m&&G.push([K("GiftAttributeSymbol"),r.Ay.createElement("span",{className:_t.uniqueAttribute},m.name,r.Ay.createElement(L.A,null,(0,q.l9)(m.rarityPercent)))]),G.push([K("GiftInfoAvailability"),K("GiftInfoIssued",{issued:le.issuedCount,total:le.totalCount})]),d){const{date:e,recipientId:t,message:a,senderId:o}=d,l=(0,n.mS)(),c=e=>{P({id:e}),C()},m=(0,s.PVB)(l,t),u=o?(0,s.PVB)(l,o):void 0,A=(0,H.L2)(1e3*e,K.code,!0),p=r.Ay.createElement(rt.A,{onClick:()=>c(t),isPrimary:!0},(0,i.F9)(K,m));let f;if(u&&o!==t){const e=r.Ay.createElement(rt.A,{onClick:()=>c(u.id),isPrimary:!0},(0,i.F9)(K,u));f=a?K("GiftInfoPeerOriginalInfoTextSender",{peer:p,sender:e,text:(0,Kt.fd)(a),date:A},{withNodes:!0}):K("GiftInfoPeerOriginalInfoSender",{peer:p,date:A,sender:e},{withNodes:!0})}else f=a?K("GiftInfoPeerOriginalInfoText",{peer:p,text:(0,Kt.fd)(a),date:A},{withNodes:!0}):K("GiftInfoPeerOriginalInfo",{peer:p,date:A},{withNodes:!0});G.push([void 0,r.Ay.createElement("span",null,f)])}}const w=S&&ue&&le.giftAddress&&`${S}${le.giftAddress}`,B=r.Ay.createElement("div",{className:_t.footer},(ye||w||ve)&&r.Ay.createElement("div",{className:_t.footerDescription},w&&r.Ay.createElement("div",null,K("GiftInfoTonText",{link:r.Ay.createElement(f.A,{url:w,shouldSkipModal:!0,text:K("GiftInfoTonLinkText")})},{withNodes:!0})),ye&&r.Ay.createElement("div",null,K(`GiftInfo${te?"Channel":""}${c?"Hidden":"Saved"}`,{link:r.Ay.createElement(rt.A,{isPrimary:!0,onClick:Ge},K("GiftInfoSaved"+(c?"Show":"Hide")))},{withNodes:!0})),!ve&&y&&r.Ay.createElement("div",null,K("GiftInfoSenderHidden")),ve&&ke&&r.Ay.createElement("div",null,K("GiftInfoBuyGift",{user:ke},{withNodes:!0}))),Fe());return{modalHeader:ue?v:void 0,header:ue?k:I,tableData:G,footer:B}},[ae,ne,ee,ce,K,ye,me,ie,V,S,le,Ue,Fe,te,De,ue,Y,b,E,Oe,ve,ke,X,be,pe,l]);return r.Ay.createElement(r.Ay.Fragment,null,r.Ay.createElement(Ee.A,{isOpen:X,modalHeader:Le?.modalHeader,header:Le?.header,hasBackdrop:ue,tableData:Le?.tableData,footer:Le?.footer,className:_t.modal,onClose:Ce,withBalanceBar:Boolean(ve),currencyInBalanceBar:Se?.currency,isLowStackPriority:!0}),Ae&&v&&Boolean(Se)&&r.Ay.createElement(Wt.A,{isOpen:z,noDefaultTitle:!0,onClose:Me,confirmLabel:K("ButtonBuyGift",{stars:Se?.currency===N.ykW?(0,de.Ms)(K,Se.amount,{shouldConvertFromNanos:!0}):(0,de.U2)(K,Se.amount,{asFont:!0})},{withNodes:!0}),confirmHandler:Te},r.Ay.createElement(Jt,{peer:k||v,gift:Ae}),!k&&r.Ay.createElement("p",null,K("GiftBuyConfirmDescription",{gift:K("GiftUnique",{title:Ae.title,number:Ae.number}),stars:Se?.currency===N.ykW?(0,de.QH)(K,Se.amount,!0):(0,de.Kk)(K,Se.amount)},{withNodes:!0,withMarkdown:!0})),k&&r.Ay.createElement("p",null,K("GiftBuyForPeerConfirmDescription",{gift:K("GiftUnique",{title:Ae.title,number:Ae.number}),stars:Se?.currency===N.ykW?(0,de.QH)(K,Se.amount,!0):(0,de.Kk)(K,Se.amount),peer:(0,i.F9)(K,k)},{withNodes:!0,withMarkdown:!0})),!Ae.resaleTonOnly&&r.Ay.createElement(r.Ay.Fragment,null,r.Ay.createElement(Re.A,{className:_t.checkBox,label:K("LabelPayInTON"),checked:W,onCheck:_}),r.Ay.createElement("div",{className:_t.checkBoxDescription},K("DescriptionPayInTON")))),ne&&r.Ay.createElement(Wt.A,{isOpen:D,onClose:O,confirmHandler:Pe,title:K("GiftInfoConvertTitle")},r.Ay.createElement("div",null,K("GiftInfoPeerConvertDescription",{amount:(0,de.Kk)(K,ne.starsToConvert),peer:(0,i.F9)(K,Z)},{withNodes:!0,withMarkdown:!0})),me&&r.Ay.createElement("div",null,K("GiftInfoConvertDescriptionPeriod",{count:oe},{withNodes:!0,withMarkdown:!0,pluralValue:oe})),r.Ay.createElement("div",null,K("GiftInfoConvertDescription2"))))}));var Qt=a(40664);const Xt=(0,r.ph)((0,n.EK)(e=>{const t=e.appConfig?.starsStargiftResaleCommissionPermille,a=t?t/1e3:void 0,r=e.appConfig?.starsStargiftResaleAmountMin||0,n=e.appConfig?.starsStargiftResaleAmountMax,i=e.appConfig?.starsUsdWithdrawRateX1000,s=i?i/1e3:1,o=e.appConfig?.tonStargiftResaleCommissionPermille,c=o?o/1e3:0,m=(0,l.wD)(e.appConfig?.tonStargiftResaleAmountMin||0),d=e.appConfig?.tonStargiftResaleAmountMax,u=d&&(0,l.wD)(d),A=e.appConfig?.tonUsdRate;return{starsStargiftResaleCommissionPermille:a,starsStargiftResaleAmountMin:r,starsStargiftResaleAmountMax:n,starsUsdWithdrawRate:s,tonStargiftResaleCommissionPermille:c,tonStargiftResaleAmountMin:m,tonStargiftResaleAmountMax:u,tonUsdRate:A}})(({modal:e,starsStargiftResaleCommissionPermille:t,starsStargiftResaleAmountMin:a,starsStargiftResaleAmountMax:i,starsUsdWithdrawRate:s,tonStargiftResaleCommissionPermille:o,tonStargiftResaleAmountMin:c,tonStargiftResaleAmountMax:u,tonUsdRate:A})=>{const{closeGiftResalePriceComposerModal:p,closeGiftInfoModal:f,updateStarGiftPrice:h,showNotification:E}=(0,n.ko)(),b=Boolean(e),[S,v]=(0,r.J0)(void 0),[N,k]=(0,r.J0)(!1),C=(0,m.A)(e),{gift:I}=C||{},G=I&&"gift"in I?I:void 0,P=Boolean(S),w=(0,U.A)(),B=(0,d.A)(e=>{const t=e.target.value,a=parseFloat(t),r=N?u:i,n=""===t||Number.isNaN(a)?void 0:r?Math.min(a,r):a;v(n)}),M=(0,d.A)(()=>{p()}),T=(0,d.A)(()=>{G&&"starGiftUnique"===G.gift.type&&G.inputGift&&S&&(p(),f(),h({gift:G.inputGift,price:{currency:N?"TON":"XTR",amount:N?(0,l.tT)(S):S,nanos:0}}),E({icon:"sell-outline",message:{key:"NotificationGiftIsSale",variables:{gift:w("GiftUnique",{title:G.gift.title,number:G.gift.number})}}}))}),R=N?o:t,x=N?c:a,D=P&&S>=x;return r.Ay.createElement(g.A,{isOpen:b,title:w(N?"PriceInTON":"PriceInStars"),hasCloseButton:!0,isSlim:!0,onClose:M},r.Ay.createElement("div",{className:"ElDo1Bru"},r.Ay.createElement(Qt.A,{label:w(N?"EnterPriceInTon":"EnterPriceInStars"),onChange:B,value:S?.toString(),inputMode:"numeric",tabIndex:0,teactExperimentControlled:!N})),r.Ay.createElement("div",{className:"SGFmA4kL"},r.Ay.createElement("span",null,!D&&Boolean(R)&&w("DescriptionComposerGiftMinimumPrice",{stars:N?(0,de.QH)(w,x):(0,de.Kk)(w,x)},{withMarkdown:!0,withNodes:!0}),D&&(()=>{const e=R?Number((S*R).toFixed()):S;return w("DescriptionComposerGiftResalePrice",{stars:N?(0,de.QH)(w,e):(0,de.Kk)(w,e)},{withMarkdown:!0,withNodes:!0})})()),D&&Boolean(N?A:s)&&r.Ay.createElement("span",{className:"r9R0VR_w"},`≈ ${(0,l.Ad)(N?(0,l.C)(S,A):S*s,"USD",w.code)}`)),r.Ay.createElement(Re.A,{className:"yt_nODdj",label:w("OnlyAcceptTON"),checked:N,onCheck:k}),r.Ay.createElement("div",{className:"pWjQiY4m"},w("OnlyAcceptTONDescription")),r.Ay.createElement(y.A,{noForcedUpperCase:!0,disabled:!D,size:"smaller",onClick:T},D&&w("ButtonSellGift",{stars:N?(0,de.Ms)(w,S):(0,de.U2)(w,S,{asFont:!0})},{withNodes:!0}),!D&&w("Sell")))}));var Yt=a(58554),$t=a(32625),Zt=a(5463);const ea="_Dt6RSQV",ta=(0,r.ph)((0,n.EK)((e,{modal:t})=>{const a=t?.recipientId;return{recipient:a?(0,s.PVB)(e,a):void 0}})(({modal:e,recipient:t})=>{const{closeGiftUpgradeModal:a,upgradeGift:s}=(0,n.ko)(),o=Boolean(e),l=(0,m.A)(e),c=(0,m.A)(t),[u,A]=(0,r.J0)(!1),[p,f]=(0,r.J0)(),g=(0,U.A)(),h=(0,d.A)(()=>a()),E=(0,d.A)(()=>{const e=l?.gift;e?.inputGift&&(s({gift:e.inputGift,shouldKeepOriginalDetails:u,upgradeStars:e.alreadyPaidUpgradeStars?void 0:e.gift.upgradeStars}),h())}),b=(0,d.A)(()=>{l?.sampleAttributes&&f(function(e,t){const a=e.filter(e=>"model"===e.type&&e.name!==t?.model.name),r=e.filter(e=>"pattern"===e.type&&e.name!==t?.pattern.name),n=e.filter(e=>"backdrop"===e.type&&e.name!==t?.backdrop.name);return{model:a[Math.floor(Math.random()*a.length)],pattern:r[Math.floor(Math.random()*r.length)],backdrop:n[Math.floor(Math.random()*n.length)]}}(l.sampleAttributes,p))});(0,$t.A)(b,o?3e3:void 0,!0),(0,r.vJ)(()=>{o&&l?.sampleAttributes&&b()},[o,l?.sampleAttributes]),(0,r.vJ)(()=>{const e=l?.sampleAttributes;e&&[...e.filter(e=>"pattern"===e.type).map(e=>e.sticker),...e.filter(e=>"model"===e.type).map(e=>e.sticker)].map(e=>(0,k.Mw)(e,"full")).forEach(e=>{(0,Yt.hd)(e,Ze.qZ.BlobUrl)})},[l?.sampleAttributes]);const S=(0,r.Kr)(()=>{if(!p||!o)return;const e=l?.gift,t=[["diamond",g("GiftUpgradeUniqueTitle"),g("GiftUpgradeUniqueDescription")],["trade",g("GiftUpgradeTransferableTitle"),g("GiftUpgradeTransferableDescription")],["auction",g("GiftUpgradeTradeableTitle"),g("GiftUpgradeTradeableDescription")]],a=c?g("GiftPeerUpgradeText",{peer:(0,i.F9)(g,c)}):g("GiftUpgradeTextOwn");return{listItemData:t,header:r.Ay.createElement(Ne,{modelAttribute:p.model,backdropAttribute:p.backdrop,patternAttribute:p.pattern,title:g("GiftUpgradeTitle"),subtitle:a}),footer:r.Ay.createElement("div",{className:"EWaVCxY4"},!e&&r.Ay.createElement(y.A,{className:ea,size:"smaller",onClick:h},g("OK")),e&&r.Ay.createElement(r.Ay.Fragment,null,r.Ay.createElement(Re.A,{label:g("GiftUpgradeKeepDetails"),onCheck:A,checked:u}),r.Ay.createElement(y.A,{className:ea,size:"smaller",isShiny:!0,onClick:E},e.alreadyPaidUpgradeStars?g("GeneralConfirm"):g("GiftUpgradeButton",{amount:(0,de.U2)(g,e.gift.upgradeStars,{asFont:!0})},{withNodes:!0}))))}},[p,o,g,c,l?.gift,u]);return r.Ay.createElement(Zt.A,{isOpen:o,header:S?.header,footer:S?.footer,listItemData:S?.listItemData,hasBackdrop:!0,onClose:h})}));var aa=a(47483);const ra=(0,r.ph)((0,n.EK)(e=>({currentUser:(0,s.mBe)(e,e.currentUserId),isCurrentUserPremium:(0,s.g29)(e)}))(({modal:e,currentUser:t,isCurrentUserPremium:a})=>{const{closeGiftStatusInfoModal:i,setEmojiStatus:s}=(0,n.ko)(),l=(0,U.A)(),c=Boolean(e),u=(0,m.A)(e),{emojiStatus:f}=u||{},g=f?.textColor,h=(0,aa.A)(f?.patternDocumentId),E=(0,d.A)(()=>{i()}),b=(0,d.A)(()=>{f&&s({emojiStatus:f}),i()}),S=(0,r.Kr)(()=>{if(!f||!c)return;const e=[f.centerColor,f.edgeColor],t=f.patternColor;return r.Ay.createElement(Z.A,{className:"_1RfhkfB",backgroundColors:e,patternColor:t,patternIcon:h.customEmoji})},[f,c,h]),v=(0,r.Kr)(()=>({...t,emojiStatus:f}),[t,f]),N=(0,r.Kr)(()=>r.Ay.createElement("div",{className:"qL0cHbwS"},r.Ay.createElement("div",{className:(0,o.A)("t18QCmAb"),style:(0,Se.A)(g&&`color: ${g}`)},S,r.Ay.createElement(A.A,{peer:v,size:"jumbo",className:"JK2zOWA7"}),r.Ay.createElement(Ue.A,{peer:v,className:"lxxbgNCl",withEmojiStatus:!0,noFake:!0,noVerified:!0,statusSparklesColor:g}),r.Ay.createElement("p",{className:"MLMdxkUg",style:(0,Se.A)(g&&`color: ${g}`)},l("Online"))),r.Ay.createElement("div",{className:"q8w7tnmR"},r.Ay.createElement("div",{className:"wxg_5ou_"},l("UniqueStatusWearTitle",{gift:v?.emojiStatus?.title})),r.Ay.createElement("div",{className:"KSCLIMZm"},l("UniqueStatusBenefitsDescription")))),[g,S,v,l]),k=[["radial-badge",l("UniqueStatusBadgeBenefitTitle"),l("UniqueStatusBadgeDescription")],["unique-profile",l("UniqueStatusProfileDesignBenefitTitle"),l("UniqueStatusProfileDesignDescription")],["proof-of-ownership",l("UniqueStatusProofOfOwnershipBenefitTitle"),l("UniqueStatusProofOfOwnershipDescription")]],C=(0,r.Kr)(()=>{if(c)return r.Ay.createElement("div",{className:"VDrvalBo"},r.Ay.createElement(y.A,{size:"smaller",onClick:b},l("UniqueStatusWearButton"),!a&&r.Ay.createElement(p.A,{name:"lock-badge",className:"jiPObOWv"})))},[l,a,c]);return r.Ay.createElement(Zt.A,{isOpen:c,header:N,listItemData:k,footer:C,hasBackdrop:!0,onClose:E})}));var na=a(21309),ia=a(15535);const sa={header:"LQgz8Nlx",giftPreview:"hgs0ts_O",backdrop:"OnBhMaBw",description:"HBxB4QPY",arrow:"kXTOUpfb",noPassword:"BnqLhoKr"},oa={isCustomPeer:!0,avatarIcon:"fragment",title:"",customPeerAvatarColor:"#000000"},la=4.5*It.$,ca=(0,r.ph)((0,n.EK)(e=>{const{settings:{byKey:{hasPassword:t}},twoFaSettings:{hint:a}}=e;return{hasPassword:t,passwordHint:a}})(({modal:e,hasPassword:t,passwordHint:a})=>{const{closeGiftWithdrawModal:i,clearGiftWithdrawError:s,closeGiftInfoModal:o,processStarGiftWithdrawal:l,openSettingsScreen:c}=(0,n.ko)(),u=Boolean(e),[f,h]=(0,r.J0)(!1),E=(0,U.A)(),b=(0,m.A)(e),S=b?.gift?.gift,v=S&&(0,Q.uc)(S),N=b?.gift?.canExportAt?Math.max(b.gift.canExportAt-(0,Lt.Fm)(),0):void 0,k=(0,d.A)(()=>{i()}),C=(0,d.A)(e=>{l({gift:b.gift.inputGift,password:e})}),I=(0,d.A)(()=>{c({screen:ye.VS.TwoFaDisabled}),i(),o()});return r.Ay.createElement(g.A,{isOpen:u,title:E("GiftWithdrawTitle"),hasCloseButton:!0,isSlim:!0,onClose:k},v&&r.Ay.createElement(r.Ay.Fragment,null,r.Ay.createElement("div",{className:sa.header},r.Ay.createElement("div",{className:sa.giftPreview},r.Ay.createElement(Z.A,{className:sa.backdrop,backgroundColors:[v.backdrop.centerColor,v.backdrop.edgeColor],patternColor:v.backdrop?.patternColor,patternIcon:v.pattern?.sticker}),r.Ay.createElement($.A,{className:sa.sticker,size:la,sticker:v.model?.sticker})),r.Ay.createElement(p.A,{name:"next",className:sa.arrow}),r.Ay.createElement(A.A,{peer:oa,size:"giant",className:sa.avatar})),r.Ay.createElement("p",{className:sa.description},E("GiftWithdrawDescription",{gift:`${S.title} #${S.number}`},{withNodes:!0,withMarkdown:!0,renderTextFilters:["br"]}))),Boolean(N)&&r.Ay.createElement("p",{className:sa.exportHint},E("GiftWithdrawWait",{days:(0,na._k)(N)},{pluralValue:(0,na._k)(N)})),!t&&r.Ay.createElement(r.Ay.Fragment,null,r.Ay.createElement("span",{className:sa.noPassword},E("ErrorPasswordMissing")),r.Ay.createElement(y.A,{className:"mt-2",size:"smaller",onClick:I},E("SetUp2FA"))),t&&!N&&r.Ay.createElement(ia.A,{shouldShowSubmit:!0,placeholder:E("CheckPasswordPlaceholder"),error:b?.errorKey&&E.withRegular(b?.errorKey),description:E("CheckPasswordDescription"),clearError:s,isLoading:b?.isLoading,hint:a,isPasswordVisible:f,shouldResetValue:u,onChangePasswordVisibility:h,submitLabel:E("GiftWithdrawSubmit"),onSubmit:C}))}));var ma=a(79824),da=a(74984),ua=a(24021),Aa=a(56863),pa=a(30857),fa=a(84080),ya=a(56133),ga=a(35297);function ha(){}async function Ea(e){const t=await(0,ua.px)("searchChats",{query:e});if(t)return[...t.accountResultIds,...t.globalResultIds]}const ba=(0,r.ph)((0,n.EK)(e=>{const{contactList:t,currentUserId:a}=e;return{contactIds:t?.userIds,currentUserId:a}})(({modal:e,contactIds:t,currentUserId:a})=>{const{closeGiftTransferModal:o,openGiftWithdrawModal:l,transferGift:c}=(0,n.ko)(),u=Boolean(e),A=(0,U.A)(),[p,f]=(0,r.J0)(""),y=(0,m.A)(e),g=y?.gift?.gift,h=g&&(0,Q.uc)(g),[E,b]=(0,r.J0)(),S=(0,m.A)(E),v=(0,r.Kr)(()=>{const e=(0,n.mS)();return S?(0,s.PVB)(e,S):void 0},[S]),k=(0,da.Rh)(N.DSF),w=(0,r.Kr)(()=>(0,C.Am)([...t||[],...k||[]]),[t,k]),{result:B,currentResultsQuery:M}=function({query:e,queryFn:t=Ea,defaultValue:a,debounceTimeout:n=300,isDisabled:i}){const s=function(e,t,a){const[n,i]=(0,r.J0)(),{isFrozen:s,updateWhenUnfrozen:o}=function(){const e=(0,r.li)(!1),t=(0,r.hb)(()=>{e.current=!0},[]),a=(0,pa.A)(),n=(0,r.hb)(()=>{e.current&&(e.current=!1,a())},[a]);return(0,fa.Ay)(ha,n),{isFrozen:(0,r.OV)(),updateWhenUnfrozen:t}}(),l=(0,ya.A)(t,!0);return(0,ga.A)(()=>{s?o():l(()=>{i(e())})},[...a,s]),n}(()=>e,n,[e]),[o,l]=(0,r.J0)(""),c=e?s:e,m=(0,d.A)(t);return{...(0,Aa.A)(async()=>{if(!c||i)return l(""),Promise.resolve(a);const e=await m(c);return l(c),e},[c,a,m,i],a),currentResultsQuery:o}}({query:p,defaultValue:w}),T=M!==p,R=(0,r.Kr)(()=>M?ma.p:[{type:"withdraw",isCustomPeer:!0,avatarIcon:"toncoin",peerColorId:5,title:A("GiftTransferTON")}],[A,M]),x=(0,d.A)(e=>{"withdraw"===e&&(l({gift:y.gift}),o())}),D=(0,r.Kr)(()=>{if(T)return ma.p;const e=(0,n.mS)();return(0,I.A)((B||[]).filter(t=>t!==a&&(0,s.X2D)(e,t)),!1)},[T,B,a]),F=(0,d.A)(()=>{b(void 0)});(0,r.vJ)(()=>{u||b(void 0)},[u]);const O=(0,d.A)(()=>{y?.gift.inputGift&&(c({gift:y.gift.inputGift,recipientId:S,transferStars:y.gift.transferStars}),F(),o())});return r.Ay.createElement(P.A,{isOpen:u,onClose:o,title:A("GiftTransferTitle"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0,ignoreFreeze:!0},r.Ay.createElement(G.A,{itemIds:D,categories:R,onSelectedCategoryChange:x,withDefaultPadding:!0,withPeerUsernames:!0,isSearchable:!0,noScrollRestore:!0,isLoading:T,filterValue:p,filterPlaceholder:A("Search"),onFilterChange:f,onSelectedIdChange:b}),h&&r.Ay.createElement(Wt.A,{isOpen:Boolean(E),noDefaultTitle:!0,onClose:F,confirmLabel:y?.gift.transferStars?A("GiftTransferConfirmButton",{amount:(0,de.U2)(A,y.gift.transferStars,{asFont:!0})},{withNodes:!0}):A("GiftTransferConfirmButtonFree"),confirmHandler:O},v&&r.Ay.createElement(Jt,{peer:v,gift:g}),r.Ay.createElement("p",null,y?.gift.transferStars?A("GiftTransferConfirmDescription",{gift:A("GiftUnique",{title:g.title,number:g.number}),amount:(0,de.Kk)(A,y.gift.transferStars),peer:(0,i.F9)(A,v)},{withNodes:!0,withMarkdown:!0}):A("GiftTransferConfirmDescriptionFree",{gift:A("GiftUnique",{title:g.title,number:g.number}),peer:(0,i.F9)(A,v)},{withNodes:!0,withMarkdown:!0}))))})),Sa=(0,r.ph)((0,n.EK)((e,{modal:t})=>({user:t?.userId?(0,s.mBe)(e,t.userId):void 0}))(({modal:e,user:t})=>{const{closeChatRefundModal:a,toggleNoPaidMessagesException:s}=(0,n.ko)(),[o,l]=(0,r.J0)(!1),c=(0,m.A)(e),u=(0,m.A)(t),{starsToRefund:A,userId:p}=c||{},f=(0,U.A)(),y=Boolean(e),g=(0,d.A)(()=>{a(),p&&s({userId:p,shouldRefundCharged:o})});return r.Ay.createElement(Wt.A,{isOpen:y,onClose:a,title:f("RemoveFeeTitle"),confirmLabel:f("ConfirmRemoveMessageFee"),confirmHandler:g},f("ConfirmDialogMessageRemoveFee",{peer:u&&(0,i.F9)(f,u)},{withMarkdown:!0,withNodes:!0}),Boolean(A)&&r.Ay.createElement(Re.A,{className:"dialog-checkbox",label:f("ConfirmDialogRemoveFeeRefundStars",{amount:(0,de.Kk)(f,A)},{withMarkdown:!0,withNodes:!0}),checked:o,onCheck:l}))}));var va=a(14487);const Na=(0,r.ph)((0,n.EK)(e=>{const t=e.stars?.balance,a=e.ton?.balance?.amount;return{starBalance:t,tonBalance:a}})(({modal:e,starBalance:t,tonBalance:a})=>{const i=(0,n.ko)(),s=(0,U.A)(),o=(0,r.hb)(()=>{if(!e?.directInfo)return void i.closePriceConfirmModal();const{currency:r,newAmount:n}=e,s="TON"===r,o=s?a:t?.amount;if(void 0!==o){if(o<n)return i.openStarsBalanceModal({currency:s?"TON":"XTR",tabId:(0,va.g0)()}),void i.closePriceConfirmModal();i.sendStarPaymentForm({directInfo:e.directInfo,tabId:(0,va.g0)()}),i.closePriceConfirmModal()}else i.closePriceConfirmModal()},[e,t,a,i]),c=(0,r.hb)(()=>{i.closePriceConfirmModal()},[i]);if(!e)return;const{originalAmount:m,newAmount:d,currency:u}=e;let A,p;return"TON"===u?(A=(0,de.QH)(s,(0,l.wD)(m)),p=(0,de.QH)(s,(0,l.wD)(d))):(A=(0,de.Kk)(s,m),p=(0,de.Kk)(s,d)),r.Ay.createElement(Wt.A,{isOpen:Boolean(e),onClose:c,title:s("PriceChanged"),confirmHandler:o,confirmLabel:s("PayNewPrice")},r.Ay.createElement("p",null,s("PriceChangedText",{originalAmount:A,newAmount:p},{withMarkdown:!0,withNodes:!0})))}))}}]);
//# sourceMappingURL=6930.1ef8094763d6ef0b451e.js.map