(self.webpackChunkTeleGPT=self.webpackChunkTeleGPT||[]).push([[5529],{45:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var a=n(84051),s=n(41036),o=n(54746),r=function(e){return e[e.failed=0]="failed",e[e.pending=1]="pending",e[e.succeeded=2]="succeeded",e[e.read=3]="read",e}(r||{});const i=(0,a.ph)(({status:e})=>a.Ay.createElement("div",{className:"MessageOutgoingStatus"},a.Ay.createElement(s.Ay,{name:"reveal",activeKey:r[e]},"failed"===e?a.Ay.createElement("div",{className:"MessageOutgoingStatus--failed"},a.Ay.createElement(o.A,{name:"message-failed"})):a.Ay.createElement(o.A,{name:`message-${e}`}))))},285:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var a=n(84051),s=n(13439),o=n(90709),r=n(60919),i=n(4961),l=n(59030),c=n(94189);const d=(0,a.ph)((0,s.EK)((e,{userId:t})=>{const n=(0,r.meB)(e),a=t&&(0,r.mBe)(e,t);return{chat:n,contactName:a?(0,o.u0)(a):void 0}})(({isOpen:e,chat:t,userId:n,contactName:o,onClose:r})=>{const{deleteChatMember:d}=(0,s.ko)(),m=(0,l.A)(),u=(0,a.hb)(()=>{d({chatId:t.id,userId:n}),r()},[t,d,r,n]);if(t&&n)return a.Ay.createElement(c.A,{isOpen:e,onClose:r,title:m("GroupRemoved.Remove"),textParts:(0,i.A)(m("PeerInfo.Confirm.RemovePeer",o)),confirmLabel:m("lng_box_remove"),confirmHandler:u,confirmIsDestructive:!0})}))},1671:()=>{},2178:(e,t,n)=>{"use strict";n.d(t,{v:()=>i});var a=n(84051),s=n(46536);const o=new Set(["INPUT","TEXTAREA","SELECT"]),r=(0,s.h)();function i(e){(0,a.vJ)(()=>{if(!e)return;const t=Object.entries(e);return r.addCallback(function(e){(function(e){return!(e.target instanceof HTMLElement)||!o.has(e.target.tagName)})(e)&&t.forEach(([t,n])=>{(function(e){return t=>function(e,t){const{alt:n,ctrl:a,meta:s,mod:o,shift:r,key:i}=e,{altKey:l,ctrlKey:c,metaKey:d,shiftKey:m,key:u}=t;if(n!==l)return!1;if(o){if(!c&&!d)return!1}else{if(a!==c)return!1;if(s!==d)return!1}return r===m&&Boolean(i&&(u.toLowerCase()===i.toLowerCase()||t.code.replace("Key","").toLowerCase()===i.toLowerCase()))}(function(e){const t=e.toLowerCase().split("+").map(e=>e.trim()),n={alt:t.includes("alt"),ctrl:t.includes("ctrl"),meta:t.includes("meta"),mod:t.includes("mod"),shift:t.includes("shift")},a=["alt","ctrl","meta","shift","mod"];return{...n,key:t.find(e=>!a.includes(e))}}(e),t)})(t)(e)&&n(e)})})},[e])}document.documentElement.addEventListener("keydown",r.runCallbacks)},2429:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});const a={root:"CdTfL4f7",fadeIn:"MyeHARy0",closing:"EZbKn_M3",peer:"kW0xpExG",name:"BDZrSTO_",name_hasUnreadStory:"OoUm5AUZ",nameHasUnreadStory:"OoUm5AUZ",hidden:"lnVtxMZI",contextMenu:"N1sagA0s"}},3225:(e,t,n)=>{"use strict";n.d(t,{A:()=>E});var a=n(84051),s=n(13439),o=n(31481),r=n(66644),i=n(98221),l=n(96454),c=n(36353),d=n(39074),m=n(58734),u=n(63988),p=n(83414),h=n(19129),g=n(37661),A=n(17712);const y=300,f=new RegExp(`(${i.A.source})$`,"g"),v=new RegExp(`${o.bpX.source}$`,"g");function E(e,t,n,E,b,x){const{loadCustomEmojiForEmoji:w,clearCustomEmojiForEmoji:C}=(0,s.ko)(),[N,I,S]=(0,g.A)(!1),M=(0,u.gs)(()=>{const n=t();if(!e||!n||!E()?.collapsed)return;if(!n.match(l.TL?i.A:o.bpX))return;const a=(0,d.LV)(b.current);return a.match(l.TL?f:v)?.[0]},[t,E,b,e],y),k=(0,p.A)(M,[M,t,E],!0),T=(0,h.A)(()=>Boolean(k()),[k]),P=Boolean(x?.length);(0,a.vJ)(()=>{if(!e||!T)return;const t=k();if(t){if(!P){const e=l.TL?t:t.match(/.+alt="(.+)"/)?.[1];e&&w({emoji:e})}}else C()},[e,T,k,P,C,w]);const L=(0,A.A)(t=>{const a=k();if(!e||!a)return;const s=b.current,o=(0,d.LV)(s),i=l.TL?a:a.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),u=new RegExp(`(${i})\\1*$`,""),p=o.match(u)[0].length/a.length,h=o.replace(u,(0,m.hB)(t).repeat(p)),g=s.innerHTML.substring(o.length);n(`${h}${g}`),(0,r.Uz)(()=>{(0,c.A)(s,!0,!0)})});return(0,a.vJ)(S,[S,t]),{isCustomEmojiTooltipOpen:Boolean(T&&P&&!N),closeCustomEmojiTooltip:I,insertCustomEmoji:L}}},4955:(e,t,n)=>{"use strict";n.d(t,{$:()=>o});var a=n(96540),s=n(22199);const o=({className:e,disabled:t,onClick:n,children:o})=>a.createElement("button",{className:(0,s.cn)("w-[40px] h-[40px] p-[5px] border-none rounded-full box-border flex items-center justify-center hover:bg-[var(--color-interactive-element-hover)]",e),onClick:n,disabled:t},o)},5130:(e,t,n)=>{"use strict";n.d(t,{U:()=>i});var a=n(14235),s=n(37836);function o(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class r{constructor(e,t,n){this.target=e,this.onUpdate=t,this.channel=n,o(this,"requestStates",new Map),o(this,"requestStatesByCallback",new Map),o(this,"pendingPayloads",[]),o(this,"pendingTransferables",[]),o(this,"postMessagesOnTickEnd",(0,s.Fe)(()=>{const{channel:e}=this,t=this.pendingPayloads,n=this.pendingTransferables;this.pendingPayloads=[],this.pendingTransferables=[],this.target.postMessage({channel:e,payloads:t},n)}))}destroy(){}init(...e){this.postMessageOnTickEnd({type:"init",args:e})}request(e){const{requestStates:t,requestStatesByCallback:n}=this,{transferables:s,...o}=e,r=(0,a.A)(),i={type:"callMethod",messageId:r,...o},l={messageId:r},c=new Promise((e,t)=>{Object.assign(l,{resolve:e,reject:t})});if("function"==typeof i.args[i.args.length-1]){i.withCallback=!0;const e=i.args.pop();l.callback=e,n.set(e,l)}return t.set(r,l),c.catch(()=>{}).finally(()=>{t.delete(r),l.callback&&n.delete(l.callback)}),this.postMessageOnTickEnd(i,s),c}cancelCallback(e){e.isCanceled=!0;const{messageId:t}=this.requestStatesByCallback.get(e)||{};t&&this.postMessageOnTickEnd({type:"cancelProgress",messageId:t})}onMessage(e){const{requestStates:t,channel:n}=this;e.channel===n&&e.payloads.forEach(e=>{if("update"===e.type&&this.onUpdate&&this.onUpdate(e.update),"methodResponse"===e.type){const n=t.get(e.messageId);n&&(e.error?n.reject(e.error):n.resolve(e.response))}else if("methodCallback"===e.type){const n=t.get(e.messageId);n?.callback?.(...e.callbackArgs)}else if("unhandledError"===e.type)throw new Error(e.error?.message)})}postMessageOnTickEnd(e,t){this.pendingPayloads.push(e),t&&this.pendingTransferables.push(...t),this.postMessagesOnTickEnd()}}function i(e,t,n){const a=new r(e,t,n);function s({data:e}){a.onMessage(e)}return e.addEventListener("message",s),a.destroy=()=>{e.removeEventListener("message",s)},a}},5244:(e,t,n)=>{"use strict";n.d(t,{B:()=>Vt});var a=n(96540),s=n(32017),o=n.n(s),r=n(92508),i=n(75304);var l=n(22199),c=n(46942),d=n.n(c),m=n(66221),u=n(57674),p=n(8235);const h=["Who is interested in early investments in GameFi projects?","Which meme KOLs are worth following?","Which of my contacts interacts with Paulo the most?","Which friends do Paulo and I share?","Find messages about Twitter Space collaboration."],g=e=>{const{handleSearch:t}=e;return a.createElement("div",{className:"flex flex-col mx-[22px]"},a.createElement("img",{className:"w-[52px] h-[52px] rounded-full",src:p,alt:""}),a.createElement("span",{className:"font-bold text-[24px]"},"AI Search"),a.createElement("span",{className:"mb-[12px] text-[14px]"},"Intelligent deep search experience."),h.map(e=>a.createElement("div",{className:"px-[10px] py-[6px] mb-[8px] rounded-[8px] bg-[#F8F2FF] text-[14px]",onClick:()=>t(e)},e)))};var A=n(13439),y=n(72531),f=n(60919),v=n(87357),E=n(58324),b=n(77787);const x=()=>{const e=(0,A.mS)(),{currentUserId:t}=e,n=t?(0,f.mBe)(e,t):void 0,{scrollToBottom:s}=(0,i.R)();return a.createElement("div",{className:"global-summary-introduce"},a.createElement("h3",null,"Hi ",[n?.firstName,n?.lastName].filter(Boolean).join(" ")," 👋"),a.createElement("h3",null,"How can I help you today！"),a.createElement("div",{className:"rounded-[16px] p-[15px] grid grid-cols-2 gap-[12px] w-[743px] mt-[10px] mb-[20px] bg-[var(--color-background)]"},a.createElement("div",{className:(0,v.A)("rf6B3If7","global-summary-introduce-item"),onClick:()=>{const e=(0,E.n5)();b.zs.summary?.storeMessage(e),y.A.emit(y.E.AddSummaryMessage,e),s()}},a.createElement("div",{className:"text-[18px] font-bold mb-[10px] text-[var(--color-text)]"},"📝 AI Summary"),a.createElement("div",{className:"text-[14px] leading-[18px] text-[var(--color-text-secondary)] pr-[120px]"},"Get instant, clear takeaways during the chat")),a.createElement("div",{className:(0,v.A)("dJsvi1dH","global-summary-introduce-item"),onClick:()=>{const e=(0,E.sh)();b.zs.summary?.storeMessage(e),y.A.emit(y.E.AddSummaryMessage,e),s()}},a.createElement("div",{className:"text-[18px] font-bold mb-[10px] text-[var(--color-text)]"},"✅ Action Items"),a.createElement("div",{className:"text-[14px] leading-[18px] text-[var(--color-text-secondary)] pr-[120px]"},"Automatically capture next steps and assignments.")),a.createElement("div",{className:(0,v.A)("o3wMHYSu","global-summary-introduce-item"),onClick:()=>{const e=(0,E.w7)();b.zs.summary?.storeMessage(e),y.A.emit(y.E.AddSummaryMessage,e),s()}},a.createElement("div",{className:"text-[18px] font-bold mb-[10px] text-[var(--color-text)]"},"📚️ Translation & Grammar Check"),a.createElement("div",{className:"text-[14px] leading-[18px] text-[var(--color-text-secondary)] pr-[120px]"},"Communicate effortlessly, in any language.")),a.createElement("div",{className:(0,v.A)("rhP7CCVz","global-summary-introduce-item"),onClick:()=>{const e=(0,E.i9)();b.zs.summary?.storeMessage(e),y.A.emit(y.E.AddSummaryMessage,e),s()}},a.createElement("div",{className:"text-[18px] font-bold mb-[10px] text-[var(--color-text)]"},"🚀 Meeting Scheduler"),a.createElement("div",{className:"text-[14px] leading-[18px] text-[var(--color-text-secondary)] pr-[120px]"},"Book and organize meetings with ease."))),a.createElement("div",null,a.createElement("h5",{className:"text-[16px] font-normal mb-[16px]"}," You can also ask me like this"),a.createElement("div",{className:"flex flex-row flex-wrap gap-[12px]"},a.createElement("div",{className:"p-[8px] rounded-[16px] text-[14px] text-[var(--color-text)] bg-[var(--color-background)]"},"Summarize unread messages"),a.createElement("div",{className:"p-[8px] rounded-[16px] text-[14px] text-[var(--color-text)] bg-[var(--color-background)]"},"What are the most discussed crypto today?"),a.createElement("div",{className:"p-[8px] rounded-[16px] text-[14px] text-[var(--color-text)] bg-[var(--color-background)]"},"Help me schedule a meeting for 10 AM tomorrow"))))};var w=n(89027),C=n(48862);let N=null;const I={};function S(e){const[t,n]=(0,a.useState)(!1),s=(0,a.useRef)(null);return(0,a.useEffect)(()=>(I[e]=e=>n(e),()=>{delete I[e]}),[e]),{isSpeaking:t,speak:(t,n={})=>{(speechSynthesis.speaking||speechSynthesis.pending)&&speechSynthesis.cancel();const a=new SpeechSynthesisUtterance(t);Object.assign(a,n),N=e,s.current=a,a.onend=()=>{N===e&&(I[e]?.(!1),N=null)},a.onerror=()=>{N===e&&(I[e]?.(!1),N=null)},Object.entries(I).forEach(([t,n])=>n(t===e)),speechSynthesis.speak(a)},stop:()=>{N===e&&(speechSynthesis.speaking||speechSynthesis.pending)&&(speechSynthesis.cancel(),I[e]?.(!1),N=null)}}}var M=n(70809);const k=({message:e,canCopy:t,canVoice:n,canShare:s,canDelete:o,onClickShare:r,onDelete:i})=>{const{showNotification:l}=(0,A.ko)(),{isSpeaking:c,speak:d,stop:m}=S(e.id),u=(0,a.useRef)(void 0),p=(0,a.useCallback)(()=>{if(!u.current)return"";const e=u.current.closest("[data-message-container]");if(!e)return"";const t=e.querySelectorAll("[data-readable], [data-readable-inline]"),n=[];let a="";return t.forEach(e=>{const t=e.textContent?.trim();t&&(e.hasAttribute("data-readable-inline")?a=a?`${a} ${t}`:t:(a&&(n.push(a),a=""),n.push(t)))}),a&&n.push(a),n.join("\n")},[]);return a.createElement("div",{ref:u,className:"flex items-center gap-[8px] py-[6px]"},t&&a.createElement("div",{className:"w-[24px] h-[24px] text-[#676B74] cursor-pointer",onClick:()=>{const e=p();e?navigator.clipboard.writeText(e).then(()=>{l({message:"Copy successful"})}).catch(()=>{l({message:"Copy failed"})}):l({message:"No text to copy"})}},a.createElement(M.Td,{size:24})),n&&a.createElement("div",{className:"w-[24px] h-[24px] text-[#676B74] cursor-pointer",onClick:()=>{const e=p();if(c)m();else if(e)try{d(e)}catch(e){l({message:"语音播放失败"})}else l({message:"没有可播放的内容"})}},c?a.createElement(M.ON,{size:24}):a.createElement(M.S,{size:24})),s&&a.createElement("div",{className:"w-[24px] h-[24px] text-[#676B74] cursor-pointer",onClick:r},a.createElement(M.A,{size:24})),o&&a.createElement("div",{className:"w-[20px] h-[20px] cursor-pointer",onClick:i},a.createElement(M.d7,{size:20})))};var T=n(81008),P=n(29356),L=n(99299),B=n(89116);const R=n.p+"actions.c226eff441fdabe1f4ee.png";var F=n(11553);const D=n.p+"check.0abcdabedcbc8ca0f4e8.png";var O=n(23814),z=n(40842),j=n(30934),U=n(9716);function V(e,t){const n=e=>e.toString().length<=10?1e3*e:e,a=e?new Date(n(e)):void 0,s=t?new Date(n(t)):void 0,o=new Date,r=e=>{return n=o,(t=e).getFullYear()===n.getFullYear()&&t.getMonth()===n.getMonth()&&t.getDate()===n.getDate();var t,n},i=e=>{const t=e=>String(e).padStart(2,"0");return`${t(e.getHours())}:${t(e.getMinutes())}`},l=e=>{return`${["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()]} ${t=e.getDate(),String(t).padStart(2,"0")} / ${i(e)}`;var t};return a||s?!a&&s?`${l(s)}`:a&&!s?`${l(a)}`:a&&s?r(a)&&r(s)?`${i(a)} - ${i(s)}`:`${l(a)} - ${l(s)}`:"":""}const J=({chatId:e,classNames:t,size:n,style:s,tooltip:o})=>{const r=(0,A.mS)();let i;return i=(0,U.L8)(e)?(0,f.mBe)(r,e):(0,f.hds)(r,e),a.createElement(T.A,{style:s,key:e,className:(0,l.cn)(t,"overlay-avatar inline-block cursor-pointer"),size:n,peer:i,tooltip:o})},H=({chatId:e,topicItem:t})=>{const{openDrawer:n}=(0,B.S)();return a.createElement(L.A,null,a.createElement("ul",{className:"list-disc pl-[18px] text-[16px] list-inside"},t.map(t=>{const{content:s,relevantMessageIds:o}=t;return s?a.createElement("li",{role:"button",className:"cursor-pointer text-[15px] break-words",onClick:()=>((e,t)=>{n(B.N.OriginalMessages,{relevantMessages:[{chatId:e,messageIds:t}]})})(e,o),"data-readable":!0},s):null})))},K=({pendingItem:e})=>{const{openDrawer:t}=(0,B.S)();return a.createElement(L.A,null,a.createElement("div",{className:"flex gap-[8px] my-[4px] cursor-pointer",key:e.chatId,onClick:()=>{t(B.N.OriginalMessages,{relevantMessages:[{chatId:e.chatId,messageIds:e.relevantMessageIds}]})}},a.createElement("img",{className:"w-[18px] h-[18px] mt-[2px]",src:D,alt:""}),a.createElement("span",{className:"text-[15px]","data-readable":!0},e.summary),a.createElement(J,{size:20,chatId:e.chatId})))},$=({garBageItem:e})=>{const{chatId:t,chatRoomName:n,level:s,summary:o,relevantMessageIds:r}=e,{openDrawer:i}=(0,B.S)();if((0,U.L8)(t))return a.createElement(L.A,null,a.createElement("div",{className:"flex justify-start gap-[8px] my-[16px]",key:e.chatId,onClick:()=>{((e,t)=>{i(B.N.OriginalMessages,{relevantMessages:[{chatId:e,messageIds:t}]})})(t,r)}},a.createElement(J,{chatId:t,size:44}),a.createElement("div",null,a.createElement("p",{className:"text-[16px] font-semibold leading-[20px] mb-[4px]"},n),a.createElement("div",{className:"flex justify-start gap-[4px]"},"high"===s?a.createElement("span",{className:"text-[#FF543D] text-[14px] whitespace-nowrap"},"🔴 High-Risk"):a.createElement("span",{className:"text-[#FF9B05] text-[14px] whitespace-nowrap"},"🟡 Low-Risk"),a.createElement("span",{className:"text-[14px] text-[var(--color-text-secondary)]"},o)))))},G=({summaryInfo:e})=>a.createElement(L.A,null,a.createElement("div",{className:"mb-[6px]"},a.createElement("div",{className:"flex items-center gap-[8px]"},a.createElement("img",{className:"w-[52px] h-[52px] rounded-full ml-[-60px]",src:p,alt:""}),a.createElement("div",null,a.createElement("p",{className:"text-[16px] font-semibold"},"Tely AI"),e?.summaryEndTime?a.createElement("p",{className:"text-[14px] text-[#A8A6AC]"},(0,l.Ey)(e.summaryEndTime)):null)),a.createElement("p",{className:"text-[22px] font-bold mb-[16px]","data-readable":!0},"Chat Summary"),a.createElement("div",{className:"flex items-center gap-[20px]"},a.createElement("p",{className:"flex items-center gap-[8px]"},a.createElement("img",{className:"w-[16px] h-[16px]",src:F,alt:""}),a.createElement("div",{className:"flex items-center gap-[4px]"},a.createElement("span",{className:"mr-[4px] font-bold text-[14px]","data-readable":!0,"data-readable-inline":!0},"Time range:"),a.createElement("span",{"data-readable":!0,"data-readable-inline":!0},V(e?.summaryStartTime,e?.summaryEndTime)))),a.createElement("p",{className:"flex items-center gap-[8px]"},a.createElement("img",{className:"w-[16px] h-[16px]",src:O,alt:""}),a.createElement("div",{className:"flex items-center gap-[4px]"},a.createElement("span",{className:"font-bold text-[14px]","data-readable":!0,"data-readable-inline":!0},"Messages:"),e?.summaryMessageCount?a.createElement("span",{"data-readable":!0,"data-readable-inline":!0},e?.summaryMessageCount):null))),e?.summaryChatIds?a.createElement("div",{className:"flex items-center gap-[8px]"},a.createElement("img",{className:"w-[16px] h-[16px]",src:z,alt:""}),a.createElement("span",{className:"font-bold text-[14px]"},"Groups/friends: "),a.createElement("div",{className:"flex items-center"},e.summaryChatIds.slice(0,10).map((t,n)=>a.createElement(J,{style:{zIndex:`${String(e.summaryChatIds.length-n)};`},chatId:t,size:24,classNames:"summary-avatar-group !border-solid-[2px] !border-white ml-[-4px]",key:t})),e.summaryChatIds.length>10?a.createElement("div",{className:"w-[24px] h-[24px] rounded-full bg-[#979797] text-[12px] whitespace-nowrap flex items-center justify-center"},e.summaryChatIds.length-10,"+"):null)):null)),_=({chatId:e,handleIgnore:t})=>a.createElement("div",{className:"flex items-center gap-[4px] cursor-pointer transition-colors duration-200 text-[14px] text-[var(--color-text)]",onClick:()=>t(e)},a.createElement(P.A,{name:"eye-crossed"}),a.createElement("span",{className:"font-semibold"},"Ignore this chat")),q=({messageId:e,summaryInfo:t,summaryTopic:n,pendingMatters:s,deleteMessage:o})=>{const{ignored_summary_chat_ids:r}=C.Hk.telegptSettings,i=(0,C.rB)(r),[l,c]=(0,a.useState)(i),d=(0,a.useCallback)(e=>{const t=[...new Set([...l,e])],n=(0,C.EM)(t);c(t),C.Hk.setSettingOption({ignored_summary_chat_ids:n},e=>{0===e.code&&(0,A.ko)().showNotification({message:"This chat will no longer be included in future summaries."})})},[l]);return a.createElement("div",{className:"w-max-[693px] rounded-[10px] pl-[82px] pr-[25px] pt-[20px] pb-[25px] bg-[var(--color-background)]","data-message-container":!0},t&&a.createElement(G,{summaryInfo:t}),n.length>0&&a.createElement("div",null,a.createElement("p",{className:"flex items-center gap-[8px] mb-[16px]"},a.createElement("span",{className:"text-[18px] font-bold","data-readable":!0},"Key Topics"),a.createElement("img",{className:"w-[16px] h-[16px]",src:j,alt:""})),n.map((e,t)=>a.createElement("div",null,a.createElement("div",{className:"flex items-center justify-between gap-[8px]"},l.includes(e.chatId)?a.createElement("div",{className:"flex items-center gap-[8px]"},a.createElement("p",{className:"text-[16px] font-bold","data-readable":!0},t+1,".",e.chatRoomName),a.createElement(J,{size:20,chatId:e.chatId})):a.createElement(w.A,{className:"room-info-popover",placement:"top",content:a.createElement(_,{chatId:e.chatId,handleIgnore:d})},a.createElement("div",{className:"flex items-center gap-[8px]"},a.createElement("p",{className:"text-[16px] font-bold","data-readable":!0},t+1,".",e.chatRoomName),a.createElement(J,{size:20,chatId:e.chatId})))),a.createElement("ul",{className:"list-disc pl-[2px] text-[16px] list-inside"},e.mainTopics.length>0&&a.createElement("li",null,a.createElement("span",{className:"text-[16px] font-bold","data-readable":!0},"Key Points"),a.createElement(H,{chatId:e.chatId,topicItem:e.mainTopics})),e.customTopics.length>0&&e.customTopics.map(t=>a.createElement("li",null,a.createElement("span",{className:"text-[16px] font-bold","data-readable":!0},t.topicName),a.createElement(H,{chatId:e.chatId,topicItem:t.summaryItems}))))))),s.length>0&&a.createElement("div",null,a.createElement("p",{className:"flex items-center gap-[8px] mb-[16px]"},a.createElement("span",{className:"text-[18px] font-bold","data-readable":!0},"Actions Items"),a.createElement("img",{className:"w-[16px] h-[16px]",src:R,alt:""})),s.map(e=>a.createElement(K,{pendingItem:e}))),a.createElement(k,{canCopy:!0,canVoice:!0,canDelete:!0,onDelete:o,message:{id:e}}))},W=({messageId:e,summaryInfo:t,summaryTopic:n,pendingMatters:s,garbageMessage:o,deleteMessage:r})=>a.createElement(a.Fragment,null,n.length||s.length?a.createElement(q,{messageId:e,summaryInfo:t,summaryTopic:n,pendingMatters:s,deleteMessage:r}):null,o&&o.length>0&&a.createElement("div",{className:"w-max-[693px] rounded-[10px] bg-[var(--color-background)] pl-[82px] pr-[25px] pt-[20px] pb-[25px] mt-[10px]"},a.createElement("div",{className:"flex items-center gap-[8px]"},a.createElement("img",{className:"w-[52px] h-[52px] rounded-full ml-[-60px]",src:p,alt:""}),a.createElement("div",null,a.createElement("p",{className:"text-[16px] font-semibold"},"Tely AI"),t?.summaryEndTime?a.createElement("p",{className:"text-[14px] text-[#A8A6AC]"},(0,l.Ey)(t.summaryEndTime)):null)),a.createElement("p",{className:"text-[22px] font-bold mb-[16px]"},"Spam Filtering"),a.createElement("div",{className:"flex items-center gap-[20px]"},a.createElement("p",{className:"flex items-center gap-[8px]"},a.createElement("img",{className:"w-[16px] h-[16px]",src:F,alt:""}),a.createElement("div",{className:"flex items-center"},a.createElement("span",{className:"mr-[4px]"},"Time range:"),V(t?.summaryStartTime,t?.summaryEndTime)))),o.map(e=>a.createElement($,{garBageItem:e})))),Q=e=>{const{message:t,deleteMessage:n}=e,[s,o]=(0,a.useState)(null),[r,i]=(0,a.useState)([]),[l,c]=(0,a.useState)([]),[d,m]=(0,a.useState)([]),u=(0,a.useCallback)(e=>{const t=JSON.parse(e),{mainTopic:n=[],pendingMatters:a,garbageMessage:s,customTopic:r=[],summaryInfo:l}=t;a&&i(a),s&&c(s),l&&o(l);const d=function(e,t){const n=new Map;if(e.length>0)for(const t of e){const e=t.chatId;n.has(e)?n.get(e).mainTopics.push(...t.summaryItems||[]):n.set(e,{chatId:t.chatId,chatRoomName:t.chatRoomName,mainTopics:t.summaryItems||[],customTopics:[]})}if(t.length>0)for(const e of t){const t=e.chatId;n.has(t)?n.get(t).customTopics.push({topicName:e.topicName,summaryItems:e.summaryItems||[]}):n.set(t,{chatId:e.chatId,chatRoomName:e.chatRoomName,mainTopics:[],customTopics:[{topicName:e.topicName,summaryItems:e.summaryItems||[]}]})}return Array.from(n.values())}(n,r);m(d)},[]);return(0,a.useEffect)(()=>{try{u(t.content)}catch(e){console.error(e)}},[t,u]),s?a.createElement(W,{messageId:t.id,summaryInfo:s,summaryTopic:d,pendingMatters:r,garbageMessage:l,deleteMessage:n}):null};var Y=n(92629),Z=n(39875),X=n(5131),ee=n(42754),te=n(91393),ne=n(21468),ae=n(74353),se=n.n(ae),oe=n(85325),re=n(80395),ie=n(95533),le=n(71847);const ce={"Pacific/Midway":"Midway Island, Samoa","Pacific/Honolulu":"Hawaii","America/Juneau":"Alaska","America/Boise":"Mountain Time","America/Dawson":"Dawson, Yukon","America/Chihuahua":"Chihuahua, La Paz, Mazatlan","America/Phoenix":"Arizona","America/Chicago":"Central Time","America/Regina":"Saskatchewan","America/Mexico_City":"Guadalajara, Mexico City, Monterrey","America/Belize":"Central America","America/Detroit":"Eastern Time","America/Bogota":"Bogota, Lima, Quito","America/Caracas":"Caracas, La Paz","America/Santiago":"Santiago","America/St_Johns":"Newfoundland and Labrador","America/Sao_Paulo":"Brasilia","America/Tijuana":"Tijuana","America/Montevideo":"Montevideo","America/Argentina/Buenos_Aires":"Buenos Aires, Georgetown","America/Godthab":"Greenland","America/Los_Angeles":"Pacific Time","Atlantic/Azores":"Azores","Atlantic/Cape_Verde":"Cape Verde Islands",GMT:"UTC","Europe/London":"Edinburgh, London","Europe/Dublin":"Dublin","Europe/Lisbon":"Lisbon","Africa/Casablanca":"Casablanca, Monrovia","Atlantic/Canary":"Canary Islands","Europe/Belgrade":"Belgrade, Bratislava, Budapest, Ljubljana, Prague","Europe/Sarajevo":"Sarajevo, Skopje, Warsaw, Zagreb","Europe/Brussels":"Brussels, Copenhagen, Madrid, Paris","Europe/Amsterdam":"Amsterdam, Berlin, Bern, Rome, Stockholm, Vienna","Africa/Algiers":"West Central Africa","Europe/Bucharest":"Bucharest","Africa/Cairo":"Cairo","Europe/Helsinki":"Helsinki, Kyiv, Riga, Sofia, Tallinn, Vilnius","Europe/Athens":"Athens","Asia/Jerusalem":"Jerusalem","Africa/Harare":"Harare, Pretoria","Europe/Moscow":"Istanbul, Minsk, Moscow, St. Petersburg, Volgograd","Asia/Kuwait":"Kuwait, Riyadh","Africa/Nairobi":"Nairobi","Asia/Baghdad":"Baghdad","Asia/Tehran":"Tehran","Asia/Dubai":"Abu Dhabi, Muscat","Asia/Baku":"Baku, Tbilisi, Yerevan","Asia/Kabul":"Kabul","Asia/Yekaterinburg":"Ekaterinburg","Asia/Karachi":"Islamabad, Karachi, Tashkent","Asia/Kolkata":"Chennai, Kolkata, Mumbai, New Delhi","Asia/Kathmandu":"Kathmandu","Asia/Dhaka":"Astana, Dhaka","Asia/Colombo":"Sri Jayawardenepura","Asia/Almaty":"Almaty, Novosibirsk","Asia/Rangoon":"Yangon Rangoon","Asia/Bangkok":"Bangkok, Hanoi, Jakarta","Asia/Krasnoyarsk":"Krasnoyarsk","Asia/Shanghai":"Beijing, Chongqing, Hong Kong SAR, Urumqi","Asia/Kuala_Lumpur":"Kuala Lumpur, Singapore","Asia/Taipei":"Taipei","Australia/Perth":"Perth","Asia/Irkutsk":"Irkutsk, Ulaanbaatar","Asia/Seoul":"Seoul","Asia/Tokyo":"Osaka, Sapporo, Tokyo","Asia/Yakutsk":"Yakutsk","Australia/Darwin":"Darwin","Australia/Adelaide":"Adelaide","Australia/Sydney":"Canberra, Melbourne, Sydney","Australia/Brisbane":"Brisbane","Australia/Hobart":"Hobart","Asia/Vladivostok":"Vladivostok","Pacific/Guam":"Guam, Port Moresby","Asia/Magadan":"Magadan, Solomon Islands, New Caledonia","Asia/Kamchatka":"Kamchatka, Marshall Islands","Pacific/Fiji":"Fiji Islands","Pacific/Auckland":"Auckland, Wellington","Pacific/Tongatapu":"Nuku'alofa"};const de=n.p+"default-avatar.37bfde946e6829d2e5a8.png";var me=n(49804);const ue=e=>{const[t,n]=(0,a.useState)(""),[s,o]=(0,a.useState)(""),{lable:r}=e;return(0,a.useEffect)(()=>{switch(r){case"title":o(j),n("Title");break;case"time":o(F),n("Time");break;case"guests":o(z),n("Guests");break;case"meet":o(me),n("Meeting link")}},[r]),a.createElement("div",{className:"flex items-center gap-[8px]"},a.createElement("img",{src:s,alt:"",className:"w-[16px] h-[16px]"}),a.createElement("span",{className:"text-[14px] font-semibold"},t))},pe=({message:e})=>a.createElement("div",{className:"text-[12px] leading-[18px] text-red-400"},e),he=({email:e,onDelete:t})=>a.createElement("div",{className:"flex items-center gap-[8px] py-[10px]"},a.createElement("img",{className:"w-[24px] h-[24px] rounded-full",src:de,alt:""}),a.createElement("span",{className:"text-[14px] text-black"},e),a.createElement("div",{className:"ml-auto cursor-pointer w-[20px] h-[20px] rounded-full text-[#979797] bg-[#F3F3F3] flex items-center justify-center",onClick:()=>t(e)},a.createElement(M.US,{size:14}))),ge=({message:e})=>{const t=(0,a.useCallback)(e=>e&&e<se()().startOf("day"),[]),{options:n,parseTimezone:s}=function(){const e=ce,t=(0,a.useMemo)(()=>Object.entries(e).map(e=>{let t,n,a,s;try{const o=ie.A.now().goto(e[0]),r=o.isDST()?"daylight":"standard",i=o.timezone(),l=(0,le.A)(e[0]),c=null==(n=null==(t=null==l?void 0:l[0])?void 0:t[r])?void 0:n.abbr,d=null==(s=null==(a=null==l?void 0:l[0])?void 0:a[r])?void 0:s.name,m=60*i.current.offset,u=`${Math.floor(m/60)}:${m%60==0?"00":Math.abs(m%60)}`,p=`(GMT${u.includes("-")?u:`+${u}`}) ${e[1]}`;return{value:i.name,label:p,offset:i.current.offset,abbrev:c,altName:d}}catch(e){return null}}).filter(Boolean).sort((e,t)=>e.offset-t.offset),[e]);return{options:t,parseTimezone:e=>{return"string"==typeof e?t.find(t=>t.value===e)||-1!==e.indexOf("/")&&(e=>{let n,a,s;try{s=ie.A.now().goto(e)}catch(e){s=ie.A.now().goto("GMT")}return null==(a=null==(n=t.filter(e=>e.offset===s.timezone().current.offset).map(e=>{let t=0;return s.timezones[e.value.toLowerCase()]&&!!s.timezones[e.value.toLowerCase()].dst===s.timezone().hasDst?(-1!==e.value.toLowerCase().indexOf(s.tz.substring(s.tz.indexOf("/")+1))&&(t+=8),-1!==e.label.toLowerCase().indexOf(s.tz.substring(s.tz.indexOf("/")+1))&&(t+=4),-1!==e.value.toLowerCase().indexOf(s.tz.substring(0,s.tz.indexOf("/")))&&(t+=2),t+=1):"GMT"===e.value&&(t+=1),{tz:e,score:t}}).sort((e,t)=>t.score-e.score))?void 0:n[0])?void 0:a.tz})(e):"object"!=typeof(n=e)||Array.isArray(n)||null===n||e.label?e:t.find(t=>t.value===e.value);var n}}}(),{RangePicker:o}=Y.A,[r,i]=(0,a.useState)(""),[l,c]=(0,a.useState)(""),[d,m]=(0,a.useState)(""),[u,p]=(0,a.useState)(""),[h,g]=(0,a.useState)([]),[v,E]=(0,a.useState)(""),[b,x]=(0,a.useState)(""),[w,C]=(0,a.useState)(""),[N,I]=(0,a.useState)(!1),[S,M]=(0,a.useState)(Intl.DateTimeFormat().resolvedOptions().timeZone),k=(0,A.mS)(),T=(0,f.SJA)(k);(0,a.useEffect)(()=>{console.log("selectedTimezone",S)},[S]);const P=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),L=(0,a.useCallback)(e=>{i(e.target.value),e.target.value&&C("")},[]),B=(0,a.useCallback)(e=>{M(e.value)},[]),R=(0,a.useCallback)((e,t)=>{e&&(console.log("From: ",e[0],", to: ",e[1]),console.log("From: ",t[0],", to: ",t[1]),m(t[0]),p(t[1]),x(""))},[]),F=(0,a.useCallback)(e=>{c(e.target.value)},[]),D=(0,a.useCallback)(e=>{const t=e.target.value;t?P(t)?(g(e=>[...e,t]),c(""),E("")):E("Please enter the correct email address"):c("")},[]),O=(0,a.useCallback)(e=>{const t=e.currentTarget.value;t?P(t)?(g(e=>[...e,t]),c(""),E("")):E("Please enter the correct email address"):c("")},[]),z=(0,a.useCallback)(e=>{g(t=>t.filter(t=>t!==e))},[]),j=(0,a.useCallback)(()=>{if(N)return;if(!r)return void C("Please enter the title");if(!d||!u)return void x("Please select the date");if(!h.length)return void E("Please enter the email");I(!0);const t=(0,re.IM)(),n=[];h.length&&h.forEach(e=>{n.push({email:e})}),(0,oe.FG)({title:r,startDate:new Date(d),endDate:new Date(u),selectedTimezone:S,emails:h,googleToken:t?.accessToken}).then(t=>{y.A.emit(y.E.CreateCalendarSuccess,{message:e,response:t})}).catch(e=>{console.log(e)}).finally(()=>{I(!1)})},[h,u,N,e,S,d,r]);return a.createElement(Z.Ay,{theme:{algorithm:"dark"===T?X.A.darkAlgorithm:X.A.defaultAlgorithm}},a.createElement("div",{className:"google-event-create-message px-[12px]"},a.createElement("div",{className:"p-[10px] border border-solid border-[#D9D9D9] rounded-[16px] w-[326px] bg-white dark:bg-[#292929] dark:border-[#292929]"},a.createElement("span",{className:"text-[14px] font-semibold mb-[16px]"},"Please tell me the event details. "),a.createElement("div",{className:"flex flex-col gap-[8px] mb-[12px]"},a.createElement(ue,{lable:"title"}),a.createElement(ee.A,{value:r,onChange:L}),w&&a.createElement(pe,{message:w})),a.createElement("div",{className:"flex flex-col gap-[8px] mb-[12px]"},a.createElement(ue,{lable:"time"}),a.createElement("div",{className:"flex flex-col items-center gap-[8px]"},a.createElement(o,{disabledDate:t,presets:[{label:a.createElement("span",{"aria-label":"Current Time to End of Day"},"Now ~ EOD"),value:()=>[se()(),se()().endOf("day")]}],showTime:!0,format:"YYYY/MM/DD HH:mm",onChange:R}),a.createElement(te.A,{className:"w-full",placeholder:"Please select",onChange:B,options:n,value:s(S)})),b&&a.createElement(pe,{message:b})),a.createElement("div",{className:"flex flex-col gap-[8px] mb-[12px]"},a.createElement(ue,{lable:"guests"}),a.createElement(ee.A,{value:l,onChange:F,onBlur:D,onPressEnter:O}),v&&a.createElement(pe,{message:v}),h.length>0&&h.map(e=>a.createElement(he,{email:e,key:e,onDelete:z}))),a.createElement(ne.Ay,{type:"primary",className:"!bg-[#8C42F0] w-full",htmlType:"submit",onClick:j,loading:N,disabled:N},"Confirm"))))};var Ae=n(10777),ye=n(8063),fe=n(11780);function ve({capturing:e=!1,children:t,captureCallback:n=()=>{}}){const s=(0,a.useRef)(void 0),o=(0,A.mS)(),{currentUserId:r}=o,i=(0,f.mBe)(o,r);return(0,a.useEffect)(()=>{s.current&&setTimeout(()=>{(0,Ae.ZR)(s.current,{width:330,pixelRatio:2,quality:1}).then(e=>{const t=new File([e],"telegpt.org.png",{type:"image/png"});globalThis?.p__handleFileSelect?.([t],!0),n()})},100)},[e,n]),e?a.createElement("div",{className:"fixed top-0 left-0 translate-x-[-1000000px] translate-y-[-100000px]"},a.createElement("div",{ref:s,className:"relative w-[330px] box-content overflow-hidden bg-white text-black"},a.createElement("div",{className:"absolute top-0 left-0 w-full blur-xl pointer-events-none"},a.createElement("img",{src:fe,alt:"",className:"w-full"})),a.createElement("div",{className:"relative py-3 px-4 flex flex-col gap-2"},a.createElement("div",{className:"flex flex-row justify-end items-center gap-2 text-xs text-[#979797]"},a.createElement(T.A,{className:"w-[20px] h-[20px]",peer:i}),a.createElement("span",null,i?.firstName),a.createElement("span",null,i?.lastName)),a.createElement("div",{className:"text-[20px] font-bold"},"Meeting Invitation"),t),a.createElement("section",{className:"flex flex-row gap-1 items-center justify-center py-2 text-xs bg-[#F7FAFF]"},a.createElement("img",{className:"inline w-[20px] h-[20px] rounded-full",src:p,alt:"Serena"}),"Powered by",a.createElement("span",{className:"text-[#2996FF]"},"telepgt.org")))):null}const Ee=({message:e})=>{const[t,n]=(0,a.useState)(null),[s,o]=(0,a.useState)(!1);if((0,a.useEffect)(()=>{try{const t=JSON.parse(e.content);n(t)}catch(e){console.error("Error parsing message content:",e)}},[e]),!t)return null;const r=a.createElement(a.Fragment,null,a.createElement("div",null,a.createElement(ue,{lable:"title","data-readable":!0}),a.createElement("span",{className:"text-[14px]","data-readable":!0},t?.summary)),a.createElement("div",null,a.createElement(ue,{lable:"time","data-readable":!0}),a.createElement("div",{className:"flex flex-col"},a.createElement("span",{className:"text-[14px]","data-readable":!0},(0,ye.bK)(t.start.dateTime,t.end.dateTime)),a.createElement("span",{className:"text-[14px] text-[#979797]","data-readable":!0},t.start.timeZone))),t?.attendees?.length>0&&a.createElement("div",null,a.createElement(ue,{lable:"guests","data-readable":!0}),t?.attendees?.map(e=>a.createElement("div",{className:"text-[14px]",key:e.email,"data-readable":!0},e.email))),a.createElement("div",null,a.createElement(ue,{lable:"meet","data-readable":!0}),a.createElement("span",{className:"text-[14px]","data-readable":!0},t?.hangoutLink)));return a.createElement("div",{className:"px-[12px]"},a.createElement("div",{className:"flex-col gap-[12px] p-[10px] border border-solid  border-[#D9D9D9] rounded-[16px] w-[326px] bg-white dark:bg-[#292929] dark:border-[#292929]","data-message-container":!0},a.createElement("div",{className:"text-[14px] font-semibold","data-readable":!0},"Event details"),r,a.createElement(k,{canCopy:!0,canVoice:!0,canShare:!0,message:e,onClickShare:()=>{o(!0)}})),a.createElement(ve,{capturing:s,captureCallback:()=>{o(!1)}},r))};var be=n(69036),xe=n(96454);const we=n.p+"google.5f147c0a9dbb2590b20d.png",Ce=e=>{const{deleteMessage:t}=e,n=(0,a.useCallback)(()=>{xe.cp?window.electron.googleLogin().then(e=>{const n={isLoggedIn:!0,accessToken:e.access_token,idToken:e.id_token,grantedScopes:e.scope,expiresAt:e.expiry_date};(0,re.UA)(n),y.A.emit(y.E.GoogleAuthSuccess),t()}).catch(e=>{console.error("Google login failed:",e)}):(0,oe.XL)().then(e=>{console.log(e),y.A.emit(y.E.GoogleAuthSuccess),t()}).catch(e=>{console.error("Google login failed:",e),be.Ay.info("Google login failed")})},[t]);return a.createElement("div",{className:"px-[12px]"},a.createElement("div",{className:"p-[10px] border-solid border-[#D9D9D9] rounded-[16px] w-[316px] bg-white dark:bg-[#292929]"},a.createElement("span",null,"This service requires access to your Google Calendar."),a.createElement(ne.Ay,{className:"w-auto mt-[4px] flex items-center cursor-pointer hover:opacity-80 hover:!bg-[#F3F3F3]  gap-[8px] bg-[#F3F3F3] px-[12px] py-[10px] rounded-[6px] dark:!bg-[#383838] h-[36px] border-none",onClick:n},a.createElement("img",{src:we,alt:"",className:"w-[16px] h-[16px]"}),a.createElement("span",{className:"text-[var(--color-text)]"},"Google authorization"))))};var Ne=n(90709),Ie=n(95815),Se=n(5556);const Me=({message:e})=>{const{chatId:t,messageId:n,emailConfirmed:s,calendlyConfirmed:o,suggestType:r}=JSON.parse(e.content)||{},[i,l]=(0,a.useState)(s),[c,d]=(0,a.useState)(o),{emails:m,calendlyUrls:u}=Se.s.informations,p=(0,A.mS)();if(("both"!==r||u.length||m.length)&&("email"!==r||m.length)&&("time"!==r||u.length))return a.createElement("div",{className:"px-[12px] text-[15px]"},a.createElement("div",{className:"p-[10px] border border-solid border-[#D9D9D9] rounded-[16px] w-full bg-white dark:bg-[#292929] dark:border-[#292929]"},a.createElement("p",null,"🔔 ",(()=>{const e=(0,f.mBe)(p,t);return e?(0,Ne.Yg)(e):""})()," would like to schedule a meeting with you. Would you like to send your calendar link or email address?"),a.createElement("ul",{className:"list-disc pl-[18px] mb-[4px]"},("both"===r||"time"===r)&&u.length>0&&a.createElement(a.Fragment,null,a.createElement("b",{className:"ml-[-18px]"},"Calendars:"),u.map(o=>a.createElement("li",{className:"word-break break-all"},a.createElement("span",null,a.createElement("span",{className:"text-[12px] mr-[4px]"},"📅"),o),!c&&a.createElement("span",{className:"mx-[2px] font-semibold cursor-pointer ml-[4px] outline-none border-none focus:outline-none focus:ring-0 underline decoration-2",onClick:()=>(a=>{c||((0,A.ko)().sendMessage({messageList:{chatId:t,threadId:"-1",type:"thread"},text:a}),d(!0),e.content=JSON.stringify({chatId:t,messageId:n,emailConfirmed:s,calendlyConfirmed:!0,suggestType:r}),b.zs?.message?.storeMessage((0,Ie.Jr)(t,[e])[0]))})(o)},"Send👉")))),("both"===r||"email"===r)&&m.length>0&&a.createElement(a.Fragment,null,a.createElement("b",{className:"ml-[-18px]"},"Emails:"),m.map(s=>a.createElement("li",{className:"word-break break-all"},a.createElement("span",null,a.createElement("span",{className:"text-[12px] mr-[4px]"},"✉️"),s),!i&&a.createElement("span",{className:"mx-[2px] font-semibold cursor-pointer ml-[4px] outline-none border-none focus:outline-none focus:ring-0 underline decoration-2",onClick:()=>(a=>{i||((0,A.ko)().sendMessage({messageList:{chatId:t,threadId:"-1",type:"thread"},text:a}),l(!0),e.content=JSON.stringify({chatId:t,messageId:n,emailConfirmed:!0,calendlyConfirmed:o,suggestType:r}),b.zs?.message?.storeMessage((0,Ie.Jr)(t,[e])[0]))})(s)},"Send👉")))))))},ke=({message:e})=>{const{chatId:t,messageId:n,isConfirmed:s}=JSON.parse(e.content)||{},[o,r]=(0,a.useState)(s),i=()=>{const a=(0,A.mS)();let s="";const o=(0,f.ZZX)(a,t)||0;for(let e=n;e<=o;e++){const n=(0,f.O5q)(a,t,e);if(n&&(0,Ne.XR)(n)&&!n.isOutgoing){const e=(0,Ne.r_)(n).text?.text;s+=`;${e}`}}ye.Ay.create({chatId:t}).start({chatId:t,text:s}),r(!0),e.content=JSON.stringify({chatId:t,messageId:n,isConfirmed:!0}),b.zs?.message?.storeMessage((0,Ie.Jr)(t,[e])[0])};return a.createElement("div",{className:"px-[12px] text-[15px]"},a.createElement("div",{className:"p-[10px] border border-solid border-[#D9D9D9] rounded-[16px] w-full bg-white dark:bg-[#292929] dark:border-[#292929]"},a.createElement("div",null,"🔔 I noticed that ",(()=>{const e=(0,A.mS)(),n=(0,f.mBe)(e,t);return n?(0,Ne.Yg)(n):""})()," wants to schedule a meeting with you. Would you like me to help set it up?"),a.createElement("div",null,"👉 Click",a.createElement("span",{className:d()("mx-[2px] outline-none border-none focus:outline-none focus:ring-0",{"underline decoration-2":!o}),onClick:()=>{if(o)return;if(!t||!n)return;const e=(0,re.IM)();e&&(0,re.G6)(e)?i():(0,oe.wG)({onOk:()=>{i()}})}},'"Yes"'),"to proceed, or ignore this message.")))},Te=({message:e})=>{const{content:t}=e,{chatId:n,date:s,email:o,isConfirmed:r}=JSON.parse(t||"{}")||{},[i,l]=(0,a.useState)(r),c=({token:e,start:t,end:a,email:s})=>{(0,A.ko)().sendMessage({messageList:{chatId:n,threadId:"-1",type:"thread"},text:ye.oS}),(0,oe.FG)({startDate:new Date(t),endDate:new Date(a),selectedTimezone:Intl.DateTimeFormat().resolvedOptions().timeZone,emails:s,googleToken:e}).then(e=>{e&&(0,ye.Qg)(e,n)})};return a.createElement("div",{className:"px-[12px] text-[14px]"},a.createElement("div",{className:"p-[10px] border border-solid border-[#D9D9D9] rounded-[16px] w-[326px] bg-white dark:bg-[#292929] dark:border-[#292929]"},a.createElement("div",null,"📅 I’ve checked your calendar. Here are some available time slots in the coming days:"),a.createElement("ul",{className:"list-decimal pl-[18px] mb-[4px]"},s&&s.map(t=>a.createElement("li",null,a.createElement("div",{className:d()("font-semibold cursor-pointer bg-transparent border-none p-0",{"underline decoration-2":!i}),onClick:()=>(t=>{if(!i){if(o.length>0){const e=(0,re.IM)();e&&(0,re.G6)(e)?c({token:e.accessToken,start:t.start,end:t.end,email:o}):(0,oe.wG)({onOk:e=>{c({token:e,start:t.start,end:t.end,email:o})}})}else{const e=ye.Ay.create({chatId:n,date:[t],hasConfirmed:!0}),a=(0,re.IM)();a&&(0,re.G6)(a)?e.start():(0,oe.wG)({onOk:()=>{e.start()}})}e.content=JSON.stringify({chatId:n,date:s,email:o,isConfirmed:!0}),b.zs?.message?.storeMessage((0,Ie.Jr)(n,[e])[0]),l(!0)}})(t)},(0,ye.bK)(t.start,t.end))))),a.createElement("div",null,a.createElement("span",null,"Which time would you like to choose? Or 📆 "),a.createElement("a",{href:"https://calendar.google.com/",target:"_blank",className:"underline decoration-2 font-semibold",rel:"noreferrer"},"View Full Calendar"))))};var Pe=n(31511);const Le=({message:e})=>{const[t,n]=(0,a.useState)([]),s=(0,A.mS)(),o=(0,Pe.A)();return(0,a.useEffect)(()=>{try{const t=JSON.parse(e.content);n(t||[])}catch(e){console.log(e)}},[e]),0===t.length?a.createElement("span",null,"未找到相关群组"):a.createElement("div",{className:"p-[10px] mx-[22px] rounded-[16px] border-[1px] border-[#D9D9D9] bg-white dark:bg-[#292929]"},a.createElement("div",{className:"flex flex-col gap-[12px]"},t.splice(0,10).map(e=>a.createElement(a.Fragment,null,(e=>{if((0,U.L8)(e))return null;let t,n;const r=(0,f.hds)(s,e);return r?(t=r?.membersCount,n=(0,Ne.Js)(o,r),a.createElement("div",{className:"flex flex-row items-center gap-[8px] cursor-pointer px-[12px] py-[8px] rounded-[12px] hover:bg-[#D9D9D9]",onClick:()=>{(e=>{(0,f.hds)(s,e)&&(0,A.ko)().openChat({id:e})})(e)}},a.createElement(T.A,{key:e,className:"overlay-avatar inline-block cursor-pointer",size:44,peer:r}),a.createElement("div",{className:"flex flex-col justify-center gap-[4px]"},a.createElement("span",{className:"text-[15px] font-semibold text-black leading-[18px]"},n),a.createElement("span",{className:"text-[14px] text-[#5E6272] leading-[18px]"},t," Members")))):null})(e)))))},Be=n.p+"actions.c00bd19afbf93bdda994.png",Re=()=>a.createElement("div",{className:"rounded-[16px] w-[488px] bg-[var(--color-background)]"},a.createElement("img",{src:Be,alt:"",className:"w-[490px] h-[259px]"}),a.createElement("div",{className:"py-[14px] px-[12px]"},a.createElement("h3",null,"✅  Action Items"),a.createElement("p",{className:"text-[15px] text-[var(--color-text)]"},"During message summarization, the AI assistant automatically identifies actionable tasks and follow-ups from your chats. No need to take notes—your to-do list is generated in real time, helping you stay organized and never miss a beat."))),Fe=n.p+"schedule-meeting.84e2b3273614570bd641.png",De="text-[15px] text-[var(--color-text)]",Oe=()=>a.createElement("div",{className:"rounded-[16px] w-[488px] bg-[var(--color-background)]"},a.createElement("img",{src:Fe,alt:"",className:"w-[490px] h-[259px]"}),a.createElement("div",{className:"py-[14px] px-[12px]"},a.createElement("h3",null,"🔥 Meeting Scheduler 🔥"),a.createElement("ul",{className:"pl-[24px] list-disc"},a.createElement("li",{className:De},"Automatic Detection & Smart Coordination The AI assistant instantly recognizes meeting-related messages, asks for time, participants, and other details—all through natural chat flow."),a.createElement("li",{className:De},"Instant Invite Delivery Once confirmed, it auto-generates and sends calendar invites, keeping everyone in sync without ever leaving the conversation.")))),ze=n.p+"summarize.9cfdcaba3ebe53c6ba08.png",je="text-[15px] text-[var(--color-text)]",Ue=()=>a.createElement("div",{className:"rounded-[16px] w-[488px] bg-[var(--color-background)]"},a.createElement("img",{src:ze,alt:"",className:"w-[490px] h-[259px]"}),a.createElement("div",{className:"py-[14px] px-[12px]"},a.createElement("h3",null,"🔥 Message Summarization 🔥"),a.createElement("p",{className:je},"The Message Summarization feature uses AI to automatically extract key content from IM conversations and periodically generate summary reports. It helps users efficiently grasp important group updates, improve information retrieval, and avoid missing critical messages."),a.createElement("h3",null,"🔑 Key Capabilities:"),a.createElement("ul",{className:"pl-[24px] list-disc"},a.createElement("li",{className:je},"🔍 Automatically extracts topics, key figures, time references, and user insights from chat messages"),a.createElement("li",{className:je},"🧠 Intelligently identifies and groups content by chat, ensuring clarity and structure"),a.createElement("li",{className:je},"🕒 Automatically generates summary reports during active hours, adapting to peak and off-peak periods"),a.createElement("li",{className:je},"🎯 Supports personalized summary customization, allowing users to focus on specific chats or content types")))),Ve="text-[15px] text-[var(--color-text)]",Je=()=>a.createElement("div",{className:"rounded-[16px] w-[488px] bg-[var(--color-background)]"},a.createElement("img",{src:ze,alt:"",className:"w-[490px] h-[259px]"}),a.createElement("div",{className:"py-[14px] px-[12px]"},a.createElement("h3",null,"🔥 Real-time Translation 🔥"),a.createElement("ul",{className:"pl-[24px] list-disc"},a.createElement("li",{className:Ve},a.createElement("b",null,"Instant Translation While Typing:")," Automatically detects the source language and translates it into the target language in real time."),a.createElement("li",{className:Ve},a.createElement("b",null,"Multi-language Support:")," Covers major languages, including English, Chinese, Japanese, French, German, Spanish, and more."),a.createElement("li",{className:Ve},a.createElement("b",null,"Context-aware Translation:")," Enhances accuracy and fluency by leveraging message context and chat history.")),a.createElement("h3",null,"🔥 Grammar & Style Check 🔥"),a.createElement("ul",{className:"pl-[24px] list-disc"},a.createElement("li",{className:Ve},a.createElement("b",null,"Automatic Error Detection:")," Identifies spelling, grammar, and sentence structure issues."),a.createElement("li",{className:Ve},a.createElement("b",null,"Expression Optimization:")," Suggests more natural and professional phrasing suitable for business or formal messages."),a.createElement("li",{className:Ve},a.createElement("b",null,"Multilingual Correction:")," Supports grammar checks not only in English but also in other languages, such as Chinese.")))),He=({chatId:e,classNames:t,size:n,style:s})=>{if(!e)return null;const o=(0,A.mS)();let r;return r=(0,U.L8)(e)?(0,f.mBe)(o,e):(0,f.hds)(o,e),a.createElement(T.A,{style:s,key:e,className:(0,l.cn)(t,"overlay-avatar inline-block cursor-pointer"),size:n,peer:r})},Ke=({pendingItem:e})=>a.createElement(L.A,null,a.createElement("div",{className:"flex gap-[8px] my-[4px] cursor-pointer"},a.createElement("img",{className:"w-[18px] h-[18px] mt-[2px]",src:D,alt:""}),a.createElement("span",{className:"text-[15px]","data-readable":!0},e.summary))),$e=({messageId:e})=>a.createElement(k,{canCopy:!0,canVoice:!0,message:{id:e}}),Ge=({summaryInfo:e})=>a.createElement(L.A,null,a.createElement("div",null,a.createElement("p",{className:"flex items-center gap-[8px] mb-[16px]"},a.createElement("span",{className:"text-[18px] font-bold","data-readable":!0},"Actions Items"),a.createElement("img",{className:"w-[16px] h-[16px]",src:R,alt:""})),a.createElement("div",{className:"flex items-center gap-[20px]"},a.createElement("p",{className:"flex items-center gap-[8px]"},a.createElement("img",{className:"w-[16px] h-[16px]",src:F,alt:""}),a.createElement("div",{className:"flex items-center gap-[4px]"},a.createElement("span",{className:"mr-[4px] font-bold text-[14px]","data-readable-inline":!0},"Time:"),e?.summaryTime?a.createElement("p",{className:"text-[14px] text-[#A8A6AC]","data-readable-inline":!0},(0,l.Ey)(e.summaryTime)):null)),a.createElement("p",{className:"flex items-center gap-[8px]"},a.createElement("img",{className:"w-[16px] h-[16px]",src:O,alt:""}),a.createElement("div",{className:"flex items-center gap-[4px]"},a.createElement("span",{className:"font-bold text-[14px]","data-readable-inline":!0},"Messages:"),e?.messageCount?a.createElement("span",{"data-readable-inline":!0},e?.messageCount):null))),e?.userIds?a.createElement("div",{className:"flex items-center gap-[8px] mb-[18px]"},a.createElement("img",{className:"w-[16px] h-[16px]",src:z,alt:""}),a.createElement("span",{className:"font-bold text-[14px]","data-readable":!0},"Groups/friends: "),a.createElement("div",{className:"flex items-center"},e.userIds.slice(0,5).map((t,n)=>a.createElement(He,{style:{zIndex:`${String(e.userIds.length-n)};`},chatId:t,size:24,classNames:"summary-avatar-group !border-solid-[2px] !border-white ml-[-4px]",key:t})),e.userIds.length>10?a.createElement("div",{className:"w-[24px] h-[24px] rounded-full bg-[#979797] text-[12px] whitespace-nowrap flex items-center justify-center","data-readable":!0},e.userIds.length-10,"+"):null)):null)),_e=e=>{const{message:t}=e,[n,s]=(0,a.useState)(null),[o,r]=(0,a.useState)([]),i=(0,a.useCallback)(e=>{const t=JSON.parse(e),{pendingMatters:n,summaryInfo:a}=t;n&&r(n),a&&s(a)},[]);return(0,a.useEffect)(()=>{try{i(t.content)}catch(e){console.error(e)}},[t,i]),n?a.createElement("div",{className:"px-[12px] w-full"},o.length?a.createElement("div",{className:"mx-auto rounded-[10px] px-3 py-2 bg-white dark:bg-[#292929]","data-message-container":!0},n&&a.createElement(Ge,{summaryInfo:n}),o.length>0&&a.createElement("div",null,o.map(e=>a.createElement(Ke,{pendingItem:e}))),a.createElement($e,{messageId:t.id})):null):null},qe="h-[40px] w-fit px-[12px] py-[8px] rounded-[6px] bg-[#F5F1FF] text-[14px] text-[var(--color-text)] dark:bg-[#383838]",We=({message:e})=>{const{content:t}=e,n=(0,A.mS)(),s=(0,f.hds)(n,t),o=()=>{y.A.emit(y.E.RoomAIActions,{chatId:t,action:"new-feature"})};return a.createElement("div",{className:"px-[12px]"},a.createElement("div",{className:"px-3 py-2 rounded-xl text-[var(--color-text)] bg-white dark:bg-[#292929]"},a.createElement("p",{className:"text-[14px]"},"👋 Hi, welcome to 【",s?.title,"】! I’m Tely AI 🤖, your smart assistant here."),a.createElement("div",{className:"mt-[0.5rem]"},a.createElement("h3",{className:"text-[14px] font-semibold"},"🚀 Here’s what I can help you with:"),a.createElement("div",{className:"flex flex-col gap-[8px] mt-[0.5rem]"},a.createElement("div",{className:qe,onClick:()=>{y.A.emit(y.E.RoomAIActions,{chatId:t,action:"summary"})}},"🧠 Chat Summary"),a.createElement("div",{className:qe,onClick:()=>{y.A.emit(y.E.RoomAIActions,{chatId:t,action:"schedule-meet"})}},"📅 Schedule Meeting"),a.createElement("div",{className:qe,onClick:()=>{y.A.emit(y.E.RoomAIActions,{chatId:t,action:"todo"})}},"✅ Action Items"),a.createElement("div",{className:qe,onClick:o},"🔍 Group Search"),a.createElement("div",{className:qe,onClick:o},"👮 User Portrait"),a.createElement("div",{className:qe,onClick:o},"🎯 Project Tracking"))),a.createElement("div",{className:"mt-[0.5rem]"},a.createElement("h3",{className:"text-[14px] font-semibold"},"📍 You can ask me things like:"),a.createElement("ul",{className:"list-disc pl-[24px] text-[14px] text-[var(--color-text)]"},a.createElement("li",null,"What was discussed in the group yesterday?"),a.createElement("li",null,"Has there been any mention of client feedback in the group?")))))};var Qe=n(23174),Ye=n(65240),Ze=n(96456),Xe=n(89925),et=n(7971);function tt(){return tt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},tt.apply(null,arguments)}const nt=e=>{const t=(0,A.mS)(),n=(0,f.SJA)(t);let s,o,r={},i=!1,l="loading";try{r=JSON.parse(e?.message.content),s=r?.message;try{o=JSON.parse(r?.summaryInfo)}catch(e){}i=r?.isAuto,l=r?.status}catch(e){}const c=!!s&&(0,Ne.Ie)(s),d=s?.content?.voice?(0,Ye.lz)(n,s?.content?.voice,1,c):void 0,m=s?.content?.photo?(0,Ze.A)(s?.content?.photo?(0,Ne.rI)(s?.content?.photo,"inline"):void 0,!1,Qe.qZ.BlobUrl):void 0,u=s?.content?.photo?.blobUrl||m,h=s?.content?.photo?.thumbnail?.width,g=Boolean(h);function y(){if(!s)return"";const{webPage:e,photo:t,document:n,audio:a,voice:o,video:r}=s?.content,i=(0,et.Ah)(s?.content?.text?.text),l=!!n&&(0,et.ER)(n?.mimeType);return e||i?"website page":t||l?"image":n?"file":a?"audio":o?"voice":r?"video":void 0}function E(){const{openMediaViewer:e}=(0,A.ko)();e({chatId:s?.chatId,threadId:-1,messageId:s?.id,origin:Xe.TQ.Inline,withDynamicLoading:!0})}return a.createElement("div",{className:"flex flex-col gap-2 px-3 text-[14px]","data-message-container":!0},!i&&a.createElement("div",{className:"text-right"},a.createElement(at,null,"Summarize this ",y())),function(){if(!s)return"";const{webPage:e,photo:t,document:n,audio:o,voice:r,video:l}=s?.content,c=(0,et.Ah)(s?.content?.text?.text);return e||c?a.createElement("div",{className:(0,v.A)("flex",i?"":"justify-end")},a.createElement("div",{className:"rounded-[16px] bg-[var(--color-ai-room-media-bg)] p-3 text-[var(--color-text)] break-all"},e?s?.content?.webPage?.url:s?.content?.text?.text)):t?u&&a.createElement("div",{className:(0,v.A)("flex",i?"":"justify-end")},a.createElement("img",{src:u,className:(0,v.A)("full-media cursor-pointer",g&&"with-blurred-bg"),alt:"",style:{width:`${h??0}px`},onClick:E})):n?a.createElement("div",{className:(0,v.A)("flex",i?"":"justify-end")},a.createElement("div",{className:"rounded-[16px] bg-[var(--color-ai-room-media-bg)] p-3 text-[var(--color-text)] break-all"},s?.content.document?.fileName)):o?a.createElement("div",{className:(0,v.A)("flex",i?"":"justify-end")},a.createElement("div",{className:"rounded-[16px] bg-[var(--color-ai-room-media-bg)] p-3 text-[var(--color-text)] break-all"},s?.content.audio?.fileName)):r?a.createElement("div",{className:(0,v.A)("flex",i?"":"justify-end")},a.createElement("div",{className:"rounded-[16px] bg-[var(--color-ai-room-media-bg)] p-3 text-[var(--color-text)] break-all"},s?.content?.voice&&a.createElement("div",{className:"waveform-wrapper"},a.createElement("div",{className:"waveform",draggable:!1},a.createElement("canvas",{ref:d}))),s?.content?.audio&&a.createElement("p",{className:"title",dir:"auto",title:s?.content?.audio?.title},s?.content?.audio?.title))):l?a.createElement("div",{className:(0,v.A)("flex",i?"":"justify-end")},a.createElement("div",{className:"rounded-[16px] bg-[var(--color-ai-room-media-bg)] p-3 text-[var(--color-text)] break-all"},s?.content.video?.fileName)):void 0}(),"loading"===l?a.createElement(Ot,null):"error"===l?a.createElement(ot,{content:y()||"",message:e.message}):function(){if(!s)return"";const{webPage:t,photo:n,document:r}=s?.content,l=(0,et.Ah)(s?.content?.text?.text),c=!!r&&(0,et.ER)(r?.mimeType);return t||l?o?.title?a.createElement("div",{className:"rounded-[16px] bg-[var(--color-ai-room-media-bg)] p-3 text-[var(--color-text)]"},a.createElement("div",{className:"font-[600] text-[16px]","data-readable":!0},'Summary of the Article: "',o?.title,'"'),a.createElement("div",{className:"flex flex-col gap-[6px] mt-3"},a.createElement("div",{className:"font-[600]","data-readable":!0},"Key Highlights:"),a.createElement("div",{className:"flex flex-col"},o?.highlights?.map((e,t)=>a.createElement("div",{className:"flex flex-col",key:t},a.createElement("div",{className:"flex flex-row items-center flex-wrap"},a.createElement("span",{className:"mr-[24px]","data-readable":!0},t+1,". ",e?.title)),a.createElement("ul",{className:"list-disc list-inside ml-3 mb-1"},e?.content?.map((e,t)=>a.createElement("li",{className:"break-word",key:t,"data-readable":!0},e))))))),a.createElement(k,{canCopy:!0,canVoice:!0,message:e.message})):a.createElement(ot,{content:"website page",message:e.message}):n||c?a.createElement("div",{className:"rounded-[16px] bg-[var(--color-ai-room-media-bg)] text-[var(--color-text)] p-3 text-[14px]"},i?a.createElement("div",{className:"font-[600]","data-readable":!0},"Image summarize"):a.createElement("div",{className:"flex items-center gap-2","data-readable":!0},a.createElement("img",{src:p,className:"w-[18px] h-[18px]"}),"Tely AI"),a.createElement("div",{className:"flex flex-col gap-[6px] mt-2","data-readable":!0},o?.text),a.createElement(k,{canCopy:!0,canVoice:!0,message:e.message})):a.createElement("div",{className:"rounded-[16px] bg-[var(--color-ai-room-media-bg)] p-3 text-[var(--color-text)]"},a.createElement("div",{className:"font-[600] text-[16px]","data-readable":!0},"Key Highlights:"),a.createElement("div",{className:"flex flex-col mt-2"},o?.map((e,t)=>a.createElement("div",{className:"flex flex-col",key:t},a.createElement("div",{className:"flex flex-row items-center flex-wrap"},a.createElement("span",{className:"mr-[24px] font-[600]","data-readable":!0},e?.title)),a.createElement("ul",{className:"list-disc list-inside ml-3 mb-1"},e?.content?.map((e,t)=>a.createElement("li",{className:"break-word",key:t,"data-readable":!0},e)))))),a.createElement(k,{canCopy:!0,canVoice:!0,message:e.message}))}())},at=({children:e})=>a.createElement("div",{className:"bg-[var(--color-ai-room-bubble-bg)] py-2 px-3 rounded-t-[16px] rounded-bl-[16px] text-right inline-flex relative"},e,a.createElement("div",{className:"absolute bottom-[-3px] right-[-9px] text-[var(--color-ai-room-bubble-bg)]"},a.createElement(st,null))),st=e=>a.createElement("svg",tt({width:9,height:20},e),a.createElement("defs",null,a.createElement("filter",{id:"a",width:"200%",height:"141.2%",x:"-50%",y:"-14.7%",filterUnits:"objectBoundingBox"},a.createElement("feOffset",{dy:1,in:"SourceAlpha",result:"shadowOffsetOuter1"}),a.createElement("feGaussianBlur",{in:"shadowOffsetOuter1",result:"shadowBlurOuter1",stdDeviation:1}),a.createElement("feColorMatrix",{in:"shadowBlurOuter1",values:"0 0 0 0 0.0621962482 0 0 0 0 0.138574144 0 0 0 0 0.185037364 0 0 0 0.15 0"}))),a.createElement("g",{fill:"none",fillRule:"evenodd"},a.createElement("path",{fill:"currentColor",d:"M6 17H0V0c.193 2.84.876 5.767 2.05 8.782.904 2.325 2.446 4.485 4.625 6.48A1 1 0 0 1 6 17z",filter:"url(#a)"}),a.createElement("path",{fill:"currentColor",d:"M6 17H0V0c.193 2.84.876 5.767 2.05 8.782.904 2.325 2.446 4.485 4.625 6.48A1 1 0 0 1 6 17z"}))),ot=({content:e,message:t})=>a.createElement("div",{className:"rounded-[16px] bg-[var(--color-ai-room-media-bg)] p-3 text-[var(--color-text)]"},a.createElement("span",{"data-readable":!0},"I couldn't find any accessible content from the ",e," you provided. It appears the search query didn't return any results. Could you please paste the text you want summarized? That way, I can give you a clear and accurate summary!"),a.createElement(k,{canCopy:!0,canVoice:!0,message:t})),rt=e=>{const{message:t}=e;let n={},s=0,o="loading",r=[];try{n=JSON.parse(t.content),s=n?.messageId,o=n?.status;try{r=JSON.parse(n?.replys?.replace(/'/g,'"')?.replace(/,\s+/g,","))}catch(e){}}catch(e){}const[i,l]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{l(n?.disabled)},[t]),a.createElement("div",{className:"rounded-[16px] bg-[var(--color-background)] text-[var(--color-text)] mx-2 p-3 w-full text-[14px]"},a.createElement("div",{className:"font-[600]"},"You were mentioned:"),a.createElement("div",null,'"',n?.content,'"'),"loading"==o?a.createElement(Ot,null):"error"===o?a.createElement("div",{className:"rounded-[16px] bg-[#FFF9F9] text-[#000] p-3 text-[14px] border-[1px] border-[#FFC7C7]"},n?.errorMsg):a.createElement(a.Fragment,null,a.createElement("div",null,"Here are a few reply suggestions for you 👇"),a.createElement("div",{className:"flex flex-col gap-[6px] mt-2"},r?.map((e,o)=>a.createElement("div",{className:(0,v.A)("bg-[var(--color-ai-room-mention-reply-bg)] rounded-[6px] p-[6px] ",i?"cursor-not-allowed opacity-50":"cursor-pointer hover:opacity-80"),key:o,onClick:()=>function(e){if(i)return;const a=(0,A.mS)(),{saveReplyDraft:o,sendMessage:r,clearDraft:c}=(0,A.ko)(),d=(0,f.meB)(a);if(d&&s){const a=d.id,i=-1;o({chatId:a,threadId:i,draft:{replyInfo:{type:"message",replyToMsgId:s,replyToPeerId:void 0}},isLocalOnly:!0}),r({messageList:{chatId:a,threadId:i,type:"thread"},text:e}),c({chatId:a,isLocalOnly:!0}),l(!0),b.zs.message?.storeMessage({...t,chatId:a,timestamp:(new Date).getTime(),content:JSON.stringify({disabled:!0,...n})})}}(e)},'"',e,'"')))))};var it=n(17712);const lt=e=>{const t=(0,A.mS)(),{openUserPortrait:n}=(0,A.ko)(),s=e?.userId,o=s?(0,f.mBe)(t,s):void 0,r=(0,it.A)(()=>{n({userId:s})});return a.createElement("div",{className:"flex flex-col gap-2 px-3 text-[14px]"},a.createElement("div",{className:"rounded-[16px] bg-[var(--color-ai-room-media-bg)] text-[var(--color-text)] p-3 text-[14px]"},a.createElement("div",{className:"flex items-center gap-2"},a.createElement("img",{src:p,className:"w-[18px] h-[18px]"}),"Tely AI"),o?a.createElement("div",{onClick:r,className:"flex flex-row items-center gap-2 mt-2 cursor-pointer hover:opacity-80"},a.createElement(T.A,{peer:o,size:"small"}),`${o?.firstName||""} ${o?.lastName||""}`," 's Portrait"):a.createElement("div",null,"Couldn't find the user.")))},ct=({chatId:e,classNames:t,size:n,style:s})=>{if(!e)return null;const o=(0,A.mS)();let r;return r=(0,U.L8)(e)?(0,f.mBe)(o,e):(0,f.hds)(o,e),a.createElement(T.A,{style:s,key:e,className:(0,l.cn)(t,"overlay-avatar inline-block cursor-pointer"),size:n,peer:r})},dt=({topicItem:e,index:t})=>{const{title:n,summaryItems:s}=e;return s.length&&n?a.createElement(L.A,null,a.createElement("div",null,a.createElement("div",{className:"flex flex-row items-center flex-wrap"},a.createElement("span",{className:"text-[16px] font-bold mr-[24px]","data-readable":!0},t+1,". ",n)),a.createElement("ul",{className:"list-disc pl-[2px] text-[16px] list-inside"},s.map(e=>{const{content:t}=e;return t?a.createElement("li",{role:"button",className:"cursor-pointer text-[15px] break-words","data-readable":!0},t):null})))):null},mt=({pendingItem:e})=>a.createElement(L.A,null,a.createElement("div",{className:"flex gap-[8px] my-[4px] cursor-pointer"},a.createElement("img",{className:"w-[18px] h-[18px] mt-[2px]",src:D,alt:""}),a.createElement("span",{className:"text-[15px]","data-readable":!0},e.summary))),ut=({summaryInfo:e,title:t=a.createElement(a.Fragment,null,"Chat Summary")})=>a.createElement(L.A,null,a.createElement("div",null,a.createElement("p",{className:"text-[22px] font-bold mb-[16px]","data-readable":!0},t),a.createElement("div",{className:"flex items-center flex-wrap"},a.createElement("p",{className:"flex items-center gap-[8px] pr-[20px]"},a.createElement("img",{className:"w-[16px] h-[16px]",src:F,alt:""}),a.createElement("div",{className:"flex items-center gap-[4px]"},a.createElement("span",{className:"mr-[4px] font-bold text-[14px]","data-readable-inline":!0},"Time:"),e?.summaryTime?a.createElement("p",{className:"text-[14px] text-[#A8A6AC] whitespace-nowrap","data-readable-inline":!0},(0,l.Ey)(e.summaryTime)):null)),a.createElement("p",{className:"flex items-center gap-[8px]"},a.createElement("img",{className:"w-[16px] h-[16px]",src:O,alt:""}),a.createElement("div",{className:"flex items-center gap-[4px]"},a.createElement("span",{className:"font-bold text-[14px]","data-readable":!0,"data-readable-inline":!0},"Messages:"),e?.messageCount?a.createElement("span",{"data-readable":!0,"data-readable-inline":!0},e?.messageCount):null))),e?.userIds?a.createElement("div",{className:"flex items-center gap-[8px] mb-[18px]"},a.createElement("img",{className:"w-[16px] h-[16px]",src:z,alt:""}),a.createElement("span",{className:"font-bold text-[14px]"},"Main speakers: "),a.createElement("div",{className:"flex items-center"},e.userIds.slice(0,5).map((t,n)=>a.createElement(ct,{style:{zIndex:`${String(e.userIds.length-n)};`},chatId:t,size:24,classNames:"summary-avatar-group !border-solid-[2px] !border-white ml-[-4px]",key:t})),e.userIds.length>10?a.createElement("div",{className:"w-[24px] h-[24px] rounded-full bg-[#979797] text-[12px] whitespace-nowrap flex items-center justify-center"},e.userIds.length-10,"+"):null)):null)),pt=({messageId:e,summaryInfo:t,mainTopic:n,pendingMatters:s})=>{const[o,r]=(0,a.useState)(!1),i=(0,A.mS)(),{chatId:l}=(0,f.Xf0)(i)||{},c=(0,f.hds)(i,l);return a.createElement("div",{className:"mx-auto rounded-[10px] px-3 py-2 dark:bg-[#292929] bg-white","data-message-container":!0},t&&a.createElement(ut,{summaryInfo:t}),n.length>0&&a.createElement("div",null,a.createElement("p",{className:"flex items-center gap-[8px] mb-[16px]"},a.createElement("span",{className:"text-[18px] font-bold","data-readable":!0},"Key Topics"),a.createElement("img",{className:"w-[16px] h-[16px]",src:j,alt:""})),n.map((e,t)=>a.createElement(dt,{topicItem:e,index:t}))),s.length>0&&a.createElement("div",null,a.createElement("p",{className:"flex items-center gap-[8px] mb-[16px]"},a.createElement("span",{className:"text-[18px] font-bold","data-readable":!0},"Actions Items"),a.createElement("img",{className:"w-[16px] h-[16px]",src:R,alt:""})),s.map(e=>a.createElement(mt,{pendingItem:e}))),a.createElement(k,{canCopy:!0,canVoice:!0,canShare:!0,message:{id:e},onClickShare:()=>{r(!0)}}),a.createElement(ht,{capturing:o,captureCallback:()=>{r(!1)}},t&&a.createElement(ut,{summaryInfo:t,title:a.createElement(a.Fragment,null,"Chat Summary",a.createElement("span",{className:"ml-2 text-xs text-[#979797]"},"[",c?.title,"]"))}),n.length>0&&a.createElement("div",null,a.createElement("p",{className:"flex items-center gap-[8px]"},a.createElement("span",{className:"text-[18px] font-bold","data-readable":!0},"Key Topics"),a.createElement("img",{className:"w-[16px] h-[16px]",src:j,alt:""})),n.map((e,t)=>a.createElement(dt,{topicItem:e,index:t}))),s.length>0&&a.createElement("div",null,a.createElement("p",{className:"flex items-center gap-[8px]"},a.createElement("span",{className:"text-[18px] font-bold","data-readable":!0},"Actions Items"),a.createElement("img",{className:"w-[16px] h-[16px]",src:R,alt:""})),s.map(e=>a.createElement(mt,{pendingItem:e})))))};function ht({capturing:e=!1,children:t,captureCallback:n=()=>{}}){const s=(0,a.useRef)(),o=(0,A.mS)(),{currentUserId:r}=o,i=(0,f.mBe)(o,r);return(0,a.useEffect)(()=>{s.current&&setTimeout(()=>{(0,Ae.ZR)(s.current,{pixelRatio:2,quality:1}).then(e=>{const t=new File([e],"telegpt.org.png",{type:"image/png"});globalThis?.p__handleFileSelect?.([t],!0),n()})},100)},[e,n]),e?a.createElement("div",{className:"fixed top-0 left-0 translate-x-[-1000000px] translate-y-[-100000px]"},a.createElement("div",{ref:s,className:"relative w-[390px] box-content overflow-hidden bg-white text-black"},a.createElement("div",{className:"absolute top-0 left-0 w-full blur-xl pointer-events-none"},a.createElement("img",{src:fe,alt:"",className:"w-full"})),a.createElement("div",{className:"relative py-3 px-4 flex flex-col gap-2"},a.createElement("div",{className:"flex flex-row justify-end items-center gap-2 text-xs text-[#979797]"},a.createElement(T.A,{className:"w-[20px] h-[20px]",peer:i}),a.createElement("span",null,i?.firstName),a.createElement("span",null,i?.lastName)),t),a.createElement("section",{className:"flex flex-row gap-1 items-center justify-center py-2 text-xs bg-[#F7FAFF]"},a.createElement("img",{className:"inline w-[20px] h-[20px] rounded-full",src:p,alt:"Serena"}),"Powered by",a.createElement("span",{className:"text-[#2996FF]"},"telepgt.org")))):null}const gt=e=>{const{message:t}=e,[n,s]=(0,a.useState)(null),[o,r]=(0,a.useState)([]),[i,l]=(0,a.useState)([]),c=(0,a.useCallback)(e=>{const t=JSON.parse(e),{mainTopic:n,pendingMatters:a,summaryInfo:o}=t;n&&r(n),a&&l(a),o&&s(o)},[]);return(0,a.useEffect)(()=>{try{c(t.content)}catch(e){console.error(e)}},[t,c]),n?a.createElement("div",{className:"px-[12px] w-full"},o.length||i.length?a.createElement(pt,{messageId:t.id,summaryInfo:n,mainTopic:o,pendingMatters:i}):null):null};var At=n(75606),yt=n(9626);const ft=e=>{const{message:t,deleteMessage:n}=e,[s,o]=(0,a.useState)([]),{openDrawer:r}=(0,B.S)();return(0,a.useEffect)(()=>{const e=JSON.parse(t.content);e&&"object"==typeof e&&e.length>0&&o(e)},[t]),s&&0!==s.length?a.createElement("div",{className:"w-max-[693px] rounded-[10px] bg-[var(--color-urgent-message-bg)] pl-[82px] pr-[25px] pt-[20px] pb-[25px] border-[1px] border-[#FFC7C7] dark:border-none","data-message-container":!0},a.createElement("div",{className:"flex items-center gap-[8px]"},a.createElement("img",{className:"w-[52px] h-[52px] rounded-full ml-[-60px]",src:p,alt:""}),a.createElement("div",null,a.createElement("p",{className:"text-[16px] font-semibold"},"Tely AI"),t.createdAt&&a.createElement("p",{className:"text-[14px] text-[#A8A6AC]"},(0,l.Ey)(new Date(t.createdAt).getTime())))),a.createElement("div",{className:"flex flex-row items-center gap-[8px] mb-[10px]"},a.createElement("img",{src:yt,alt:"",className:"w-[26px] h-[26px]"}),a.createElement("span",{className:"text-[20px] text-[#FF543D] font-bold","data-readable":!0},"Urgent Alert")),a.createElement("ul",{className:"list-disc pl-[24px]"},s.map(e=>a.createElement("li",{className:"flex flex-row items-top gap-[8px]"},a.createElement("span",{className:"text-[15px] break-words","data-readable":!0,onClick:()=>(e=>{r(B.N.OriginalMessages,{relevantMessages:[{chatId:e.chatId,messageIds:[e.messageId]}]})})(e)},e.content),a.createElement(At.A,{size:20,chatId:e.chatId})))),a.createElement(k,{canCopy:!0,canVoice:!0,canDelete:!0,onDelete:n,message:t})):null},vt=({message:e})=>{const[t,n]=(0,a.useState)([]),s=(0,A.mS)();return(0,a.useEffect)(()=>{try{const t=JSON.parse(e.content);n(t||[])}catch(e){console.log(e)}},[e]),0===t.length?null:a.createElement("div",{className:"p-[10px] mx-[22px] rounded-[16px] border-[1px] border-[#D9D9D9] bg-white dark:bg-[#292929]"},a.createElement("div",{className:"flex flex-col gap-[12px]"},t.splice(0,10).map(e=>a.createElement(a.Fragment,null,(e=>{if(!(0,U.L8)(e))return null;let t;const n=(0,f.mBe)(s,e);return n?(t=(0,Ne.Yg)(n),a.createElement("div",{className:"flex flex-row items-center gap-[8px] cursor-pointer px-[12px] py-[8px] rounded-[12px] hover:bg-[#D9D9D9]",onClick:()=>{(e=>{(0,f.hds)(s,e)&&(0,A.ko)().openChat({id:e})})(e)}},a.createElement(T.A,{key:e,className:"overlay-avatar inline-block cursor-pointer",size:44,peer:n}),a.createElement("div",{className:"flex flex-col justify-center gap-[4px]"},a.createElement("span",{className:"text-[15px] font-semibold text-black leading-[18px]"},t)))):null})(e)))))};var Et=n(2391),bt=n(93250);function xt(){return xt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},xt.apply(null,arguments)}function wt(){return wt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},wt.apply(null,arguments)}const Ct={code:function({node:e,inline:t,className:n,children:s,...o}){return t?a.createElement("code",xt({className:`${n} text-sm bg-zinc-100 dark:bg-zinc-800 py-0.5 px-1 rounded-md`},o),s):a.createElement("div",{className:"not-prose flex flex-col"},a.createElement("pre",xt({},o,{className:"text-sm w-full overflow-x-auto dark:bg-zinc-900 p-4 border border-zinc-200 dark:border-zinc-700 rounded-xl dark:text-zinc-50 text-zinc-900"}),a.createElement("code",{className:"whitespace-pre-wrap break-words"},s)))},pre:({children:e})=>a.createElement(a.Fragment,null,e),ol:({node:e,children:t,...n})=>a.createElement("ol",wt({className:"list-decimal list-outside ml-4"},n),t),li:({node:e,children:t,...n})=>a.createElement("li",wt({className:"py-1"},n),t),ul:({node:e,children:t,...n})=>a.createElement("ul",wt({className:"list-decimal list-outside ml-4"},n),t),strong:({node:e,children:t,...n})=>a.createElement("span",wt({className:"font-semibold"},n),t),a:({node:e,children:t,...n})=>a.createElement("a",{className:"text-blue-500 hover:underline",target:"_blank",rel:"noreferrer"},t),h1:({node:e,children:t,...n})=>a.createElement("h1",wt({className:"text-3xl font-semibold mt-6 mb-2"},n),t),h2:({node:e,children:t,...n})=>a.createElement("h2",wt({className:"text-2xl font-semibold mt-6 mb-2"},n),t),h3:({node:e,children:t,...n})=>a.createElement("h3",wt({className:"text-xl font-semibold mt-6 mb-2"},n),t),h4:({node:e,children:t,...n})=>a.createElement("h4",wt({className:"text-lg font-semibold mt-6 mb-2"},n),t),h5:({node:e,children:t,...n})=>a.createElement("h5",wt({className:"text-base font-semibold mt-6 mb-2"},n),t),h6:({node:e,children:t,...n})=>a.createElement("h6",wt({className:"text-sm font-semibold mt-6 mb-2"},n),t)},Nt=[bt.A],It=({children:e})=>a.createElement(Et.oz,{remarkPlugins:Nt,components:Ct},e),St=(0,a.memo)(It,(e,t)=>e.children===t.children);var Mt=n(17965),kt=n.n(Mt);const Tt=({message:e})=>{const{showNotification:t}=(0,A.ko)(),{isSpeaking:n,speak:s,stop:o}=S(e.id);return a.createElement("div",{className:"message-actions flex items-center gap-[8px]"},a.createElement("div",{className:"w-[24px] h-[24px] text-[#676B74] cursor-pointer",onClick:()=>{kt()(e.content),t({message:"TextCopied"})}},a.createElement(M.Td,{size:24})),n?a.createElement("div",{className:"w-[24px] h-[24px] text-[#676B74] cursor-pointer",onClick:o},a.createElement(M.ON,{size:24})):a.createElement("div",{className:"w-[24px] h-[24px] text-[#676B74] cursor-pointer",onClick:()=>{const t=e.content;n?o():s(t)}},a.createElement(M.S,{size:24})))};function Pt({isLoading:e,reasoning:t}){const[n,s]=(0,a.useState)(!0);return a.createElement("div",{className:"flex flex-col"},e?a.createElement("div",{className:"flex flex-row gap-2 items-center"},a.createElement("div",{className:"font-medium"},"Reasoning"),a.createElement("div",{className:"animate-spin"},a.createElement(M.hz,null))):a.createElement("div",{className:"flex flex-row gap-2 items-center"},a.createElement("div",{className:"font-medium"},"Reasoned for a few seconds"),a.createElement("div",{className:"cursor-pointer",onClick:()=>{s(!n)}},a.createElement(M.D3,null))),a.createElement(m.N,{initial:!1},n&&a.createElement(r.P.div,{key:"content",initial:"collapsed",animate:"expanded",exit:"collapsed",variants:{collapsed:{height:0,opacity:0,marginTop:0,marginBottom:0},expanded:{height:"auto",opacity:1,marginTop:"1rem",marginBottom:"0.5rem"}},transition:{duration:.2,ease:"easeInOut"},className:"pl-4 text-zinc-600 dark:text-zinc-400 border-l flex flex-col gap-4 overflow-hidden"},a.createElement(St,null,t))))}const Lt=({attachment:e,isUploading:t=!1})=>{const{name:n,url:s,contentType:o}=e;return a.createElement("div",{className:"flex flex-col gap-2"},a.createElement("div",{className:"w-20 h-16 aspect-video bg-muted rounded-md relative flex flex-col items-center justify-center"},o&&o.startsWith("image")?a.createElement("img",{key:s,src:s,alt:n??"An image attachment",className:"rounded-md size-full object-cover"}):a.createElement("div",{className:""}),t&&a.createElement("div",{className:"animate-spin absolute text-zinc-500"},a.createElement(M.hz,null))),a.createElement("div",{className:"text-xs text-zinc-500 max-w-16 truncate"},n))};let Bt=function(e){return e.GlobalSummary="global-summary",e.UrgentCheck="urgent-message-check",e.GroupSearch="group-search",e.UserSearch="user-search",e.GoogleAuth="google-auth",e.GoogleEventInsert="google-event-insert",e.GoogleEventDetail="google-event-detail",e.GoogleMeetTimeConfirm="google-meet-time-confirm",e.GoogleMeetMention="google-meet-mention",e.GoogleMeetInformationSuggest="google-meet-information-suggest",e.RoomSummary="room-summary",e.RoomActions="room-actions",e.MeetingIntroduce="global-meeting-introduce",e.SummaryIntroduce="global-summary-introduce",e.TranslationIntroduce="global-translation-introduce",e.ActionsIntroduce="global-actions-introduce",e.GlobalIntroduce="global-introduce",e.RoomAIDescription="room-ai-description",e.AISearchSugesstion="ai-search-sugesstion",e.AIReplyMention="room-ai-reply-mention",e.AIMediaSummary="room-ai-media-summary",e.UserPortrait="user-portrait",e.Default="default",e}({});const Rt=({message:e,isLoading:t})=>a.createElement(r.P.div,{className:"w-full px-[12px] group/message",initial:{y:5,opacity:0},animate:{y:0,opacity:1},"data-role":e.role},a.createElement("div",{className:"flex gap-4 w-full group-data-[role=user]/message:ml-auto group-data-[role=user]/message:max-w-2xl"},a.createElement("div",{className:"flex flex-col gap-4 w-full"},e.experimental_attachments&&a.createElement("div",{className:"flex flex-row justify-end gap-2"},e.experimental_attachments.map(e=>a.createElement(Lt,{key:e.url,attachment:e}))),e.reasoning&&a.createElement(Pt,{isLoading:t,reasoning:e.reasoning}),(e.content||e.reasoning)&&a.createElement("div",{className:"flex flex-row gap-2 items-start w-full"},a.createElement("div",{className:(0,u.cn)("w-auto flex flex-col gap-4 bg-white text-[var(--color-text)] px-3 py-2 rounded-xl dark:bg-[#292929]",{"!bg-[#E8D7FF] text-black ml-auto":"user"===e.role})},a.createElement(St,null,e.content),"user"!==e.role&&a.createElement(Tt,{message:e})))))),Ft=({message:e,isLoading:t,deleteMessage:n})=>{const s=(0,a.useMemo)(()=>{const t=e?.annotations?.find(e=>e&&"object"==typeof e&&"type"in e&&Object.values(Bt).includes(e.type));return t?.type||Bt.Default},[e]);return a.createElement(m.N,null,(()=>{switch(s){case Bt.GlobalSummary:return a.createElement(L.A,null,a.createElement(Q,{message:e,deleteMessage:()=>n?.(e.id)}));case Bt.UrgentCheck:return a.createElement(ft,{message:e,deleteMessage:()=>n?.(e.id)});case Bt.GroupSearch:return a.createElement(Le,{message:e});case Bt.UserSearch:return a.createElement(vt,{message:e});case Bt.GoogleAuth:return a.createElement(Ce,{deleteMessage:()=>n?.(e.id)});case Bt.GoogleEventInsert:return a.createElement(ge,{message:e});case Bt.GoogleEventDetail:return a.createElement(Ee,{message:e});case Bt.GoogleMeetTimeConfirm:return a.createElement(Te,{message:e});case Bt.GoogleMeetMention:return a.createElement(ke,{message:e});case Bt.GoogleMeetInformationSuggest:return a.createElement(Me,{message:e});case Bt.RoomSummary:return a.createElement(gt,{message:e});case Bt.RoomActions:return a.createElement(_e,{message:e});case Bt.MeetingIntroduce:return a.createElement(Oe,null);case Bt.SummaryIntroduce:return a.createElement(Ue,null);case Bt.TranslationIntroduce:return a.createElement(Je,null);case Bt.ActionsIntroduce:return a.createElement(Re,null);case Bt.GlobalIntroduce:return a.createElement(x,null);case Bt.RoomAIDescription:return a.createElement(We,{message:e});case Bt.AISearchSugesstion:return a.createElement(g,null);case Bt.AIReplyMention:return a.createElement(rt,{message:e});case Bt.AIMediaSummary:return a.createElement(nt,{message:e});case Bt.UserPortrait:return a.createElement(lt,{userId:e?.content});case Bt.Default:default:return a.createElement(Rt,{message:e,isLoading:t})}})())},Dt=(0,a.memo)(Ft,(e,t)=>e.isLoading===t.isLoading&&e.message.reasoning===t.message.reasoning&&e.message.content===t.message.content&&!!o()(e.message.toolInvocations,t.message.toolInvocations)),Ot=()=>a.createElement(r.P.div,{className:"w-full px-[12px] group/message ",initial:{y:5,opacity:0},animate:{y:0,opacity:1,transition:{delay:1}},"data-role":"assistant"},a.createElement("div",{className:d()("flex gap-4 group-data-[role=user]/message:px-3 w-full group-data-[role=user]/message:w-fit group-data-[role=user]/message:ml-auto group-data-[role=user]/message:max-w-2xl group-data-[role=user]/message:py-2 rounded-xl",{"group-data-[role=user]/message:bg-muted":!0})},a.createElement(M.mP,{size:40})));var zt=n(95547),jt=n(40708);function Ut({chatId:e,className:t,isLoading:n,status:s,messages:o,hasMore:c,deleteMessage:d,loadMore:m}){const u=(0,a.useRef)(!1),p=(0,a.useRef)(null),{containerRef:h,endRef:g,isAtBottom:A,onViewportEnter:y,onViewportLeave:f}=function({chatId:e,status:t}){const{containerRef:n,endRef:s,isAtBottom:o,scrollToBottom:r,onViewportEnter:l,onViewportLeave:c}=(0,i.R)(),d=(0,a.useRef)(!1),[m,u]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{"submitted"===t&&u(!0)},[t]),(0,a.useEffect)(()=>{!d.current&&n.current&&(function({container:e,scrollToBottom:t,maxAttempts:n=30,interval:a=50}){let s=e.scrollHeight,o=0;const r=()=>{const i=e.scrollHeight;i!==s?(t("instant"),s=i,o=0):o++,o<n&&requestAnimationFrame(()=>setTimeout(r,a))};r()}({container:n.current,scrollToBottom:r}),d.current=!0)},[n,r]),{containerRef:n,endRef:s,isAtBottom:o,scrollToBottom:r,onViewportEnter:l,onViewportLeave:c,hasSentMessage:m}}({chatId:e,status:s});return A&&zt.A.updateRoomAIData(jt.bL,"unreadCount",0),a.createElement("div",{ref:h,onScroll:()=>{const e=h.current;if(!e||u.current)return;const{scrollTop:t}=e;if(0===t&&c){u.current=!0;const t=e.firstChild?.firstChild||null;p.current=t,m().finally(()=>{u.current=!1,p.current&&p.current.scrollIntoView({behavior:"instant",block:"start"})})}},className:(0,l.cn)("ai-message-container custom-scroll flex flex-col min-w-0 gap-[10px] h-full overflow-y-auto relative pt-4 overflow-x-hidden",t)},o.map((e,t)=>(e=>e?.annotations?.some(e=>e&&"object"==typeof e&&"isAuxiliary"in e&&!0===e.isAuxiliary)??!1)(e)?null:a.createElement(Dt,{message:e,deleteMessage:d,key:e.id,isLoading:"streaming"===s&&o.length-1===t})),("submitted"===s&&o.length>0&&"user"===o[o.length-1].role||n)&&a.createElement(Ot,null),a.createElement(r.P.div,{ref:g,className:"shrink-0 min-w-[24px] min-h-[24px]",onViewportLeave:f,onViewportEnter:y}))}const Vt=(0,a.memo)(Ut,(e,t)=>!(e.status!==t.status||e.status&&t.status||e.messages.length!==t.messages.length||!o()(e.messages,t.messages)))},6070:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(84051),s=n(80089),o=n(80464);const r=e=>{const{isOpen:t}=e,n=(0,o.A)(s.ar.Extra,"CustomSendMenu",!t);return n?a.Ay.createElement(n,e):void 0}},7971:(e,t,n)=>{"use strict";n.d(t,{Ah:()=>C,Al:()=>v,ER:()=>N,LW:()=>f,WE:()=>p,_b:()=>y,aT:()=>w,mu:()=>A,tg:()=>h,ur:()=>g});var a=n(25279),s=n(72531),o=n(77787),r=n(81120),i=(n(96140),n(90709)),l=n(58554),c=n(69036),d=n(30020),m=n(13439);n(60919),d.GlobalWorkerOptions.workerSrc="pdf.worker.min.js";const u=n(70306);async function p(e,t=!1){if(!e.isMentioned||!e.content?.text?.text)return;let n={chatId:e.chatId,timestamp:(new Date).getTime(),id:(0,a.A)(),createdAt:new Date,role:"assistant",annotations:[{type:"room-ai-reply-mention"}],content:JSON.stringify({messageId:e.id,content:e.content.text?.text,isAuto:t,status:"loading"})};await E(n),(0,r.Rx)({message:e.content.text?.text,language:S()}).then(a=>{a.text?(n={...n,content:JSON.stringify({messageId:e.id,content:e.content.text?.text,replys:a.text,isAuto:t,status:"success"})},E(n)):I(n,e,t)}).catch(a=>{console.log("error",a),I(n,e,t)})}async function h(e,t=!1){const n=e.content?.photo;if(!n)return;const s=(0,i.VO)(n,"download");if(!s)return;let o={chatId:e.chatId,timestamp:(new Date).getTime(),id:(0,a.A)(),createdAt:new Date,role:"assistant",annotations:[{type:"room-ai-media-summary"}],content:JSON.stringify({message:e,isAuto:t,status:"loading"})};await E(o),await x({mimeType:"image/jpeg",mediaHash:s,message:e,newMessage:o,isAuto:t})}async function g(e,t=!1){const n=e.content?.webPage,s=n?n?.url:e.content?.text?.text;if(!s||""===s)return;let o={chatId:e.chatId,timestamp:(new Date).getTime(),id:(0,a.A)(),createdAt:new Date,role:"assistant",annotations:[{type:"room-ai-media-summary"}],content:JSON.stringify({message:e,isAuto:t,status:"loading"})};await E(o),(0,r.U$)({url:s,text:e.content?.text?.text||"",language:S()}).then(n=>{n?.text?(o={...o,content:JSON.stringify({message:e,summaryInfo:n?.text,isAuto:t,status:"success"})},E(o)):I(o,e,t)}).catch(n=>{console.log("error",n),I(o,e,t)})}async function A(e,t=!1){const n=e.content?.document;if(!n)return;const s=(0,i.VO)(n,"download");if(!s)return;if(N(n.mimeType)&&t)return;let o={chatId:e.chatId,timestamp:(new Date).getTime(),id:(0,a.A)(),createdAt:new Date,role:"assistant",annotations:[{type:"room-ai-media-summary"}],content:JSON.stringify({message:e,isAuto:t,status:"loading"})};if(await E(o),N(n.mimeType))return void x({mimeType:n.mimeType,mediaHash:s,message:e,newMessage:o,isAuto:t});if(c=n.mimeType,["video/mp4"].indexOf(c)>=0)return void await b({mediaHash:s,mimeType:n?.mimeType,filename:n?.fileName,size:n?.size,newMessage:o,message:e,isAuto:t});var c;await l.hd(s,0);const m=l.Ih(s);if(!m)return;const p=await fetch(m),h=await p.blob(),g=await h.arrayBuffer();let A="";switch(n.mimeType){case"text/plain":A=(new TextDecoder).decode(g);break;case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":case"application/msword":A=(await u.extractRawText({arrayBuffer:g})).value;break;case"application/pdf":const n=await d.getDocument({data:g}).promise;let a="";for(let e=1;e<=n.numPages;e++){const t=await n.getPage(e);a+=(await t.getTextContent()).items.map(e=>e.str).join(" ")+"\n"}A=a;break;default:return void await I(o,e,t)}""!==A?(0,r.OJ)({content:A,language:S()}).then(n=>{n?.text?(o={...o,content:JSON.stringify({message:e,summaryInfo:n?.text,isAuto:t,status:"success"})},E(o)):I(o,e,t)}).catch(n=>{console.log("error",n),I(o,e,t)}):await I(o,e,t)}async function y(e,t=!1){const n=e.content?.voice;if(!n)return;const s=(0,i.VO)(n,"download");if(!s)return;const o=Math.floor(4194304);if(e.content.audio?.size&&e.content.audio?.size*(4/3)>o)return void c.Ay.info("File size exceeds limit (4 MB)");let r={chatId:e.chatId,timestamp:(new Date).getTime(),id:(0,a.A)(),createdAt:new Date,role:"assistant",annotations:[{type:"room-ai-media-summary"}],content:JSON.stringify({message:e,isAuto:t,status:"loading"})};await E(r),await b({mediaHash:s,mimeType:"audio/ogg",filename:n?.id+".ogg",size:n?.size,newMessage:r,message:e,isAuto:t})}async function f(e,t=!1){const n=e.content?.audio;if(!n)return;const s=(0,i.VO)(n,"download");if(!s)return;let o={chatId:e.chatId,timestamp:(new Date).getTime(),id:(0,a.A)(),createdAt:new Date,role:"assistant",annotations:[{type:"room-ai-media-summary"}],content:JSON.stringify({message:e,isAuto:t,status:"loading"})};await E(o),await b({mediaHash:s,mimeType:n?.mimeType,filename:n?.fileName,size:n?.size,newMessage:o,message:e,isAuto:t})}async function v(e,t=!1){const n=e.content?.video;if(!n)return;const s=(0,i.VO)(n,"download");if(!s)return;let o={chatId:e.chatId,timestamp:(new Date).getTime(),id:(0,a.A)(),createdAt:new Date,role:"assistant",annotations:[{type:"room-ai-media-summary"}],content:JSON.stringify({message:e,isAuto:t,status:"loading"})};await E(o),"video/mp4"===n?.mimeType?await b({mediaHash:s,mimeType:n?.mimeType,filename:n?.fileName,size:n?.size,newMessage:o,message:e,isAuto:t}):await I(o,e,t)}async function E(e){await(o.zs.message?.storeMessage(e)),await s.A.emit(s.E.AddRoomAIMessage,e)}async function b({mediaHash:e,mimeType:t,filename:n,size:a,newMessage:s,message:o,isAuto:i}){try{if(a&&a>4718592)return c.Ay.info("File size exceeds limit (4.5 MB)"),s={...s,content:JSON.stringify({message:o,errorMsg:"File size exceeds limit (4.5 MB)",isAuto:i,status:"error"})},void await E(s);await l.hd(e,0);const d=l.Ih(e);if(!d)return void I(s,o,i);const m=await fetch(d),u=await m.blob(),p=new FormData;p.append("file",u,n||"audio.ogg"),p.append("language",S()),t&&p.append("mimeType",t);const h=await(0,r.DF)(p);h?.text?E(s={...s,content:JSON.stringify({message:o,summaryInfo:h?.text,isAuto:i,status:"success"})}):I(s,o,i)}catch(e){console.log("error",e),I(s,o,i)}}async function x({mimeType:e,mediaHash:t,message:n,newMessage:a,isAuto:s}){await l.hd(t,0);const o=l.Ih(t);if(!o)return void I(a,n,s);const i=await fetch(o),c=await i.blob(),d=new FileReader;d.onloadend=function(){const t=d.result?.toString().split(",")[1]||"";(0,r.IT)({image:`data:${e};base64,`+t,language:S()}).then(e=>{e?.text?E(a={...a,content:JSON.stringify({message:n,summaryInfo:JSON.stringify({text:e?.text}),isAuto:s,status:"success"})}):I(a,n,s)}).catch(e=>{console.log("error",e),I(a,n,s)})},d.readAsDataURL(c)}function w(e){const{photo:t,document:n,webPage:a,voice:s,audio:o,text:r,video:i}=e?.content,l=C(r?.text),c=r?.text&&""!==r.text.trim();return t||n||a&&!c||s||o||l||i}function C(e){return"string"==typeof e&&/^https?:\/\/[\w\-._~:/?#[\]@!$&'()*+,;=%]+$/i.test(e)}function N(e){return e.startsWith("image/")}async function I(e,t,n){e={...e,content:JSON.stringify({message:t,isAuto:n,status:"error"})},await E(e)}function S(){const e=(0,m.mS)(),{autoTranslateLanguage:t="en"}=e.settings.byKey;return new Intl.DisplayNames([t],{type:"language"}).of(t)||"en"}},9442:(e,t,n)=>{"use strict";n.d(t,{A:()=>E});var a=n(84051),s=n(13439),o=n(23174),r=n(66644),i=n(90709),l=n(70636),c=n(36353),d=n(87894),m=n(39074),u=n(17778),p=n(63988),h=n(83414),g=n(37661),A=n(39351),y=n(17712);const f=300;let v;try{v=/(^|\s)@[-_\p{L}\p{M}\p{N}]*$/giu}catch(e){v=/(^|\s)@[-_\d\wа-яёґєії]*$/gi}function E(e,t,n,E,x,w,C,N){const I=(0,A.A)(),[S,M]=(0,a.J0)(),[k,T,P]=(0,g.A)(!1),L=(0,p.gs)(()=>{const n=t();if(!e||!E()?.collapsed||!n.includes("@"))return;const a=(0,m.LV)(x.current);return(0,u.S)(a).match(v)?.[0].trim()},[e,t,E,x],f),B=(0,h.A)(L,[L,t,E],!0),R=(0,h.A)(()=>e&&t().startsWith("@"),[t,e]);(0,a.vJ)(()=>{const e=B();if(!e||!w&&!C)return void M(void 0);const t=(0,s.mS)().users.byId;if(!t)return void M(void 0);const n=w?.reduce((e,t)=>(t.userId!==N&&e.push(t.userId),e),[]),a=e.substring(1),o=(0,l.PU)({ids:(0,d.Am)([...R()&&C||[],...n||[]]),query:a,type:"user"});M(Object.values((0,d._E)(t,o)))},[N,w,C,B,R]);const F=(0,y.A)((e,t=!1,a=!1)=>{if(!e.hasUsername&&!(0,l.F9)(I,e))return;const s=(0,i.Kl)(e),d=(0,l.F9)(I,e)||"",u=s?`@${s}`:`<a\n          class="text-entity-link"\n          data-entity-type="${o.C7.MentionName}"\n          data-user-id="${e.id}"\n          contenteditable="false"\n          dir="auto"\n        >${d}</a>`,p=x.current,h=b((0,m.LV)(p)),g=a?h.length:h.lastIndexOf("@"),A=(s?s.length+1:d.length)-(h.length-g);if(-1!==g){const e=`${h.substr(0,g)}${u}&nbsp;`,a=b(p.innerHTML).substring(h.length),s=(0,m.JC)(p);n(`${e}${a}`),(0,r.Uz)(()=>{const e=s+A+1;(0,c.A)(p,t),e>=0&&(0,m.vZ)(p,e)})}M(void 0)});return(0,a.vJ)(P,[P,t]),{isMentionTooltipOpen:Boolean(S?.length&&!k),closeMentionTooltip:T,insertMention:F,mentionFilteredUsers:S}}function b(e){return e.replace(/<div>(<br>|<br\s?\/>)?<\/div>/gi,"<br>")}},9626:(e,t,n)=>{"use strict";e.exports=n.p+"danger.7dcfa39ea30ab887338e.png"},9717:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var a=n(84051),s=n(87894),o=n(79882),r=n(73767);function i(e,t){const n=(0,a.Kr)(()=>{if(e)return e.reduce((e,t,n)=>(e[t]=n,e),{})},[e]),i=(0,r.A)(n),l=(0,r.A)(t),c=(0,a.Kr)(()=>n&&i&&t===l?(0,s.LG)(n,(e,t)=>void 0!==i[t]?e-i[t]:-1/0):{},[t,n,l,i]);return{orderDiffById:c,getAnimationType:(0,o.W)(c)}}},9740:(e,t,n)=>{"use strict";n.d(t,{A:()=>X});var a=n(84051),s=n(13439),o=n(89925),r=n(96454),i=n(87357),l=n(49763),c=n(80140),d=n(60919),m=n(72531),u=n(40708),p=n(17712),h=n(95547),g=n(22720),A=n(26607),y=n(8235);const f=(0,a.ph)((0,s.EK)(e=>{const t=(0,d.meB)(e);return{isSelected:u.bL===t?.id}})(e=>{const{isSelected:t,offsetTop:n}=e,{openChat:o}=(0,s.ko)(),r=(0,i.A)("Chat chat-item-clickable",t&&"selected"),l=function(){const[e,t]=(0,a.J0)(0),n=(0,p.A)(e=>{e.chatId===u.bL&&t(e.count)});return(0,a.vJ)(()=>{const e=localStorage.getItem("room-ai-data"),a=e&&JSON.parse(e)?.[u.bL]?.unreadCount||0;return t(a),m.A.on(m.E.UpdateRoomAIUnreadCount,n),()=>{m.A.off(m.E.UpdateRoomAIUnreadCount,n)}},[]),e}();return a.Ay.createElement(g.A,{className:r,key:u.bL,style:`top: ${n}px`,onClick:()=>{o({id:u.bL}),h.A.updateRoomAIData(u.bL,"unreadCount",0)},withPortalForMenu:!0},a.Ay.createElement("img",{className:"w-[54px] h-[54px] rounded-full mr-[12px]",src:y,alt:"Tely AI"}),a.Ay.createElement("div",{className:"info"},a.Ay.createElement("div",{className:"info-row"},a.Ay.createElement("div",{className:"title FullNameTitle-module__root"},a.Ay.createElement("h3",{dir:"auto",role:"button",className:"fullName FullNameTitle-module__fullName"},"Tely AI"))),a.Ay.createElement("div",{className:"subtitle"},a.Ay.createElement("p",{className:"last-message shared-canvas-container",dir:"ltr"},"Chat Summary"),a.Ay.createElement(A.A,{isCustom:!0,className:"ChatBadge-transition",isOpen:l>0},a.Ay.createElement("div",{className:"ChatBadge unread"},l)))))}));var v=n(31481),E=n(23459),b=n(66644),x=n(9718),w=n(16581),C=n(74984),N=n(2178),I=n(96374),S=n(5912),M=n(9717),k=n(46222),T=n(52745),P=n(90709),L=n(87894),B=n(14242),R=n(4961),F=n(39351),D=n(21849),O=n(54746),z=n(24713);const j={root:"sG8AAzvK",minimized:"lTOui0dp",button:"bNkLqJf1",title:"rMTpNazX","unread-count":"O7esHjyC",unreadCount:"O7esHjyC",info:"OS2LWzdu",name:"bkCtPuPQ",icon:"f4LUPgr4",avatarWrapper:"RMY__Znz",avatar:"qeb0Aox1",chatsPreview:"_1817Hwgd",unread:"SS39xuL3"},U={isCustomPeer:!0,title:"Archived Chats",avatarIcon:"archive-filled",customPeerAvatarColor:"#9EAAB5"},V=(0,a.ph)(({archiveSettings:e,onDragEnter:t,onClick:n})=>{const{updateArchiveSettings:o}=(0,s.ko)(),r=(0,F.A)(),l=(0,C.Rh)(v._E9),c=(0,C.ic)(),d=c[v._E9]?.chatsCount,m=(0,a.Kr)(()=>{if(!l?.length)return r("Loading");const e=(0,s.mS)().chats.byId;return l.slice(0,5).map((t,n,s)=>{const o=n===s.length-1,l=e[t];if(!l)return;const c=(0,P.Js)(r,l);return a.Ay.createElement(a.Ay.Fragment,null,a.Ay.createElement("span",{className:(0,i.A)(j.chat,d&&l.unreadCount&&j.unread)},(0,R.A)(c)),o?"":", ")})},[l,r,d]),u=(0,a.Kr)(()=>{const t=!e.isMinimized&&{title:r("ContextArchiveCollapse"),icon:"collapse",handler:()=>{o({isMinimized:!0})}},n=e.isMinimized&&{title:r("ContextArchiveExpand"),icon:"expand",handler:()=>{o({isMinimized:!1})}},a={title:r("ContextArchiveToMenu"),icon:"archive-to-main",handler:()=>{o({isHidden:!0})}};return(0,L.oE)([t,n,a])},[e.isMinimized,r,o]),p=(0,a.hb)(e=>{e.preventDefault(),t?.()},[t]);return a.Ay.createElement(g.A,{onClick:n,onDragEnter:p,className:(0,i.A)(j.root,e.isMinimized&&j.minimized,"chat-item-clickable","chat-item-archive"),buttonClassName:j.button,contextActions:u,withPortalForMenu:!0},e.isMinimized?a.Ay.createElement("div",{className:(0,i.A)(j.info,"info")},a.Ay.createElement("div",{className:"info-row"},a.Ay.createElement("div",{className:(0,i.A)("title",j.title)},a.Ay.createElement("h3",{dir:"auto",className:(0,i.A)(j.name,"fullName")},a.Ay.createElement(O.A,{name:"archive-filled",className:j.icon}),r("ArchivedChats"))),a.Ay.createElement(z.A,{className:j.unreadCount,text:d?(0,B.Vw)(r,d):void 0}))):a.Ay.createElement(a.Ay.Fragment,null,a.Ay.createElement("div",{className:(0,i.A)("status",j.avatarWrapper)},a.Ay.createElement(D.A,{peer:U})),a.Ay.createElement("div",{className:(0,i.A)(j.info,"info")},a.Ay.createElement("div",{className:"info-row"},a.Ay.createElement("div",{className:(0,i.A)("title",j.title)},a.Ay.createElement("h3",{dir:"auto",className:(0,i.A)(j.name,"fullName")},r("ArchivedChats")))),a.Ay.createElement("div",{className:"subtitle"},a.Ay.createElement("div",{className:(0,i.A)("status",j.chatsPreview)},m),a.Ay.createElement(z.A,{className:j.unreadCount,text:d?(0,B.Vw)(r,d):void 0})))))});var J=n(32754),H=n(43874),K=n(59030),$=n(79577),G=n(64493);const _=(0,a.ph)((0,s.EK)((e,{folderId:t,folderType:n})=>({chatFolder:t&&"folder"===n?(0,d.$aQ)(e,t):void 0,animatedEmoji:(0,d.oei)(e,"📂")}))(({chatFolder:e,animatedEmoji:t,foldersDispatch:n})=>{const{openSettingsScreen:r}=(0,s.ko)(),i=(0,K.A)(),{isMobile:l}=(0,H.Ay)(),c=(0,a.hb)(()=>{n({type:"editFolder",payload:e}),r({screen:o.VS.FoldersEditFolderFromChatList})},[e,n]);return a.Ay.createElement("div",{className:"yftKUVDQ"},a.Ay.createElement("div",{className:"UCBfMOiz"},t&&a.Ay.createElement($.A,{sticker:t,size:96})),a.Ay.createElement("h3",{className:"dB9cHelg",dir:"auto"},i("FilterNoChatsToDisplay")),a.Ay.createElement("p",{className:"TJ_liZcJ",dir:"auto"},i(e?"ChatList.EmptyChatListFilterText":"Chat.EmptyChat")),e&&a.Ay.createElement(G.A,{ripple:!l,fluid:!0,pill:!0,onClick:c,size:"smaller",isRtl:i.isRtl},a.Ay.createElement(O.A,{name:"settings"}),a.Ay.createElement("div",{className:"aL7e0w4t"},i("ChatList.EmptyChatListEditFilter"))))})),q=(0,a.ph)(({onClick:e})=>{const t=(0,F.A)();return a.Ay.createElement("div",{className:"fOmerTkM",onClick:e},a.Ay.createElement("div",{className:"URLYINJA"},t("TitleFrozenAccount")),a.Ay.createElement("div",{className:"mCFsx7Tv"},t("SubtitleFrozenAccount")))});var W=n(93545);const Q="pedMJD_v",Y=(0,a.ph)(({sessions:e,onHeightChange:t})=>{const{changeSessionSettings:n,terminateAuthorization:o,showNotification:r}=(0,s.ko)(),i=(0,a.li)(),l=(0,K.A)();(0,W.A)(i,e=>{const n=e.borderBoxSize?.[0]?.blockSize||e.contentRect.height;t(n)});const c=(0,a.Kr)(()=>Object.values(e).sort((e,t)=>t.dateCreated-e.dateCreated).find(e=>e.isUnconfirmed),[e]),d=(0,a.Kr)(()=>[c.deviceModel,c.region,c.country].filter(Boolean).join(", "),[c]),m=(0,p.A)(()=>{n({hash:c.hash,isConfirmed:!0})}),u=(0,p.A)(()=>{o({hash:c.hash}),r({title:l("UnconfirmedAuthDeniedTitle",1),message:l("UnconfirmedAuthDeniedMessageSingle",d)})});return a.Ay.createElement("div",{className:"yEkGgZVL",ref:i},a.Ay.createElement("h2",{className:"VhAJDrnz"},l("UnconfirmedAuthTitle")),a.Ay.createElement("p",{className:"WmyL1NJ8"},l("UnconfirmedAuthSingle",d)),a.Ay.createElement("div",{className:"_40UGD1Y"},a.Ay.createElement(G.A,{fluid:!0,isText:!0,size:"smaller",className:Q,onClick:m},l("UnconfirmedAuthConfirm")),a.Ay.createElement(G.A,{fluid:!0,isText:!0,size:"smaller",color:"danger",onClick:u,className:Q},l("UnconfirmedAuthDeny"))))}),Z=new Set(["9","0"]),X=(0,a.ph)(({className:e,folderType:t,folderId:n,isActive:d,isForumPanelOpen:m,canDisplayArchive:h,archiveSettings:g,sessions:A,foldersDispatch:y,onSettingsScreenSelect:P,onLeftColumnContentChange:L,isAccountFrozen:B,isMainList:R})=>{const{openChat:F,openNextChat:D,closeForumPanel:O,toggleStoryRibbon:z,openFrozenAccountModal:j,openLeftColumnContent:U}=(0,s.ko)(),H=(0,a.li)(),K=(0,a.li)(!1),[$,G]=(0,a.J0)(0),W="archived"===t,Q="all"===t,X="saved"===t,ee="preset"===t,te="unread"===t,ne="ai"===t,ae=Q?v.DSF:W?v._E9:X?v.pX9:ee?v.LFk:te?v.j7l:ne?v.Sab:n,se=Q&&h&&g,oe=B&&Q,re=(0,C.Rh)(ae);(0,E.A)(re);const ie=(re?.length||0)*v.yq1,le=se?g?.isMinimized?v.eqO:v.yq1:0,ce=oe?68:0,{orderDiffById:de,getAnimationType:me}=(0,M.A)(re),[ue,pe]=(0,I.A)(void 0,re,void 0,v.T7t),he=(0,a.Kr)(()=>{const e=Object.values(A||{}),t=e.find(e=>e.isCurrent);return!(!t||(0,c.Fm)()-t.dateCreated<v.C7Y)&&!B&&Q&&e.some(e=>e.isUnconfirmed)},[Q,A,B]);(0,a.vJ)(()=>{he||G(0)},[he]),(0,N.v)((0,a.Kr)(()=>d&&re?.length?{"Alt+ArrowUp":e=>{e.preventDefault(),D({targetIndexDelta:-1,orderedIds:re})},"Alt+ArrowDown":e=>{e.preventDefault(),D({targetIndexDelta:1,orderedIds:re})}}:void 0,[d,re])),(0,a.vJ)(()=>{if(d&&!X&&re&&r.lE)return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)};function e(e){if((r.MP&&e.metaKey||!r.MP&&e.ctrlKey)&&e.code.startsWith("Digit")){const[,t]=e.code.match(/Digit(\d)/)||[];if(!t||Z.has(t))return;const n=se&&g&&!g.isMinimized,a=n?-1:0,s=Number(t)+a-1;if(n&&-1===s)return void(R&&U({contentKey:o.Bn.Archived}));if(s>re.length-1)return;F({id:re[s],shouldReplaceHistory:!0})}}},[g,X,d,F,D,re,se,R]);const{observe:ge}=(0,S.BL)({rootRef:H,throttleMs:200}),Ae=(0,p.A)(()=>{U({contentKey:o.Bn.Archived}),O()}),ye=(0,p.A)(()=>{j()}),fe=(0,p.A)(()=>{K.current?K.current=!1:Ae()}),ve=(0,w.A)(e=>{K.current?K.current=!1:F({id:e,shouldReplaceHistory:!0})},[F],500,!0),Ee=(0,p.A)(e=>{const t=e.currentTarget.getBoundingClientRect(),n=e.clientX-t.left,a=e.clientY-t.top;n<t.width||a<t.y||(K.current=!0)}),be=function(e,t,n,s){const o=(0,a.li)(),i=(0,a.li)(!1),l=(0,a.li)(0),c=(0,a.li)(!1),d=(0,a.li)(!0),m=(0,a.li)(0),u=(0,a.li)(!1),h=(0,p.A)((t=!1)=>{c.current||o.current&&e.current&&(o.current.style.display="block",e.current.scrollTop=1,r.Yw||t||(0,x.E)(e.current),i.current=!0,l.current=1,c.current=!0,d.current=!0)}),g=(0,p.A)(()=>{c.current&&o.current&&(o.current.style.display="none",c.current=!1)}),A=(0,p.A)(()=>{if(!e.current)return;if(i.current)return void(i.current=!1);const a=e.current.scrollTop,s=a>l.current,r=a<l.current,p=0===a,A=Date.now()-m.current;if(o.current){if(p&&!c.current)return void(0,b.dL)(h,[e.current,o.current]);(0,b.dL)(g,o.current)}r&&(d.current&&A>100||a<0&&u.current)?t?.():s&&a>0&&n?.(),l.current=a,d.current=p,m.current=Date.now(),u.current=s&&a<0}),y=(0,w.A)(a=>{if(!e.current)return;const s=e.current;s.scrollHeight>s.offsetHeight||0===a.deltaY||(a.deltaY<0?t?.():n?.())},[e,t,n],250);return(0,a.vJ)(()=>{const t=e.current;if(t)return 0===t.scrollTop&&(0,b.RK)(()=>{h(!0)}),t.addEventListener("scroll",A,{passive:!0}),t.addEventListener("wheel",y,{passive:!0}),()=>{t.removeEventListener("scroll",A),t.removeEventListener("wheel",y)}},[e,y]),r.pz||s?void 0:a.Ay.createElement("div",{ref:o,className:"overscroll-trigger",key:"overscroll-trigger"})}(H,(0,p.A)(()=>{z({isShown:!0,isArchived:W})}),(0,p.A)(()=>{z({isShown:!1,isArchived:W})}),X);return a.Ay.createElement(k.A,{className:(0,i.A)("chat-list custom-scroll",m&&"forum-panel-open",e),ref:H,items:ue,itemSelector:".ListItem:not(.chat-item-archive)",preloadBackwards:v.T7t,withAbsolutePositioning:!0,beforeChildren:be,maxHeight:ie+le+ce+$,onLoadMore:pe,onDragLeave:Ee},he&&a.Ay.createElement(Y,{key:"unconfirmed",sessions:A,onHeightChange:G}),oe&&a.Ay.createElement(q,{key:"frozen",onClick:ye}),se&&a.Ay.createElement(V,{key:"archive",archiveSettings:g,onClick:Ae,onDragEnter:fe}),ue?.length?function(){const e=re.indexOf(ue[0]),t=(0,l.zm)(ae)||0;return ue.map((s,o)=>{const r=e+o<t,i=$+le+ce+(e+o)*v.yq1;return s===u.bL?a.Ay.createElement(f,{key:"serena",offsetTop:i}):a.Ay.createElement(J.A,{key:s,teactOrderKey:r?o:(0,l.uk)(s,X),chatId:s,isPinned:r,folderId:n,isSavedDialog:X,animationType:me(s),orderDiff:de[s],offsetTop:i,observeIntersection:ge,onDragEnter:ve})})}():!ue||ue.length||X?a.Ay.createElement(T.A,{key:"loading"}):a.Ay.createElement(_,{folderId:n,folderType:t,foldersDispatch:y}))})},10221:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var a=n(84051),s=n(66644),o=n(76023),r=n(17712);const i=o.$;function l({anchorRef:e,overlayRef:t,isMirrored:n,isForMessageEffect:o,isDisabled:l,id:c}){const d=(0,r.A)(()=>{const a=t.current,r=e.current;if(!a||!r)return;const l=r.getBoundingClientRect(),c=a.getBoundingClientRect(),d=window.innerWidth;(0,s.RK)(()=>{const e=l.top+l.height/2,t=l.bottom,s=o?t:e;a.style.top=s-c.height/2+"px",n?a.style.left=l.left-i+"px":a.style.right=d-l.right-i+"px"})});return(0,a.vJ)(()=>{l||d()},[l,c]),(0,a.vJ)(()=>{if(l)return;const t=e.current.closest(".MessageList");return t?(t.addEventListener("scroll",d,{passive:!0}),()=>{t.removeEventListener("scroll",d)}):void 0},[l,e]),d}},10587:(e,t,n)=>{"use strict";n.d(t,{X:()=>r});var a=n(96540),s=n(22199);function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o.apply(null,arguments)}const r=a.forwardRef(({className:e,...t},n)=>a.createElement("textarea",o({className:(0,s.cn)("flex min-h-[45px] w-full border-box rounded-md border border-input bg-white px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm dark:bg-black dark:placeholder:text-[#888888]",e),ref:n},t)));r.displayName="Textarea"},10979:(e,t,n)=>{"use strict";n.d(t,{s:()=>B,A:()=>R});var a=n(84051),s=n(74353),o=n.n(s),r=n(2543),i=n(13439),l=n(60919),c=n(87357),d=n(59030),m=n(76526),u=n(96140),p=n(77787),h=n(7971),g=n(81120);var A=n(21849),y=n(34431),f=n(46222),v=n(57474),E=n(11553),b=n(23814),x=n(8235),w=n(63947),C=n(9716),N=n(22199);const I=({chatId:e,showName:t,size:n})=>{const{openChat:s}=(0,i.ko)(),o=(0,i.mS)(),r=(0,C.L8)(e);let c;return c=r?(0,l.mBe)(o,e):(0,l.hds)(o,e),a.Ay.createElement("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>{s({id:e})}},a.Ay.createElement(A.A,{key:e,className:(0,N.cn)("overlay-avatar inline-block"),size:n??20,peer:c}),t&&a.Ay.createElement("div",null,r?`${c?.firstName??""} ${c?.lastName??""}`:c?.title))},S=({topicItem:e,index:t,chatId:n})=>{const{title:s,summaryItems:o}=e;if(!s||!n)return;const{focusMessage:r}=(0,i.ko)();return a.Ay.createElement("div",{className:"px-3"},a.Ay.createElement("div",{className:"flex flex-row items-center flex-wrap"},a.Ay.createElement("span",{className:"font-[700] mr-[14px]"},t+1,". ",s),a.Ay.createElement(I,{chatId:n})),a.Ay.createElement("ul",{className:"list-disc pl-1 list-inside"},o.map(e=>{const{content:t,relevantMessageIds:s}=e;if(t)return a.Ay.createElement("li",{role:"button",className:"cursor-pointer break-words",onClick:()=>function(e){if(!n)return;const t=Math.min(...e);t&&r({chatId:n,messageId:t})}(s)},t)})))},M=({data:e,isLast:t})=>a.Ay.createElement("div",{className:(0,c.A)("flex flex-col border-b-[1px]",t?"border-[transparent]":"border-[#EDEDED]")},a.Ay.createElement("div",{className:"flex items-center justify-between gap-1 px-3"},a.Ay.createElement("div",{className:"flex items-center gap-2"},a.Ay.createElement("img",{src:x,className:"w-[22px] h-[22px]",alt:""}),a.Ay.createElement("div",{className:"font-[600]"},"Tely AI")),a.Ay.createElement("div",{className:"text-[12px] text-[#979797]"},o()(e?.time).format("MMM D"),", ",e?.timeRange?.split("-")?.[1])),a.Ay.createElement("div",{className:"my-2 px-3"},a.Ay.createElement("div",{className:"flex items-center gap-[8px]"},a.Ay.createElement("img",{className:"w-[16px] h-[16px]",src:E,alt:""}),a.Ay.createElement("div",{className:"flex items-center gap-[4px]"},a.Ay.createElement("span",{className:"mr-[4px] font-bold text-[14px]"},"Time range: "),o()(e?.time).format("MMM D"),", ",e?.timeRange)),a.Ay.createElement("div",{className:"flex items-center gap-[8px]"},a.Ay.createElement("img",{className:"w-[16px] h-[16px]",src:b,alt:""}),a.Ay.createElement("div",{className:"flex items-center gap-[4px]"},a.Ay.createElement("span",{className:"font-bold text-[14px]"},"Messages: "),e?.messageCount?a.Ay.createElement("span",null,e?.messageCount):void 0))),e?.chatGroups?.map((e,t)=>a.Ay.createElement(S,{key:e?.chatId,chatId:e?.chatId,topicItem:e,index:t}))),k=({user:e,data:t,isLast:n})=>a.Ay.createElement("div",{className:(0,c.A)("flex flex-col pb-3 border-b-[1px]",n?"border-[transparent]":"border-[#EDEDED]")},a.Ay.createElement("div",{className:"flex items-center justify-between gap-1 px-3"},a.Ay.createElement("div",{className:"flex items-center gap-2"},a.Ay.createElement("img",{src:x,className:"w-[22px] h-[22px]",alt:""}),a.Ay.createElement("div",{className:"font-[600]"},"Tely AI")),a.Ay.createElement("div",{className:"text-[12px] text-[#979797]"},o()(t?.time).format("MMM D, HH:mm"))),a.Ay.createElement("div",{className:"ml-[25px] mt-2 px-3"},a.Ay.createElement("div",{className:"mb-1"},a.Ay.createElement("span",{className:"font-[600]"},e?.firstName||""," ",e?.lastName||""),"Post a Story"),a.Ay.createElement(w.A,{story:t.message,isArchive:!1}))),T=function({user:e,data:t,isLast:n}){const s=!1!==t.isSummary,o=!s&&"story"===t?.id?.split("-")[1];return s?a.Ay.createElement(M,{data:t,isLast:n}):o?a.Ay.createElement(k,{data:t,isLast:n,user:e}):void 0};var P=n(47778),L=n(24845);const B=["#E5D9FF","#CCD6FF","#B6FFCE","#FFD9D9","#FFD9FF"],R=(0,a.ph)((0,i.EK)(e=>{const{userPortraitUserId:t}=(0,l.nTw)(e);return{user:t?(0,l.mBe)(e,t):void 0,theme:(0,l.SJA)(e)}})(({theme:e,userId:t,user:n})=>{const{loading:s,userPortraitInfo:l,chatTags:E,portraitMessage:b}=function({userId:e}){const[t,n]=(0,a.J0)(!1),[s,o]=(0,a.J0)([]),[r,l]=(0,a.J0)(void 0),[c,d]=(0,a.J0)(void 0),[A,y]=(0,a.J0)([]),[f,v]=(0,a.J0)([]),E=(0,a.hb)(async e=>{n(!0);const t=await(0,m.cZ)(e);o(t?.filter(e=>!(0,h.Ah)(e?.content))),n(!1)},[o]),b=(0,a.hb)(async e=>{const t=await(p.zs.userPortrait?.getUserPortrait(e));t?(l(t),d(t)):(l(void 0),d(void 0));const n=await(p.zs.userPortraitMessage?.searchMessageBySenderId(e));y(n)},[]),x=(0,a.hb)(()=>{if(0===s?.length)return;const t=Math.max(...s.map(e=>e.messageId));if((!r||!r?.lastMsgId||r&&r?.lastMsgId<t)&&e===s?.[0]?.senderId){const a=r?.lastMsgId??0,o=s.reduce((e,t)=>(e[t.chatId]=(e[t.chatId]||0)+1,e),{}),l=Object.entries(o).sort((e,t)=>t[1]-e[1]).map(e=>e[0]);(0,g.g4)({data:{messages:[{role:"system",content:"\n  你是一个专业的数据分析师, 根据提供的消息内容进行分析, 并返回JSON格式数据;\n  # 格式要求\n    ## 去除所有换行符,确保 JSON 结构紧凑\n    ## 严格遵从JSON规范,确保所有的JSON数据正确\n  # 数据字段解析\n    ## langs: 根据提供的内容，判断出用的是哪种语言，如Chinese, English等; 最多给出两种，按使用频率排序\n    ## tags: 根据提供的内容，分析出用户的职业或涉及的行业, 给出最多5个标签;\n  # 返回的JSON格式示例\n    {\n      langs: ['Chinese', 'English'],\n      tags: ['Analytical Investor', 'DAO Governance'],\n    }\n"},{role:"user",content:s?.slice(0,100)?.map(e=>e.content).join(" ")}]},onResponse:n=>{const a=(0,u.CQ)(n),s={...r,id:e,lastMsgId:t,langs:a?.langs,tags:a?.tags,chatCount:Object.keys(o).length,chatIds:l};p.zs.userPortrait?.addUserPortrait(s),d(s)}});const c=(0,m.kU)(s.filter(e=>e.messageId>a));if(0===c.length)return;n(!0);const h=(0,i.mS)(),{autoTranslateLanguage:A="en"}=h.settings.byKey;(0,g.g4)({data:{messages:[{role:"system",content:"\n## 输入字段解释\n   - chatGroups: 聊天组\n    - chatId: 群聊ID\n    - messages: 聊天记录\n     - content: 消息内容\n   - time: 日期\n   - timeRange: 时间范围\n# 输出格式要求\n    ## 去除所有换行符,确保 JSON 结构紧凑\n    ## 严格遵从JSON规范,确保所有的JSON数据正确\n## 各模块输出要求\n  ## mainTopic(主要话题)\n  - 目标：提取各群聊的主要话题、关键数据、时间节点、观点与行动建议，形成“日报风格”的结构化摘要。\n    - title：该群聊消息的主要话题简述，需简洁、明确、贴近群内讨论核心\n    - content：只提取有实际价值的信息，包括但不限于：\n           - 行情数据、交易记录、质押金额、区块信息等\n           - 涉及数字、价格、网址、时间等要素的内容\n           - 用户的观点、经验分享、操作建议、趋势判断等\n    - content 必须剔除下列内容：\n      - 单独的短语、问候、无意义的表情或单字回复（如“来了”“哈”“好”）\n      - 无法单独体现价值的闲聊碎片\n    - 如果多条短句连贯构成有价值的观点或讨论，请合并后保留\n    - 如果某个群聊**没有任何有价值的内容**，则**完全省略该群聊，不在输出中显示**\n    - 输出格式及字段说明：\n      [\n        {\n          time: 日期, // 原样返回\n          timeRange: '时间范围', // 原样返回\n          chatGroups: [{\n            chatId: 群聊ID, // 原样返回\n            title: '8-15字核心议题',\n            summaryItems: {       // 至少1条，最多5条\n              content: 子话题：数据+行为+建议\"结构'; 如无总结内容，则直接返回原信息\n              relevantMessageIds: [消息ID1, 消息ID2, ...], // 原样返回\n            }[]\n          }]\n        }\n      ]\n"},{role:"system",content:`响应必须完全用以下目标语言编写:${A},不要使用其他语言。`},{role:"user",content:JSON.stringify(c)}]},onResponse:t=>{const a=(0,u.CQ)(t),s=[];a?.forEach(t=>{const n=c.find(e=>e?.timeRange===t?.timeRange&&e?.time===t?.time),a={id:`${e}-(${t?.time})-(${t?.timeRange})`,senderId:e,isSummary:!0,time:t?.time,timeRange:t?.timeRange,summaryTime:(new Date).getTime(),messageCount:n?.chatGroups?.reduce((e,t)=>e+((t?.messages||[])?.length??0),0)??0,chatGroups:t?.chatGroups?.map(e=>({chatId:e?.chatId,title:e?.title,summaryItems:e?.summaryItems}))};p.zs.userPortraitMessage?.addUserPortraitMessage(a),s.push(a)}),y(e=>[...e,...s]),n(!1)},onFinish:()=>{n(!1)}})}},[s,e,r]),w=(0,a.hb)(()=>{const e=[];c?.chatIds&&c?.chatIds?.length>0&&c?.chatIds?.slice(0,5).forEach(async t=>{const n=await(p.zs.aIChatFolders?.getAIChatFolder(t));e.push(n?.summary)}),v(e)},[c?.chatIds]);return(0,a.vJ)(()=>{x()},[s?.length,r?.lastMsgId,x]),(0,a.vJ)(()=>{w()},[w,c?.chatIds]),(0,a.vJ)(()=>{n(!1),o([]),y([]),d({}),v([]),b(e),E(e)},[e,E,b]),{userPortraitInfo:c,chatTags:f,portraitMessage:A,loading:t}}({userId:t}),x=(0,a.li)(),w=(0,d.A)();return(0,a.vJ)(()=>{x?.current?.scrollTo({top:0,behavior:"smooth"})},[t]),a.Ay.createElement(f.A,{ref:x,className:(0,c.A)(P.A.rightPanelBg,"Portrait custom-scroll"),noFastList:!0},a.Ay.createElement(a.Ay.Fragment,null,a.Ay.createElement("div",{className:"flex flex-col gap-2 items-center justify-center"},a.Ay.createElement(A.A,{peer:n,className:L.A.fallbackPhotoAvatar,size:"giant"}),a.Ay.createElement(y.A,{peer:n,canCopyTitle:!0})),a.Ay.createElement("div",{className:"rounded-[16px] bg-[var(--color-ai-room-media-bg)] p-3 text-[14px]"},a.Ay.createElement("div",{className:"text-[16px] font-[700] mb-2"},"Basic Description"),a.Ay.createElement("div",{className:"flex flex-col gap-1"},n?.usernames?.[0]?.username&&a.Ay.createElement("div",null,a.Ay.createElement("span",{className:"font-[600]"},"Username: "),n?.usernames?.[0]?.username),a.Ay.createElement("div",null,a.Ay.createElement("span",{className:"font-[600]"},"Alias/Nickname: "),n?.firstName," ",n?.lastName),l?.langs&&a.Ay.createElement("div",null,a.Ay.createElement("span",{className:"font-[600]"},"Language: "),`${l?.langs?.[0]?`${l?.langs?.[0]}(Primary)`:""} ${l?.langs?.[1]?`, ${l?.langs?.[1]}(Secondary)`:""}`),l?.tags&&l?.tags?.length>0&&a.Ay.createElement(a.Ay.Fragment,null,a.Ay.createElement("div",null,a.Ay.createElement("span",{className:"font-[600]"},"Tags: ")),a.Ay.createElement("div",{className:"flex flex-row flex-wrap items-center gap-2"},l?.tags?.map((e,t)=>a.Ay.createElement("div",{className:"flex items-center justify-center px-2 rounded-[4px] h-[28px] text-[12px] font-[500] text-black",style:`background: ${B[t]}`},e))))))),l?a.Ay.createElement("div",{className:"rounded-[16px] bg-[var(--color-ai-room-media-bg)] p-3 text-[14px]"},a.Ay.createElement("div",{className:"text-[16px] font-[700] mb-2"},"Behavioral Features & Group Participation"),l?.chatCount&&l?.chatCount>0&&a.Ay.createElement("div",null,a.Ay.createElement("div",{className:"font-[600]"},"Group Coverage"),a.Ay.createElement("div",null,"Participates in ",l?.chatCount," TG groups"," ",E?.length>0&&E?.filter(Boolean).length>0&&`(${(0,r.uniq)(E).join(",")})`)),l?.chatIds?.length&&a.Ay.createElement("div",{className:"mt-2"},a.Ay.createElement("div",{className:"font-[600]"},"Key Groups"),a.Ay.createElement("div",{className:"flex flex-col gap-2 mt-2"},l?.chatIds?.map(e=>a.Ay.createElement(I,{key:e,chatId:e,size:24,showName:!0}))))):void 0,a.Ay.createElement("div",{className:"rounded-[16px] bg-[var(--color-ai-room-media-bg)] text-[14px]"},a.Ay.createElement("div",{className:" rounded-t-[16px] text-[16px] font-[700] p-3 sticky top-[-10px] z-10 bg-[var(--color-ai-room-media-bg)] "},"Activity Stream"),s&&a.Ay.createElement("div",{className:"flex items-center justify-center p-3"},a.Ay.createElement(v.A,{className:"w-[18px] h-[18px] ml-2",color:"dark"===e?"white":"black"})),b?.length&&n?a.Ay.createElement("div",{className:"flex flex-col gap-2"},b?.sort((e,t)=>o()(!1===t?.isSummary?t?.time:`${t?.time} ${t?.timeRange?.split("-")[1]}`).unix()-o()(!1===e?.isSummary?e?.time:`${e?.time} ${e?.timeRange?.split("-")[1]}`).unix())?.map((e,t)=>a.Ay.createElement(T,{user:n,data:e,isLast:t===b.length-1,key:e?.id}))):!s&&a.Ay.createElement("div",{className:"empty"},w("NoMessages"))))}))},11359:(e,t,n)=>{"use strict";n.d(t,{L:()=>s});const a=5;function s(e,t){const{commonAncestorContainer:n}=e;let s=n,o=1;for(;s&&s.id!==t&&o<a;)s=s.parentElement,o++;return Boolean(s&&s.id===t)}},11462:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var a=n(84051),s=n(30857),o=n(17712),r=n(35297);function i(e=!1){const t=(0,a.li)(e),n=(0,a.li)(!1),i=(0,s.A)();(0,r.A)(()=>{e&&(t.current=!0)},[e]);const l=(0,o.A)(()=>{t.current=!1,n.current=!1,i()}),c=(0,o.A)(()=>{n.current=!0,i()});return{shouldRenderForumPanel:t.current,isAnimationStarted:n.current,handleForumPanelAnimationEnd:l,handleForumPanelAnimationStart:c}}},14413:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var a=n(84051),s=n(13439),o=n(31481),r=n(39351),i=n(19806),l=n(94189);const c=(0,a.ph)((0,s.EK)(e=>{const t=e.appConfig,n=t?.verifyAgeMin;return{verifyAgeMin:n||o.lYi}})(({isOpen:e,onClose:t,shouldAlwaysShow:n,onAlwaysShowChanged:s,confirmHandler:o,verifyAgeMin:c})=>{const d=(0,r.A)();return a.Ay.createElement(l.A,{title:d("TitleSensitiveModal",{years:c}),confirmLabel:d("ButtonSensitiveView"),isOpen:e,onClose:t,confirmHandler:o},d("TextSensitiveModal"),a.Ay.createElement(i.A,{className:"mYXi2mIC",label:d("ButtonSensitiveAlways",{years:c}),checked:n,onCheck:s}))}))},14792:(e,t,n)=>{"use strict";e.exports=n.p+"ai-translate.0aa5d916daa46257d410.png"},15006:(e,t,n)=>{"use strict";n.d(t,{U:()=>p,A:()=>u});var a=n(84051),s=n(13439),o=n(31481),r=n(60919),i=n(6842),l=n(14235);const c={root:"AN8wkEiR",ghost:"ANWk2pWP",scale:"kMHxyoSt",elementContainer:"UDCMfXxs"},d=50,m=1e3,u=(0,a.ph)(()=>a.Ay.createElement("div",{className:c.root,id:o.Lj4}));function p(e){const t=(0,s.mS)();if(!(0,r.Rwe)(t))return!1;const n=e.getBoundingClientRect(),u=n.left+window.scrollX,p=n.top+window.scrollY,h=n.width,g=n.height;if(u+h+d<0||u-d>window.innerWidth||p+g+d<0||p-d>window.innerHeight)return!1;const A=Math.floor(Date.now()/1e3),y=`${o.xcU}-${(0,l.A)()}`,f=a.Ay.createElement("svg",{className:c.ghost,width:h,height:g,style:`left: ${u}px; top: ${p}px;`,viewBox:`0 0 ${h} ${g}`},a.Ay.createElement("defs",null,function(e,t,n=42){return a.Ay.createElement("filter",{xmlns:o.jNX,id:e,x:"-150%",y:"-150%",width:"400%",height:"400%","color-interpolation-filters":"sRGB"},a.Ay.createElement("feTurbulence",{type:"fractalNoise",baseFrequency:"0.5",numOctaves:"1",result:"dustNoise",seed:n}),a.Ay.createElement("feComponentTransfer",{in:"dustNoise",result:"dustNoiseMask"},a.Ay.createElement("feFuncA",{type:"linear",slope:"5",intercept:"0"},a.Ay.createElement("animate",{attributeName:"slope",values:"5; 2; 1; 0",dur:`${m}ms`,fill:"freeze"}))),a.Ay.createElement("feComposite",{in:"SourceGraphic",in2:"dustNoiseMask",operator:"in",result:"dustySource"}),a.Ay.createElement("feTurbulence",{type:"fractalNoise",baseFrequency:"0.015",numOctaves:"1",result:"displacementNoise1",seed:n+1}),a.Ay.createElement("feTurbulence",{type:"fractalNoise",baseFrequency:"1",numOctaves:"2",result:"displacementNoise2",seed:n+2}),a.Ay.createElement("feMerge",{result:"combinedNoise"},a.Ay.createElement("feMergeNode",{in:"displacementNoise1"}),a.Ay.createElement("feMergeNode",{in:"displacementNoise2"})),a.Ay.createElement("feDisplacementMap",{in:"dustySource",in2:"combinedNoise",scale:"0",xChannelSelector:"R",yChannelSelector:"G"},a.Ay.createElement("animate",{attributeName:"scale",values:"0; "+3*t,dur:`${m}ms`,fill:"freeze"})))}(y,Math.min(h,g),A)),a.Ay.createElement("g",{filter:`url(#${y})`},a.Ay.createElement("foreignObject",{className:c.elementContainer,width:h,height:g}))),v=(0,i.A)(f)[0],E=v.querySelector("foreignObject"),b=window.getComputedStyle(e),x=e.cloneNode(!0);Array.from(b).forEach(e=>x.style.setProperty(e,b.getPropertyValue(e),"important")),E.appendChild(x);const w=document.getElementById(o.Lj4);return w.appendChild(v),v.addEventListener("animationend",()=>{w.removeChild(v)},{once:!0}),!0}},15365:()=>{},15591:(e,t,n)=>{"use strict";n.d(t,{A:()=>ie});var a=n(84051),s=n(13439),o=n(23174),r=n(31481),i=n(90709),l=n(27109),c=n(60919),d=n(85982),m=n(64713),u=n(83868),p=n(59852),h=n(79882),g=n(24899),A=n(4961),y=n(82117),f=n(39351),v=n(17712),E=n(62587),b=n(59030),x=n(38691),w=n(32754),C=n(64493),N=n(22720),I=n(55158),S=n(63152),M=n(87412),k=n(84685),T=n(66644),P=n(96454),L=n(87357),B=n(17663);const R=1440,F=10080;function D(){const e=new Date;e.setHours(0,0,0,0);const t=e.getDay(),n=e.getDate()-t+(0===t?-6:1);return new Date(e.setDate(n)).getTime()}function O(e,t){if(0===t)return e;const n=[];for(const a of e){let e=(a.startMinute+t)%F,s=(a.endMinute+t)%F;e<0&&(e+=F),s<=0&&(s+=F),e>s?(n.push({startMinute:e,endMinute:10079}),n.push({startMinute:0,endMinute:s})):n.push({startMinute:e,endMinute:s})}return n.sort((e,t)=>e.startMinute-t.startMinute),n.reduce((e,t)=>{const n=e[e.length-1];return n&&n.endMinute>=t.startMinute?n.endMinute=Math.max(n.endMinute,t.endMinute):e.push(t),e},[])}var z=n(98255),j=n(32625),U=n(19129),V=n(37661),J=n(30857),H=n(41036),K=n(54746);const $="MPBKHdZL",G=Array.from({length:7},(e,t)=>t),_=(0,a.ph)(({businessHours:e})=>{const t=(0,a.li)(),[n,s,o]=(0,V.A)(!1),[r,i,l]=(0,V.A)(!1),c=(0,b.A)(),d=(0,J.A)();(0,j.A)(d,6e4);const m=(0,z.A)(e=>e.timezones?.byId),u=(0,U.A)(m,[m]),p=(0,a.Kr)(()=>{if(!u)return 0;const t=u[e.timezoneId];return(-60*(new Date).getTimezoneOffset()-t.utcOffset)/60},[e.timezoneId,u]),h=(0,a.Kr)(()=>{const t=D(),n=function(e){const t={};for(const n of e){const e=n.startMinute,a=n.endMinute,s=Math.floor(e/R),o=Math.floor((a-1)/R);for(let n=s;n<=o;n++)t[n]||(t[n]=[]),t[n].push({startMinute:Math.max(0,e-n*R),endMinute:Math.min(R,a-n*R)})}return t}(O(e.workHours,r?p:0)),a={};return G.forEach(e=>{const s=n[e];a[e]=s?s.map(({startMinute:e,endMinute:n})=>n-e===1440?c("BusinessHoursDayFullOpened"):`${(0,B.fU)(c,t+60*e*1e3)} – ${(0,B.fU)(c,t+60*n*1e3)}`):[c("BusinessHoursDayClosed")]}),a},[e.workHours,r,c,p]),g=(0,a.Kr)(()=>{const t=O(e.workHours,p),n=D(),a=((new Date).getTime()-n)/1e3/60;return t.some(({startMinute:e,endMinute:t})=>e<=a&&a<=t)},[e.workHours,p]),A=(0,a.Kr)(()=>(new Date(Date.now()-(r?0:60*p*1e3)).getDay()+6)%7,[r,p]),y=(0,v.A)(()=>{n?o():s()}),f=(0,v.A)(e=>{e.stopPropagation(),r?l():i()});(0,a.vJ)(()=>{if(!n)return;const e=document.querySelector(`.${H.uo} > .${$}`);if(!e)return;const a=e.offsetHeight;(0,T.RK)(()=>{t.current.style.height=`${a}px`})},[n]);const E=(0,v.A)(()=>{const e=document.querySelector(`.${H.VY} > .${$}`);(0,T.YS)(()=>{const n=e.offsetHeight;(0,T.RK)(()=>{t.current.style.height=`${n}px`})})});return a.Ay.createElement(N.A,{icon:"clock",iconClassName:"rlM4Mbnn",multiline:!0,className:"Ef_0p5Qm",isStatic:n,ripple:!0,narrow:!0,withColorTransition:!0,onClick:y},a.Ay.createElement("div",{className:"nHSmCUNs"},a.Ay.createElement("div",{className:"JTZ8UnnP"},a.Ay.createElement("div",null,c("BusinessHoursProfile")),a.Ay.createElement("div",{className:(0,L.A)("JVL7ZnnJ",g&&"segAfYXs")},c(g?"BusinessHoursProfileNowOpen":"BusinessHoursProfileNowClosed"))),a.Ay.createElement(K.A,{className:"dYxw2cFn",name:n?"up":"down"})),n&&a.Ay.createElement("div",{className:"lp9VIV1o"},Boolean(p)&&a.Ay.createElement("div",{className:"gVwflFhz",role:"button",tabIndex:0,onMouseDown:P.TF?void 0:f,onClick:P.TF?f:void 0},c(r?"BusinessHoursProfileSwitchMy":"BusinessHoursProfileSwitchLocal")),a.Ay.createElement(H.Ay,{className:"WKgL_XiP",ref:t,name:"fade",activeKey:Number(r),onStart:E},a.Ay.createElement("dl",{className:$},G.map(e=>a.Ay.createElement(a.Ay.Fragment,null,a.Ay.createElement("dt",{className:(0,L.A)("cmxPqAof",e===A&&"YZVvP_56")},(0,B.wv)(c,6===e?0:e+1)),a.Ay.createElement("dd",{className:"Rs0VPgpq"},h[e].map(e=>a.Ay.createElement("div",null,e)))))))))});var q=n(77787),W=n(10979);const Q=()=>a.Ay.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:12,height:3,fill:"none"},a.Ay.createElement("path",{fill:"currentColor",d:"M1.268 0a1.267 1.267 0 1 1-.002 2.534A1.267 1.267 0 0 1 1.268 0Zm4.435 0a1.268 1.268 0 1 1 0 2.536 1.268 1.268 0 0 1 0-2.536Zm4.437 0a1.268 1.268 0 1 1 0 2.535 1.268 1.268 0 0 1 0-2.535Z"})),Y=(0,a.ph)(({user:e})=>{const t=(0,b.A)(),{openUserPortrait:n}=(0,s.ko)(),[o,r]=(0,a.J0)(),i=(0,v.A)(()=>{n({userId:e?.id})}),l=(0,a.hb)(async e=>{if(!e)return;const t=await(q.zs.userPortrait?.getUserPortrait(e));r(t||void 0)},[]);return(0,a.vJ)(()=>{l(e?.id)},[e?.id,l]),a.Ay.createElement(N.A,{icon:"portrait-large-icon",iconClassName:(0,L.A)(o?.tags?.length?"pb-[40px]":""),multiline:!0,narrow:!0,ripple:!0,onClick:i},a.Ay.createElement("span",{className:"title"},a.Ay.createElement("span",{className:"font-[600]"},(e?.firstName||"")+(e?.lastName||"")),"‘s portrait"),o?.tags&&o?.tags?.length>0&&a.Ay.createElement("div",{className:"flex items-center gap-1 my-1"},o?.tags?.slice(0,1)?.map((e,t)=>a.Ay.createElement("div",{className:"flex items-center justify-center px-2 rounded-[4px] h-[24px] text-[12px] font-[500]",style:`background: ${W.s[t]}`},e)),o?.tags?.length>1&&a.Ay.createElement("div",{className:"flex items-center justify-center px-2 rounded-[4px] h-[24px]",style:`background: ${W.s[1]}`},a.Ay.createElement(Q,null))),a.Ay.createElement("span",{className:"subtitle"},t("User Portrait")))});var Z=n(87894),X=n(58554),ee=n(14737),te=n(82855);const ne=["🎉","🎆","🎈"],ae=(0,a.ph)((0,s.EK)(e=>{const{birthdayNumbers:t,animatedEmojiEffects:n}=e;return{birthdayNumbers:t,animatedEmojiEffects:n,isPremiumPurchaseBlocked:(0,c.n_C)(e)}})(({user:e,birthday:t,isPremiumPurchaseBlocked:n,birthdayNumbers:r,animatedEmojiEffects:l,isInSettings:c})=>{const{openGiftModal:d,requestConfetti:m}=(0,s.ko)(),u=(0,a.li)(),p=(0,a.li)(!1),[h,g,y]=(0,V.A)(),f=(0,b.A)(),{formattedDate:E,isToday:x,age:w}=(0,a.Kr)(()=>{const e=new Date,n=new Date;return t.year&&n.setFullYear(t.year),n.setMonth(t.month-1),n.setDate(t.day),n.setHours(0,0,0,0),{formattedDate:(0,B.A)(n,f.code,!0,"long"),isToday:n.getDate()===e.getDate()&&n.getMonth()===e.getMonth(),age:t.year&&se(n)}},[t,f]),C=(0,a.Kr)(()=>{if(!w||!x)return;const e=r?.stickers?.filter(({emoji:e})=>e?.endsWith("️⃣"));if(!e)return;const t=(0,Z.dU)(e,"emoji");return w.toString().split("").map(e=>t[e+"️⃣"])},[w,r?.stickers,x]),I=(0,a.Kr)(()=>{if(!x)return;const e=ne[Math.floor(Math.random()*ne.length)];return l?.stickers?.find(({emoji:t})=>t===e)},[l?.stickers,x]);(0,a.vJ)(()=>{if(x&&C&&(C.forEach(e=>{const t=(0,i.Mw)(e,"preview");X.hd(t,o.qZ.BlobUrl)}),I)){const e=(0,i.Mw)(I,"preview");X.hd(e,o.qZ.BlobUrl)}},[I,x,C]),(0,ee.A)(y,h?3e3:void 0),(0,a.vJ)(()=>{if(h){p.current=!0;const e=document.getElementById(c?"LeftColumn":"RightColumn");if(!e)return;(0,T.YS)(()=>{const{top:t,left:n,width:a,height:s}=e.getBoundingClientRect();m({top:t,left:n,width:a,height:s,style:"top-down"})})}},[c,h]);const S=`ProfileBirthday${x?"Today":""}Value${w?"Year":""}`,M=x&&!e.isPremium&&!e.isSelf&&!n,k=(0,v.A)(()=>{d({forUserId:e.id})}),R=(0,v.A)(()=>{x&&(M&&p.current?k():g())}),F=!x&&!M;return a.Ay.createElement("div",{className:"wCp6TBYF"},a.Ay.createElement(N.A,{icon:"calendar",secondaryIcon:M?"gift":void 0,secondaryIconClassName:"c4HDQNGJ",multiline:!0,narrow:!0,ref:u,ripple:!F,onClick:R,isStatic:F,onSecondaryIconClick:k},a.Ay.createElement("div",{className:"title",dir:f.isRtl?"rtl":void 0},(0,A.A)(f(S,[E,w],void 0,w))),a.Ay.createElement("span",{className:"subtitle"},f(x?"ProfileBirthdayToday":"ProfileBirthday"))),h&&P.ol&&C?.map((e,t)=>a.Ay.createElement("div",{className:(0,L.A)("lQeU96Fj",t>0&&"e1ezfWJb"),style:`--digit-offset: ${t}`},a.Ay.createElement(te.A,{containerRef:u,sticker:e,size:128,forceAlways:!0}))),h&&I&&a.Ay.createElement("div",{className:"cFEXGUih"},a.Ay.createElement(te.A,{containerRef:u,sticker:I,size:288,shouldLoop:!0,forceAlways:!0})))}));function se(e){const t=new Date;let n=t.getFullYear()-e.getFullYear();const a=t.getMonth()-e.getMonth();return(a<0||0===a&&t.getDate()<e.getDate())&&n--,n}const oe="UZbkeFDB",re={width:64,height:64,zoom:15},ie=(0,a.ph)((0,s.EK)((e,{chatOrUserId:t,isSavedDialog:n})=>{const{countryList:{phoneCodes:a}}=e,s=t?(0,c.hds)(e,t):void 0,o=t?(0,c.mBe)(e,t):void 0,r=t?(0,c.XOs)(e,t):void 0,d=s?.isForum,m=s&&(0,l.If)(s,(0,c.K52)(e),(0,c.P5N)(e,s.id)),{threadId:u}=(0,c.Xf0)(e)||{},p=d&&u?Number(u):void 0,h=s&&(0,c.AWZ)(e,s.id),g=o&&(0,c.vGo)(e,o.id),A=g?.botVerification||h?.botVerification,y=h?.inviteLink,f=g?.bio||h?.about,v=s&&!o&&(!(0,i.WX)(s)&&!(0,i.Sq)(s,"inviteUsers")||(0,i.ub)(s,"inviteUsers")),E=p?(0,c.sZk)(e,t,p):void 0,b=!n&&e.chats.listIds.saved?.includes(t),x=g?.personalChannelId?(0,c.hds)(e,g.personalChannelId):void 0,w=o?.hasMainMiniApp;return{phoneCodeList:a,chat:s,user:o,userFullInfo:g,canInviteUsers:v,botAppPermissions:r,isMuted:m,topicId:p,chatInviteLink:y,description:f,topicLink:E,hasSavedMessages:b,personalChannel:x,hasMainMiniApp:w,isBotCanManageEmojiStatus:g?.isBotCanManageEmojiStatus,botVerification:A}})(({chatOrUserId:e,user:t,chat:n,userFullInfo:l,isInSettings:T,canInviteUsers:P,isMuted:L,phoneCodeList:B,topicId:R,description:F,chatInviteLink:D,topicLink:O,hasSavedMessages:z,personalChannel:j,hasMainMiniApp:U,isBotCanManageEmojiStatus:V,botAppPermissions:J,botVerification:H})=>{const{showNotification:K,updateChatMutedState:$,updateTopicMutedState:G,loadPeerStories:q,openSavedDialog:W,openMapModal:Q,requestCollectibleInfo:Z,requestMainWebView:X,toggleUserEmojiStatusPermission:ee,toggleUserLocationPermission:te}=(0,s.ko)(),{id:ne,usernames:se,phoneNumber:ie,isSelf:le}=t||{},{id:ce,usernames:de}=n||{},me=ne||ce,{businessLocation:ue,businessWorkHours:pe,personalChannelMessageId:he,birthday:ge}=l||{},Ae=(0,b.A)(),ye=(0,f.A)();(0,y.A)(([e])=>{me&&e!==me&&(t||n&&(0,i.WX)(n))&&q({peerId:me})},[me,n,t]);const{width:fe,height:ve,zoom:Ee}=re,be=(0,x.A)(),xe=ue?.geo&&(0,i.rt)(ue.geo,fe,ve,Ee,be),we=(0,E.A)(xe),Ce=(0,a.Kr)(()=>{if(ue?.geo)return we?a.Ay.createElement("img",{src:we,alt:"",className:oe}):a.Ay.createElement(I.A,{className:oe})},[ue,we]),Ne=Boolean(R&&R!==o.l3),Ie=n&&(0,i.WX)(n)||t?.isPremium,Se=(0,a.Kr)(()=>{const e=se?.filter(e=>e.isActive);return e?.length?e:void 0},[se]),Me=(0,a.Kr)(()=>{const e=t?void 0:de?.filter(e=>e.isActive);return e?.length?e:void 0},[de,t]),ke=(0,a.Kr)(()=>{if(n)return Ne?O:(0,i.L7)(n)||D},[n,Ne,O,D]),Te=(0,v.A)(()=>{const{address:e,geo:t}=ue;if(!t)return(0,d.eM)(e),void K({message:Ae("BusinessLocationCopied")});Q({geoPoint:t,zoom:Ee})}),Pe=(0,v.A)(()=>{Ne?G({chatId:ce,topicId:R,isMuted:!L}):$({chatId:ce,isMuted:!L})}),Le=(0,v.A)(()=>{t&&ee({botId:t.id,isEnabled:!V})}),Be=(0,v.A)(()=>{t&&te({botId:t.id,isAccessGranted:!J?.geolocation})}),Re=(0,v.A)(()=>{W({chatId:e})});function Fe(e,t){(0,d.eM)(e),K({message:`${t} was copied`})}const De=ie&&(0,m.Ox)(B,ie),Oe=(0,v.A)(()=>{ie?.length===r.PGI&&ie.startsWith(r._Bb)?Z({collectible:ie,peerId:me,type:"phone"}):Fe(De,Ae("Phone"))}),ze=(0,v.A)((e,t)=>{e.isEditable?Fe((0,g.A)(e.username,t),Ae(t?"Link":"Username")):Z({collectible:e.username,peerId:me,type:"username"})}),je=(0,v.A)(()=>{const e=t?.id;if(!e)return;const n=(0,p.A)();X({botId:e,peerId:e,theme:n,shouldMarkBotTrusted:!0})}),Ue=ye("ProfileOpenAppAbout",{terms:a.Ay.createElement(k.A,{text:ye("ProfileOpenAppTerms"),url:ye("ProfileBotOpenAppInfoLink")})},{withNodes:!0});if(!(ce&&(0,c._ls)((0,s.mS)(),ce)||le&&!T))return a.Ay.createElement("div",{className:"ChatExtra"},j&&a.Ay.createElement("div",{className:"HP5EJx7s"},a.Ay.createElement("h3",{className:"cHyTGri2"},Ae("ProfileChannel")),a.Ay.createElement("span",{className:"kYd2GrmU"},Ae("Subscribers",j.membersCount,"i")),a.Ay.createElement(w.A,{chatId:j.id,orderDiff:0,animationType:h.I.None,isPreview:!0,previewMessageId:he,className:"qOJwhXMC"})),Boolean(De?.length)&&a.Ay.createElement(N.A,{icon:"phone",multiline:!0,narrow:!0,ripple:!0,onClick:Oe},a.Ay.createElement("span",{className:"title",dir:ye.isRtl?"rtl":void 0},De),a.Ay.createElement("span",{className:"subtitle"},Ae("Phone"))),Se&&a.Ay.createElement(a.Ay.Fragment,null,Ve(Se),t&&a.Ay.createElement(Y,{user:t})),F&&Boolean(F.length)&&a.Ay.createElement(N.A,{icon:"info",multiline:!0,narrow:!0,isStatic:!0,allowSelection:!0},a.Ay.createElement("span",{className:"title word-break allow-selection",dir:ye.isRtl?"rtl":void 0},(0,A.A)(F,["br",Ie?"links":"tg_links","emoji"])),a.Ay.createElement("span",{className:"subtitle"},Ae(ne?"UserBio":"Info"))),Me&&!Ne&&Ve(Me,!0),(!Me&&P||Ne)&&ke&&a.Ay.createElement(N.A,{icon:"link",multiline:!0,narrow:!0,ripple:!0,onClick:()=>Fe(ke,Ae("SetUrlPlaceholder"))},a.Ay.createElement("div",{className:"title"},ke),a.Ay.createElement("span",{className:"subtitle"},Ae("SetUrlPlaceholder"))),ge&&a.Ay.createElement(ae,{key:me,birthday:ge,user:t,isInSettings:T}),U&&a.Ay.createElement(N.A,{multiline:!0,isStatic:!0,narrow:!0},a.Ay.createElement(C.A,{className:"x925YeS3",size:"smaller",onClick:je},Ae("ProfileBotOpenApp")),a.Ay.createElement("div",{className:"IrqRJFxm"},Ue)),!T&&a.Ay.createElement(N.A,{icon:"unmute",narrow:!0,ripple:!0,onClick:Pe},a.Ay.createElement("span",null,Ae("Notifications")),a.Ay.createElement(S.A,{id:"group-notifications",label:ne?"Toggle User Notifications":"Toggle Chat Notifications",checked:!L,inactive:!0})),pe&&a.Ay.createElement(_,{businessHours:pe}),ue&&a.Ay.createElement(N.A,{icon:"location",ripple:!0,multiline:!0,narrow:!0,rightElement:Ce,onClick:Te},a.Ay.createElement("div",{className:"title"},ue.address),a.Ay.createElement("span",{className:"subtitle"},Ae("BusinessProfileLocation"))),z&&!T&&a.Ay.createElement(N.A,{icon:"saved-messages",narrow:!0,ripple:!0,onClick:Re},a.Ay.createElement("span",null,Ae("SavedMessagesTab"))),l&&"isBotAccessEmojiGranted"in l&&a.Ay.createElement(N.A,{icon:"user",narrow:!0,ripple:!0,onClick:Le},a.Ay.createElement("span",null,Ae("BotProfilePermissionEmojiStatus")),a.Ay.createElement(S.A,{label:Ae("BotProfilePermissionEmojiStatus"),checked:V,inactive:!0})),void 0!==J?.geolocation&&a.Ay.createElement(N.A,{icon:"location",narrow:!0,ripple:!0,onClick:Be},a.Ay.createElement("span",null,Ae("BotProfilePermissionLocation")),a.Ay.createElement(S.A,{label:Ae("BotProfilePermissionLocation"),checked:J?.geolocation,inactive:!0})),H&&a.Ay.createElement("div",{className:"RWFu5ENh"},a.Ay.createElement(M.A,{className:"b32hsSPS",documentId:H.iconId,size:16}),H.description));function Ve(e,t){const[n,...s]=e,o=s.length?Ae("UsernameAlso","%USERNAMES%").split("%").map(e=>"USERNAMES"===e?a.Ay.createElement(a.Ay.Fragment,null,s.map((e,n)=>a.Ay.createElement(a.Ay.Fragment,null,n>0?", ":"",a.Ay.createElement("a",{key:e.username,href:(0,g.A)(e.username,!0),onMouseDown:u.A,onClick:n=>{(0,u.A)(n),ze(e,t)},className:"text-entity-link username-link"},(0,g.A)(e.username))))):e):void 0;return a.Ay.createElement(N.A,{icon:t?"link":"mention",multiline:!0,narrow:!0,ripple:!0,onClick:()=>{ze(n,t)}},a.Ay.createElement("span",{className:"title",dir:ye.isRtl?"rtl":void 0},(0,g.A)(n.username,t)),a.Ay.createElement("span",{className:"subtitle"},o&&a.Ay.createElement("span",{className:"other-usernames"},o),Ae(t?"Link":"Username")))}}))},17169:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});const a={name:"BDZrSTO_",root:"QOz6fQFU",avatar:"dXSy0i2c",avatarHidden:"n0vJEdNW",ghost:"E1IeDpeb",ghostAnimateName:"HMp3KTKQ",ghostRevealName:"unYkDic1",ghostLast:"dZJGfaXC"}},17751:(e,t,n)=>{"use strict";n.d(t,{A:()=>v});var a=n(84051),s=n(13439),o=n(89925),r=n(90709),i=n(60919),l=n(87357),c=n(4961),d=n(54699),m=n(17712),u=n(59030),p=n(42452),h=n(21849),g=n(80999),A=n(34431),y=n(54746),f=n(80477);const v=(0,a.ph)((0,s.EK)((e,{userId:t,forceShowSelf:n})=>{const{isSynced:a}=e,s=t?(0,i.mBe)(e,t):void 0,o=t?(0,i.K0y)(e,t):void 0,r=!n&&s&&s.isSelf,l=r?s:(0,i.mBe)(e,e.currentUserId);return{user:s,userStatus:o,isSavedMessages:r,areMessagesLoaded:Boolean(t&&(0,i.zeq)(e,t)),self:l,isSynced:a}})(({customPeer:e,typingStatus:t,avatarSize:n="medium",status:i,statusIcon:v,withDots:E,withMediaViewer:b,withUsername:x,withStory:w,withFullInfo:C,withUpdatingStatus:N,emojiStatusSize:I,noStatusOrTyping:S,noEmojiStatus:M,noFake:k,noVerified:T,noRtl:P,user:L,userStatus:B,self:R,isSavedMessages:F,isSavedDialog:D,areMessagesLoaded:O,adminMember:z,ripple:j,className:U,storyViewerOrigin:V,isSynced:J,onEmojiStatusClick:H,iconElement:K,rightElement:$})=>{const{loadFullUser:G,openMediaViewer:_,loadMoreProfilePhotos:q}=(0,s.ko)(),W=(0,u.A)(),{id:Q}=L||{},Y=b&&!F;(0,a.vJ)(()=>{Q&&(C&&J&&G({userId:Q}),b&&q({peerId:Q,isPreload:!0}))},[Q,C,b,J]),(0,d.A)(6e4);const Z=(0,m.A)((e,t)=>{L&&t&&(e.stopPropagation(),_({isAvatarView:!0,chatId:L.id,mediaIndex:0,origin:"jumbo"===n?o.TQ.ProfileAvatar:o.TQ.MiddleHeaderAvatar}))}),X=(0,a.Kr)(()=>L&&x&&(0,r.Kl)(L),[L,x]);if(!L&&!e)return;const ee=z?z.customTitle||W(z.isOwner?"GroupInfo.LabelOwner":"GroupInfo.LabelAdmin"):void 0;return a.Ay.createElement("div",{className:(0,l.A)("ChatInfo",U),dir:!P&&W.isRtl?"rtl":void 0},D&&R&&a.Ay.createElement(h.A,{key:"saved-messages",size:n,peer:R,isSavedMessages:!0,className:"saved-dialog-avatar"}),a.Ay.createElement(h.A,{key:L?.id,size:n,peer:e||L,className:(0,l.A)(D&&"overlay-avatar"),isSavedMessages:F,isSavedDialog:D,withStory:w,storyViewerOrigin:V,storyViewerMode:"single-peer",onClick:Y?Z:void 0}),a.Ay.createElement("div",{className:"info"},ee?a.Ay.createElement("div",{className:"info-name-title"},a.Ay.createElement(A.A,{peer:L,withEmojiStatus:!M,emojiStatusSize:I,isSavedMessages:F,isSavedDialog:D,onEmojiStatusClick:H}),ee&&a.Ay.createElement("span",{className:"custom-title"},ee)):a.Ay.createElement(A.A,{peer:e||L,noFake:k,noVerified:T,withEmojiStatus:!M,emojiStatusSize:I,isSavedMessages:F,isSavedDialog:D,onEmojiStatusClick:H,iconElement:K}),(i||!F&&!S)&&function(){if(i)return E?a.Ay.createElement(g.A,{className:"status",content:i}):a.Ay.createElement("span",{className:"status",dir:"auto"},v&&a.Ay.createElement(y.A,{className:"status-icon",name:v}),(0,c.A)(i));if(N&&!O)return a.Ay.createElement(g.A,{className:"status",content:W("Updating")});if(e?.subtitleKey)return a.Ay.createElement("span",{className:"status",dir:"auto"},a.Ay.createElement("span",{className:"user-status",dir:"auto"},W(e.subtitleKey)));if(!L)return;if(t)return a.Ay.createElement(f.A,{typingStatus:t});if((0,r.DX)(L.id))return;const n=(0,r.CD)(W,L,B),s=(0,l.A)("handle",n&&"withStatus");return a.Ay.createElement("span",{className:(0,l.A)("status",(0,r.PF)(L,B,!0)&&"online")},X&&a.Ay.createElement("span",{className:s},X),n&&a.Ay.createElement("span",{className:"user-status",dir:"auto"},n))}()),j&&a.Ay.createElement(p.A,null),$)}))},17778:(e,t,n)=>{"use strict";n.d(t,{S:()=>i});const a=/(<br>|<br\s?\/>)/g,s=/(&nbsp;|\u00A0)/g,o=/(<div>|<\/div>)/gi,r=/\n$/i;function i(e){return e.replace(s," ").replace(a,"\n").replace(o,"").replace(r,"")}},20247:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var a=n(84051),s=n(13439),o=n(31481),r=n(17712);function i(e,t,n){const{shouldPaidMessageAutoApprove:i}=(0,s.mS)().settings.byKey,[l,c]=(0,a.J0)(Boolean(i)),[d,m]=(0,a.J0)(!1),u=(0,a.li)(void 0),p=(0,r.A)(()=>{(0,s.ko)().closePaymentMessageConfirmDialogOpen()});(0,a.vJ)(()=>{d&&!t&&(m(!1),n>e&&u?.current?.())},[d,t,n,e]);const h=(0,r.A)(()=>{(0,s.ko)().openStarsBalanceModal({topup:{balanceNeeded:e,purpose:o.D3m}}),m(!0)});return{closeConfirmDialog:p,handleWithConfirmation:(t,...a)=>{if(e){if(u.current=()=>t(...a),!i)return void(0,s.ko)().openPaymentMessageConfirmDialogOpen();if(e>n)return void h()}t(...a)},dialogHandler:(0,r.A)(()=>{e>n?h():u?.current?.(),(0,s.ko)().closePaymentMessageConfirmDialogOpen(),l&&(0,s.ko)().setPaidMessageAutoApprove()}),shouldAutoApprove:l,setAutoApprove:c}}},21488:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(84051),s=n(13439),o=n(37836);const r=function(e,t,n){const{loadPeerStoriesByIds:r}=(0,s.ko)(),i=(0,a.Kr)(()=>{const n=(0,o.nF)(r,200,!0);return()=>{n({peerId:e,storyIds:[t]})}},[t,e]);(0,a.vJ)(()=>{e&&t&&(!n||!("content"in n)&&!("isDeleted"in n))&&i()},[i,n,t,e])}},23459:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var a=n(84051),s=n(13439),o=n(90709),r=n(60919),i=n(9716),l=n(37836);const c=36e5,d=new Map;let m=new Set;const u=(0,l.nF)(()=>{const e=Array.from(m),t=e.slice(0,100),n=e.slice(101);(0,s.ko)().loadStoriesMaxIds({peerIds:t}),t.forEach(e=>d.set(e,Date.now())),m=new Set(n),m.size&&u()},500);function p(e){const t=(0,a.Kr)(()=>{const t=(0,s.mS)();return e?.map(e=>(0,r.PVB)(t,e)).filter(Boolean)},[e]),n=(0,a.Kr)(()=>{const e=(0,s.mS)();return t?.filter(t=>{const n=d.get(t.id)||0;if(Date.now()-n<c)return!1;if((0,i.L8)(t.id)){const n=t,a=(0,r.K0y)(e,n.id),s=a&&"userStatusEmpty"!==a.type;return!n.isContact&&!n.isSelf&&!(0,o.tv)(n)&&!t.isSupport&&s}{const n=t,a=(0,r._ls)(e,n.id);return(0,o.WX)(n)&&!a}}).map(e=>e.id)},[t]);(0,a.vJ)(()=>{n?.length&&(n.forEach(e=>m.add(e)),u())},[n])}},23565:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var a=n(84051),s=n(30857),o=n(73767),r=n(35297);function i(e,t){const n=(0,o.A)(e,!0),i=(0,a.li)(),l=(0,s.A)(),c=null!=e,d=null!=n;return c&&i.current&&(clearTimeout(i.current),i.current=void 0),(0,r.A)(()=>{t&&!c&&d&&!i.current&&(i.current=window.setTimeout(()=>{i.current=void 0,l()},t))},[t,l,c,d]),i.current&&t&&!c?n:e}},23814:(e,t,n)=>{"use strict";e.exports=n.p+"message.772cf7cc443d60210a5e.png"},24807:(e,t,n)=>{"use strict";n.d(t,{A:()=>f});var a=n(84051),s=n(13439),o=n(87357),r=n(80140),i=n(22237),l=n(14242),c=n(59852),d=n(19129),m=n(39351),u=n(17712),p=n(59030),h=n(68292),g=n(54746),A=n(64493),y=n(26607);const f=(0,a.ph)(({topic:e,topics:t,chat:n,isPinned:f,isMuted:v,shouldShowOnlyMostImportant:E,wasTopicOpened:b,forceHidden:x,isSavedDialog:w,hasMiniApp:C,isSelected:N})=>{const{requestMainWebView:I}=(0,s.ko)(),S=(0,p.A)(),M=(0,m.A)(),{unreadMentionsCount:k=0,unreadReactionsCount:T=0}=n.isForum?{}:n,P=!f&&e&&!b,L=n.isForum&&!e,B=(0,a.Kr)(()=>L&&t?Object.values(t).filter(({unreadCount:e})=>e):void 0,[t,L]),R=(0,a.Kr)(()=>L?B?.length:(e||n).unreadCount,[n,e,B,L]),F=(0,a.Kr)(()=>{if(!L)return!v||0===e?.notifySettings.mutedUntil;if(v)return B?.some(e=>0===e.notifySettings.mutedUntil);const t=B?.every(e=>e.notifySettings.mutedUntil&&e.notifySettings.mutedUntil>(0,r.Fm)());return!t},[L,v,B,e?.notifySettings.mutedUntil]),D=!e&&n.hasUnreadMark,O=!(0,d.A)(()=>(0,i.Hp)(x)?x():x,[x])&&Boolean(R||k||D||f||T||P||C),z=Boolean((R||D)&&!w),j=(0,o.A)("ChatBadge",!F&&"muted",!z&&f&&"pinned",z&&"unread"),U=(0,u.A)(e=>{e.stopPropagation();const t=(0,c.A)();I({botId:n.id,peerId:n.id,theme:t})});return a.Ay.createElement(y.A,{isCustom:!0,className:"ChatBadge-transition",isOpen:O},function(){const e=T&&a.Ay.createElement("div",{className:(0,o.A)("ChatBadge reaction",!F&&"muted")},a.Ay.createElement(g.A,{name:"heart"})),t=k&&a.Ay.createElement("div",{className:"ChatBadge mention"},a.Ay.createElement(g.A,{name:"mention"})),n=P&&a.Ay.createElement("div",{className:(0,o.A)("ChatBadge unopened",!F&&"muted")}),s=D||R?a.Ay.createElement("div",{className:j},!D&&a.Ay.createElement(h.A,{text:(0,l.Vw)(M,R)})):void 0,r=f&&a.Ay.createElement("div",{className:j},a.Ay.createElement(g.A,{name:"pinned-chat"})),i=C&&a.Ay.createElement(A.A,{color:N?"secondary":"primary",className:"ChatBadge miniapp",pill:!0,size:"tiny",onClick:U},S("BotOpen")),c=!s&&!t&&!e&&r,d=[n,e,t,s,c].filter(Boolean);return w?r:C&&(0===d.length||c)?i:0!==d.length?1===d.length?d[0]:E?[t,s,e,r].filter(Boolean)[0]:a.Ay.createElement("div",{className:"ChatBadge-wrapper"},d):void 0}())})},24845:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});const a={fallbackPhoto:"Wm9Ygb23",fallbackPhotoContents:"nflKKT3R",fallbackPhotoVisible:"tFkRrvxe",fallbackPhotoAvatar:"R7w3H5eC",photoWrapper:"GBGLnrA7",photoDashes:"uyvKpR3B",photoDash:"wB4yjvei",photoDash_current:"aZmp9FLh",photoDashCurrent:"aZmp9FLh",navigation:"ZZRcBh8v",navigation_prev:"RQITz4WQ",navigationPrev:"RQITz4WQ",navigation_next:"_0F1Txru",navigationNext:"_0F1Txru",info:"UcyW7tVh",status:"cpyXyZDl","user-status":"_HDVUj4P",userStatus:"_HDVUj4P","get-status":"Qga38M20",getStatus:"Qga38M20",topicContainer:"yzg267rr",topicTitle:"umOuiu3K",topicIcon:"ZCxp0_t4",topicIconTitle:"lkfZNWOm",topicMessagesCounter:"tLTzQ2ks"}},24899:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var a=n(31481);function s(e,t){return t?`${a.jsp}${e}`:`@${e}`}},24920:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(84051),s=n(30857),o=n(73767);function r(e){const t=(0,s.A)(),n=(0,a.li)(e),r=(0,o.A)(e);return!1===e&&r!==e&&(n.current=!1),{shouldDisableDropdownMenuTransitionRef:n,handleDropdownMenuTransitionEnd:function(){n.current=Boolean(e),t()}}}},25352:()=>{},25477:(e,t,n)=>{"use strict";n.d(t,{A:()=>S});var a=n(84051),s=n(13439),o=n(90709),r=n(87357),i=n(17663),l=n(58554),c=n(76023),d=n(35127),m=n(84313),u=n(43874),p=n(37661),h=n(5912),g=n(17712),A=n(62587),y=n(37960),f=n(69419),v=n(73767),E=n(34201),b=n(61097),x=n(54746),w=n(27860),C=n(14413),N=n(65843),I=n(35913);const S=(0,a.ph)((0,s.EK)(e=>{const t=e.appConfig,n=t?.needAgeVideoVerification;return{needsAgeVerification:n}})(({id:e,video:t,isOwn:n,isInWebPage:S,noAvatars:M,canAutoLoad:k,canAutoPlay:T,uploadProgress:P,forcedWidth:L,dimensions:B,asForwarded:R,isDownloading:F,isProtected:D,className:O,lastPlaybackTimestamp:z,clickArg:j,isMediaNsfw:U,observeIntersectionForLoading:V,observeIntersectionForPlaying:J,onClick:H,onCancelUpload:K,needsAgeVerification:$})=>{const{cancelMediaDownload:G,updateContentSettings:_,openAgeVerificationModal:q}=(0,s.ko)(),W=(0,a.li)(),Q=(0,a.li)(),[Y,Z,X]=(0,p.A)(),[ee,te]=(0,a.J0)(!1),ne="extendedMediaPreview"===t.mediaType,ae=ne?void 0:t.blobUrl,se=ne||t.isSpoiler||U,[oe,re,ie]=(0,p.A)(se);(0,a.vJ)(()=>{se?re():ie()},[se]);const le=(0,g.A)(()=>{X(),ie(),ee&&_({isSensitiveEnabled:!0})}),ce=(0,h.Vz)(W,V),de=(0,h.Vz)(W,J)&&ce,me=(0,a.li)(ce);de&&!me.current&&(me.current=!0);const{isMobile:ue}=(0,u.Ay)(),[pe,he]=(0,a.J0)(k),ge=Boolean(pe&&ce&&!ne),[Ae,ye]=(0,a.J0)(Boolean(T&&!oe)),fe=ne?void 0:(0,o.sC)(t,"inline"),[ve]=(0,a.J0)(Boolean(fe&&l.Ih(fe))),{mediaData:Ee,loadProgress:be}=(0,f.A)(fe,!ge,ne?void 0:(0,o.Cz)(t,"inline")),xe=ae||Ee,[we,Ce]=(0,p.A)(),Ne=(0,o.VD)(t),Ie=Boolean(Ne),Se=Boolean(L),Me=xe&&me.current,ke=(0,m.A)(Q,!0,!Me),Te=ne?void 0:(0,o.sC)(t,"preview"),[Pe]=(0,a.J0)(Boolean(Te&&l.Ih(Te))),Le=ce,Be=(0,A.A)(Te,!Le),Re=we&&!ke,{ref:Fe}=(0,y.A)({hasMediaData:Boolean((Ie||Be)&&!Re)}),De=Boolean(!Ie||Be||we),Oe=(0,b.A)(t,De);(0,y.A)({ref:Oe,hasMediaData:!De});const ze=(0,b.A)(t,!Se),{loadProgress:je}=(0,f.A)(ne?void 0:(0,o.sC)(t,"download"),!F,ne?void 0:(0,o.Cz)(t,"download")),{isUploading:Ue,isTransferring:Ve,transferProgress:Je}=(0,o.LK)(P||(F?je:be),ge&&!we&&!ve||F,void 0!==P),He=!1===(0,v.A)(pe),{ref:Ke,shouldRender:$e}=(0,E.A)({isOpen:Ve&&!ke,noMountTransition:He,withShouldRender:!0}),{ref:Ge}=(0,E.A)({isOpen:Boolean((pe||xe)&&!Ae&&!$e)}),[_e,qe]=(0,a.J0)(0),We=(0,g.A)(e=>{qe(Math.max(0,e.currentTarget.currentTime-1))}),Qe=(Number.isFinite(Q.current?.duration)&&!ke?Q.current?.duration:t.duration)||0,{width:Ye,height:Ze}=B||(ne?(0,c.ri)(t,Boolean(n),R,S,M,ue):(0,c.rO)(t,Boolean(n),R,S,M,ue)),Xe=(0,g.A)((e,n)=>{if(Ue)K?.(j);else if(ne||!F){if(xe)return xe&&!Ae&&ye(!0),oe?U?$?void q():void Z():void ie():n&&ge&&!we&&!ve?(he(!1),void e.stopPropagation()):void H?.(j,e);he(e=>!e)}else G({media:t})}),et=(0,g.A)(e=>{Xe(e,!0)}),tt=(0,r.A)("media-inner dark",!Ue&&"interactive",Ze<d.ej&&"fix-min-height",O),nt=`height: ${Ze}px;${B?` width: ${Ye}px; left: ${B.x}px; top: ${B.y}px;`:""}`;return a.Ay.createElement("div",{ref:W,id:e,className:tt,style:nt,onClick:Ue?void 0:e=>Xe(e)},Se&&a.Ay.createElement("canvas",{ref:ze,className:"thumbnail blurred-bg"}),Me&&a.Ay.createElement(N.A,{ref:Q,src:xe,className:(0,r.A)("full-media",Se&&"with-blurred-bg"),canPlay:Ae&&de&&!ke,defaultMuted:!0,muted:!0,loop:!0,playsInline:!0,disablePictureInPicture:!0,draggable:!D,onTimeUpdate:We,onReady:Ce,style:L?`width: ${L}px`:void 0}),a.Ay.createElement("img",{ref:Fe,src:Be,className:(0,r.A)("thumbnail",Se&&"with-blurred-bg"),alt:"",style:L?`width: ${L}px;`:void 0,draggable:!D}),Ie&&!Pe&&a.Ay.createElement("canvas",{ref:Oe,className:"thumbnail"}),D&&a.Ay.createElement("span",{className:"protector"}),a.Ay.createElement(x.A,{ref:Ge,name:"large-play"}),a.Ay.createElement(w.A,{isVisible:oe,withAnimation:!0,thumbDataUri:Ne,isNsfw:U,width:Ye,height:Ze,className:"media-spoiler"}),$e&&a.Ay.createElement("div",{ref:Ke,className:"media-loading"},a.Ay.createElement(I.A,{progress:Je,onClick:et})),!pe&&!xe&&a.Ay.createElement(x.A,{name:"download"}),!Ve||ke&&!F?a.Ay.createElement("div",{className:"message-media-duration"},!ne&&t.isGif?"GIF":(0,i.QO)(Math.max(Qe-_e,0)),ke&&a.Ay.createElement(x.A,{name:"message-failed",className:"playback-failed"})):a.Ay.createElement("span",{className:"message-transfer-progress"},Ue||F?`${Math.round(100*Je)}%`:"..."),Boolean(z)&&a.Ay.createElement("div",{className:"message-media-last-progress",style:`--_progress: ${Math.floor(z/Qe*100)}%`}),a.Ay.createElement(C.A,{isOpen:Y,onClose:X,shouldAlwaysShow:ee,onAlwaysShowChanged:te,confirmHandler:le}))}))},25498:(e,t,n)=>{"use strict";n.d(t,{A:()=>P});var a=n(84051),s=n(13439),o=n(31481),r=n(66644),i=n(60919),l=n(52491),c=n(36353),d=n(87894),m=n(79824),u=n(37830),p=n(4961),h=n(58734),g=n(17778),A=n(63988),y=n(83414),f=n(37661),v=n(17712);let E,b,x,w,C;const N=36,I=2,S=300,M=(0,u.A)(function(e,t,n){return e&&t.length?Object.values((0,d._E)(e,t)).slice(0,n):m.p}),k=(0,u.A)(function(e,t,n){const a=Object.values(e),s=(0,d.dU)(a,"native"),o=t?(0,d.LG)(t,e=>Object.values((0,d._E)(s,e))):{},r=n?(0,d.LG)(n,e=>Object.values((0,d._E)(s,e))):{},i={...o,...r},l=[].concat(Object.keys(o),Object.keys(r)),c=a.reduce((e,t)=>(t.names.forEach(n=>{e[n]||(e[n]=[]),e[n].push(t)}),e),{}),m=Object.keys(c),u=l.reduce((e,t)=>Math.max(e,t.length),0);return{byKeyword:i,keywords:l,byName:c,names:m,maxKeyLength:u}}),T=(0,u.A)(function(e,t,n){const{byKeyword:a,keywords:s,byName:o,names:r,maxKeyLength:i}=e;let l=[];if(t.length>i)return m.p;const c=s.filter(e=>e.startsWith(t)).sort();l=l.concat(Object.values((0,d._E)(a,c)).flat());const u=r.filter(e=>e.startsWith(t));return l=l.concat(Object.values((0,d._E)(o,u)).flat()),l=(0,d.Am)(l),l.length?l.slice(0,n):m.p});try{w=/(^|\s):(?!\s)[-+_:'\s\p{L}\p{N}]*$/giu,C=/\p{Ll}/u}catch(e){w=/(^|\s):(?!\s)[-+_:'\s\d\wа-яёґєії]*$/gi,C=/[a-zяёґєії]/}function P(e,t,u,P=o.CfG,L,B,R){const[F,D,O]=(0,f.A)(!1),[z,j]=(0,a.J0)(),[U,V]=(0,a.J0)(m.p),[J,H]=(0,a.J0)(m.p);(0,a.vJ)(()=>{function t(){j(x.emojis)}e&&(x?t():async function(){return E||(E=n.e(996).then(n.t.bind(n,20996,19)),b=(await E).default,x=(0,l.cp)(b)),E}().then(t))},[e]);const K=(0,A.gs)(()=>{const n=t();return e&&n.includes(":")?(0,g.S)(n).match(w)?.[0].trim():void 0},[t,e],S),$=(0,y.A)(K,[K,t],!0),G=(0,v.A)(e=>{if(V(e),e===m.p)return void H(m.p);const t=e.map(e=>e.native),n=(0,d.Xd)((0,i.oZ0)((0,s.mS)(),t),"id");H(n)}),_=(0,v.A)((e,n=!1)=>{const a=t();if(!a)return;const s=a.lastIndexOf(":",n?a.lastIndexOf(":")-1:void 0);if(-1!==s){const t="string"==typeof e?(0,p.A)(e,["emoji_html"])[0]:(0,h.hB)(e);u(`${a.substring(0,s)}${t}`);const n=P===o.CfG?document.querySelector(o.m$5):document.getElementById(P);(0,r.Uz)(()=>{(0,c.A)(n,!0,!0)})}G(m.p)});return(0,a.vJ)(()=>{const e=$();if(!e||!z)return void G(m.p);const t=e.length>2&&e.endsWith(":"),n=e.substring(1,t?1+e.length-2:void 0);let a=m.p;if(n){if(1===n.length&&C.test(n)||n.length>=I){const e=k(z,B,R);a=T(e,n.toLowerCase(),N)}}else a=M(z,L,N);a.length?t?_(a[0].native,!0):G(a):G(m.p)},[B,z,$,R,_,L,G]),(0,a.vJ)(O,[O,t]),{isEmojiTooltipOpen:Boolean(U.length||J.length)&&!F,closeEmojiTooltip:D,filteredEmojis:U,filteredCustomEmojis:J,insertEmoji:_}}},25897:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(84051),s=n(80089),o=n(80464);const r=e=>{const{isOpen:t}=e,n=(0,o.A)(s.ar.Extra,"CustomEmojiTooltip",!t);return n?a.Ay.createElement(n,e):void 0}},26440:(e,t,n)=>{"use strict";n.d(t,{A:()=>A});var a=n(84051),s=n(13439),o=n(31481),r=n(87357),i=n(37661),l=n(17712),c=n(54746),d=n(64493),m=n(66469),u=n(57474),p=n(80089),h=n(80464);const g=e=>{const{isOpen:t}=e,n=(0,h.A)(p.ar.Extra,"SymbolMenu",!t);return n?a.Ay.createElement(n,e):void 0},A=(0,a.ph)(({chatId:e,threadId:t,isMobile:n,canSendGifs:p,canSendStickers:h,isMessageComposer:A,isReady:y,isSymbolMenuOpen:f,idPrefix:v,isAttachmentModal:E,canSendPlainText:b,isSymbolMenuForced:x,className:w,forceDarkTheme:C,inputCssSelector:N=o.m$5,openSymbolMenu:I,closeSymbolMenu:S,onCustomEmojiSelect:M,onStickerSelect:k,onGifSelect:T,onRemoveSymbol:P,onEmojiSelect:L,closeBotCommandMenu:B,closeSendAsMenu:R})=>{const{setStickerSearchQuery:F,setGifSearchQuery:D,addRecentEmoji:O,addRecentCustomEmoji:z}=(0,s.ko)(),j=(0,a.li)(),[U,V]=(0,i.A)(),[J,H]=(0,a.J0)(void 0),K=(0,r.A)("composer-action-button mobile-symbol-menu-button",!y&&"not-ready",U?f&&"menu-opened":f&&"is-loading"),$=(0,l.A)(()=>{B?.(),R?.(),I();const e=j.current;if(!e)return;const{x:t,y:n}=e.getBoundingClientRect();H({x:t,y:n})}),G=(0,l.A)(e=>{"stickers"===e?(F({query:""}),D({query:void 0})):(D({query:""}),F({query:void 0}))}),_=(0,l.A)(()=>{const e=document.querySelector(E?o.wVm:N);n&&e===document.activeElement?(e?.blur(),setTimeout(()=>{B?.(),I()},100)):I()}),q=(0,l.A)(()=>j.current),W=(0,l.A)(()=>j.current?.closest(".custom-scroll, .no-scrollbar")),Q=(0,l.A)(()=>document.querySelector("#portals .SymbolMenu .bubble")),Y=(0,l.A)(()=>({withPortal:!0}));return a.Ay.createElement(a.Ay.Fragment,null,n?a.Ay.createElement(d.A,{className:K,round:!0,color:"translucent",onClick:f?S:_,ariaLabel:"Choose emoji, sticker or GIF"},a.Ay.createElement(c.A,{name:"smile"}),a.Ay.createElement(c.A,{name:"keyboard"}),f&&!U&&a.Ay.createElement(u.A,{color:"gray"})):a.Ay.createElement(m.A,{className:(0,r.A)("composer-action-button symbol-menu-button",f&&"activated"),round:!0,color:"translucent",onActivate:$,ariaLabel:"Choose emoji, sticker or GIF"},a.Ay.createElement("div",{ref:j,className:"symbol-menu-trigger"}),a.Ay.createElement(c.A,{name:"smile"})),a.Ay.createElement(g,{chatId:e,threadId:t,isOpen:f||Boolean(x),canSendGifs:p,canSendStickers:h,isMessageComposer:A,idPrefix:v,onLoad:V,onClose:S,onEmojiSelect:L,onStickerSelect:k,onCustomEmojiSelect:M,onGifSelect:T,onRemoveSymbol:P,onSearchOpen:G,addRecentEmoji:O,addRecentCustomEmoji:z,isAttachmentModal:E,canSendPlainText:b,className:(0,r.A)(w,C&&"component-theme-dark"),anchor:E?J:void 0,getTriggerElement:E?q:void 0,getRootElement:E?W:void 0,getMenuElement:E?Q:void 0,getLayout:E?Y:void 0}))})},26959:()=>{},31791:(e,t,n)=>{"use strict";n.d(t,{v:()=>a});let a=function(e){return e.FULLSCREEN_CHANGE="fullscreen-change",e.UPDATE_ERROR="update-error",e.UPDATE_AVAILABLE="update-available",e.DEEPLINK="deeplink",e}({})},31880:(e,t,n)=>{"use strict";n.d(t,{A:()=>p,a:()=>c});var a=n(13439),s=n(60919),o=n(87894),r=n(42215);const i=["includedChatIds","bots","channels","groups","contacts","nonContacts"],l=["excludedChatIds","excludeArchived","excludeMuted","excludeRead"];function c(e,t,n){let r=[],c=[];if("included"===t){const{includedChatIds:t,...a}=n?e.includeFilters||{}:(0,o.Up)(e.folder,i);r=t||[],c=Object.keys(a).filter(e=>Boolean(a[e]))}else{const{excludedChatIds:t,...a}=n?e.excludeFilters||{}:(0,o.Up)(e.folder,l);r=t||[],c=Object.keys(a).filter(e=>Boolean(a[e]))}const d=(0,a.mS)();return{selectedChatIds:r.filter(e=>(0,s.hds)(d,e)),selectedChatTypes:c}}function d(e){if(e){const{includedChatIds:t,...n}=e;if(Object.values(n).filter(Boolean).length>1||t?.length)return"";if(n.bots)return"Bots";if(n.groups)return"Groups";if(n.channels)return"Channels";if(n.contacts)return"Contacts";if(n.nonContacts)return"Non-Contacts"}return""}const m={mode:"create",chatFilter:"",folder:{title:{text:""},includedChatIds:[],excludedChatIds:[]}},u=(e,t)=>{switch(t.type){case"setTitle":return{...e,folder:{...e.folder,title:{text:t.payload}},isTouched:!0};case"setFolderId":return{...e,folderId:t.payload,mode:"edit"};case"editIncludeFilters":return{...e,includeFilters:(0,o.Up)(e.folder,i)};case"editExcludeFilters":return{...e,excludeFilters:(0,o.Up)(e.folder,l)};case"setIncludeFilters":return{...e,includeFilters:t.payload,chatFilter:""};case"setExcludeFilters":return{...e,excludeFilters:t.payload,chatFilter:""};case"saveFilters":return e.includeFilters?{...e,folder:{...(0,o.cJ)(e.folder,i),title:e.folder.title?e.folder.title:{text:d(e.includeFilters)},...e.includeFilters},includeFilters:void 0,chatFilter:"",isTouched:!0}:e.excludeFilters?{...e,folder:{...(0,o.cJ)(e.folder,l),...e.excludeFilters},excludeFilters:void 0,chatFilter:"",isTouched:!0}:e;case"editFolder":{const{id:e,...n}=t.payload;return{mode:"edit",folderId:e,folder:n,chatFilter:""}}case"setChatFilter":return{...e,chatFilter:t.payload};case"setIsTouched":return{...e,isTouched:t.payload};case"setIsLoading":return{...e,isLoading:t.payload};case"setError":return{...e,isLoading:!1,error:t.payload};case"setIsChatlist":return{...e,folder:{...e.folder,isChatList:t.payload}};case"reset":return m;default:return e}},p=()=>(0,r.A)(u,m)},32754:(e,t,n)=>{"use strict";n.d(t,{A:()=>F});var a=n(84051),s=n(13439),o=n(23174),r=n(89925),i=n(90709),l=n(27109),c=n(60919),d=n(96454),m=n(87357),u=n(9716),p=n(66414),h=n(98255),g=n(43874),A=n(47067),y=n(49746),f=n(37661),v=n(5912),E=n(17712),b=n(50680),x=n(53188),w=n(21849),C=n(54314),N=n(34431),I=n(54746),S=n(9267),M=n(81642),k=n(22720),T=n(97967),P=n(97046),L=n(24807);const B="AA5s1Pu4",R=(0,a.ph)(({isSelected:e,isActive:t,isMobile:n})=>a.Ay.createElement("div",{className:(0,m.A)("byPckqUT",t&&"IsUWP16T",e&&!n&&"qy2i51dM")},a.Ay.createElement("div",{className:"nl36F75B"},a.Ay.createElement("div",{className:B}),a.Ay.createElement("div",{className:B}),a.Ay.createElement("div",{className:B})))),F=(0,a.ph)((0,s.EK)((e,{chatId:t,isSavedDialog:n,isPreview:a,previewMessageId:s})=>{const r=(0,c.hds)(e,t),i=(0,c.mBe)(e,t);if(!r)return{currentUserId:e.currentUserId};const d=s||(0,c.ZZX)(e,t,n?"saved":"all"),m=s?(0,c.O5q)(e,t,s):(0,c.yHC)(e,t,n?"saved":"all"),{isOutgoing:u,forwardInfo:p}=m||{},h=n&&p?.fromId?(0,c.PVB)(e,p.fromId):void 0,g=m?(0,c.Y7C)(e,m):void 0,A=h||g,{chatId:y,threadId:f,type:v}=(0,c.Xf0)(e)||{},E=!a&&t===y&&(n?t===f:f===o.l3),b=r.isForum&&t===y||t===(0,c.nTw)(e).forumPanelChatId,x=(0,c.K0y)(e,t),w=m&&(0,c.nkm)(e,m),C=(0,c.C5H)(e,t,o.l3,"typingStatus"),N=(0,c.xyP)(e,t),I=m?.content.storyData,S=I&&(0,c.Msb)(e,I.peerId,I.id),M=(0,c.trm)(e),k=(0,c.k2W)(e,t);return{chat:r,isMuted:(0,l.If)(r,(0,c.K52)(e),(0,c.P5N)(e,r.id)),lastMessageSender:A,draft:(0,c.GA4)(e,t,o.l3),isSelected:E,isSelectedForum:b,isForumPanelOpen:(0,c.clw)(e),canScrollDown:E&&"thread"===v,canChangeFolder:(e.chatFolders.orderedIds?.length||0)>1,...u&&m&&{lastMessageOutgoingStatus:(0,c.Tl2)(e,m)},user:i,userStatus:x,lastMessageTopic:w,typingStatus:C,withInterfaceAnimations:(0,c.PKK)(e),lastMessage:m,lastMessageId:d,currentUserId:e.currentUserId,listedTopicIds:N?.listedTopicIds,topics:N?.topicsById,isSynced:e.isSynced,lastMessageStory:S,isAccountFrozen:M,monoforumChannel:k}})(({chatId:e,folderId:t,orderDiff:n,animationType:l,isPinned:B,listedTopicIds:F,topics:D,observeIntersection:O,chat:z,monoforumChannel:j,lastMessageStory:U,isMuted:V,user:J,userStatus:H,lastMessageSender:K,lastMessageOutgoingStatus:$,offsetTop:G,draft:_,withInterfaceAnimations:q,isSelected:W,isSelectedForum:Q,isForumPanelOpen:Y,canScrollDown:Z,canChangeFolder:X,lastMessageTopic:ee,typingStatus:te,lastMessageId:ne,lastMessage:ae,isSavedDialog:se,currentUserId:oe,isPreview:re,previewMessageId:ie,className:le,isSynced:ce,onDragEnter:de,isAccountFrozen:me})=>{const{openChat:ue,openSavedDialog:pe,toggleChatInfo:he,focusLastMessage:ge,focusMessage:Ae,loadTopics:ye,openForumPanel:fe,closeForumPanel:ve,setShouldCloseRightColumn:Ee,reportMessages:be,openFrozenAccountModal:xe}=(0,s.ko)(),{isMobile:we}=(0,g.Ay)(),[Ce,Ne,Ie]=(0,f.A)(),[Se,Me,ke]=(0,f.A)(),[Te,Pe,Le]=(0,f.A)(),[Be,Re,Fe]=(0,f.A)(),[De,Oe,ze]=(0,f.A)(),[je,Ue,Ve]=(0,f.A)(),{isForum:Je,isForumAsMessages:He,isMonoforum:Ke}=z||{};(0,y.A)(se?oe:e,ne,ae);const{renderSubtitle:$e,ref:Ge}=(0,x.A)({chat:z,chatId:e,lastMessage:ae,typingStatus:te,draft:_,statefulMediaContent:(0,i.FE)({story:U}),lastMessageTopic:ee,lastMessageSender:K,observeIntersection:O,animationType:l,withInterfaceAnimations:q,orderDiff:n,isSavedDialog:se,isPreview:re,topics:D}),_e=(0,h.A)(c.sRo),qe=(0,E.A)(()=>{const t=we&&He;if(we&&Ee({value:!0}),re)Ae({chatId:e,messageId:ie});else{if(se)return pe({chatId:e,noForumTopicPanel:!0},{forceOnHeavyAnimation:!0}),void(we&&he({force:!1}));if(Je){if(Y)return void ve(void 0,{forceOnHeavyAnimation:!0});if(t||fe({chatId:e},{forceOnHeavyAnimation:!0}),!He)return}ue({id:e,noForumTopicPanel:t,shouldReplaceHistory:!0},{forceOnHeavyAnimation:!0}),W&&Z&&ge()}}),We=(0,E.A)(t=>{t.preventDefault(),de?.(e)}),Qe=(0,E.A)(()=>{me?xe():(Re(),Ne())}),Ye=(0,E.A)(()=>{me?xe():(Oe(),Me())}),Ze=(0,E.A)(()=>{Ue(),Pe()}),Xe=(0,E.A)(()=>{me?xe():z&&be({chatId:z.id,messageIds:[]})}),et=(0,A.A)({chat:z,user:J,handleDelete:Qe,handleMute:Ye,handleChatFolderChange:Ze,handleReport:Xe,folderId:t,isPinned:B,isMuted:V,canChangeFolder:X,isSavedDialog:se,currentUserId:oe,isPreview:re,topics:D}),tt=(0,v.Vz)(Ge,z?O:void 0);(0,a.vJ)(()=>{tt&&Je&&ce&&void 0===F&&ye({chatId:e})},[e,F,ce,Je,tt]);const nt=J&&H&&(0,i.PF)(J,H),{hasShownClass:at}=(0,b.A)(nt),st=(0,a.Kr)(()=>{if(d.OS)return se?`#${(0,p.az)(oe,"thread",e)}`:`#${(0,p.az)(e,"thread",o.l3)}`},[e,oe,se]);if(!z)return;const ot=J||z,rt=(0,m.A)("Chat chat-item-clickable",(0,u.L8)(e)?"private":"group",Je&&"forum",W&&"selected",Q&&"selected-forum",re&&"standalone",le);return a.Ay.createElement(k.A,{ref:Ge,className:rt,href:st,style:`top: ${G}px`,ripple:!Je&&!we,contextActions:et,onClick:qe,onDragEnter:We,withPortalForMenu:!0},a.Ay.createElement("div",{className:(0,m.A)("status","status-clickable")},a.Ay.createElement(w.A,{peer:Ke?j:ot,isSavedMessages:J?.isSelf,isSavedDialog:se,size:re?"medium":"large",asMessageBubble:Ke,withStory:!J?.isSelf&&!Ke,withStoryGap:at||Boolean(z.subscriptionUntil),storyViewerOrigin:r.G9.ChatList,storyViewerMode:"single-peer"}),a.Ay.createElement("div",{className:"avatar-badge-wrapper"},a.Ay.createElement("div",{className:(0,m.A)("avatar-online","avatar-badge",at&&"avatar-online-shown")}),!at&&Boolean(z.subscriptionUntil)&&a.Ay.createElement(S.A,{type:"gold",className:"avatar-badge avatar-subscription",size:"adaptive"}),a.Ay.createElement(L.A,{chat:z,isMuted:V,shouldShowOnlyMostImportant:!0,forceHidden:_e,topics:D,isSelected:W})),z.isCallActive&&z.isCallNotEmpty&&a.Ay.createElement(R,{isMobile:we,isSelected:W,isActive:q})),a.Ay.createElement("div",{className:"info"},a.Ay.createElement("div",{className:"info-row"},a.Ay.createElement(N.A,{peer:Ke?j:ot,isMonoforum:Ke,monoforumBadgeClassName:"monoforum-badge",withEmojiStatus:!0,isSavedMessages:e===J?.id&&J?.isSelf,isSavedDialog:se,observeIntersection:O}),V&&!se&&a.Ay.createElement(I.A,{name:"muted"}),a.Ay.createElement("div",{className:"separator"}),ae&&a.Ay.createElement(M.A,{message:ae,outgoingStatus:se?void 0:$,draftDate:_?.date})),a.Ay.createElement("div",{className:"subtitle"},$e(),!re&&a.Ay.createElement(L.A,{chat:z,isPinned:B,isMuted:V,isSavedDialog:se,hasMiniApp:J?.hasMainMiniApp,topics:D,isSelected:W}))),Be&&a.Ay.createElement(C.A,{isOpen:Ce,onClose:Ie,onCloseAnimationEnd:Fe,chat:z,isSavedDialog:se}),De&&a.Ay.createElement(P.A,{isOpen:Se,onClose:ke,onCloseAnimationEnd:ze,chatId:e}),je&&a.Ay.createElement(T.A,{isOpen:Te,onClose:Le,onCloseAnimationEnd:Ve,chatId:e}))}))},34458:(e,t,n)=>{"use strict";n.d(t,{$:()=>y,UG:()=>d,wV:()=>A});var a=n(31481),s=n(66644),o=n(19822),r=n(83868),i=n(76023),l=n(2429),c=n(17169);const d=250,m=.25*i.$,u=11,p=.1875*i.$,h=.125*i.$,g=new Set;function A(e){w();const{container:t,toggler:n,leftMainHeader:r,ribbonPeers:i,toggleAvatars:l}=f(e);if(!(n&&l&&i&&t&&r))return;const{bottom:h,right:A}=r.getBoundingClientRect(),y=h+m,C=l[0],N=l[l.length-1],I=E(C);Array.from(i).reverse().forEach((e,r,{length:i})=>{const l=E(e);if(!l)return;const m=l===I;let h=b(n,l),f=u+r+1;if(h||(h=r===i-1?N:C,f=u),!h)return;let{top:w,left:S,width:M}=h.getBoundingClientRect();const{left:k,width:T}=e.getBoundingClientRect();if(k>A)return;S-=p,M+=2*p;const P=S-k,L=w-y,B=M/T;w-=p;const R=k-S+2*p,F=y-w+p,D=T/(M+2*p);(0,s.RK)(()=>{if(!h)return;const n=v(e);let r;f>u?(r=v(h),m&&r.classList.add(c.A.ghostLast)):n.classList.add(c.A.ghostAnimateName),(0,o.ZM)(n,{top:`${y}px`,left:`${k}px`,zIndex:String(f),opacity:r?"0":"",transform:`translate3d(${P}px, ${L}px, 0) scale(${B})`}),r&&(0,o.ZM)(r,{top:`${w}px`,left:`${S}px`,zIndex:String(f)}),t.appendChild(n),r&&t.appendChild(r),h.classList.add("animating"),e.classList.add("animating"),(0,s.RK)(()=>{(0,o.ZM)(n,{opacity:"",transform:""}),r?(0,o.ZM)(r,{opacity:"0",transform:`translate3d(${R}px, ${F}px, 0) scale(${D})`}):n.classList.add(c.A.ghostRevealName);const i=x(()=>{(0,s.RK)(()=>{t.contains(n)&&t.removeChild(n),r&&t.contains(r)&&t.removeChild(r),h?.classList.remove("animating"),e.classList.remove("animating"),g.delete(i)})},d+a.xB5);g.add(i)})})})}function y(e){w();const{container:t,toggler:n,toggleAvatars:r,ribbonPeers:i,leftMainHeader:l}=f(e);if(!(n&&r&&i&&t&&l))return;const{right:m}=l.getBoundingClientRect(),A=r[0],y=r[r.length-1],C=E(A);Array.from(i).reverse().forEach((e,r,{length:i})=>{const l=E(e);if(!l)return;const f=l===C;let w=b(n,l),N=u+r+1;if(w||(w=r===i-1?y:A,N=u),!w)return;const{top:I,left:S,width:M}=e.getBoundingClientRect();let{left:k,width:T,top:P}=w.getBoundingClientRect();if(S>m)return;k-=p,T+=2*p;const L=k-S,B=P-I-h,R=T/M;P-=p;const F=S-k+2*p,D=I-P+p,O=M/(T+2*p);(0,s.RK)(()=>{const n=v(e);let r;N>u?(r=v(w),f&&r.classList.add(c.A.ghostLast)):n.classList.add(c.A.ghostAnimateName,c.A.ghostRevealName),(0,o.ZM)(n,{top:`${I}px`,left:`${S}px`,width:`${M}px`,zIndex:String(N)}),r&&(0,o.ZM)(r,{top:`${P}px`,left:`${k}px`,zIndex:String(N),opacity:"0",transform:`translate3d(${F}px, ${D}px, 0) scale(${O})`}),e.classList.add("animating"),w.classList.add("animating"),t.appendChild(n),r&&t.appendChild(r),(0,s.RK)(()=>{(0,o.ZM)(n,{opacity:r?"0":"",transform:`translate3d(${L}px, ${B}px, 0) scale(${R})`}),r?(0,o.ZM)(r,{opacity:"",transform:""}):n.classList.remove(c.A.ghostRevealName);const i=x(()=>{(0,s.RK)(()=>{t.contains(n)&&t.removeChild(n),r&&t.contains(r)&&t.removeChild(r),e.classList.remove("animating"),w.classList.remove("animating")}),g.delete(i)},d+a.xB5);g.add(i)})})})}function f(e){let t=document.getElementById("LeftColumn");if(t&&e&&(t=t.querySelector(".ArchivedChats")),!t)return{};const n=t.querySelector("#StoryToggler"),a=t.querySelector("#StoryRibbon"),s=t.querySelector(".left-header"),o=a?.querySelectorAll(`.${l.A.peer}`),r=n?.querySelectorAll(".Avatar");return{container:t,toggler:n,leftMainHeader:s,ribbonPeers:o,toggleAvatars:r}}function v(e){const t=e.cloneNode(!0);t.classList.add(c.A.ghost),t.classList.remove("animating"),t.draggable=!1,t.oncontextmenu=r.A;const n=e.querySelector("canvas");if(n){const e=t.querySelector("canvas");e?.getContext("2d")?.drawImage(n,0,0)}return t}function E(e){return e?.getAttribute("data-peer-id")}function b(e,t){return e?.querySelector(`[data-peer-id="${t}"]`)}function x(e,t){const n=setTimeout(e,t);return()=>{clearTimeout(n),e()}}function w(){g.forEach(e=>e()),g.clear()}},35127:(e,t,n)=>{"use strict";n.d(t,{MC:()=>r,ej:()=>l,nP:()=>c,yA:()=>d});var a=n(76023);const s=12,o=40,r=20*a.$,i=s*a.$,l=5*a.$;function c(e,t){return(e?.length??0)>o||t?r:i}function d({media:e,messageText:t,isOwn:n,isInWebPage:o,asForwarded:r,noAvatars:i,isMobile:d}){const m="photo"===e.mediaType,u="video"===e.mediaType,p=m&&o,h=u&&o,{width:g,height:A}=m?(0,a.ck)(e,n,r,p,i,d):u?(0,a.rO)(e,n,r,h,i,d):(0,a.ri)(e,n,r,o,i,d),y=c(t);let f=1;g<y&&y-g<s&&(f=y/g),A*f<l&&l-A*f<s&&(f=l/A);const v=Math.round(g*f),E=Math.round(A*f);return{width:v,height:E,isSmall:v<y||E<l}}},35749:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(77312),s=n(63527);function o(e){return e.messages.webPageById}function r(e,t){const n=(0,s.A)(o);if(!e)return;const r=e.content.webPage?.id,i=r?n[r]:void 0;return(0,a.EO)(e,{webPage:i},t)}},36353:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var a=n(96454);function s(e,t,n){if(!t&&e===document.activeElement)return;const s=window.getSelection(),o=document.createRange(),r=e.lastChild||e;a.TF||n||r&&r.nodeValue?(o.selectNodeContents(n?e:r),o.collapse(!1),s.removeAllRanges(),s.addRange(o)):e.focus()}},36680:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var a=n(84051),s=n(96454),o=n(17712);const r=250;let i;function l(e,t,n=r,l=!1){const c=(0,a.li)(!1),d=(0,o.A)(()=>{c.current=!0});return(0,a.vJ)(()=>{i&&(clearTimeout(i),i=void 0),!e||s.TF||l||(i=window.setTimeout(()=>{c.current||t()},2*n))},[l,e,n,t]),[(0,o.A)(()=>{c.current=!0}),(0,o.A)(()=>{c.current=!1,i&&(clearTimeout(i),i=void 0),i=window.setTimeout(()=>{c.current||t()},n)}),d]}},37378:(e,t,n)=>{"use strict";n.d(t,{A:()=>y});var a=n(84051),s=n(13439),o=n(90709),r=n(60919),i=n(87357),l=n(17663),c=n(58849),d=n(49086),m=n(4961),u=n(17712),p=n(59030),h=n(96530),g=n(81524),A=n(84685);const y=(0,a.ph)((0,s.EK)((e,{message:t})=>({webPage:(0,r.Pn$)(e,t)}))(({message:e,webPage:t,senderTitle:n,isProtected:s,onlyWebPage:r,observeIntersection:y,onMessageClick:f})=>{const v=(0,p.A)();let E=t;if(!E&&!r){const t=(0,o.ZD)(e);if(t){const{url:n,domain:a}=t;E={siteName:a.replace(/^www./,""),url:n.includes("://")?n:n.includes("@")?`mailto:${n}`:`http://${n}`,formattedDescription:(0,o.P5)(e)?.text!==n?(0,d.C)(v,e,void 0,void 0,170):void 0}}}const b=(0,u.A)(()=>{f(e)});if("full"!==E?.webpageType)return;const{siteName:x,url:w,displayUrl:C,title:N,description:I,formattedDescription:S,photo:M,video:k}=E,T=!n&&I&&(0,c.A)(I,170),P=(0,i.A)("WebLink scroll-item",!M&&!k&&"without-media"),L=w.replace("mailto:","")||C;return a.Ay.createElement("div",{className:P,"data-initial":(x||C)[0],dir:v.isRtl?"rtl":void 0},M&&a.Ay.createElement(g.A,{message:e,isProtected:s,observeIntersection:y}),a.Ay.createElement("div",{className:"content"},a.Ay.createElement(h.A,{isRtl:v.isRtl,className:"site-title",onClick:b},(0,m.A)(N||x||C)),(T||S)&&a.Ay.createElement(h.A,{isRtl:v.isRtl,className:"site-description",onClick:b},S||T&&(0,m.A)(T)),a.Ay.createElement(A.A,{url:w,className:"site-name",text:L,isRtl:v.isRtl}),n&&a.Ay.createElement("div",{className:"sender-name"},(0,m.A)(n))),n&&a.Ay.createElement("div",{className:"message-date"},a.Ay.createElement(h.A,{className:"date",onClick:b,isRtl:v.isRtl},(0,l.be)(v,1e3*e.date))))}))},37830:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var a=n(87894);const s=new WeakMap;function o(e){return(...t)=>{const n=s.get(e);if(n&&(0,a.k)(n.lastArgs,t))return n.lastResult;const o=e(...t);return s.set(e,{lastArgs:t,lastResult:o}),o}}},38102:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(84051),s=n(87412),o=n(76471);const r=(0,a.ph)(({topic:e,className:t,letterClassName:n,size:r,noLoopLimit:i,observeIntersection:l,onClick:c})=>e.iconEmojiId&&"0"!==e.iconEmojiId?a.Ay.createElement(s.A,{documentId:e.iconEmojiId,className:t,size:r,observeIntersectionForPlaying:l,loopLimit:i?void 0:2,onClick:c}):a.Ay.createElement(o.A,{iconColor:e.iconColor,title:e.title,topicId:e.id,className:t,letterClassName:n,onClick:c}))},38218:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(84051),s=n(31481),o=n(17712);const r=function({onClick:e,onStart:t,onEnd:n,threshold:r=250}){const i=(0,a.li)(!1),l=(0,a.li)(!1),c=(0,a.li)(void 0),d=(0,o.A)(e=>{const n="button"in e&&0===e.button||"touches"in e&&e.touches.length>0;!l.current&&n&&(l.current=!0,c.current=window.setTimeout(()=>{t?.(),i.current=!0},r))}),m=(0,o.A)(t=>{l.current&&(i.current?n?.():e?.(t),u())}),u=(0,o.A)(()=>{i.current=!1,l.current=!1,window.clearTimeout(c.current)});return(0,a._W)(()=>{window.clearTimeout(c.current)}),(0,a.vJ)(()=>(document.body.addEventListener(s.D2Y,u),()=>{document.body.removeEventListener(s.D2Y,u)}),[]),{onMouseDown:d,onMouseUp:m,onMouseLeave:m,onTouchStart:d,onTouchEnd:m}}},38493:(e,t,n)=>{"use strict";n.d(t,{A:()=>f});var a=n(96540),s=n(57446),o=n(96454),r=n(87357),i=n(4146),l=n(36838),c=n(59030),d=n(66644),m=n(41402),u=n(4961),p=n(11217);const h="Tab--active",g=({className:e,title:t,isActive:n,badgeCount:s,isBadgeActive:i,previousActiveTab:l,onClick:c,clickArg:g})=>{const A=(0,a.useRef)(null);(0,a.useLayoutEffect)(()=>{n&&void 0===l&&A.current&&A.current.classList.add(h)},[n,l]),(0,a.useEffect)(()=>{if(!n||void 0===l)return;const e=A.current,t=e.parentElement.children[l];if(!t)return void(n&&!e.classList.contains(h)&&(0,d.RK)(()=>{e.classList.add(h)}));const a=e.querySelector(".platform"),s=t.querySelector(".platform"),o=s.parentElement.offsetLeft-a.parentElement.offsetLeft,r=s.clientWidth/a.clientWidth;(0,d.RK)(()=>{s.classList.remove("animate"),a.classList.remove("animate"),a.style.transform=`translate3d(${o}px, 0, 0) scale3d(${r}, 1, 1)`,(0,d.gm)(()=>((0,m.A)(a),()=>{a.classList.add("animate"),a.style.transform="none",t.classList.remove(h),e.classList.add(h)}))})},[n,l]);const{handleClick:y,handleMouseDown:f}=(0,p.Q)(e=>{"mousedown"===e.type&&e.button!==o.w3.Main||c?.(g)});return a.createElement("div",{className:(0,r.A)("Tab",c&&"Tab--interactive",e),onClick:y,onMouseDown:f,ref:A},a.createElement("span",{className:"Tab_inner"},(0,u.A)(t),Boolean(s)&&a.createElement("span",{className:(0,r.A)("badge",i&&"Tab__badge--active")},s),a.createElement("i",{className:"platform"})))},A=o.pz?450:o.Ni?400:300,y=({tabs:e,activeTab:t,onSwitchTab:n,className:o,tabClassName:d,inversion:m})=>{const u=(0,a.useRef)(null),p=(0,i.A)(t);(0,l.A)(u,void 0,!0),(0,a.useEffect)(()=>{const e=u.current,{scrollWidth:n,offsetWidth:a,scrollLeft:o}=e;if(n<=a)return;const r=e.childNodes[t];if(!r)return;const{offsetLeft:i,offsetWidth:l}=r,c=i-a/2+l/2;Math.abs(c-o)<16||(0,s.A)(e,c,A)},[t]);const h=(0,c.A)();return a.createElement("div",{className:(0,r.A)("TabList","no-scrollbar",m&&"inversion",o),ref:u,dir:h.isRtl?"rtl":void 0},e.map((e,s)=>a.createElement(g,{key:e.id,title:e.title,isActive:s===t,badgeCount:e.badgeCount,isBadgeActive:e.isBadgeActive,previousActiveTab:p,onClick:n,clickArg:s,className:d})))},f=(0,a.memo)(y)},39074:(e,t,n)=>{"use strict";n.d(t,{DY:()=>l,JC:()=>r,LV:()=>o,oR:()=>s,vZ:()=>i});const a=document.createElement("div");function s(e){const t=window.getSelection();if(t?.getRangeAt&&t.rangeCount){const n=t.getRangeAt(0);n.deleteContents();const a=n.createContextualFragment(e),s=a.lastChild;n.insertNode(a),s?(n.setStartAfter(s),n.setEndAfter(s)):n.collapse(!1),t.removeAllRanges(),t.addRange(n)}}function o(e,t){if(!e)return"";const n=window.getSelection();if(!n||!n.rangeCount)return e.innerHTML;const s=n.getRangeAt(0).cloneRange();return s.intersectsNode(e)?t||e.contains(s.commonAncestorContainer)?(s.collapse(!0),s.setStart(e,0),a.innerHTML="",a.appendChild(s.cloneContents()),a.innerHTML):"":e.innerHTML}function r(e){let t=0;const n=window.getSelection();if(!n||0===n.rangeCount)return t;const a=n.getRangeAt(0),s=a.cloneRange();return s.selectNodeContents(e),s.setEnd(a.endContainer,a.endOffset),t=s.toString().length,t}function i(e,t){for(const n of e.childNodes)if(n.nodeType===Node.TEXT_NODE){if(n.length>=t){const e=document.createRange(),a=window.getSelection();return e.setStart(n,t),e.collapse(!0),a.removeAllRanges(),a.addRange(e),-1}t-="length"in n?n.length:0}else if(-1===(t=i(n,t)))return-1;return t}function l(){const e=window.getSelection();e?.removeAllRanges()}},40175:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var a=n(84051),s=n(13439),o=n(31481),r=n(60919),i=n(34458),l=n(59030),c=n(34201),d=n(92111),m=n(21849),u=n(17169);const p=(0,a.ph)((0,s.EK)((e,{isArchived:t})=>{const{orderedPeerIds:{archived:n,active:a},byPeerId:s}=e.stories,{storyViewer:{isRibbonShown:o,isArchivedRibbonShown:i}}=(0,r.nTw)(e),l=(0,r.clw)(e),c=(0,r.xYJ)(e,"storyRibbonAnimations");return{currentUserId:e.currentUserId,orderedPeerIds:t?n:a,isShown:t?!i:!o,isForumPanelOpen:l,withAnimation:c,usersById:e.users.byId,chatsById:e.chats.byId,peerStories:s}})(function({currentUserId:e,orderedPeerIds:t,usersById:n,chatsById:r,canShow:p,isShown:h,isForumPanelOpen:g,isArchived:A,withAnimation:y,peerStories:f}){const{toggleStoryRibbon:v}=(0,s.ko)(),E=(0,l.A)(),b=(0,a.Kr)(()=>1===t.length?[n[t[0]]||r[t[0]]]:t.map(e=>n[e]||r[e]).filter(t=>t&&t.id!==e).slice(0,o.dqH).reverse(),[e,t,n,r]),x=(0,a.Kr)(()=>b?.length?b.reduce((e,t)=>{const n=f[t.id];if(!n)return e;const a=n.orderedIds.some(e=>{const t=n.byId[e];if(!t||!("isForCloseFriends"in t))return!1;const a=n.lastReadId&&t.id<=n.lastReadId;return t.isForCloseFriends&&!a});return e[t.id]=a,e},{}):{},[f,b]),w=(0,a.Kr)(()=>t.slice(0,5),[t]);(0,d.A)(w);const C=p&&h,{ref:N,shouldRender:I}=(0,c.A)({isOpen:C,className:"slow",withShouldRender:!0});if((0,a.vJ)(()=>{y&&!g&&(C?((0,a.VK)(i.UG+o.xB5),(0,i.$)(A)):((0,a.VK)(i.UG+o.xB5),(0,i.wV)(A)))},[A,C,y,g]),I)return a.Ay.createElement("button",{ref:N,type:"button",id:"StoryToggler",className:u.A.root,"aria-label":E("Chat.Context.Peer.OpenStory"),onClick:()=>v({isShown:!0,isArchived:A}),dir:E.isRtl?"rtl":void 0},b.map(e=>a.Ay.createElement(m.A,{key:e.id,peer:e,size:"tiny",className:u.A.avatar,withStorySolid:!0,forceFriendStorySolid:x[e.id]})))}))},40435:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var a=n(41074);const s={dark:{outgoing:"rgb(135,116,225)",incoming:"rgb(33,33,33)"},light:{outgoing:"rgb(238,255,222)",incoming:"rgb(255,255,255)"}};function o(e,t,n,o,r){return o?Promise.resolve(s[r||"light"][t?"outgoing":"incoming"]):(0,a.M1)({name:"offscreen-canvas:getAppendixColorFromImage",args:[e,t]},Math.round(n)%a.bP)}},41074:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>i,M1:()=>l,bP:()=>o});var a=n(31481),s=n(5130);const o=Math.min(navigator.hardwareConcurrency||4,4);let r;function i(){return a.W75?[]:(r||(r=new Array(o).fill(void 0).map(()=>{const e=new Worker(new URL(n.p+n.u(9722),n.b));return{worker:e,connector:(0,s.U)(e,void 0,"media")}})),r)}function l(e,t){return i()[t].connector.request(e)}},41316:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var a=n(84051);function s(e){const[t,n]=(0,a.Ul)();return(0,a.vJ)(()=>{function t(){const t=window.getSelection();if(!t?.rangeCount)return;const a=t.getRangeAt(0);if(!a)return;if(!document.querySelector(e))return;const{commonAncestorContainer:s}=a;(s instanceof Element?s:s.parentElement).closest(e)&&n(a)}return document.addEventListener("selectionchange",t),()=>document.removeEventListener("selectionchange",t)},[e,n]),t}},41510:(e,t,n)=>{"use strict";n.d(t,{I:()=>E,A:()=>b});var a=n(84051),s=n(13439),o=n(90709),r=n(87357),i=n(11778),l=n(55153),c=n(45761),d=n(39351),m=n(17712),u=n(73767),p=n(50680),h=n(3325),g=n(15283),A=n(37661),y=n(93545),f=n(54746);const v=(0,a.ph)(({isQuick:e,isGeneric:t,onFileSelect:n})=>{const s=(0,a.li)(),o=(0,a.li)(),[i,l,c]=(0,A.A)(),d=(0,m.A)(e=>{const{relatedTarget:t}=e;t&&e.stopPropagation(),c()}),u=(0,m.A)(()=>{const e=o.current;if(!e)return;const{width:t,height:n}=e.getBoundingClientRect();e.viewBox.baseVal.width=t,e.viewBox.baseVal.height=n});(0,y.A)(s,u),(0,g.A)(u);const p=(0,r.A)("DropTarget",i&&"hovered");return a.Ay.createElement("div",{className:p,ref:s,onDrop:n,onDragEnter:l,onDragLeave:d,"data-dropzone":!0},a.Ay.createElement("svg",{className:"target-outline-container"},a.Ay.createElement("rect",{className:"target-outline",x:"0",y:"0",width:"100%",height:"100%",rx:"8"})),a.Ay.createElement("div",{className:"target-content"},a.Ay.createElement(f.A,{name:e?"photo":"document"}),a.Ay.createElement("div",{className:"title"},"Drop files here to send them"),!t&&a.Ay.createElement("div",{className:"description"},e?"in a quick way":"without compression")))});let E=function(e){return e.None="none",e.Document="document",e.QuickFile="quick_file",e}({});const b=(0,a.ph)(({isOpen:e,withQuick:t,editingMessage:n,onHide:g,onFileSelect:A})=>{const y=(0,d.A)(),{showNotification:f,updateAttachmentSettings:E}=(0,s.ko)(),b=(0,a.li)(),x=(0,u.A)(t),{shouldRender:w,transitionClassNames:C}=(0,p.A)(e);(0,a.vJ)(()=>e?(0,i.A)(g):void 0,[e,g]);const N=(0,m.A)(async e=>{const{dataTransfer:a}=e;let s=[];if(!(a.files&&a.files.length>0)||a.items&&a.items.length){if(a.items&&a.items.length>0){const e=await(0,c.A)(a.items);e?.length&&(s=s.concat(e))}}else s=s.concat(Array.from(a.files));if(n){if(s.length>1)return void f({message:y("MediaReplaceInvalidError",void 0,{pluralValue:s.length})});if(1===s.length){const e=await(0,l.A)(s[0].name,s[0]);if(!(n&&e&&(0,o.eh)(n,e)))return void f({message:y("MediaReplaceInvalidError",void 0,{pluralValue:s.length})})}}g(),E({shouldCompress:!t&&void 0}),A(s)}),I=(0,m.A)(async e=>{const{dataTransfer:t}=e;if(t.files&&t.files.length>0){const e=Array.from(t.files);if(n){if(e.length>1)return void f({message:y("MediaReplaceInvalidError",void 0,{pluralValue:e.length})});if(1===e.length){const t=await(0,l.A)(e[0].name,e[0]);if(!(n&&t&&(0,o.eh)(n,t)))return void f({message:y("MediaReplaceInvalidError",void 0,{pluralValue:e.length})})}}g(),E({shouldCompress:!0}),A(e)}}),S=(0,m.A)(e=>{e.stopPropagation();const{target:t,relatedTarget:n}=e;!t.matches(".DropTarget, .DropArea")||n&&n.matches(".DropTarget, .DropArea")||(b.current=window.setTimeout(()=>{g()},150))});if(!w)return;const M=t||x,k=(0,r.A)("DropArea",C);return a.Ay.createElement(h.A,{containerSelector:"#middle-column-portals"},a.Ay.createElement("div",{className:k,onDragLeave:S,onDragOver:()=>{b.current&&window.clearTimeout(b.current)},onDrop:g,onClick:g},a.Ay.createElement(v,{onFileSelect:N,isGeneric:!M}),M&&a.Ay.createElement(v,{onFileSelect:I,isQuick:!0})))})},42215:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var a=n(84051),s=n(30857);function o(e,t){const n=(0,s.A)(),o=(0,a.li)(e),r=(0,a.li)(t),i=(0,a.hb)(e=>(r.current=o.current(r.current,e),n(),r.current),[]);return[r.current,i]}},42827:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var a=n(84051),s=n(87357),o=n(58443),r=n(4961),i=n(59030),l=n(50680),c=n(64489);const d=(0,a.ph)(({text:e="Nothing found.",description:t,withSticker:n})=>{const d=(0,i.A)(),{transitionClassNames:m}=(0,l.A)(!0);return a.Ay.createElement("div",{className:(0,s.A)("NothingFound",m,t&&"with-description",n&&"with-sticker")},n&&a.Ay.createElement(c.A,{className:"sticker",size:120,tgsUrl:o.w.DuckNothingFound,previewUrl:o.d.DuckNothingFound,nonInteractive:!0,noLoop:!1}),e,t&&a.Ay.createElement("p",{className:"description"},(0,r.A)(d(t),["br"])))})},44589:(e,t,n)=>{"use strict";n.d(t,{A:()=>y});var a=n(84051),s=n(13439),o=n(31481),r=n(90709),i=n(91525),l=n(37661),c=n(5912),d=n(17712),m=n(62587),u=n(69419),p=n(59030),h=n(19806),g=n(94189),A=n(52988);const y=(0,a.ph)(({document:e,observeIntersection:t,smaller:n,canAutoLoad:y,autoLoadFileMaxSizeMb:f,uploadProgress:v,withDate:E,datetime:b,className:x,sender:w,isSelected:C,isSelectable:N,shouldWarnAboutSvg:I,isDownloading:S,message:M,onSelect:k,onCancelUpload:T,onMediaClick:P,onDateClick:L})=>{const{cancelMediaDownload:B,downloadMedia:R,setSharedSettingOption:F}=(0,s.ko)(),D=(0,a.li)(),O=(0,p.A)(),[z,j,U]=(0,l.A)(),[V,J]=(0,a.J0)(!1),{fileName:H,size:K,timestamp:$}=e,G=(0,i.rK)(e)||"",_=(0,c.Vz)(D,t),[q,W]=(0,l.A)();(0,a.vJ)(()=>{_&&W()},[_,W]);const[Q,Y]=(0,a.J0)(y&&(!f||K<=1048576*f)),Z=Boolean(S||Q&&q),X=(0,r.mr)(e,"download"),{loadProgress:ee,mediaData:te}=(0,u.A)(X,!Z,(0,r.Cz)(e,"download"),void 0,!0),ne=Boolean(te),{isUploading:ae,isTransferring:se,transferProgress:oe}=(0,r.LK)(v||ee,Z&&!ne,void 0!==v),re=(0,i.ON)(e),ie=re?(0,r.VD)(e):void 0,le=re?e.previewBlobUrl:void 0,ce=(0,m.A)((0,r.mr)(e,"pictogram"),!_),de=P&&e.innerMediaType,me=(0,d.A)(()=>{R({media:e,originMessage:M})}),ue=(0,d.A)(()=>{ae?T&&T():S?B({media:e}):se?Y(!1):de?P():o.c59.has(G)&&I?j():me()}),pe=(0,d.A)(()=>{F({shouldWarnAboutSvg:!V}),U(),me()}),he=(0,d.A)(()=>{L?.(M)});return a.Ay.createElement(a.Ay.Fragment,null,a.Ay.createElement(A.A,{ref:D,name:H,extension:G,size:K,timestamp:E?b||$:void 0,thumbnailDataUri:ie,previewData:le||ce,smaller:n,isTransferring:se,isUploading:ae,transferProgress:oe,className:x,sender:w,isSelectable:N,isSelected:C,actionIcon:de?(0,r.hr)(e)?"play":"eye":"download",onClick:ue,onSelect:k,onDateClick:L?he:void 0}),a.Ay.createElement(g.A,{isOpen:z,onClose:U,confirmHandler:pe},O("lng_launch_svg_warning"),a.Ay.createElement(h.A,{className:"dialog-checkbox",checked:V,label:O("lng_launch_exe_dont_ask"),onCheck:J})))})},45227:(e,t,n)=>{"use strict";n.d(t,{P:()=>o});var a=n(96540),s=n(5338);function o({component:e,props:t}){return n=>{if(!n)return{unmount:()=>{}};n._reactRoot||(n._reactRoot=s.createRoot(n));try{n._reactRoot.render(a.createElement(e,t))}catch(e){return console.error("Failed to render React component:",e),{unmount:()=>{}}}return{unmount:()=>{n._reactRoot?.unmount(),n._reactRoot=null}}}}},45318:(e,t,n)=>{"use strict";e.exports=n.p+"GiftStar.59a3e3598fdbab13b181.svg"},45761:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var a=n(87679);async function s(e){const t=[];function n(e,a){return new Promise(s=>{if(e instanceof File)t.push(e),s(e);else if(e.isFile){const n=a.getAsFile();e.file(e=>{t.push(e),s(e)},()=>{n&&t.push(n),s(n)})}else e.isDirectory&&e.createReader().readEntries(e=>{const t=[];for(let s=0;s<e.length;s++)t.push(n(e[s],a));s(Promise.all(t))})})}const s=[];for(let t=0;t<e.length;t++){const a=e[t];if("file"===a.kind){const e=a.webkitGetAsEntry()||a.getAsFile();e&&s.push(n(e,a))}}return await Promise.all(s),(0,a.kc)(t)}},46051:(e,t,n)=>{"use strict";n.d(t,{G:()=>a,w:()=>s});const a="video/mp4; codecs=hvc1.1.6.L63.00",s="video/mp4; codecs=avc1.64001E"},47058:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var a=n(84051),s=n(13439),o=n(87357),r=n(85982),i=n(43874),l=n(17712),c=n(59030),d=n(64493),m=n(22699),u=n(24433),p=n(54746);const h=(0,a.ph)(({title:e,link:t,isDisabled:n,className:h,withShare:g,onRevoke:A})=>{const y=(0,c.A)(),{showNotification:f,openChatWithDraft:v}=(0,s.ko)(),{isMobile:E}=(0,i.Ay)(),b=!A,x=(0,l.A)(()=>{(0,r.eM)(t),f({message:{key:"LinkCopied"}})}),w=(0,l.A)(()=>{n||x()}),C=(0,l.A)(()=>{v({text:{text:t}})}),N=(0,a.Kr)(()=>({onTrigger:e,isOpen:t})=>a.Ay.createElement(d.A,{round:!0,ripple:!E,size:"smaller",color:"translucent",className:t?"active":"",onClick:e,ariaLabel:y("AccDescrOpenMenu2")},a.Ay.createElement(p.A,{name:"more"})),[E,y]);return a.Ay.createElement("div",{className:h},a.Ay.createElement("p",{className:"vCMpiQTJ"},y(e||"InviteLink.InviteLink")),a.Ay.createElement("div",{className:"xNjJHI7j"},a.Ay.createElement("input",{className:(0,o.A)("form-control","Ag6k_p7b"),value:t,readOnly:!0,onClick:w}),b?a.Ay.createElement(d.A,{color:"translucent",className:"obuPXobw",size:"smaller",round:!0,disabled:n,onClick:w},a.Ay.createElement(p.A,{name:"copy"})):a.Ay.createElement(m.A,{className:"p7t3macG",trigger:N,positionX:"right"},a.Ay.createElement(u.A,{icon:"copy",onClick:w,disabled:n},y("Copy")),A&&a.Ay.createElement(u.A,{icon:"delete",onClick:A,destructive:!0},y("RevokeButton")))),g&&a.Ay.createElement(d.A,{size:"smaller",disabled:n,onClick:C,className:"Sbagy_Tm"},y("FolderLinkScreen.LinkActionShare")))})},47067:(e,t,n)=>{"use strict";n.d(t,{A:()=>m});var a=n(84051),s=n(13439),o=n(31481),r=n(90709),i=n(96454),l=n(9716),c=n(87894),d=n(39351);const m=({chat:e,user:t,folderId:n,isPinned:m,isMuted:u,canChangeFolder:p,isSavedDialog:h,currentUserId:g,isPreview:A,topics:y,handleDelete:f,handleMute:v,handleChatFolderChange:E,handleReport:b},x=!1)=>{const w=(0,d.A)(),{isSelf:C}=t||{},N=t?.id===o.zv8,I=(0,a.Kr)(()=>{if(e)return h?w("Delete"):(0,l.L8)(e.id)||(0,r.IC)(e)?w("DeleteChat"):(0,r.WX)(e)?w("ChannelLeave"):w("GroupLeaveGroup")},[e,h,w]);return(0,a.Kr)(()=>{if(!e||A)return;const{toggleChatPinned:a,toggleSavedDialogPinned:o,updateChatMutedState:d,toggleChatArchived:S,markChatMessagesRead:M,markChatUnread:k,openChatInNewTab:T,openUserPortrait:P}=(0,s.ko)(),L=(0,l.L8)(e.id)?{title:"User Portrait",icon:"portrait-icon",handler:()=>{P({chatId:e.id,userId:e.id})}}:void 0,B=i.OS&&{title:i.cp?w("ChatListOpenInNewWindow"):w("ChatListOpenInNewTab"),icon:"open-in-new-tab",handler:()=>{T(h?{chatId:g,threadId:e.id}:{chatId:e.id})}},R=()=>{h?o({id:e.id}):a({id:e.id,folderId:n})},F=m?{title:w("ChatListUnpinFromTop"),icon:"unpin",handler:R}:{title:w("ChatListPinToTop"),icon:"pin",handler:R},D={title:I,icon:"delete",destructive:!0,handler:f};if(h)return(0,c.oE)([B,F,D]);const O=p?{title:w("ChatListContextAddToFolder"),icon:"folder",handler:E}:void 0,z=u?{title:w("ChatsUnmute"),icon:"unmute",handler:()=>d({chatId:e.id,isMuted:!1})}:{title:`${w("ChatsMute")}...`,icon:"mute",handler:v};if(x)return(0,c.oE)([B,F,O,z]);const j=e.unreadCount||e.hasUnreadMark||Object.values(y||{}).some(({unreadCount:e})=>e)?{title:w("ChatListContextMaskAsRead"),icon:"readchats",handler:()=>M({id:e.id})}:void 0,U=e.unreadCount||e.hasUnreadMark||e.isForum?void 0:{title:w("ChatListContextMaskAsUnread"),icon:"unread",handler:()=>k({id:e.id})},V=(0,r.TJ)(e)?{title:w("Unarchive"),icon:"unarchive",handler:()=>S({id:e.id})}:{title:w("Archive"),icon:"archive",handler:()=>S({id:e.id})},J=b&&!t&&((0,r.WX)(e)||(0,r.YE)(e))?{title:w("ReportPeerReport"),icon:"flag",handler:b}:void 0,H=void 0!==n;return(0,c.oE)([L,B,O,j,U,F,!C&&z,!C&&!N&&!H&&V,J,D])},[e,t,p,w,E,m,x,u,g,f,v,b,n,C,N,h,I,A,y])}},47526:(e,t,n)=>{"use strict";n.d(t,{KE:()=>l,PP:()=>c,_u:()=>i,zS:()=>r});const a={google:"https://maps.google.com/maps",bing:"https://bing.com/maps/default.aspx",osm:"https://www.openstreetmap.org",apple:"https://maps.apple.com"},s=new Map(Object.entries({"building/medical":"#43b3f4","building/gym":"#43b3f4","education/cafeteria":"#f7943f","travel/bedandbreakfast":"#9987ff","travel/hotel":"#9987ff","travel/hostel":"#9987ff","travel/resort":"#9987ff","travel/hotel_bar":"#e56dd6",arts_entertainment:"#e56dd6",building:"#6e81b2",education:"#a57348",event:"#959595",food:"#f7943f",home:"#00aeef",nightlife:"#e56dd6",parks_outdoors:"#6cc039",shops:"#ffb300",travel:"#1c9fff",work:"#ad7854"})),o=["#e56cd5","#f89440","#9986ff","#44b3f5","#6dc139","#ff5d5a","#f87aad","#6e82b3","#f5ba21"];function r(e,t,n=15){const{lat:s,long:o}=t,r=a[e];switch(e){case"google":return`${r}/place/${s}+${o}/@${s},${o},${n}z`;case"bing":return`${r}?cp=${s}~${o}&lvl=${n}&sp=point.${s}_${o}`;case"apple":return`${r}?q=${s},${o}`;default:return`${r}/?mlat=${s}&mlon=${o}&zoom=${n}`}}function i(e,t){return 156543.03392*Math.cos(e*(Math.PI/180))/2**t}function l(e){return e?`https://ss3.4sqi.net/img/categories_v2/${e}_88.png`:""}function c(e){return e?s.get(e)||s.get(e.split("/")[0])||o[(t=e,t.split("").reduce((e,t)=>(e<<5)-e+t.charCodeAt(0)|0,0)%o.length)]:"#008df2";var t}},47778:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});const a={rightPanelBg:"ZfJHpS2Q"}},48227:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var a=n(84051),s=n(48775),o=n(39351),r=n(19806),i=n(94189);const l=(0,a.ph)(({isOpen:e,onClose:t,userName:n,messagePriceInStars:l,messagesCount:c,shouldAutoApprove:d,setAutoApprove:m,confirmHandler:u})=>{const p=(0,o.A)(),h=p("ConfirmationModalPaymentForMessage",{user:n,amount:(0,s.Kk)(p,l),totalAmount:(0,s.Kk)(p,l*c),count:c},{withMarkdown:!0,withNodes:!0,pluralValue:c}),g=p("PayForMessage",{count:c},{withNodes:!0,pluralValue:c});return a.Ay.createElement(i.A,{title:p("TitleConfirmPayment"),confirmLabel:g,isOpen:e,onClose:t,confirmHandler:u},h,a.Ay.createElement(r.A,{className:"eScpikxM",label:p("DoNotAskAgain"),checked:d,onCheck:m}))})},48553:(e,t,n)=>{"use strict";n.d(t,{A:()=>E});var a=n(84051),s=n(13439),o=n(23174),r=n(89925),i=n(66644),l=n(90709),c=n(60919),d=n(96454),m=n(9716),u=n(2178),p=n(17712),h=n(59030),g=n(54746),A=n(64493),y=n(80089),f=n(80464);const v=e=>{const{isOpen:t}=e,n=(0,f.A)(y.ar.Extra,"HeaderMenuContainer",!t);return n?a.Ay.createElement(n,e):void 0},E=(0,a.ph)((0,s.EK)((e,{chatId:t,threadId:n,messageListType:a,isMobile:s})=>{const r=(0,c.hds)(e,t),i=Boolean(r&&(0,l.WX)(r)),u=Boolean(r&&(0,l.Vs)(r)),p=(0,c.wmb)(e),h=(0,c.Qq_)(e),g=(0,m.L8)(t),{doNotTranslate:A}=e.settings.byKey,y=(0,c._ls)(e,t);if(!r||y||(0,c.rTV)(e))return{noMenu:!0,language:p,translationLanguage:h,doNotTranslate:A};const f=(0,c.yps)(e,t),v=g?void 0:(0,c.AWZ)(e,t),E=g?(0,c.vGo)(e,t):void 0,b=v||E,x=(0,c.nZ4)(e,t),w="thread"===a&&n===o.l3,C="thread"===a&&n!==o.l3,N=(0,c.gjV)(e,s),I=(0,l.cG)(t,n,e.currentUserId),S=!!g&&(0,c.apd)(e,t),M=Boolean(f&&S),k=!M&&Boolean((0,c.I_m)(e,t)),T=S&&!f,P=Boolean((w||r.isForum)&&(i||u)&&r.isNotJoined&&!r.isMonoforum),L=w||C,B=d.OL&&(0,m.L8)(r.id)&&!x&&!f&&!r.isSupport&&!(0,l.Qe)(r.id),R=w&&!x&&!P,F=I||w&&!P,D=d.OL&&w&&r.isCallActive,O=d.OL&&w&&!r.isCallActive&&(r.adminRights?.manageCall||r.isCreator&&(0,l.yn)(r))&&!r.isMonoforum,z=w&&v?.canViewStatistics,j=w&&v?.canViewMonetization,U=w&&!r.isMonoforum&&(u||i)&&(z||(0,l.ub)(r,"postStories")),V=!U&&(u||i)&&!r.isMonoforum,J=w?v?.requestsPending:void 0,H=Boolean(r?.isNotJoined&&r.isJoinToSend),K=Boolean(r?.isNotJoined&&r.isJoinRequest),$=!(0,c.PKK)(e),G=(0,c.trm)(e),_=(0,l.WX)(r)?r.linkedMonoforumId:void 0,q=Boolean((0,c.qZq)(e,t));return{noMenu:!1,isChannel:i,isRightColumnShown:N,canStartBot:k,canRestartBot:M,canSubscribe:P,canSearch:L,canCall:B,canMute:R,canViewStatistics:z,canViewMonetization:j,canViewBoosts:U,canShowBoostModal:V,canLeave:F,canEnterVoiceChat:D,canCreateVoiceChat:O,pendingJoinRequests:J,shouldJoinToSend:H,shouldSendJoinRequest:K,noAnimation:$,canTranslate:(0,c.jGY)(e,t)&&!b?.isTranslationDisabled,isTranslating:q,translationLanguage:h,language:p,doNotTranslate:A,detectedChatLanguage:r.detectedLanguage,canUnblock:T,isAccountFrozen:G,channelMonoforumId:_}})(({chatId:e,threadId:t,noMenu:n,isMobile:o,isChannel:l,canStartBot:c,canRestartBot:m,canUnblock:y,canSubscribe:f,canSearch:E,canCall:x,canMute:w,canViewStatistics:C,canViewMonetization:N,canViewBoosts:I,canShowBoostModal:S,canLeave:M,canEnterVoiceChat:k,canCreateVoiceChat:T,channelMonoforumId:P,pendingJoinRequests:L,isRightColumnShown:B,isForForum:R,canExpandActions:F,shouldJoinToSend:D,shouldSendJoinRequest:O,noAnimation:z,onTopicSearch:j,isAccountFrozen:U})=>{const{joinChannel:V,sendBotCommand:J,openMiddleSearch:H,restartBot:K,requestMasterAndRequestCall:$,requestNextManagementScreen:G,showNotification:_,openChat:q,unblockUser:W,setViewForumAsMessages:Q}=(0,s.ko)(),Y=(0,a.li)(),Z=(0,h.A)(),[X,ee]=(0,a.J0)(!1),[te,ne]=(0,a.J0)(void 0),ae=(0,p.A)(()=>{ee(!0);const e=Y.current.getBoundingClientRect();ne({x:e.right,y:e.bottom})}),se=(0,p.A)(()=>{ee(!1)}),oe=(0,p.A)(()=>{ne(void 0)}),re=(0,p.A)(()=>{V({chatId:e}),O&&_({message:Z(l?"RequestToJoinChannelSentDescription":"RequestToJoinGroupSentDescription")})}),ie=(0,p.A)(()=>{J({command:"/start"})}),le=(0,p.A)(()=>{K({chatId:e})}),ce=(0,p.A)(()=>{W({userId:e})}),de=(0,p.A)(()=>{G({screen:r.je.JoinRequests})}),me=(0,p.A)(()=>{R?j?.():(H(),o?b():z?(0,i.YS)(()=>{(0,i.Uz)(b)}):setTimeout(b,320))}),ue=(0,p.A)(()=>{q({id:e}),Q({chatId:e,isEnabled:!0})}),pe=(0,p.A)(()=>{U||$({userId:e})}),he=(0,p.A)(e=>{E&&d.lE&&!e.shiftKey&&(e.preventDefault(),me())});return(0,u.v)((0,a.Kr)(()=>({"Mod+F":he}),[])),a.Ay.createElement("div",{className:"HeaderActions"},!o&&a.Ay.createElement(a.Ay.Fragment,null,F&&!O&&(f||D)&&a.Ay.createElement(A.A,{size:"tiny",ripple:!0,fluid:!0,onClick:re},Z(l?"ProfileJoinChannel":"ProfileJoinGroup")),F&&O&&a.Ay.createElement(A.A,{size:"tiny",ripple:!0,fluid:!0,onClick:re},Z("ChannelJoinRequest")),F&&c&&a.Ay.createElement(A.A,{size:"tiny",ripple:!0,fluid:!0,onClick:ie},Z("BotStart")),F&&m&&a.Ay.createElement(A.A,{size:"tiny",ripple:!0,fluid:!0,onClick:le},Z("BotRestart")),F&&y&&a.Ay.createElement(A.A,{size:"tiny",ripple:!0,fluid:!0,onClick:ce},Z("Unblock")),E&&a.Ay.createElement(A.A,{round:!0,ripple:B,color:"translucent",size:"smaller",onClick:me,ariaLabel:Z("Conversation.SearchPlaceholder")},a.Ay.createElement(g.A,{name:"search"})),x&&a.Ay.createElement(A.A,{round:!0,color:"translucent",size:"smaller",onClick:pe,ariaLabel:"Call"},a.Ay.createElement(g.A,{name:"phone"}))),!R&&Boolean(L)&&a.Ay.createElement(A.A,{round:!0,className:"badge-button",ripple:B,color:"translucent",size:"smaller",onClick:de,ariaLabel:Z(l?"SubscribeRequests":"MemberRequests")},a.Ay.createElement(g.A,{name:"user"}),a.Ay.createElement("div",{className:"badge"},L)),a.Ay.createElement(A.A,{ref:Y,className:X?"active":"",round:!0,ripple:!o,size:"smaller",color:"translucent",disabled:n,ariaLabel:"More actions",onClick:ae},a.Ay.createElement(g.A,{name:"more"})),te&&a.Ay.createElement(v,{chatId:e,threadId:t,isOpen:X,anchor:te,withExtraActions:o||!F,isChannel:l,canStartBot:c,canSubscribe:f,canSearch:E,canCall:x,canMute:w,canViewStatistics:C,canViewBoosts:I,canViewMonetization:N,canShowBoostModal:S,canLeave:M,canEnterVoiceChat:k,canCreateVoiceChat:T,pendingJoinRequests:L,onJoinRequestsClick:de,withForumActions:R,channelMonoforumId:P,onSubscribeChannel:re,onSearchClick:me,onAsMessagesClick:ue,onClose:se,onCloseAnimationEnd:oe}))}));function b(){const e=document.querySelector("#MiddleSearch input");e?.focus()}},48885:(e,t,n)=>{"use strict";n.d(t,{A:()=>u,S:()=>p});var a=n(84051),s=n(61433),o=n(66644),r=n(14737),i=n(17712),l=n(93545),c=n(672);const d=450,m=100;function u({ref:e,isOpen:t,isDisabled:n,withResizeObserver:s,onStateChange:u}){const[p,h]=(0,a.J0)(t),g=(0,a.li)(),A=e||g,y=(0,a.li)(0),f=(0,i.A)(()=>{h(!0),u?.({element:void 0,height:0,isOpen:!1})});(0,a.vJ)(()=>{n&&f()},[n]),(0,a.vJ)(()=>{t&&h(!0)},[t]),(0,a._W)(f),(0,r.A)(()=>{h(!1),u?.({height:0,isOpen:!1})},t?void 0:d);const v=(0,a.hb)(()=>{const e=A.current;!n&&e&&p&&(t?(0,o.gm)(()=>{const n=e.offsetHeight;return y.current=n,()=>{u?.({element:e,height:n,isOpen:t})}}):u?.({element:e,height:0,isOpen:!1}))},[t,p,n,A,u]),E=(0,c.A)(()=>{const e=A.current;e&&e.offsetHeight!==y.current&&v()},[v,A],m,!0);return(0,a.Nf)(v,[v]),(0,l.A)(A,E,!s||!p),{shouldRender:p,ref:A}}function p(e,t=!1){let n=0;for(let a=0;a<e.length;a++){const r=e[a],i=r.element;if(!i)continue;const l=`${n}px`,c=()=>{(0,s.Tv)(i,{transform:`translateY(${r.isOpen?l:`calc(${l} - 100%)`})`,zIndex:String(-a),transition:t?"none":""})};i.dataset.isPanelOpen||!r.isOpen||t?c():((0,s.Tv)(i,{transform:`translateY(calc(${l} - 100%))`,zIndex:String(-a),transition:"none"}),i.dataset.isPanelOpen="true",(0,o.Uz)(c)),n+=r.height}}},48906:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var a=n(84051);const s=function({isOwn:e}){const t=e?"M6 17H0V0c.193 2.84.876 5.767 2.05 8.782.904 2.325 2.446 4.485 4.625 6.48A1 1 0 016 17z":"M3 17h6V0c-.193 2.84-.876 5.767-2.05 8.782-.904 2.325-2.446 4.485-4.625 6.48A1 1 0 003 17z";return a.Ay.createElement("svg",{width:"9",height:"20",className:"svg-appendix"},a.Ay.createElement("defs",null,a.Ay.createElement("filter",{x:"-50%",y:"-14.7%",width:"200%",height:"141.2%",filterUnits:"objectBoundingBox",id:"messageAppendix"},a.Ay.createElement("feOffset",{dy:"1",in:"SourceAlpha",result:"shadowOffsetOuter1"}),a.Ay.createElement("feGaussianBlur",{stdDeviation:"1",in:"shadowOffsetOuter1",result:"shadowBlurOuter1"}),a.Ay.createElement("feColorMatrix",{values:"0 0 0 0 0.0621962482 0 0 0 0 0.138574144 0 0 0 0 0.185037364 0 0 0 0.15 0",in:"shadowBlurOuter1"}))),a.Ay.createElement("g",{fill:"none","fill-rule":"evenodd"},a.Ay.createElement("path",{d:t,fill:"#000",filter:"url(#messageAppendix)"}),a.Ay.createElement("path",{d:t,fill:e?"#EEFFDE":"FFF",className:"corner"})))}},49068:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(84051),s=n(80089),o=n(80464);const r=e=>{const{isOpen:t}=e,n=(0,o.A)(s.ar.Extra,"EmojiTooltip",!t);return n?a.Ay.createElement(n,e):void 0}},49642:(e,t,n)=>{"use strict";n.d(t,{D5:()=>o,Eg:()=>i,HW:()=>l,MV:()=>s,hm:()=>c,wp:()=>d});const a={play:void 0,pause:void 0,seekbackward:void 0,seekforward:void 0,previoustrack:void 0,nexttrack:void 0,stop:void 0,seekTo:void 0};function s(e,t){const{mediaSession:n}=window.navigator;n?(e&&o(e),t&&r(t)):console.warn("MediaSession API not supported in this browser")}function o(e){const{mediaSession:t}=window.navigator;t&&(t.metadata=e??null)}function r(e){const{mediaSession:t}=window.navigator;t&&Object.entries({...a,...e}).forEach(([e,n])=>{try{t.setActionHandler(e,n)}catch(e){}})}function i(){const{mediaSession:e}=window.navigator;e&&(e.metadata=null,r(a),e.playbackState&&(e.playbackState="none"),e.setPositionState?.())}function l(e="none"){const{mediaSession:t}=window.navigator;t&&t.playbackState&&(t.playbackState=e)}function c(e){if(!e||void 0===e.position||void 0===e.duration)return;e.position=Math.min(e.position,e.duration);const{mediaSession:t}=window.navigator;t?.setPositionState?.(e)}function d({title:e,artist:t,album:n,artwork:a}){if("MediaMetadata"in window)return new window.MediaMetadata({title:e,artist:t,album:n,artwork:a})}},51083:(e,t,n)=>{"use strict";n.d(t,{A:()=>x});var a=n(84051),s=n(13439),o=n(89925),r=n(90709),i=n(60919),l=n(87357),c=n(76023),d=n(4961),m=n(39351),u=n(17712),p=n(59030),h=n(41036),g=n(21849),A=n(80999),y=n(34431),f=n(54746),v=n(38102),E=n(80477);const b=2.5*c.$,x=(0,a.ph)((0,s.EK)((e,{chatId:t,threadId:n})=>{const a=(0,i.hds)(e,t),s=n?(0,i.Vw0)(e,t,n):void 0,o=a?(0,i.ToO)(e,a):void 0,r=Boolean((0,i.zeq)(e,t)),l=n?(0,i.S0q)(e,t,n):void 0;return{chat:a,threadInfo:s,onlineCount:o,topic:l,areMessagesLoaded:r,messagesCount:l&&(0,i.QbG)(e,t,n),self:(0,i.mBe)(e,e.currentUserId),monoforumChannel:(0,i.k2W)(e,t)}})(({typingStatus:e,className:t,statusIcon:n,avatarSize:c="medium",noAvatar:x,status:w,withDots:C,withMediaViewer:N,withUsername:I,withFullInfo:S,withUpdatingStatus:M,withChatType:k,threadInfo:T,noRtl:P,chat:L,onlineCount:B,areMessagesLoaded:R,topic:F,messagesCount:D,noStatusOrTyping:O,withStory:z,storyViewerOrigin:j,noEmojiStatus:U,emojiStatusSize:V,isSavedDialog:J,self:H,withMonoforumStatus:K,monoforumChannel:$,onClick:G,onEmojiStatusClick:_})=>{const{loadFullChat:q,openMediaViewer:W,loadMoreProfilePhotos:Q}=(0,s.ko)(),Y=!K&&$?$:L,Z=(0,p.A)(),X=(0,m.A)(),ee=Y&&(0,r.Vs)(Y),te=Boolean(Y?.isForum&&T&&F),{id:ne,isMin:ae}=Y||{},se=(0,i._ls)((0,s.mS)(),ne);(0,a.vJ)(()=>{ne&&!ae&&(S&&q({chatId:ne}),N&&Q({peerId:ne,isPreload:!0}))},[ne,ae,S,ee,N]);const oe=(0,u.A)((e,t)=>{Y&&t&&(e.stopPropagation(),W({isAvatarView:!0,chatId:Y.id,mediaIndex:0,origin:"jumbo"===c?o.TQ.ProfileAvatar:o.TQ.MiddleHeaderAvatar}))}),re=(0,a.Kr)(()=>Y&&I&&(0,r.Kl)(Y),[Y,I]);if(Y)return a.Ay.createElement("div",{className:(0,l.A)("ChatInfo",t),dir:!P&&Z.isRtl?"rtl":void 0,onClick:G},!x&&!te&&a.Ay.createElement(a.Ay.Fragment,null,J&&H&&a.Ay.createElement(g.A,{key:"saved-messages",size:c,peer:H,isSavedMessages:!0,className:"saved-dialog-avatar"}),a.Ay.createElement(g.A,{key:Y.id,className:(0,l.A)(J&&"overlay-avatar"),size:c,peer:Y,withStory:z,asMessageBubble:Boolean($),storyViewerOrigin:j,storyViewerMode:"single-peer",isSavedDialog:J,onClick:N?oe:void 0})),te&&a.Ay.createElement(v.A,{topic:F,className:"topic-header-icon",size:b}),a.Ay.createElement("div",{className:"info"},F?a.Ay.createElement("h3",{dir:"auto",className:"fullName"},(0,d.A)(F.title)):a.Ay.createElement(y.A,{peer:Y,isMonoforum:!K&&Boolean($),emojiStatusSize:V,withEmojiStatus:!U,isSavedDialog:J,onEmojiStatusClick:_}),!O&&function(){if(w)return C?a.Ay.createElement(A.A,{className:"status",content:w}):a.Ay.createElement("span",{className:"status",dir:"auto"},n&&a.Ay.createElement(f.A,{className:"status-icon",name:n}),(0,d.A)(w));if(M&&!R&&!se)return a.Ay.createElement(A.A,{className:"status",content:Z("Updating")});if(K)return a.Ay.createElement("span",{className:"status",dir:"auto"},X("MonoforumStatus"));if(L?.isMonoforum)return;if(w)return C?a.Ay.createElement(A.A,{className:"status",content:w}):a.Ay.createElement("span",{className:"status",dir:"auto"},n&&a.Ay.createElement(f.A,{className:"status-icon",name:n}),(0,d.A)(w));if(!Y)return;if(e)return a.Ay.createElement(E.A,{typingStatus:e});if(te)return a.Ay.createElement("span",{className:"status",dir:"auto"},a.Ay.createElement(h.Ay,{name:"fade",shouldRestoreHeight:!0,activeKey:void 0!==D?1:2,className:"message-count-transition"},void 0!==D&&Z("messages",D,"i")));if(k)return a.Ay.createElement("span",{className:"status",dir:"auto"},Z((0,r.Gg)(Y)));const t=(0,r.sT)(Z,Y),s=B?`, ${Z("OnlineCount",B,"i")}`:void 0;return a.Ay.createElement("span",{className:"status"},re&&a.Ay.createElement("span",{className:"handle withStatus"},re),a.Ay.createElement("span",{className:"group-status"},t),s&&a.Ay.createElement("span",{className:"online-status"},s))}()))}))},51644:(e,t,n)=>{"use strict";n.d(t,{A:()=>I});var a=n(84051),s=n(13439),o=n(31481),r=n(66644),i=n(90709),l=n(87357),c=n(40435),d=n(35127),m=n(43874),u=n(37661),p=n(5912),h=n(17712),g=n(37859),A=n(37960),y=n(69419),f=n(29886),v=n(73767),E=n(34201),b=n(61097),x=n(54746),w=n(27860),C=n(14413),N=n(35913);const I=(0,a.ph)((0,s.EK)(e=>{const t=e.appConfig,n=t?.needAgeVideoVerification;return{needsAgeVerification:n}})(({id:e,photo:t,messageText:n,isOwn:I,noAvatars:S,canAutoLoad:M,isInSelectMode:k,isSelected:T,uploadProgress:P,forcedWidth:L,size:B="inline",dimensions:R,asForwarded:F,nonInteractive:D,shouldAffectAppendix:O,isDownloading:z,isProtected:j,theme:U,isInWebPage:V,clickArg:J,className:H,isMediaNsfw:K,observeIntersection:$,onClick:G,onCancelUpload:_,needsAgeVerification:q})=>{const W=(0,a.li)(),Q="extendedMediaPreview"===t.mediaType,Y=Q?void 0:t.blobUrl,Z=(0,p.Vz)(W,$),{isMobile:X}=(0,m.Ay)(),[ee,te]=(0,a.J0)(M),ne=ee&&Z&&!Q,{mediaData:ae,loadProgress:se}=(0,y.A)(Q?void 0:(0,i.rI)(t,B),!ne),oe=(0,f.A)(ae),re=Y||ae,{ref:ie,shouldRender:le}=(0,A.A)({hasMediaData:Boolean(re),withShouldRender:!0}),ce=Boolean(L),[de]=(0,a.J0)(!re),me=Boolean(re),ue=(0,b.A)(t,me);(0,A.A)({ref:ue,hasMediaData:!me});const pe=(0,b.A)(t,!ce),he=(0,i.VD)(t),{updateContentSettings:ge,openAgeVerificationModal:Ae}=(0,s.ko)(),[ye,fe,ve]=(0,u.A)(),[Ee,be]=(0,a.J0)(!1),xe=Q||t.isSpoiler||K,[we,Ce,Ne]=(0,u.A)(xe);(0,a.vJ)(()=>{xe?Ce():Ne()},[xe]);const Ie=(0,h.A)(()=>{ve(),Ne(),Ee&&ge({isSensitiveEnabled:!0})}),{loadProgress:Se}=(0,y.A)(Q?void 0:(0,i.rI)(t,"download"),!z,Q?void 0:(0,i.Cz)(t,"download")),{isUploading:Me,isTransferring:ke,transferProgress:Te}=(0,i.LK)(P||(z?Se:se),ne&&!re,void 0!==P),Pe=!1===(0,v.A)(ee),{ref:Le,shouldRender:Be}=(0,E.A)({isOpen:ke,noMountTransition:Pe,className:"slow",withShouldRender:!0}),{ref:Re,shouldRender:Fe}=(0,E.A)({isOpen:!re&&!ee,withShouldRender:!0}),De=(0,h.A)(e=>{if(Me)_?.(J);else{if(re)return we?K?q?void Ae():void fe():void Ne():void G?.(J,e);te(e=>!e)}});(0,g.A)(([e])=>{if(!O)return void(e&&W.current.closest(o.KFG).removeAttribute(o.D3G));const t=W.current.closest(o.KFG);if(re){const e=Number(t.closest(".Message").dataset.messageId);(0,c.A)(re,Boolean(I),e,T,U).then(e=>{(0,r.RK)(()=>{t.style.setProperty("--appendix-bg",e),t.setAttribute(o.D3G,"")})})}else t.classList.add("has-appendix-thumb")},[O,re,I,k,T,U]);const{width:Oe,height:ze,isSmall:je}=R||(0,d.yA)({media:t,isOwn:I,asForwarded:F,noAvatars:S,isMobile:X,messageText:n,isInWebPage:V}),Ue=(0,l.A)("media-inner",!Me&&!D&&"interactive",je&&"small-image",(Oe===ze||"pictogram"===B)&&"square-image",ze<d.ej&&"fix-min-height",H),Ve=R?` width: ${Oe}px; left: ${R.x}px; top: ${R.y}px;`:"",Je="inline"===B?`height: ${ze}px;${Ve}`:void 0;return a.Ay.createElement("div",{id:e,ref:W,className:Ue,style:Je,onClick:Me?void 0:De},ce&&a.Ay.createElement("canvas",{ref:pe,className:"thumbnail blurred-bg"}),re&&a.Ay.createElement("img",{ref:ie,src:re||oe,className:(0,l.A)("full-media",ce&&"with-blurred-bg"),alt:"",style:L?`width: ${L}px`:void 0,draggable:!j}),de&&a.Ay.createElement("canvas",{ref:ue,className:"thumbnail"}),j&&a.Ay.createElement("span",{className:"protector"}),Be&&!Fe&&a.Ay.createElement("div",{ref:Le,className:"media-loading"},a.Ay.createElement(N.A,{progress:Te,onClick:Me?De:void 0})),Fe&&a.Ay.createElement(x.A,{ref:Re,name:"download"}),a.Ay.createElement(w.A,{isVisible:we,withAnimation:!0,thumbDataUri:he,width:Oe,height:ze,className:"media-spoiler",isNsfw:K}),ke&&a.Ay.createElement("span",{className:"message-transfer-progress"},Math.round(100*Te),"%"),a.Ay.createElement(C.A,{isOpen:ye,onClose:ve,shouldAlwaysShow:Ee,onAlwaysShowChanged:be,confirmHandler:Ie}))}))},52844:(e,t,n)=>{"use strict";let a;function s(e="*",t,n=!1){a||(a=document.createElement("input"),a.setAttribute("type","file")),a.setAttribute("accept",e),n?a.removeAttribute("multiple"):a.setAttribute("multiple","multiple"),a.onchange=null,a.value="",a.onchange=t,a.click()}n.d(t,{p:()=>s})},52988:(e,t,n)=>{"use strict";n.d(t,{A:()=>f});var a=n(84051),s=n(96454),o=n(87357),r=n(17663),i=n(91525),l=n(76023),c=n(4961),d=n(43874),m=n(45470),u=n(83057),p=n(59030),h=n(50680),g=n(96530),A=n(35913),y=n(54746);const f=(0,a.ph)(({ref:e,name:t,size:n,extension:f="",timestamp:v,sender:E,thumbnailDataUri:b,previewData:x,className:w,smaller:C,isTransferring:N,isUploading:I,isSelectable:S,isSelected:M,transferProgress:k,actionIcon:T,onClick:P,onSelect:L,onDateClick:B})=>{const R=(0,p.A)();let F=(0,a.li)();e&&(F=e);const{isMobile:D}=(0,d.Ay)(),[O]=(0,a.J0)(!x),z=Boolean(x),j=(0,m.A)(b,z,D&&!s.QH),U=(0,u.A)(!z),{shouldRender:V,transitionClassNames:J}=(0,h.A)(N,void 0,!0),H=(0,i.fE)(f),K=(0,i.zV)(n),$=(0,a.Kr)(()=>N&&k?`${(0,i.zV)(n*k)} / ${K}`:K,[N,n,K,k]),{width:G,height:_}=(0,l.tP)(C),q=(0,o.A)("File",w,C&&"smaller",P&&!I&&"interactive",M&&"file-is-selected");return a.Ay.createElement("div",{ref:F,className:q,dir:R.isRtl?"rtl":void 0,onClick:L},S&&a.Ay.createElement("div",{className:"message-select-control no-selection"},M&&a.Ay.createElement(y.A,{name:"select"})),a.Ay.createElement("div",{className:"file-icon-container",onClick:I?void 0:P},b||x?a.Ay.createElement("div",{className:"file-preview media-inner"},a.Ay.createElement("img",{src:x,className:"full-media",width:G,height:_,draggable:!1,alt:""}),O&&a.Ay.createElement("canvas",{ref:j,className:(0,o.A)("thumbnail",U)})):a.Ay.createElement("div",{className:`file-icon ${H}`},f.length<=4&&a.Ay.createElement("span",{className:"file-ext",dir:"auto"},f)),V&&a.Ay.createElement("div",{className:(0,o.A)("file-progress",H,J)},a.Ay.createElement(A.A,{progress:k,size:C?"s":"m",onClick:I?P:void 0})),P&&a.Ay.createElement(y.A,{name:T||"download",className:(0,o.A)("action-icon",V&&"hidden")})),a.Ay.createElement("div",{className:"file-info"},a.Ay.createElement("div",{className:"file-title",dir:"auto",title:t},(0,c.A)(t)),a.Ay.createElement("div",{className:"file-subtitle",dir:"auto"},a.Ay.createElement("span",null,$),E&&a.Ay.createElement("span",{className:"file-sender"},(0,c.A)(E)),!E&&Boolean(v)&&a.Ay.createElement(a.Ay.Fragment,null,a.Ay.createElement("span",{className:"bullet"}),a.Ay.createElement(g.A,{onClick:B},(0,r.fS)(R,1e3*v,!0))))),E&&Boolean(v)&&a.Ay.createElement(g.A,{onClick:B},(0,r.be)(R,1e3*v)))})},53188:(e,t,n)=>{"use strict";n.d(t,{A:()=>L});var a=n(84051),s=n(31481),o=n(66644),r=n(90709),i=n(70636),l=n(87357),c=n(4961),d=n(18501),m=n(79882),u=n(35749),p=n(2338),h=n(21488),g=n(62587),A=n(59030),y=n(13439),f=n(76023),v=n(43874),E=n(11217),b=n(38102);const x="CBda1UmC",w="BhS75ocD",C="uWo2dhui",N="g3XnC73g",I=Number(f.$),S=(0,a.ph)(({chat:e,topics:t,renderLastMessage:n,observeIntersection:s})=>{const{openThread:o}=(0,y.ko)(),i=(0,a.li)(),d=(0,a.li)(),m=(0,A.A)(),[u,...p]=(0,a.Kr)(()=>t?(0,r.CO)(Object.values(t),void 0,!0).slice(0,3):[],[t]),[h,g]=(0,a.J0)(!1),[f,S]=(0,a.J0)(void 0),{handleClick:M,handleMouseDown:k}=(0,E.Q)(t=>{0===u.unreadCount||e.isForumAsMessages||(t.stopPropagation(),t.preventDefault(),o({chatId:e.id,threadId:u.id,shouldReplaceHistory:!0,noForumTopicPanel:(0,v.Ny)()}))});return(0,a.vJ)(()=>{const e=i.current,t=d.current;if(!e||!t)return;const n=e.offsetWidth,a=t.offsetWidth;Math.abs(n-a)<I?S(Math.max(n,a)):S(void 0),g(n>a)},[u,n]),a.Ay.createElement("div",{className:(0,l.A)("Ow6Ij9O5",h&&"U_yhhC0w",f&&"HV0wCR4O"),dir:m.isRtl?"rtl":void 0,style:f?`--overwritten-width: ${f}px`:void 0},u&&a.Ay.createElement("div",{className:x},a.Ay.createElement("div",{className:(0,l.A)("lEbV6HrI",u.unreadCount&&w),ref:d,onClick:M,onMouseDown:k},a.Ay.createElement(b.A,{topic:u,observeIntersection:s}),a.Ay.createElement("div",{className:"k3Ch25ZQ"},(0,c.A)(u.title)),!f&&h&&a.Ay.createElement("div",{className:C},a.Ay.createElement("div",{className:N}))),a.Ay.createElement("div",{className:"IkuCBmvA"},p.map(e=>a.Ay.createElement("div",{className:(0,l.A)("d0hTIVJn",e.unreadCount&&w),key:e.id},a.Ay.createElement(b.A,{topic:e,className:"oknhG11L",observeIntersection:s}),a.Ay.createElement("span",{className:"ZUj3xAjs"},(0,c.A)(e.title))))),a.Ay.createElement("div",{className:"_m_2xcPW"})),!u&&a.Ay.createElement("div",{className:(0,l.A)(x,"L4Zk0yMN")},m("Loading")),a.Ay.createElement("div",{className:(0,l.A)("KJ16dBus",u?.unreadCount&&w),ref:i,onClick:M,onMouseDown:k},n(),!f&&!h&&a.Ay.createElement("div",{className:C},a.Ay.createElement("div",{className:N}))))});var M=n(54746),k=n(18653),T=n(80477);const P=200;function L({chat:e,topics:t,lastMessage:n,statefulMediaContent:y,chatId:f,typingStatus:v,draft:E,lastMessageTopic:b,lastMessageSender:x,observeIntersection:w,animationType:C,orderDiff:N,withInterfaceAnimations:I,isTopic:L,isSavedDialog:B,isPreview:R}){const F=(0,A.A)(),D=(0,a.li)(),O=n?.content.storyData,z=y&&!y.story;(0,h.A)(z?O?.peerId:void 0,O?.id,y?.story);const j=y?.story||n,U=j&&!(0,r.fP)(j),V=(0,p.A)(j),J=U?V:void 0,H=(0,u.A)(j,"micro"),K=(0,g.A)(U?H:void 0),$=Boolean(n&&(0,r.lk)(n)),G=(0,a.hb)(()=>{if(!B&&!R&&v&&n&&v.timestamp>1e3*n.date)return a.Ay.createElement(T.A,{typingStatus:v});const t=E&&E.replyInfo?.replyToMsgId===b?.id,s=E?.replyInfo&&!E.text&&E.isLocal;if(!e?.isForum&&!B&&!R&&E&&!s&&(!L||!t))return a.Ay.createElement("p",{className:"last-message",dir:F.isRtl?"auto":"ltr"},a.Ay.createElement("span",{className:"draft"},F("Draft")),a.Ay.createElement("span",{className:"last-message-summary",dir:"auto"},(0,d.fd)({text:E.text?.text||"",entities:E.text?.entities,asPreview:!0,withTranslucentThumbs:!0})));if(!n)return;const o=x?(0,i.Q5)(F,f,x):void 0;return a.Ay.createElement("p",{className:"last-message shared-canvas-container",dir:F.isRtl?"auto":"ltr"},o&&a.Ay.createElement(a.Ay.Fragment,null,a.Ay.createElement("span",{className:"sender-name"},(0,c.A)(o)),a.Ay.createElement("span",{className:"colon"},":")),!B&&n.forwardInfo&&a.Ay.createElement(M.A,{name:"share-filled",className:"chat-prefix-icon"}),"story"===n.replyInfo?.type&&a.Ay.createElement(M.A,{name:"story-reply",className:"chat-prefix-icon"}),a.Ay.createElement("span",{className:"last-message-summary",dir:"auto"},function(e,t,n,s){const o=a.Ay.createElement(k.A,{message:e,noEmoji:Boolean(n),observeIntersectionForLoading:t,inChatList:!0});if(!n)return o;const i=(0,r.y2)(e);return a.Ay.createElement("span",{className:"media-preview"},a.Ay.createElement("img",{src:n,alt:"",className:(0,l.A)("media-preview--image",s&&"round",i&&"media-preview-spoiler"),draggable:!1}),(0,r.zX)(e)&&a.Ay.createElement(M.A,{name:"play"}),o)}(n,w,K||J,$)))},[e,f,E,$,L,F,n,x,b,K,J,w,v,B,R]);return(0,a.Nf)(()=>{const e=D.current;if(I&&e){if(C===m.I.Opacity)e.style.opacity="0",(0,o.RK)(()=>{e.classList.add("animate-opacity"),e.style.opacity="1"});else{if(C!==m.I.Move)return;e.style.transform=`translate3d(0, ${-N*s.yq1}px, 0)`,(0,o.RK)(()=>{e.classList.add("animate-transform"),e.style.transform=""})}setTimeout(()=>{(0,o.RK)(()=>{e.classList.remove("animate-opacity","animate-transform"),e.style.opacity="",e.style.transform=""})},P+s.xB5)}},[I,N,C]),{renderSubtitle:function(){return e?.isForum&&!L?a.Ay.createElement(S,{chat:e,renderLastMessage:G,observeIntersection:w,topics:t}):G()},ref:D}}},53827:(e,t,n)=>{"use strict";n.d(t,{_K:()=>A,dj:()=>v,kz:()=>y});var a=n(13439),s=n(89925),o=n(66644),r=n(60919),i=n(96454),l=n(60343),c=n(80853),d=n(41733);const m=new Map;let u,p=[],h=[];function g(e,t){const n=u&&m.get(u);n&&(n.audio.pause(),n.audio.currentTime=0,n.onTrackChange&&n.onTrackChange());const o=f(e,(0,r.nTw)((0,a.mS)()).audioPlayer.origin||s.d9.Inline,t);if(!o)return;if(!m.has(o))return void(0,a.ko)().openAudioPlayer((0,l.ES)(E(o).messageKey));const i=m.get(o);i.onForcePlay&&i.onForcePlay(),u=o,i.audio.src&&(0,d.A)(i.audio)}function A(){const e=u&&m.get(u);e&&e.audio.pause()}function y(e,t,n,A,y){if(!m.has(e)){const n=function(e,t,n,a){const s=new Audio;function o(t){return n=>{m.has(e)&&((0,c.f)(s)||m.get(e).handlers.forEach(e=>{e(t,n)}))}}return s.addEventListener("timeupdate",o("onTimeUpdate")),s.addEventListener("play",o("onPlay")),s.addEventListener("pause",o("onPause")),s.addEventListener("loadstart",o("onLoadStart")),s.addEventListener("loadeddata",o("onLoadedData")),s.addEventListener("playing",o("onPlaying")),s.addEventListener("ended",()=>{m.has(e)&&((0,c.f)(s)||g(e))}),{audio:s,type:t,proxy:new Proxy(s,{get:(e,t)=>e[t]}),handlers:[],onForcePlay:n,onTrackChange:a}}(e,t,A,y);m.set(e,n),function(e,t){"audio"!==e.type||h.includes(t)||(h.push(t),h.sort(b)),"voice"!==e.type||p.includes(t)||(p.push(t),p.sort(b))}(n,e)}const{audio:v,proxy:x,handlers:w}=m.get(e);return w.push(n),{play(n){if(!v.paused)return;const o=u&&m.get(u);o&&u!==e&&(o.audio.pause(),o.audio.currentTime=0,(0,c.f)(o.audio)&&(o.audio.dataset.preventPlayAfterPatch="true"),o.onTrackChange&&o.onTrackChange()),u=e,v.src||(v.src=n,v.preload="auto",n.includes("/progressive/")&&i.Yw&&(delete v.dataset.preventPlayAfterPatch,(0,c.C)(v))),(0,d.A)(v),function(e,t){if((0,r.nTw)((0,a.mS)()).globalSearch.currentContent===s.$C.Music)return;const{chatId:n}=(0,l.ES)(E(t).messageKey),o=(0,r.Xf0)((0,a.mS)())?.chatId,i=e=>e.startsWith(`msg${n}`)||o&&e.startsWith(`msg${o}`);"audio"===e&&(h=h.filter(i)),"voice"===e&&(p=p.filter(i))}(t,e)},pause(){u===e&&v.pause()},stop(){if(u===e){const e=v.src;v.pause(),(0,o.Uz)(()=>{v.src="",v.src=e})}},setCurrentTime(t){u===e&&(v.fastSeek?v.fastSeek(t):v.currentTime=t)},setVolume(t){u===e&&(v.volume=t,v.muted=!1)},setPlaybackRate(t){u===e&&(v.playbackRate=t)},toggleMuted(e){v.muted=void 0===e?!v.muted:e},proxy:x,requestNextTrack(){g(e)},isLast:()=>!f(e,(0,r.nTw)((0,a.mS)()).audioPlayer.origin),isFirst:()=>!f(e,(0,r.nTw)((0,a.mS)()).audioPlayer.origin,!0),requestPreviousTrack(){g(e,!0)},destroy(t=!1){const a=m.get(e);a&&(a.handlers=a.handlers.filter(e=>e!==n),a.handlers.length||(a.audio.pause(),m.delete(e),t&&function(e,t){const n=e=>e!==t;"audio"===e.type&&(h=h.filter(n)),"voice"===e.type&&(p=p.filter(n))}(a,e),e===u&&(u=void 0)))}}}function f(e,t=s.d9.Inline,n){const a=function(e){switch(e.type){case"audio":return h;case"voice":return p;default:return}}(m.get(e));if(!a)return;if(t===s.d9.Search){const t=a.indexOf(e);if(t<0)return;return a[t+(n?-1:1)]}const{chatId:o}=(0,l.ES)(E(e).messageKey),r=a.filter(e=>e.startsWith(`msg${o}`)),i=r.indexOf(e);if(i<0)return;let c=t===s.d9.Inline?-1:1;return n&&(c*=-1),r[i+c]}function v(e){const t=(0,l.AD)(e);if(t)return`${t}-${e.date}`}function E(e){return{messageKey:e.match(/^msg(-?\d+)-(\d+)/)[0],date:Number(e.split("-").pop())}}function b(e,t){if(!e||!t)return 0;const{date:n,messageKey:a}=E(e),{date:s,messageKey:o}=E(t),r=s-n;return 0===r?o.localeCompare(a):r}},54172:(e,t,n)=>{"use strict";n.d(t,{A:()=>Zn});var a=n(84051),s=n(13439),o=n(23174),r=n(89925),i=n(31481),l=n(90709),c=n(70636),d=n(26129),m=n(60919),u=n(56494),p=n(30708),h=n(96454),g=n(87357),A=n(9716),y=n(60343),f=n(80140),v=n(83868),E=n(41512),b=n(46942),x=n.n(b),w=n(72531),C=n(7971),N=n(81120),I=n(85325),S=n(80395),M=n(48799),k=n(8063),T=n(60160),P=n(17712),L=n(8235);const B="w-[20px] h-[20px] text-[16px] cursor-pointer flex items-center justify-center",R=(0,a.ph)((0,s.EK)((e,{message:t,messageListType:n,detectedLanguage:a})=>{const s=(0,l.Ie)(t),o=(0,l.XR)(t),r=(0,C.aT)(t),i="pinned"===n,c="scheduled"===n,d=(0,m.hds)(e,t.chatId),u=d&&(0,A.L8)(d.id)?void 0:(0,m.AWZ)(e,t.chatId),{threadId:p}=(0,m.Xf0)(e)||{},{canReplyGlobally:h}=p&&(0,m.WAX)(e,t,p)||{},g=d&&!(0,l.Sq)(d,"sendPlain",u),y=(0,m.Rny)(e,t.chatId,t.id);return{message:t,canScheduleMeeting:!s&&o,canAISummarize:r,canSmartReply:!s&&!i&&!c&&h&&g&&o,canTranslate:!(y?Boolean((0,m.a_$)(e,t.chatId,y)[t.id]?.text):void 0)&&(0,m.S86)(e,t,a)}})(({message:e,position:t,canScheduleMeeting:n,canAISummarize:o,canSmartReply:r,canTranslate:i})=>{const c=n||o||r||i,[d,m]=(0,a.J0)(!1),u=(0,P.A)(()=>{if(d)return;m(!0);const t=e.chatId,n=(0,l.r_)(e)?.text?.text||"",a=k.Ay.create({chatId:t}),s=(0,S.IM)(),o=()=>{a.start({chatId:t,text:n}),setTimeout(()=>m(!1),2e3)};s&&(0,S.G6)(s)?o():(0,I.wG)({onOk:o,onCancel:()=>m(!1)})}),p=(0,P.A)(async()=>{if(e.content.text?.text){(0,s.ko)().updateDraftReplyInfo({replyToMsgId:e.id,replyToPeerId:void 0,quoteText:void 0,quoteOffset:void 0});const t=(await T.Xt.similaritySearch({query:e.content.text?.text})).similarItems[0];t&&t.score>.8?w.A.emit("update-input-text",t.metadata.answer):(w.A.emit("update-input-spiner",!0),(0,N.g4)({data:{messages:[{role:"system",content:"你是一个多语种智能助手。接收用户消息后，自动识别其使用的语言，并用相同的语言进行自然、得体的回复。你应该理解消息的语境，确保回复简洁、友好且符合语言习惯。",id:"1"},{role:"user",content:`请回复下面的消息: ${e.content.text?.text}`,id:"2"}]},onResponse:e=>{w.A.emit("update-input-text",e)},onFinish:()=>{console.log("Finish")}}))}}),h=(0,P.A)(async()=>{const{photo:t,document:n,webPage:a,voice:o,audio:r,text:i,video:l}=e.content,c=(0,C.Ah)(i?.text);await(0,s.ko)().openChatAIWithInfo({chatId:e.chatId}),t?(0,C.tg)(e):a&&!i?.text||c?(0,C.ur)(e):n?(0,C.mu)(e):o?(0,C._b)(e):r?(0,C.LW)(e):l&&(0,C.Al)(e)}),g=(0,P.A)(()=>{(0,s.ko)().requestMessageTranslation({chatId:e.chatId,id:e.id})});if(c)return a.Ay.createElement("div",{className:x()("message-gpt-menu","top"===t?"top-[-32px]":"bottom-[-32px]")},a.Ay.createElement("div",{className:"message-gpt-menu-inner"},a.Ay.createElement("div",{className:x()("!cursor-auto",B)},a.Ay.createElement("img",{className:"w-[20px] h-[20px] mt-[-4px]",src:L,alt:""})),i&&a.Ay.createElement("div",{className:B,onClick:g,title:"Translate"},a.Ay.createElement(M.wE,{size:16})),n&&a.Ay.createElement("div",{className:B,onClick:u,title:"Schedule meeting"},a.Ay.createElement(M.Nn,{size:16})),o&&a.Ay.createElement("div",{className:B,onClick:h,title:"Summarize"},a.Ay.createElement(M.hD,{size:16})),r&&a.Ay.createElement("div",{className:B,onClick:p,title:"Smart Reply"},a.Ay.createElement(M.o9,{size:16}))))}));var F=n(76023),D=n(35049),O=n(4961),z=n(58734);function j(e){if(!e||1!==e.extendedMedia.length)return{photo:void 0,video:void 0};const t=e.extendedMedia[0],n="mediaType"in t;return{photo:n?t.duration?void 0:t:t.photo,video:n?t.duration?t:void 0:t.video}}var U=n(43336),V=n(35127);function J(e,t){return e.reduce((e,t)=>e+t,t)}function H(e){const t={width:0,height:0};return e.forEach(({dimensions:e,sides:n})=>{2&n&&(t.width=e.width+e.x),4&n&&(t.height=e.height+e.y)}),t}function K(e,t,n,a){const s=function(e,t,n){const a=e[0].isOutgoing,s=(t?e[0].content.paidMedia.extendedMedia.map(e=>"mediaType"in e?e:e.photo||e.video):e.map(e=>(0,l.r_)(e).photo||(0,l.r_)(e).video)).filter(Boolean);return s.map(e=>{const t=(0,V.yA)({media:e,isOwn:a,isMobile:n});return t.width/t.height})}(n.messages,n.isPaidMedia,a),o=function(e){return e.map(e=>e>1.2?"w":e<.8?"n":"q").join("")}(s),r=function(e){return e.reduce((e,t)=>t+e,1)/e.length}(s),i=s.length,c=s.some(e=>e>2),d=(0,F.w4)(e,!1,t,a);let m;const u={ratios:s,proportions:o,averageRatio:r,maxWidth:d,minWidth:100,maxHeight:d,spacing:2};return m=i>=5||c?function({ratios:e,averageRatio:t,maxWidth:n,minWidth:a,spacing:s,maxHeight:o=4*n/3}){const r=function(e,t){return e.map(e=>t>1.1?(0,U.qE)(e,1,2.75):(0,U.qE)(e,.6667,1))}(e,t),i=e.length,l=new Array(i),c=[],d=e=>{const t=[];let a=0;e.forEach(e=>{t.push(((e,t)=>{const a=J(r.slice(e,e+t),0);return(n-(t-1)*s)/a})(a,e)),a+=e}),c.push({lineCounts:e,heights:t})};for(let e=1;e!==i;++e){const t=i-e;e<=3&&t<=3&&d([e,t])}for(let e=1;e!==i-1;++e)for(let n=1;n!==i-e;++n){const a=i-e-n;e<=3&&n<=(t<.85?4:3)&&a<=3&&d([e,n,a])}for(let e=1;e!==i-1;++e)for(let t=1;t!==i-e;++t)for(let n=1;n!==i-e-t;++n){const a=i-e-t-n;e<=3&&t<=3&&n<=3&&a<=4&&d([e,t,n,a])}let m,u=0;for(let e=0;e<c.length;e++){const{heights:t,lineCounts:n}=c[e],r=n.length,i=J(t,0)+s*(r-1),l=Math.min(...t)<a?1.5:1,d=(()=>{for(let e=1;e!==r;++e)if(n[e-1]>n[e])return 1.5;return 1})(),p=Math.abs(i-o)*l*d;(!m||p<u)&&(m=c[e],u=p)}const p=m.lineCounts,h=m.heights,g=p.length;let A=0,y=0;for(let e=0;e!==g;++e){const t=p[e],a=h[e],o=Math.round(a);let i=0;for(let c=0;c!==t;++c){const d=0|(0===e?1:0)|(e===g-1?4:0)|(0===c?8:0)|(c===t-1?2:0),m=r[A],u=c===t-1?n-i:Math.round(m*a);l[A]={dimensions:{x:i,y,width:u,height:o},sides:d},i+=u+s,++A}y+=o+s}return l}(u):2===i?function(e){const{ratios:t,proportions:n,averageRatio:a}=e;return"ww"===n&&a>1.4&&t[1]-t[0]<.2?function(e){const{ratios:t,maxWidth:n,spacing:a,maxHeight:s}=e,o=Math.round(Math.min(n/t[0],Math.min(n/t[1],(s-a)/2)));return[{dimensions:{x:0,y:0,width:n,height:o},sides:11},{dimensions:{x:0,y:o+a,width:n,height:o},sides:14}]}(e):"ww"===n||"qq"===n?function(e){const{ratios:t,maxWidth:n,spacing:a,maxHeight:s}=e,o=(n-a)/2,r=Math.round(Math.min(o/t[0],Math.min(o/t[1],s)));return[{dimensions:{x:0,y:0,width:o,height:r},sides:13},{dimensions:{x:o+a,y:0,width:o,height:r},sides:7}]}(e):function(e){const{ratios:t,minWidth:n,maxWidth:a,spacing:s,maxHeight:o}=e,r=Math.round(1.5*n),i=Math.min(Math.round(Math.max(.4*(a-s),(a-s)/t[0]/(1/t[0]+1/t[1]))),a-s-r),l=a-i-s,c=Math.min(o,Math.round(Math.min(l/t[0],i/t[1])));return[{dimensions:{x:0,y:0,width:l,height:c},sides:13},{dimensions:{x:l+s,y:0,width:i,height:c},sides:7}]}(e)}(u):3===i?function(e){const{proportions:t}=e;return"n"===t[0]?function(e){const{maxHeight:t,spacing:n,ratios:a,maxWidth:s,minWidth:o}=e,r=t,i=Math.round(Math.min((t-n)/2,a[1]*(s-n)/(a[2]+a[1]))),l=r-i-n,c=Math.max(o,Math.round(Math.min((s-n)/2,Math.min(i*a[2],l*a[1])))),d=Math.min(Math.round(r*a[0]),s-n-c);return[{dimensions:{x:0,y:0,width:d,height:r},sides:13},{dimensions:{x:d+n,y:0,width:c,height:l},sides:3},{dimensions:{x:d+n,y:l+n,width:c,height:i},sides:6}]}(e):function(e){const{maxWidth:t,ratios:n,maxHeight:a,spacing:s}=e,o=t,r=Math.round(Math.min(o/n[0],.66*(a-s))),i=(t-s)/2,l=Math.min(a-r-s,Math.round(Math.min(i/n[1],i/n[2])));return[{dimensions:{x:0,y:0,width:o,height:r},sides:11},{dimensions:{x:0,y:r+s,width:i,height:l},sides:12},{dimensions:{x:i+s,y:r+s,width:o-i-s,height:l},sides:6}]}(e)}(u):function(e){const{proportions:t}=e;return"w"===t[0]?function({maxWidth:e,ratios:t,spacing:n,maxHeight:a,minWidth:s}){const o=e,r=Math.round(Math.min(o/t[0],.66*(a-n))),i=Math.round((e-2*n)/(t[1]+t[2]+t[3])),l=Math.max(s,Math.round(Math.min(.4*(e-2*n),i*t[1]))),c=Math.round(Math.max(Math.max(s,.33*(e-2*n)),i*t[3])),d=o-l-c-2*n,m=Math.min(a-r-n,i);return[{dimensions:{x:0,y:0,width:o,height:r},sides:11},{dimensions:{x:0,y:r+n,width:l,height:m},sides:12},{dimensions:{x:l+n,y:r+n,width:d,height:m},sides:4},{dimensions:{x:l+n+d+n,y:r+n,width:c,height:m},sides:6}]}(e):function({maxHeight:e,ratios:t,maxWidth:n,spacing:a,minWidth:s}){const o=e,r=Math.round(Math.min(o*t[0],.6*(n-a))),i=Math.round((e-2*a)/(1/t[1]+1/t[2]+1/t[3])),l=Math.round(i/t[1]),c=Math.round(i/t[2]),d=o-l-c-2*a,m=Math.max(s,Math.min(n-r-a,i));return[{dimensions:{x:0,y:0,width:r,height:o},sides:13},{dimensions:{x:r+a,y:0,width:m,height:l},sides:3},{dimensions:{x:r+a,y:l+a,width:m,height:c},sides:2},{dimensions:{x:r+a,y:l+c+2*a,width:m,height:d},sides:6}]}(e)}(u),{layout:m,containerStyle:H(m)}}var $=n(43874),G=n(10722),_=n(49746),q=n(21488),W=n(37661),Q=n(5912),Y=n(39351),Z=n(59030),X=n(73767),ee=n(14622),te=n(34201),ne=n(9705),ae=n(5130);let se;const oe=new ne.A;h.CM&&setTimeout(function(){se||(se=(0,ae.U)(new Worker(new URL(n.p+n.u(8590),n.b))),oe.resolve())},4e3);var re=n(84947),ie=n(37836);const le=new Map;const ce=(0,ie.nF)(function(e){const{updateChatDetectedLanguage:t}=(0,s.ko)(),n=le.get(e);if(!n)return;const a=n.size;if(a<8)return;let o=0,r=0;const i=new Map;for(const e of n.values()){e.isTranslatable&&o++,e.detectedLanguage&&r++;const t=e.detectedLanguage;if(t){const e=i.get(t)||0;i.set(t,e+1)}}if(o/a<.3||r/o<.6)return;t({chatId:e,detectedLanguage:Array.from(i.entries()).sort(([,e],[,t])=>t-e)[0][0]})},1e3);var de=n(79519),me=n(46275),ue=n(64154),pe=n(66644),he=n(50442),ge=n(43503),Ae=n(54464),ye=n(672);const fe=3*F.$,ve=Number(F.$),Ee="data-is-document-group-hover";function be(e,t,n,o,r,i,l,c,d,m,u,p,g){const{updateDraftReplyInfo:A,sendDefaultReaction:y}=(0,s.ko)(),[f,E,b]=(0,W.A)(),[x,w,C]=(0,W.A)(),N=(0,a.li)(),I=(0,ye.A)(e=>{const t=u.current;if(!t)return;const{clientX:n,clientY:a}=e,{x:s,width:o,y:r,height:i}=t.getBoundingClientRect(),l=s+o/2,c=r+i/2,d=Math.abs(l-n)<fe,m=Math.abs(c-a)<ve;d&&m?E():b()},[u],pe.YS);return(0,a.vJ)(()=>{if(!h.TF||o||!r||m||!g?.())return;let e;return(0,he.wJ)(t.current,{selectorToPreventScroll:".MessageList",excludedClosestSelector:".no-word-wrap",onSwipe:(t,n)=>n===he.ez.Left&&(e||(e=Date.now()),w(),!0),onRelease:()=>{e&&r&&(A({replyToMsgId:n}),setTimeout(C,Math.max(0,150-(Date.now()-e))),e=void 0)}})},[t,o,n,w,C,r,m,g]),{handleMouseDown:o?void 0:function(e){(0,Ae.l)(e),c(e)},handleClick:function(t){if(o)e(t);else if(h.TF)return N.current?(clearInterval(N.current),N.current=void 0,void y({chatId:d,messageId:n})):void(N.current=setTimeout(()=>{N.current=void 0,function(e){if(h.Ni){const t=e.target;if(!t.classList.contains("text-content")&&!t.classList.contains("Message"))return;ge.A.getIsKeyboardVisible()?setTimeout(()=>{l(e)},350):l(e)}}(t)},200))},handleContextMenu:o?i?v.A:void 0:function(t){if(h.Ni){if(t.target.matches("a[href]")||m)return;t.preventDefault(),e()}else l(t)},handleDoubleClick:o?void 0:function(){!h.TF&&r&&A({replyToMsgId:n,replyToPeerId:void 0,quoteText:void 0,quoteOffset:void 0})},handleContentDoubleClick:h.TF?void 0:function(e){e.stopPropagation()},handleMouseMove:I,handleSendQuickReaction:function(e){e.stopPropagation(),y({chatId:d,messageId:n})},handleMouseLeave:function(e){(0,pe.YS)(b),p&&function(e){const t=we(e.currentTarget);t&&t.removeAttribute(Ee)}(e)},isSwiped:x,isQuickReactionVisible:f,handleDocumentGroupMouseEnter:xe}}function xe(e){const t=we(e.currentTarget);t&&t.setAttribute(Ee,"")}function we(e){let t=e;do{t=t.nextElementSibling}while(t&&!t.classList.contains("last-in-document-group"));return t}var Ce=n(65240),Ne=n(21849),Ie=n(87412),Se=n(44589),Me=n(80999),ke=n(91930),Te=n(11217),Pe=n(62587),Le=n(54746),Be=n(86070);const Re=({story:e,sender:t,noUserColors:n,isProtected:o,observeIntersectionForLoading:r,onClick:i})=>{const{showNotification:d}=(0,s.ko)(),m=(0,Z.A)(),u=(0,a.li)(),p=(0,Q.Vz)(u,r),h=e&&"content"in e,A=e&&"isDeleted"in e,y=h&&Boolean(e.content.video),f=h?"Story":A?"ExpiredStory":"Loading",v=(0,Pe.A)(h&&(0,l.EN)(e,"pictogram"),!p),E=y?e.content.video.thumbnail?.dataUri:void 0,b=v||E,x=t?(0,c.F9)(m,t):void 0,w=(0,P.A)(()=>{e&&!A?i():d({message:m("StoryNotFound")})}),{handleClick:C,handleMouseDown:N}=(0,Te.Q)(w);return a.Ay.createElement(Be.A,{ref:u,peerColor:t?.color,noUserColors:n,shouldReset:!0,className:(0,g.A)("EmbeddedMessage",b&&"with-thumb"),onClick:C,onMouseDown:N},b&&function(e,t){const{width:n,height:s}=(0,F.mr)();return a.Ay.createElement("div",{className:"embedded-thumb"},a.Ay.createElement("img",{src:e,width:n,height:s,alt:"",className:"pictogram",draggable:!1}),t&&a.Ay.createElement("span",{className:"protector"}))}(b,o),a.Ay.createElement("div",{className:"message-text with-message-color"},a.Ay.createElement("p",{className:"embedded-text-wrapper"},A&&a.Ay.createElement(Le.A,{name:"story-expired",className:"embedded-origin-icon"}),h&&a.Ay.createElement(Le.A,{name:"story-reply",className:"embedded-origin-icon"}),m(f)),a.Ay.createElement("div",{className:"message-title"},(0,O.A)(x||" "))))};var Fe=n(2578),De=n(9267),Oe=n(74936),ze=n(17794),je=n(90603),Ue=n(38102);var Ve=n(61911);const Je=1.125*F.$,He=(0,a.ph)(({topic:e,className:t,onClick:n})=>{const s=(0,Z.A)();return a.Ay.createElement("div",{className:(0,g.A)("JldIqqof",t),style:`--topic-button-accent-color: var(${(0,je.Mt)(e?.iconColor)})`,onClick:n},e?a.Ay.createElement(Ue.A,{topic:e,size:Je}):a.Ay.createElement("img",{src:Ve,alt:"",draggable:!1}),e?.title?(0,O.A)(e.title):s("Loading"),e?.isClosed&&a.Ay.createElement(Le.A,{name:"lock"}),a.Ay.createElement(Le.A,{name:"next"}))});var Ke=n(15006),$e=n(64493),Ge=n(94189),_e=n(40664);function qe(e){return(0,a.ph)((0,s.EK)((e,t)=>{const{clickArg:n,noSelectControls:a}=t;return{isInSelectMode:!a&&(0,m.rTV)(e),isSelected:!a&&(0,m.H1_)(e,n)}})(t=>{const{isInSelectMode:n,isSelected:o,dimensions:r,clickArg:i}=t,{toggleMessageSelection:l}=(0,s.ko)(),c=(0,P.A)(e=>{e.stopPropagation(),l({messageId:i,withShift:e?.shiftKey})}),d=(0,a.Kr)(()=>{const{dimensions:e,onClick:a}=t;return{...t,isInSelectMode:n,isSelected:o,dimensions:{...e,x:0,y:0},onClick:n?void 0:a}},[t,n,o]);return a.Ay.createElement("div",{className:(0,g.A)("album-item-select-wrapper",o&&"is-selected"),style:r?`left: ${r.x}px; top: ${r.y}px;`:"",onClick:n?c:void 0},n&&a.Ay.createElement("div",{className:"message-select-control"},o&&a.Ay.createElement(Le.A,{name:"select"})),a.Ay.createElement(e,d))}))}var We=n(51644),Qe=n(25477);const Ye=qe(We.A),Ze=qe(Qe.A),Xe=(0,s.EK)(e=>{const t=(0,m.SJA)(e),n=(0,m.yuw)(e);return{theme:t,uploadsByKey:e.fileUploads.byMessageKey,activeDownloads:n}})(({album:e,observeIntersection:t,hasCustomAppendix:n,isOwn:o,isProtected:r,albumLayout:i,onMediaClick:c,uploadsByKey:d,activeDownloads:u,theme:p})=>{const{cancelUploadMedia:h}=(0,s.ko)(),{content:{paidMedia:g}}=e.mainMessage,A=e.isPaidMedia?g.extendedMedia.length:e.messages.length,f=(0,P.A)(t=>{c(e.mainMessage.id,t)}),v=(0,P.A)(e=>{c(e)}),E=(0,P.A)(t=>{h({chatId:e.mainMessage.chatId,messageId:t})}),b=(0,a.Kr)(()=>e.isPaidMedia?e.mainMessage.content.paidMedia.extendedMedia.map(()=>e.mainMessage):e.messages,[e]),{width:x,height:w}=i.containerStyle;return a.Ay.createElement("div",{className:"Album",style:`width: ${x}px; height: ${w}px;`},b.map(function(c,h){const g=e.isPaidMedia?c.content.paidMedia?.extendedMedia[h]:void 0,b=g&&"mediaType"in g?g:g?.photo,x=g&&"mediaType"in g?g:g?.video,w=b||(0,l.yl)(c),C=x||(0,l.r_)(c).video,N=d[(0,y.bj)(c)],I=N?.progress,{dimensions:S,sides:M}=i.layout[h],k=(0,m.wwb)((0,s.mS)(),c),T=(0,m.OEt)((0,s.mS)(),c);if(w){const s=n&&(o?h===A-1:Boolean(8&M&&4&M));return a.Ay.createElement(Ye,{id:`album-media-${(0,l.GZ)(c.id,e.isPaidMedia?h:void 0)}`,photo:w,isOwn:o,observeIntersectionForLoading:t,canAutoLoad:k,shouldAffectAppendix:s,uploadProgress:I,dimensions:S,isProtected:r,clickArg:e.isPaidMedia?h:c.id,onClick:e.isPaidMedia?f:v,onCancelUpload:E,isDownloading:"extendedMediaPreview"!==w.mediaType&&(0,l.$r)(u,w),theme:p,noSelectControls:e.isPaidMedia})}if(C)return a.Ay.createElement(Ze,{id:`album-media-${(0,l.GZ)(c.id)}`,video:C,observeIntersectionForLoading:t,canAutoLoad:k,canAutoPlay:T,uploadProgress:I,dimensions:S,isProtected:r,clickArg:e.isPaidMedia?h:c.id,onClick:e.isPaidMedia?f:v,onCancelUpload:E,isDownloading:"extendedMediaPreview"!==C.mediaType&&(0,l.$r)(u,C),theme:p,noSelectControls:e.isPaidMedia})}))});var et=n(95807),tt=n(41733);const nt=7*F.$;function at(e,t,n,o,r,i,l){const{interactWithAnimatedEmoji:c,sendEmojiInteraction:d,sendWatchingEmojiInteraction:m}=(0,s.ko)(),u=(0,a.li)(),p=(0,a.li)(),g=(0,Pe.A)(n?`document${n}`:void 0,!n),A=l||nt,y=(0,et.A)(`width: ${A}px`,`height: ${A}px`,i&&!h.cp&&"cursor: pointer"),f=(0,a.li)(void 0),v=(0,a.li)(void 0),E=(0,P.A)(()=>{u.current&&(d({chatId:e,messageId:t,emoji:i,interactions:f.current}),v.current=void 0,f.current=void 0)}),b=(0,P.A)(()=>{const e=p.current;g&&(e&&(e.pause(),e.remove()),p.current=new Audio,p.current.src=g,(0,tt.A)(p.current),p.current.addEventListener("ended",()=>{p.current=void 0},{once:!0}))}),x=(0,P.A)(()=>{b();const n=u.current;if(!(i&&n&&t&&e))return;const{x:a,y:s}=n.getBoundingClientRect();c({emoji:i,x:a,y:s,startSize:A,isReversed:!r}),f.current||(f.current=[],v.current=performance.now(),setTimeout(E,1e3)),f.current.push(v.current?(performance.now()-v.current)/1e3:0)});return(0,a.vJ)(()=>{const n=u.current;n&&o&&o.forEach(({id:a,startSize:s,messageId:o})=>{if(s||t!==o)return;const{x:l,y:c}=n.getBoundingClientRect();m({id:a,chatId:e,emoticon:i,startSize:A,x:l,y:c,isReversed:!r}),b()})},[o,e,i,r,t,b,m,A]),{ref:u,size:A,style:y,handleClick:x}}const st=(0,a.ph)((0,s.EK)((e,{customEmojiId:t,withEffects:n})=>{const a=e.customEmojis.byId[t];return{sticker:a,effect:a?.emoji&&n?(0,m.Nr8)(e,a.emoji):void 0,soundId:a?.emoji&&(0,m.tKM)(e,a.emoji),noPlay:!(0,m.BWX)(e)}})(({isOwn:e,customEmojiId:t,messageId:n,chatId:s,activeEmojiInteractions:o,sticker:r,effect:i,soundId:l,noPlay:c,observeIntersection:d})=>{const{ref:m,size:u,style:p,handleClick:h}=at(s,n,l,o,e,i?.emoji,(0,z.Rr)(1));return a.Ay.createElement(Ie.A,{ref:m,documentId:t,className:(0,g.A)("AnimatedEmoji media-inner",r?.id===F.AC&&"like-sticker-thumb"),style:p,size:u,isBig:!0,noPlay:c,withSharedAnimation:!0,forceOnHeavyAnimation:Boolean(i&&o?.length),observeIntersectionForLoading:d,onClick:h})}));var ot=n(79577);const rt=(0,a.ph)((0,s.EK)((e,{emoji:t,withEffects:n})=>({sticker:(0,m.oei)(e,t),effect:n?(0,m.Nr8)(e,t):void 0,soundId:(0,m.tKM)(e,t)}))(({isOwn:e,observeIntersection:t,forceLoadPreview:n,messageId:s,chatId:o,activeEmojiInteractions:r,sticker:i,effect:l,soundId:c})=>{const{ref:d,size:m,style:u,handleClick:p}=at(o,s,c,r,e,l?.emoji),h=(0,Q.Vz)(d,t);return a.Ay.createElement(ot.A,{sticker:i,size:m,quality:1,noLoad:!h,forcePreview:n,play:h,forceAlways:!0,ref:d,className:(0,g.A)("AnimatedEmoji media-inner",i?.id===F.AC&&"like-sticker-thumb"),style:u,onClick:p})}));var it=n(14242),lt=n(93809),ct=n(68292),dt=n(57474);const mt=(0,a.ph)(({isCustomShape:e,threadInfo:t,disabled:n,isLoading:o,asActionButton:r})=>{const{openThread:i,openFrozenAccountModal:l}=(0,s.ko)(),c=(0,lt.A)([o],450),d=(0,Z.A)(),u=(0,Y.A)(),{originMessageId:p,chatId:h,messagesCount:A,lastMessageId:y,lastReadInboxMessageId:f,recentReplierIds:v,originChannelId:E}=t,b=(0,P.A)(()=>{const e=(0,s.mS)();(0,m.trm)(e)?l():i({isComments:!0,chatId:h,originMessageId:p,originChannelId:E})}),x=(0,a.Kr)(()=>{if(!v?.length)return;const e=(0,s.mS)();return v.map(t=>(0,m.PVB)(e,t)).filter(Boolean)},[v]);if(void 0===A)return;const w=Boolean(f&&y&&f<y),C=A?d("CommentsCount","%COMMENTS_COUNT%",void 0,A).split("%").map(e=>"COMMENTS_COUNT"===e?a.Ay.createElement(ct.A,{text:(0,it.Vw)(u,A)}):e):void 0;return a.Ay.createElement("div",{"data-cnt":(0,it.Vw)(u,A),className:(0,g.A)("CommentButton",w&&"has-unread",n&&"disabled",e&&"CommentButton-custom-shape",o&&"loading",r&&"as-action-button"),dir:d.isRtl?"rtl":"ltr",onClick:b,role:"button",tabIndex:0},a.Ay.createElement(Le.A,{name:"comments-sticker",className:(0,g.A)("CommentButton_icon-comments",o&&c&&"CommentButton_hidden")}),!x?.length&&a.Ay.createElement(Le.A,{name:"comments"}),Boolean(x?.length)&&a.Ay.createElement("div",{className:"recent-repliers",dir:d.isRtl?"rtl":"ltr"},x.map(e=>a.Ay.createElement(Ne.A,{key:e.id,size:"small",peer:e}))),a.Ay.createElement("div",{className:"label",dir:"auto"},A?C:d("LeaveAComment")),a.Ay.createElement("div",{className:"CommentButton_right"},o&&a.Ay.createElement(dt.A,{className:(0,g.A)("CommentButton_loading",!c&&"CommentButton_hidden"),color:e?"white":"blue"}),a.Ay.createElement(Le.A,{name:"next",className:(0,g.A)("CommentButton_icon-open",o&&c&&"CommentButton_hidden")})))});var ut=n(85982),pt=n(64713);const ht="ReDHhQHm";function gt(e){return e.firstName&&e.lastName?`${e.firstName} ${e.lastName}`:e.firstName?e.firstName:e.lastName?e.lastName:""}const At=(0,s.EK)((e,{contact:t})=>{const{countryList:{phoneCodes:n}}=e;return{user:(0,m.mBe)(e,t.userId),phoneCodeList:n}})(({contact:e,user:t,phoneCodeList:n,noUserColors:o})=>{const r=(0,Z.A)(),{openChat:i,openAddContactDialog:c,showNotification:d,openChatWithInfo:m}=(0,s.ko)(),{phoneNumber:u,userId:p}=e,h="0"!==p,g=h&&t&&(0,l.Gh)(t),A=(0,P.A)(()=>{i({id:p})}),y=(0,P.A)(()=>{c({userId:t?.id})}),f=(0,P.A)(()=>{t?m({id:p}):((0,ut.eM)(u),d({message:r("PhoneCopied")}))});return a.Ay.createElement(Be.A,{noUserColors:o,peer:t,emojiIconClassName:"SjZYi3sJ",className:"AAHWWWvU"},a.Ay.createElement("div",{className:"tpDpg82n",onClick:f},a.Ay.createElement(Ne.A,{size:"medium",peer:t,text:gt(e)}),a.Ay.createElement("div",{className:"fpYynE5s"},a.Ay.createElement("div",{className:"_PNTJc_V"},t?(0,l.Yg)(t):gt(e)),a.Ay.createElement("div",{className:"JP_3wes8"},(0,pt.Ox)(n,u)))),h&&a.Ay.createElement(a.Ay.Fragment,null,a.Ay.createElement("div",{className:"_OSJcuqH"}),a.Ay.createElement("div",{className:"Blui4M4G"},a.Ay.createElement($e.A,{isText:!0,color:"translucent",ripple:!0,size:"tiny",onClick:A,className:ht},r("SharedContactMessage")),g&&a.Ay.createElement($e.A,{isText:!0,color:"translucent",ripple:!0,size:"tiny",onClick:y,className:ht},r("SharedContactAdd")))))});var yt=n(80089),ft=n(80464);const vt=e=>{const{isOpen:t}=e,n=(0,ft.A)(yt.ar.Extra,"ContextMenuContainer",!t);return n?a.Ay.createElement(n,e):void 0};var Et=n(18501),bt=n(57675),xt=n(32581);const wt={color:0},Ct=(0,a.ph)(({factCheck:e,isToggleDisabled:t})=>{const n=(0,Z.A)(),s=(0,a.li)(),o=(0,a.li)(),{isCollapsed:r,isCollapsible:i,setIsCollapsed:l}=(0,bt.A)(s,4,o),c=(0,a.Kr)(()=>{if(e.countryCode&&n.code)return new Intl.DisplayNames([n.code],{type:"region"}).of(e.countryCode)},[e.countryCode,n.code]),d=!t&&r,m=(0,P.A)(()=>{l(!1)}),u=(0,P.A)(()=>{l(e=>!e)});if(e.text)return a.Ay.createElement(Be.A,{peerColor:wt,className:"HMB5LgeX",onClick:d?m:void 0},a.Ay.createElement("div",{ref:o,className:(0,g.A)("nfCzKu78",r&&"hYzpXwTM")},a.Ay.createElement("div",{className:"vZnCPl3t"},n("FactCheck")),a.Ay.createElement("div",{ref:s,className:"k_dGolcu"},(0,Et.fd)({text:e.text.text,entities:e.text.entities})),a.Ay.createElement(xt.A,{className:"qRaSs5iA"}),a.Ay.createElement("div",{className:"EDmr0wJG"},n("FactCheckFooter",c))),i&&a.Ay.createElement("div",{className:(0,g.A)("mxPizZpR",!t&&"Cj2cLczd"),onClick:t?void 0:u,"aria-hidden":!0},a.Ay.createElement(Le.A,{name:r?"down":"up"})))});var Nt=n(55158);const It=(0,a.ph)(({message:e,canAutoLoadMedia:t})=>{const{clickBotInlineButton:n}=(0,s.ko)(),o=e.content.game,{title:r,description:i}=o,c=(0,l.zb)(o),d=(0,l.ih)(o),m=(0,Pe.A)(c,!t),u=(0,Pe.A)(d,!t);return a.Ay.createElement("div",{className:"Game"},a.Ay.createElement("div",{className:"preview",style:"width: 480px; height: 270px",onClick:()=>{n({chatId:e.chatId,messageId:e.id,button:e.inlineButtons[0][0]})}},!m&&!u&&a.Ay.createElement(Nt.A,{className:"skeleton preview-content"}),m&&a.Ay.createElement("img",{className:"preview-content",src:m,alt:r,draggable:!1}),u&&a.Ay.createElement("video",{className:"preview-content",playsInline:!0,muted:!0,disablePictureInPicture:!0,autoPlay:!0,loop:!0,src:u})),a.Ay.createElement("div",{className:"title"},r),!(0,l.P5)(e)&&a.Ay.createElement("div",{className:"description"},i))});var St=n(17663),Mt=n(52491),kt=n(24021),Tt=n(58443),Pt=n(64489),Lt=n(10187);const Bt="ogvcv3mr",Rt="MSFa9BPf",Ft="HfZ6SuLI",Dt="rPyyNYxK",Ot="FV70u896",zt=(0,a.ph)((0,s.EK)((e,{message:t})=>{const{giveaway:n}=t.content,a=(0,m.hds)(e,t.chatId);return{chat:a,sender:(n?.channelIds[0]?(0,m.hds)(e,n.channelIds[0]):void 0)||(0,m.Szq)(e,t)||a,giftSticker:n&&(0,m.t0O)(e,n.months),canPlayAnimatedEmojis:(0,m.BWX)(e)}})(({chat:e,sender:t,message:n,canPlayAnimatedEmojis:o,giftSticker:r})=>{const{openChat:i}=(0,s.ko)(),d=(0,a.li)(!1),[m,u]=(0,a.J0)(),p=(0,Z.A)(),{giveaway:h,giveawayResults:A}=n.content,y=Boolean(A),{months:v,untilDate:E,prizeDescription:b,stars:x}=h||A,w=(0,l.Ie)(n),C=y?A.winnersCount:h.quantity,N=(0,f.Fm)()>E,I=(0,a.Kr)(()=>{if(y)return;const e=new Intl.DisplayNames([p.code,"en"].filter(Boolean),{type:"region"});return h?.countries?.map(t=>`${(0,Mt.D0)(t)} ${e.of(t)}`).join(", ")},[h,y,p.code]),S=(0,P.A)(e=>{i({id:e})}),M=(0,P.A)(async()=>{if(d.current)return;d.current=!0;const t=await(0,kt.px)("fetchGiveawayInfo",{peer:e,messageId:n.id});u(t),d.current=!1}),k=(0,P.A)(()=>{u(void 0)}),T=(0,a.Kr)(()=>{if(m)return p("results"===m.type?"BoostingGiveawayEnd":"BoostingGiveAwayAbout")},[m,p]);return a.Ay.createElement("div",{className:"CbpKtOey"},a.Ay.createElement("div",{className:(0,g.A)("hjjKhvVv",y&&"JEiR48jJ")},y?a.Ay.createElement(Pt.A,{size:150,tgsUrl:Tt.w.PartyPopper,nonInteractive:!0,noLoop:!0}):a.Ay.createElement(ot.A,{sticker:r,play:o&&N,noLoop:!0,nonInteractive:!0,size:175}),a.Ay.createElement("span",{className:"n_QCMv_A"},`x${C}`)),y?function(e){const t=e.winnerIds;return a.Ay.createElement(a.Ay.Fragment,null,a.Ay.createElement("div",{className:Rt},a.Ay.createElement("strong",{className:Bt},(0,O.A)(p("BoostingGiveawayResultsMsgWinnersSelected"),["simple_markdown"])),a.Ay.createElement("p",{className:Ft},(0,O.A)(p("BoostingGiveawayResultsMsgWinnersTitle",t.length),["simple_markdown"])),a.Ay.createElement("strong",{className:Bt},p("lng_prizes_results_winners")),a.Ay.createElement("div",{className:Dt},t.map(e=>a.Ay.createElement(Lt.A,{peerId:e,forceShowSelf:!0,withPeerColors:!w,className:Ot,clickArg:e,onClick:S})))),a.Ay.createElement("div",{className:Rt},a.Ay.createElement("p",{className:Ft},p("BoostingGiveawayResultsMsgAllWinnersReceivedLinks"))))}(A):function(e){const t=e.channelIds;return a.Ay.createElement(a.Ay.Fragment,null,a.Ay.createElement("div",{className:Rt},a.Ay.createElement("strong",{className:Bt},(0,O.A)(p("BoostingGiveawayPrizes"),["simple_markdown"])),b&&a.Ay.createElement(a.Ay.Fragment,null,a.Ay.createElement("p",{className:Ft},(0,O.A)(p("BoostingGiveawayMsgPrizes",[C,b],void 0,C),["simple_markdown"])),a.Ay.createElement(xt.A,null,p("BoostingGiveawayMsgWithDivider"))),a.Ay.createElement("p",{className:Ft},n?.content?.giveaway?.stars?a.Ay.createElement(a.Ay.Fragment,null,(0,O.A)(p("Chat.Giveaway.Message.Stars.PrizeText",p("Stars",n?.content?.giveaway?.stars)),["simple_markdown"]),a.Ay.createElement("br",null),(0,O.A)(p("AmongWinners",C),["simple_markdown"])):a.Ay.createElement(a.Ay.Fragment,null,(0,O.A)(p("Chat.Giveaway.Info.Subscriptions",C),["simple_markdown"]),a.Ay.createElement("br",null),(0,O.A)(p("ActionGiftPremiumSubtitle",p("Chat.Giveaway.Info.Months",v)),["simple_markdown"])))),a.Ay.createElement("div",{className:Rt},a.Ay.createElement("strong",{className:Bt},(0,O.A)(p("BoostingGiveawayMsgParticipants"),["simple_markdown"])),a.Ay.createElement("p",{className:Ft},(0,O.A)(p("BoostingGiveawayMsgAllSubsPlural",t.length),["simple_markdown"])),a.Ay.createElement("div",{className:Dt},t.map(e=>a.Ay.createElement(Lt.A,{peerId:e,forceShowSelf:!0,withPeerColors:!w,className:Ot,clickArg:e,onClick:S}))),I&&a.Ay.createElement("span",null,(0,O.A)(p("Chat.Giveaway.Message.CountriesFrom",I)))),a.Ay.createElement("div",{className:Rt},a.Ay.createElement("strong",{className:Bt},(0,O.A)(p("BoostingWinnersDate"),["simple_markdown"])),a.Ay.createElement("p",{className:Ft},(0,St.L2)(1e3*E,p.code,!0))))}(h),a.Ay.createElement($e.A,{className:"jMBw7STU",color:"adaptive",size:"smaller",onClick:M},p("BoostingHowItWork")),a.Ay.createElement(Ge.A,{isOpen:Boolean(m),isOnlyConfirm:!0,title:T,confirmHandler:k,onClose:k},function(){if(!t||!m)return;const e="results"===m.type,n=(0,c.vj)(t)?(0,l.Js)(p,t):(0,l.Yg)(t),o=(0,St.U)(p,1e3*E),r=h?.channelIds?h.channelIds.length-1:0,i=p("Chat.Giveaway.Info.OtherChannels",r),d=r>0,u=e?"BoostingGiveawayHowItWorksTextEnd":"BoostingGiveawayHowItWorksText",g=e?p("Chat.Giveaway.Info.Months",v):p("Stars",x,"i"),A=p(u,[n,C,g],void 0,C),y=b?p("BoostingGiveawayHowItWorksIncludeText",[n,C,b],void 0,C):void 0;let f="";f=e?d?"BoostingGiveawayHowItWorksSubTextSeveralEnd":"BoostingGiveawayHowItWorksSubTextEnd":d?"BoostingGiveawayHowItWorksSubTextSeveral":"BoostingGiveawayHowItWorksSubText";let w=p(f,[o,C,n,r],void 0,C);e&&m.activatedCount&&(w+=` ${p("BoostingGiveawayUsedLinksPlural",m.activatedCount)}`);let N="";e&&(N=m.isRefunded?p("BoostingGiveawayCanceledByPayment"):p(m.isWinner?"BoostingGiveawayYouWon":"BoostingGiveawayYouNotWon"));let I="";if(e);else if(m.disallowedCountry)I=p("BoostingGiveawayNotEligibleCountry");else if(m.adminDisallowedChatId){const e=(0,s.mS)().chats.byId[m.adminDisallowedChatId],t=e&&(0,l.Js)(p,e);I=p("BoostingGiveawayNotEligibleAdmin",t)}else if(m.joinedTooEarlyDate){const e=(0,St.U)(p,1e3*m.joinedTooEarlyDate);I=p("BoostingGiveawayNotEligible",e)}else I=m.isParticipating?d?p("Chat.Giveaway.Info.ParticipatingMany",[n,r]):p("Chat.Giveaway.Info.Participating",n):d?p("Chat.Giveaway.Info.NotQualifiedMany",[n,i,o]):p("Chat.Giveaway.Info.NotQualified",[n,o]);return a.Ay.createElement(a.Ay.Fragment,null,N&&a.Ay.createElement("p",{className:"ZQ4aVVkI"},(0,O.A)(N,["simple_markdown"])),a.Ay.createElement("p",null,(0,O.A)(A,["simple_markdown"])),y&&a.Ay.createElement("p",null,(0,O.A)(y,["simple_markdown"])),a.Ay.createElement("p",null,(0,O.A)(w,["simple_markdown"])),I&&a.Ay.createElement("p",null,(0,O.A)(I,["simple_markdown"])))}()))}));var jt=n(85449);const Ut=(0,a.ph)(({message:e,onClick:t})=>{const n=(0,Z.A)(),s=(0,a.Kr)(()=>{const t=[];return e.inlineButtons.forEach(e=>{t.push(e.map(e=>(0,jt.A)(n,e)))}),t},[n,e.inlineButtons]);return a.Ay.createElement("div",{className:"InlineButtons"},e.inlineButtons.map((n,o)=>a.Ay.createElement("div",{className:"row"},n.map((n,r)=>a.Ay.createElement($e.A,{size:"tiny",ripple:!0,disabled:"unsupported"===n.type||"suggestedMessage"===n.type&&n.disabled,onClick:()=>t({chatId:e.chatId,messageId:e.id,button:n})},(e=>{const{type:t}=e;switch(t){case"url":if(!i.OFc.test(e.url))return a.Ay.createElement(Le.A,{className:"corner-icon",name:"arrow-right"});break;case"urlAuth":return a.Ay.createElement(Le.A,{className:"corner-icon",name:"arrow-right"});case"buy":case"receipt":return a.Ay.createElement(Le.A,{className:"corner-icon",name:"card"});case"switchBotInline":return a.Ay.createElement(Le.A,{className:"corner-icon",name:"share-filled"});case"webView":case"simpleWebView":return a.Ay.createElement(Le.A,{className:"corner-icon",name:"webapp"});case"copy":return a.Ay.createElement(Le.A,{className:"corner-icon",name:"copy"});case"suggestedMessage":if("suggestChanges"===e.buttonType)return a.Ay.createElement(Le.A,{className:"left-icon",name:"edit"});if("approve"===e.buttonType)return a.Ay.createElement(Le.A,{className:"left-icon",name:"check"});if("decline"===e.buttonType)return a.Ay.createElement(Le.A,{className:"left-icon",name:"close"})}})(n),a.Ay.createElement("span",{className:"inline-button-text"},s[o][r]))))))});var Vt=n(17142),Jt=n(40435),Ht=n(37859),Kt=n(61097);const $t=(0,a.ph)(({message:e,shouldAffectAppendix:t,isInSelectMode:n,isSelected:s,theme:o,forcedWidth:r})=>{const c=(0,a.li)(),d=(0,Z.A)(),m=(0,Y.A)(),u=(0,l.NO)(e),{title:p,description:h,amount:g,currency:A,isTest:y,photo:f}=u,v=(0,Pe.A)((0,l.cy)(f)),E=Boolean(r),b=(0,Kt.A)(v,!E),x=e.id;(0,Ht.A)(([e])=>{if(t){if(v){const e=c.current.closest(i.KFG);(0,Jt.A)(v,!1,x,s,o).then(t=>{(0,pe.RK)(()=>{e.style.setProperty("--appendix-bg",t),e.setAttribute(i.D3G,"")})})}}else e&&c.current.closest(i.KFG).removeAttribute(i.D3G)},[t,v,n,s,o,x]);const w=r||f?.dimensions?.width,C=(0,et.A)(f?.dimensions&&`width: ${w}px`,f?.dimensions&&`aspect-ratio: ${f.dimensions.width} / ${f.dimensions.height}`,Boolean(!f?.dimensions&&r)&&`width: ${r}px`);return a.Ay.createElement("div",{ref:c,className:"Invoice"},p&&a.Ay.createElement("p",{className:"title"},(0,O.A)(p)),h&&a.Ay.createElement("div",{className:"info"},(0,O.A)(h,["emoji","br"])),a.Ay.createElement("div",{className:"description "+(f?"has-image":"")},Boolean(f)&&a.Ay.createElement("div",{className:"invoice-image-container"},E&&a.Ay.createElement("canvas",{ref:b,className:"thumbnail blurred-bg"}),v&&a.Ay.createElement("img",{className:"invoice-image",src:v,alt:"",style:C,crossOrigin:"anonymous",draggable:!1}),!v&&f&&a.Ay.createElement(Nt.A,{width:w,height:f.dimensions?.height,forceAspectRatio:!0})),a.Ay.createElement("p",{className:"description-text"},(0,Vt.vv)(m,g,A,{iconClassName:"invoice-currency-icon"}),y&&a.Ay.createElement("span",{className:"test-invoice"},d("PaymentTestInvoice")))))});var Gt=n(32625),_t=n(27860);const qt={root:"dCK8GQ_8",duration:"CWT8ZMwV",buy:"C38zhCDM",spoiler:"CG55VZP1"},Wt=(0,a.ph)(({message:e,isConnected:t})=>{const{openInvoice:n,loadExtendedMedia:o}=(0,s.ko)(),r=(0,Z.A)(),i=(0,l.NO)(e),{chatId:c,id:d}=e,m=(0,P.A)(()=>{o({chatId:c,ids:[d]})});(0,Gt.A)(m,t?3e4:void 0);const{amount:u,currency:p,extendedMedia:h}=i,{width:A,height:y,thumbnail:f,duration:v}=h,E=(0,P.A)(()=>{n({type:"message",chatId:c,messageId:d,isExtendedMedia:!0})});return a.Ay.createElement("div",{className:(0,g.A)(qt.root,"media-inner"),onClick:E},a.Ay.createElement(_t.A,{thumbDataUri:f?.dataUri,width:A,height:y,isVisible:!0,className:qt.spoiler}),Boolean(v)&&a.Ay.createElement("div",{className:qt.duration},(0,St.QO)(v)),a.Ay.createElement("div",{className:qt.buy},a.Ay.createElement(Le.A,{name:"lock",className:qt.lock}),r("Checkout.PayPrice",(0,Vt.Ad)(u,p))))});var Qt=n(47526),Yt=n(14737),Zt=n(30857),Xt=n(38691);const en=n.p+"map-pin.899635f6fe777c28998a.svg",tn=24*Math.PI,nn=1e-4,an={width:400,height:300,zoom:16};function sn(){return a.Ay.createElement("svg",{className:"round-pin",style:"enable-background:new 0 0 64 64",viewBox:"0 0 64 64"},a.Ay.createElement("circle",{cx:"32",cy:"32",r:"24.5"}),a.Ay.createElement("path",{d:"M32 8c13.23 0 24 10.77 24 24S45.23 56 32 56 8 45.23 8 32 18.77 8 32 8m0-1C18.19 7 7 18.19 7 32s11.19 25 25 25 25-11.19 25-25S45.81 7 32 7z"}),a.Ay.createElement("path",{d:"m29.38 57.67-1.98-1.59 3.02-1.66L32 51.54l1.58 2.88 3.02 1.66-1.91 1.53L32 60.73z"}),a.Ay.createElement("path",{d:"m32 52.58 1.07 1.95.14.26.26.14 2.24 1.22-1.33 1.06-.07.06-.06.07L32 59.96l-2.24-2.61-.06-.07-.07-.06-1.33-1.06 2.24-1.22.26-.14.14-.26L32 52.58m0-2.08-1.94 3.56L26.5 56l2.5 2 3 3.5 3-3.5 2.5-2-3.56-1.94L32 50.5z"}))}const on=(0,a.ph)(({message:e,peer:t})=>{const{openMapModal:n}=(0,s.ko)(),o=(0,a.li)(),r=(0,a.li)(),i=(0,Z.A)(),c=(0,Zt.A)(),d=(0,l.fB)(e),{mediaType:m,geo:u}=d,p=(0,f.Fm)(),h=(0,l.vz)(e),A="geoLive"!==m||h?void 0:e.date+d.period-p,[y,v]=(0,a.J0)(u),E="venue"===m||"geoLive"===m&&!h,{width:b,height:x,zoom:w}=an,C=(0,Xt.A)(),N=(0,l.rt)(y,b,x,w,C),I=(0,Pe.A)(N),S=(0,X.A)(I,!0),M=I||S,k=(0,a.Kr)(()=>{if("geoLive"!==m||!y.accuracyRadius)return 0;const{lat:e,accuracyRadius:t}=y;return t/(0,Qt._u)(e,w)},[m,y,w]),T=(0,P.A)(t=>{if("geoLive"!==m)return;const n=t.lastElementChild,a=t.firstElementChild,s=e.date+d.period-(0,f.Fm)(),o=(1-s/d.period)*tn,r=(0,St.dq)(i,1e3*s);a.textContent=r,n.firstElementChild.setAttribute("stroke-dashoffset",`-${o}`)});return(0,a.Nf)(()=>{r.current&&T(r.current)},[T]),(0,a.vJ)(()=>{Math.abs(u.lat-y.lat)<nn&&Math.abs(u.long-y.long)<nn?y.accuracyRadius!==u.accuracyRadius&&v({...y,accuracyRadius:u.accuracyRadius}):v(u)},[u,y]),(0,Yt.A)(()=>{c()},h?void 0:1e3*(A||0)),(0,Gt.A)(()=>{(0,pe.RK)(()=>{const e=r.current;e&&T(e)})},A?1e3:void 0),a.Ay.createElement("div",{ref:o,className:"Location media-inner interactive",onClick:()=>{n({geoPoint:y,zoom:w})}},a.Ay.createElement("div",{className:"map-wrapper"},M?a.Ay.createElement("img",{className:"full-media map",src:M,alt:"Location on a map",draggable:!1,style:`width: ${an.width}px; height: ${an.height}px;`}):a.Ay.createElement(Nt.A,{width:b,height:x}),function(){if(M)return a.Ay.createElement(a.Ay.Fragment,null,Boolean(k)&&!h&&a.Ay.createElement("div",{className:"location-accuracy",style:`width: ${2*k}px; height: ${2*k}px`}),function(){const e=(0,g.A)("pin",m,h&&"expired");if("geoLive"===m)return a.Ay.createElement("div",{className:e},a.Ay.createElement(sn,null),a.Ay.createElement(Ne.A,{peer:t,className:"location-avatar"}),void 0!==d.heading&&a.Ay.createElement("div",{className:"direction",style:`--direction: ${d.heading}deg`}));if("venue"===m){const t=(0,Qt.PP)(d.venueType),n=(0,Qt.KE)(d.venueType);if(n)return a.Ay.createElement("div",{className:e,style:`--pin-color: ${t}`},a.Ay.createElement(sn,null),a.Ay.createElement("img",{src:n,draggable:!1,className:"venue-icon",alt:""}))}return a.Ay.createElement("img",{className:e,draggable:!1,src:en,alt:""})}())}()),function(){if(E)return"venue"===m?a.Ay.createElement("div",{className:"location-info"},a.Ay.createElement("div",{className:"location-info-title"},d.title),a.Ay.createElement("div",{className:"location-info-subtitle"},d.address)):"geoLive"===m?a.Ay.createElement("div",{className:"location-info"},a.Ay.createElement("div",{className:"location-info-title"},i("AttachLiveLocation")),a.Ay.createElement("div",{className:"location-info-subtitle"},(0,St.IF)(i,p,e.editDate)),!h&&a.Ay.createElement("div",{className:"geo-countdown",ref:r},a.Ay.createElement("span",{className:"geo-countdown-text"}),a.Ay.createElement("svg",{width:"32px",height:"32px"},a.Ay.createElement("circle",{cx:"16",cy:"16",r:12,className:"geo-countdown-progress",transform:"rotate(-90, 16, 16)","stroke-dasharray":tn,"stroke-dashoffset":"0"})))):void 0}())});var rn=n(48906),ln=n(75295),cn=n(48775),dn=n(45);const mn=(0,a.ph)(({message:e,outgoingStatus:t,signature:n,withReactionOffset:o,repliesThreadInfo:r,renderQuickReactionButton:i,noReplies:l,isTranslated:c,isPinned:d,withFullDate:m,effectEmoji:u,onClick:p,onTranslationClick:h,onEffectClick:A,onOpenThread:y,paidMessageStars:f})=>{const{showNotification:v}=(0,s.ko)(),[E,b]=(0,W.A)(),x=(0,Z.A)(),w=(0,Y.A)();function C(e){e.stopPropagation(),v({message:{key:"ImportedInfo"}})}const N=(0,a.Kr)(()=>{if(!E)return;const t=(0,St.L2)(1e3*e.date,x.code,void 0,x.timeFormat),n=e.isEdited&&(0,St.L2)(1e3*e.editDate,x.code,void 0,x.timeFormat),a=e.forwardInfo&&(0,St.L2)(1e3*(e.forwardInfo.savedDate||e.forwardInfo.date),x.code,void 0,x.timeFormat);let s=t;return n&&(s+="\n",s+=w("MessageTooltipEditedDate",{date:n})),a&&(s+="\n",s+=w("MessageTooltipForwardedDate",{date:a})),s},[E,x,e,x.timeFormat]),I=(0,a.Kr)(()=>{if(!e.viewsCount)return;let t=w("MessageTooltipViews",{count:w.number(e.viewsCount)},{pluralValue:e.viewsCount});return e.forwardsCount&&(t+="\n",t+=w("MessageTooltipForwards",{count:w.number(e.forwardsCount)},{pluralValue:e.forwardsCount})),t},[w,e.forwardsCount,e.viewsCount]),S=(0,a.Kr)(()=>{const e=r?.messagesCount;if(e)return w("MessageTooltipReplies",{count:e},{pluralValue:e})},[w,r]),M=(0,a.Kr)(()=>{const t=(0,St.fU)(x,1e3*e.date);return m?(0,St.be)(x,1e3*(e.forwardInfo?.date||e.date),!0):t},[x,e.date,e.forwardInfo?.date,m]),k=(0,g.A)("MessageMeta",o&&"reactions-offset",e.forwardInfo?.isImported&&"is-imported");return a.Ay.createElement("span",{className:k,dir:w.isRtl?"rtl":"ltr",onClick:p,"data-ignore-on-paste":!0},u&&a.Ay.createElement("span",{className:"message-effect-icon",onClick:A},(0,O.A)(u)),c&&a.Ay.createElement(Le.A,{name:"language",className:"message-translated",onClick:h}),Boolean(e.viewsCount)&&a.Ay.createElement(a.Ay.Fragment,null,a.Ay.createElement("span",{className:"message-views",title:I},(0,it.Vw)(w,e.viewsCount)),a.Ay.createElement(Le.A,{name:"channelviews"})),!l&&Boolean(r?.messagesCount)&&a.Ay.createElement("span",{onClick:function(e){e.stopPropagation(),y()},className:"message-replies-wrapper",title:S},a.Ay.createElement("span",{className:"message-replies"},a.Ay.createElement(ct.A,{text:(0,it.Vw)(w,r.messagesCount)})),a.Ay.createElement(Le.A,{name:"reply-filled"})),d&&a.Ay.createElement(Le.A,{name:"pinned-message",className:"message-pinned"}),n&&a.Ay.createElement("span",{className:"message-signature"},(0,O.A)(n)),Boolean(f)&&a.Ay.createElement("span",{className:"message-price"},(0,cn.U2)(w,f,{asFont:!0,className:"message-price-star-icon",containerClassName:"message-price-stars-container"})),a.Ay.createElement("span",{className:"message-time",title:N,onMouseEnter:b},e.forwardInfo?.isImported&&a.Ay.createElement(a.Ay.Fragment,null,a.Ay.createElement("span",{className:"message-imported",onClick:C},(0,St.L2)(1e3*e.forwardInfo.date,w.code,!0)),a.Ay.createElement("span",{className:"message-imported",onClick:C},w("MessageMetaImported"))),e.isEdited&&`${w("MessageMetaEdited")} `,e.isVideoProcessingPending&&`${w("MessageMetaApproximate")} `,M),t&&a.Ay.createElement(dn.A,{status:t}),i&&i())});var un=n(4262);const pn=(0,a.ph)(({phoneCall:e,message:t,chatId:n})=>{const{requestMasterAndRequestCall:o}=(0,s.ko)(),r=(0,Z.A)(),{isVideo:i,reason:l,duration:c}=e,d=t.isOutgoing,m="missed"===l,u="busy"===l||void 0===c,p=(0,P.A)(()=>{o({isVideo:i,userId:n})}),A=(0,a.Kr)(()=>e.duration?(0,St.zA)(r,e.duration):void 0,[r,e.duration]),y=(0,St.fU)(r,1e3*t.date);return a.Ay.createElement("div",{className:"wqsZyy8u"},a.Ay.createElement($e.A,{size:"smaller",color:"translucent",round:!0,ripple:!0,onClick:p,className:"NGmo4ADz",disabled:!h.OL,ariaLabel:r(d?"CallAgain":"CallBack")},a.Ay.createElement(Le.A,{name:i?"video-outlined":"phone"})),a.Ay.createElement("div",{className:"iFn6m6hd"},a.Ay.createElement("div",{className:"l8QfocIQ"},r((0,un.fB)(e,t.isOutgoing))),a.Ay.createElement("div",{className:"rF5tkx92"},a.Ay.createElement(Le.A,{name:"arrow-right",className:(0,g.A)("ONmpzmUS",m&&"Alra_BWu",u&&"J7xsuCAm",!d&&"BfgDXljM")}),a.Ay.createElement("span",{className:"kKPKwFzu"},A?r("CallMessageWithDuration",[y,A]):y))))});var hn=n(98607);const gn=(0,a.ph)(({paidMedia:e,chatId:t,messageId:n,isOutgoing:o,children:r})=>{const{openInvoice:l}=(0,s.ko)(),c=(0,Z.A)(),d=(0,Y.A)(),m=!e.isBought,u=(0,a.Kr)(()=>{const t=c("UnlockPaidContent",e.starsAmount);return(0,hn.i)(t,i.Cyx,a.Ay.createElement(De.A,{className:"ywiOugiH",type:"gold",size:"adaptive"}))},[c,e]),p=(0,P.A)(e=>{l({type:"message",chatId:t,messageId:n}),(0,v.A)(e)});return a.Ay.createElement("div",{className:"mVaSjZRJ",onClick:m?p:void 0},r,m&&a.Ay.createElement($e.A,{className:"GnKGu6D9",color:"dark",size:"tiny",fluid:!0,pill:!0},a.Ay.createElement("span",{className:"gLaaVQXr"},u)),e.isBought&&a.Ay.createElement("div",{className:(0,g.A)("message-paid-media-status","IGXW5hWr")},o?(0,cn.U2)(d,e.starsAmount):c("Chat.PaidMedia.Purchased")))});var An=n(26875),yn=n(77561),fn=n(1087);function vn(e,t){return t>0?(e/t*100).toFixed():0}const En=({answer:e,voteResults:t,totalVoters:n,maxVotersCount:s,correctResults:o,shouldAnimate:r})=>{const i=(0,Y.A)(),l=t&&t.find(t=>t.option===e.option),c=0===o.length||-1!==o.indexOf(e.option),d=o.length>0&&c||l?.isChosen,m=l?vn(l.votersCount,n||0):0,[u,p]=(0,a.J0)(r?0:m),h=l?vn(l.votersCount,s||0):0,A=u!==m;if((0,a.vJ)(()=>{r&&p(m)},[r,m]),!t||!l)return;const y=`width: ${h}%; transform:scaleX(${A?0:1})`;return a.Ay.createElement("div",{className:"PollOption",dir:i.isRtl?"rtl":void 0},a.Ay.createElement("div",{className:"poll-option-share "+("100"===m?"limit-width":"")},m,"%",d&&a.Ay.createElement("span",{className:(0,g.A)("poll-option-chosen",!c&&"wrong",r&&"animate")},a.Ay.createElement(Le.A,{name:c?"check":"close",className:"poll-option-icon"}))),a.Ay.createElement("div",{className:"poll-option-right"},a.Ay.createElement("div",{className:"poll-option-text",dir:"auto"},(0,Et.fd)({text:e.text.text,entities:e.text.entities})),a.Ay.createElement("div",{className:(0,g.A)("poll-option-answer",d&&!c&&"wrong")},r&&a.Ay.createElement("svg",{className:"poll-line",style:A?"":"stroke-dasharray: 100% 200%; stroke-dashoffset: -44"},a.Ay.createElement("path",{d:"M4.47 5.33v13.6a9 9 0 009 9h13"})),a.Ay.createElement("div",{className:"poll-option-line",style:y}))))},bn=12*Math.PI;function xn(e){e.stopPropagation()}const wn=(0,a.ph)(({message:e,poll:t,observeIntersectionForLoading:n,observeIntersectionForPlaying:o,onSendVote:r})=>{const{loadMessage:i,openPollResults:l,requestConfetti:c,showNotification:d}=(0,s.ko)(),{id:u,chatId:p}=e,{summary:h,results:g}=t,[A,v]=(0,a.J0)(!1),[E,b]=(0,a.J0)([]),[x,w]=(0,a.J0)(!1),[C,N]=(0,a.J0)(!h.closed&&h.closeDate&&h.closeDate>0?Math.min(h.closeDate-(0,f.Fm)(),h.closePeriod):0),I=(0,a.li)(),S=(0,a.li)(),{results:M,totalVoters:k}=g,T=M&&M.some(e=>e.isChosen),L=!h.closed&&!T,B=!L&&h.isPublic&&Number(g.totalVoters)>0,R=L&&h.multipleChoice,F=g.recentVoterIds,D=M?Math.max(...M.map(e=>e.votersCount)):k,O=(0,a.Kr)(()=>M?.filter(e=>e.isCorrect).map(e=>e.option)||[],[M]),z=(0,a.Kr)(()=>h.answers.map(e=>({label:(0,Et.fd)({text:e.text.text,entities:e.text.entities,observeIntersectionForLoading:n,observeIntersectionForPlaying:o}),value:e.option,hidden:Boolean(h.quiz&&h.closePeriod&&C<=0)})),[C,n,o,h.answers,h.closePeriod,h.quiz]);(0,a.vJ)(()=>{const e=t.results.results?.find(e=>e.isChosen);A&&e&&(e.isCorrect&&c({}),v(!1))},[A,t.results.results,c]),(0,a.Nf)(()=>{if(C>0&&setTimeout(()=>N(C-1),1e3),!S.current)return;C<=5&&I.current.classList.add("hurry-up");const e=(h.closePeriod-C)/h.closePeriod*bn;S.current.setAttribute("stroke-dashoffset",`-${e}`)},[C,h.closePeriod]),(0,a.vJ)(()=>{h.quiz&&(C<=0||T&&!h.closed)&&i({chatId:p,messageId:u})},[p,C,T,i,u,h.closed,h.quiz]),(0,a.vJ)(()=>{let e;return h.quiz&&!h.closed&&h.closePeriod&&h.closePeriod>0&&(e=window.setTimeout(()=>{i({chatId:p,messageId:u})},1e3*h.closePeriod)),()=>{e&&window.clearTimeout(e)}},[L,p,i,u,h.closePeriod,h.closed,h.quiz]);const j=(0,a.Kr)(()=>{const e=(0,s.mS)();return F?F.reduce((t,n)=>{const a=(0,m.PVB)(e,n);return a&&t.push(a),t},[]):[]},[F]),U=(0,P.A)(e=>{b([e]),v(!0),w(!0),r([e])}),V=(0,P.A)(e=>{b(e)}),J=(0,P.A)(()=>{v(!0),w(!0),r(E)}),H=(0,P.A)(()=>{l({chatId:p,messageId:u})}),K=(0,P.A)(()=>{d({localId:(0,y.bj)(e),message:(0,Et.fd)({text:t.results.solution,entities:t.results.solutionEntities}),duration:5e3,containerSelector:"#middle-column-portals"})});(0,a.vJ)(()=>{x&&T&&h.quiz&&g.results&&t.results.solution&&(g.results.find(e=>e.isChosen&&e.isCorrect)||K())},[T,x,g.results,h.quiz,t.results.solution]);const $=(0,Z.A)();return a.Ay.createElement("div",{className:"Poll",dir:$.isRtl?"auto":"ltr"},a.Ay.createElement("div",{className:"poll-question"},(0,Et.fd)({text:h.question.text,entities:h.question.entities,observeIntersectionForLoading:n,observeIntersectionForPlaying:o})),a.Ay.createElement("div",{className:"poll-type"},$(function(e){return void 0===e.isPublic?" ":e.closed?"FinalResults":e.quiz?e.isPublic?"QuizPoll":"AnonymousQuizPoll":e.isPublic?"PublicPoll":"AnonymousPoll"}(h)),j.length>0&&a.Ay.createElement("div",{className:"poll-recent-voters"},a.Ay.createElement(An.A,{size:"micro",peers:j})),C>0&&L&&a.Ay.createElement("div",{ref:I,className:"poll-countdown"},a.Ay.createElement("span",null,(0,St.QO)(C)),a.Ay.createElement("svg",{width:"16px",height:"16px"},a.Ay.createElement("circle",{ref:S,cx:"8",cy:"8",r:6,className:"poll-countdown-progress",transform:"rotate(-90, 8, 8)","stroke-dasharray":bn,"stroke-dashoffset":"0"}))),h.quiz&&t.results.solution&&!L&&a.Ay.createElement($e.A,{round:!0,size:"tiny",color:"translucent",className:"poll-quiz-help",onClick:K,ariaLabel:"Show Solution"},a.Ay.createElement(Le.A,{name:"lamp"}))),L&&a.Ay.createElement("div",{className:"poll-answers",onClick:xn},R?a.Ay.createElement(yn.A,{options:z,selected:E,onChange:V,disabled:e.isScheduled||A,loadingOptions:A?E:void 0,isRound:!0}):a.Ay.createElement(fn.A,{name:`poll-${u}`,options:z,onChange:U,disabled:e.isScheduled||A,loadingOption:A?E[0]:void 0})),!L&&a.Ay.createElement("div",{className:"poll-results"},h.answers.map(function(e){return a.Ay.createElement(En,{key:e.option,shouldAnimate:x||!L,answer:e,voteResults:M,totalVoters:k,maxVotersCount:D,correctResults:O})})),!B&&!R&&a.Ay.createElement("div",{className:"poll-voters-count"},function(e,t,n){return n?e(t?"Answer":"Vote",n,"i"):e(t?"Chat.Quiz.TotalVotesEmpty":"Chat.Poll.TotalVotesResultEmpty")}($,h.quiz,g.totalVoters)),R&&a.Ay.createElement($e.A,{isText:!0,disabled:0===E.length,size:"tiny",onClick:J},$("PollSubmitVotes")),B&&a.Ay.createElement($e.A,{isText:!0,size:"tiny",onClick:H},$("PollViewResults")))});var Cn=n(43581),Nn=n(84555),In=n(10221),Sn=n(18104),Mn=n(14413),kn=n(82855),Tn=n(3325);const Pn="GydRBA08",Ln="WMMaWlOL",Bn=(0,a.ph)((0,s.EK)(e=>{const t=e.appConfig,n=t?.needAgeVideoVerification;return{needsAgeVerification:n}})(({message:e,shouldLoop:t,shouldPlayEffect:n,withEffect:r,isMediaNsfw:i,onStopEffect:c,observeIntersection:d,observeIntersectionForPlaying:m,needsAgeVerification:u})=>{const{showNotification:p,openStickerSet:A,updateContentSettings:y,openAgeVerificationModal:f}=(0,s.ko)(),v=(0,Z.A)(),{isMobile:E}=(0,$.Ay)(),b=(0,a.li)(),x=(0,a.li)(),w=e.content.sticker,{stickerSetInfo:C,isVideo:N,hasEffect:I}=w,S=!e.isOutgoing,[M,k,T]=(0,W.A)(),[L,B]=(0,a.J0)(!1),R=i,[D,O,z]=(0,W.A)(R);(0,a.vJ)(()=>{R?O():z()},[R]);const j=(0,P.A)(()=>{T(),z(),L&&y({isSensitiveEnabled:!0})}),U=w.isPreloadedGlobally?void 0:(0,l.Mw)(w,N&&!h.OF?"pictogram":"inline"),V=(0,Q.Vz)(b,d),J=(0,Q.Vz)(b,m),H=`sticker${w.id}?size=f`,K=(0,Pe.A)(H,!V||!I||!r,o.qZ.BlobUrl),[G,_,q]=(0,W.A)(),Y=(0,l.VD)(w),X=(0,P.A)(()=>{q(),c?.()});(0,a.vJ)(()=>{I&&r&&J&&n&&_()},[I,J,n,_,r]);const ee=I&&r&&K&&G;(0,In.A)({anchorRef:b,overlayRef:x,isMirrored:S,isDisabled:!ee});const te=(0,P.A)(()=>{A({stickerSetInfo:w.stickerSetInfo})}),ne=(0,P.A)(()=>{if(D)return i?u?void f():void k():void z();if(I){if(G||!r)return void p({message:v("PremiumStickerTooltip"),action:{action:"openStickerSet",payload:{stickerSetInfo:w.stickerSetInfo}},actionText:v("ViewAction")});if(r)return void _()}te()}),ae="isMissing"in C,{width:se,height:oe}=(0,F.bu)(w,E),re=(0,g.A)("media-inner","FPceNkgD",ae&&"hruUWBuj",I&&S&&Pn);return a.Ay.createElement("div",{ref:b,className:re,style:`width: ${se}px; height: ${oe}px;`,onClick:ae?void 0:ne},a.Ay.createElement(kn.A,{containerRef:b,sticker:w,fullMediaHash:U,fullMediaClassName:"full-media",size:se,shouldLoop:t,noLoad:!V,noPlay:!J,withSharedAnimation:!0}),a.Ay.createElement(_t.A,{isVisible:D,withAnimation:!0,thumbDataUri:Y,width:se,height:oe,className:"media-spoiler",isNsfw:i}),ee&&a.Ay.createElement(Tn.A,null,a.Ay.createElement(Sn.A,{ref:x,key:H,className:(0,g.A)(Ln,S&&Pn),tgsUrl:K,size:1.49*se,play:!0,isLowPriority:!0,noLoop:!0,onEnded:X})),a.Ay.createElement(Mn.A,{isOpen:M,onClose:T,shouldAlwaysShow:L,onAlwaysShowChanged:B,confirmHandler:j}),ee&&a.Ay.createElement(Tn.A,null,a.Ay.createElement(Sn.A,{ref:x,key:H,className:(0,g.A)(Ln,S&&Pn),tgsUrl:K,size:1.49*se,play:!0,isLowPriority:!0,noLoop:!0,onEnded:X})))}));var Rn=n(45470),Fn=n(14),Dn=n(50680),On=n(59816);const zn=(0,a.ph)(function({story:e,isPreview:t,isProtected:n,isConnected:o}){const{openStoryViewer:r,loadPeerStoriesByIds:i,showNotification:c}=(0,s.ko)(),d=(0,Z.A)(),{isMobile:m}=(0,$.Ay)(),u=e&&"isDeleted"in e,p=e&&"content"in e,A=p?e.content.video:void 0,y=p?(0,l.EN)(e):void 0,f=(0,Pe.A)(y),v=p?A?A.thumbnail?.dataUri:e.content.photo?.thumbnail?.dataUri:void 0,E=(0,Fn.A)(f,!0),{shouldRender:b,transitionClassNames:x}=(0,Dn.A)(Boolean(E)),w=(0,Rn.A)(v,u&&!t,m&&!h.QH),C=(0,g.A)("EVLTkrt1","media-inner",(!o||u)&&"AQWPv0bP",u&&"tprkr7qf",t&&"V3HabdKr");(0,a.vJ)(()=>{!e||p||u||i({peerId:e.peerId,storyIds:[e.id]})},[e,u,p]);const N=(0,P.A)(()=>{u?c({message:d("StoryNotFound")}):r({peerId:e.peerId,storyId:e.id,isSinglePeer:!0,isSingleStory:!0})});return a.Ay.createElement("div",{className:C,onClick:o?N:void 0},!u&&t&&a.Ay.createElement("canvas",{ref:w,className:"thumbnail blurred-bg"}),b&&a.Ay.createElement(a.Ay.Fragment,null,a.Ay.createElement("img",{src:E,alt:"",className:(0,g.A)("WAItYc5d",t&&"ClGe8yij",x),draggable:!1}),p&&a.Ay.createElement(On.A,{story:e,className:x})),u&&a.Ay.createElement("span",null,a.Ay.createElement(Le.A,{name:"story-expired",className:"nLA7VEhv"}),d("StoryExpiredSubtitle")),Boolean(A?.duration)&&a.Ay.createElement("div",{className:"message-media-duration"},(0,St.QO)(A.duration)),n&&a.Ay.createElement("span",{className:"protector"}))}),jn=(0,a.ph)((0,s.EK)((e,{message:t})=>{const{id:n,peerId:a}=t.content.storyData;return{story:(0,m.Msb)(e,a,n),isConnected:"connectionStateReady"===e.connectionState}})(function({message:e,story:t,isProtected:n,isConnected:s}){const{storyData:o}=e.content;return a.Ay.createElement(zn,{story:t||o,isProtected:n,isConnected:s})})),Un=(0,a.ph)((0,s.EK)((e,{message:t})=>{const{id:n,peerId:a}=t.content.storyData,s=(0,m._bp)(e,a)?.lastReadId;return{story:(0,m.Msb)(e,a,n),peer:(0,m.PVB)(e,a),targetUser:(0,m.mBe)(e,t.chatId),isUnread:Boolean(s&&s<n)}})(function({message:e,story:t,peer:n,isUnread:o,targetUser:r}){const{openStoryViewer:i}=(0,s.ko)(),d=(0,Z.A)(),{storyData:m}=e.content,u=(0,P.A)(()=>{i({peerId:t.peerId,storyId:t.id,isSinglePeer:!0,isSingleStory:!0})}),p=t&&"isDeleted"in t,h=t&&"content"in t,A=h?t.content.video:void 0,y=h?(0,l.EN)(t,"pictogram"):void 0,f=(0,Pe.A)(y)||A?.thumbnail?.dataUri;return(0,q.A)(m.peerId,m.id,t),a.Ay.createElement("div",{className:(0,g.A)("action-message-story-mention",o&&"is-unread",h&&"with-preview"),tabIndex:0,role:"button",onClick:h?u:void 0},h&&a.Ay.createElement("span",{className:"story-media-wrapper"},f&&a.Ay.createElement("img",{src:f,alt:"",className:"story-media"})),a.Ay.createElement("span",{className:"story-title"},(0,O.A)(n&&"isSelf"in n&&n.isSelf?d(p?"ExpiredStoryMentioned":"StoryYouMentionedTitle",(0,l.u0)(r)):p?d("ExpiredStoryMention"):d("StoryMentionedTitle",(0,c.F9)(d,n)),["emoji","simple_markdown"])))})),Vn=(0,a.ph)((0,s.EK)((e,{message:t})=>({sender:(0,m.Y7C)(e,t),isCurrentUserPremium:(0,m.g29)(e),isSynced:e.isSynced}))(({message:e,todoList:t,sender:n,isCurrentUserPremium:o,isSynced:r})=>{const{toggleTodoCompleted:i,showNotification:l,requestConfetti:d}=(0,s.ko)(),{todo:u,completions:p}=t,{title:h,items:A,othersCanComplete:y}=u,[f,v]=(0,a.J0)([]),E=(0,a.Kr)(()=>new Set(f),[f]),b=!e.isScheduled&&o&&r;(0,a.Nf)(()=>{const e=p?.map(e=>e.itemId.toString())||[];v(e)},[p]);const x=(0,Y.A)(),w=(0,P.A)(e=>{e.preventDefault(),e.stopPropagation(),o||l({message:x("SubscribeToTelegramPremiumForToggleTask"),action:{action:"openPremiumModal",payload:{initialSection:"todo"}},actionText:x("PremiumMore")})}),C=(0,P.A)(t=>{const n=t.find(e=>!E.has(e)),a=Array.from(E).find(e=>!t.includes(e));i({chatId:e.chatId,messageId:e.id,completedIds:n?[Number(n)]:[],incompletedIds:a?[Number(a)]:[]}),t.length===A.length&&d({})}),N=Boolean(e.forwardInfo)||!y&&!e.isOutgoing,I=e.isOutgoing,S=(0,a.Kr)(()=>A.map(e=>{const t=y?(0,m.mBe)((0,s.mS)(),p?.find(t=>t.itemId===e.id)?.completedBy||""):void 0,n=t?(0,c.em)(x,t):void 0;return{label:(0,Et.fd)(e.title),value:e.id.toString(),user:t,subLabel:n}}),[A,y,p,x]);return a.Ay.createElement("div",{className:"todo-list",dir:x.isRtl?"auto":"ltr"},a.Ay.createElement("div",{className:"todo-list-header"},a.Ay.createElement("div",{className:"todo-list-title"},(0,Et.fd)(h)),a.Ay.createElement("div",{className:"list-type"},e.forwardInfo?x("TitleToDoList"):y?x("TitleGroupToDoList"):I?x("TitleYourToDoList"):n?x("TitleUserToDoList",{peer:(0,c.F9)(x,n)},{withNodes:!0}):x("TitleToDoList"))),a.Ay.createElement("div",{className:"todo-list-items"},N?a.Ay.createElement("div",{className:"todo-list-items"},S.map(e=>a.Ay.createElement("div",{key:e.value,className:"todo-list-readonly-item"},a.Ay.createElement("div",{className:"todo-readonly-item-checkbox"},E.has(e.value)?a.Ay.createElement(Le.A,{name:"check"}):a.Ay.createElement("div",{className:"todo-item-bullet-point"})),a.Ay.createElement("div",{className:(0,g.A)("readonly-item-label",E.has(e.value)&&"completed-label")},e.label)))):a.Ay.createElement(yn.A,{options:S,selected:f,onChange:C,onClickLabel:o?void 0:w,disabled:!b,isRound:!0})),a.Ay.createElement("div",{className:"completed-tasks-count"},a.Ay.createElement(ct.A,{text:x("DescriptionCompletedToDoTasks",{number:f.length,count:S.length})})))}));var Jn=n(58849),Hn=n(87094),Kn=n(39877),$n=n(84685),Gn=n(66833),_n=n(40558);const qn=(0,a.ph)(({gift:e,observeIntersectionForLoading:t,observeIntersectionForPlaying:n,onClick:s})=>{const o=(0,a.li)(),{backdrop:r,model:i,pattern:l}=(0,Gn.uc)(e),[c,d,m]=(0,W.A)(),u=[r.centerColor,r.edgeColor];return a.Ay.createElement("div",{className:(0,g.A)("interactive-gift","LaOdPURl"),onClick:s,onMouseEnter:h.TF?void 0:d,onMouseLeave:h.TF?void 0:m},a.Ay.createElement("div",{className:"zDnMa37m"},a.Ay.createElement(_n.A,{className:"EdXfeKWY",backgroundColors:u,patternColor:r.patternColor,patternIcon:l.sticker})),a.Ay.createElement("div",{ref:o,className:"o_DYZEMV"},a.Ay.createElement(kn.A,{containerRef:o,sticker:i.sticker,size:120,shouldLoop:c,observeIntersectionForPlaying:n,observeIntersectionForLoading:t})))}),Wn=(0,a.ph)((0,s.EK)(e=>({canPlayAnimatedEmojis:(0,m.BWX)(e)}))(({messageWebPage:e,webPage:t,message:n,noAvatars:o,canAutoLoad:i,canAutoPlay:c,asForwarded:d,isDownloading:m=!1,isProtected:u,isConnected:p,story:h,theme:A,backgroundEmojiId:y,shouldWarnAboutSvg:f,autoLoadFileMaxSizeMb:v,lastPlaybackTimestamp:E,observeIntersectionForLoading:b,observeIntersectionForPlaying:x,onMediaClick:w,onDocumentClick:C,onContainerClick:N,onAudioPlay:I,onCancelMediaTransfer:S})=>{const{openUrl:M,openTelegramLink:k}=(0,s.ko)(),T=(0,a.li)(),L=(0,Z.A)(),B=(0,Y.A)(),R=(0,P.A)(()=>{w()}),F=(0,P.A)(e=>{N?.(e)}),D="full"===t?.webpageType?t:void 0,{story:z,stickers:j}=D||{};(0,q.A)(z?.peerId,z?.id,h);const U=j?.isWithTextColor||j?.documents?.[0]?.shouldUseTextColor,V=(0,Hn.A)(T,void 0,!U),J=(0,a.Kr)(()=>{const e=t?.url&&(0,me.vG)(t?.url);if(e&&"timestamp"in e)return e.timestamp},[t?.url]);if("full"!==t?.webpageType)return;const H=(0,P.A)(()=>{k({url:t.url})}),{siteName:K,url:$,displayUrl:G,title:_,description:W,photo:Q,video:X,audio:ee,type:te,document:ne}=t,{mediaSize:ae}=e,se="telegram_story"===te,oe="telegram_nft"===te,re=h&&"isDeleted"in h?void 0:function(e){switch(e){case"telegram_channel_request":case"telegram_megagroup_request":case"telegram_chat_request":return"ViewButtonRequestJoin";case"telegram_message":return"ViewButtonMessage";case"telegram_bot":return"ViewButtonBot";case"telegram_voicechat":return"ViewButtonVoiceChat";case"telegram_livestream":return"ViewButtonVoiceChatChannel";case"telegram_megagroup":case"telegram_chat":return"ViewButtonGroup";case"telegram_channel":return"ViewButtonChannel";case"telegram_user":return"ViewButtonUser";case"telegram_botapp":return"ViewButtonBotApp";case"telegram_chatlist":return"ViewChatList";case"telegram_story":return"ViewButtonStory";case"telegram_channel_boost":case"telegram_group_boost":return"ViewButtonBoost";case"telegram_stickerset":return"ViewButtonStickerset";case"telegram_emojiset":return"ViewButtonEmojiset";case"telegram_nft":return"ViewButtonGiftUnique";default:return}}(j?.isEmoji?"telegram_emojiset":te),ie=re&&B(re),le=(0,Jn.A)(W,170),ce=Boolean(le||_||K);let de=Boolean(j);ce&&t?.photo&&!t.video&&!t.document&&(de=function(e,t){if(!e?.photo)return!1;if("small"===t)return!0;if("large"===t)return!1;const{width:n,height:a}=(0,l.Xn)(e.photo)||{};return!(!n||!a||n!==a||e.hasLargeMedia)}(t,ae));const ue=(Q||X)&&w&&!de,pe=(0,g.A)("WebPage",de&&"with-square-photo",!Q&&!X&&"without-media",X&&"with-video",!ce&&"no-article",ne&&"with-document",ie&&"with-quick-button",oe&&"with-gift");return a.Ay.createElement(Be.A,{className:pe,"data-initial":(K||G)[0],dir:L.isRtl?"rtl":"auto",onClick:F},a.Ay.createElement("div",{className:(0,g.A)("WebPage--content",se&&"is-story",oe&&"is-gift")},y&&a.Ay.createElement(Kn.A,{emojiDocumentId:y,className:"WebPage--background-icons"}),se&&a.Ay.createElement(zn,{story:h,isProtected:u,isConnected:p,isPreview:!0}),oe&&a.Ay.createElement(qn,{gift:t.gift,observeIntersectionForLoading:b,observeIntersectionForPlaying:x,onClick:H}),ce&&a.Ay.createElement("div",{className:(0,g.A)("WebPage-text","WebPage-text_interactive"),onClick:()=>M({url:$,shouldSkipModal:e.isSafe})},a.Ay.createElement($n.A,{className:"site-name",url:$,text:K||G}),_&&a.Ay.createElement("p",{className:"site-title"},(0,O.A)(_)),le&&!oe&&a.Ay.createElement("p",{className:"site-description"},(0,O.A)(le,["emoji","br"]))),Q&&!oe&&!X&&!ne&&a.Ay.createElement(We.A,{photo:Q,isOwn:n?.isOutgoing,isInWebPage:!0,observeIntersection:b,noAvatars:o,canAutoLoad:i,size:de?"pictogram":"inline",asForwarded:d,nonInteractive:!ue,isDownloading:m,isProtected:u,theme:A,onClick:ue?R:void 0,onCancelUpload:S}),X&&a.Ay.createElement(Qe.A,{video:X,isOwn:n?.isOutgoing,isInWebPage:!0,observeIntersectionForLoading:b,noAvatars:o,canAutoLoad:i,canAutoPlay:c,asForwarded:d,isDownloading:m,isProtected:u,lastPlaybackTimestamp:E||J,onClick:ue?R:void 0,onCancelUpload:S}),ee&&a.Ay.createElement(Ce.Ay,{theme:A,message:n,origin:r.d9.Inline,noAvatars:o,isDownloading:m,onPlay:I,onCancelUpload:S}),ne&&a.Ay.createElement(Se.A,{document:ne,message:n,observeIntersection:b,autoLoadFileMaxSizeMb:v,onMediaClick:C,onCancelUpload:S,isDownloading:m,shouldWarnAboutSvg:f}),j&&a.Ay.createElement("div",{ref:T,className:(0,g.A)("media-inner","square-image",j.isEmoji&&"WebPage--emoji-grid","WebPage--stickers")},j.documents.map(e=>a.Ay.createElement("div",{key:e.id,className:"WebPage--sticker"},a.Ay.createElement(kn.A,{containerRef:T,sticker:e,shouldLoop:!0,size:j.isEmoji?38:80,customColor:V,observeIntersectionForPlaying:x,observeIntersectionForLoading:b}))))),ie&&(he=ie,a.Ay.createElement($e.A,{className:"WebPage--quick-button",size:"tiny",color:"translucent",isRectangular:!0,noForcedUpperCase:!0,onClick:H},he)));var he})),Qn=1.75*F.$,Yn=2.25*F.$,Zn=(0,a.ph)((0,s.EK)((e,t)=>{const{focusedMessage:n,forwardMessages:a,activeReactions:s,activeEmojiInteractions:r,loadingThread:c}=(0,m.nTw)(e),{message:g,album:f,withSenderName:v,withAvatar:E,threadId:b,messageListType:x,isLastInDocumentGroup:w,isFirstInGroup:C}=t,{id:N,chatId:I,viaBotId:S,isOutgoing:M,forwardInfo:k,transcriptionId:T,isPinned:P,viaBusinessBotId:L,effectId:B,paidMessageStars:R}=g,F=(0,m.k9R)(e,g),{shouldWarnAboutSvg:D}=(0,p.l)(e),O=(0,A.L8)(I),z=(0,m.hds)(e,I),j=(0,m.nZ4)(e,I),U=(0,l.DX)(I),V=(0,l.Qe)(I),J=z&&(0,l.WX)(z),H=z&&(0,l.YE)(z),K=O?void 0:(0,m.AWZ)(e,I),$=F?.story,G=$?(0,m.Msb)(e,$.peerId,$.id):void 0,_=a.messageIds&&a.messageIds.includes(N),q=!j&&(0,l.zP)(g),W=v||E||q,Q=(0,m.Y7C)(e,g),Y=(0,m.Szq)(e,g),Z=S?(0,m.mBe)(e,S):void 0,X=Q?.id&&H?K?.adminMembersById?.[Q?.id]:void 0,ee=g.id===b,{replyToMsgId:te,replyToPeerId:ne,replyFrom:ae}=(0,d.Q)(g)||{},{peerId:se,storyId:oe}=(0,d.W)(g)||{},re=te&&te===b,ie=(0,m.gMr)(e,g),le=k||ae,ce=ie?(0,m.Y7C)(e,ie):!le||U||V?void 0:(0,m.HdA)(e,le),de=ie&&(0,m.Szq)(e,ie),me=ne?(0,m.hds)(e,ne):void 0,ue=!U&&!V&&me&&!(0,l.gA)(me)&&(me.isNotJoined||(0,m._ls)(e,me.id)),pe="topicCreate"===ie?.content.action?.type,he=oe&&se?(0,m.Msb)(e,se,oe):void 0,ge=se?(0,m.PVB)(e,se):void 0,Ae=(0,m.ldX)(e,g),ye="thread"===x&&(f?f.messages.some(t=>(0,m.nJv)(e,t,b)):(0,m.nJv)(e,g,b)),{direction:fe,noHighlight:ve,isResizingContainer:Ee,quote:be,quoteOffset:xe,scrollTargetPosition:we}=ye&&n||{},Ce=(0,m.TCk)(e),Ne=Ce?.results?.query&&`${Ce.isHashtag?"#":""}${Ce.results.query}`,Ie=(0,l.wb)(g),Se=Ie&&(0,m.oei)(e,Ie)?Ie:void 0,Me=(0,l.Jw)(g);let ke;ke=f?.messages?f.messages.every(({id:t})=>(0,m.H1_)(e,t)):(0,m.H1_)(e,N);const Te="thread"===x&&(0,m.tOf)(e,g,b),Pe=(0,m.yuw)(e),Le=(0,u.iS)(e,g),Be=Le&&(0,l.$r)(Pe,Le),Re=(0,m.Vw0)(e,I,f?.commentsMessage?.id||N),Fe=Boolean(g.groupedId)&&!g.isInAlbum,De=Fe?(0,m.D_S)(e,I,g.groupedId)[0]:void 0,Oe=Fe?w?(0,m.O5q)(e,I,De):void 0:g,ze=z?.unreadReactions?.includes(g.id),je=b===o.l3&&z?.isForum&&C,Ue=je?(0,m.nkm)(e,g):void 0,Ve=(0,m.RnX)(e,I),Je=(0,m.Rny)(e,I,g.id),He=(0,m.qZq)(e,I),Ke=h.CM&&e.settings.byKey.canTranslate&&!He,$e="connectionStateReady"===e.connectionState,Ge=Boolean(Oe&&s[(0,y.bj)(Oe)]?.length),_e=(0,m.g29)(e),qe=Q&&(0,m.nZ4)(e,Q.id)?K?.boostsApplied??g.senderBoosts:g.senderBoosts,We=z?.boostLevel||0,Qe=e.appConfig?.groupTranscribeLevelMin,Ye=(_e||Boolean(Qe&&We>=Qe),L?(0,m.mBe)(e,L):void 0),Ze=B?e.availableEffectById[B]:void 0,Xe=(0,m.zcZ)(e,g),et=(0,u.me)(e,g),tt=(0,u.xd)(e,I,g.id),nt=Je?Boolean((0,m.a_$)(e,g.chatId,Je)[g.id]?.text):void 0,at=(0,m.trm)(e),st=e.appConfig?.starsSuggestedPostFutureMin||i.WHU,ot=(0,u.B9)(e,g),rt=ie&&(0,u.B9)(e,ie);return{theme:(0,m.SJA)(e),forceSenderName:q,sender:Q,canShowSender:W,originSender:Y,botSender:Z,shouldHideReply:re||pe,isThreadTop:ee,replyMessage:ie,replyMessageSender:ce,replyMessageForwardSender:de,replyMessageChat:me,replyStory:he,isReplyPrivate:ue,storySender:ge,isInDocumentGroup:Fe,isProtected:(0,m.ynf)(e,g),isChatProtected:(0,m.ryq)(e,I),isFocused:ye,isForwarding:_,reactionMessage:Oe,isChatWithSelf:j,isRepliesChat:U,isAnonymousForwards:V,isChannel:J,isGroup:H,canReply:Te,highlight:Ne,animatedEmoji:Se,animatedCustomEmoji:Me,isInSelectMode:(0,m.rTV)(e),isSelected:ke,isGroupSelected:Boolean(g.groupedId)&&!g.isInAlbum&&(0,m.SLS)(e,I,g.groupedId),threadId:b,isDownloading:Be,isPinnedList:"pinned"===x,isPinned:P,canAutoLoadMedia:(0,m.wwb)(e,g),canAutoPlayMedia:(0,m.OEt)(e,g),autoLoadFileMaxSizeMb:e.settings.byKey.autoLoadFileMaxSizeMb,shouldLoopStickers:(0,m.ML4)(e),repliesThreadInfo:Re,availableReactions:e.reactions.availableReactions,defaultReaction:(0,l.Nb)(g)||"scheduled"===x?void 0:(0,m.nTJ)(e,I),hasActiveReactions:Ge,activeEmojiInteractions:r,hasUnreadReaction:ze,isTranscribing:void 0!==T&&e.transcriptions[T]?.isPending,transcribedText:void 0!==T?e.transcriptions[T]?.text:void 0,hasTranslation:nt,isPremium:_e,senderAdminMember:X,messageTopic:Ue,hasTopicChip:je,chatTranslations:Ve,areTranslationsEnabled:Ke,shouldDetectChatLanguage:(0,m.LRV)(e,I),requestedTranslationLanguage:Je,requestedChatTranslationLanguage:He,hasLinkedChat:Boolean(K?.linkedChatId),withAnimatedEffects:(0,m.xYJ)(e,"stickerEffects"),webPageStory:G,isConnected:$e,isLoadingComments:Re?.isCommentsInfo&&c?.loadingChatId===Re?.originChannelId&&c?.loadingMessageId===Re?.originMessageId,shouldWarnAboutSvg:D,...M&&{outgoingStatus:(0,m.Tl2)(e,g,"scheduled"===x)},..."number"==typeof Ae&&{uploadProgress:Ae},...ye&&{focusDirection:fe,noFocusHighlight:ve,isResizingContainer:Ee,focusedQuote:be,focusedQuoteOffset:xe,scrollTargetPosition:we},senderBoosts:qe,tags:e.savedReactionTags?.byKey,canTranscribeVoice:!0,viaBusinessBot:Ye,minFutureTime:st,effect:Ze,poll:Xe,maxTimestamp:et,lastPlaybackTimestamp:tt,paidMessageStars:R,isChatWithUser:O,isAccountFrozen:at,isMediaNsfw:ot,isReplyMediaNsfw:rt,webPage:F}})(({message:e,observeIntersectionForBottom:t,observeIntersectionForLoading:n,observeIntersectionForPlaying:m,album:u,noAvatars:p,withAvatar:A,withSenderName:y,noComments:b,noReplies:x,appearanceOrder:w,isJustAdded:C,isFirstInGroup:N,isPremium:I,isLastInGroup:S,isFirstInDocumentGroup:M,isLastInDocumentGroup:k,isTranscribing:T,transcribedText:L,hasTranslation:B,isLastInList:U,theme:J,forceSenderName:H,sender:ne,canShowSender:ae,originSender:ie,botSender:pe,isThreadTop:he,shouldHideReply:ge,replyMessage:Ae,replyMessageSender:ye,replyMessageForwardSender:fe,replyMessageChat:ve,replyStory:Ee,isReplyPrivate:xe,storySender:we,outgoingStatus:Te,uploadProgress:Pe,isInDocumentGroup:Be,isLoadingComments:je,isProtected:Ue,isChatProtected:Ve,isFocused:Je,focusDirection:qe,focusedQuote:Ye,focusedQuoteOffset:Ze,noFocusHighlight:et,scrollTargetPosition:tt,isResizingContainer:nt,isForwarding:at,isChatWithSelf:ot,isRepliesChat:it,isAnonymousForwards:lt,isChannel:ct,isGroup:dt,canReply:ut,highlight:pt,animatedEmoji:ht,animatedCustomEmoji:gt,hasActiveReactions:yt,hasLinkedChat:ft,isInSelectMode:Et,isSelected:bt,isGroupSelected:xt,threadId:wt,reactionMessage:Nt,availableReactions:St,defaultReaction:Mt,activeEmojiInteractions:kt,messageListType:Tt,isPinnedList:Pt,isPinned:Lt,isDownloading:Bt,canAutoLoadMedia:Rt,canAutoPlayMedia:Ft,shouldLoopStickers:Dt,autoLoadFileMaxSizeMb:Ot,repliesThreadInfo:jt,hasUnreadReaction:Vt,memoFirstUnreadIdRef:Jt,senderAdminMember:Ht,messageTopic:Kt,hasTopicChip:Gt,chatTranslations:_t,areTranslationsEnabled:qt,shouldDetectChatLanguage:Qt,requestedTranslationLanguage:Yt,requestedChatTranslationLanguage:Zt,withAnimatedEffects:Xt,webPageStory:en,isConnected:tn,getIsMessageListReady:nn,shouldWarnAboutSvg:an,senderBoosts:sn,tags:cn,canTranscribeVoice:dn,viaBusinessBot:un,effect:hn,poll:An,maxTimestamp:yn,lastPlaybackTimestamp:fn,isMediaNsfw:vn,isReplyMediaNsfw:En,paidMessageStars:bn,isChatWithUser:xn,isAccountFrozen:In,minFutureTime:Sn,webPage:Mn,onIntersectPinnedMessage:kn})=>{const{toggleMessageSelection:Tn,clickBotInlineButton:Pn,clickSuggestedMessageButton:Ln,rejectSuggestedPost:Rn,openSuggestedPostApprovalModal:Fn,disableContextMenuHint:Dn,animateUnreadReaction:On,focusLastMessage:zn,markMentionsRead:Jn}=(0,s.ko)(),Hn=(0,a.li)(),Kn=(0,a.li)(),$n=(0,a.li)(),Gn=(0,a.li)(),_n=(0,Z.A)(),qn=(0,Y.A)(),[Zn,Xn]=(0,a.J0)(!1),[ea,ta]=(0,a.J0)(!1),[na,aa]=(0,a.J0)(!1),[sa,oa,ra]=(0,W.A)(),[ia,la,ca]=(0,W.A)(),[da,ma]=(0,a.J0)(""),{isMobile:ua,isTouchScreen:pa}=(0,$.Ay)();(0,Q.mv)(Kn,t);const{isContextMenuOpen:ha,contextMenuAnchor:ga,contextMenuTarget:Aa,handleBeforeContextMenu:ya,handleContextMenu:fa,handleContextMenuClose:va,handleContextMenuHide:Ea}=(0,G.A)(Hn,pa&&Et||In,!h.cp,h.Ni,nn),{isGptMenuOpen:ba,gptMenuPosition:xa}=(e=>{const[t,n]=(0,a.J0)(!1),[s,o]=(0,a.J0)("bottom"),[r,i]=(0,a.J0)(!1);return(0,a.vJ)(()=>{let e=null;const t=()=>{i(!0),e&&window.clearTimeout(e),e=window.setTimeout(()=>{i(!1)},200)};return window.addEventListener("scroll",t,!0),()=>{window.removeEventListener("scroll",t,!0),e&&window.clearTimeout(e)}},[]),(0,a.vJ)(()=>{const t=e?.current;if(!t)return;const a=()=>{if(r)return;const e=t.getBoundingClientRect(),a=window.innerHeight-e.bottom;o(a<150?"top":"bottom"),n(!0)},s=()=>n(!1);return t.addEventListener("mouseenter",a),t.addEventListener("mouseleave",s),()=>{t.removeEventListener("mouseenter",a),t.removeEventListener("mouseleave",s)}},[e,r]),{isGptMenuOpen:t,gptMenuPosition:s}})(Gn);(0,a.vJ)(()=>{ha&&Dn()},[ha,Dn]);const wa=w<=0,[Ca,Na]=(0,W.A)(wa);(0,a.vJ)(()=>{wa||setTimeout(Na,w*i.zq7)},[w,Na,wa]),(0,te.A)({ref:Hn,isOpen:Ca||C,noMountTransition:wa&&!C,className:!1});const{id:Ia,chatId:Sa,forwardInfo:Ma,viaBotId:ka,isTranscriptionError:Ta,factCheck:Pa}=e;(0,a._W)(()=>{if(e.isPinned){const e=u?u.mainMessage.id:Ia;kn?.({viewportPinnedIdsToRemove:[e]})}});const La=(0,l.Nb)(e),Ba=(0,l.Ie)(e),Ra="scheduled"===Tt||e.isScheduled,Fa=(0,l.Tv)(e)&&!ge,{paidMedia:Da}=(0,l.r_)(e),{photo:Oa,video:za}=j(Da),{photo:ja=Oa,video:Ua=za,audio:Va,voice:Ja,document:Ha,sticker:Ka,contact:$a,invoice:Ga,location:_a,action:qa,game:Wa,storyData:Qa,giveaway:Ya,giveawayResults:Za,todo:Xa}=(0,l.r_)(e),es=(0,d.Q)(e),ts=(0,d.W)(e),ns=Boolean(!Zn&&(Ta||L)),as=Boolean(ts),ss=Boolean(jt)&&"thread"===Tt,os=!ns&&(0,l.aN)(e),rs=os&&(ht||gt),is=Nt?.reactions&&!(0,l.G)(Nt.reactions),ls=Ma&&(!ot||Ra)&&!it&&!Ma.isLinkedChannelPost&&!lt&&!pe||Boolean(Qa&&!Qa.isMention),cs=Boolean(sn)&&!ls&&N,ds=Qa?.isMention,ms="video"===Ua?.mediaType&&Ua.isRound,us=Boolean(u)&&(u.isPaidMedia&&Da.extendedMedia.length>1||u.messages.length>1)&&!u.messages.some(e=>0===Object.keys(e.content).length),ps=Be&&!M,hs=Be&&!k,gs=void 0!==ga,As=!(gs||Et||at||hs||ds||(Ka||rs)&&ls),ys=ct&&!Ra&&e.isForwardingAllowed&&!Ve,fs=Boolean(Pt||Ma&&(Ma.isChannelPost||ot||it||lt)&&Ma.fromMessageId),vs=Boolean(Pa?.text),Es=ls&&os,bs=Gt||Fa||as||Es,xs=(0,P.A)((e,t)=>{In||Tn({messageId:Ia,groupedId:t,...e?.shiftKey&&{withShift:!0},...us&&{childMessageIds:u.messages.map(({id:e})=>e)}})}),ws=ae?ne:void 0,Cs=Ma&&(ot||it||lt||!ws)?ie:ws,Ns=ls?ie:ne,Is=Ba&&!os,Ss=Ma||Qa?ie:ws,Ms=(0,l.G5)(e),{handleMouseDown:ks,handleClick:Ts,handleContextMenu:Ps,handleDoubleClick:Ls,handleContentDoubleClick:Bs,handleMouseMove:Rs,handleSendQuickReaction:Fs,handleMouseLeave:Ds,isSwiped:Os,isQuickReactionVisible:zs,handleDocumentGroupMouseEnter:js}=be(xs,Hn,Ia,Boolean(Et),Boolean(ut),Boolean(Ue),fa,ya,Sa,gs,$n,hs,nn),{handleSenderClick:Us,handleViaBotClick:Vs,handleReplyClick:Js,handleMediaClick:Hs,handleDocumentClick:Ks,handleAudioPlay:$s,handleAlbumMediaClick:Gs,handlePhotoMediaClick:_s,handleVideoMediaClick:qs,handleMetaClick:Ws,handleTranslationClick:Qs,handleOpenThread:Ys,handleReadMedia:Zs,handleCancelUpload:Xs,handleVoteSend:eo,handleGroupForward:to,handleForward:no,handleFocus:ao,handleFocusForwarded:so,handleDocumentGroupSelectAll:oo,handleTopicChipClick:ro,handleStoryClick:io}=function({lang:e,selectMessage:t,message:n,webPage:a,chatId:i,threadId:c,isInDocumentGroup:m,asForwarded:u,isScheduled:p,album:h,senderPeer:g,botSender:A,messageTopic:y,isTranslatingChat:f,story:v,isReplyPrivate:E,isRepliesChat:b,isSavedMessages:x,lastPlaybackTimestamp:w}){const{openChat:C,showNotification:N,focusMessage:I,openMediaViewer:S,openAudioPlayer:M,markMessagesRead:k,cancelUploadMedia:T,sendPollVote:L,openForwardMenu:B,openChatLanguageModal:R,openThread:F,openStoryViewer:D,searchChatMediaMessages:O}=(0,s.ko)(),{id:z,forwardInfo:j,groupedId:U,content:{paidMedia:V,video:J}}=n,{replyToMsgId:H,replyToPeerId:K,replyToTopId:$,isQuote:G,quoteText:_,quoteOffset:q}=(0,d.Q)(n)||{},W=(0,P.A)(()=>{g?u&&j?.channelPostId?I({chatId:g.id,messageId:j.channelPostId}):C({id:g.id}):N({message:e("HidAccount")})}),Q=(0,P.A)(()=>{A&&C({id:A.id})}),Y=(0,P.A)(()=>{H&&!E?b&&K&&$?F({isComments:!0,originChannelId:K,originMessageId:$,focusMessageId:H}):I({chatId:K||i,threadId:b?$:c,messageId:H,replyMessageId:K?void 0:z,noForumTopicPanel:!K,...G&&{quote:_?.text,quoteOffset:q}}):N({message:e(G?"QuotePrivate":"ReplyPrivate")})}),Z=(0,P.A)(()=>{S({chatId:i,threadId:c,messageId:z,origin:p?r.TQ.ScheduledInline:r.TQ.Inline})}),X=(0,P.A)(e=>{if(V&&!V.isBought)return;e&&O({chatId:i,threadId:c,currentMediaMessageId:z});const t=a?.url&&(0,me.vG)(a.url),n=J||(0,l.rU)(a),s=t&&"timestamp"in t?t.timestamp:void 0;S({chatId:i,threadId:c,messageId:z,origin:p?r.TQ.ScheduledInline:r.TQ.Inline,timestamp:w||n?.timestamp||s,withDynamicLoading:e})}),ee=(0,P.A)(()=>{X(!p&&!V)}),te=(0,P.A)(()=>{const e=n.content?.video?.isGif;X(!e&&!p&&!V)}),ne=(0,P.A)(()=>{((0,l.yl)(n)||(0,l.eY)(a))&&ee(),te()}),ae=(0,P.A)(()=>{M({chatId:i,messageId:z})}),se=(0,P.A)((e,t)=>{V&&!V.isBought||(O({chatId:i,threadId:c,currentMediaMessageId:z}),S({chatId:i,threadId:c,messageId:e,mediaIndex:t,origin:p?r.TQ.ScheduledAlbum:r.TQ.Album,withDynamicLoading:!V}))}),oe=(0,P.A)(()=>{k({messageIds:[z]})}),re=(0,P.A)(()=>{T({chatId:i,messageId:z})}),ie=(0,P.A)(e=>{L({chatId:i,messageId:z,options:e})}),le=(0,P.A)(()=>{B({fromChatId:i,groupedId:U})}),ce=(0,P.A)(()=>{if(h&&h.messages){const e=h.messages.map(({id:e})=>e);B({fromChatId:i,messageIds:e})}else B({fromChatId:i,messageIds:[z]})}),de=(0,P.A)(()=>{I({chatId:i,threadId:o.l3,messageId:z})}),ue=(0,P.A)(()=>{const e=x&&j.savedFromPeerId||j.fromChatId;m?I({chatId:e,groupedId:U,groupedChatId:i,messageId:j.fromMessageId}):K&&$?b?F({isComments:!0,originChannelId:K,originMessageId:$,focusMessageId:j.fromMessageId}):I({chatId:K,threadId:$,messageId:j.fromMessageId}):I({chatId:e,messageId:j.fromMessageId})}),pe=(0,P.A)(e=>{e.stopPropagation(),t(e,U)}),he=(0,P.A)(e=>{e.stopPropagation(),R({chatId:i,messageId:f?void 0:z})}),ge=(0,P.A)(()=>{F({chatId:n.chatId,threadId:n.id})}),Ae=(0,P.A)(()=>{y&&I({chatId:K||i,threadId:y.id,messageId:z})}),ye=(0,P.A)(()=>{v&&D({peerId:v.peerId,storyId:v.id,isSingleStory:!0})});return{handleSenderClick:W,handleViaBotClick:Q,handleReplyClick:Y,handleDocumentClick:Z,handleMediaClick:ne,handleAudioPlay:ae,handleAlbumMediaClick:se,handlePhotoMediaClick:ee,handleVideoMediaClick:te,handleMetaClick:pe,handleTranslationClick:he,handleOpenThread:ge,handleReadMedia:oe,handleCancelUpload:re,handleVoteSend:ie,handleGroupForward:le,handleForward:ce,handleFocus:de,handleFocusForwarded:ue,handleDocumentGroupSelectAll:pe,handleTopicChipClick:Ae,handleStoryClick:ye}}({lang:_n,selectMessage:xs,message:e,webPage:Mn,chatId:Sa,threadId:wt,isInDocumentGroup:Be,asForwarded:ls,isScheduled:Ra,album:u,avatarPeer:Cs,senderPeer:Ss,botSender:pe,messageTopic:Kt,isTranslatingChat:Boolean(Zt),story:Ee&&"content"in Ee?Ee:void 0,isReplyPrivate:xe,isRepliesChat:it,isSavedMessages:ot,lastPlaybackTimestamp:fn}),lo=(0,P.A)(e=>{e.stopPropagation(),oa()});(0,a.vJ)(()=>{U&&ns&&L&&zn()},[zn,U,L,ns]),(0,a.vJ)(()=>{const t=Hn.current,n=e.isInAlbum&&u?.messages.some(e=>!e.isDeleting);e.isDeleting&&t&&!n&&((0,Ke.U)(t)?ta(!0):aa(!0))},[e.isDeleting]);const co=u?.hasMultipleCaptions?void 0:u?.captionMessage||e,mo=co&&(0,l.XR)(co),uo=mo||vs,po=(0,g.A)("Message message-list-item",N&&"first-in-group",Ue&&"hide-on-print",Ue&&!mo?"is-protected":"allow-selection",S&&"last-in-group",M&&"first-in-document-group",k&&"last-in-document-group",U&&"last-in-list",Ba&&"own",Boolean(e.viewsCount)&&"has-views",e.isEdited&&"was-edited",Fa&&"has-reply",ha&&"has-menu-open",Je&&!et&&"focused",at&&"is-forwarding",na&&"is-deleting",ea&&"is-dissolving",Be&&"is-in-document-group",us&&"is-album",e.hasUnreadMention&&"has-unread-mention",bt&&"is-selected",Et&&"is-in-selection-mode",he&&!A&&"is-thread-top",Boolean(e.inlineButtons)&&"has-inline-buttons",Os&&"is-swiped",C&&"is-just-added",(yt||sa)&&"has-active-effect",ds&&"is-story-mention",!As&&"no-action-button"),ho=co&&(0,l.r_)(co).text,go=Boolean(e.isInvertedMedia),{replyToMsgId:Ao,replyToPeerId:yo}=es||{},{peerId:fo,storyId:vo}=ts||{};(0,a.vJ)(()=>{(Ka?.hasEffect||hn)&&(Jt?.current&&Ia>=Jt.current||La)&&oa()},[hn,La,Jt,Ia,Ka?.hasEffect]);const Eo=function(e,t,n){const[s,o]=(0,a.J0)();return(0,a.vJ)(()=>{t||n&&!n()||(e?async function(e,t=.2){return se||await oe.promise,await se.request({name:"detectLanguage",args:[e,t]})}(e).then(o):o(void 0))},[t,e,n]),s}(ho?.text,!(qt||Qt),nn);!function(e,t,n,s){(0,a.vJ)(()=>{if(n||s&&!s())return;const a=Boolean(e.content.text?.text.length);!function({chatId:e,id:t,isTranslatable:n,detectedLanguage:a}){const s=le.get(e)||new re.A(150),o=s.get(t);o&&o.detectedLanguage===a&&o.isTranslatable===n||(s.set(t,{id:t,isTranslatable:n,detectedLanguage:a}),le.set(e,s),ce(e))}({chatId:e.chatId,id:e.id,isTranslatable:a,detectedLanguage:t})},[e,t,n,s])}(e,Eo,!Qt,nn);const bo=(0,l.ZR)(e,!0),{isPending:xo,translatedText:wo}=(0,ue.A)(_t,Sa,bo?Ia:void 0,Yt),Co=(0,X.A)(wo,Boolean(bo)),No=wo||Co,Io="phoneCall"===qa?.type?qa:void 0,So=(jt||ft&&ct&&La)&&!hs&&"thread"===Tt&&!b,Mo=jt?.isCommentsInfo&&!hs&&"thread"===Tt&&!b,ko=!pa&&!Io&&!Et&&Mt&&!hs&&!ds&&!Ms&&!In,To=!ns&&is&&(os||(ja||Ua||Qa||"geo"===_a?.mediaType)&&!uo),Po=function(e,t,{poll:n,webPage:a,hasSubheader:s,isCustomShape:o,isLastInGroup:r,asForwarded:c,hasThread:d,forceSenderName:m,hasCommentCounter:u,hasCommentButton:p,hasActionButton:h,hasReactions:g,isGeoLiveActive:A,withVoiceTranscription:y,peerColorClass:f,hasOutsideReactions:v}={}){const{paidMedia:E}=(0,l.r_)(e),{photo:b,video:x}=j(E),w=(0,l.r_)(e),{photo:C=b,video:N=x,audio:I,voice:S,document:M,contact:k,location:T,invoice:P,storyData:L,giveaway:B,giveawayResults:R}=w,F=t?.hasMultipleCaptions?void 0:(0,l.r_)(t?.captionMessage||e).text,D=Boolean(e.factCheck?.text),O="video"===N?.mediaType&&N.isRound,z=e.isInvertedMedia,U=C||N&&!O||t||a,V=[i.zPk],J=L||C||N||T||P?.extendedMedia||E,H=F||"venue"===T?.mediaType||A||D,K=J&&!H,$=Boolean(e.inlineButtons),G=Boolean(e.viaBotId),_=z&&U?!(!g||v)||!!D||!(!a||!H):H;return f&&V.push(f),!J&&e.emojiOnlyCount?(V.push("emoji-only"),e.emojiOnlyCount<=i.Apc&&V.push(`emoji-only-${e.emojiOnlyCount}`)):H?V.push("text"):V.push("no-text"),Object.keys(w).length||V.push("unsupported"),h&&V.push("has-action-button"),o&&(V.push("custom-shape"),O&&V.push("round"),u&&V.push("has-comment-counter")),J&&!y?V.push("media"):N?V.push("video"):I?V.push("audio"):S?(V.push("voice"),y&&V.push("with-voice-transcription")):M?V.push("document"):k?V.push("contact"):n?V.push("poll"):B||R?V.push("giveaway"):"full"===a?.webpageType&&(V.push("web-page"),(a.photo||a.video)&&V.push("media"),a.document&&V.push("document"),a.gift&&V.push("gift")),P&&!P.extendedMedia&&V.push("invoice"),P&&P.photo&&V.push("has-photo"),L&&V.push("story"),c&&V.push("is-forwarded"),s&&V.push("has-subheader"),d&&V.push("has-replies"),g&&V.push("has-reactions"),v&&V.push("has-outside-reactions"),G&&V.push("is-via-bot"),m&&V.push("force-sender-name"),o||(V.push("has-shadow"),J&&d&&V.push("has-background"),(s||c||G||!K||m||D||y)&&V.push("has-solid-background"),D&&V.push("has-fact-check"),!r||$||!C&&K&&!p||V.push("has-appendix")),U&&z&&V.push("is-inverted-media"),_?V.push("has-footer"):V.push("no-footer"),V.join(" ")}(e,u,{poll:An,webPage:Mn,hasSubheader:bs,isCustomShape:os,isLastInGroup:S,asForwarded:ls,hasThread:ss&&!b,forceSenderName:H,hasCommentCounter:ss&&jt.messagesCount>0,hasCommentButton:Mo,hasActionButton:ys||fs,hasReactions:is,isGeoLiveActive:"geoLive"===_a?.mediaType&&!(0,l.vz)(e),withVoiceTranscription:ns,peerColorClass:(0,D.y)(Ns,Is,!0),hasOutsideReactions:To}),Lo=Po.includes("has-appendix"),Bo=(0,z.Rr)(e.emojiOnlyCount),Ro=xn?void 0:us&&bn?u.messages.length*bn:bn;let Fo,Do;Fo=Io||hs?"none":!uo||Mn||Bo||go?go&&!Bo&&(vs||Mn)?"in-text":"standalone":"in-text",is?To?Do="outside":ls?(Fo="standalone",Do="inside"):Do="inside":Do="none";const Oo=os?"in-meta":"in-content";(0,_.A)(yo||Sa,Ao,Ae,e.id,ge||xe),(0,q.A)(fo||Sa,vo,Ee),(0,de.A)({elementRef:Hn,chatId:Sa,isFocused:Je,focusDirection:qe,noFocusHighlight:et,isResizingContainer:nt,isJustAdded:C,isQuote:Boolean(Ye),scrollTargetPosition:tt});const zo=un?(0,c.em)(_n,un):void 0,jo=!e.senderId,Uo=zo||jo&&e.postAuthorTitle||(ls||ot)&&Ma?.postAuthorTitle||void 0;(0,ee.A)(Hn,U),(0,a.vJ)(()=>{const t=Kn.current;if(!t||!(0,E.Y)(t))return;Vt&&On({messageIds:[Ia]});let n=[];e.hasUnreadMention&&(n=[Ia]),u&&(n=u.messages.filter(e=>e.hasUnreadMention).map(e=>e.id)),n.length&&Jn({chatId:Sa,messageIds:n})},[Vt,u,Sa,Ia,On,e.hasUnreadMention]);const Vo=(0,a.Kr)(()=>us?K(Ba,Boolean(p),u,ua):void 0,[us,Ba,p,u,ua]),Jo=ls&&!os?28:0,Ho=(0,a.Kr)(()=>{let e,t,n,a=!1,s="";if(!us&&(ja||Ua||Ga?.extendedMedia)){let n;if(ja||Ua){const e=ja||Ua;e&&!ms&&(n=(0,V.yA)({media:e,isOwn:Ba,asForwarded:ls,noAvatars:p,isMobile:ua}).width)}else if(Ga?.extendedMedia&&Ga.extendedMedia.width&&Ga.extendedMedia.height){const{width:e,height:t}=Ga.extendedMedia;n=(0,F.kn)({width:e,height:t,fromOwnMessage:Ba,asForwarded:ls,noAvatars:p,isMobile:ua}).width}n&&(n<V.MC&&(t=n),e=Math.max((0,V.nP)(ho?.text,So),n),!ls&&Ga?.extendedMedia&&e-n>18&&(a=!0))}else Vo&&(e=Math.max((0,V.nP)(ho?.text,So),Vo.containerStyle.width),e-Vo.containerStyle.width>18&&(a=!0));if(e)s=`width: ${e}px`,n=e+Yn;else if(Ka&&!bs){const{width:e}=(0,F.bu)(Ka,ua);s=`width: ${e+Jo}px`,n=e+Yn}return{contentWidth:t,noMediaCorners:a,style:s,reactionsMaxWidth:n}},[Vo,ls,Jo,bs,Ga?.extendedMedia,us,So,ua,Ba,p,ja,Ka,ho?.text,Ua,ms]),{contentWidth:Ko,noMediaCorners:$o,style:Go,reactionsMaxWidth:_o}=Ho;function qo(e){if(co)return a.Ay.createElement(Oe.A,{messageOrStory:co,translatedText:Yt||B?No:void 0,isForAnimation:e,focusedQuote:Ye,focusedQuoteOffset:Ze,emojiSize:Bo,highlight:pt,isProtected:Ue,observeIntersectionForLoading:n,observeIntersectionForPlaying:m,withTranslucentThumbs:os,isInSelectMode:Et,canBeEmpty:vs,maxTimestamp:yn,threadId:wt})}const Wo=(0,a.hb)(()=>{if(Mt)return a.Ay.createElement("div",{className:(0,g.A)("quick-reaction","no-selection",zs&&!yt&&"visible"),onClick:Fs,ref:$n},a.Ay.createElement(ze.A,{reaction:Mt,size:Qn,availableReactions:St,observeIntersection:m}))},[yt,St,Mt,Fs,zs,m]);function Qo(){const t=a.Ay.createElement(mn,{message:e,isPinned:Lt,withFullDate:ot&&!Ba,noReplies:x,repliesThreadInfo:jt,outgoingStatus:Te,signature:Uo,withReactionOffset:"inside"===Do,renderQuickReactionButton:ko&&"in-meta"===Oo?Wo:void 0,availableReactions:St,isTranslated:Boolean(Yt?No:void 0),effectEmoji:hn?.emoticon,onClick:Ws,onEffectClick:lo,onTranslationClick:Qs,onOpenThread:Ys,paidMessageStars:Ro});return"inside"!==Do?t:a.Ay.createElement(Cn.A,{message:Nt,threadId:wt,metaChildren:t,observeIntersection:m,noRecentReactors:ct,tags:cn,isCurrentUserPremium:I,isAccountFrozen:In})}function Yo(){const t=(0,l.T_)(e);if(t&&Mn)return a.Ay.createElement(Wn,{messageWebPage:t,webPage:Mn,message:e,observeIntersectionForLoading:n,observeIntersectionForPlaying:m,noAvatars:p,canAutoLoad:Rt,canAutoPlay:Ft,asForwarded:ls,isDownloading:Bt,isProtected:Ue,theme:J,story:en,isConnected:tn,lastPlaybackTimestamp:fn,backgroundEmojiId:Ns?.color?.backgroundEmojiId,shouldWarnAboutSvg:an,autoLoadFileMaxSizeMb:Ot,onAudioPlay:$s,onMediaClick:Hs,onDocumentClick:Ks,onCancelMediaTransfer:Xs})}function Zo(e){const t=a.Ay.createElement(a.Ay.Fragment,null,us&&n&&a.Ay.createElement(Xe,{album:u,albumLayout:Vo,observeIntersection:n,isOwn:Ba,isProtected:Ue,hasCustomAppendix:e,onMediaClick:Gs}),!us&&ja&&a.Ay.createElement(We.A,{messageText:ho?.text,photo:ja,isOwn:Ba,observeIntersection:n,noAvatars:p,canAutoLoad:Rt,uploadProgress:Pe,shouldAffectAppendix:e,isDownloading:Bt,isProtected:Ue,asForwarded:ls,theme:J,isMediaNsfw:vn,forcedWidth:Ko,onClick:_s,onCancelUpload:Xs}),!us&&Ua&&!ms&&a.Ay.createElement(Qe.A,{video:Ua,isOwn:Ba,observeIntersectionForLoading:n,observeIntersectionForPlaying:m,forcedWidth:Ko,noAvatars:p,canAutoLoad:Rt,canAutoPlay:Ft,uploadProgress:Pe,isDownloading:Bt,isProtected:Ue,asForwarded:ls,isMediaNsfw:vn,lastPlaybackTimestamp:fn,onClick:qs,onCancelUpload:Xs}));return Da?a.Ay.createElement(gn,{chatId:Sa,messageId:Ia,paidMedia:Da,isOutgoing:Ba},t):t}function Xo(){return!(os&&!ka)&&(y&&(!(ja||Ua||_a||Da)||Gt)||ls||ka||H)&&!ps&&!(Fa&&os)}function er(){return a.Ay.createElement("span",{className:"forward-title-container"},ls&&a.Ay.createElement(Le.A,{name:Ma?.hiddenUserName?"forward":"share-filled"}),ls&&a.Ay.createElement("span",{className:"forward-title"},_n("ForwardedFrom")))}const tr=(0,P.A)(t=>{"suggestedMessage"===t.button.type&&("approve"!==t.button.buttonType?"decline"!==t.button.buttonType?Ln({...t,button:t.button}):la():Fn({chatId:Sa,messageId:e.id}))}),nr=(0,P.A)(e=>{ma(e.target.value)}),ar=(0,P.A)(()=>{Rn({chatId:Sa,messageId:e.id,rejectComment:da.trim()||void 0}),ca(),ma("")});function sr(t=!1,s=!1){let o;!Ss||os&&ka?Ma?.hiddenUserName?o=Ma.hiddenUserName:Qa&&ie&&(o=(0,c.em)(_n,ie)):o=(0,c.em)(_n,Ss);const r=Ss&&"emojiStatus"in Ss&&Ss.emojiStatus,d=Ss&&"isPremium"in Ss&&Ss.isPremium,u=ls&&Ss,p=pe?.hasUsername;return a.Ay.createElement("div",{className:"message-title",dir:"ltr"},o||ls?a.Ay.createElement("span",{className:(0,g.A)("message-title-name-container",Ma?.hiddenUserName?"sender-hidden":"interactive",void 0),dir:"ltr"},!t&&er(),a.Ay.createElement("span",{className:"message-title-name"},Qa&&a.Ay.createElement(Le.A,{name:"play-story"}),u&&a.Ay.createElement(Ne.A,{className:"forward-avatar",peer:Ss,size:"micro"}),a.Ay.createElement("span",{className:"sender-title",onClick:Us},o?(0,O.A)(o):ls?" ":void 0),!ls&&r&&a.Ay.createElement(Ie.A,{documentId:r.documentId,className:"no-selection",loopLimit:i.J$1,observeIntersectionForLoading:n,observeIntersectionForPlaying:m}),!ls&&!r&&d&&a.Ay.createElement(De.A,null),Ss?.fakeType&&a.Ay.createElement(Fe.A,{fakeType:Ss.fakeType}))):pe?void 0:" ",pe?.hasUsername&&a.Ay.createElement("span",{className:"interactive"},a.Ay.createElement("span",{className:"via"},_n("ViaBot")),a.Ay.createElement("span",{className:"sender-title",onClick:Vs},(0,O.A)(`@${(0,l.Kl)(pe)}`))),a.Ay.createElement("div",{className:"title-spacer"}),s||p?void 0:Ma?.isLinkedChannelPost?a.Ay.createElement("span",{className:"admin-title",dir:"auto"},_n("DiscussChannel")):e.postAuthorTitle&&dt&&!ls?a.Ay.createElement("span",{className:"admin-title",dir:"auto"},e.postAuthorTitle):!Ht||ls||ka?void 0:a.Ay.createElement("span",{className:"admin-title",dir:"auto"},Ht.customTitle||_n(Ht.isOwner?"GroupInfo.LabelOwner":"GroupInfo.LabelAdmin")),cs&&a.Ay.createElement("span",{className:"sender-boosts","aria-hidden":!0},a.Ay.createElement(Le.A,{name:sn>1?"boosts":"boost"}),sn>1?sn:void 0))}const or=dt&&ls?e.postAuthorTitle:void 0,rr=e.suggestedPostInfo&&!e.isOutgoing&&!e.suggestedPostInfo.isAccepted&&!e.suggestedPostInfo.isRejected,ir=(0,a.Kr)(()=>{if(!e.suggestedPostInfo?.scheduleDate||!Sn)return!1;const t=(0,f.Fm)();return e.suggestedPostInfo.scheduleDate<=t+Sn},[e.suggestedPostInfo,Sn]);return a.Ay.createElement("div",{ref:Hn,id:(0,l.GZ)(e.id),className:po,"data-message-id":Ia,onCopy:Ue?v.A:void 0,onMouseDown:ks,onClick:Ts,onContextMenu:Ps,onDoubleClick:Ls,onMouseEnter:hs?js:void 0,onMouseMove:ko?Rs:void 0,onMouseLeave:ko||hs?Ds:void 0},a.Ay.createElement("div",{ref:Kn,className:"bottom-marker","data-message-id":Ia,"data-last-message-id":u?u.messages[u.messages.length-1].id:void 0,"data-album-main-id":u?u.mainMessage.id:void 0,"data-has-unread-mention":e.hasUnreadMention||void 0,"data-has-unread-reaction":Vt||void 0,"data-is-pinned":Lt||void 0,"data-should-update-views":void 0!==e.viewsCount}),!Be&&a.Ay.createElement("div",{className:"message-select-control no-selection"},bt&&a.Ay.createElement(Le.A,{name:"select"})),k&&a.Ay.createElement("div",{className:(0,g.A)("message-select-control group-select no-selection",xt&&"is-selected"),onClick:oo},xt&&a.Ay.createElement(Le.A,{name:"select"})),a.Ay.createElement("div",{ref:Gn,className:(0,g.A)("message-content-wrapper",Po.includes("text")&&"can-select-text",Po.includes("giveaway")&&"giveaway-result-content")},a.Ay.createElement("div",{className:Po,style:Go,dir:"auto"},ls&&!ps&&a.Ay.createElement(a.Ay.Fragment,null,Xo()&&sr(),or&&a.Ay.createElement("span",{className:"admin-title",dir:"auto"},or)),function(){const t=(0,g.A)("content-inner",ls&&"forwarded-message",Es&&"forwarded-custom-shape",bs&&"with-subheader",$o&&"no-media-corners"),s=S&&(!uo||go&&!vs&&!is)&&!Mo,o=(0,g.A)("text-content","clearfix","in-text"===Fo&&"with-meta",Te&&"with-outgoing-icon"),i=!Ms||!Ba||ot;return a.Ay.createElement("div",{className:t,onDoubleClick:Bs,dir:"auto"},!ls&&Xo()&&sr(),bs&&a.Ay.createElement("div",{className:"message-subheader"},Gt&&a.Ay.createElement(He,{topic:Kt,onClick:ro,className:"message-topic"}),Es&&a.Ay.createElement("div",{className:"forward-custom-shape-subheader"},a.Ay.createElement("div",{className:"message-title"},er()),sr(!0,!0)),Fa&&a.Ay.createElement(ke.A,{message:Ae,replyInfo:es,noUserColors:Is,isProtected:Ue,sender:ye,senderChat:ve,forwardSender:fe,chatTranslations:_t,isMediaNsfw:En,requestedChatTranslationLanguage:Zt,observeIntersectionForLoading:n,observeIntersectionForPlaying:m,onClick:Js}),as&&a.Ay.createElement(Re,{story:Ee,sender:we,noUserColors:Is,isProtected:Ue,observeIntersectionForLoading:n,onClick:io})),Ka&&n&&m&&a.Ay.createElement(Bn,{message:e,observeIntersection:n,observeIntersectionForPlaying:m,shouldLoop:Dt,shouldPlayEffect:sa,withEffect:Xt,isMediaNsfw:vn,onStopEffect:ra}),rs&&gt&&a.Ay.createElement(st,{customEmojiId:gt,withEffects:Xt&&xn&&!hn,isOwn:Ba,observeIntersection:n,forceLoadPreview:La,messageId:Ia,chatId:Sa,activeEmojiInteractions:kt}),rs&&ht&&a.Ay.createElement(rt,{emoji:ht,withEffects:Xt&&xn&&!hn,isOwn:Ba,observeIntersection:n,forceLoadPreview:La,messageId:Ia,chatId:Sa,activeEmojiInteractions:kt}),Xt&&hn&&!La&&a.Ay.createElement(ln.A,{shouldPlay:sa,messageId:e.id,isMirrored:!e.isOutgoing,effect:hn,observeIntersectionForLoading:n,observeIntersectionForPlaying:m,onStop:ra}),Io&&a.Ay.createElement(pn,{message:e,phoneCall:Io,chatId:Sa}),!us&&ms&&!ns&&a.Ay.createElement(Nn.A,{message:e,observeIntersection:n,canAutoLoad:Rt,isDownloading:Bt,onReadMedia:i?Zs:void 0,onHideTranscription:Xn,isTranscriptionError:Ta,isTranscribed:Boolean(L),canTranscribe:dn&&!Ms,isTranscriptionHidden:Zn,isTranscribing:T}),(Va||Ja||ns)&&a.Ay.createElement(Ce.Ay,{theme:J,message:e,origin:r.d9.Inline,uploadProgress:Pe,isSelectable:Be,isSelected:bt,noAvatars:p,onPlay:$s,onReadMedia:Ja&&i?Zs:void 0,onCancelUpload:Xs,isDownloading:Bt,isTranscribing:T,isTranscriptionHidden:Zn,isTranscribed:Boolean(L),isTranscriptionError:Ta,canDownload:!Ue,onHideTranscription:Xn,canTranscribe:dn&&!Ms}),Ha&&a.Ay.createElement(Se.A,{document:Ha,message:e,observeIntersection:n,canAutoLoad:Rt,autoLoadFileMaxSizeMb:Ot,uploadProgress:Pe,isSelectable:Be,isSelected:bt,onMediaClick:Ks,onCancelUpload:Xs,isDownloading:Bt,shouldWarnAboutSvg:an}),Qa&&!ds&&a.Ay.createElement(jn,{message:e,isProtected:Ue}),ds&&a.Ay.createElement(Un,{message:e}),$a&&a.Ay.createElement(At,{contact:$a,noUserColors:Ba}),An&&a.Ay.createElement(wn,{message:e,poll:An,onSendVote:eo}),Xa&&a.Ay.createElement(Vn,{message:e,todoList:Xa}),(Ya||Za)&&a.Ay.createElement(zt,{message:e}),Wa&&a.Ay.createElement(It,{message:e,canAutoLoadMedia:Rt}),Ga?.extendedMedia&&a.Ay.createElement(Wt,{message:e,isConnected:tn}),ns&&a.Ay.createElement("p",{className:(0,g.A)("transcription",!Zn&&Ta&&"transcription-error"),dir:"auto"},Ta?_n("NoWordsRecognized"):T&&L?a.Ay.createElement(Me.A,{content:L}):L),go&&function(e){const t=(0,g.A)("text-content","clearfix"),n=(0,g.A)("text-content","clearfix","in-text"===Fo&&"with-meta",Te&&"with-outgoing-icon"),s=us||!us&&ja||!us&&Ua&&!ms||!rs&&vs,o="in-text"===Fo;return a.Ay.createElement(a.Ay.Fragment,null,Yo(),uo&&!rs&&a.Ay.createElement("div",{className:t,dir:"auto"},qo(),xo&&a.Ay.createElement("div",{className:"translation-animation"},a.Ay.createElement("div",{className:"text-loading"},qo(!0))),!s&&o&&Qo()),s&&a.Ay.createElement(a.Ay.Fragment,null,Zo(e),!rs&&a.Ay.createElement("div",{className:n,dir:"auto"},vs&&a.Ay.createElement(Ct,{factCheck:Pa,isToggleDisabled:Et}),o&&Qo())))}(s),!go&&a.Ay.createElement(a.Ay.Fragment,null,Zo(s),uo&&!rs&&a.Ay.createElement("div",{className:o,dir:"auto"},qo(),xo&&a.Ay.createElement("div",{className:"translation-animation"},a.Ay.createElement("div",{className:"text-loading"},qo(!0))),vs&&a.Ay.createElement(Ct,{factCheck:Pa,isToggleDisabled:Et}),"in-text"===Fo&&Qo()),Yo()),Ga&&!Ga.extendedMedia&&a.Ay.createElement($t,{message:e,shouldAffectAppendix:s&&!is,isInSelectMode:Et,isSelected:bt,theme:J,forcedWidth:Ko}),_a&&a.Ay.createElement(on,{message:e,isInSelectMode:Et,isSelected:bt,theme:J,peer:ne}))}(),!hs&&"standalone"===Fo&&!ds&&Qo(),As&&a.Ay.createElement("div",{className:(0,g.A)("message-action-buttons",je&&"message-action-buttons-shown")},Mo&&os&&a.Ay.createElement(mt,{threadInfo:jt,disabled:b,isLoading:je,isCustomShape:!0,asActionButton:!0}),ys&&a.Ay.createElement($e.A,{className:"message-action-button",color:"translucent-white",round:!0,size:"tiny",ariaLabel:_n("lng_context_forward_msg"),onClick:k?to:no},a.Ay.createElement(Le.A,{name:"share-filled"})),fs&&a.Ay.createElement($e.A,{className:"message-action-button",color:"translucent-white",round:!0,size:"tiny",ariaLabel:"Focus message",onClick:Pt?ao:so},a.Ay.createElement(Le.A,{name:"arrow-right"}))),Mo&&!(As&&os)&&a.Ay.createElement(mt,{threadInfo:jt,disabled:b,isLoading:je}),Lo&&a.Ay.createElement(rn.A,{isOwn:Ba}),ko&&"in-content"===Oo&&Wo(),ba&&a.Ay.createElement(R,{position:xa,message:e,messageListType:Tt,detectedLanguage:Eo})),e.inlineButtons&&a.Ay.createElement(Ut,{message:e,onClick:Pn}),rr&&a.Ay.createElement(Ut,{message:{...e,inlineButtons:[[{type:"suggestedMessage",buttonType:"decline",text:qn("SuggestedPostDecline")},{type:"suggestedMessage",buttonType:"approve",text:qn("SuggestedPostApprove"),disabled:ir}],[{type:"suggestedMessage",buttonType:"suggestChanges",text:qn("SuggestedPostSuggestChanges")}]]},onClick:tr}),"outside"===Do&&!ds&&a.Ay.createElement(Cn.A,{message:Nt,threadId:wt,isOutside:!0,isCurrentUserPremium:I,maxWidth:_o,observeIntersection:m,noRecentReactors:ct,tags:cn,isAccountFrozen:In})),ga&&a.Ay.createElement(vt,{isOpen:ha,anchor:ga,targetHref:Aa?.matches("a[href]")?Aa.href:void 0,message:e,album:u,messageListType:Tt,onClose:va,onCloseAnimationEnd:Ea,repliesThreadInfo:jt,noReplies:x,detectedLanguage:Eo}),ia&&a.Ay.createElement(Ge.A,{isOpen:ia,onClose:ca,title:qn("SuggestedPostDecline"),confirmLabel:qn("SuggestedPostDecline"),confirmHandler:ar,confirmIsDestructive:!0},a.Ay.createElement("div",{className:"decline-dialog-question"},(0,O.A)(qn("DeclinePostDialogQuestion",{sender:ne?(0,c.em)(_n,ne):""},{withNodes:!0,withMarkdown:!0}))),a.Ay.createElement(_e.A,{placeholder:qn("DeclineReasonPlaceholder"),value:da,onChange:nr,maxLength:200})))}))},54314:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var a=n(84051),s=n(13439),o=n(90709),r=n(60919),i=n(9716),l=n(4961),c=n(17712),d=n(59030),m=n(64493),u=n(22337),p=n(21849);const h=(0,a.ph)((0,s.EK)((e,{chat:t,isSavedDialog:n})=>{const a=(0,i.L8)(t.id),s=(0,r.nZ4)(e,t.id),l=a&&(0,r.mBe)(e,(0,o.e7)(t)),c=l&&(0,o.tv)(l)&&!t.isSupport,d=a&&!s&&!c&&!n,m=a?(0,o.u0)((0,r.mBe)(e,(0,o.e7)(t))):void 0;return{isPrivateChat:a,isChatWithSelf:s,isBot:c,isChannel:(0,o.WX)(t),isBasicGroup:(0,o.yn)(t),isSuperGroup:(0,o.Vs)(t),currentUserId:e.currentUserId,canDeleteForAll:d,contactName:m}})(({isOpen:e,chat:t,isSavedDialog:n,isChannel:r,isPrivateChat:i,isChatWithSelf:h,isBot:g,isBasicGroup:A,isSuperGroup:y,currentUserId:f,canDeleteForAll:v,contactName:E,onClose:b,onCloseAnimationEnd:x})=>{const{leaveChannel:w,deleteHistory:C,deleteSavedHistory:N,deleteChannel:I,deleteChatUser:S,blockUser:M,deleteChat:k}=(0,s.ko)(),T=(0,d.A)(),P=(0,o.Js)(T,t),L=(0,c.A)(()=>{C({chatId:t.id,shouldDeleteForAll:!0}),b()}),B=(0,c.A)(()=>{C({chatId:t.id,shouldDeleteForAll:!0}),M({userId:t.id}),b()}),R=(0,c.A)(()=>{n?N({chatId:t.id}):i?C({chatId:t.id,shouldDeleteForAll:!1}):A?t.isCreator?(C({chatId:t.id,shouldDeleteForAll:!0}),k({chatId:t.id})):(C({chatId:t.id,shouldDeleteForAll:!1}),S({chatId:t.id,userId:f})):!r&&!y||t.isCreator?(r||y)&&t.isCreator&&I({chatId:t.id}):w({chatId:t.id}),b()}),F=(0,c.A)(()=>{r||y?(w({chatId:t.id}),b()):A&&t.isCreator?(C({chatId:t.id,shouldDeleteForAll:!1}),S({chatId:t.id,userId:f})):R()});return a.Ay.createElement(u.A,{isOpen:e,className:"DeleteChatModal",header:a.Ay.createElement("div",{className:"modal-header",dir:T.isRtl?"rtl":void 0},a.Ay.createElement(p.A,{size:"tiny",peer:t,isSavedMessages:h}),a.Ay.createElement("h3",{className:"modal-title"},T(n?h?"ClearHistoryMyNotesTitle":"ClearHistoryTitleSingle2":r&&!t.isCreator?"LeaveChannel":r&&t.isCreator?"ChannelDelete":A||y?"Group.LeaveGroup":"DeleteChatUser"))),onClose:b,onCloseAnimationEnd:x},n?a.Ay.createElement("p",null,(0,l.A)(h?T("ClearHistoryMyNotesMessage"):T("ClearHistoryMessageSingle",P),["simple_markdown","emoji"])):r&&t.isCreator?a.Ay.createElement("p",null,(0,l.A)(T("ChatList.DeleteAndLeaveGroupConfirmation",P),["simple_markdown","emoji"])):r&&!t.isCreator||A||y?a.Ay.createElement("p",null,(0,l.A)(T("ChannelLeaveAlertWithName",P),["simple_markdown","emoji"])):a.Ay.createElement("p",null,(0,l.A)(T("ChatList.DeleteChatConfirmation",E),["simple_markdown","emoji"])),a.Ay.createElement("div",{className:"dialog-buttons-column"},g&&!n&&a.Ay.createElement(m.A,{color:"danger",className:"confirm-dialog-button",isText:!0,onClick:B},T("DeleteAndStop")),v&&a.Ay.createElement(m.A,{color:"danger",className:"confirm-dialog-button",isText:!0,onClick:L},E?(0,l.A)(T("ChatList.DeleteForEveryone",E)):T("DeleteForAll")),!i&&t.isCreator&&!n&&a.Ay.createElement(m.A,{color:"danger",className:"confirm-dialog-button",isText:!0,onClick:R},T("DeleteForAll")),a.Ay.createElement(m.A,{color:"danger",className:"confirm-dialog-button",isText:!0,onClick:i||n?R:F},T(n?"Delete":r&&!t.isCreator?"LeaveChannel":r&&t.isCreator?"Chat.Input.Delete":A||y?"Group.LeaveGroup":v?"ChatList.DeleteForCurrentUser":"Delete")),a.Ay.createElement(m.A,{className:"confirm-dialog-button",isText:!0,onClick:b},T("Cancel"))))}))},54639:(e,t,n)=>{"use strict";n.d(t,{A:()=>f});var a=n(84051),s=n(13439),o=n(37661),r=n(17712),i=n(59030),l=n(71429),c=n(24433),d=n(23174),m=n(90709),u=n(87357),p=n(43874),h=n(62587);const g="VGmPJoga",A=/#fff/gi,y=(0,a.ph)(({icon:e,theme:t})=>{const{isTouchScreen:n}=(0,p.Ay)(),s=(0,h.A)((0,m.mr)(e,"full"),!1,d.qZ.Text),o=(0,a.Kr)(()=>{if(!s)return"";const e="dark"===t?"rgb(170, 170, 170)":"rgb(112, 117, 121)",n=s.replace(A,e),a=(new DOMParser).parseFromString(n,"image/svg+xml");return a.querySelectorAll("path").forEach(t=>{t.style.stroke=e,t.style.strokeWidth="0.5px"}),`data:image/svg+xml;utf8,${a.documentElement.outerHTML}`},[s,t]);return a.Ay.createElement("i",{className:(0,u.A)("mklnEg0s","icon",!n&&g)},a.Ay.createElement("img",{src:o,alt:"",className:(0,u.A)("tT8KQwg0",!n&&g),draggable:!1}))}),f=(0,a.ph)(({bot:e,theme:t,chatId:n,threadId:d,isInSideMenu:m,canShowNew:u,onMenuOpened:p,onMenuClosed:h})=>{const{callAttachBot:g,toggleAttachBot:A}=(0,s.ko)(),f=(0,i.A)(),v=(0,a.Kr)(()=>e.icons.find(({name:e})=>"default_static"===e)?.document,[e.icons]),[E,b,x]=(0,o.A)(),[w,C]=(0,a.J0)(void 0),N=(0,r.A)(e=>{e.preventDefault();const t=e.currentTarget.getBoundingClientRect();C({x:t.right,y:t.bottom}),p(),b()}),I=(0,r.A)(()=>{g(m?{bot:e,isFromSideMenu:!0}:{bot:e,chatId:n,threadId:d})}),S=(0,r.A)(()=>{x(),h()}),M=(0,r.A)(()=>{C(void 0)}),k=(0,r.A)(()=>{A({botId:e.id,isEnabled:!1})});return a.Ay.createElement(c.A,{key:e.id,customIcon:v&&a.Ay.createElement(y,{icon:v,theme:t}),icon:v?void 0:"bots",onClick:I,onContextMenu:N},e.shortName,u&&e.isDisclaimerNeeded&&a.Ay.createElement("span",{className:"menu-item-badge"},f("New")),w&&a.Ay.createElement(l.A,{isOpen:E,positionX:"right",style:`left: ${w.x}px;top: ${w.y}px;`,className:"bot-attach-context-menu",autoClose:!0,withPortal:!0,onClose:S,onCloseAnimationEnd:M},a.Ay.createElement(c.A,{icon:"stop",destructive:!0,onClick:k},f("WebApp.RemoveBot"))))})},54699:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var a=n(30857),s=n(32625);function o(e){const t=(0,a.A)();(0,s.A)(t,e,!0)}},55317:(e,t,n)=>{"use strict";function a(e,t){const{level:n,boosts:a,currentLevelBoosts:s,nextLevelBoosts:o,hasMyBoost:r,prepaidGiveaways:i}=e,l=t&&a===s&&r;return{currentLevel:l?n-1:n,hasNextLevel:Boolean(o),boosts:a,levelProgress:!o||l?1:(a-s)/(o-s),remainingBoosts:o?o-a:0,isMaxLevel:void 0===o,prepaidGiveaways:i}}n.d(t,{z:()=>a})},55429:(e,t,n)=>{"use strict";n.d(t,{N:()=>r});var a=n(90709),s=n(70636),o=n(9716);function r(e,t,n,r){const{senderId:i}=t;if(!i)return;const l=(0,o.L8)(i)?r[i]:n[i];let c=(0,s.F9)(e,l);const d=n[t.chatId];return d&&("isSelf"in l&&l.isSelf?c=`${e("FromYou")} → ${(0,a.Js)(e,d)}`:(0,a.YE)(d)&&(c+=` → ${(0,a.Js)(e,d)}`)),c}},57674:(e,t,n)=>{"use strict";n.d(t,{cn:()=>o,y8:()=>r});var a=n(34164),s=n(50856);function o(...e){return(0,s.QP)((0,a.$)(e))}function r(e){return e.map(e=>{if("assistant"!==e.role)return e;if(!e.toolInvocations)return e;const t=[];for(const n of e.toolInvocations)"result"===n.state&&t.push(n.toolCallId);const n=e.toolInvocations.filter(e=>"result"===e.state||t.includes(e.toolCallId));return{...e,toolInvocations:n}}).filter(e=>e.content.length>0||e.toolInvocations&&e.toolInvocations.length>0)}},58324:(e,t,n)=>{"use strict";n.d(t,{i9:()=>s,ku:()=>l,n5:()=>o,sh:()=>i,w7:()=>r});var a=n(25279);const s=()=>({timestamp:(new Date).getTime(),content:"",id:(0,a.A)(),createdAt:new Date,role:"assistant",annotations:[{type:"global-meeting-introduce"}]}),o=()=>({timestamp:(new Date).getTime(),content:"",id:(0,a.A)(),createdAt:new Date,role:"assistant",annotations:[{type:"global-summary-introduce"}]}),r=()=>({timestamp:(new Date).getTime(),content:"",id:(0,a.A)(),createdAt:new Date,role:"assistant",annotations:[{type:"global-translation-introduce"}]}),i=()=>({timestamp:(new Date).getTime(),content:"",id:(0,a.A)(),createdAt:new Date,role:"assistant",annotations:[{type:"global-actions-introduce"}]}),l=()=>({timestamp:(new Date).getTime(),content:"",id:(0,a.A)(),createdAt:new Date,role:"assistant",annotations:[{type:"global-introduce"}]})},59816:(e,t,n)=>{"use strict";n.d(t,{A:()=>S});var a=n(84051),s=n(13439),o=n(31481),r=n(66644),i=n(87357),l=n(95807),c=n(39751),d=n(90709),m=n(9716),u=n(76023),p=n(82117),h=n(17712),g=n(93545),A=n(11241);const y="pruw1nLm",f=(0,a.ph)(({story:e,mediaArea:t,index:n,className:o,style:r,isPreview:c})=>{const{sendStoryReaction:y}=(0,s.ko)(),f=(0,a.li)(),[v,E]=(0,a.J0)(1.5*u.$),{peerId:b,id:x,views:w}=e,{reactions:C}=w||{},{reaction:N,isDark:I,isFlipped:S}=t,M=!(0,m.L8)(b),k=`${(0,d.$_)(b,x)}-${n}-${c?"preview":"viewer"}`,T=(0,a.Kr)(()=>C?.find(e=>(0,d.a0)(e.reaction,N))?.count,[N,C]),P=!c&&Boolean(T)&&M,L=(0,h.A)(()=>{if(!f.current)return;const e=f.current.clientHeight;E(Math.round(.6*e))});(0,p.A)(([e])=>{Boolean(T)!==Boolean(e)&&L()},[T]),(0,g.A)(f,L);const B=(0,h.A)(()=>{y({peerId:b,storyId:x,containerId:k,reaction:N})});return a.Ay.createElement("div",{ref:f,className:(0,i.A)(I?"eic2vQ8c":"_7esBA3m",o),style:(0,l.A)(r,`--custom-emoji-size: ${v}px`),onClick:B},a.Ay.createElement("div",{className:(0,i.A)("c3ajA3hg",S&&"furSXGdL")}),Boolean(v)&&a.Ay.createElement(A.A,{className:(0,i.A)("Et3MvYmN",P&&"mFTLUHm2"),reaction:N,containerId:k,size:v,effectSize:4*v,shouldPause:c,shouldLoop:!c}),P&&a.Ay.createElement("span",{className:"Tr8mYyDk"},T))});var v=n(61433),E=n(60919),b=n(48894),x=n(87412);const w=(0,a.ph)((0,s.EK)((e,t)=>{const{mediaArea:n}=t;return{restrictedEmoji:(0,E.GHK)(e,n.emoji)}})(({mediaArea:e,className:t,style:n,restrictedEmoji:s,isPreview:o})=>{const c=(0,a.li)(),[d,m]=(0,a.J0)(0),{temperatureC:u,color:p}=e,A=(0,b.Bz)(p),y=(0,b.vG)(p),f=(0,h.A)(e=>{if(!c.current)return;const t=c.current,n=t.clientHeight,a=Math.round(.7*n);m(a);const s=()=>{(0,v.Tv)(t,{"--custom-emoji-size":`${a}px`,"font-size":n/32+"rem"})};if(e)return s;(0,r.RK)(s)});return(0,a.Nf)(()=>{(0,r.gm)(()=>f(!0))},[]),(0,g.A)(c,()=>f()),a.Ay.createElement("div",{ref:c,className:(0,i.A)("KBjMtRUS",t),style:(0,l.A)(n,`--custom-background-color: ${A}`,`color: ${y}`)},a.Ay.createElement("div",{className:"IFChB3tD"},s&&a.Ay.createElement(x.A,{key:s.id,documentId:s.id,size:d,noPlay:o,withTranslucentThumb:!0,forceAlways:!0}),a.Ay.createElement("p",{className:"_ke1UBIl"},(e=>Boolean("en-US"===navigator.language)?`${Math.round(9*e/5+32)}°F`:`${Math.round(e)}°C`)(u))))})),C=9/16,N=new Set(["channelPost","uniqueGift"]);function I(e,t){const{x:n,y:a,width:s,height:o,rotation:r,radius:i}=e.coordinates;let c="";if(t&&i&&t>0){const e=t*(s/100),n=t*(o/100);c=Math.min(e,n)*(i/100)+"px"}return(0,l.A)(`left: ${n}%`,`top: ${a}%`,`width: ${s}%`,`height: ${o}%`,`transform: rotate(${r}deg) translate(-50%, -50%)`,c&&`border-radius: ${c}`)}const S=(0,a.ph)(({story:e,isActive:t,className:n,isStoryPlaying:l})=>{const{openMapModal:d,openUniqueGiftBySlug:m,focusMessage:u,closeStoryViewer:p,openUrl:h}=(0,s.ko)(),g=(0,a.li)(),[A,v]=(0,a.J0)(0),E=(0,c.A)();(0,a.vJ)(()=>{if(!g.current)return;const e=g.current;if(v(e.clientWidth),E.width>o.c2m)return void(0,r.RK)(()=>{e.style.removeProperty("--media-width"),e.style.removeProperty("--media-height")});const t=E.width/E.height,n=t<C?e.clientHeight*C:e.clientWidth,a=t<C?e.clientHeight:e.clientWidth/C;(0,r.RK)(()=>{e.style.setProperty("--media-width",`${n}px`),e.style.setProperty("--media-height",`${a}px`)})},[t,E]);const b=e.mediaAreas;return a.Ay.createElement("div",{className:(0,i.A)("RXAMu4VD",!t&&"_5HkplWee",n),ref:g},b?.map((n,s)=>{switch(n.type){case"geoPoint":case"venue":case"channelPost":case"url":case"uniqueGift":{const e=t&&!N.has(n.type);return a.Ay.createElement("div",{className:(0,i.A)(y,e&&"xFjJpeOA"),style:I(n),onClick:()=>(e=>{switch(e.type){case"geoPoint":case"venue":d({geoPoint:e.geo});break;case"channelPost":u({chatId:e.channelId,messageId:e.messageId}),p();break;case"url":h({url:e.url});break;case"uniqueGift":m({slug:e.slug})}})(n)})}case"suggestedReaction":return a.Ay.createElement(f,{key:`${n.type}-${s}`,story:e,mediaArea:n,index:s,isPreview:!t,className:y,style:I(n)});case"weather":return a.Ay.createElement(w,{key:`${n.type}-${s}`,mediaArea:n,className:y,style:I(n,A),isPreview:!t||l});default:return}}))})},60138:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(84051),s=n(37836),o=n(17712);function r(e){const t=(0,o.A)(e);(0,a.vJ)(()=>(0,s.yu)(t),[t])}},60195:()=>{},60406:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var a=n(84051),s=n(61433),o=n(66644),r=n(37836);const i=({containerRef:e,selector:t},n)=>{(0,a.Nf)(()=>{const n=e.current?.querySelectorAll(t);if(!n?.length)return;const a=(0,r.nF)(e=>{const t=e.target,n=t.scrollTop>0;(0,o.RK)(()=>{(0,s.dH)(t,"scrolled",n)})},100);return n.forEach(e=>{(0,s.YM)(e,"with-notch"),e.addEventListener("scroll",a,{passive:!0})}),()=>{n.forEach(e=>{e.removeEventListener("scroll",a),(0,s.HW)(e,"with-notch")})}},[e,t,...n]),(0,a.vJ)(()=>{const n=e.current?.querySelectorAll(t);n?.length&&n.forEach(e=>{const t=e.scrollTop>0;(0,o.RK)(()=>{(0,s.dH)(e,"scrolled",t)})})},[e,t,...n])}},60474:(e,t,n)=>{"use strict";n.d(t,{A:()=>Ae});var a=n(84051),s=n(13439),o=n(31481),r=n(66644),i=n(60919),l=n(30708),c=n(96454),d=n(87357),m=n(52674),u=n(14680),p=n(17237),h=n(36353),g=n(37836),A=n(4961),y=n(11359),f=n(43874),v=n(19129),E=n(37661),b=n(17712),x=n(59030),w=n(88458),C=n(41733);function N(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class I{constructor(e,t,n){this.container=t,this.options=n,N(this,"video",void 0),N(this,"isPlaying",!1),this.video=document.createElement("video"),this.video.src=e,this.video.disablePictureInPicture=!0,this.video.muted=!0,n.style&&this.video.setAttribute("style",n.style),this.video.style.position="absolute",this.video.load(),this.options.noLoop||(this.video.loop=!0),(0,r.RK)(()=>{this.container.appendChild(this.video),this.recalculatePositionAndSize()})}play(){!this.isPlaying&&this.video&&(this.recalculatePositionAndSize(),this.video.paused&&(0,C.A)(this.video),this.isPlaying=!0)}pause(){this.isPlaying&&this.video&&(this.video.paused||this.video.pause(),this.isPlaying=!1)}destroy(){this.pause(),this.video?.remove(),this.video=void 0}updatePosition(e){this.options.position=e,this.recalculatePositionAndSize()}recalculatePositionAndSize(){const{size:e,position:{x:t,y:n}}=this.options;(0,r.YS)(()=>{if(!this.video)return;const a=this.video,{width:s,height:o}=this.container.getBoundingClientRect();(0,r.RK)(()=>{a.style.left=`${Math.round(t*s)}px`,a.style.top=`${Math.round(n*o)}px`,a.style.width=`${e}px`,a.style.height=`${e}px`})})}}var S=n(60261),M=n(43336),k=n(71322),T=n(76023),P=n(37479),L=n(87094),B=n(82117),R=n(93545),F=n(672),D=n(61157),O=n(38691);const z=1.25*T.$;var j=n(54746),U=n(64493),V=n(61361),J=n(80089),H=n(80464);const K=e=>{const{isOpen:t}=e,n=(0,H.A)(J.ar.Extra,"TextFormatter",!t);return n?a.Ay.createElement(n,e):void 0};var $=n(45227),G=n(96540),_=n(94697),q=n(21468),W=n(70809),Q=n(2189),Y=n(20181),Z=n.n(Y),X=n(80539);class ee{constructor(){var e,t,n;e=this,n=void 0,(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t="languageToolURL"))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,this.languageToolURL="https://api.languagetoolplus.com/v2/check"}async saplingEditOverview(e){const t=new URLSearchParams({text:e,language:"en-US",useragent:"standalone",disabledRules:"WHITESPACE_RULE",mode:"allButTextLevelOnly",allowIncompleteResults:"true"});try{const n=await fetch(this.languageToolURL,{headers:{accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},body:t.toString(),method:"POST"}),a=await n.json();return console.log("LanguageTool response:",JSON.stringify(a)),a.matches.map(t=>{if(t.replacements&&t.replacements.length)return{description:t.rule.description,start:t.offset,end:t.offset+t.length,id:t.rule.id,general_error_type:t.rule.category.id.toLowerCase(),error_type:ee.classifyTypeGramma(t.rule),replacement:t.replacements[0]?.value||"",isPremium:!!t.rule?.isPremium,shortMessage:t.shortMessage||"",original_text:e.substring(t.offset,t.offset+t.length),sentence:t.sentence,sentence_start:e.indexOf(t.sentence)}}).filter(Boolean)}catch(e){return console.log(e),[]}}static classifyTypeGramma(e){return e?.category?.id?.toLowerCase()||""}async check(e){return await this.saplingEditOverview(e)}}const te=new ee,ne=new Q.diff_match_patch;function ae(e,t){let n=t;for(const t of e){if(t.nodeType!==Node.TEXT_NODE)continue;const e=t.length;if(n<=e)return{node:t,offset:n};n-=e}return{node:null,offset:0}}function se(e,t,n){const a=getComputedStyle(n),s=parseFloat(a.lineHeight||"16");return{left:e.left-t.left,top:e.top-t.top,width:e.width,height:s}}var oe=n(89027);const re=({replacement:e,errorIndex:t,handleFixError:n})=>G.createElement("div",{className:"text-[var(--color-text)]"},G.createElement("div",null,"ReplaceMent"),G.createElement("div",{className:"max-w-[min(30vw,400px)] px-[12px] py-[10px] rounded-[8px] cursor-pointer hover:bg-[var(--color-primary)] hover:text-white",onClick:()=>{n(t)}},e)),ie=e=>{const{top:t,left:n,width:a,height:s,replacement:o,generalErrorType:r,errorIndex:i,handleFixError:l}=e,c=(0,G.useRef)(null);return G.createElement("div",{className:"absolute pointer-events-none",style:{left:`${n}px`,top:`${t}px`,width:`${a}px`,height:`${s}px`}},G.createElement(oe.A,{placement:"top",content:G.createElement(re,{replacement:o,errorIndex:i,handleFixError:l})},G.createElement("div",{ref:c,className:"absolute bottom-[-2px] h-[6px] w-full border-b-[2px] pointer-events-auto "+("typos"===r.toLocaleLowerCase()?"border-red-500/60":"border-[#FFD633]")})))},le=(0,G.memo)(ie);var ce=n(75175);const de=({errorRanges:e,onClose:t,handleFixAllErrors:n,handleFixError:a})=>{const[s,o]=(0,G.useState)(0),[r,i]=(0,G.useState)(e[0]),[l,c]=(0,G.useState)([]),[d,m]=(0,G.useState)("");(0,G.useEffect)(()=>{const t=e[s];t&&(i(t),c([{description:t.description,offset:t.start-t.sentence_start,length:t.end-t.start,originalText:t.original_text,remove_segment:!1,suggestions:[t.replacement]}]),m(t.sentence))},[s,e]);const u=(0,G.useCallback)(()=>{a(s),1===e.length&&t(),s===e.length-1&&t()},[s,r]),p=(0,G.useCallback)(()=>{n(),t()},[n,t]);return G.createElement("div",{className:"h-[190px] flex flex-col overflow-hidden"},G.createElement("div",{className:"flex flex-row items-center justify-between"},G.createElement("h3",{className:"text-[var(--color-text)]"},"Review suggestions"),G.createElement("div",{className:"h-[26px] rounded-[6px] overflow-hidden flex flex-row"},G.createElement("div",{className:"w-[21px] bg-[#F1F1F1] cursor-pointer",onClick:()=>{s>0&&o(s-1)}},G.createElement(W.Yy,null)),G.createElement("div",{className:"px-[5px] text-[#979797]"},s+1,"/",e.length),G.createElement("div",{className:"w-[21px] bg-[#F1F1F1] cursor-pointer",onClick:()=>{s<e.length-1&&o(s+1)}},G.createElement(W.Xq,null)))),G.createElement("div",{className:"flex-1 overflow-hidden flex flex-col"},G.createElement("div",{className:"flex flex-row items-center gap-[8px]"},G.createElement("div",{className:"w-[8px] h-[8px] rounded-full bg-[#FF9900]"}),G.createElement("span",{className:"text-[14px] text-[#959595]"},"Improve your text")),G.createElement("div",{className:"flex-1 overflow-auto"},l?G.createElement(ce.A,{text:d,errors:l}):void 0)),G.createElement("div",{className:"flex flex-row items-center justify-between  pt-[10px] border-t-[1px] border-black/10"},G.createElement("div",{className:"text-[#7D40FF] border-[1px] border-[#7D40FF] rounded-[6px] px-[8px] py-[5px]",onClick:p},"Accept all (",e.length,")"),G.createElement("div",{className:"flex flex-row items-center gap-[8px]"},G.createElement(q.Ay,{color:"purple",variant:"solid",onClick:u},"Accept"))))},me=e=>{const{inputRef:t,getHtml:n,setHtml:a}=e,[s,o]=(0,G.useState)(!1),[r,i]=(0,G.useState)({left:0,top:0}),{corrections:l,spalingLoading:c,errorMarkers:d,fixError:m,fixAllErrors:u}=function(e,t,n,{delay:a=1e3}){const[s,o]=(0,G.useState)([]),[r,i]=(0,G.useState)(!1),[l,c]=(0,G.useState)([]),d=(0,G.useRef)(""),m=(0,G.useRef)(Date.now()),u=(0,G.useCallback)(()=>{const t=e.current;if(!t)return;const n=t.textContent||"",a=function(e){const t=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null),n=[];for(;t.nextNode();)n.push(t.currentNode);return n}(t);if(!a)return;c([]);const o=(r=n,s.filter(({start:e,end:t,original_text:n})=>{if(t>r.length)return!1;const a=r.slice(e,t);return a===n&&/\S/.test(a)}));var r;const i=[];for(const e of o){const{start:n,end:s,replacement:o,general_error_type:r}=e,{node:l,offset:c}=ae(a,n),{node:d,offset:m}=ae(a,s);if(!l||!d)continue;const u=document.createRange();u.setStart(l,c),u.setEnd(d,m);const p=u.getClientRects(),h=t.getBoundingClientRect();for(const e of p)i.push({...se(e,h,t),start:n,end:s,replacement:o,general_error_type:r})}c(i)},[s,e]),p=(0,G.useRef)(Z()(async()=>{const t=e.current?.innerText||"";i(!0);const n=await te.check(t);d.current=t,m.current=Date.now();const a=function(e,t,n){const a=ne.diff_main(e,t);ne.diff_cleanupSemantic(a);const s=[];let o=0;for(const e of n){const t=e.start,n=e.end;let r=!0,i=0;o=0;for(const[e,s]of a){const a=s.length;if(0===e)o+=a;else if(-1===e){if(o+a<=t)i-=a,o+=a;else if(o<n){r=!1;break}}else if(1===e)if(o<=t)i+=a;else if(o<n){r=!1;break}}r&&s.push({...e,start:t+i,end:n+i})}return s}(d.current,t,n);o(a),0===a.length&&c([]),i(!1)},a,{leading:!1,trailing:!0})).current,h=(0,G.useMemo)(()=>Z()(u,a,{leading:!1,trailing:!0}),[u,a]),g=t();return(0,G.useEffect)(()=>{if(e.current){const{text:e}=(0,X.Ay)(g);if(0===e.trim().length)return o([]),void c([]);p()}},[g,p,e]),(0,G.useEffect)(()=>{const e=()=>{h()};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[h]),(0,G.useEffect)(()=>{u()},[s,u]),{corrections:s,spalingLoading:r,errorMarkers:l,fixError:t=>{const a=s[t],r=e.current;if(!a||!r||!a.replacement)return;const{start:i,end:l,replacement:c}=a,m=r.innerText||"",u=m.slice(0,i)+c+m.slice(l);r.innerText=u;const p=[],h=c.length-(l-i);for(let e=0;e<s.length;e++){if(e===t)continue;const n=s[e];n.start>=l?p.push({...n,start:n.start+h,end:n.end+h}):p.push(n)}o(p),d.current=u,n(u)},fixAllErrors:()=>{const t=e.current;if(!t||0===s.length)return;let a=t.innerText||"";const r=[...s].sort((e,t)=>e.start-t.start);let i=0;for(const{start:e,end:t,replacement:n}of r){if(!n)continue;const s=e+i,o=t+i;a=a.slice(0,s)+n+a.slice(o),i+=n.length-(t-e)}t.innerText=a,d.current=a,n(a),o([]),c([]),p()}}}(t,n,a,{}),p=(0,G.useCallback)(()=>{o(!1)},[]);return G.createElement(G.Fragment,null,G.createElement("div",{className:"absolute left-0 top-0 pointer-events-auto"},d.map((e,t)=>G.createElement(le,{left:e.left,top:e.top,width:e.width,height:e.height,replacement:e.replacement,errorIndex:t,generalErrorType:e.general_error_type,handleFixError:m}))),G.createElement("div",{className:"sapling-badge-container"},G.createElement("div",{className:"sapling-status-container"},G.createElement("div",{className:"sapling-badge-errors"},d.length>0&&G.createElement("div",{className:"sapling-badge-errors-count",onClick:()=>{if(t&&t.current){const e=t.current.getBoundingClientRect(),{left:n,top:a}=e;i({left:n,top:a-240}),o(!0)}}},d.length)),c&&G.createElement("div",{className:"sapling-badge-spinner"}))),G.createElement(_.A,{className:"sapling-errors-modal",closable:!1,footer:null,open:s,onCancel:p,destroyOnClose:!0,style:{top:r.top,left:r.left}},G.createElement(de,{errorRanges:l,handleFixError:m,handleFixAllErrors:u,onClose:p})))},ue=e=>{const{inputRef:t,getHtml:n,setHtml:s}=e,o=(0,$.P)({component:me,props:{inputRef:t,getHtml:n,setHtml:s}});return a.Ay.createElement("div",{className:"absolute left-0 top-0 w-full h-full pointer-events-none",ref:o})},pe="input-scroller",he=140,ge=["Esc","Escape","Enter","PageUp","PageDown","Meta","Alt","Ctrl","ArrowDown","ArrowUp","Control","Shift"],Ae=(0,a.ph)((0,s.EK)((e,{chatId:t,threadId:n})=>{const{messageSendKeyCombo:a}=(0,l.l)(e);return{messageSendKeyCombo:a,replyInfo:t&&n?(0,i.GA4)(e,t,n)?.replyInfo:void 0,isSelectModeActive:(0,i.rTV)(e),canPlayAnimatedEmojis:(0,i.BWX)(e)}})(({ref:e,id:t,chatId:n,captionLimit:l,isAttachmentModalInput:C,isStoryInput:N,customEmojiPrefix:T,editableInputId:J,isReady:H,isActive:$,getHtml:G,placeholder:_,timedPlaceholderLangKey:q,timedPlaceholderDate:W,forcedPlaceholder:Q,canSendPlainText:Y,canAutoFocus:Z,noFocusInterception:X,shouldSuppressFocus:ee,shouldSuppressTextFormatter:te,replyInfo:ne,isSelectModeActive:ae,canPlayAnimatedEmojis:se,messageSendKeyCombo:oe,onUpdate:re,onSuppressedFocus:ie,onSend:le,onScroll:ce,onFocus:de,onBlur:me,isNeedPremium:Ae,messageListType:ye})=>{const{editLastMessage:fe,replyToNextMessage:ve,showAllowedMessageTypesNotification:Ee,openPremiumModal:be}=(0,s.ko)();let xe=(0,a.li)();e&&(xe=e);const we=(0,a.li)(),Ce=(0,a.li)(),Ne=(0,a.li)(),Ie=(0,a.li)(),Se=(0,a.li)(),Me=(0,a.li)(),ke=(0,x.A)(),Te=(0,a.li)(!1),[Pe,Le,Be]=(0,E.A)(),[Re,Fe]=(0,a.J0)(),[De,Oe]=(0,a.J0)(),[ze,je]=(0,a.J0)(!1),{isMobile:Ue}=(0,f.Ay)(),Ve=Ue&&(c.pz||c.Ni),[Je,He]=(0,a.J0)(!1);(0,a.vJ)(()=>{He(Boolean(q&&W))},[W,q]);const Ke=(0,b.A)(()=>{He(!1)});!function(e,t,n,o,l,c,d,m,u){const p=(0,L.A)(t,void 0,!m),h=(0,P.A)(p,!0),g=(0,O.A)(),A=(0,a.li)(new Map),y=(0,b.A)(e=>{e.forEach(e=>{const t=A.current.get(e);t&&(t.destroy(),A.current.delete(e))})}),f=(0,b.A)(()=>{if(!(m&&t.current&&n.current&&o.current))return;const e=(0,s.mS)(),a=new Set(A.current.keys());Array.from(t.current.querySelectorAll(".custom-emoji")).forEach(t=>{if(!t.dataset.uniqueId)return;const s=`${c}${t.dataset.uniqueId}${p||""}`,r=t.dataset.documentId;a.delete(s);const m=(0,S.ZR)(r);if(!m)return;const u=n.current.getBoundingClientRect(),y=t.getBoundingClientRect(),f=(0,M.LI)((y.left-u.left)/u.width,4),v=(0,M.LI)((y.top-u.top)/u.height,4);if(A.current.has(s))return void A.current.get(s).updatePosition(f,v);const E=e.customEmojis.byId[r];if(!E)return;const b=E?.stickerSetInfo&&(0,i.CzR)(e,E.stickerSetInfo),x=[c,r,p,g].filter(Boolean).join("_");(async function({customEmoji:e,sharedCanvasRef:t,sharedCanvasHqRef:n,absoluteContainerRef:a,renderId:s,viewId:o,mediaUrl:r,position:i,isHq:l,textColor:c,colorFilter:d}){if(e.isLottie){const a=e.shouldUseTextColor&&c?(0,k.E2)(c):void 0,d=(await(0,w.Y)()).init(r,l?n.current:t.current,s,{size:z,coords:i,isLowPriority:!l},o,a?[a.r,a.g,a.b]:void 0);return{play:()=>d.play(),pause:()=>d.pause(),destroy:()=>d.removeView(o),updatePosition:(e,t)=>d.setSharedCanvasCoords(o,{x:e,y:t})}}if(e.isVideo){const t=e.shouldUseTextColor&&d?`filter: ${d};`:void 0,n=new I(r,a.current,{size:z,position:i,style:t});return{play:()=>n.play(),pause:()=>n.pause(),destroy:()=>n.destroy(),updatePosition:(e,t)=>n.updatePosition({x:e,y:t})}}throw new Error("Unsupported custom emoji type")})({customEmoji:E,sharedCanvasRef:n,sharedCanvasHqRef:o,absoluteContainerRef:l,renderId:x,viewId:s,mediaUrl:m,isHq:b,position:{x:f,y:v},textColor:p,colorFilter:h}).then(e=>{d&&e.play(),A.current.set(s,e)})}),y(Array.from(a))});(0,a.vJ)(()=>(0,S.K3)(f),[f]),(0,a.vJ)(()=>{const e=A.current;return()=>{y(Array.from(e.keys()))}},[]),(0,a.vJ)(()=>{e()&&t.current&&n.current&&u&&m?(0,r.YS)(()=>{f()}):y(Array.from(A.current.keys()))},[e,f,t,y,n,u,m]),(0,a.Nf)(()=>{document.documentElement.style.setProperty("--input-custom-emoji-filter",h||"none")},[h]),(0,B.A)(([e])=>{void 0!==e&&p!==e&&f()},[p,f]);const v=(0,F.A)(f,[f],300,!1);(0,R.A)(n,v),(0,B.A)(([e])=>{g!==e&&(y(Array.from(A.current.keys())),f())},[g,f]);const E=(0,b.A)(()=>{A.current.forEach(e=>{e.pause()})}),x=(0,b.A)(()=>{d&&A.current?.forEach(e=>{e.play()})}),C=(0,b.A)(()=>{(0,r.YS)(x)});(0,D.Ay)(E,C)}(G,xe,Ie,Se,Me,T,se,H,$);const $e=C?160:N?128:Ue?256:416,Ge=(0,b.A)((e=!1)=>{(0,g.IJ)(()=>{(0,r.gm)(()=>{const t=xe.current.closest(`.${pe}`),n=Number(t.style.height.replace("px","")),a=Ne.current,{scrollHeight:s}=a,o=Math.min(s,$e);if(o===n)return;const i=s>$e;function l(){const e=Math.round(50*Math.log(Math.abs(o-n)));t.style.height=`${o}px`,t.style.transitionDuration=`${e}ms`,t.classList.toggle("overflown",i)}return e?void(0,r.RK)(l):l})})});(0,a.Nf)(()=>{C&&Ge(!1)},[C,Ge]);const _e=(0,a.li)(G());(0,a.Nf)(()=>{const e=$?G():"";e!==xe.current.innerHTML&&(xe.current.innerHTML=e),e!==Ce.current.innerHTML&&(Ce.current.innerHTML=e),e!==_e.current&&(_e.current=e,Ge(!e))},[G,$,Ge]),(0,a.li)(n).current=n;const qe=(0,b.A)(()=>{xe.current&&!Ae&&((0,a.OV)()?setTimeout(qe,350):(0,h.A)(xe.current))}),We=(0,b.A)(()=>{Be(),function(){const e=window.getSelection();e&&(e.removeAllRanges?e.removeAllRanges():e.empty&&e.empty())}()});function Qe(){if(c.pz)return!1;const e=window.getSelection();if(!e||!e.rangeCount||Te.current)return Be(),c.Ni&&je(!1),!1;const t=e.getRangeAt(0),n=t.toString().trim();return!(te||!(0,y.L)(t,J||o.CfG)||!n||(0,p.A)(n)||!t.START_TO_END)||(Be(),!1)}function Ye(){if(!Qe())return;if(ze)return;const e=window.getSelection().getRangeAt(0),t=e.getBoundingClientRect(),n=xe.current.closest(`.${pe}`).getBoundingClientRect();let a=t.left+t.width/2-n.left;a<he?a=he:a>n.width-he&&(a=n.width-he),Fe({x:a,y:t.top-n.top}),Oe(e),Le()}function Ze(){we.current&&window.clearTimeout(we.current),we.current=window.setTimeout(Ye,260)}const Xe=(0,b.A)(()=>be());(0,a.vJ)(()=>{c.TF||Z&&qe()},[n,qe,ne,Z]),(0,a.vJ)(()=>{if(!n||J!==o.CfG||X||Ve||ae)return;const e=e=>{if((0,u.ZJ)())return;const{key:t}=e,n=e.target;if(!n||ge.includes(t))return;const a=xe.current,s=document.getSelection()?.isCollapsed;if(!((t.startsWith("Arrow")||e.shiftKey&&"Shift"===t)&&!s||"KeyC"===e.code&&(e.ctrlKey||e.metaKey)&&"INPUT"!==n.tagName)&&a&&n!==a&&"INPUT"!==n.tagName&&"TEXTAREA"!==n.tagName&&!n.isContentEditable){(0,h.A)(a,!0,!0);const t=new KeyboardEvent(e.type,e);a.dispatchEvent(t)}};return document.addEventListener("keydown",e,!0),()=>{document.removeEventListener("keydown",e,!0)}},[n,J,Ve,ae,X]),(0,a.vJ)(()=>{const e=(0,g.sg)(e=>{"Tab"!==e.key||(0,u.ZJ)()||(e.preventDefault(),(0,r.RK)(qe))},2e3,!0,!1);return(0,m.A)({onTab:e})},[qe]),(0,a.vJ)(()=>{const e=xe.current;function t(){e.blur()}return ee&&e.addEventListener("focus",t),()=>{e.removeEventListener("focus",t)}},[ee]);const et=(0,v.A)(()=>Boolean($&&G()),[$,G]),tt=(0,d.A)("form-control allow-selection",et&&"touched",ee&&"focus-disabled"),nt=(0,d.A)("input-scroller-content",Ae&&"is-need-premium"),at="string"==typeof _?_:void 0;return a.Ay.createElement("div",{id:t,onClick:ee?ie:void 0,dir:ke.isRtl?"rtl":void 0},a.Ay.createElement("div",{className:(0,d.A)("custom-scroll",pe,Ae&&"is-need-premium"),onScroll:ce,onClick:C||Y?void 0:function(){C||Y||N&&Ae||Ee({chatId:n,messageListType:ye})}},a.Ay.createElement("div",{className:nt},a.Ay.createElement(ue,{inputRef:xe,getHtml:G,setHtml:re}),a.Ay.createElement("div",{ref:xe,id:J||o.CfG,className:tt,contentEditable:C||Y,role:"textbox",dir:"auto",tabIndex:0,onClick:qe,onChange:function(e){const{innerHTML:t,textContent:n}=e.currentTarget;if(re("<br>"===t?"":t),!c.TF&&(!n||!n.length)&&(c.TL||!t.includes("emoji-small"))&&!t.includes("custom-emoji")){const e=window.getSelection();e&&(xe.current.blur(),e.removeAllRanges(),(0,h.A)(xe.current,!0))}},onKeyDown:function(e){const{isComposing:t}=e,n=G();if(!t&&!n&&(e.metaKey||e.ctrlKey)){const t="ArrowDown"===e.key?1:"ArrowUp"===e.key?-1:void 0;if(t)return e.preventDefault(),void ve({targetIndexDelta:t})}t||"Enter"!==e.key||e.shiftKey?t||"ArrowUp"!==e.key||n||e.metaKey||e.ctrlKey||e.altKey?e.target.addEventListener("keyup",Ze,{once:!0}):(e.preventDefault(),fe()):!Ve&&("enter"===oe&&!e.shiftKey||"ctrl-enter"===oe&&(e.ctrlKey||e.metaKey))&&(e.preventDefault(),Be(),le())},onMouseDown:function(e){function t(e){e instanceof KeyboardEvent&&"Esc"!==e.key&&"Escape"!==e.key||(setTimeout(()=>{Te.current=!1},100),window.removeEventListener("keydown",t),window.removeEventListener("mousedown",t))}2===e.button?Te.current||(Te.current=!0,document.addEventListener("mousedown",t),document.addEventListener("keydown",t)):(e.currentTarget.closest(".message-input-wrapper")||e.target).addEventListener("mouseup",Ze,{once:!0})},onContextMenu:c.Ni?function(e){Qe()&&(je(!ze),ze?Be():(e.preventDefault(),e.stopPropagation(),Ye()))}:void 0,onTouchCancel:c.Ni?Ze:void 0,"aria-label":at,onFocus:Ae?void 0:de,onBlur:Ae?void 0:me}),!Q&&a.Ay.createElement("span",{className:(0,d.A)("placeholder-text",!C&&!Y&&"with-icon",Ae&&"is-need-premium"),dir:"auto"},!C&&!Y&&a.Ay.createElement(j.A,{name:"lock-badge",className:"placeholder-icon"}),Je?a.Ay.createElement(V.A,{langKey:q,endsAt:W,onEnd:Ke}):_,N&&Ae&&a.Ay.createElement(U.A,{className:"unlock-button",size:"tiny",color:"adaptive",onClick:Xe},ke("StoryRepliesLockedButton"))),a.Ay.createElement("canvas",{ref:Ie,className:"shared-canvas"}),a.Ay.createElement("canvas",{ref:Se,className:"shared-canvas"}),a.Ay.createElement("div",{ref:Me,className:"absolute-video-container"}))),a.Ay.createElement("div",{ref:Ne,className:(0,d.A)("custom-scroll",pe,"clone",Ae&&"is-need-premium")},a.Ay.createElement("div",{className:nt},a.Ay.createElement("div",{ref:Ce,className:(0,d.A)(tt,"clone"),dir:"auto"}))),void 0!==l&&a.Ay.createElement("div",{className:"max-length-indicator",dir:"auto"},l),a.Ay.createElement(K,{isOpen:Pe,anchorPosition:Re,selectedRange:De,setSelectedRange:Oe,onClose:We}),Q&&a.Ay.createElement("span",{className:"forced-placeholder"},(0,A.A)(Q)))}))},60700:(e,t,n)=>{"use strict";n.d(t,{A:()=>bn});var a=n(84051),s=n(13439),o=n(23174),r=n(31481),i=n(66644),l=n(90709),c=n(27109),d=n(70636),m=n(60919),u=n(64520),p=n(30708),h=n(96454),g=n(87357),A=n(17663),y=n(55148),f=n(46275),v=n(60261),E=n(9716),b=n(36353),x=n(48775),w=n(79824),C=n(80539),N=n(39074),I=n(80140),S=n(43503),M=n(24021),k=n(95547),T=n(4961),P=n(17712),L=n(59030),B=n(40664),R=n(22720),F=n(22337);const D=({isOpen:e,translateLanguage:t,closeInputLanguageModal:n,updateTranslateLanguage:s})=>{const[o,i]=(0,a.J0)(""),l=(0,L.A)(),c=(0,P.A)(e=>{s(e===t?void 0:e),n()}),d=(0,P.A)(e=>{i(e.target.value)}),m=(0,a.Kr)(()=>r.N89.map(e=>({langCode:e,translatedName:new Intl.DisplayNames([t||"en"],{type:"language"}).of(e),originalName:new Intl.DisplayNames([e],{type:"language"}).of(e)})),[t]);(0,a.vJ)(()=>{e||i("")},[e]);const u=(0,a.Kr)(()=>o.trim()?m.filter(({langCode:e,translatedName:t,originalName:n})=>t.toLowerCase().includes(o.toLowerCase())||n.toLowerCase().includes(o.toLowerCase())||e.toLowerCase().includes(o.toLowerCase())):m,[m,o]);return a.Ay.createElement(F.A,{className:"LFiEK79A",isSlim:!0,isOpen:e,hasCloseButton:!0,title:l("Language"),onClose:n},a.Ay.createElement(B.A,{key:"search",value:o,onChange:d,placeholder:l("Search")}),a.Ay.createElement("div",{className:(0,g.A)("WPdg2YHh","custom-scroll")},u.map(({langCode:e,originalName:n,translatedName:s})=>a.Ay.createElement(R.A,{key:e,className:(0,g.A)("_VgXA3ZV","no-icon"),secondaryIcon:t===e?"check":void 0,disabled:t===e,multiline:!0,narrow:!0,allowDisabledClick:!0,onClick:()=>c(e)},a.Ay.createElement("span",{className:(0,g.A)("title","RITxpjRP")},(0,T.A)(n,["highlight"],{highlight:o})),a.Ay.createElement("span",{className:(0,g.A)("subtitle","TsAsFkJP")},(0,T.A)(s,["highlight"],{highlight:o}))))))},O=()=>a.Ay.createElement("div",{className:"input-translate-tip"},a.Ay.createElement("span",null,"Enter your native language, and it will auto-translate to the set language upon sending."),a.Ay.createElement("div",{className:"input-translate-tip-arrow"}));var z=n(37661),j=n(14792);const U=e=>{const{chatId:t}=e,[n,s,o]=(0,z.A)(),[r,i]=(0,a.J0)(void 0),[l,c,d]=(0,z.A)();(0,a.vJ)(()=>{i(k.A.getRoomTranslateLanguage(t))},[t]);const m=(0,a.hb)(e=>{k.A.updateRoomTranslateLanguage(t,e),i(e),!r&&e&&(c(),setTimeout(()=>{d()},5e3))},[t,r]);return a.Ay.createElement("div",{className:"input-ai-actions"},a.Ay.createElement("button",{className:"Button input-ai-actions-button",onClick:s},r?a.Ay.createElement("span",{className:"text-[var(--color-text-secondary)] text-[14px] font-bold"},r.toUpperCase()):a.Ay.createElement("img",{src:j,alt:"Chat AI Logo"})),l&&a.Ay.createElement(O,null),a.Ay.createElement(D,{translateLanguage:r,isOpen:n,closeInputLanguageModal:o,updateTranslateLanguage:m}))};var V=n(52683),J=n(5556);let H;function K(e){H.focus(),e.focus()}h.pz&&(H=document.createElement("input"),H.classList.add("for-ios-autocapitalization-fix"),document.body.appendChild(H));var $=n(55153),G=n(58734),_=n(11359),q=n(35049),W=n(18501),Q=n(32625),Y=n(14737),Z=n(10722),X=n(19129),ee=n(82117),te=n(41316),ne=n(39351),ae=n(29886),se=n(73767),oe=n(24531),re=n(73172),ie=n(50680),le=n(41257),ce=n(35297),de=n(17778),me=n(63988),ue=n(83414);const pe=/^\/([\w@]{1,32})?$/i;var he=n(78396);const ge=/id="docs-internal-guid/i,Ae=["H1","H2","H3","H4","H5","H6"];function ye(e){return(new DOMParser).parseFromString(e,"text/html").body}function fe(e,t){const n=document.createElement("a");return n.href=t,n.appendChild(e.cloneNode(!0)),n}function ve(e,t){const n=document.createElement(t);return n.appendChild(e.cloneNode(!0)),n}function Ee(e,t){let n=t.cloneNode(!0);return e?(e.style&&"700"===e.style.fontWeight&&(n=ve(n,"strong")),e.style&&"italic"===e.style.fontStyle&&(n=ve(n,"em")),e.style&&"underline"===e.style.textDecoration&&(n=ve(n,"u")),e.style&&"line-through"===e.style.textDecoration&&(n=ve(n,"del")),e.style&&"super"===e.style.verticalAlign&&(n=ve(n,"sup")),e.style&&"sub"===e.style.verticalAlign&&(n=ve(n,"sub")),n):n}function be(e){const t=e.cloneNode(!0);let n=document.createTextNode(t.textContent||""),a=t;return"A"===t.nodeName&&(n=fe(n,t.href),"style"in t.childNodes[0]&&Boolean(t.childNodes[0].style)&&(a=t.childNodes[0])),n=Ee(a,n),n}function xe(e){if(e.childNodes&&(e.childNodes.length<=1||"OL"===e.nodeName||"UL"===e.nodeName)){let t,n=document.createTextNode(e.textContent||"");if("UL"===e.nodeName||"OL"===e.nodeName||"LI"===e.nodeName){t=document.createElement(e.nodeName),n=document.createDocumentFragment();const a=[];for(let t=0;t<e.childNodes.length;t++)a.push(...xe(e.childNodes[t]));a.map(e=>n.appendChild(e))}else-1!==Ae.indexOf(e.nodeName)?(t=document.createElement(e.nodeName),n=be(e.childNodes[0])):"P"===e.nodeName?(t=document.createElement("p"),n=function(e){const t=e.cloneNode(!0);let n=document.createTextNode(t.textContent||""),a=document.createTextNode("");return"style"in t.childNodes[0]&&Boolean(t.childNodes[0].style)&&(a=t.childNodes[0]),t.childNodes[0]&&"A"===t.childNodes[0].nodeName&&(n=fe(n.cloneNode(!0),t.childNodes[0].href),a=t.childNodes[0].childNodes[0]),n=Ee(a,n),n}(e)):"BR"===e.nodeName?n=e:(t=document.createElement("span"),n=be(e));return t?(t.appendChild(n),[t]):[e.cloneNode(!0)]}if(e.childNodes){const t=[];for(let n=0;n<e.childNodes.length;n++)t.push(...xe(e.childNodes[n]));return t}return[e]}function we(e){return 8!==e.nodeType}const Ce=/<style>(.*?)<\/style>/gs;var Ne=n(45761);const Ie=new Set([r.CfG,r.e0F,r.YVZ]),Se=(e,t,n,i,c,d,m)=>{const{showNotification:u}=(0,s.ko)(),p=(0,ne.A)();(0,a.vJ)(()=>{if(e)return document.addEventListener("paste",a,!1),()=>{document.removeEventListener("paste",a,!1)};async function a(e){if(!e.clipboardData)return;const a=e.target?.closest("div[contenteditable]");if(!a||!Ie.has(a.id))return;if(e.preventDefault(),document.activeElement!==a)return;const s=e.clipboardData.getData("text"),h=e.clipboardData.getData("text/html");let g=h?(0,C.Ay)(function(e){let t=document.createElement("div");try{e=(n=e).match(ge)?function(e){const t=document.createElement("body"),n=e.childNodes,a=Array.from(n).filter(we),s=[];for(const e of a)s.push(...xe(e));for(let e=0;e<s.length;e++)t.appendChild(s[e].cloneNode(!0));return t}(ye(n.replace(/(\r\n|\n|\r)/,""))).innerHTML:ye(n.replace(/(\r\n|\n|\r)/,"")).innerHTML}catch(e){r.Oig&&console.error(e)}var n;t.innerHTML=e.replace(/\u00a0/g," ").replace(Ce,"");const a=t.querySelectorAll(".text-content");return a.length&&(t=a[a.length-1]),Array.from(t.getElementsByTagName("*")).forEach(e=>{if(e instanceof HTMLElement)switch(e.removeAttribute("style"),"BR"===e.tagName&&e.replaceWith("\n"),"P"===e.tagName&&e.appendChild(document.createTextNode("\n")),"IMG"!==e.tagName||e.dataset.entityType||e.replaceWith(e.getAttribute("alt")||""),e.dataset.ignoreOnPaste&&e.remove(),C.qh[e.tagName]&&e.setAttribute("data-entity-type",C.qh[e.tagName]),e.dataset.entityType||e.textContent!==e.innerText||e.replaceWith(e.textContent),e.dataset.alt&&e.setAttribute("alt",e.dataset.alt),e.dataset.entityType){case o.C7.MentionName:e.replaceWith(e.textContent||"");break;case o.C7.CustomEmoji:e.textContent=e.dataset.alt||""}else e.remove()}),t.innerHTML.trimEnd()}(h),void 0,!0):void 0;g&&(0,he.T8)(g)&&d&&(g=(0,he.m4)(g),m?.());const{items:A}=e.clipboardData;let y=[];if(A.length>0&&(y=await(0,Ne.A)(A),c&&(y=y?.slice(0,1))),!y?.length&&!s)return;const f=g?.entities?.length?g:{text:s};let v=!1;try{v="urn:schemas-microsoft-com:office:word"===(new DOMParser).parseFromString(h,"text/html").documentElement.getAttribute("xmlns:w")}catch(e){}const E=f&&f.text;let b=y?.length&&!v;const x=y?await Promise.all(y.map(e=>(0,$.A)(e.name,e))):[],w=c&&x?.length&&(0,l.eh)(c,x[0])||Boolean(E),N=(0,l.NK)(x[0]),I=c&&c?.groupedId;c&&x?.length>1?u({message:p("MediaReplaceInvalidError",void 0,{pluralValue:x.length})}):c&&N?u({message:p("MediaReplaceInvalidError",void 0,{pluralValue:1})}):!I||(b=w,b)?(b&&n(c?x:e=>e.concat(x)),E&&(b?i(f):t(f,a?.id))):u({message:p("MediaReplaceInvalidError",void 0,{pluralValue:x.length})})}},[t,c,n,e,d,m,i,p])};var Me=n(3225),ke=n(37859),Te=n(56133),Pe=n(61157),Le=n(60138);let Be=!1;const Re=new Set([o.C7.TextUrl,o.C7.Url]);var Fe=n(25498),De=n(37830);const Oe=/^@([a-z0-9_]{1,32})[\u00A0\u0020]+(.*)/is,ze=/^@([a-z0-9_]{1,32})[\u00A0\u0020]+\n{2,}/i,je={username:"",query:"",canShowHelp:!1,usernameLowered:""},Ue=document.createElement("div");const Ve=(0,De.A)((e,t,n)=>({username:e,query:t,canShowHelp:n,usernameLowered:e.toLowerCase()})),Je=new RegExp(r.kNZ,"i");var He=n(9442),Ke=n(20247),$e=n(98221),Ge=n(17237);const _e=new RegExp(`^${r.bpX.source}$`,"g");var qe=n(11778);const We={encoderPath:new URL(n(89755),n.b).href,reuseWorker:!0},Qe={type:"audio/ogg"};let Ye,Ze,Xe;async function et(){return Ye||(Ye=n.e(4550).then(n.t.bind(n,14550,23)),Ze=(await Ye).default,Xe=new Ze(We)),Ye}async function tt(e){await async function(){await et(),await Xe.start()}();const t=Date.now();let n;const a=[],s=[];Xe.ondataavailable=e=>{a.push(e)};const o=function(t){const n=t.sourceNode,a=n.context.createAnalyser();a.fftSize=64,n.connect(a);const o=a.frequencyBinCount,r=new Uint8Array(o);let l=!1;return function t(){if(l)return;a.getByteFrequencyData(r);const n=r.reduce((e,t)=>e+t,0)/o/255;(t=>{s.push(255*t),e(t)})(n<.1?0:n),(0,i.YS)(t)}(),()=>{l=!0}}(Xe);return{stop:()=>new Promise((e,r)=>{Xe.onstop=()=>{e({blob:new Blob(a,Qe),duration:Math.round(((n||Date.now())-t)/1e3),waveform:s})},Xe.onerror=r;const i=Math.max(0,t+1e3-Date.now());setTimeout(()=>{Xe.stop(),o()},i)}),pause:()=>{const e=Math.max(0,t+1e3-Date.now());setTimeout(()=>{Xe.pause(),n=Date.now(),o()},e)}}}var nt=n(45227),at=n(22802),st=n(96540),ot=n(38493),rt=n(21468);function it(){const e=(0,s.mS)(),{currentUserId:t}=e,n=(0,m.mBe)(e,t);return{userId:t,userName:(0,l.Yg)(n)}}function lt(e,t){if(!t.length)return e;const n=[...t].sort((e,t)=>t.offset-e.offset);for(const{offset:t,length:a,suggestions:s}of n){const n=s[0]||"";e=e.slice(0,t)+n+e.slice(t+a)}return e}const ct=()=>st.createElement("div",{className:"skeleton-wrapper"},st.createElement("div",{className:"skeleton-text skeleton-line"}),st.createElement("div",{className:"skeleton-text skeleton-line"}),st.createElement("div",{className:"skeleton-text skeleton-line"}));var dt=n(75175);const mt=e=>{const{text:t,setHtml:n,onClose:a}=e,[s,o]=st.useState(!0),[i,l]=st.useState([]);(0,st.useEffect)(()=>{(e=>{const{userId:t,userName:n}=it();return new Promise((a,s)=>{fetch(`${r.Vjs}/grammarly-formal`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e,userId:t,userName:n})}).then(e=>e.json()).then(e=>a(e)).catch(e=>{s(e)})})})(t).then(e=>{if(!e.data.errors)throw new Error("No errors found in the text");l(e.data.errors),o(!1)}).catch(e=>{console.error("Error checking grammar:",e),o(!1),l([])})},[]);const c=(0,st.useCallback)(()=>{if(i){const e=lt(t,i);n(e),a()}},[i]);return st.createElement("div",null,st.createElement("h2",{className:"grammar-tool-tab-content-title"},"Use professional wording"),s?st.createElement(ct,null):st.createElement(st.Fragment,null,st.createElement(dt.A,{text:t,errors:i}),st.createElement(rt.Ay,{color:"default",variant:"outlined",onClick:c},"Accept")))},ut=e=>{const{text:t,setHtml:n,onClose:a}=e,[s,o]=st.useState(!0),[i,l]=st.useState([]);(0,st.useEffect)(()=>{(e=>{const{userId:t,userName:n}=it();return new Promise((a,s)=>{fetch(`${r.Vjs}/grammarly-friendly`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e,userId:t,userName:n})}).then(e=>e.json()).then(e=>a(e)).catch(e=>{s(e)})})})(t).then(e=>{if(!e.data.errors)throw new Error("No errors found in the text");l(e.data.errors),o(!1)}).catch(e=>{console.error("Error checking grammar:",e),o(!1),l([])})},[]);const c=(0,st.useCallback)(()=>{if(i){const e=lt(t,i);n(e),a()}},[i]);return st.createElement("div",null,st.createElement("h2",{className:"grammar-tool-tab-content-title"},"Use more personal language"),s?st.createElement(ct,null):st.createElement(st.Fragment,null,st.createElement(dt.A,{text:t,errors:i}),st.createElement(rt.Ay,{color:"default",variant:"outlined",onClick:c},"Accept")))},pt=e=>{const{text:t,setHtml:n,onClose:a}=e,[s,o]=st.useState(!0),[i,l]=st.useState([]);(0,st.useEffect)(()=>{(e=>{const{userId:t,userName:n}=it();return new Promise((a,s)=>{fetch(`${r.Vjs}/grammarly-check`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e,userId:t,userName:n})}).then(e=>e.json()).then(e=>a(e)).catch(e=>{s(e)})})})(t).then(e=>{if(!e.data.errors)throw new Error("No errors found in the text");l(e.data.errors),o(!1)}).catch(e=>{console.error("Error checking grammar:",e),o(!1),l([])})},[]);const c=(0,st.useCallback)(()=>{if(i){const e=lt(t,i);n(e),a()}},[i]);return st.createElement("div",null,st.createElement("h2",{className:"grammar-tool-tab-content-title"},"Fix grammar errors"),s?st.createElement(ct,null):st.createElement(st.Fragment,null,st.createElement(dt.A,{text:t,errors:i}),st.createElement(rt.Ay,{color:"default",variant:"outlined",onClick:c},"Accept")))},ht=e=>{const{text:t,setHtml:n,onClose:a}=e,[s,o]=st.useState(!0),[i,l]=st.useState([]);(0,st.useEffect)(()=>{(e=>{const{userId:t,userName:n}=it();return new Promise((a,s)=>{fetch(`${r.Vjs}/grammarly-rephrase`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e,userId:t,userName:n})}).then(e=>e.json()).then(e=>a(e)).catch(e=>{s(e)})})})(t).then(e=>{if(!e.data.errors)throw new Error("No errors found in the text");l(e.data.errors),o(!1)}).catch(e=>{console.error("Error checking grammar:",e),o(!1),l([])})},[]);const c=(0,st.useCallback)(()=>{if(i){const e=lt(t,i);n(e),a()}},[i]);return st.createElement("div",null,st.createElement("h2",{className:"grammar-tool-tab-content-title"},"Enhance clarity and fluency"),s?st.createElement(ct,null):st.createElement(st.Fragment,null,st.createElement(dt.A,{text:t,errors:i}),st.createElement(rt.Ay,{color:"default",variant:"outlined",onClick:c},"Accept")))},gt=e=>{const{text:t,setHtml:n,onClose:a}=e,[s,o]=st.useState(!0),[i,l]=st.useState([]);(0,st.useEffect)(()=>{(e=>{const{userId:t,userName:n}=it();return new Promise((a,s)=>{fetch(`${r.Vjs}/grammarly-shorten`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e,userId:t,userName:n})}).then(e=>e.json()).then(e=>a(e)).catch(e=>{s(e)})})})(t).then(e=>{if(!e.data.errors)throw new Error("No errors found in the text");l(e.data.errors),o(!1)}).catch(e=>{console.error("Error checking grammar:",e),o(!1),l([])})},[]);const c=(0,st.useCallback)(()=>{if(i){const e=lt(t,i);n(e),a()}},[i]);return st.createElement("div",null,st.createElement("h2",{className:"grammar-tool-tab-content-title"},"Condense wordy sections"),s?st.createElement(ct,null):st.createElement(st.Fragment,null,st.createElement(dt.A,{text:t,errors:i}),st.createElement(rt.Ay,{color:"default",variant:"outlined",onClick:c},"Accept")))},At=e=>{const{getHtml:t,setHtml:n,onClose:a}=e,{text:s}=(0,C.Ay)(t()),[o,r]=(0,st.useState)(0);return st.createElement(st.Fragment,null,st.createElement("div",{className:"px-[20px] py-[13px]"},(()=>{switch(o){case 0:return st.createElement(pt,{text:s,setHtml:n,onClose:a});case 1:return st.createElement(ht,{text:s,setHtml:n,onClose:a});case 2:return st.createElement(gt,{text:s,setHtml:n,onClose:a});case 3:return st.createElement(ut,{text:s,setHtml:n,onClose:a});case 4:return st.createElement(mt,{text:s,setHtml:n,onClose:a});default:return}})()),st.createElement(ot.A,{activeTab:o,tabs:[{title:"Improve"},{title:"Rephrase"},{title:"Shorten"},{title:"Friendly"},{title:"Formal"}],onSwitchTab:r,inversion:!0}))},yt=n.p+"grammar-input.fdc085b56253a7bdf2ac.png",ft=e=>{const[t,n,s]=(0,z.A)(),o=(0,a.li)(),{getHtml:r,setHtml:i}=e,l=(0,nt.P)({component:At,props:{getHtml:r,setHtml:i,onClose:s}});return(0,a.vJ)(()=>{let e;return o.current&&t&&(e=l(o.current)),()=>{e?.unmount()}},[t,s,r,i]),(0,a.vJ)(()=>t?(0,qe.A)(s):void 0,[t,s]),(0,at.A)(t,o,s,void 0,void 0),a.Ay.createElement("div",{className:"input-ai-actions flex-shrink-0 mr-[8px]"},a.Ay.createElement("button",{className:"Button input-ai-actions-button",onClick:()=>{if(t)s();else{const{text:e}=(0,C.Ay)(r());if(""===e.trim())return;n()}}},a.Ay.createElement("img",{src:yt,alt:"Chat AI Logo"})),t&&a.Ay.createElement("div",{className:"grammar-tool-wrapper open",ref:o}))};var vt=n(72531),Et=n(80089),bt=n(80464);const xt=e=>{const{attachments:t}=e,n=(0,bt.A)(Et.ar.Extra,"AttachmentModal",!t.length);return n?a.Ay.createElement(n,e):void 0};var wt=n(61182),Ct=n(87679),Nt=n(52844),It=n(36680),St=n(54746),Mt=n(71429),kt=n(24433),Tt=n(66469),Pt=n(54639);const Lt=(0,a.ph)(({chatId:e,threadId:t,isButtonVisible:n,canAttachMedia:o,canAttachPolls:i,canAttachToDoLists:c,canSendPhotos:d,canSendVideos:m,canSendDocuments:u,canSendAudios:p,attachBots:A,peerType:y,isScheduled:f,theme:v,shouldCollectDebugLogs:E,canEditMedia:b,editingMessage:x,messageListType:w,paidMessagesStars:C,onFileSelect:N,onMenuOpen:I,onMenuClose:S,onPollCreate:M,onTodoListCreate:k})=>{const{updateAttachmentSettings:T}=(0,s.ko)(),[B,R,F]=(0,z.A)(),[D,O,j]=(0,It.A)(B,F),U=d&&m,V=d||m,[J,H,K]=(0,z.A)(),$=B||J,G=x&&x?.groupedId&&Boolean((0,l.yl)(x)||Boolean((0,l.zX)(x))),_=x&&x?.groupedId&&Boolean((0,l.wp)(x)||(0,l.gB)(x)||(0,l.zC)(x));(0,a.vJ)(()=>{B&&j()},[B,j]),(0,a.vJ)(()=>{$?I():S()},[$,S,I]);const q=(0,P.A)(()=>{B?F():R()}),W=(0,P.A)(e=>{const{files:t}=e.target,n=(0,Ct.kc)(t);n?.length&&N(n)}),Q=(0,P.A)(()=>{T({shouldCompress:!0}),(0,Nt.p)(Array.from(U?r.mxD:d?r.gex:r.fNs).join(","),e=>W(e))}),Y=(0,P.A)(()=>{T({shouldCompress:!1}),(0,Nt.p)(!u&&p?Array.from(r.IH3).join(","):"*",e=>W(e))}),Z=(0,P.A)(()=>{const e=new File([(0,wt.F8)()],r.lFE,{type:"text/plain"});N([e])}),X=(0,a.Kr)(()=>A?Object.values(A).filter(t=>!(!y||!t.isForAttachMenu)&&(!("bots"!==y||t.id!==e||!t.attachMenuPeerTypes||!t.attachMenuPeerTypes.includes("self"))||t.attachMenuPeerTypes.includes(y))):void 0,[A,e,y]),ee=(0,L.A)(),te=(0,ne.A)();if(n)return a.Ay.createElement("div",{className:"AttachMenu"},x&&b?a.Ay.createElement(Tt.A,{id:"replace-menu-button",className:(0,g.A)("AttachMenu--button composer-action-button",B&&"activated"),round:!0,color:"translucent",onActivate:q,ariaLabel:"Replace an attachment",ariaControls:"replace-menu-controls",hasPopup:!0},a.Ay.createElement(St.A,{name:"replace"})):a.Ay.createElement(Tt.A,{id:"attach-menu-button",disabled:Boolean(x),className:(0,g.A)("AttachMenu--button composer-action-button",B&&"activated"),round:!0,color:"translucent",onActivate:q,ariaLabel:"Add an attachment",ariaControls:"attach-menu-controls",hasPopup:!0},a.Ay.createElement(St.A,{name:"attach"})),a.Ay.createElement(Mt.A,{id:"attach-menu-controls",isOpen:$,autoClose:!0,positionX:"right",positionY:"bottom",onClose:F,className:"AttachMenu--menu fluid",onCloseAnimationEnd:F,onMouseEnter:h.TF?void 0:D,onMouseLeave:h.TF?void 0:O,noCloseOnBackdrop:!h.TF,ariaLabelledBy:"attach-menu-button"},!o&&a.Ay.createElement(kt.A,{className:"media-disabled",disabled:!0},te("scheduled"===w&&C?"DescriptionScheduledPaidMediaNotAllowed":"DescriptionRestrictedMedia")),o&&a.Ay.createElement(a.Ay.Fragment,null,V&&!_&&a.Ay.createElement(kt.A,{icon:"photo",onClick:Q},ee(U?"AttachmentMenu.PhotoOrVideo":d?"InputAttach.Popover.Photo":"InputAttach.Popover.Video")),(u||p)&&!G&&a.Ay.createElement(kt.A,{icon:"document",onClick:Y},ee(!u&&p?"InputAttach.Popover.Music":"AttachDocument")),u&&E&&a.Ay.createElement(kt.A,{icon:"bug",onClick:Z},ee("DebugSendLogs"))),i&&!x&&a.Ay.createElement(kt.A,{icon:"poll",onClick:M},ee("Poll")),c&&!x&&a.Ay.createElement(kt.A,{icon:"select",onClick:k},te("TitleToDoList")),!x&&!b&&!f&&X?.map(n=>a.Ay.createElement(Pt.A,{bot:n,chatId:e,threadId:t,theme:v,onMenuOpened:H,onMenuClosed:K}))))}),Bt=e=>{const{isOpen:t}=e,n=(0,bt.A)(Et.ar.Extra,"BotCommandMenu",!t);return n?a.Ay.createElement(n,e):void 0};var Rt=n(85449),Ft=n(64493);const Dt=(0,a.ph)((0,s.EK)((e,{messageId:t})=>{const{chatId:n}=(0,m.Xf0)(e)||{};return n?{message:(0,m.O5q)(e,n,t)}:{}})(({isOpen:e,message:t,onClose:n})=>{const{clickBotInlineButton:o}=(0,s.ko)(),r=(0,L.A)(),[i,l]=(0,It.A)(e,n),{isKeyboardSingleUse:c}=t||{},d=(0,a.Kr)(()=>{const e=[];return t?.keyboardButtons.forEach(t=>{e.push(t.map(e=>(0,Rt.A)(r,e)))}),e},[r,t?.keyboardButtons]);if(t&&t.keyboardButtons)return a.Ay.createElement(Mt.A,{isOpen:e,autoClose:c,positionX:"right",positionY:"bottom",onClose:n,className:"BotKeyboardMenu",onCloseAnimationEnd:n,onMouseEnter:h.TF?void 0:i,onMouseLeave:h.TF?void 0:l,noCompact:!0},a.Ay.createElement("div",{className:"content custom-scroll"},t.keyboardButtons.map((e,n)=>a.Ay.createElement("div",{className:"row"},e.map((e,s)=>a.Ay.createElement(Ft.A,{ripple:!0,disabled:"unsupported"===e.type,onClick:()=>o({chatId:t.chatId,messageId:t.id,button:e})},d?.[n][s]))))))})),Ot=(0,a.ph)(({isOpen:e,onClick:t,text:n,isDisabled:s})=>{const o=(0,a.li)();return(0,a.vJ)(()=>{const e=o.current;if(!e)return;const t=e.scrollWidth+1;e.closest(".Composer").style.setProperty("--bot-menu-text-width",`${t}px`)},[e,n]),(0,a.vJ)(()=>{const e=o.current;if(!e)return;const t=e.closest(".Composer");return()=>{t.style.removeProperty("--bot-menu-text-width")}},[]),a.Ay.createElement(Ft.A,{className:(0,g.A)("composer-action-button bot-menu",e&&"open"),round:!0,color:"translucent",disabled:s,onClick:t,ariaLabel:"Open bot command keyboard"},a.Ay.createElement(St.A,{name:"webapp",className:(0,g.A)("bot-menu-icon",e&&"open")}),a.Ay.createElement("span",{ref:o,className:"bot-menu-text"},(0,T.A)(n)))}),zt=e=>{const{isOpen:t}=e,n=(0,bt.A)(Et.ar.Extra,"ChatCommandTooltip",!t);return n?a.Ay.createElement(n,e):void 0};var jt=n(56494),Ut=n(87894),Vt=n(14),Jt=n(91930),Ht=n(60859);const Kt=(0,a.ph)((0,s.EK)((e,{shouldForceShowEditing:t,chatId:n,threadId:a,messageListType:s})=>{const{forwardMessages:{fromChatId:o,toChatId:r,messageIds:i,noAuthors:c,noCaptions:d},isShareMessageModalShown:u,shouldPreventComposerAnimation:p}=(0,m.nTw)(e),h="scheduled"===s?(0,m.VlN)(e,n):(0,m.Ys6)(e,n,a),g=(0,m.PKK)(e)&&!p,A=r===n,y=i?.map(t=>(0,m.O5q)(e,o,t)),f=(0,m.GA4)(e,n,a),v=f?.replyInfo,E=f?.suggestedPostInfo,b=v?.replyToPeerId,x=b?(0,m.hds)(e,b):void 0;let w,C;if(h?w=(0,m.KLw)(e,n,a,s):A&&1===i.length?w=y?.[0]:v&&!t&&(w=(0,m.O5q)(e,v.replyToPeerId||n,v.replyToMsgId)),h&&w)C=(0,m.Y7C)(e,w);else if(A){let t=y?.map(t=>{return n=t,C=(0,m.Szq)(e,n),C||(C=(0,m.Y7C)(e,n)),C;var n}).filter(Boolean);t=t?(0,Ut.Am)(t):void 0,C=1===t?.length?t?.[0]:void 0}else if(v&&w&&!t){const{forwardInfo:t}=w,a=(0,m.nZ4)(e,n);t&&(t.isChannelPost||a)&&(C=(0,m.Szq)(e,w)),C||t?.hiddenUserName&&!Boolean(v.quoteText)||(C=(0,m.Y7C)(e,w))}const N=C&&(0,m.hds)(e,C.id),I=N&&(0,l.WX)(N),S=y?.some(e=>e?.content.text&&Object.keys(e.content).length>1),M=A&&1===i.length&&Boolean(w?.content.storyData),k=v?.replyToMsgId===a&&!v.replyToPeerId,T=w&&(0,jt.B9)(e,w);return{replyInfo:v,suggestedPostInfo:E,editingId:h,message:w,sender:C,shouldAnimate:g,forwardedMessagesCount:A?i.length:void 0,noAuthors:c,noCaptions:d,forwardsHaveCaptions:S,isCurrentUserPremium:(0,m.g29)(e),isContextMenuDisabled:M,isReplyToDiscussion:k,isInChangingRecipientMode:u,shouldPreventComposerAnimation:p,senderChat:x,currentUserId:e.currentUserId,isSenderChannel:I,forwardMessageIds:i,fromChatId:o,isMediaNsfw:T}})(({replyInfo:e,suggestedPostInfo:t,editingId:n,message:o,sender:r,shouldAnimate:i,forwardedMessagesCount:c,noAuthors:d,noCaptions:u,forwardsHaveCaptions:p,shouldForceShowEditing:h,isCurrentUserPremium:A,isContextMenuDisabled:y,isReplyToDiscussion:f,isInChangingRecipientMode:v,shouldPreventComposerAnimation:E,senderChat:b,chatId:x,currentUserId:w,isSenderChannel:C,forwardMessageIds:N,fromChatId:I,isMediaNsfw:S,onClear:M})=>{const{resetDraftReplyInfo:k,resetDraftSuggestedPostInfo:T,updateDraftReplyInfo:B,setEditingId:R,focusMessage:F,changeRecipient:D,openChatOrTopicWithReplyInDraft:O,setForwardNoAuthors:z,setForwardNoCaptions:j,exitForwardMode:U,setShouldPreventComposerAnimation:V,openSuggestMessageModal:J}=(0,s.ko)(),H=(0,a.li)(),K=(0,L.A)(),$=(0,ne.A)(),G="topicCreate"===o?.content.action?.type,_=e&&!h,W=Boolean(e?.quoteText),Q=Boolean(t)&&!h,Y=Boolean(c),X=(0,P.A)(e=>{const t=(0,s.mS)();return(r=(0,m.Szq)(t,e))||(r=(0,m.Y7C)(t,e)),r}),ee=(0,a.Kr)(()=>{if(!Y)return;const e=N?.map(e=>(0,m.O5q)((0,s.mS)(),I,e)).filter(Boolean),t=e?.map(e=>X(e)).filter(Boolean);return t?(0,Ut.Am)(t):void 0},[Y,N,I]),te=!(v||(!o||!e&&!n)&&(!ee||!Y)&&!Q),{shouldRender:ae,transitionClassNames:se}=(0,ie.A)(te&&!G&&!f,void 0,!i,void 0,!i,350,!i);(0,a.vJ)(()=>{E&&V({shouldPreventComposerAnimation:!1})});const oe=(0,P.A)(()=>{n?R({messageId:void 0}):c?U():Q?(T(),k()):e&&!h&&k(),M?.()});(0,a.vJ)(()=>te?(0,qe.A)(oe):void 0,[te,oe]);const{isContextMenuOpen:re,contextMenuAnchor:le,handleContextMenu:ce,handleContextMenuClose:de,handleContextMenuHide:me}=(0,Z.A)(H),ue=(0,P.A)(e=>{t?J({chatId:x}):ce(e)}),pe=(0,P.A)(e=>{e.stopPropagation(),oe(),me()}),he=e=>()=>{de(),e()},ge=(0,P.A)(he(D)),Ae=(0,P.A)(he(()=>{F({chatId:o.chatId,messageId:o.id,noForumTopicPanel:!0})})),ye=(0,P.A)(he(()=>B({quoteText:void 0}))),fe=(0,P.A)(he(D)),ve=(0,P.A)(()=>{de(),r&&O({chatId:r.id})}),Ee=(0,P.A)(he(oe)),be=(0,P.A)(()=>H.current),xe=(0,P.A)(()=>H.current),we=(0,P.A)(()=>H.current.querySelector(".forward-context-menu .bubble"));(0,a.vJ)(()=>{ae||(de(),me())},[de,me,ae]);const Ce=(0,g.A)("ComposerEmbeddedMessage",se),Ne=(0,Vt.A)(r,!0),Ie=(0,g.A)("ComposerEmbeddedMessage_inner",(0,q.y)(Ne)),Se=(0,a.Kr)(()=>n?"edit":Q?"cash-circle":Y?"forward":_?"reply":void 0,[n,Y,_,Q]),Me=c&&c>1?K("ForwardedMessageCount",c):void 0,ke=(0,a.Kr)(()=>{if(!o||!Y||!o.content.text||!d||A)return o;const e=(0,l.m4)(o.content.text);return{...o,content:{...o.content,text:e}}},[A,Y,o,d]),Te=(0,Vt.A)(Se,!0);if(!ae)return;const Pe=r&&!C&&x!==r.id&&r.id!==w;return a.Ay.createElement("div",{className:Ce,ref:H,onContextMenu:ce},a.Ay.createElement("div",{className:Ie},a.Ay.createElement("div",{className:"embedded-left-icon",onClick:ce},Te&&a.Ay.createElement(St.A,{name:Te}),Boolean(e?.quoteText)&&a.Ay.createElement(St.A,{name:"quote",className:"quote-reply"})),a.Ay.createElement(Jt.b,{isOpen:te,className:"inside-input",replyInfo:e,suggestedPostInfo:t,isMediaNsfw:S,isInComposer:!0,message:ke,sender:d?void 0:r,composerForwardSenders:ee,customText:Me,title:n&&!_?K("EditMessage"):d?K("HiddenSendersNameDescription"):void 0,onClick:ue,senderChat:b}),a.Ay.createElement(Ft.A,{className:"embedded-cancel",round:!0,faded:!0,color:"translucent",ariaLabel:K("Cancel"),onClick:pe},a.Ay.createElement(St.A,{name:"close"})),(_||Y)&&!y&&a.Ay.createElement(Mt.A,{isOpen:re,anchor:le,getTriggerElement:be,getRootElement:xe,getMenuElement:we,className:"forward-context-menu",onClose:de,onCloseAnimationEnd:me},Y&&a.Ay.createElement(a.Ay.Fragment,null,a.Ay.createElement(kt.A,{icon:d?void 0:"message-succeeded",customIcon:d?a.Ay.createElement(St.A,{name:"placeholder"}):void 0,onClick:()=>z({noAuthors:!1})},K(c>1?"ShowSenderNames":"ShowSendersName")),a.Ay.createElement(kt.A,{icon:d?"message-succeeded":void 0,customIcon:d?void 0:a.Ay.createElement(St.A,{name:"placeholder"}),onClick:()=>z({noAuthors:!0})},K(c>1?"HideSenderNames":"HideSendersName")),p&&a.Ay.createElement(a.Ay.Fragment,null,a.Ay.createElement(Ht.A,null),a.Ay.createElement(kt.A,{icon:u?void 0:"message-succeeded",customIcon:u?a.Ay.createElement(St.A,{name:"placeholder"}):void 0,onClick:()=>j({noCaptions:!1})},K(c>1?"Conversation.ForwardOptions.ShowCaption":"ShowCaption")),a.Ay.createElement(kt.A,{icon:u?"message-succeeded":void 0,customIcon:u?void 0:a.Ay.createElement(St.A,{name:"placeholder"}),onClick:()=>j({noCaptions:!0})},K(c>1?"Conversation.ForwardOptions.HideCaption":"HideCaption"))),a.Ay.createElement(Ht.A,null),a.Ay.createElement(kt.A,{icon:"replace",onClick:ge},K("ForwardAnotherChat"))),_&&a.Ay.createElement(a.Ay.Fragment,null,a.Ay.createElement(kt.A,{icon:"show-message",onClick:Ae},K("Message.Context.Goto")),W&&a.Ay.createElement(kt.A,{icon:"remove-quote",onClick:ye},K("RemoveQuote")),Pe&&a.Ay.createElement(kt.A,{icon:"user",onClick:ve},$("ReplyInPrivateMessage")),a.Ay.createElement(kt.A,{icon:"replace",onClick:fe},K("ReplyToAnotherChat")),a.Ay.createElement(kt.A,{icon:"delete",onClick:Ee},K("DoNotReply"))))))}));var $t=n(25897),Gt=n(6070),_t=n(41510);const qt=e=>{const{isOpen:t}=e,n=(0,bt.A)(Et.ar.Extra,"DropArea",!t);return n?a.Ay.createElement(n,e):void 0};var Wt=n(49068);const Qt=e=>{const{isOpen:t}=e,n=(0,bt.A)(Et.ar.Extra,"InlineBotTooltip",!t);return n?a.Ay.createElement(n,e):void 0},Yt=e=>{const{isOpen:t}=e,n=(0,bt.A)(Et.ar.Extra,"MentionTooltip",!t);return n?a.Ay.createElement(n,e):void 0};var Zt=n(60474);const Xt=e=>{const{isOpen:t}=e,n=(0,bt.A)(Et.ar.Extra,"PollModal",!t);return n?a.Ay.createElement(n,e):void 0},en=e=>{const{isOpen:t}=e,n=(0,bt.A)(Et.ar.Extra,"SendAsMenu",!t);return n?a.Ay.createElement(n,e):void 0},tn=e=>{const{isOpen:t}=e,n=(0,bt.A)(Et.ar.Extra,"StickerTooltip",!t);return n?a.Ay.createElement(n,e):void 0};var nn=n(26440);const an=e=>{const{modal:t}=e,n=(0,bt.A)(Et.ar.Extra,"ToDoListModal",!t);return n?a.Ay.createElement(n,e):void 0};var sn=n(2338),on=n(62587),rn=n(34201),ln=n(86070);const cn="zqTOc7LU",dn="b0A9Zfoa",mn=(0,a.ph)((0,s.EK)((e,{chatId:t,threadId:n})=>{const a=(0,m.nTw)(e),s=(0,m.rQx)(e,t,n),{attachmentSettings:o}=e,r=a.webPagePreviewId?(0,m.kgA)(e,a.webPagePreviewId):void 0;return{webPagePreview:"empty"===r?.webpageType?void 0:r,noWebPage:s,attachmentSettings:o}})(({chatId:e,threadId:t,isDisabled:n,webPagePreview:o,noWebPage:r,attachmentSettings:i,isEditing:c})=>{const{toggleMessageWebPage:d,updateAttachmentSettings:m}=(0,s.ko)(),u=(0,ne.A)(),p=(0,a.li)(),h=i.isInvertedMedia,A="small"===i.webPageMediaSize,y=(0,X.A)(()=>Boolean(o&&!r&&!n),[n,r,o]),{shouldRender:f}=(0,rn.A)({isOpen:y,ref:p,withShouldRender:!0}),v="full"===o?.webpageType&&o.hasLargeMedia,E=(0,a.li)(o);o&&o!==E.current&&(E.current=o);const b=o||E.current,x="full"===b?.webpageType,w=(0,sn.A)(x?{content:b}:void 0),C=(0,l.eY)(b)||(0,l.rU)(b)||(0,l.y3)(b)||(0,l.rj)(b),N=C&&(0,l.VO)(C,"pictogram"),I=(0,on.A)(N),{shouldRender:S,ref:M}=(0,rn.A)({isOpen:Boolean(I),withShouldRender:!0,noCloseTransition:!0}),k=Boolean(I||S),T=(0,P.A)(()=>{d({chatId:e,threadId:t,noWebPage:!0})}),{isContextMenuOpen:L,contextMenuAnchor:B,handleContextMenu:R,handleContextMenuClose:F,handleContextMenuHide:D,handleBeforeContextMenu:O}=(0,Z.A)(p,c,!0),z=(0,P.A)(()=>p.current),j=(0,P.A)(()=>p.current),U=(0,P.A)(()=>p.current.querySelector(`.${cn} .bubble`)),V=(0,P.A)(e=>{R(e)});function J(e){m({isInvertedMedia:e})}function H(e){m({webPageMediaSize:e})}var K;if((0,a.vJ)(()=>{f&&b||(F(),D())},[F,D,f,b]),f&&b)return a.Ay.createElement("div",{className:(0,g.A)("O3di3ULC",!c&&"G5_7x_Hn"),ref:p},a.Ay.createElement("div",{className:"m3DBx9f5"},a.Ay.createElement("div",{className:"vFWsMwfP",onClick:V},a.Ay.createElement(St.A,{name:"link"})),b&&"empty"!==b.webpageType&&a.Ay.createElement(ln.A,{noUserColors:!0,className:"otSxF62k",onContextMenu:R,onMouseDown:O,onClick:V},k&&a.Ay.createElement("div",{className:"VvwZOug9"},w&&a.Ay.createElement("img",{src:w,alt:"",className:dn}),S&&a.Ay.createElement("img",{ref:M,src:I,alt:"",className:dn})),a.Ay.createElement("div",{className:"itmZe2qi"},a.Ay.createElement("span",{className:"ER149gdz"},x?b.siteName||b.url:u("Loading")),a.Ay.createElement("span",{className:"FSYSqC60"},x?b.description||u((K=b).photo?"AttachPhoto":K.video?"AttachVideo":K.audio?"AttachMusic":K.document?"AttachDocument":K.story?"AttachStory":"LinkPreview"):b.url))),a.Ay.createElement(Ft.A,{className:"yhxytYkd",round:!0,faded:!0,color:"translucent",ariaLabel:u("AccLinkRemovePreview"),onClick:T},a.Ay.createElement(St.A,{name:"close"})),!c&&a.Ay.createElement(Mt.A,{isOpen:L,anchor:B,getTriggerElement:z,getRootElement:j,getMenuElement:U,className:cn,onClose:F,onCloseAnimationEnd:D,autoClose:!0},a.Ay.createElement(a.Ay.Fragment,null,h?a.Ay.createElement(kt.A,{icon:"move-caption-up",onClick:()=>J(void 0)},u("ContextMoveTextUp")):a.Ay.createElement(kt.A,{icon:"move-caption-down",onClick:()=>J(!0)},u("ContextMoveTextDown")),v&&(A?a.Ay.createElement(kt.A,{icon:"expand",onClick:()=>H("large")},u("ContextLinkLargerMedia")):a.Ay.createElement(kt.A,{icon:"collapse",onClick:()=>H("small")},u("ContextLinkSmallerMedia"))),a.Ay.createElement(kt.A,{icon:"delete",onClick:T},u("ContextLinkRemovePreview"))))))}));var un=n(75295),pn=n(76283),hn=n(57474),gn=n(41036),An=n(68292),yn=n(21849),fn=n(48227),vn=n(11241),En=function(e){return e.Send="send",e.Record="record",e.Edit="edit",e.Schedule="schedule",e.Forward="forward",e.SendOneTime="sendOneTime",e}(En||{});const bn=(0,a.ph)((0,s.EK)((e,{chatId:t,threadId:n,storyId:a,messageListType:s,isMobile:i,type:d})=>{const h=e.appConfig,g=(0,m.hds)(e,t),A=(0,l.DX)(t)?void 0:(0,m.yps)(e,t),y=Boolean(A),f=(0,m.nZ4)(e,t),v=(0,E.L8)(t),b=v?(0,m.vGo)(e,t):void 0,x=(0,m.WA9)(e,t),w=v?void 0:(0,m.AWZ)(e,t),C=(y||!v)&&(0,m.tVS)(e,t,n),{shouldSuggestStickers:N,shouldSuggestCustomEmoji:I,shouldUpdateStickerSetOrder:S,shouldPaidMessageAutoApprove:M}=e.settings.byKey,{language:k,shouldCollectDebugLogs:T}=(0,p.l)(e),{forwardMessages:{messageIds:P}}=(0,m.nTw)(e),L=e.emojiKeywords[r.cUY],B=k!==r.cUY?e.emojiKeywords[k]:void 0,R=C?C.id:void 0,F=R?(0,m.O5q)(e,t,R):void 0,{currentUserId:D}=e,O=(0,m.mBe)(e,D),z=w?w?.sendAsId||D:void 0,j=z?(0,m.PVB)(e,z):void 0,U=(0,m.sam)(e,t),V=(0,m.p6T)(e,t),J=(0,m.nTw)(e),H=Boolean(J.storyViewer.storyId),K=(0,m.Xf0)(e),$=t===K?.chatId&&n===K?.threadId&&s===K?.type&&!H,G=((0,m.mBe)(e,t)&&!b?.noVoiceMessages)??!0,_=w?.slowMode,q=(0,m.g29)(e),W="scheduled"===s?(0,m.dkp)(e,t):(0,m.U0A)(e,t,n),Q=a&&(0,m.Msb)(e,t,a),Y=Q&&"sentReaction"in Q?Q.sentReaction:void 0,Z=(0,m.GA4)(e,t,n),X=Z?.replyInfo?(0,m.O5q)(e,t,Z.replyInfo.replyToMsgId):void 0,ee=g?.isForum&&g.isForumAsMessages&&n===o.l3&&X?(0,m.nkm)(e,X):void 0,te="scheduled"===s,ne=v&&!y&&!te&&!f,ae=(0,m.rQx)(e,t,n),se=g&&(0,c.RY)(g,(0,m.K52)(e),(0,m.P5N)(e,t))?.isSilentPosting,oe=v&&!y&&!te&&!f&&"story"!==d&&t!==r.zv8,re=(0,m.xYJ)(e,"stickerEffects"),ie=J.shouldPlayEffectInComposer,le=oe&&Z?.effectId,ce=le?e.availableEffectById[le]:void 0,de=e.reactions.effectReactions,me=e.config?.maxMessageLength||r.YfK,ue=t===J.forwardMessages.toChatId,pe=Boolean(Z?.replyInfo),he=Boolean(Z?.suggestedPostInfo),ge=e.stars?.balance.amount||0,Ae=Boolean(J.starsBalanceModal),ye=(0,m.trm)(e),fe=e.isAppConfigLoaded,ve=J.insertingPeerIdMention,Ee=J.webPagePreviewId?(0,m.kgA)(e,J.webPagePreviewId):void 0;return{availableReactions:e.reactions.availableReactions,topReactions:"story"===d?e.reactions.topReactions:void 0,isOnActiveTab:!J.isBlurred,editingMessage:(0,m.KLw)(e,t,n,s),draft:Z,chat:g,isChatWithBot:y,isChatWithSelf:f,isForCurrentMessageList:$,canScheduleUntilOnline:(0,m.RBq)(e,t),isChannel:g?(0,l.WX)(g):void 0,isRightColumnShown:(0,m.gjV)(e,i),isSelectModeActive:(0,m.rTV)(e),withScheduledButton:"thread"===s&&(b||w)?.hasScheduledMessages,isInScheduledList:te,botKeyboardMessageId:R,botKeyboardPlaceholder:F?.keyboardPlaceholder,isForwarding:ue,isReplying:pe,hasSuggestedPost:he,forwardedMessagesCount:ue?P.length:void 0,pollModal:J.pollModal,todoListModal:J.todoListModal,stickersForEmoji:e.stickers.forEmoji.stickers,customEmojiForEmoji:e.customEmojis.forEmoji.stickers,chatFullInfo:w,topInlineBotIds:e.topInlineBots?.userIds,currentUserId:D,currentUser:O,contentToBeScheduled:J.contentToBeScheduled,shouldSuggestStickers:N,shouldSuggestCustomEmoji:I,shouldUpdateStickerSetOrder:S,recentEmojis:e.recentEmojis,baseEmojiKeywords:L?.keywords,emojiKeywords:B?.keywords,inlineBots:J.inlineBots.byUsername,isInlineBotLoading:J.inlineBots.isLoading,botCommands:b?b.botInfo?.commands||!1:void 0,botMenuButton:b?.botInfo?.menuButton,sendAsPeer:j,sendAsId:z,editingDraft:W,requestedDraft:U,requestedDraftFiles:V,attachBots:e.attachMenu.bots,attachMenuPeerType:(0,m.dfQ)(e,t),theme:(0,m.SJA)(e),fileSizeLimit:(0,u.d)(e,"uploadMaxFileparts")*r.dK5,captionLimit:(0,u.d)(e,"captionLength"),isCurrentUserPremium:q,canSendVoiceByPrivacy:G,attachmentSettings:e.attachmentSettings,slowMode:_,currentMessageList:K,isReactionPickerOpen:(0,m.Ani)(e),canBuyPremium:!q&&!(0,m.n_C)(e),canPlayAnimatedEmojis:(0,m.BWX)(e),canSendOneTimeMedia:!f&&v&&!y&&!te,shouldCollectDebugLogs:T,sentStoryReaction:Y,stealthMode:e.stories.stealthMode,replyToTopic:ee,quickReplyMessages:e.quickReplies.messagesById,quickReplies:e.quickReplies.byId,canSendQuickReplies:ne,noWebPage:ae,webPagePreview:Ee,isContactRequirePremium:b?.isContactRequirePremium,effect:ce,effectReactions:de,areEffectsSupported:oe,canPlayEffect:re,shouldPlayEffect:ie,maxMessageLength:me,paidMessagesStars:x,shouldPaidMessageAutoApprove:M,isSilentPosting:se,isPaymentMessageConfirmDialogOpen:J.isPaymentMessageConfirmDialogOpen,starsBalance:ge,isStarsBalanceModalOpen:Ae,shouldDisplayGiftsButton:b?.shouldDisplayGiftsButton,disallowedGifts:b?.disallowedGifts,isAccountFrozen:ye,isAppConfigLoaded:fe,insertingPeerIdMention:ve,pollMaxAnswers:h?.pollMaxAnswers}})(({type:e,isOnActiveTab:t,dropAreaState:n,isInScheduledList:c,canScheduleUntilOnline:u,isReady:p,isMobile:E,editingMessage:B,chatId:R,threadId:F,storyId:D,currentMessageList:O,messageListType:j,draft:H,chat:he,chatFullInfo:ge,replyToTopic:Ae,isForCurrentMessageList:ye,isCurrentUserPremium:fe,canSendVoiceByPrivacy:ve,isChatWithBot:Ee,isChatWithSelf:be,isChannel:xe,fileSizeLimit:we,isRightColumnShown:Ce,isSelectModeActive:Ne,isReactionPickerOpen:Ie,shouldDisplayGiftsButton:De,isForwarding:We,isReplying:Qe,hasSuggestedPost:Ye,forwardedMessagesCount:Ze,pollModal:Xe,todoListModal:nt,botKeyboardMessageId:at,botKeyboardPlaceholder:st,inputPlaceholder:ot,withScheduledButton:rt,stickersForEmoji:it,customEmojiForEmoji:lt,topInlineBotIds:ct,currentUserId:dt,currentUser:mt,captionLimit:ut,contentToBeScheduled:pt,shouldSuggestStickers:ht,shouldSuggestCustomEmoji:gt,baseEmojiKeywords:At,emojiKeywords:yt,recentEmojis:Et,inlineBots:bt,isInlineBotLoading:wt,botCommands:Ct,sendAsPeer:Nt,sendAsId:It,editingDraft:Mt,requestedDraft:kt,requestedDraftFiles:Pt,botMenuButton:Rt,attachBots:jt,attachMenuPeerType:Ut,attachmentSettings:Vt,theme:Jt,slowMode:Ht,shouldUpdateStickerSetOrder:sn,editableInputCssSelector:on,editableInputId:rn,inputId:ln,className:cn,availableReactions:dn,topReactions:bn,canBuyPremium:xn,canPlayAnimatedEmojis:wn,shouldCollectDebugLogs:Cn,sentStoryReaction:Nn,stealthMode:In,canSendOneTimeMedia:Sn,quickReplyMessages:Mn,quickReplies:kn,canSendQuickReplies:Tn,webPagePreview:Pn,noWebPage:Ln,isContactRequirePremium:Bn,paidMessagesStars:Rn,effect:Fn,effectReactions:Dn,areEffectsSupported:On,canPlayEffect:zn,shouldPlayEffect:jn,maxMessageLength:Un,isSilentPosting:Vn,isPaymentMessageConfirmDialogOpen:Jn,starsBalance:Hn,isStarsBalanceModalOpen:Kn,disallowedGifts:$n,isAccountFrozen:Gn,isAppConfigLoaded:_n,insertingPeerIdMention:qn,pollMaxAnswers:Wn,onDropHide:Qn,onFocus:Yn,onBlur:Zn,onForward:Xn})=>{const{sendMessage:ea,clearDraft:ta,showDialog:na,openPollModal:aa,closePollModal:sa,openTodoListModal:oa,closeTodoListModal:ra,loadScheduledHistory:ia,openThread:la,addRecentEmoji:ca,sendInlineBotResult:da,loadSendAs:ma,resetOpenChatWithDraft:ua,callAttachBot:pa,addRecentCustomEmoji:ha,showNotification:ga,showAllowedMessageTypesNotification:Aa,openStoryReactionPicker:ya,openGiftModal:fa,closeReactionPicker:va,sendStoryReaction:Ea,editMessage:ba,updateAttachmentSettings:xa,saveEffectInDraft:wa,setReactionEffect:Ca,hideEffectInComposer:Na,updateChatSilentPosting:Ia,updateInsertingPeerIdMention:Sa,updateDraftSuggestedPostInfo:Ma}=(0,s.ko)(),ka=(0,L.A)(),Ta=(0,ne.A)(),Pa=(0,a.li)(),La=(0,a.li)(),Ba=(0,a.li)(),[Ra,Fa]=(0,a.Ul)(""),[Da,Oa]=(0,a.J0)(!1),za=(0,te.A)(on),ja=(0,a.li)(),Ua=(0,se.A)(n),{width:Va}=S.A.get(),Ja="messageList"===e,Ha="story"===e,Ka=Ja?he?.sendAsPeerIds:void 0,$a=Boolean(Ka?.length),[Ga,_a,qa]=(0,z.A)(),Wa=(0,re.A)(R,F),[Qa,Ya,Za]=(0,z.A)(),[Xa,es,ts]=(0,z.A)(),[ns,as]=(0,a.J0)(!1),ss=B&&(0,l.ZV)(B),os=he?.isMonoforum,{emojiSet:rs,members:is,botCommands:ls}=ge||{},cs=rs?.id,ds=!Rn&&!os,ms=Nn&&(0,l.a0)(Nn,r.tNZ);(0,a.vJ)(v.VU,[Ra]);const us=(0,a.li)(0),[ps,hs]=(0,oe.A)(Ja&&u,qa);(0,Y.A)(()=>{Oa(!0)},430),(0,a.vJ)(()=>{Ja||va()},[Ja,D]),(0,a.vJ)(()=>{ja.current=void 0},[R]),(0,a.vJ)(()=>{_n&&R&&p&&!Ha&&!os&&ia({chatId:R})},[p,R,F,Ha,_n,os]),(0,a.vJ)(()=>{const e=xe&&he?.areProfilesShown,t=he&&(0,l.Vs)(he)&&Boolean((0,l.gA)(he)||he.isLinkedInDiscussion||he.hasGeo);!Ka&&p&&(t||e)&&ma({chatId:R})},[he,R,xe,p,ma,Ka]);const gs=(0,a.li)(!1);(0,ce.A)(([e,t])=>{gs.current=Boolean(R===e&&Ka&&!t)},[R,Ka]);const[As,ys]=(0,a.J0)([]),fs=Boolean(As.length),[vs,Es]=(0,a.J0)(void 0),{canSendStickers:bs,canSendGifs:xs,canAttachMedia:ws,canAttachPolls:Cs,canAttachEmbedLinks:Ns,canAttachToDoLists:Is,canSendVoices:Ss,canSendPlainText:Ms,canSendAudios:ks,canSendVideos:Ts,canSendPhotos:Ps,canSendDocuments:Ls}=(0,a.Kr)(()=>(0,l.Q_)(he,ge,Ee,be,Ha,Rn,c),[he,ge,Ee,be,Ha,Rn,c]),Bs=Bn&&Ha,Rs=Bs||!Ms,Fs=(0,X.A)(()=>{if(fs)return As.length;const e=Ra()||fs?1:0;return We&&Ze?Ze+e:e||1},[Ra,fs,As,We,Ze]),Ds=Rn?Fs*Rn:0,{closeConfirmDialog:Os,dialogHandler:zs,shouldAutoApprove:js,setAutoApprove:Us,handleWithConfirmation:Vs}=(0,Ke.A)(Ds,Kn,Hn),Js=!fs&&Ns&&!Ln&&Boolean(Pn),Hs=Rs&&!B;(0,a.vJ)(()=>{Js||xa({isInvertedMedia:void 0})},[Js]);const Ks=(0,P.A)((e,t=rn)=>{if(t===rn&&Hs)return;const n=window.getSelection();let a;if(a=t===rn?document.querySelector(on):document.getElementById(t),n.rangeCount){const s=n.getRangeAt(0);if((0,_.L)(s,t))return(0,N.oR)(e),void a.dispatchEvent(new Event("input",{bubbles:!0}))}Fa(`${Ra()}${e}`),(0,i.Uz)(()=>{(0,b.A)(a)})}),$s=(0,P.A)((e,t=rn)=>{const n=(0,T.A)(e,["escape_html","emoji_html","br_html"]).join("").replace(/\u200b+/g,"​");Ks(n,t)}),Gs=(0,P.A)((e,t=rn)=>{const n=(0,W.QY)(e);Ks(n,t)}),_s=(0,P.A)((e,t=rn)=>{Ks((0,G.hB)(e),t)}),qs=(0,P.A)(()=>{vs&&(Gs(vs,rn),Es(void 0))}),{shouldForceCompression:Ws,shouldForceAsFile:Qs,handleAppendFiles:Ys,handleFileSelect:Zs,onCaptionUpdate:Xs,handleClearAttachments:eo,handleSetAttachments:to}=function({attachments:e,fileSizeLimit:t,setHtml:n,setAttachments:o,chatId:r,canSendAudios:i,canSendVideos:c,canSendPhotos:d,canSendDocuments:m,insertNextText:u,editedMessage:p,shouldSendInHighQuality:h}){const g=(0,ne.A)(),{openLimitReachedModal:A,showAllowedMessageTypesNotification:y,showNotification:f}=(0,s.ko)(),[v,E]=(0,a.J0)(!1),[b,x]=(0,a.J0)(!1),C=(0,P.A)(()=>{o(w.p),u()}),N=(0,P.A)(n=>{const a="function"==typeof n?n(e):n;if(a.length)if(a.some(e=>{const t=(0,l.ES)(e);return"audio"===t&&!i&&!m||"video"===t&&!c&&!m||"photo"===t&&!d&&!m||"file"===t&&!m}))y({chatId:r});else if(a.some(({size:e})=>e>t))A({limit:"uploadMaxFileparts"});else{o(a);const e=a.some(e=>{const t=(0,l.ES)(e);return"audio"===t&&!i||"video"===t&&!c||"photo"===t&&!d});E(Boolean(e&&m)),x(!m)}else C()}),I=(0,P.A)(async(t,n)=>{if(p){const e=await(0,$.A)(t[0].name,t[0]),n=p&&(0,l.eh)(p,e);p?.groupedId?n?N([e]):f({message:g("MediaReplaceInvalidError",void 0,{pluralValue:t.length})}):N([e])}else{const a=await Promise.all(t.map(e=>(0,$.A)(e.name,e,{shouldSendAsSpoiler:n||void 0,shouldSendInHighQuality:h})));N([...e,...a])}}),S=(0,P.A)(async e=>{if(p){const t=await(0,$.A)(e[0].name,e[0]),n=p&&(0,l.eh)(p,t);p?.groupedId?n?N([t]):f({message:g("MediaReplaceInvalidError",void 0,{pluralValue:e.length})}):N([t])}else{const t=await Promise.all(e.map(e=>(0,$.A)(e.name,e,{shouldSendInHighQuality:h})));N(t)}}),M=(0,P.A)(async()=>{const t=await Promise.all(e.map(e=>(0,$.A)(e.filename,e.blob,{shouldSendInHighQuality:h})));N(t)});return(0,a.vJ)(()=>{M()},[h]),{handleAppendFiles:I,handleFileSelect:S,onCaptionUpdate:n,handleClearAttachments:C,handleSetAttachments:N,shouldForceCompression:b,shouldForceAsFile:v}}({attachments:As,setHtml:Fa,setAttachments:ys,fileSizeLimit:we,chatId:R,canSendAudios:ks,canSendVideos:Ts,canSendPhotos:Ps,canSendDocuments:Ls,insertNextText:qs,editedMessage:B,shouldSendInHighQuality:Vt.shouldSendInHighQuality});(0,a.vJ)(()=>(globalThis.p__handleFileSelect=Zs,()=>{globalThis.p__handleFileSelect=void 0,delete globalThis.p__handleFileSelect}),[Zs]);const[no,ao,so]=(0,z.A)(),[oo,ro,io]=(0,z.A)(),[lo,co,mo]=(0,z.A)(),[uo,po,ho]=(0,z.A)(),[go,Ao,yo]=(0,z.A)(),{startRecordingVoice:fo,stopRecordingVoice:vo,pauseRecordingVoice:Eo,activeVoiceRecording:bo,currentRecordTime:xo,recordButtonRef:wo,startRecordTimeRef:Co,isViewOnceEnabled:No,setIsViewOnceEnabled:Io,toogleViewOnceEnabled:So}=(()=>{const e=(0,a.li)(),[t,n]=(0,a.J0)(),s=(0,a.li)(),[o,r]=(0,a.J0)(),[l,c]=(0,a.J0)(!1);(0,a.vJ)(()=>{h.Yw&&h.pW&&et()},[]);const d=(0,P.A)(async()=>{try{const{stop:t,pause:a}=await tt(t=>{e.current&&(s.current&&Date.now()%4==0&&(0,i.RK)(()=>{e.current&&(e.current.style.boxShadow=`0 0 0 ${50*(t||0)}px rgba(0,0,0,.15)`)}),r(Date.now()))});s.current=Date.now(),r(Date.now()),n({stop:t,pause:a})}catch(e){console.error(e)}}),m=(0,P.A)(()=>{if(t){(0,i.RK)(()=>{e.current&&(e.current.style.boxShadow="none")});try{return t.pause()}catch(e){return void console.error(e)}}}),u=(0,P.A)(()=>{if(t){n(void 0),s.current=void 0,r(void 0),(0,i.RK)(()=>{e.current&&(e.current.style.boxShadow="none")});try{return t.stop()}catch(e){return void console.error(e)}}});(0,a.vJ)(()=>t?(0,qe.A)(u):void 0,[t,u]);const p=(0,P.A)(()=>{c(!l)});return{startRecordingVoice:d,pauseRecordingVoice:m,stopRecordingVoice:u,activeVoiceRecording:t,currentRecordTime:o,recordButtonRef:e,startRecordTimeRef:s,isViewOnceEnabled:l,setIsViewOnceEnabled:c,toogleViewOnceEnabled:p}})(),Mo=ye&&!Ha;(0,Q.A)(()=>{Wa({type:"recordAudio"})},Mo?bo&&r.cqp:void 0),(0,a.vJ)(()=>{ye&&!Ha&&(bo||Wa({type:"cancel"}))},[bo,ye,Ha,Wa]);const ko=(0,le.i)(Boolean(B)),To=(0,P.A)(e=>{as(e)}),Po=(0,P.A)(e=>{as(!1),Fa(e)});(0,a.vJ)(()=>{ye&&!Ha&&Ra()&&!ko.current&&Wa({type:"typing"})},[Ra,ko,ye,Ha,Wa]),(0,a.vJ)(()=>(vt.A.on("update-input-text",Po),vt.A.on("update-input-spiner",To),()=>{vt.A.off("update-input-text",Po),vt.A.off("update-input-spiner",To)}),[]);const Lo=he&&(0,l.SJ)(he),{isEmojiTooltipOpen:Bo,closeEmojiTooltip:Ro,filteredEmojis:Fo,filteredCustomEmojis:Do,insertEmoji:Oo}=(0,Fe.A)(Boolean(p&&t&&(Ha||ye)&&ht&&!fs),Ra,Fa,void 0,Et,At,yt),{isCustomEmojiTooltipOpen:zo,closeCustomEmojiTooltip:jo,insertCustomEmoji:Uo}=(0,Me.A)(Boolean(p&&t&&(Ha||ye)&&gt&&!fs),Ra,Fa,za,Pa,lt),{isStickerTooltipOpen:Vo,closeStickerTooltip:Jo}=function(e,t,n){const{loadStickersForEmoji:o,clearStickersForEmoji:i}=(0,s.ko)(),[l,c,d]=(0,z.A)(!1),m=(0,ue.A)(()=>{const n=t();if(!e||!n||h.TL&&n.length>8)return;if(!n.match(h.TL?$e.A:r.bpX))return;const a=(0,de.S)(n);return a&&(h.TL&&1===(0,Ge.A)(a)||!h.TL&&Boolean(n.match(_e)))?h.TL?a:a.match(/alt="(.+)"/)?.[1]:void 0},[t,e]),u=(0,X.A)(()=>Boolean(m()),[m]),p=Boolean(n?.length);return(0,a.vJ)(()=>{if(!e||!u)return;const t=m();t?p||o({emoji:t}):i()},[e,u,m,p,o,i]),(0,a.vJ)(d,[d,t]),{isStickerTooltipOpen:Boolean(u&&p&&!l),closeStickerTooltip:c}}(Boolean(p&&t&&(Ha||ye)&&ht&&bs&&!fs),Ra,it),{isMentionTooltipOpen:Ho,closeMentionTooltip:Ko,insertMention:$o,mentionFilteredUsers:Go}=(0,He.A)(Boolean(Ja&&p&&ye&&!fs),Ra,Fa,za,Pa,is,ct,dt);(0,a.vJ)(()=>{if(!qn)return;const e=(0,m.PVB)((0,s.mS)(),qn);e&&$o(e,!0,!0),Sa({peerId:void 0})},[qn,$o]);const{isOpen:_o,botId:qo,isGallery:Wo,switchPm:Qo,switchWebview:Yo,results:Zo,closeTooltip:Xo,help:er,loadMore:tr}=function(e,t,n,o){const{queryInlineBot:r,resetInlineBot:i,resetAllInlineBots:l}=(0,s.ko)(),[c,d,m]=(0,z.A)(!1),u=(0,me.gs)(()=>{const t=n();return e&&t.startsWith("@")?function(e){if(!e.startsWith("@"))return je;const t=function(e){return Ue.innerHTML=e.replace(/<br>/g,"\n"),Ue.querySelectorAll("[alt]").forEach(e=>{e.innerText||(e.innerText=e.getAttribute("alt"))}),Ue.innerText}(e),n=t.match(Oe);return n?Ve(n[1],n[2],""===n[2]&&!t.match(ze)):je}(t):je},[n,e],300),{username:p,query:h,canShowHelp:g,usernameLowered:A}=(0,X.A)(u,[u,n],!0);(0,ce.A)(([e])=>{e&&i({username:e})},[p,i]),(0,a.vJ)(()=>{A&&r({chatId:t,username:A,query:h})},[t,h,r,A]),(0,a.vJ)(m,[m,n]);const{id:y,switchPm:f,switchWebview:v,offset:E,results:b,isGallery:x,help:w}=A&&o?.[A]||{},C=Boolean((b?.length||f)&&!c);(0,a.vJ)(()=>{C||p||l()},[C,l,p]);const N=(0,P.A)(()=>{A&&r({chatId:t,username:A,query:h,offset:E})});return{isOpen:C,botId:y,isGallery:x,switchPm:f,switchWebview:v,results:b,closeTooltip:d,help:g&&w?`@${p} ${w}`:void 0,loadMore:N}}(Boolean(Ja&&p&&ye&&!fs),R,Ra,bt),nr=Boolean(kn&&Object.keys(kn).length),{isOpen:ar,close:sr,filteredBotCommands:or,filteredQuickReplies:rr}=function(e,t,n,s,o){const[r,i]=(0,a.J0)(),[l,c]=(0,a.J0)(),[d,m,u]=(0,z.A)(!1),p=(0,me.gs)(()=>{const n=t();return e&&n.startsWith("/")?(0,de.S)(n).match(pe)?.[0].trim():void 0},[t,e],300),h=(0,ue.A)(p,[p,t],!0);return(0,a.vJ)(()=>{const e=h(),t=n||s;if(!e||!t&&!o)return i(void 0),void c(void 0);const a=e.substring(1),r=t?.filter(e=>!a||e.command.startsWith(a));i(r?.length?r:void 0);const l=Object.values(o||{}).filter(e=>!a||e.shortcut.startsWith(a));c(l?.length?l:void 0)},[h,n,s,o]),(0,a.vJ)(u,[u,t]),{isOpen:Boolean((r?.length||l?.length)&&!d),close:m,filteredBotCommands:r,filteredQuickReplies:l}}(Boolean(Ja&&p&&ye&&(Ct&&Ct?.length||ls?.length||nr&&Tn)),Ra,Ct,ls,Tn?kn:void 0);(({draft:e,chatId:t,threadId:n,getHtml:l,setHtml:c,editedMessage:d,isDisabled:m})=>{const{saveDraft:u,clearDraft:p,loadCustomEmojis:h}=(0,s.ko)(),g=(0,a.li)(!1);(0,a.vJ)(()=>{const t=l(),n=void 0!==e?.isLocal;(0,W.QY)(e?.text)!==t||n?g.current=!0:g.current=!1},[e,l]),(0,a.vJ)(()=>{g.current=!1},[t,n]);const A=Boolean(d),y=(0,P.A)((e={})=>{if(m||A||!g.current)return;const a=l();a?(0,i.YS)(()=>{u({chatId:e.chatId??t,threadId:e.threadId??n,text:(0,C.Ay)(a)})}):p({chatId:e.chatId??t,threadId:e.threadId??n,shouldKeepReply:!0,shouldKeepSuggestedPost:!0})}),f=(0,Te.A)(r.mPG,!0,void 0,[t,n]);(0,ke.A)(([a,s,l])=>{if(m)return;const u=g.current,p=e?.suggestedPostInfo&&!l?.suggestedPostInfo;if(t===a&&n===s){if(u&&!e)return;if(!e&&l&&c(""),u&&!p)return}if(d||!e)return;c((0,W.QY)(e.text)),p&&(0,i.Uz)(()=>{const e=document.querySelector(r.m$5);e&&(0,b.A)(e,!0)});const A=e.text?.entities?.map(e=>e.type===o.C7.CustomEmoji&&e.documentId).filter(Boolean)||[];A.length&&h({ids:A})},[t,n,e,l,c,d,m]),(0,a.Nf)(()=>{if(!m)return()=>{A||y({chatId:t,threadId:n}),Be=!0,(0,i.YS)(()=>{Be=!1})}},[t,n,A,y,m]);const v=(0,le.i)(t),E=(0,le.i)(n);(0,a.vJ)(()=>{if(m||Be)return;if(!l())return void y();const e=v.current,t=E.current;f(()=>{v.current===e&&E.current===t&&y()})},[v,l,m,f,E,y]),(0,Pe.Ay)(y),(0,Le.A)(y)})({draft:H,chatId:R,threadId:F,getHtml:Ra,setHtml:Fa,editedMessage:B,isDisabled:Ha||Boolean(kt)||!Ye&&os}),function({getHtml:e,chatId:t,threadId:n}){const{loadWebPagePreview:r,clearWebPagePreview:i,toggleMessageWebPage:l}=(0,s.ko)(),c=(0,a.li)(),d=(0,me.tF)(()=>{const t=(0,C.Ay)(e()),n=t.entities?.find(e=>e.type===o.C7.TextUrl);return c.current=t,n?.url||t.text.match(Je)?.[0]},[e],300,!0),m=(0,ue.A)(d,[d,e],!0);(0,a.vJ)(()=>{const e=m(),a=c.current;e?r({text:a}):(i(),l({chatId:t,threadId:n}))},[m,t,n]),(0,ce.A)(()=>{i(),l({chatId:t,threadId:n})},[t,i,n,l])}({chatId:R,threadId:F,getHtml:Ra});const ir=(0,P.A)((e=!1)=>{e||Fa(""),ys(w.p),Es(void 0),Ro(),jo(),Jo(),Ko(),E?setTimeout(()=>mo(),350):mo()}),[lr,cr,dr]=((e,t,n,o,c,d,m,u,p)=>{const{editMessage:h,setEditingDraft:g,toggleMessageWebPage:A,openDeleteMessageModal:y}=(0,s.ko)(),[f,v]=(0,a.J0)(!1),E=u?.replyInfo?.replyToMsgId;(0,ee.A)(([e,a])=>{if(!n)return;if(E&&a!==E)return t(""),void v(!1);if(e?.id===n.id&&E===a)return;const s=!e&&p?.text.length?p:n.content.text,o=(0,W.QY)(s);t(o),v(!0),(0,i.Uz)(()=>{const e=document.querySelector(r.m$5);e&&(0,b.A)(e,!0)})},[n,E,p,t]),(0,a.vJ)(()=>{if(!n)return;const e=!("webPage"in n.content)&&n.content.text?.entities?.some(e=>Re.has(e.type));A({chatId:c,threadId:d,noWebPage:e})},[c,d,n]),(0,a.vJ)(()=>{if(n)return()=>{const t=(0,C.Ay)(e()),n=t.text.length?t:void 0;g({chatId:c,threadId:d,type:m,text:n})}},[c,n,e,g,d,m]);const x=(0,me.tF)(()=>{if(!n)return!1;const t=(0,C.Ay)(e());return!("webPage"in n.content)&&n.content.text?.entities?.some(e=>Re.has(e.type))&&!t.entities?.some(e=>Re.has(e.type))},[n,e],300,!0),w=(0,ue.A)(x,[x,e],!0);(0,ee.A)(([e])=>{n&&e?.id===n.id&&w()&&A({chatId:c,threadId:d,noWebPage:!1})},[n,c,e,d,w]);const N=(0,P.A)(()=>{u&&(0,i.YS)(()=>{t((0,W.QY)(u.text)),(0,i.Uz)(()=>{const e=document.querySelector(r.m$5);e&&(0,b.A)(e,!0)})})}),I=(0,P.A)(()=>{o(),N()}),S=(0,P.A)(()=>{const{text:t,entities:a}=(0,C.Ay)(e());n&&(t||(0,l.mR)(n)?(h({messageList:{chatId:c,threadId:d,type:m},text:t,entities:a}),o(),N()):y({chatId:c,messageIds:[n.id],isSchedule:"scheduled"===m}))}),M=(0,P.A)(()=>{if(!n)return;const t=(0,C.Ay)(e()),a=t.text.length?t:void 0;g({chatId:c,threadId:d,type:m,text:a})});return(0,Pe.Ay)(M),(0,Le.A)(M),[S,I,f]})(Ra,Fa,B,ir,R,F,j,H,Mt),mr=(0,le.i)(ir),ur=(0,le.i)(vo);(0,a.vJ)(()=>()=>{ur.current(),mr.current()},[R,F,mr,ur]);const pr=(0,a.Kr)(()=>{if($n)return Object.values($n).every(Boolean)},[$n]),hr=Boolean(!be&&De&&!pr),gr=os&&!B&&!We&&!Qe&&!H?.suggestedPostInfo,Ar=(0,P.A)(()=>{const e=us.current;ga(e?{message:ka("UnlockPremiumEmojiHint2"),action:{action:"openChat",payload:{id:dt,shouldReplaceHistory:!0}},actionText:ka("Open")}:{message:ka("UnlockPremiumEmojiHint"),action:{action:"openPremiumModal",payload:{initialSection:"animated_emoji"}},actionText:ka("PremiumMore")}),us.current=Number(!e)}),yr=(0,X.A)(()=>Qa||!Xn||Ra()&&!fs?B&&dr?En.Edit:!h.pW||bo||We||Ra()&&!fs?c?En.Schedule:En.Send:En.Record:En.Forward,[bo,B,Ra,fs,We,Qa,Xn,dr,c]),fr=!c,{isContextMenuOpen:vr,handleContextMenu:Er,handleContextMenuClose:br,handleContextMenuHide:xr}=(0,Z.A)(wo,!(yr===En.Send&&fr)),{contextMenuAnchor:wr,handleContextMenu:Cr,handleBeforeContextMenu:Nr,handleContextMenuHide:Ir}=(0,Z.A)(Ba,!Ha);(0,a.vJ)(()=>{Ie||wr&&(ya({peerId:R,storyId:D,position:wr}),Ir())},[R,Ir,Ie,D,wr]),Se(ye||Ha,Gs,to,Es,B,!fe&&!be,Ar);const Sr=(0,P.A)(()=>{B&&cr()}),Mr=(0,P.A)((e,t)=>{const n=t?ut:Un;if(e?.length>n){const t=e.length-n;return na({data:{message:"MESSAGE_TOO_LONG_PLEASE_REMOVE_CHARACTERS",textParams:{"{EXTRA_CHARS_COUNT}":t.toString(),"{PLURAL_S}":t>1?"s":""},hasErrorKey:!0}}),!1}return!0}),kr=(0,P.A)(()=>{if(Ht&&!Lo){const e=document.querySelector(on),t=(0,I.Fm)(),n=ja.current&&Math.floor(t-ja.current),a=Ht.nextSendDate&&Ht.nextSendDate>t;if(n&&n<Ht.seconds||a){const s=a?Ht.nextSendDate-t:Ht.seconds-n;return na({data:{message:ka("SlowModeHint",(0,A.QO)(s)),isSlowMode:!0,hasErrorKey:!1}}),e?.blur(),!1}}return!0}),Tr=e=>{if(!O&&!D)return!1;const{text:t}=(0,C.Ay)(Ra());return!(!t&&!e.length||!Mr(t,!0)||!kr())},Pr=(0,P.A)(({attachments:e,sendCompressed:t=Vt.shouldCompress,sendGrouped:n=Vt.shouldSendGrouped,isSilent:a,scheduledAt:s,isInvertedMedia:o})=>{if(!O&&!D)return;a=a||Vn;const{text:r,entities:l}=(0,C.Ay)(Ra());o=r&&t&&n?o:void 0,B?ba({messageList:O,text:r,entities:l,attachments:(0,$.L)(e,t)}):ea({messageList:O,text:r,entities:l,scheduledAt:s,isSilent:a,shouldUpdateStickerSetOrder:sn,attachments:(0,$.L)(e,t),shouldGroupMessages:n,isInvertedMedia:o}),ja.current=(0,I.Fm)(),ta({chatId:R,isLocalOnly:!0}),(0,i.YS)(()=>{ir()})}),Lr=(0,P.A)((e,t,n)=>{if(Tr(As)){if(B)return void Pr({attachments:As,sendCompressed:e,sendGrouped:t,isInvertedMedia:n});Vs(Pr,{attachments:As,sendCompressed:e,sendGrouped:t,isInvertedMedia:n})}}),Br=(0,P.A)((e,t,n,a,s)=>{Tr(As)&&Pr({attachments:As,sendCompressed:e,sendGrouped:t,isSilent:n,scheduledAt:a,isInvertedMedia:s})}),Rr=(0,P.A)((e,t=!1,n)=>{const{text:a,entities:s}=(0,C.Ay)(Ra());if(e.length)return void(Tr(e)&&Pr({attachments:e,scheduledAt:n,isSilent:t}));if(!a&&!We)return;if(!Mr(a))return;const o=document.querySelector(on),r=Fn?.id;if(a||We){if(!kr())return;const e=Js?Vt.isInvertedMedia:void 0;On&&wa({chatId:R,threadId:F,effectId:void 0}),ea({messageList:O,text:a,entities:s,scheduledAt:n,isSilent:t,shouldUpdateStickerSetOrder:sn,isInvertedMedia:e,effectId:r,webPageMediaSize:Vt.webPageMediaSize,webPageUrl:Js?Pn.url:void 0,isForwarding:We})}ja.current=(0,I.Fm)(),ta({chatId:R,threadId:F,isLocalOnly:!0,shouldKeepReply:We}),h.pz&&o&&o===document.activeElement&&K(o),(0,i.YS)(()=>{ir()})}),Fr=(0,P.A)(async(e=!1,t)=>{if(!O&&!D)return;e=e||Vn;let n=As;if(bo){const e=await vo(),t=No?r.dxe:void 0;if(e){const{blob:a,duration:s,waveform:o}=e;n=[await(0,$.A)("wonderful-voice-message.ogg",a,{voice:{duration:s,waveform:o},ttlSeconds:t})]}}const{text:a}=(0,C.Ay)(Ra()),s=k.A.getRoomTranslateLanguage(R);if(s&&a){as(!0);try{const e=await(0,M.px)("translateTextByTencent",{text:[{text:a}],toLanguageCode:s,userId:dt,userName:(0,l.Yg)(mt)});e&&e[0].text&&Fa(e[0].text)}catch(e){console.log(e)}as(!1),(0,V.J)("input_translate")}Rr(n,e,t),J.s.collectInformation(a)}),Dr=(0,P.A)((e=!1,t)=>{Vs(Fr,e,t)}),Or=(0,P.A)(()=>{fe?oa({chatId:R}):ga({message:Ta("SubscribeToTelegramPremiumForCreateToDo"),action:{action:"openPremiumModal",payload:{initialSection:"todo"}},actionText:Ta("PremiumMore")})}),zr=(0,P.A)(()=>{if("webApp"!==Rt?.type)return;const e=(0,f.vG)(Rt.url);"publicUsernameOrBotLink"===e?.type&&e.appName?(0,y._)(Rt.url):pa({chatId:R,url:Rt.url,threadId:F})}),jr=(0,P.A)(()=>{mo(),ro()}),Ur=(0,P.A)((e,t,n,a)=>{if(e&&"queryId"in e){const{id:n,queryId:a,isSilent:s}=e;return void da({id:n,chatId:R,threadId:F,queryId:a,scheduledAt:t,isSilent:s||Vn})}const{isSilent:s,...o}=e||{};if(e&&0!==Object.keys(o).length)if(void 0!==e.sendCompressed||void 0!==e.sendGrouped){const{sendCompressed:n=!1,sendGrouped:a=!1,isInvertedMedia:o}=e;Br(n,a,s,t,o)}else ea({...e,messageList:n,scheduledAt:t,effectId:a});else Fr(Boolean(s),t)});(0,ee.A)(([e])=>{O&&pt&&pt!==e&&ps(e=>{Ur(pt,e,O)})},[pt,O,Ur,ps]),(0,a.vJ)(()=>{kt&&(Gs(kt),ua(),(0,i.Uz)(()=>{const e=document.getElementById(rn);(0,b.A)(e,!0)}))},[rn,kt,ua,Fa]),(0,a.vJ)(()=>{Pt?.length&&(Zs(Pt),ua())},[Zs,Pt,ua]);const Vr=(0,P.A)((e,t)=>{const n="id"in e.stickerSetInfo&&e.stickerSetInfo.id;e.isFree||fe||be||n===cs?_s(e,t):Ar()}),Jr=(0,P.A)(e=>{Vr(e,r.e0F)}),Hr=(0,P.A)((e,t,n)=>{(O||D)&&(t=t||Vn,c||n?(_a(),ps(n=>{qa(),Vs(Ur,{gif:e,isSilent:t},n,O),(0,i.YS)(()=>{ir(!0)})})):(Vs(ea,{messageList:O,gif:e,isSilent:t}),(0,i.YS)(()=>{ir(!0)})))}),Kr=(0,P.A)((e,t,n,a=!1,s)=>{(O||D)&&(t=t||Vn,e={...e,isPreloadedGlobally:!0},c||n?(_a(),ps(n=>{qa(),Vs(Ur,{sticker:e,isSilent:t},n,O),(0,i.YS)(()=>{ir(a)})})):(Vs(ea,{messageList:O,sticker:e,isSilent:t,shouldUpdateStickerSetOrder:sn&&s}),ta({chatId:R,threadId:F,isLocalOnly:!0}),(0,i.YS)(()=>{ir(a)})))}),$r=(0,P.A)((e,t,n)=>{if(!O&&!D)return;t=t||Vn,c||n?ps(n=>{Vs(Ur,{id:e.id,queryId:e.queryId,isSilent:t},n,O)}):Vs(da,{id:e.id,queryId:e.queryId,threadId:F,chatId:R,isSilent:t});const a=document.querySelector(on);h.pz&&a&&a===document.activeElement&&K(a),ta({chatId:R,isLocalOnly:!0}),(0,i.YS)(()=>{ir()})}),Gr=(0,P.A)(()=>{ta({chatId:R,isLocalOnly:!0}),(0,i.YS)(()=>{ir()})}),_r=(0,P.A)(e=>{O&&(c?(ps(t=>{Vs(Ur,{poll:e},t,O)}),sa()):(Vs(ea,{messageList:O,poll:e,isSilent:Vn}),sa()))}),qr=(0,P.A)(e=>{O&&(c?ps(t=>{Vs(Ur,{todo:e},t,O)}):Vs(ea,{messageList:O,todo:e,isSilent:Vn}))}),Wr=(0,P.A)(e=>{if(c)ps(t=>{Ur({...e,isSilent:!0},t,O)});else if(e&&("sendCompressed"in e||"sendGrouped"in e)){const{sendCompressed:t=!1,sendGrouped:n=!1,isInvertedMedia:a}=e;Br(t,n,!0,void 0,a)}else Fr(!0)}),Qr=(0,P.A)(()=>{const e=document.querySelector(on);if(!E||e!==document.activeElement)return io(),mo(),void po();e?.blur(),setTimeout(()=>{io(),mo(),po()},100)});(0,a.vJ)(()=>{Hs&&Fa("")},[Hs,Fa,As]);const Yr=(0,P.A)(e=>{$s(e,r.e0F)}),Zr=(0,P.A)((e=rn)=>{const t=window.getSelection();if(t.rangeCount){const n=t.getRangeAt(0);if((0,_.L)(n,e))return void document.execCommand("delete",!1)}Fa(function(e){const t=document.createElement("div");t.contentEditable="true",t.style.position="absolute",t.style.left="-10000px",t.style.top="-10000px",t.innerHTML=e,t.className="allow-selection",document.body.appendChild(t);let n=t.lastChild;if(n.lastChild)for(;n.lastChild;)n=n.lastChild;const a=n.textContent.length,s=document.createRange(),o=window.getSelection();s.setStart(n,a),s.setEnd(n,a),o.removeAllRanges(),o.addRange(s),document.execCommand("delete",!1);const r=t.innerHTML;return document.body.removeChild(t),r}(Ra()))}),Xr=(0,P.A)(()=>{Zr(r.e0F)}),ei=(0,P.A)(()=>{la({chatId:R,threadId:F,type:"scheduled",noForumTopicPanel:!0})}),ti=(0,P.A)(()=>{fa({forUserId:R})}),ni=(0,P.A)(()=>{Ma({price:{currency:r.OUy,amount:0,nanos:0}})}),ai=(0,P.A)(()=>{const e=!Vn;Ia({chatId:R,isEnabled:e}),ga({localId:"silentPosting",icon:e?"mute":"unmute",message:Ta(`ComposerSilentPosting${e?"Enabled":"Disabled"}Tootlip`)})});(0,a.vJ)(()=>{Ce&&E&&mo()},[Ce,mo,E]),(0,a.vJ)(()=>{p&&(Ne?Ao():setTimeout(()=>{yo()},200))},[Ne,yo,Ao,p]);const si=(0,X.A)(()=>Boolean(Ra()),[Ra]),oi=Ee&&"webApp"===Rt?.type&&!B&&"thread"===j,ri=oi&&!si&&!bo,[ii,li]=(0,a.Kr)(()=>Ht?.nextSendDate?["SlowModeWait",Ht.nextSendDate]:In?.activeUntil&&Ha?["StealthModeActiveHint",In.activeUntil]:[],[Ha,Ht?.nextSendDate,In?.activeUntil]),ci=no||lo||Bo||uo||Ho||_o||oo||Xa||Vo||ar||zo||ri||vr||Boolean(bo)||As.length>0||Qa,di=ci&&!Ie&&Ha&&!Xa&&!lo,mi=(0,a.Kr)(()=>bo&&Va<=600?"":Hs?Ta(Ha?"ComposerStoryPlaceholderLocked":"ComposerPlaceholderNoText"):st||ot||(Rn?Ta("ComposerPlaceholderPaidMessage",{amount:(0,x.U2)(Ta,Rn,{asFont:!0,className:"placeholder-star-icon"})},{withNodes:!0}):Qe&&Ye?Ta("ComposerPlaceholderCaption"):he?.adminRights?.anonymous?Ta("ComposerPlaceholderAnonymous"):he?.isForum&&he?.isForumAsMessages&&F===o.l3?Ae?Ta("ComposerPlaceholderTopic",{topic:Ae.title}):Ta("ComposerPlaceholderTopicGeneral"):Ta(xe?Vn?"ComposerPlaceholderBroadcastSilent":"ComposerPlaceholderBroadcast":"ComposerPlaceholder")),[bo,st,he,ot,xe,Hs,Ha,Vn,Ta,Ae,Qe,F,Va,Rn,Ye]);(0,a.vJ)(()=>{ci?Yn?.():Zn?.()},[ci,Zn,Yn]);const{shouldRender:ui,transitionClassNames:pi}=(0,ie.A)(di),hi=!(yr!==En.Record||ws&&ve&&Ss),gi=(0,P.A)(()=>{switch(yr){case En.Forward:Xn?.();break;case En.Send:Dr();break;case En.Record:hi?ve?Ss||Aa({chatId:R,messageListType:j}):ga({message:ka("VoiceMessagesRestrictedByPrivacy",he?.title)}):(Io(!1),fo());break;case En.Edit:lr();break;case En.Schedule:if(bo&&Eo(),!O)return;ps(e=>{Ur({},e,O,Fn?.id)})}}),Ai=new Date;Ai.setSeconds(0),Ai.setMilliseconds(0);const yi=new Date;yi.setFullYear(yi.getFullYear()+1);let fi="SendMessage";switch(yr){case En.Forward:fi="Forward";break;case En.Edit:fi="Save edited message";break;case En.Record:fi=ws?"AccDescrVoiceMessage":"Conversation.DefaultRestrictedMedia"}const vi=(0,g.A)("Composer",!Ne&&"shown",go&&"hover-disabled",Da&&"mounted",cn),Ei=(0,P.A)(e=>{let t,n;if("emoji"===e.type&&(t=e.emoticon),"custom"===e.type){const a=(0,s.mS)().customEmojis.byId[e.documentId];if(!a)return;if(!a.isFree&&!fe&&!be)return void Ar();const o=(0,C.Ay)((0,G.hB)(a));t=o.text,n=o.entities}Vs(ea,{text:t,entities:n,isReaction:!0}),va()}),bi=(0,P.A)(e=>{Ca({chatId:R,threadId:F,reaction:e}),va()}),xi=(0,P.A)(e=>{ya({peerId:R,storyId:D,position:e,sendAsMessage:!0})}),wi=(0,P.A)(()=>{const e=Nn?void 0:r.tNZ;Ea({peerId:R,storyId:D,containerId:(0,l.$_)(R,D),reaction:e})}),Ci=(0,P.A)(()=>{ps(e=>{Ur({},e,O)})}),Ni=(0,P.A)(()=>{Vs(Wr)}),Ii=(0,P.A)(()=>{Vs(Ur,{},r.NkL,O,Fn?.id)}),Si=(0,P.A)((e,t,n)=>{ps(a=>{Vs(Ur,{sendCompressed:e,sendGrouped:t,isInvertedMedia:n},a,O)})}),Mi=(0,P.A)((e,t,n)=>{Vs(Wr,{sendCompressed:e,sendGrouped:t,isInvertedMedia:n})}),ki=(0,P.A)(()=>{wa({chatId:R,threadId:F,effectId:void 0})}),Ti=(0,P.A)(()=>{Na({})}),Pi=(0,a.Kr)(()=>{switch(yr){case En.Edit:return lr;case En.Schedule:return Ci;default:return Dr}},[yr,lr,Dr]),Li=Ee&&"commands"===Rt?.type&&!B&&!1!==Ct&&!bo,Bi=On&&Fn?.emoticon,Ri=Boolean(Rn&&yr===En.Send),Fi=(0,ae.A)(Ri);return a.Ay.createElement("div",{className:vi},Ja&&ws&&p&&a.Ay.createElement(qt,{isOpen:n!==_t.I.None,withQuick:n===_t.I.QuickFile||Ua===_t.I.QuickFile,onHide:Qn,onFileSelect:Zs,editingMessage:B}),ui&&!Bs&&a.Ay.createElement(pn.A,{topReactions:bn,allAvailableReactions:dn,onToggleReaction:Ei,isPrivate:!0,isReady:p,canBuyPremium:xn,isCurrentUserPremium:fe,isInSavedMessages:be,isInStoryViewer:Ha,canPlayAnimatedEmojis:wn,onShowMore:xi,className:pi}),a.Ay.createElement(xt,{chatId:R,threadId:F,canShowCustomSendMenu:fr,attachments:As,getHtml:Ra,isReady:p,shouldForceCompression:Ws,shouldForceAsFile:Qs,isForCurrentMessageList:ye,isForMessage:Ja,shouldSchedule:ds&&c,canSchedule:ds,forceDarkTheme:Ha,onCaptionUpdate:Xs,onSendSilent:Mi,onSend:Lr,onSendScheduled:Si,onFileAppend:Ys,onClear:eo,onAttachmentsUpdate:to,onCustomEmojiSelect:Jr,onRemoveSymbol:Xr,onEmojiSelect:Yr,editingMessage:B,onSendWhenOnline:Ii,canScheduleUntilOnline:u&&!No,paidMessagesStars:Rn}),a.Ay.createElement(Xt,{isOpen:Xe.isOpen,isQuiz:Xe.isQuiz,shouldBeAnonymous:xe,maxOptionsCount:Wn,onClear:sa,onSend:_r}),a.Ay.createElement(an,{modal:nt,onClear:ra,onSend:qr}),a.Ay.createElement(en,{isOpen:uo,onClose:ho,chatId:R,selectedSendAsId:It,sendAsPeerIds:Ka,isCurrentUserPremium:fe}),a.Ay.createElement(Yt,{isOpen:Ho,filteredUsers:Go,onInsertUserName:$o,onClose:Ko}),a.Ay.createElement(zt,{isOpen:ar,chatId:R,withUsername:Boolean(ls),botCommands:or,quickReplies:rr,getHtml:Ra,self:mt,quickReplyMessages:Mn,onClick:Gr,onClose:sr}),a.Ay.createElement("div",{className:(0,g.A)("composer-wrapper",Ha&&"with-story-tweaks",Bs&&"is-need-premium")},!Bs&&a.Ay.createElement("svg",{className:"svg-appendix",width:"9",height:"20"},a.Ay.createElement("defs",null,a.Ay.createElement("filter",{x:"-50%",y:"-14.7%",width:"200%",height:"141.2%",filterUnits:"objectBoundingBox",id:"composerAppendix"},a.Ay.createElement("feOffset",{dy:"1",in:"SourceAlpha",result:"shadowOffsetOuter1"}),a.Ay.createElement("feGaussianBlur",{stdDeviation:"1",in:"shadowOffsetOuter1",result:"shadowBlurOuter1"}),a.Ay.createElement("feColorMatrix",{values:"0 0 0 0 0.0621962482 0 0 0 0 0.138574144 0 0 0 0 0.185037364 0 0 0 0.15 0",in:"shadowBlurOuter1"}))),a.Ay.createElement("g",{fill:"none","fill-rule":"evenodd"},a.Ay.createElement("path",{d:"M6 17H0V0c.193 2.84.876 5.767 2.05 8.782.904 2.325 2.446 4.485 4.625 6.48A1 1 0 016 17z",fill:"#000",filter:"url(#composerAppendix)"}),a.Ay.createElement("path",{d:"M6 17H0V0c.193 2.84.876 5.767 2.05 8.782.904 2.325 2.446 4.485 4.625 6.48A1 1 0 016 17z",fill:"#FFF",className:"corner"}))),Ja&&a.Ay.createElement(a.Ay.Fragment,null,a.Ay.createElement(Qt,{isOpen:_o,botId:qo,isGallery:Wo,inlineBotResults:Zo,switchPm:Qo,switchWebview:Yo,loadMore:tr,isSavedMessages:be,canSendGifs:xs,isCurrentUserPremium:fe,onSelectResult:$r,onClose:Xo}),a.Ay.createElement(Kt,{onClear:Sr,shouldForceShowEditing:Boolean(dr&&B),chatId:R,threadId:F,messageListType:j}),a.Ay.createElement(mn,{chatId:R,threadId:F,isDisabled:!Ns||fs||!si,isEditing:Boolean(B)})),a.Ay.createElement("div",{className:(0,g.A)("message-input-wrapper",(0,q.y)(mt))},Ja&&a.Ay.createElement(a.Ay.Fragment,null,oi&&a.Ay.createElement(Ot,{isOpen:ri,text:Rt.text,isDisabled:Boolean(bo),onClick:zr}),Li&&a.Ay.createElement(Tt.A,{className:(0,g.A)("bot-commands","composer-action-button"),round:!0,disabled:void 0===Ct,color:"translucent",onActivate:jr,ariaLabel:"Open bot command keyboard"},a.Ay.createElement(St.A,{name:"bot-commands-filled"})),$a&&Nt&&a.Ay.createElement(Ft.A,{round:!0,color:"translucent",onClick:uo?ho:Qr,ariaLabel:ka("SendMessageAsTitle"),className:(0,g.A)("send-as-button","composer-action-button",gs.current&&"appear-animation")},a.Ay.createElement(yn.A,{peer:Nt,size:"tiny"}))),(!Hs||xs||bs)&&!Bs&&!Gn&&a.Ay.createElement(nn.A,{chatId:R,threadId:F,isMobile:E,isReady:p,isSymbolMenuOpen:lo,openSymbolMenu:co,closeSymbolMenu:mo,canSendStickers:bs,canSendGifs:xs,isMessageComposer:Ja,onGifSelect:Hr,onStickerSelect:Kr,onCustomEmojiSelect:Vr,onRemoveSymbol:Zr,onEmojiSelect:$s,closeBotCommandMenu:io,closeSendAsMenu:ho,isSymbolMenuForced:Ga,canSendPlainText:!Hs,inputCssSelector:on,idPrefix:e,forceDarkTheme:Ha}),a.Ay.createElement(Zt.A,{ref:Pa,id:ln,editableInputId:rn,customEmojiPrefix:e,isStoryInput:Ha,chatId:R,canSendPlainText:!Hs,threadId:F,isReady:p,isActive:!fs,getHtml:Ra,placeholder:mi,timedPlaceholderDate:li,timedPlaceholderLangKey:ii,forcedPlaceholder:er,canAutoFocus:p&&ye&&!fs&&Ja,noFocusInterception:fs,shouldSuppressFocus:E&&lo,shouldSuppressTextFormatter:Bo||Ho||_o,onUpdate:Fa,onSend:Pi,onSuppressedFocus:mo,onFocus:Ya,onBlur:Za,isNeedPremium:Bs,messageListType:j}),Ja&&a.Ay.createElement(a.Ay.Fragment,null,(wt&&Boolean(qo)||ns)&&a.Ay.createElement(hn.A,{color:"gray",className:"flex-shrink-0"}),a.Ay.createElement(gn.Ay,{className:"composer-action-buttons-container",slideClassName:"composer-action-buttons",activeKey:Number(si),direction:"inverse",name:"slideFadeAndroid"},!si&&a.Ay.createElement(a.Ay.Fragment,null,xe&&a.Ay.createElement(gn.Ay,{className:"composer-action-button",name:"reveal",activeKey:Number(Vn)},a.Ay.createElement(Ft.A,{round:!0,faded:!0,className:"composer-action-button",color:"translucent",onClick:ai,ariaLabel:Ta(Vn?"AriaComposerSilentPostingDisable":"AriaComposerSilentPostingEnable")},a.Ay.createElement(St.A,{name:Vn?"mute":"unmute"}))),rt&&a.Ay.createElement(Ft.A,{round:!0,faded:!0,className:"composer-action-button scheduled-button",color:"translucent",onClick:ei,ariaLabel:Ta("AriaComposerOpenScheduled")},a.Ay.createElement(St.A,{name:"schedule"})),hr&&a.Ay.createElement(Ft.A,{round:!0,faded:!0,className:"composer-action-button",color:"translucent",onClick:ti},a.Ay.createElement(St.A,{name:"gift"})),gr&&a.Ay.createElement(Ft.A,{round:!0,faded:!0,className:"composer-action-button",color:"translucent",onClick:ni},a.Ay.createElement(St.A,{name:"cash-circle"})),Boolean(at)&&!bo&&!B&&a.Ay.createElement(Tt.A,{className:(0,g.A)("composer-action-button",no&&"activated"),round:!0,color:"translucent",onActivate:ao,ariaLabel:Ta("AriaComposerBotKeyboard")},a.Ay.createElement(St.A,{name:"bot-command"}))))),bo&&Boolean(xo)&&a.Ay.createElement("span",{className:"recording-state"},(0,A.JW)(xo-Co.current)),a.Ay.createElement(ft,{getHtml:Ra,setHtml:Fa}),a.Ay.createElement(U,{chatId:R}),!Bs&&a.Ay.createElement(Lt,{chatId:R,threadId:F,editingMessage:B,canEditMedia:ss,isButtonVisible:!bo,canAttachMedia:ws,canAttachPolls:Cs,canAttachToDoLists:Is,canSendPhotos:Ps,canSendVideos:Ts,canSendDocuments:Ls,canSendAudios:ks,onFileSelect:Zs,onPollCreate:aa,onTodoListCreate:Or,isScheduled:c,attachBots:Ja?jt:void 0,peerType:Ut,shouldCollectDebugLogs:Cn,theme:Jt,onMenuOpen:es,onMenuClose:ts,messageListType:j,paidMessagesStars:Rn}),Ja&&Boolean(at)&&a.Ay.createElement(Dt,{messageId:at,isOpen:no,onClose:so}),Ja&&Ct&&a.Ay.createElement(Bt,{isOpen:oo,botCommands:Ct,onClose:io}),a.Ay.createElement($t.A,{key:`custom-emoji-tooltip-${rn}`,chatId:R,isOpen:zo,onCustomEmojiSelect:Uo,addRecentCustomEmoji:ha,onClose:jo}),a.Ay.createElement(tn,{key:`sticker-tooltip-${rn}`,chatId:R,threadId:F,isOpen:Vo,onStickerSelect:Kr,onClose:Jo}),a.Ay.createElement(Wt.A,{key:`emoji-tooltip-${rn}`,isOpen:Bo,emojis:Fo,customEmojis:Do,addRecentEmoji:ca,addRecentCustomEmoji:ha,onEmojiSelect:Oo,onCustomEmojiSelect:Oo,onClose:Ro}))),Sn&&bo&&a.Ay.createElement(Ft.A,{className:(0,g.A)("view-once",No&&"active"),round:!0,color:"secondary",ariaLabel:ka("Chat.PlayOnceVoiceMessageTooltip"),onClick:So},a.Ay.createElement(St.A,{name:"view-once"}),a.Ay.createElement(St.A,{name:"one-filled"})),bo&&a.Ay.createElement(Ft.A,{round:!0,color:"danger",className:"cancel",onClick:vo,ariaLabel:"Cancel voice recording"},a.Ay.createElement(St.A,{name:"delete"})),Ha&&!bo&&a.Ay.createElement(Ft.A,{round:!0,className:"story-reaction-button",color:"secondary",onClick:wi,onContextMenu:Cr,onMouseDown:Nr,ariaLabel:ka("AccDescrLike"),ref:Ba},Nn&&a.Ay.createElement(vn.A,{key:(0,l.Jj)(Nn),containerId:(0,l.$_)(R,D),reaction:Nn,withEffectOnly:ms}),(!Nn||ms)&&a.Ay.createElement(St.A,{name:"heart",className:(0,g.A)(ms&&"story-reaction-heart")})),a.Ay.createElement(Ft.A,{ref:wo,round:!0,color:"secondary",className:(0,g.A)(yr,"main-button",!p&&"not-ready",bo&&"recording"),disabled:hi,allowDisabledClick:!0,noFastClick:!0,ariaLabel:ka(fi),onClick:gi,onContextMenu:yr===En.Send&&fr?Er:void 0},a.Ay.createElement(St.A,{name:"send"}),a.Ay.createElement(St.A,{name:"microphone-alt"}),Xn&&a.Ay.createElement(St.A,{name:"forward"}),Ja&&a.Ay.createElement(St.A,{name:"schedule"}),Ja&&a.Ay.createElement(St.A,{name:"check"}),a.Ay.createElement(Ft.A,{className:(0,g.A)("paidStarsBadge",Ri&&"visible",Fi&&!Ri&&"hiding",!Fi&&!Ri&&"hidden"),nonInteractive:!0,size:"tiny",color:"stars",pill:!0,fluid:!0},a.Ay.createElement("div",{className:"paidStarsBadgeText"},a.Ay.createElement(St.A,{name:"star",className:(0,g.A)("star-amount-icon",cn)}),a.Ay.createElement(An.A,{ref:La,text:Ta.number(Ds)})))),Bi&&a.Ay.createElement("span",{className:"effect-icon",onClick:ki},(0,T.A)(Bi)),Fn&&zn&&a.Ay.createElement(un.A,{shouldPlay:jn,effect:Fn,onStop:Ti}),fr&&a.Ay.createElement(Gt.A,{isOpen:vr,canSchedule:ds&&Ja&&!No,canScheduleUntilOnline:u&&!No,onSendSilent:be?void 0:Ni,onSendSchedule:c?void 0:Ci,onSendWhenOnline:Ii,onRemoveEffect:ki,onClose:br,onCloseAnimationEnd:xr,isSavedMessages:be,chatId:R,withEffects:On,hasCurrentEffect:Boolean(Fn),effectReactions:Dn,allAvailableReactions:dn,onToggleReaction:bi,isCurrentUserPremium:fe,isInSavedMessages:be,isInStoryViewer:Ha,canPlayAnimatedEmojis:wn}),hs,a.Ay.createElement(fn.A,{isOpen:Jn,onClose:Os,userName:he?(0,d.F9)(Ta,he):void 0,messagePriceInStars:Rn||0,messagesCount:Fs,shouldAutoApprove:js,setAutoApprove:Us,confirmHandler:zs}))}))},61097:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var a=n(90709),s=n(84051),o=n(66644),r=n(67054),i=n(87679),l=n(41074),c=n(17712);const d=.1;let m=-1;function u(e,t){return function(e,t=!1){const n=(0,s.li)(),a=(0,s.Kr)(()=>(0,r.A)(l.bP,++m),[]),u=(0,s.li)(),p=(0,c.A)(async(e,t)=>{const n=await(0,i.NN)(t);n&&(0,o.RK)(()=>{e.width=n.width,e.height=n.height,u.current=e.transferControlToOffscreen();const s=Math.ceil(Math.min(n.width,n.height)*d);(0,l.M1)({name:"offscreen-canvas:blurThumb",args:[u.current,t,s],transferables:[u.current]},a)})});return(0,s.Nf)(()=>{if(!e||t||u.current)return;const a=n.current;a&&p(a,e)},[p,t,e]),n}(e?"string"==typeof e?e:(0,a.VD)(e):void 0,t)}},63744:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var a=n(84051),s=n(13439),o=n(60919),r=n(71331),i=n(87357),l=n(14),c=n(59030),d=n(48885),m=n(26875),u=n(64493);const p=(0,a.ph)((0,s.EK)((e,{chatId:t})=>{const n=(0,o.hds)(e,t),a=(0,r.mD)(e,t);return{groupCall:a,isActive:((0,o.nTw)(e).isMasterTab?e.groupCalls.activeGroupCallId:void 0)!==a?.id&&Boolean(a?a.participantsCount>0&&a.isLoaded:n&&n.isCallNotEmpty&&n.isCallActive)}})(({chatId:e,isActive:t,className:n,groupCall:o,onPaneStateChange:r})=>{const{requestMasterAndJoinGroupCall:p}=(0,s.ko)(),h=(0,c.A)(),g=(0,a.hb)(()=>{p({chatId:e})},[p,e]),A=o?.participants,y=(0,a.Kr)(()=>{if(!A)return[];const e=(0,s.mS)().users.byId,t=(0,s.mS)().chats.byId;return Object.values(A).slice(0,3).map(({id:n})=>e[n]||t[n]).filter(Boolean)},[A]),f=(0,l.A)(o?.participantsCount,!0),v=(0,l.A)(y,!0),E=Boolean(o&&t),{ref:b,shouldRender:x}=(0,d.A)({isOpen:E,onStateChange:r});if(x)return a.Ay.createElement("div",{ref:b,className:(0,i.A)("GroupCallTopPane",n),onClick:g},a.Ay.createElement("div",{className:"info"},a.Ay.createElement("span",{className:"title"},h("VoipGroupVoiceChat")),a.Ay.createElement("span",{className:"participants"},h("Participants",f??0,"i"))),Boolean(v?.length)&&a.Ay.createElement(m.A,{size:"small",peers:v,className:"avatars"}),a.Ay.createElement(u.A,{round:!0,className:"join"},h("VoipChatJoin")))}))},63947:(e,t,n)=>{"use strict";n.d(t,{A:()=>E});var a=n(84051),s=n(13439),o=n(90709),r=n(60919),i=n(87357),l=n(17663),c=n(83868),d=n(54464),m=n(10722),u=n(17712),p=n(62587),h=n(59030),g=n(54746),A=n(71429),y=n(24433),f=n(59816);const v="NOCaj4mx",E=(0,a.ph)((0,s.EK)((e,{story:t})=>{const n=(0,r.hds)(e,t.peerId),a=n?.isProtected,{maxPinnedStoriesCount:s}=e.appConfig||{},o="isOut"in t&&t.isOut,i=(0,r.gVx)(e,t.peerId),l=i?.some(e=>e.id===t.id);return{isProtected:a,isPinned:l,canPin:o&&(!s||(i?.length||0)<s)}})(function({story:e,isProtected:t,isArchive:n,isPinned:r,canPin:E}){const{openStoryViewer:b,loadPeerSkippedStories:x,toggleStoryInProfile:w,toggleStoryPinnedToTop:C,showNotification:N}=(0,s.ko)(),I=(0,h.A)(),S=(0,a.li)(),M=(0,u.A)(()=>S.current),k=(0,u.A)(()=>document.body),T=(0,u.A)(()=>document.querySelector("#portals .story-context-menu .bubble")),P=(0,u.A)(()=>({withPortal:!0,isDense:!0})),L=e&&e.peerId,B=e&&"content"in e,R=B&&e.isOut,F=e&&"isDeleted"in e,D=B?e.content.video:void 0,O=D&&(0,l.QO)(D.duration),z=B?(0,o.EN)(e):void 0,j=(0,p.A)(z)||D?.thumbnail?.dataUri;(0,a.vJ)(()=>{!e||B||F||x({peerId:e.peerId})},[F,B,e]);const{isContextMenuOpen:U,contextMenuAnchor:V,handleBeforeContextMenu:J,handleContextMenu:H,handleContextMenuClose:K,handleContextMenuHide:$}=(0,m.A)(S,!R),G=(0,a.hb)(()=>{b({peerId:e.peerId,storyId:e.id,isSinglePeer:!0,isPrivate:!0,isArchive:n})},[n,e.id,e.peerId]),_=(0,u.A)(e=>{(0,d.u)(e),J(e)}),q=(0,u.A)(t=>{(0,c.A)(t),w({peerId:L,storyId:e.id,isInProfile:!0}),N({message:I("Story.ToastSavedToProfileText")}),K()}),W=(0,u.A)(t=>{(0,c.A)(t),w({peerId:L,storyId:e.id,isInProfile:!1}),N({message:I("Story.ToastRemovedFromProfileText")}),K()}),Q=(0,u.A)(()=>{C({peerId:L,storyId:e.id}),K()});return a.Ay.createElement("div",{ref:S,className:(0,i.A)("kxMIqtqr","scroll-item"),onMouseDown:_,onClick:G,onContextMenu:H},F&&a.Ay.createElement("span",null,a.Ay.createElement(g.A,{className:"cq7jTRkg",name:"story-expired"}),I("ExpiredStory")),r&&a.Ay.createElement(g.A,{className:(0,i.A)(v,"GTWFQyJx"),name:"pin-badge"}),B&&Boolean(e.views?.viewsCount)&&a.Ay.createElement("span",{className:(0,i.A)(v,"g09Rb4Ps")},a.Ay.createElement(g.A,{name:"eye"}),e.views.viewsCount),O&&a.Ay.createElement("span",{className:(0,i.A)(v,"lM_2MMyQ")},O),a.Ay.createElement("div",{className:"D6Yajvjx"},j&&a.Ay.createElement("img",{src:j,alt:"",className:"cV_QL3N5",draggable:!1}),B&&a.Ay.createElement(f.A,{story:e}),t&&a.Ay.createElement("span",{className:"protector"})),void 0!==V&&a.Ay.createElement(A.A,{isOpen:U,anchor:V,getTriggerElement:M,getRootElement:k,getMenuElement:T,getLayout:P,className:(0,i.A)("UAfI9izT","story-context-menu"),autoClose:!0,onClose:K,onCloseAnimationEnd:$,withPortal:!0},n&&a.Ay.createElement(y.A,{icon:"archive",onClick:q},I("StoryList.SaveToProfile")),!n&&a.Ay.createElement(y.A,{icon:"archive",onClick:W},I("Story.Context.RemoveFromProfile")),!n&&!r&&E&&a.Ay.createElement(y.A,{icon:"pin",onClick:Q},I("StoryList.ItemAction.Pin")),!n&&r&&a.Ay.createElement(y.A,{icon:"unpin",onClick:Q},I("StoryList.ItemAction.Unpin"))))}))},63988:(e,t,n)=>{"use strict";n.d(t,{D7:()=>c,aG:()=>i,gs:()=>r,tF:()=>l});var a=n(16581),s=n(83414),o=n(672);function r(e,t,n,a=!1){return(0,o.A)(t=>{t(e())},t,n,a)}function i(e,t,n=!1){const a=r(()=>e(),[e],t,n);return(0,s.A)(a,[a,e],!0)}function l(e,t,n,s=!1,o=!1){return(0,a.A)(t=>{t(e())},t,n,s,o)}function c(e,t,n=!1,a=!1){const o=l(()=>e(),[e],t,n,a);return(0,s.A)(o,[o,e],!0)}},64154:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var a=n(84051),s=n(13439),o=n(37836);const r=new Map;function i(e,t,n,o){const i=o&&n?e?.byLangCode[o]?.[n]:void 0,{isPending:c,text:d}=i||{};return(0,a.vJ)(()=>{t&&n&&!d&&void 0===c&&o&&function(e,t,n){const a=r.get(n)||new Map,o=a.get(e)||[];o.includes(t)||(o.push(t),a.set(e,o),r.set(n,a),(0,s.ko)().markMessagesTranslationPending({chatId:e,messageIds:o,toLanguageCode:n})),l()}(t,n,o)},[t,d,c,n,o]),t&&n?{isPending:c,translatedText:d}:{isPending:!1,translatedText:void 0}}const l=(0,o.nF)(function(){const{translateMessagesByTencent:e}=(0,s.ko)();let t=!1;r.forEach((n,a)=>{n.forEach((n,s)=>{const o=n.slice(0,20);o.length<n.length&&(t=!0),e({chatId:s,messageIds:o,toLanguageCode:a}),function(e,t,n){const a=r.get(n);if(!a?.size)return void r.delete(n);const s=a.get(e);if(!s?.length)return void a.delete(e);const o=s.filter(e=>!t.includes(e));if(!o?.length)return a.delete(e),void(a.size||r.delete(n));a.set(e,o)}(s,o,a)})}),t&&l()},500)},65240:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>U,lz:()=>z});var a=n(84051),s=n(13439),o=n(23174),r=n(89925),i=n(90709),l=n(60919),c=n(56494),d=n(53827),m=n(87357),u=n(50442),p=n(17663),h=n(58443),g=n(91525),A=n(4961);const y=30,f=2,v=4,E=1,b=23;var x=n(43874),w=n(88792),C=n(71533),N=n(17712),I=n(62587),S=n(69419),M=n(59030),k=n(50680),T=n(64493),P=n(96530),L=n(35913),B=n(4438),R=n(54746);const F=window.matchMedia("(max-width: 375px)"),D=window.matchMedia("(max-width: 410px)"),O=10;function z(e,t,n=0,s=!1,o=!1,r=!1,i=!1){const l=(0,a.li)(),{data:c,peak:d}=(0,a.Kr)(()=>{if(!t)return;const{waveform:e,duration:n}=t;if(!e)return{data:new Array(Math.min(n,y)).fill(0),peak:0};const{MIN_SPIKES:a,MAX_SPIKES:s}=function(e,t){return{MIN_SPIKES:e?F.matches?16:20:25,MAX_SPIKES:e?F.matches?35:t&&D.matches?40:45:75}}(r,o),i=Math.min(n/O,1),l=Math.round(a+(s-a)*i);return function(e,t){let n=0;const a=new Array(t),s=e.length/t,o=e[0],r=e[e.length-1];for(let i=0;i<t;i++){const t=Math.floor(i*s),l=((e[t-1]??o)+(e[t]??o)+(e[t+1]??r))/3;a[i]=l,n<l&&(n=l)}return{data:a,peak:n}}(function(e){const t=8*e.length,n=Math.floor(t/5);if(!n)return[];const a=Array(n),s=e;for(let e=0,t=n-1;e!==t;++e){const t=Math.floor(5*e/8),n=Math.floor(5*e%8),o=s[t]+(s[t+1]<<8);a[e]=o>>n&31}const o=Math.floor(5*(n-1)/8),r=Math.floor(5*(n-1)%8),i=s[o]+(s[o+1]<<8);return a[n-1]=i>>r&31,a}(new Uint8Array(e)),l)},[r,t,o])||{};return(0,a.Nf)(()=>{const t=l.current;t&&c&&void 0!==d&&function(e,t,n,{peak:a,fillStyle:s,progressFillStyle:o}){const r=t.length*v,i=b;e.width=2*r,e.height=2*i,e.style.width=`${r}px`,e.style.height=`${i}px`;const l=e.getContext("2d");l.scale(2,2),t.forEach((e,r)=>{l.globalAlpha=r/t.length>=n?.5:1,l.fillStyle=n>r/t.length?o:s;const c=Math.max(2,b*(e/Math.max(1,a)));!function(e,t,n,a,s,o){a<2*o&&(o=a/2),s<2*o&&(o=s/2),e.beginPath(),e.moveTo(t+o,n),e.arcTo(t+a,n,t+a,n-s,o),e.arcTo(t+a,n-s,t,n-s,o),e.arcTo(t,n-s,t,n,o),e.arcTo(t,n,t+a,n,o),e.closePath()}(l,r*v,(i+c)/2,f,c,E),l.fill()})}(t,c,i?1-n:n,{peak:d,fillStyle:s?"dark"===e?"#B7ABED":"#AEDFA4":"dark"===e?"#494A78":"#ADD3F7",progressFillStyle:s?"dark"===e?"#FFFFFF":"#4FAE4E":"dark"===e?"#8774E1":"#3390EC"})},[s,d,n,c,e,i]),l}function j(e,t,n){return a.Ay.createElement("div",{className:"seekline",ref:n},t.map(({start:e,end:t})=>a.Ay.createElement("div",{className:"seekline-buffered-progress",style:`left: ${100*e}%; right: ${100-100*t}%`})),a.Ay.createElement("span",{className:"seekline-play-progress"},a.Ay.createElement("i",{className:"seekline-play-progress-inner",style:`transform: translateX(${100*e}%)`})),a.Ay.createElement("span",{className:"seekline-thumb"},a.Ay.createElement("i",{className:"seekline-thumb-inner",style:`transform: translateX(${100*e}%)`})))}const U=(0,a.ph)((0,s.EK)((e,{message:t})=>({webPage:(0,l.Pn$)(e,t),mediaDuration:(0,c.Y9)(e,t)}))(({theme:e,message:t,senderTitle:n,uploadProgress:l,origin:c,date:y,noAvatars:f,className:v,isSelectable:E,isSelected:b,isDownloading:F,isTranscribing:D,isTranscriptionHidden:O,isTranscribed:U,isTranscriptionError:V,canDownload:J,canTranscribe:H,autoPlay:K,webPage:$,mediaDuration:G,onHideTranscription:_,onPlay:q,onPause:W,onReadMedia:Q,onCancelUpload:Y,onDateClick:Z})=>{const{cancelMediaDownload:X,downloadMedia:ee,transcribeAudio:te,openOneTimeMediaModal:ne}=(0,s.ko)(),{content:{audio:ae,voice:se,video:oe},isMediaUnread:re}=t,ie=ae||(0,i.y3)($),le=se||oe||ie,ce=se||oe,de=Boolean(se||oe),me=(0,a.li)(!1),ue=(0,a.li)(),pe=(0,M.A)(),{isRtl:he}=pe,{isMobile:ge}=(0,x.Ay)(),[Ae,ye]=(0,a.J0)(!1),fe=Ae||!0,ve=(0,i.VO)(le,"pictogram"),Ee=(0,I.A)(ve,!1,o.qZ.BlobUrl),be=(0,i.G5)(t),xe=c===r.d9.OneTimeModal,we=de?be?"oneTimeVoice":"voice":"audio",Ce=(0,I.A)((0,i.VO)(le,"inline"),!fe,(0,i.Cz)(le,"inline")),{loadProgress:Ne}=(0,S.A)((0,i.VO)(le,"download"),!F,(0,i.Cz)(le,"download")),Ie=(0,N.A)(()=>{ye(!0),q?.(t.id,t.chatId)}),Se=(0,N.A)(()=>{ye(!1)}),{isBuffered:Me,bufferedRanges:ke,bufferingHandlers:Te,checkBuffering:Pe}=(0,C.A)(),Le=xe,{isPlaying:Be,playProgress:Re,playPause:Fe,setCurrentTime:De,duration:Oe}=(0,w.A)((0,d.dj)(t),G,we,Ce,Te,void 0,Pe,Boolean(Ae||K),Ie,Se,(0,i.Nb)(t)||be,void 0,W,Le,be&&!xe),ze=1-Re,je=(0,i.Ie)(t),Ue=be&&xe,Ve=z(e,ce,!re||je||Ue?Re:1,je,!f,ge,Ue),Je=Be||Re>0&&Re<1;(0,a.vJ)(()=>{ye(Be)},[Be]);const He=Ae&&!Me,{isUploading:Ke,isTransferring:$e,transferProgress:Ge}=(0,i.LK)(l||Ne,He||F,void 0!==l),{shouldRender:_e,transitionClassNames:qe}=(0,k.A)($e),We=_e&&(He||Ke),Qe=(0,N.A)(()=>{if(Ke)Y?.();else{if(be)return ne({message:t}),void Q?.();Be||q?.(t.id,t.chatId),(0,s.ko)().setAudioPlayerOrigin({origin:c}),ye(!Ae),Fe()}});(0,a.vJ)(()=>{Q&&re&&Be&&Q()},[Be,re,Q]);const Ye=(0,N.A)(()=>{F?X({media:le}):ee({media:le,originMessage:t})}),Ze=(0,N.A)(e=>{if(me.current&&ue.current){const{width:t,left:n}=ue.current.getBoundingClientRect(),a=e instanceof MouseEvent?e.clientX:e.targetTouches[0].clientX;e.stopPropagation(),De(Math.max(Math.min(Oe*((a-n)/t),Oe-.1),.001))}}),Xe=(0,N.A)(e=>{e instanceof MouseEvent&&2===e.button||(me.current=!0,Ze(e))}),et=(0,N.A)(()=>{me.current=!1}),tt=(0,N.A)(()=>{Z(t)}),nt=(0,N.A)(()=>{te({chatId:t.chatId,messageId:t.id})});function at(){if(de)return n||"Voice";const{title:e,fileName:t}=ie;return e||t}(0,a.vJ)(()=>{if(ue.current&&Je&&!xe)return(0,u.wJ)(ue.current,{onCapture:Xe,onRelease:et,onClick:et,onDrag:Ze})},[Je,Xe,Ze,et,xe]);const st=(0,m.A)("Audio",v,xe&&"non-interactive",c===r.d9.Inline&&"inline",je&&c===r.d9.Inline&&"own",(c===r.d9.Search||c===r.d9.SharedMedia)&&"bigger",b&&"audio-is-selected"),ot=["toogle-play-wrapper"];We?ot.push("loading"):ot.push(Be?"pause":"play");const rt=(0,m.A)("content",Je&&"with-seekline");function it(){return a.Ay.createElement("div",{className:rt},a.Ay.createElement("div",{className:"content-row"},a.Ay.createElement("p",{className:"title",dir:"auto",title:at()},(0,A.A)(at())),a.Ay.createElement("div",{className:"message-date"},Boolean(y)&&a.Ay.createElement(P.A,{className:"date",onClick:tt},(0,p.be)(pe,1e3*y)))),Je&&a.Ay.createElement("div",{className:"meta search-result",dir:he?"rtl":void 0},a.Ay.createElement("span",{className:"duration with-seekline",dir:"auto"},Re<1&&(0,p.QO)(Oe*Re,Oe)),j(Re,ke,ue)),!Je&&function(){if(de)return a.Ay.createElement("div",{className:"meta",dir:he?"rtl":void 0},(0,p.QO)((se||oe).duration));const{performer:e}=ie;return a.Ay.createElement("div",{className:"meta",dir:he?"rtl":void 0},(0,p.QO)(Oe),a.Ay.createElement("span",{className:"bullet"},"•"),e&&a.Ay.createElement("span",{className:"performer",title:e},(0,A.A)(e)),e&&n&&a.Ay.createElement("span",{className:"bullet"},"•"),n&&a.Ay.createElement("span",{title:n},(0,A.A)(n)))}())}return a.Ay.createElement("div",{className:st,dir:pe.isRtl?"rtl":"ltr"},E&&a.Ay.createElement("div",{className:"message-select-control no-selection"},b&&a.Ay.createElement(R.A,{name:"select"})),a.Ay.createElement("div",{className:(0,m.A)(...ot)},a.Ay.createElement(T.A,{round:!0,ripple:!ge,size:"smaller",className:"toggle-play",color:Ee?"translucent-white":"primary",ariaLabel:Be?"Pause audio":"Play audio",onClick:Qe,isRtl:pe.isRtl,backgroundImage:Ee,nonInteractive:xe},!xe&&a.Ay.createElement(R.A,{name:"play"}),!xe&&a.Ay.createElement(R.A,{name:"pause"}),xe&&a.Ay.createElement(B.A,{className:"flame",tgsUrl:h.w.Flame,nonInteractive:!0,noLoop:!1,size:40})),be&&!xe&&a.Ay.createElement(R.A,{name:"view-once"})),_e&&a.Ay.createElement("div",{className:(0,m.A)("media-loading",qe,We&&"interactive")},a.Ay.createElement(L.A,{progress:Ge,transparent:!0,withColor:!0,size:"m",onClick:We?Qe:void 0,noCross:!We})),xe&&!_e&&a.Ay.createElement("div",{className:(0,m.A)("media-loading")},a.Ay.createElement(L.A,{progress:Re,transparent:!0,size:"m",noCross:!0,rotationOffset:3/4})),ie&&J&&!Ke&&a.Ay.createElement(T.A,{round:!0,size:"tiny",className:"download-button",ariaLabel:F?"Cancel download":"Download",onClick:Ye},a.Ay.createElement(R.A,{name:F?"close":"arrow-down"})),c===r.d9.Search&&it(),c!==r.d9.Search&&ie&&function(e,t,n,s,o,r,i,l,c,d,m){const{title:u,performer:h,fileName:y}=t,f=s||o>0&&o<1,{isRtl:v}=e;return a.Ay.createElement("div",{className:"content"},a.Ay.createElement("p",{className:"title",dir:"auto",title:u},(0,A.A)(u||y)),f&&a.Ay.createElement("div",{className:"meta",dir:v?"rtl":void 0},a.Ay.createElement("span",{className:"duration with-seekline",dir:"auto"},(0,p.QO)(n*o,n)),j(o,r,i)),!f&&l&&a.Ay.createElement("div",{className:"meta",dir:v?"rtl":void 0},d?`${(0,g.zV)(t.size*d)} / `:void 0,(0,g.zV)(t.size)),!f&&!l&&a.Ay.createElement("div",{className:"meta",dir:v?"rtl":void 0},a.Ay.createElement("span",{className:"duration",dir:"auto"},(0,p.QO)(n)),h&&a.Ay.createElement(a.Ay.Fragment,null,a.Ay.createElement("span",{className:"bullet"},"•"),a.Ay.createElement("span",{className:"performer",dir:"auto",title:h},(0,A.A)(h))),Boolean(c)&&a.Ay.createElement(a.Ay.Fragment,null,a.Ay.createElement("span",{className:"bullet"},"•"),a.Ay.createElement(P.A,{className:"date",onClick:m},(0,p.fS)(e,1e3*c,!0)))))}(pe,ie,Oe,Be,Re,ke,ue,F||Ke,y,Ge,Z?tt:void 0),c===r.d9.SharedMedia&&ce&&it(),(c===r.d9.Inline||xe||U)&&ce&&function(e,t,n,s,o,i,l,c,d,u,h,g){return a.Ay.createElement("div",{className:"content"},a.Ay.createElement("div",{className:"waveform-wrapper"},a.Ay.createElement("div",{className:"waveform",draggable:!1,ref:t},a.Ay.createElement("canvas",{ref:n})),u&&a.Ay.createElement(T.A,{onClick:()=>{(c||d)&&h?h(!l):i||u()}},a.Ay.createElement(R.A,{name:c||d?"down":"transcribe",className:(0,m.A)("transcribe-icon",(c||d)&&!l&&"transcribe-shown")}),i&&a.Ay.createElement("svg",{viewBox:"0 0 32 24",className:"loading-svg"},a.Ay.createElement("rect",{className:"loading-rect",fill:"transparent",width:"32",height:"24","stroke-width":"3","stroke-linejoin":"round",rx:"6",ry:"6",stroke:"white","stroke-dashoffset":"1","stroke-dasharray":"32,68"})))),a.Ay.createElement("p",{className:(0,m.A)("voice-duration",g!==r.d9.OneTimeModal&&o&&"unread"),dir:"auto"},0===s||1===s?(0,p.QO)(e.duration):(0,p.QO)(e.duration*s)))}(ce,ue,Ve,be?ze:Re,re,D,O,U,V,H?nt:void 0,_,c))}))},65741:(e,t,n)=>{"use strict";e.exports=n.p+"GiftRedRound.a86b78b0b99e07f69a70.svg"},66991:(e,t,n)=>{"use strict";n.d(t,{Y:()=>m,c:()=>u});var a=n(84051),s=n(31481),o=n(66644),r=n(19822),i=n(39761),l=n(96454),c=n(95704);const d=100;function m(e,t,n){return(0,a.vJ)(()=>{if(!t||!e.current)return;const a=g(),s=e.current;if(!l.Yw||!n||!a?.isTypeSupported(n))return;const m=new a;function u(){if(!t||!n)return;const e=m.addSourceBuffer(n),a=(0,c.h)(t);e.addEventListener("updateend",function(){a.next().then(({value:t,done:n})=>{"open"===m.readyState&&(n?h(m):p(e,t))})}),a.next().then(({value:t,done:n})=>{n||"open"!==m.readyState||((0,o.RK)(()=>{s.style.display="block",setTimeout(()=>{(0,o.RK)(()=>{(0,r.ZM)(s,{opacity:"1"})})},d)}),p(e,t))})}return m.addEventListener("sourceopen",u,{once:!0}),(0,o.RK)(()=>{(0,r.ZM)(s,{display:"none",opacity:"0"}),s.src=URL.createObjectURL(m)}),()=>{(0,o.RK)(()=>{const e=s.src;(0,i.A)(s),m.removeEventListener("sourceopen",u),"open"===m.readyState&&h(m),URL.revokeObjectURL(e)})}},[n,t,e]),u(n)}function u(e){return!(!l.Yw||!e)&&Boolean(g()?.isTypeSupported(e))}function p(e,t){try{e.appendBuffer(t)}catch(e){s.Oig&&console.warn("[Stream] failed to append buffer",e)}}function h(e){try{e.endOfStream()}catch(e){s.Oig&&console.warn("[Stream] failed to end stream",e)}}function g(){return"ManagedMediaSource"in window?ManagedMediaSource:"MediaSource"in window?MediaSource:void 0}},67054:(e,t,n)=>{"use strict";function a(e,t){return t-Math.floor(t/e)*e}n.d(t,{A:()=>a})},68153:(e,t,n)=>{"use strict";e.exports=n.p+"GiftGreenRound.f66f0acd5d3dda1c7baf.svg"},69419:(e,t,n)=>{"use strict";n.d(t,{A:()=>g});var a=n(84051),s=n(23174),o=n(60919),r=n(96454),i=n(58554),l=n(37836),c=n(63527),d=n(30857),m=n(14745);const u=.75,p=1500,h=500;function g(e,t=!1,n=s.qZ.BlobUrl,g,A=!1){const y=e?i.Ih(e):void 0,f=r.Uz&&n===s.qZ.Progressive,v=(0,d.A)(),E=(0,c.A)(o.nIz),b=(0,m.A)(),[x,w]=(0,a.J0)(y&&!f?1:0),C=(0,a.li)(),N=(0,a.Kr)(()=>(0,l.nF)(e=>{C.current&&(!g||Date.now()-C.current>g)&&w(e)},h,!0),[g]);return(0,a.vJ)(()=>{!t&&e&&(y?f&&setTimeout(()=>{w(u)},p):(w(0),C.current&&i.ch(N),C.current=Date.now(),i.hd(e,n,A,N,b).then(()=>{const e=Date.now()-C.current;C.current=void 0,!g||e>=g?v():setTimeout(v,g-e)})))},[t,e,y,n,f,g,N,A,b,E]),(0,a.vJ)(()=>{t&&C.current&&(i.ch(N),w(0),C.current=void 0)},[N,t]),(0,a.vJ)(()=>()=>{e&&i.Cn(e,b)},[b,e]),{mediaData:y,loadProgress:x}}},70809:(e,t,n)=>{"use strict";n.d(t,{A:()=>l,D3:()=>i,ON:()=>g,S:()=>h,Td:()=>r,US:()=>c,Xq:()=>u,Yy:()=>m,d7:()=>A,fl:()=>d,hz:()=>s,mP:()=>f,qx:()=>p,sY:()=>y,wF:()=>o});var a=n(96540);const s=({size:e=16})=>a.createElement("svg",{height:e,strokeLinejoin:"round",viewBox:"0 0 16 16",width:e,style:{color:"currentcolor"}},a.createElement("g",{clipPath:"url(#clip0_2393_1490)"},a.createElement("path",{d:"M8 0V4",stroke:"currentColor",strokeWidth:"1.5"}),a.createElement("path",{opacity:"0.5",d:"M8 16V12",stroke:"currentColor",strokeWidth:"1.5"}),a.createElement("path",{opacity:"0.9",d:"M3.29773 1.52783L5.64887 4.7639",stroke:"currentColor",strokeWidth:"1.5"}),a.createElement("path",{opacity:"0.1",d:"M12.7023 1.52783L10.3511 4.7639",stroke:"currentColor",strokeWidth:"1.5"}),a.createElement("path",{opacity:"0.4",d:"M12.7023 14.472L10.3511 11.236",stroke:"currentColor",strokeWidth:"1.5"}),a.createElement("path",{opacity:"0.6",d:"M3.29773 14.472L5.64887 11.236",stroke:"currentColor",strokeWidth:"1.5"}),a.createElement("path",{opacity:"0.2",d:"M15.6085 5.52783L11.8043 6.7639",stroke:"currentColor",strokeWidth:"1.5"}),a.createElement("path",{opacity:"0.7",d:"M0.391602 10.472L4.19583 9.23598",stroke:"currentColor",strokeWidth:"1.5"}),a.createElement("path",{opacity:"0.3",d:"M15.6085 10.4722L11.8043 9.2361",stroke:"currentColor",strokeWidth:"1.5"}),a.createElement("path",{opacity:"0.8",d:"M0.391602 5.52783L4.19583 6.7639",stroke:"currentColor",strokeWidth:"1.5"})),a.createElement("defs",null,a.createElement("clipPath",{id:"clip0_2393_1490"},a.createElement("rect",{width:"16",height:"16",fill:"white"})))),o=({size:e=16})=>a.createElement("svg",{height:e,viewBox:"0 0 16 16",width:e,style:{color:"currentcolor"}},a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3 3H13V13H3V3Z",fill:"currentColor"})),r=({size:e=24})=>a.createElement("svg",{height:e,viewBox:"0 0 24 24",width:e,fill:"none"},a.createElement("path",{d:"M0 4C0 1.79086 1.79086 0 4 0H20C22.2091 0 24 1.79086 24 4V20C24 22.2091 22.2091 24 20 24H4C1.79086 24 0 22.2091 0 20V4Z"}),a.createElement("path",{d:"M9.60016 14.3991C9.60016 12.137 9.60016 11.0051 10.3033 10.3027C11.0056 9.59961 12.1375 9.59961 14.3997 9.59961H15.1996C17.4618 9.59961 18.5937 9.59961 19.296 10.3027C19.9992 11.0051 19.9992 12.137 19.9992 14.3991V15.1991C19.9992 17.4612 19.9992 18.5931 19.296 19.2955C18.5937 19.9986 17.4618 19.9986 15.1996 19.9986H14.3997C12.1375 19.9986 11.0056 19.9986 10.3033 19.2955C9.60016 18.5931 9.60016 17.4612 9.60016 15.1991V14.3991Z",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),a.createElement("path",{d:"M15.9988 9.59946C15.9964 7.23409 15.9612 6.00861 15.2725 5.16949C15.1396 5.00762 14.9912 4.85919 14.8294 4.72633C13.943 4 12.6296 4 9.99942 4C7.37007 4 6.055 4 5.16949 4.72633C5.00762 4.85919 4.85919 5.00762 4.72633 5.16949C4 6.0558 4 7.36927 4 9.99942C4 12.6288 4 13.9438 4.72633 14.8294C4.85919 14.9912 5.00762 15.1396 5.16949 15.2725C6.00941 15.9604 7.23329 15.9972 9.59946 15.9988",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})),i=({size:e=16})=>a.createElement("svg",{height:e,strokeLinejoin:"round",viewBox:"0 0 16 16",width:e,style:{color:"currentcolor"}},a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.0607 6.74999L11.5303 7.28032L8.7071 10.1035C8.31657 10.4941 7.68341 10.4941 7.29288 10.1035L4.46966 7.28032L3.93933 6.74999L4.99999 5.68933L5.53032 6.21966L7.99999 8.68933L10.4697 6.21966L11 5.68933L12.0607 6.74999Z",fill:"currentColor"}));function l({size:e=16}){return a.createElement("svg",{height:e,strokeLinejoin:"round",viewBox:"0 0 24 24",width:e,fill:"none"},a.createElement("path",{d:"M8.6125 10.8083L14.3875 7.69167M8.6125 13.1917L14.3875 16.3083M3.625 12C3.625 12.7293 3.90156 13.4288 4.39384 13.9445C4.88613 14.4603 5.55381 14.75 6.25 14.75C6.94619 14.75 7.61387 14.4603 8.10616 13.9445C8.59844 13.4288 8.875 12.7293 8.875 12C8.875 11.2707 8.59844 10.5712 8.10616 10.0555C7.61387 9.53973 6.94619 9.25 6.25 9.25C5.55381 9.25 4.88613 9.53973 4.39384 10.0555C3.90156 10.5712 3.625 11.2707 3.625 12ZM14.125 6.5C14.125 7.22935 14.4016 7.92882 14.8938 8.44454C15.3861 8.96027 16.0538 9.25 16.75 9.25C17.4462 9.25 18.1139 8.96027 18.6062 8.44454C19.0984 7.92882 19.375 7.22935 19.375 6.5C19.375 5.77065 19.0984 5.07118 18.6062 4.55546C18.1139 4.03973 17.4462 3.75 16.75 3.75C16.0538 3.75 15.3861 4.03973 14.8938 4.55546C14.4016 5.07118 14.125 5.77065 14.125 6.5ZM14.125 17.5C14.125 18.2293 14.4016 18.9288 14.8938 19.4445C15.3861 19.9603 16.0538 20.25 16.75 20.25C17.4462 20.25 18.1139 19.9603 18.6062 19.4445C19.0984 18.9288 19.375 18.2293 19.375 17.5C19.375 16.7707 19.0984 16.0712 18.6062 15.5555C18.1139 15.0397 17.4462 14.75 16.75 14.75C16.0538 14.75 15.3861 15.0397 14.8938 15.5555C14.4016 16.0712 14.125 16.7707 14.125 17.5Z",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}))}const c=({size:e=24})=>a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"currentColor"},a.createElement("path",{d:"M7 17L17 7M7 7L17 17",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})),d=({size:e=24})=>a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none"},a.createElement("path",{d:"M20.3635 12.7068C20.5509 12.5193 20.6562 12.265 20.6562 11.9998C20.6562 11.7347 20.5509 11.4803 20.3635 11.2928L14.7065 5.63582C14.5179 5.45366 14.2653 5.35287 14.0031 5.35515C13.7409 5.35742 13.4901 5.46259 13.3046 5.648C13.1192 5.83341 13.0141 6.08422 13.0118 6.34642C13.0095 6.60862 13.1103 6.86122 13.2925 7.04982L17.2425 10.9998L3.99946 10.9998C3.73425 10.9998 3.47989 11.1052 3.29236 11.2927C3.10482 11.4803 2.99946 11.7346 2.99946 11.9998C2.99946 12.265 3.10482 12.5194 3.29236 12.7069C3.47989 12.8945 3.73425 12.9998 3.99946 12.9998L17.2425 12.9998L13.2925 16.9498C13.1103 17.1384 13.0095 17.391 13.0118 17.6532C13.0141 17.9154 13.1192 18.1662 13.3046 18.3516C13.4901 18.537 13.7409 18.6422 14.0031 18.6445C14.2653 18.6468 14.5179 18.546 14.7065 18.3638L20.3635 12.7068Z",fill:"currentColor"})),m=({size:e=24})=>a.createElement("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M14 7L9 12L14 17",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})),u=({size:e=24})=>a.createElement("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M10 17L15 12L10 7",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})),p=({size:e=24})=>a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 15 15",fill:"none"},a.createElement("path",{d:"M0 15L1.56 8.055L10.185 7.515L1.56 6.93L0 0L15 7.5L0 15Z",fill:"currentColor"})),h=({size:e=24})=>a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none"},a.createElement("path",{d:"M0 4C0 1.79086 1.79086 0 4 0H20C22.2091 0 24 1.79086 24 4V20C24 22.2091 22.2091 24 20 24H4C1.79086 24 0 22.2091 0 20V4Z"}),a.createElement("path",{d:"M13.5996 14.3449V9.65499C13.5996 7.03422 13.5996 5.72426 12.8596 5.3976C12.1187 5.07177 11.2475 5.99758 9.50496 7.8517C8.60251 8.81168 8.08807 9.02418 6.804 9.02418C5.68153 9.02418 5.11989 9.02418 4.71587 9.31084C3.87902 9.90582 4.00702 11.0683 4.00702 11.9999C4.00702 12.9316 3.87982 14.0941 4.71747 14.689C5.12069 14.9757 5.68233 14.9757 6.8048 14.9757C8.08887 14.9757 8.60331 15.1882 9.50576 16.1482C11.2483 18.0015 12.1195 18.9281 12.8604 18.6023C13.6004 18.2756 13.6004 16.9657 13.6004 14.344M15.9998 9.5C16.4998 10.1833 16.7998 11.0525 16.7998 11.9999C16.7998 12.9474 16.4998 13.8166 15.9998 14.4999M18.3999 7.83337C19.4 8.97168 20 10.4216 20 11.9999C20 13.5782 19.4 15.0282 18.3999 16.1665",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})),g=({size:e=24})=>a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none"},a.createElement("path",{d:"M12 4V20M8 9V15M20 10V14M4 10V14M16 7V17",stroke:"#4C72FF","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})),A=({size:e=20})=>a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 20 20",fill:"none"},a.createElement("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M7.29183 3.58321C7.29183 3.55495 7.30346 3.51147 7.35734 3.46432C7.41246 3.41609 7.50317 3.37488 7.61921 3.37488H12.3811C12.4972 3.37488 12.5879 3.41609 12.643 3.46432C12.6969 3.51147 12.7085 3.55495 12.7085 3.58321V4.62488H7.29183V3.58321ZM6.04183 4.62488V3.58321C6.04183 2.70201 6.82905 2.12488 7.61921 2.12488H12.3811C13.1713 2.12488 13.9585 2.70201 13.9585 3.58321V4.62488H15.6274H16.6699C17.0151 4.62488 17.2949 4.9047 17.2949 5.24988C17.2949 5.59506 17.0151 5.87488 16.6699 5.87488H16.2064L15.4459 15.8191C15.3457 17.122 14.2592 18.1283 12.9525 18.1283H7.04765C5.7409 18.1283 4.65446 17.1222 4.55423 15.8194L3.7937 5.87488H3.33105C2.98588 5.87488 2.70605 5.59506 2.70605 5.24988C2.70605 4.9047 2.98588 4.62488 3.33105 4.62488H4.37272H6.04183ZM13.3335 5.87488H6.66683H5.04735L5.80055 15.7235C5.85081 16.375 6.39416 16.8783 7.04765 16.8783H12.9525C13.606 16.8783 14.1493 16.3753 14.1996 15.7238L14.9528 5.87488H13.3335ZM11.6416 8.43754C11.9868 8.43754 12.2666 8.71736 12.2666 9.06254V13.752C12.2666 14.0972 11.9868 14.377 11.6416 14.377C11.2964 14.377 11.0166 14.0972 11.0166 13.752V9.06254C11.0166 8.71736 11.2964 8.43754 11.6416 8.43754ZM8.98372 9.06254C8.98372 8.71736 8.7039 8.43754 8.35872 8.43754C8.01355 8.43754 7.73372 8.71736 7.73372 9.06254V13.752C7.73372 14.0972 8.01355 14.377 8.35872 14.377C8.7039 14.377 8.98372 14.0972 8.98372 13.752V9.06254Z",fill:"#FF543D"})),y=({size:e=20})=>a.createElement("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M22 6.5H16",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),a.createElement("path",{d:"M6 6.5H2",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),a.createElement("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M10 10C8.067 10 6.5 8.433 6.5 6.5C6.5 4.567 8.067 3 10 3C11.933 3 13.5 4.567 13.5 6.5C13.5 8.433 11.933 10 10 10Z",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),a.createElement("path",{d:"M22 17.5H18",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),a.createElement("path",{d:"M8 17.5H2",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),a.createElement("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M14 21C12.067 21 10.5 19.433 10.5 17.5C10.5 15.567 12.067 14 14 14C15.933 14 17.5 15.567 17.5 17.5C17.5 19.433 15.933 21 14 21Z",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})),f=({size:e=20})=>a.createElement("svg",{width:e,height:e,viewBox:"0 0 40 40",xmlns:"http://www.w3.org/2000/svg",fill:"#3498db"},a.createElement("circle",{cx:"10",cy:"20",r:"4"},a.createElement("animate",{attributeName:"opacity",from:"0.3",to:"1",dur:"1.2s",begin:"0s",repeatCount:"indefinite"}),a.createElement("animate",{attributeName:"r",from:"3",to:"4",dur:"1.2s",begin:"0s",repeatCount:"indefinite"})),a.createElement("circle",{cx:"20",cy:"20",r:"4"},a.createElement("animate",{attributeName:"opacity",from:"0.3",to:"1",dur:"1.2s",begin:"0.2s",repeatCount:"indefinite"}),a.createElement("animate",{attributeName:"r",from:"3",to:"4",dur:"1.2s",begin:"0.2s",repeatCount:"indefinite"})),a.createElement("circle",{cx:"30",cy:"20",r:"4"},a.createElement("animate",{attributeName:"opacity",from:"0.3",to:"1",dur:"1.2s",begin:"0.4s",repeatCount:"indefinite"}),a.createElement("animate",{attributeName:"r",from:"3",to:"4",dur:"1.2s",begin:"0.4s",repeatCount:"indefinite"})))},71950:(e,t,n)=>{"use strict";n.d(t,{A:()=>f});var a=n(84051),s=n(87357),o=n(17663),r=n(14242),i=n(39351),l=n(59030),c=n(54746);const d="gvrp3KoR",m="IHb3ZATQ",u="zAPFdKbZ",p=[[{name:"followers",title:"ChannelStats.Overview.Followers"},{name:"enabledNotifications",title:"ChannelStats.Overview.EnabledNotifications",isPercentage:!0}],[{name:"viewsPerPost",title:"ChannelStats.Overview.ViewsPerPost"},{name:"viewsPerStory",title:"ChannelStats.Overview.ViewsPerStory"}],[{name:"sharesPerPost",title:"ChannelStats.Overview.SharesPerPost"},{name:"sharesPerStory",title:"ChannelStats.Overview.SharesPerStory"}],[{name:"reactionsPerPost",title:"ChannelStats.Overview.ReactionsPerPost"},{name:"reactionsPerStory",title:"ChannelStats.Overview.ReactionsPerStory"}]],h=[[{name:"members",title:"Stats.GroupMembers"},{name:"messages",title:"Stats.GroupMessages"}],[{name:"viewers",title:"Stats.GroupViewers"},{name:"posters",title:"Stats.GroupPosters"}]],g=[[{name:"viewsCount",title:"Stats.Message.Views",isPlain:!0},{name:"publicForwards",title:"Stats.Message.PublicShares",isPlain:!0}],[{name:"reactionsCount",title:"Channel.Stats.Overview.Reactions",isPlain:!0},{name:"forwardsCount",title:"Stats.Message.PrivateShares",isPlain:!0,isApproximate:!0}]],A=[[{name:"viewsCount",title:"Channel.Stats.Overview.Views",isPlain:!0},{name:"publicForwards",title:"PublicShares",isPlain:!0}],[{name:"reactionsCount",title:"Channel.Stats.Overview.Reactions",isPlain:!0},{name:"forwardsCount",title:"PrivateShares",isPlain:!0}]],y=[[{name:"level",title:"Stats.Boosts.Level",isPlain:!0},{name:"premiumSubscribers",title:"Stats.Boosts.PremiumSubscribers",isPercentage:!0,isApproximate:!0,withAbsoluteValue:!0}],[{name:"boosts",title:"Stats.Boosts.ExistingBoosts",isPlain:!0},{name:"remainingBoosts",title:"Stats.Boosts.BoostsToLevelUp",isPlain:!0}]],f=(0,a.ph)(({title:e,type:t,statistics:n,isToncoin:f,className:v,subtitle:E})=>{const b=(0,l.A)(),x=(0,i.A)(),w=(e,t,n)=>{const[s,o]=e.toFixed(4).split("."),[r,i]=(e*t).toFixed(2).split(".");return a.Ay.createElement("div",null,a.Ay.createElement(c.A,{className:"it39BC_c",name:"toncoin"}),a.Ay.createElement("b",{className:u},s,a.Ay.createElement("span",{className:"ZAfXkuWL"},".",o))," ",a.Ay.createElement("span",{className:m},"≈ $",r,a.Ay.createElement("span",{className:"HRXb_S2M"},".",i)),a.Ay.createElement("h3",{className:m},b(n)))},{period:C}=n,{balances:N,usdRate:I}=n,S=function(e){switch(e){case"group":return h;case"message":return g;case"boost":return y;case"story":return A;default:return p}}(t);return a.Ay.createElement("div",{className:(0,s.A)("Gi8Nokbl",v)},a.Ay.createElement("div",{className:"H01lE7mv"},e&&a.Ay.createElement("div",{className:"VQbs04hT"},e),C&&a.Ay.createElement("div",{className:"X7bBlGdi"},(0,o.Lu)(b,1e3*C.minDate)," ","—",(0,o.Lu)(b,1e3*C.maxDate))),a.Ay.createElement("table",{className:"s5beXqqL"},f?a.Ay.createElement("tr",null,a.Ay.createElement("td",{className:d},w(N?.availableBalance||0,I||0,"lng_channel_earn_available"),w(N?.currentBalance||0,I||0,"lng_channel_earn_reward"),w(N?.overallRevenue||0,I||0,"lng_channel_earn_total"))):S.map(e=>a.Ay.createElement("tr",null,e.map(e=>{const t=n?.[e.name];if(e.isPlain)return a.Ay.createElement("td",{className:d},a.Ay.createElement("b",{className:u},`${e.isApproximate?"≈ ":""}${(0,r.Sm)(t??0)}`),a.Ay.createElement("h3",{className:m},b(e.title)));if(e.isPercentage){const n=t?.part??0,s=t?.percentage??0;return a.Ay.createElement("td",{className:d},e.withAbsoluteValue&&a.Ay.createElement("span",{className:u},`${e.isApproximate?"≈ ":""}${(0,r.Sm)(n)}`),a.Ay.createElement("span",{className:e.withAbsoluteValue?"_mYEmh_u":u},s,"%"),a.Ay.createElement("h3",{className:m},b(e.title)))}return a.Ay.createElement("td",{className:d},a.Ay.createElement("b",{className:u},(0,r.Vw)(x,t?.current??0))," ",(({change:e,percentage:t})=>{if(!e)return;const n=Number(e)<0;return a.Ay.createElement("span",{className:(0,s.A)("idLrmbhS",n&&"SLfwGHQC")},n?`-${(0,r.Vw)(x,Math.abs(e))}`:`+${(0,r.Vw)(x,e)}`,t&&a.Ay.createElement(a.Ay.Fragment,null," ","(",t,"%)"))})(t),a.Ay.createElement("h3",{className:m},b(e.title)))})))),E)})},72078:(e,t,n)=>{"use strict";e.exports=n.p+"GiftBlueRound.90e369f0f350cdfb20d4.svg"},73172:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var a=n(84051),s=n(13439),o=n(31481),r=n(37836);const i=(e,t)=>(0,a.Kr)(()=>(0,r.nF)(n=>{e&&t&&(0,s.ko)().sendMessageAction({chatId:e,threadId:t,action:n})},o.cqp),[e,t])},75175:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var a=n(96540);const s=({text:e,errors:t})=>{if(!t.length)return a.createElement("p",null,a.createElement("span",null,e));const n=[];let s=0;return t.sort((e,t)=>e.offset-t.offset).forEach((t,o)=>{const{offset:r,length:i,suggestions:l}=t;r>s&&n.push(a.createElement("span",{key:`normal-${o}`,className:"text-[var(--color-text)]"},e.slice(s,r)));const c=e.slice(r,r+i),d=l[0]||"";n.push(a.createElement("span",{key:`error-${o}`,className:"bg-black/15 line-through mr-[4px] text-[var(--color-text)]"},c)),n.push(a.createElement("span",{key:`suggestion-${o}`,className:"bg-[#8C42F033] mr-[4px] text-[#8C42F0]"},d)),s=r+i}),s<e.length&&n.push(a.createElement("span",{key:"end",className:"text-[var(--color-text)]"},e.slice(s))),a.createElement("p",null,n)}},75295:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var a=n(84051),s=n(87357),o=n(37661),r=n(5912),i=n(17712),l=n(62587),c=n(10221),d=n(18104),m=n(3325);const u=(0,a.ph)(({messageId:e,isMirrored:t,effect:n,shouldPlay:u,observeIntersectionForLoading:p,observeIntersectionForPlaying:h,onStop:g})=>{const A=(0,a.li)(),y=(0,a.li)(),f=(0,r.Vz)(A,p),v=(0,r.Vz)(A,h),[E,b,x]=(0,o.A)(),[w,C,N]=(0,o.A)(),I=function(e){return e.effectAnimationId?`sticker${e.effectAnimationId}`:`sticker${e.effectStickerId}?size=f`}(n),S=(0,l.A)(I,!f),M=(0,i.A)(()=>{x(),g?.()}),k=(0,c.A)({anchorRef:A,overlayRef:y,isMirrored:t,isDisabled:!E,isForMessageEffect:!0,id:n.id});(0,a.vJ)(()=>{w&&k(),N()},[k,N,w]),(0,a.vJ)(()=>{v&&u&&S&&(b(),C())},[v,S,u,k]);const T=(0,s.A)("McmbiWZE",t&&"wNvU2uqi");return a.Ay.createElement("div",{className:(0,s.A)("IYu2f7FM",t&&"GsTZawTE"),ref:A},E&&a.Ay.createElement(m.A,null,a.Ay.createElement(d.A,{ref:y,key:`effect-${e??n.id}`,className:T,tgsUrl:S,size:256,play:!0,isLowPriority:!0,noLoop:!0,forceAlways:!0,onEnded:M})))})},75304:(e,t,n)=>{"use strict";n.d(t,{R:()=>o});var a=n(96540),s=n(20427);function o(){const e=(0,a.useRef)(null),t=(0,a.useRef)(null),{data:n=!1,mutate:o}=(0,s.Ay)("messages:is-scroll-lock",null,{fallbackData:!1}),{data:r=!1,mutate:i}=(0,s.Ay)("messages:is-at-bottom",null,{fallbackData:!1}),{data:l=!1,mutate:c}=(0,s.Ay)("messages:should-scroll",null,{fallbackData:!1});(0,a.useEffect)(()=>{l&&!n&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{t.current?.scrollIntoView({behavior:l}),c(!1)})})},[c,l,n]);const d=(0,a.useCallback)((e="smooth")=>{o(!1),c(e)},[o,c]);return{containerRef:e,endRef:t,isAtBottom:r,isScrollLock:n,scrollToBottom:d,onViewportEnter:function(){i(!0)},onViewportLeave:function(){i(!1)},scrollLocked:()=>{o(!0)},scrollUnLocked:()=>{o(!1)}}}},75319:(e,t,n)=>{"use strict";function a(e){return"object"==typeof e&&null!==e&&"graphType"in e}n.d(t,{R:()=>a})},75343:(e,t,n)=>{"use strict";n.d(t,{A:()=>b});var a=n(84051),s=n(13439),o=n(87357),r=n(43874),i=n(36838),l=n(59030),c=n(89925),d=n(70636),m=n(9716),u=n(54464),p=n(10722),h=n(17712),g=n(92111),A=n(21849),y=n(71429),f=n(24433),v=n(2429);const E=(0,a.ph)(function({peer:e,isArchived:t}){const{openChat:n,openChatWithInfo:r,openStoryViewer:i,toggleStoriesHidden:E}=(0,s.ko)(),b=(0,l.A)(),x=(0,a.li)(),w="isSelf"in e&&e.isSelf,C=!(0,m.L8)(e.id);(0,g.A)(e.id);const{isContextMenuOpen:N,contextMenuAnchor:I,handleBeforeContextMenu:S,handleContextMenu:M,handleContextMenuClose:k,handleContextMenuHide:T}=(0,p.A)(x),P=(0,h.A)(()=>x.current),L=(0,h.A)(()=>document.body),B=(0,h.A)(()=>x.current.querySelector(".story-peer-context-menu .bubble")),R=(0,h.A)(()=>({withPortal:!0,isDense:!0})),F=(0,h.A)(()=>{N||i({peerId:e.id,origin:c.G9.StoryRibbon})}),D=(0,h.A)(e=>{(0,u.u)(e),S(e)}),O=(0,h.A)(()=>{r({id:e.id,shouldReplaceHistory:!0,profileTab:"stories"})}),z=(0,h.A)(()=>{r({id:e.id,shouldReplaceHistory:!0,profileTab:"storiesArchive"})}),j=(0,h.A)(()=>{n({id:e.id,shouldReplaceHistory:!0})}),U=(0,h.A)(()=>{r({id:e.id,shouldReplaceHistory:!0})}),V=(0,h.A)(()=>{E({peerId:e.id,isHidden:!t})});return a.Ay.createElement("div",{ref:x,role:"button","data-peer-id":e.id,tabIndex:0,className:v.A.peer,onMouseDown:D,onClick:F,onContextMenu:M},a.Ay.createElement(A.A,{peer:e,withStory:!0,storyViewerOrigin:c.G9.StoryRibbon,storyViewerMode:"full"}),a.Ay.createElement("div",{className:(0,o.A)(v.A.name,e.hasUnreadStories&&v.A.name_hasUnreadStory)},w?b("MyStory"):(0,d.F9)(b,e)),void 0!==I&&a.Ay.createElement(y.A,{isOpen:N,anchor:I,getTriggerElement:P,getRootElement:L,getMenuElement:B,getLayout:R,className:(0,o.A)("story-peer-context-menu",v.A.contextMenu),autoClose:!0,withPortal:!0,onClose:k,onCloseAnimationEnd:T},w?a.Ay.createElement(a.Ay.Fragment,null,a.Ay.createElement(f.A,{onClick:O,icon:"play-story"},b("StoryList.Context.SavedStories")),a.Ay.createElement(f.A,{onClick:z,icon:"archive"},b("StoryList.Context.ArchivedStories"))):a.Ay.createElement(a.Ay.Fragment,null,!C&&a.Ay.createElement(f.A,{onClick:j,icon:"message"},b("SendMessageTitle")),C?a.Ay.createElement(f.A,{onClick:U,icon:"channel"},b("ChatList.ContextOpenChannel")):a.Ay.createElement(f.A,{onClick:U,icon:"user"},b("StoryList.Context.ViewProfile")),a.Ay.createElement(f.A,{onClick:V,icon:t?"unarchive":"archive"},b(t?"StoryList.Context.Unarchive":"StoryList.Context.Archive")))))}),b=(0,a.ph)((0,s.EK)((e,{isArchived:t})=>{const{orderedPeerIds:{active:n,archived:a}}=e.stories;return{orderedPeerIds:t?a:n,usersById:e.users.byId,chatsById:e.chats.byId}})(function({isArchived:e,className:t,orderedPeerIds:n,usersById:s,chatsById:c,isClosing:d}){const m=(0,l.A)(),u=(0,o.A)(v.A.root,!n.length&&v.A.hidden,d&&v.A.closing,t,"no-scrollbar"),p=(0,a.li)();return(0,i.A)(p,(0,r.Ny)()),a.Ay.createElement("div",{ref:p,id:"StoryRibbon",className:u,dir:m.isRtl?"rtl":void 0},n.map(t=>{const n=s[t]||c[t];if(n)return a.Ay.createElement(E,{key:t,peer:n,isArchived:e})}))}))},75606:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var a=n(96540),s=n(13439),o=n(60919),r=n(9716),i=n(22199),l=n(81008);const c=({chatId:e,classNames:t,size:n,style:c})=>{const d=(0,s.mS)();let m;return m=(0,r.L8)(e)?(0,o.mBe)(d,e):(0,o.hds)(d,e),a.createElement(l.A,{style:c,key:e,className:(0,i.cn)(t,"overlay-avatar inline-block cursor-pointer"),size:n,peer:m})}},79882:(e,t,n)=>{"use strict";n.d(t,{I:()=>s,W:()=>o});var a=n(84051);let s=function(e){return e[e.Move=0]="Move",e[e.Opacity=1]="Opacity",e[e.None=2]="None",e}({});function o(e){return(0,a.Kr)(()=>{const t=Object.values(e),n=t.filter(e=>e<0).length,a=t.filter(e=>e>0).length;return t=>{const o=e[t];return 0===o?s.None:o===1/0||o===-1/0||n<=a&&o<0||a<n&&o>0?s.Opacity:s.Move}},[e])}},80477:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var a=n(84051),s=n(13439),o=n(90709),r=n(60919),i=n(4961),l=n(59030),c=n(80999);const d=(0,a.ph)((0,s.EK)((e,{typingStatus:t})=>t.userId?{typingUser:(0,r.mBe)(e,t.userId)}:{})(({typingStatus:e,typingUser:t})=>{const n=(0,l.A)(),s=t&&!t.isSelf&&(0,o.u0)(t),r=n(e.action).replace("{user}","").replace("{emoji}",e.emoji||"").trim();return a.Ay.createElement("p",{className:"typing-status",dir:n.isRtl?"rtl":"auto"},s&&a.Ay.createElement("span",{className:"sender-name",dir:"auto"},(0,i.A)(s)),a.Ay.createElement(c.A,{content:r}))}))},80999:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var a=n(84051),s=n(87357),o=n(4961),r=n(59030);const i=({content:e,className:t})=>{const n=(0,r.A)();return a.Ay.createElement("span",{className:(0,s.A)("DotAnimation",t),dir:n.isRtl?"rtl":"auto"},(0,o.A)(e),a.Ay.createElement("span",{className:"ellipsis"}))}},81524:(e,t,n)=>{"use strict";n.d(t,{A:()=>A});var a=n(84051),s=n(90709),o=n(87357),r=n(17663),i=n(83868),l=n(35749),c=n(2338),d=n(37661),m=n(5912),u=n(17712),p=n(62587),h=n(83057),g=n(27860);const A=(0,a.ph)(({message:e,idPrefix:t="shared-media",isProtected:n,observeIntersection:A,onClick:y})=>{const f=(0,a.li)(),v=(0,m.Vz)(f,A),E=(0,c.A)(e),b=(0,l.A)(e,"pictogram"),x=(0,p.A)(b,!v),w=(0,h.A)(x),C=(0,s.zX)(e),N=(0,s.y2)(e),[I,,S]=(0,d.A)(N),M=(0,u.A)(()=>{S(),y(e.id,e.chatId)});return a.Ay.createElement("div",{ref:f,id:`${t}${(0,s.GZ)(e.id)}`,className:"Media scroll-item",onClick:y?M:void 0},a.Ay.createElement("img",{src:E,className:"media-miniature",alt:"",draggable:!n,decoding:"async",onContextMenu:n?i.A:void 0}),a.Ay.createElement("img",{src:x,className:(0,o.A)("full-media","media-miniature",w),alt:"",draggable:!n,decoding:"async",onContextMenu:n?i.A:void 0}),N&&a.Ay.createElement(g.A,{thumbDataUri:x||E,isVisible:I,className:"media-spoiler"}),C&&a.Ay.createElement("span",{className:"video-duration"},C.isGif?"GIF":(0,r.QO)(C.duration)),n&&a.Ay.createElement("span",{className:"protector"}))})},81642:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var a=n(84051),s=n(87357),o=n(17663),r=n(59030),i=n(45);const l=(0,a.ph)(({className:e,message:t,outgoingStatus:n,draftDate:l})=>{const c=(0,r.A)(),d=l&&l>t.date;return a.Ay.createElement("div",{className:(0,s.A)("LastMessageMeta",e)},n&&!d&&a.Ay.createElement(i.A,{status:n}),a.Ay.createElement("span",{className:"time"},(0,o.be)(c,1e3*(d?l:t.date))))})},84313:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var a=n(84051),s=n(13439),o=n(96454),r=n(17712),i=n(59030);const l=8e3;function c(e,t,n){const{showNotification:c}=(0,s.ko)(),d=(0,i.A)(),[m,u]=(0,a.J0)(!1),p=(0,r.A)(()=>{u(!0),t||c({message:o.yS?d("Video.Unsupported.Mobile"):d("Video.Unsupported.Desktop"),duration:l})}),h=(0,r.A)(e=>{const t=e.currentTarget,{error:n}=t;n&&(3!==n.code&&4!==n.code||p())}),g=(0,r.A)(e=>{const t=e.currentTarget;t.videoHeight&&t.videoWidth||p()});return(0,a.vJ)(()=>{if(n)return;const{current:t}=e;return t?(t.addEventListener("error",h),t.addEventListener("canplay",g),()=>{t.removeEventListener("error",h),t.removeEventListener("canplay",g)}):void 0},[n,e]),m}},84555:(e,t,n)=>{"use strict";n.d(t,{A:()=>T});var a=n(84051),s=n(13439),o=n(23174),r=n(90709),i=n(53827),l=n(87357),c=n(17663),d=n(41733),m=n(76023),u=n(2338),p=n(63988),h=n(37661),g=n(5912),A=n(17712),y=n(37960),f=n(69419),v=n(73767),E=n(34201),b=n(61097),x=n(54746),w=n(27860),C=n(64493),N=n(65843),I=n(35913);const S=m.Wd/2,M=2*(S-6)*Math.PI;let k;const T=({message:e,className:t,canAutoLoad:n,isDownloading:T,origin:P,observeIntersection:L,onStop:B,onReadMedia:R,isTranscriptionError:F,isTranscribed:D,canTranscribe:O,onHideTranscription:z,isTranscriptionHidden:j,isTranscribing:U})=>{const V=(0,a.li)(),J=(0,a.li)(),H=(0,a.li)(),{cancelMediaDownload:K,openOneTimeMediaModal:$,transcribeAudio:G}=(0,s.ko)(),_=(0,g.Vz)(V,L),q=e.content.video,W=e.isMediaUnread,[Q,Y]=(0,a.J0)(n),Z=Boolean(Q&&_),{mediaData:X,loadProgress:ee}=(0,f.A)((0,r.sC)(q,"inline"),!Z,(0,r.Cz)(q,"inline")),{loadProgress:te}=(0,f.A)((0,r.sC)(q,"download"),!T,o.qZ.BlobUrl),[ne,ae]=(0,h.A)(),se=(0,r.G5)(e),oe="oneTimeModal"===P,re=se&&!oe,ie=(0,u.A)(e),le=!Boolean(ie)||ne||re,ce=(0,b.A)(q,le);(0,y.A)({hasMediaData:!le,ref:ce});const de=Q&&!ne||T,me=!1===(0,v.A)(Q),{ref:ue,shouldRender:pe}=(0,E.A)({isOpen:de,noMountTransition:me,withShouldRender:!0}),[he,ge]=(0,a.J0)(!1),[Ae,ye]=(0,a.J0)(0),[fe,ve]=(0,a.Ul)(0),Ee=(0,p.aG)(fe,16);(0,a.vJ)(()=>{if(!he)return;const e=J.current;ve(e.currentTime/e.duration)},[ve,he,Ee]),(0,a.Nf)(()=>{if(!he||!H.current)return;const e=M-Ee()*M;H.current.setAttribute("stroke-dashoffset",e.toString())},[he,Ee]);const be=Boolean(X&&_),xe=(0,A.A)(()=>{J.current&&(ge(!1),ve(0),(0,d.A)(J.current))}),we=(0,A.A)(()=>{k?.(),k=xe}),Ce=(0,A.A)(()=>{const e=J.current;he?e.paused?((0,d.A)(e),(0,i._K)()):e.pause():(we(),e.pause(),e.currentTime=0,(0,d.A)(e),(0,i._K)(),ge(!0))});(0,a.vJ)(()=>{oe&&Ce()},[oe]);const Ne=(0,A.A)(t=>{if(!t.target.closest(".transcribe-button"))if(X){if(!T)return se&&!oe?($({message:e}),void R?.()):void Ce();K({media:q})}else Y(e=>!e)});(0,a.vJ)(()=>{R&&W&&he&&R()},[he,W,R]);const Ie=(0,A.A)(e=>{const t=e.currentTarget;ve(t.currentTime/t.duration),ye(Math.floor(t.currentTime))}),Se=(0,A.A)(()=>{G({chatId:e.chatId,messageId:e.id})}),Me=(0,A.A)(()=>{(D||F)&&z?z(!j):U||Se()});return a.Ay.createElement("div",{ref:V,className:(0,l.A)("RoundVideo","media-inner",oe&&"non-interactive",t),onClick:Ne},X&&a.Ay.createElement("div",{className:"video-wrapper"},re&&a.Ay.createElement(w.A,{isVisible:!0,thumbDataUri:ie,width:m.Wd,height:m.Wd,className:"media-spoiler"}),a.Ay.createElement(N.A,{canPlay:be,ref:J,src:X,className:"full-media",width:m.Wd,height:m.Wd,autoPlay:!re,disablePictureInPicture:!0,muted:!he,defaultMuted:!0,loop:!he,playsInline:!0,isPriority:!0,onEnded:he?B??xe:void 0,onTimeUpdate:he?Ie:void 0,onReady:ae})),!re&&a.Ay.createElement("canvas",{ref:ce,className:"thumbnail",style:`width: ${m.Wd}px; height: ${m.Wd}px`}),a.Ay.createElement("div",{className:"progress"},he&&a.Ay.createElement("svg",{width:m.Wd,height:m.Wd},a.Ay.createElement("circle",{ref:H,cx:S,cy:S,r:S-6,className:"progress-circle",transform:`rotate(-90, ${S}, ${S})`,"stroke-dasharray":M,"stroke-dashoffset":M}))),pe&&a.Ay.createElement("div",{ref:ue,className:"media-loading"},a.Ay.createElement(I.A,{progress:T?te:ee})),re&&!pe&&a.Ay.createElement("div",{className:"play-wrapper"},a.Ay.createElement(C.A,{color:"dark",round:!0,size:"smaller",className:"play",nonInteractive:!0},a.Ay.createElement(x.A,{name:"play"})),a.Ay.createElement(x.A,{name:"view-once"})),!X&&!Q&&a.Ay.createElement(x.A,{name:"download"}),!oe&&a.Ay.createElement("div",{className:(0,l.A)("message-media-duration",W&&"unread")},he?(0,c.QO)(Ae):(0,c.QO)(q.duration),(!he||J.current.paused)&&a.Ay.createElement(x.A,{name:"muted"})),O&&a.Ay.createElement(C.A,{onClick:Me,className:"transcribe-button"},D||F?a.Ay.createElement(x.A,{name:"down"}):a.Ay.createElement(x.A,{name:"transcribe"}),U&&a.Ay.createElement("svg",{viewBox:"0 0 32 24",className:"loading-svg"},a.Ay.createElement("rect",{className:"loading-rect",fill:"transparent",width:"32",height:"24","stroke-width":"3","stroke-linejoin":"round",rx:"6",ry:"6",stroke:"white","stroke-dashoffset":"1","stroke-dasharray":"32,68"}))))}},85449:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var a=n(84051),s=n(31481),o=n(98607),r=n(4961),i=n(54746);function l(e,t){return"receipt"===t.type?e("PaymentReceipt"):"buy"===t.type?(0,o.i)(t.text,s.Cyx,a.Ay.createElement(i.A,{className:"star-currency-icon",name:"star"})):(0,r.A)(t.text)}},88792:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var a=n(84051),s=n(13439),o=n(31481),r=n(60919),i=n(53827),l=n(49642),c=n(80853),d=n(82117),m=n(17712),u=n(35297);const p=(e,t,n,p,h,g,A,y=!1,f,v,E=!1,b=!1,x,w=!1,C=!1)=>{const N=(0,a.li)(),[I,S]=(0,a.J0)(!1);let M=I;const[k,T]=(0,a.J0)(0),P=(0,m.A)(()=>{S(!1),v&&v()});(0,u.A)(()=>{if(!e)return;N.current=(0,i.kz)(e,n,(e,a)=>{if(!C){switch(e){case"onPlay":{const{setVolume:e,setPlaybackRate:a,toggleMuted:i,proxy:c}=N.current;S(!0),"oneTimeVoice"!==n&&(0,l.MV)(g,function(e){let t={};if(e&&e.current){const{play:n,pause:a,setCurrentTime:o,proxy:r,requestNextTrack:i,requestPreviousTrack:l,isFirst:c,isLast:d}=e.current;t={play:()=>{n(r.src)},pause:()=>{a()},stop:()=>{a(),o(0),(0,s.ko)().closeAudioPlayer()},seekbackward:e=>{const t=e.seekOffset||10;o(Math.max(r.currentTime-t,0))},seekforward:e=>{const t=e.seekOffset||10;o(Math.min(r.currentTime+t,r.duration))},seekTo:e=>{e.seekTime&&o(e.seekTime)}},d()||(t.nexttrack=()=>{i()}),c()||(t.previoustrack=()=>{l()})}return t}(N)),(0,l.HW)("playing");const{audioPlayer:d}=(0,r.nTw)((0,s.mS)());e(d.volume),i(Boolean(d.isMuted));const m=c.duration&&Number.isFinite(c.duration)?c.duration:t;("voice"===n||m>o.CVm)&&a(d.playbackRate),(0,l.hm)({duration:c.duration||0,playbackRate:c.playbackRate,position:c.currentTime});break}case"onRateChange":{const{proxy:e}=N.current;(0,l.hm)({duration:e.duration||0,playbackRate:e.playbackRate,position:e.currentTime});break}case"onPause":S(!1),(0,l.HW)("paused"),x?.();break;case"onTimeUpdate":{const{proxy:e}=N.current;if(w&&0===e.currentTime)break;const n=e.duration&&Number.isFinite(e.duration)?e.duration:t;b||T(e.currentTime/n);break}case"onEnded":(0,l.HW)("paused")}h?.[e]?.(a)}},f,P);const{proxy:a}=N.current;I||a.paused||(S(!0),M=!0),A&&!C&&A(a)},[e]),(0,a.vJ)(()=>{I&&g&&(0,l.D5)(g)},[g,I]);const{play:L,pause:B,setCurrentTime:R,proxy:F,destroy:D,setVolume:O,stop:z,isFirst:j,isLast:U,requestNextTrack:V,requestPreviousTrack:J,setPlaybackRate:H,toggleMuted:K}=N.current??{},$=(0,a.Kr)(()=>F?.duration&&Number.isFinite(F.duration)?F.duration:t,[F?.duration,t]);(0,a.vJ)(()=>{F&&(w&&0===F.currentTime||!$||(0,c.f)(F)||b||T(F.currentTime/$))},[$,k,F,b,w]),(0,a.vJ)(()=>()=>{D?.(E)},[D,E]),(0,d.A)(([e,t])=>{e===y&&p===t||F?.src&&F?.paused||y&&p&&!I&&L?.(p)},[y,p,I,L,F?.src,F?.paused,n]);const G=(0,m.A)(()=>{p&&L?.(p)}),_=(0,m.A)(()=>{I?B?.():G()}),q=(0,m.A)(e=>{R?.(e),$&&F&&T(F.currentTime/$)});return{isPlaying:M,playProgress:k,playPause:_,pause:B,play:G,stop:z,setCurrentTime:q,setVolume:O,audioProxy:F,duration:$,requestNextTrack:V,requestPreviousTrack:J,isFirst:j,isLast:U,setPlaybackRate:H,toggleMuted:K}}},89116:(e,t,n)=>{"use strict";n.d(t,{N:()=>s,S:()=>o});var a=n(71511);let s=function(e){return e.PersonalizeSettings="PersonalizeSettings",e.OriginalMessages="OriginalMessages",e.CustomizationPrompt="CustomizationPrompt",e.ChatPicker="ChatPicker",e.AddTopicPanel="AddTopicPanel",e}({});const o=(0,a.v)(e=>({isOpen:!1,drawerKey:void 0,drawerParams:void 0,openDrawer:(t,n)=>e(()=>({isOpen:!0,drawerKey:t,drawerParams:n})),closeDrawer:()=>e(()=>({isOpen:!1,drawerKey:void 0,drawerParams:void 0}))}))},89873:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var a=n(84051),s=n(13439),o=n(17712),r=n(34201),i=n(59030),l=n(71429),c=n(24433),d=n(60859);const m=(0,a.ph)(({isOpen:e,sponsorInfo:t,canReport:n,anchor:s,triggerRef:r,shouldSkipAbout:m,onClose:u,onCloseAnimationEnd:p,onAboutAdsClick:h,onSponsoredHide:g,onSponsorInfo:A,onSponsoredReport:y})=>{const f=(0,a.li)(),v=(0,i.A)(),E=(0,o.A)(()=>r.current),b=(0,o.A)(()=>({withPortal:!0})),x=(0,o.A)(()=>f.current),w=(0,o.A)(()=>document.body),C=t||!m||n;return a.Ay.createElement(l.A,{ref:f,isOpen:e,anchor:s,withPortal:!0,className:"with-menu-transitions",getLayout:b,getTriggerElement:E,getMenuElement:x,getRootElement:w,onClose:u,onCloseAnimationEnd:p},t&&A&&a.Ay.createElement(c.A,{icon:"channel",onClick:A},v("SponsoredMessageSponsor")),!m&&a.Ay.createElement(c.A,{icon:"info",onClick:h},v(n?"AboutRevenueSharingAds":"SponsoredMessageInfo")),n&&y&&a.Ay.createElement(c.A,{icon:"hand-stop",onClick:y},v("ReportAd")),C&&a.Ay.createElement(d.A,null),a.Ay.createElement(c.A,{icon:"close-circle",onClick:g},v("HideAd")))}),u=(0,a.ph)(({isOpen:e,randomId:t,sponsorInfo:n,additionalInfo:i,canReport:l,anchor:c,triggerRef:d,shouldSkipAbout:u,onItemClick:p,onClose:h,onCloseAnimationEnd:g})=>{const{openAboutAdsModal:A,showDialog:y,reportSponsored:f,hideSponsored:v}=(0,s.ko)(),{ref:E}=(0,r.A)({isOpen:e,onCloseAnimationEnd:g}),b=(0,o.A)(()=>{p?.(),h()}),x=(0,o.A)(()=>{A({randomId:t,additionalInfo:i,canReport:l,sponsorInfo:n}),b()}),w=(0,o.A)(()=>{v(),b()}),C=(0,o.A)(()=>{y({data:{message:[n,i].filter(Boolean).join("\n")}}),b()}),N=(0,o.A)(()=>{f({randomId:t}),b()});if(c)return a.Ay.createElement("div",{ref:E,className:"ContextMenuContainer"},a.Ay.createElement(m,{isOpen:e,anchor:c,triggerRef:d,canReport:l,sponsorInfo:n,shouldSkipAbout:u,onClose:h,onCloseAnimationEnd:h,onAboutAdsClick:x,onSponsoredHide:w,onSponsorInfo:C,onSponsoredReport:N}))})},90054:(e,t,n)=>{"use strict";n.d(t,{A:()=>q});var a=n(84051),s=n(13439),o=n(23174),r=n(31481),i=n(66644),l=n(90709),c=n(60919),d=n(96454),m=n(87357),u=n(11778),p=n(50442),h=n(25903),g=n(43874),A=n(26072),y=n(96374),f=n(5912),v=n(17712),E=n(59030),b=n(73767),x=n(9717),w=n(63744),C=n(51083),N=n(54746),I=n(48553),S=n(64493),M=n(46222),k=n(52745),T=n(76023),P=n(79577);const L={root:"Ky16H_sV","button-text":"W01t9CIf",buttonText:"W01t9CIf",sticker:"c8lE3XW5",title:"wlwD1B1Q",description:"V8OCFHmp","is-ios":"IxW_z_r0",isIos:"IxW_z_r0","is-macos":"OFxKGCEJ",isMacos:"OFxKGCEJ"},B=7*T.$,R=(0,a.ph)((0,s.EK)((e,{chatId:t})=>{const n=(0,c.hds)(e,t),a=n&&(n.isCreator||(0,l.ub)(n,"manageTopics"));return{animatedEmoji:(0,c.oei)(e,"🐣"),canManageTopics:a}})(({chatId:e,animatedEmoji:t,canManageTopics:n})=>{const{openCreateTopicPanel:o}=(0,s.ko)(),r=(0,E.A)(),{isMobile:i}=(0,g.Ay)(),l=(0,a.hb)(()=>{o({chatId:e})},[e,o]);return a.Ay.createElement("div",{className:L.root},a.Ay.createElement("div",{className:L.sticker},t&&a.Ay.createElement(P.A,{sticker:t,size:B})),a.Ay.createElement("h3",{className:L.title,dir:"auto"},r("ChatList.EmptyTopicsTitle")),a.Ay.createElement("p",{className:(0,m.A)(L.description,L.centered),dir:"auto"},r("ChatList.EmptyTopicsDescription")),n&&a.Ay.createElement(S.A,{ripple:!i,fluid:!0,onClick:l,size:"smaller",isRtl:r.isRtl},a.Ay.createElement("div",{className:L.buttonText},r("ChatList.EmptyTopicsCreate"))))}));var F=n(27109),D=n(66414),O=n(4961),z=n(37661),j=n(53188),U=n(87894),V=n(81642),J=n(38102),H=n(94189),K=n(22720),$=n(97046),G=n(24807);const _=(0,a.ph)((0,s.EK)((e,{chatId:t,topic:n,isSelected:a})=>{const s=(0,c.hds)(e,t),o=(0,c.O5q)(e,t,n.lastMessageId),{isOutgoing:r}=o||{},i=o&&(0,c.Y7C)(e,o),l=(0,c.C5H)(e,t,n.id,"typingStatus"),d=(0,c.GA4)(e,t,n.id),m=(0,c.Vw0)(e,t,n.id),u=Boolean(m?.lastReadInboxMessageId),p=(0,c.pSx)(e,t),{chatId:h,threadId:g}=(0,c.Xf0)(e)||{},A=o?.content.storyData,y=A&&(0,c.Msb)(e,A.peerId,A.id);return{chat:s,lastMessage:o,lastMessageSender:i,typingStatus:l,isChatMuted:s&&(0,F.If)(s,(0,c.K52)(e),(0,c.P5N)(e,s.id)),canDelete:(0,c.DBV)(e,t,n.id),withInterfaceAnimations:(0,c.PKK)(e),draft:d,...r&&o&&{lastMessageOutgoingStatus:(0,c.Tl2)(e,o)},canScrollDown:a&&s?.id===h&&g===n.id,wasTopicOpened:u,topics:p,lastMessageStory:y}})(({topic:e,isSelected:t,chatId:n,chat:o,isChatMuted:r,style:i,lastMessage:c,lastMessageStory:u,canScrollDown:p,lastMessageOutgoingStatus:h,observeIntersection:g,canDelete:A,lastMessageSender:y,animationType:f,withInterfaceAnimations:b,orderDiff:x,typingStatus:w,draft:C,wasTopicOpened:I,topics:S})=>{const{openThread:M,deleteTopic:k,focusLastMessage:T,setViewForumAsMessages:P}=(0,s.ko)(),L=(0,E.A)(),[B,R,F]=(0,z.A)(),[_,q,W]=(0,z.A)(),[Q,Y,Z]=(0,z.A)(),[X,ee,te]=(0,z.A)(),{isPinned:ne,isClosed:ae,notifySettings:se}=e,oe=Boolean(se.mutedUntil||void 0===se.mutedUntil&&r),re=(0,v.A)(()=>{Y(),R()}),ie=(0,v.A)(()=>{k({chatId:o.id,topicId:e.id})}),le=(0,v.A)(()=>{ee(),q()}),{renderSubtitle:ce,ref:de}=(0,j.A)({chat:o,chatId:n,lastMessage:c,draft:C,lastMessageSender:y,lastMessageTopic:e,observeIntersection:g,isTopic:!0,typingStatus:w,topics:S,statefulMediaContent:(0,l.FE)({story:u}),animationType:f,withInterfaceAnimations:b,orderDiff:x}),me=(0,v.A)(()=>{M({chatId:n,threadId:e.id,shouldReplaceHistory:!0}),P({chatId:n,isEnabled:!1}),p&&T()}),ue=function({topic:e,chat:t,isChatMuted:n,wasOpened:o,canDelete:r,handleDelete:i,handleMute:c}){const m=(0,E.A)();return(0,a.Kr)(()=>{const{isPinned:a,notifySettings:u,isClosed:p,id:h}=e,g=t.id,{editTopic:A,toggleTopicPinned:y,markTopicRead:f,updateTopicMutedState:v,openChatInNewTab:E}=(0,s.ko)(),b=(0,l.l1)(t,e),x=t.isCreator||(0,l.ub)(t,"manageTopics"),w=d.OS&&{title:"Open in new tab",icon:"open-in-new-tab",handler:()=>{E({chatId:t.id,threadId:h})}},C=e.unreadCount||!o?{title:m("MarkAsRead"),icon:"readchats",handler:()=>{f({chatId:g,topicId:h})}}:void 0,N=x?a?{title:m("UnpinFromTop"),icon:"unpin",handler:()=>y({chatId:g,topicId:h,isPinned:!1})}:{title:m("PinToTop"),icon:"pin",handler:()=>y({chatId:g,topicId:h,isPinned:!0})}:void 0,I=n&&void 0===u.mutedUntil||u.mutedUntil?{title:m("ChatList.Unmute"),icon:"unmute",handler:()=>v({chatId:g,topicId:h,isMuted:!1})}:{title:`${m("ChatList.Mute")}...`,icon:"mute",handler:c},S=b?p?{title:m("lng_forum_topic_reopen"),icon:"reopen-topic",handler:()=>A({chatId:g,topicId:h,isClosed:!1})}:{title:m("lng_forum_topic_close"),icon:"close-topic",handler:()=>A({chatId:g,topicId:h,isClosed:!0})}:void 0,M=r?{title:m("lng_forum_topic_delete"),icon:"delete",destructive:!0,handler:i}:void 0;return(0,U.oE)([w,N,C,I,S,M])},[e,t,n,o,m,r,i,c])}({topic:e,chat:o,isChatMuted:r,wasOpened:I,canDelete:A,handleDelete:re,handleMute:le});return a.Ay.createElement(K.A,{className:(0,m.A)("Fn34Vu_9","Chat",t&&"selected","chat-item-clickable"),onClick:me,style:i,href:d.OS?`#${(0,D.az)(n,"thread",e.id)}`:void 0,contextActions:ue,withPortalForMenu:!0,ref:de},a.Ay.createElement("div",{className:"info"},a.Ay.createElement("div",{className:"info-row"},a.Ay.createElement("div",{className:(0,m.A)("title")},a.Ay.createElement(J.A,{topic:e,className:"oXJl4tra",observeIntersection:g}),a.Ay.createElement("h3",{dir:"auto",className:"fullName"},(0,O.A)(e.title))),Boolean(se.mutedUntil)&&a.Ay.createElement(N.A,{name:"muted"}),a.Ay.createElement("div",{className:"separator"}),ae&&a.Ay.createElement(N.A,{name:"lock-badge",className:"MB7Gomjn"}),c&&a.Ay.createElement(V.A,{message:c,outgoingStatus:h})),a.Ay.createElement("div",{className:"subtitle"},ce(),a.Ay.createElement(G.A,{chat:o,isPinned:ne,isMuted:oe,topic:e,wasTopicOpened:I,topics:S}))),Q&&a.Ay.createElement(H.A,{isOpen:B,onClose:F,onCloseAnimationEnd:Z,confirmIsDestructive:!0,confirmHandler:ie,text:L("lng_forum_topic_delete_sure"),confirmLabel:L("Delete")}),X&&a.Ay.createElement($.A,{isOpen:_,onClose:W,onCloseAnimationEnd:te,chatId:n,topicId:e.id}))})),q=(0,a.ph)((0,s.EK)(e=>{const t=(0,c.nTw)(e).forumPanelChatId,n=t?(0,c.hds)(e,t):void 0,{chatId:a,threadId:s}=(0,c.Xf0)(e)||{},o=t?(0,c.xyP)(e,t):void 0;return{chat:n,currentTopicId:t===a?Number(s):void 0,withInterfaceAnimations:(0,c.PKK)(e),topicsInfo:o}},e=>(0,c.clw)(e))(({chat:e,currentTopicId:t,isOpen:n,isHidden:c,topicsInfo:T,onTopicSearch:P,onCloseAnimationEnd:L,onOpenAnimationStart:B,withInterfaceAnimations:F})=>{const{closeForumPanel:D,openChatWithInfo:O,loadTopics:z}=(0,s.ko)(),j=(0,a.li)(),U=(0,a.li)(),V=(0,a.li)(),{isMobile:J}=(0,g.Ay)(),H=e?.id;(0,a.vJ)(()=>{H&&!T&&z({chatId:H})},[T,H]);const[K,$]=(0,a.J0)(!1),G=(0,E.A)(),q=(0,v.A)(()=>{D()});(0,a.vJ)(()=>{F||n||L?.()},[F,n,L]);const W=(0,v.A)(()=>{e&&O({id:e.id,shouldReplaceHistory:!0})}),{observe:Q}=(0,f.BL)({rootRef:U,throttleMs:200});(0,f.mv)(V,Q,({isIntersecting:e})=>{$(!e)});const Y=(0,a.Kr)(()=>T?(0,l.CO)(Object.values(T.topicsById),T.orderedPinnedTopicIds).map(({id:e})=>e):[],[T]),{orderDiffById:Z,getAnimationType:X}=(0,x.A)(Y,e?.id),[ee,te]=(0,y.A)(()=>{e&&z({chatId:e.id})},Y,!T?.totalCount||Y.length>=T.totalCount,r.iIc),ne=(0,a.li)(!1),ae=n&&!c,se=(0,b.A)(ae);se!==ae&&(ne.current=!1),(0,A.A)({isActive:ae,onBack:q}),(0,a.vJ)(()=>ae?(0,u.A)(q):void 0,[q,ae]),(0,a.vJ)(()=>{se!==ae&&(0,i.Uz)(()=>{if(!j.current)return;const e=(0,a.VK)();(0,h.j)(j.current,e),B?.(),ae?(ne.current=!0,j.current.style.transform="none"):(ne.current=!1,j.current.style.transform="")})},[ae,B,se]),(0,a.vJ)(()=>{if(d.TF)return(0,p.wJ)(j.current,{selectorToPreventScroll:".chat-list",onSwipe:(e,t)=>t===(G.isRtl?p.ez.Left:p.ez.Right)&&(D(),!0)})},[D,G.isRtl]);const oe=void 0===T;return a.Ay.createElement("div",{ref:j,className:(0,m.A)("MlF2n1nb",K&&"SZ24u3cn",G.isRtl&&"Xs2y1fCE",!F&&"kmDMv6D8"),onTransitionEnd:n?void 0:L},a.Ay.createElement("div",{id:"TopicListHeader",className:"left-header"},a.Ay.createElement(S.A,{round:!0,size:"smaller",color:"translucent",onClick:q,ariaLabel:G("Close")},a.Ay.createElement(N.A,{name:"close"})),e&&a.Ay.createElement(C.A,{noAvatar:!0,className:"Sf633zAP",chatId:e.id,onClick:W}),e&&a.Ay.createElement(I.A,{chatId:e.id,threadId:o.l3,messageListType:"thread",canExpandActions:!1,isForForum:!0,isMobile:J,onTopicSearch:P})),e&&a.Ay.createElement(w.A,{chatId:e.id}),a.Ay.createElement("div",{className:"hGeb3TQJ"}),a.Ay.createElement(M.A,{className:"chat-list custom-scroll",ref:U,items:ee,preloadBackwards:r.iIc,withAbsolutePositioning:!0,maxHeight:(Y?.length||0)*r.HGU,onLoadMore:te,sensitiveArea:r.C$_,beforeChildren:a.Ay.createElement("div",{ref:V,className:"ERz3fcar"})},Boolean(ee?.length)&&function(){const n=Y.indexOf(ee[0]);return ee?.map((s,o)=>a.Ay.createElement(_,{key:s,chatId:e.id,topic:T.topicsById[s],style:`top: ${(n+o)*r.HGU}px;`,isSelected:t===s,observeIntersection:Q,animationType:X(s),orderDiff:Z[s]}))}(),oe&&!ee?.length&&a.Ay.createElement(k.A,{key:"loading"})),!oe&&1===ee?.length&&ee[0]===r.HxB&&a.Ay.createElement(R,{chatId:H}))}))},90254:(e,t,n)=>{"use strict";n.d(t,{A:()=>j});var a=n(84051),s=n(13439),o=n(89925),r=n(90709),i=n(60919),l=n(30708),c=n(96454),d=n(87357),m=n(50442),u=n(79824),p=n(31460),h=n(4961),g=n(54699),A=n(39351),y=n(17712),f=n(59030),v=n(73767),E=n(23174),b=n(58554),x=n(41036),w=n(21849),C=n(34431),N=n(9716),I=n(14242),S=n(35049),M=n(43874),k=n(45470),T=n(37661),P=n(62587),L=n(83057),B=n(65843),R=n(57474),F=n(54746);const D=(0,a.ph)(({chat:e,user:t,photo:n,isSavedMessages:s,isSavedDialog:o,canPlayVideo:i,onClick:l})=>{const m=(0,a.li)(),u=(0,f.A)(),{isMobile:p}=(0,M.Ay)(),g=t&&(0,r.PL)(t),A=e&&(0,r.kE)(e.id),y=e&&(0,r.Qe)(e.id),v=t||e,E=v&&!s&&!g&&!A&&!y,{isVideo:b}=n||{},x=(!n||n.id===v.avatarPhotoId)&&(0,r.cP)(v,"normal"),w=E&&n&&!x&&(0,r.rI)(n,"pictogram"),C=(0,P.A)(w||x),D=E&&n&&!b&&(0,r.mU)(n),O=(0,P.A)(D),z=E&&n&&b&&(0,r.Pg)(n),j=(0,P.A)(z)||O,[U,V]=(0,T.A)(),J=Boolean(j&&(!b||U)),H=(0,L.A)(J),K=E&&!J&&!C&&n?.thumbnail?.dataUri,$=(0,k.A)(n?.thumbnail?.dataUri,!K,p&&!c.QH),G=n||C||K;(0,a.vJ)(()=>{m.current&&!i&&(m.current.currentTime=0)},[i]);const _=(0,a.Kr)(()=>s?o?"my-notes":"avatar-saved-messages":g?"avatar-deleted-account":A?"reply-filled":y?"author-hidden":void 0,[y,g,o,A,s]);let q;if(_)q=a.Ay.createElement(F.A,{name:_,role:"img"});else if(G)q=a.Ay.createElement(a.Ay.Fragment,null,K?a.Ay.createElement("canvas",{ref:$,className:"thumb"}):a.Ay.createElement("img",{src:C,draggable:!1,className:"thumb",alt:""}),n&&(b?a.Ay.createElement(B.A,{canPlay:i,ref:m,src:j,className:(0,d.A)("avatar-media",H),muted:!0,disablePictureInPicture:!0,loop:!0,playsInline:!0,onReady:V}):a.Ay.createElement("img",{src:j,className:(0,d.A)("avatar-media",H),alt:""})));else if(t){const e=(0,r.Yg)(t);q=e?(0,I.Qh)(e,2):void 0}else if(e){const t=(0,r.Js)(u,e);q=t&&(0,I.Qh)(t,(0,N.L8)(e.id)?2:1)}else q=a.Ay.createElement("div",{className:"spinner-wrapper"},a.Ay.createElement(R.A,{color:"white"}));const W=(0,d.A)("ProfilePhoto",(0,S.y)(v),s&&"saved-messages",y&&"anonymous-forwards",g&&"deleted-account",A&&"replies-bot-account",!s&&!G&&"no-photo");return a.Ay.createElement("div",{className:W,onClick:G?l:void 0},"string"==typeof q?(0,h.A)(q,["hq_emoji"]):q)});var O=n(38102),z=n(24845);const j=(0,a.ph)((0,s.EK)((e,{peerId:t})=>{const n=(0,i.mBe)(e,t),a=(0,i.K0y)(e,t),s=(0,i.hds)(e,t),o=(0,i.IVq)(e,t),{mediaIndex:r,chatId:c}=(0,i.nTw)(e).mediaViewer,d=s?.isForum,{threadId:m}=(0,i.Xf0)(e)||{},u=d&&m?(0,i.S0q)(e,t,m):void 0,{animationLevel:p}=(0,l.l)(e),h=(n||s)?.emojiStatus;return{user:n,userStatus:a,chat:s,mediaIndex:r,avatarOwnerId:c,animationLevel:p,emojiStatusSticker:h?e.customEmojis.byId[h.documentId]:void 0,emojiStatusSlug:"collectible"===h?.type?h.slug:void 0,profilePhotos:o,...u&&{topic:u,messagesCount:(0,i.QbG)(e,t,m)}}})(({forceShowSelf:e,canPlayVideo:t,user:n,userStatus:i,chat:l,mediaIndex:N,avatarOwnerId:I,topic:S,messagesCount:M,animationLevel:k,emojiStatusSticker:T,emojiStatusSlug:P,profilePhotos:L,peerId:B,isForMonoforum:R})=>{const{openMediaViewer:F,openPremiumModal:j,openStickerSet:U,openPrivacySettingsNoticeModal:V,loadMoreProfilePhotos:J,openUniqueGiftBySlug:H}=(0,s.ko)(),K=(0,f.A)(),$=(0,A.A)();(0,g.A)(n?6e4:void 0);const G=L?.photos||u.p,_=(0,v.A)(N),q=(0,v.A)(I),[W,Q]=(0,a.J0)(!0),[Y,Z]=(0,a.J0)(0),X=G.length<=1||0===Y,ee=G.length<=1||Y===G.length-1;(0,a.vJ)(()=>{G.length-Y<=3&&J({peerId:B})},[Y,B,G.length]),(0,a.vJ)(()=>{q&&void 0!==_&&void 0===N&&(Q(!1),Z(_))},[N,_,q]),(0,a.vJ)(()=>{Y>G.length&&(Q(!1),Z(Math.max(0,G.length-1)))},[Y,G.length]),function(e,t){(0,a.vJ)(()=>{e.slice(t,t+4).forEach(e=>{const t=(0,r.mU)(e);b.Ih(t)||b.hd(t,E.qZ.BlobUrl)})},[t,e])}(G,Y);const te=(0,y.A)(()=>{F({isAvatarView:!0,chatId:B,mediaIndex:Y,origin:e?o.TQ.SettingsAvatar:o.TQ.ProfileAvatar})}),ne=(0,y.A)(()=>{P?H({slug:P}):B?j({fromUserId:B}):U({stickerSetInfo:T.stickerSetInfo})}),ae=(0,y.A)(()=>{X||(Q(!0),Z(Y-1))}),se=(0,y.A)(()=>{ee||(Q(!0),Z(Y+1))}),oe=(0,y.A)(()=>{V({chatId:l.id,isReadDate:!1})});if((0,a.vJ)(()=>{const e=document.querySelector(`.${z.A.photoWrapper}`);if(e)return(0,m.wJ)(e,{selectorToPreventScroll:".Profile, .settings-content",onSwipe:c.TF?(e,t)=>t===m.ez.Right?(ae(),!0):t===m.ez.Left&&(se(),!0):void 0})},[se,ae]),n||l)return S?a.Ay.createElement("div",{className:z.A.topicContainer},a.Ay.createElement(O.A,{topic:S,size:120,className:z.A.topicIcon,letterClassName:z.A.topicIconTitle,noLoopLimit:!0}),a.Ay.createElement("h3",{className:z.A.topicTitle,dir:K.isRtl?"rtl":void 0},(0,h.A)(S.title)),a.Ay.createElement("p",{className:z.A.topicMessagesCounter},M?K("Chat.Title.Topic",M,"i"):K("lng_forum_no_messages"))):a.Ay.createElement("div",{className:(0,d.A)("ProfileInfo"),dir:K.isRtl?"rtl":void 0},a.Ay.createElement("div",{className:z.A.photoWrapper},function(){const e=Math.max(G.length,L?.count||0);if(!G||e<=1)return;const t=Array.from({length:Math.min(e,30)}),n=Y>=30?29:Y;return a.Ay.createElement("div",{className:z.A.photoDashes},t.map((e,t)=>a.Ay.createElement("span",{className:(0,d.A)(z.A.photoDash,t===n&&z.A.photoDash_current)})))}(),!e&&L?.personalPhoto&&a.Ay.createElement("div",{className:(0,d.A)(z.A.fallbackPhoto,X&&z.A.fallbackPhotoVisible)},a.Ay.createElement("div",{className:z.A.fallbackPhotoContents},K(L.personalPhoto.isVideo?"UserInfo.CustomVideo":"UserInfo.CustomPhoto"))),e&&L?.fallbackPhoto&&a.Ay.createElement("div",{className:(0,d.A)(z.A.fallbackPhoto,(X||ee)&&z.A.fallbackPhotoVisible)},a.Ay.createElement("div",{className:z.A.fallbackPhotoContents,onClick:function(){X&&(Q(!0),Z(G.length-1))}},!ee&&a.Ay.createElement(w.A,{photo:L.fallbackPhoto,className:z.A.fallbackPhotoAvatar,size:"mini"}),K(L.fallbackPhoto.isVideo?"UserInfo.PublicVideo":"UserInfo.PublicPhoto"))),a.Ay.createElement(x.Ay,{activeKey:Y,name:(0,p.P)("slide",k,!W,K.isRtl)},re),!X&&a.Ay.createElement("button",{type:"button",dir:K.isRtl?"rtl":void 0,className:(0,d.A)(z.A.navigation,z.A.navigation_prev),"aria-label":K("AccDescrPrevious"),onClick:ae}),!ee&&a.Ay.createElement("button",{type:"button",dir:K.isRtl?"rtl":void 0,className:(0,d.A)(z.A.navigation,z.A.navigation_next),"aria-label":K("Next"),onClick:se})),a.Ay.createElement("div",{className:z.A.info,dir:K.isRtl?"rtl":"auto"},(n||l)&&a.Ay.createElement(C.A,{peer:n||l,withEmojiStatus:!0,emojiStatusSize:24,onEmojiStatusClick:ne,noLoopLimit:!0,canCopyTitle:!0}),function(){const e=(0,r.Qe)(B),t=(0,r.DX)(B);if(!e&&!t)return R?a.Ay.createElement("span",{className:(0,d.A)(z.A.status,"status"),dir:"auto"},$("MonoforumStatus")):n?a.Ay.createElement("div",{className:(0,d.A)(z.A.status,"status",(0,r.PF)(n,i)&&"online")},a.Ay.createElement("span",{className:z.A.userStatus,dir:"auto"},(0,r.CD)(K,n,i)),i?.isReadDateRestrictedByMe&&a.Ay.createElement("span",{className:z.A.getStatus,onClick:oe},a.Ay.createElement("span",null,K("StatusHiddenShow")))):a.Ay.createElement("span",{className:(0,d.A)(z.A.status,"status"),dir:"auto"},(0,r.WX)(l)?K("Subscribers",l.membersCount??0,"i"):K("Members",l.membersCount??0,"i"))}()));function re(e){const s=G.length>0?G[Y]:void 0;return a.Ay.createElement(D,{key:Y,user:n,chat:l,photo:s,canPlayVideo:Boolean(e&&t),onClick:te})}}))},90423:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>i,j9:()=>d,zk:()=>l});var a=n(84051),s=n(31791),o=n(96454);const r=c();function i(e,t,n){const[s,i]=(0,a.J0)(Boolean(r&&document[r]));return(0,a.Nf)(()=>{const a=e.current,s=()=>{const e=Boolean(r&&document[r]);i(e),e?n?.(!1):t?.(!1),a instanceof HTMLVideoElement&&(a.controls=e)},o=()=>{i(!0),n&&n(!0)},l=()=>{i(!1),t&&t(!1)};return document.addEventListener("fullscreenchange",s,!1),document.addEventListener("webkitfullscreenchange",s,!1),document.addEventListener("mozfullscreenchange",s,!1),a&&(a.addEventListener("webkitbeginfullscreen",o,!1),a.addEventListener("webkitendfullscreen",l,!1)),()=>{document.removeEventListener("fullscreenchange",s,!1),document.removeEventListener("webkitfullscreenchange",s,!1),document.removeEventListener("mozfullscreenchange",s,!1),a&&(a.removeEventListener("webkitbeginfullscreen",o,!1),a.removeEventListener("webkitendfullscreen",l,!1))}},[]),r||o.pz?[s,()=>{var t;e.current&&(r||o.pz)&&!s&&((t=e.current).requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.webkitEnterFullscreen?t.webkitEnterFullscreen():t.mozRequestFullScreen&&t.mozRequestFullScreen(),i(!0))},()=>{e.current&&(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen(),i(!1))}]:[!1]}const l=()=>{const[e,t]=(0,a.J0)(!1);return(0,a.vJ)(()=>{const e=()=>{t(d())},n=window.electron?.on(s.v.FULLSCREEN_CHANGE,t);return window.electron?.isFullscreen().then(t),document.addEventListener("fullscreenchange",e,!1),document.addEventListener("webkitfullscreenchange",e,!1),document.addEventListener("mozfullscreenchange",e,!1),()=>{n?.(),document.removeEventListener("fullscreenchange",e,!1),document.removeEventListener("webkitfullscreenchange",e,!1),document.removeEventListener("mozfullscreenchange",e,!1)}},[]),e};function c(){return void 0!==document.fullscreenElement?"fullscreenElement":void 0!==document.mozFullScreenElement?"mozFullScreenElement":void 0!==document.webkitFullscreenElement?"webkitFullscreenElement":""}function d(){const e=c();return Boolean(e&&document[e])}},91930:(e,t,n)=>{"use strict";n.d(t,{A:()=>L,b:()=>P});var a=n(84051),s=n(31481),o=n(90709),r=n(3544),i=n(70636),l=n(87357),c=n(17663),d=n(9716),m=n(91034),u=n(48775),p=n(76023),h=n(4961),g=n(18501),A=n(35749),y=n(2338),f=n(11217),v=n(5912),E=n(39351),b=n(62587),x=n(59030),w=n(64154),C=n(42452),N=n(54746),I=n(27860),S=n(18653),M=n(86070);const k=" ",T=({className:e,message:t,replyInfo:n,suggestedPostInfo:m,sender:T,senderChat:P,forwardSender:L,composerForwardSenders:B,title:R,customText:F,isProtected:D,isInComposer:O,noUserColors:z,chatTranslations:j,requestedChatTranslationLanguage:U,isMediaNsfw:V,observeIntersectionForLoading:J,observeIntersectionForPlaying:H,onClick:K})=>{const $=(0,a.li)(),G=(0,v.Vz)($,J),_=(0,a.Kr)(()=>{const e="message"===n?.type&&n.replyMedia||t?.content;if(e)return{content:e}},[t,n]),q=_?.content?.video?.isGif?_.content.video:void 0,W=Boolean(q&&!q.previewPhotoSizes?.length),Q=(0,A.A)(_,W?"full":"pictogram"),Y=(0,b.A)(Q,!G),Z=(0,y.A)(_),X=Boolean(_&&(0,o.lk)(_)),ee=Boolean(_&&(0,o.y2)(_))||V,te=Boolean("message"===n?.type&&n.isQuote),ne="message"===n?.type?n.replyFrom:void 0,ae=t&&(0,o.ZR)(t),{translatedText:se}=(0,w.A)(j,t?.chatId,ae?t?.id:void 0,U),oe=(0,x.A)(),re=(0,E.A)(),ie=T?(0,i.F9)(oe,T):ne?.hiddenUserName||t?.forwardInfo?.hiddenUserName,le=(0,a.Kr)(()=>{if(!B)return;const e=B.map(e=>(0,i.F9)(re,e)).filter(Boolean);return re.conjunction(e)},[B,re]),ce=P?(0,i.F9)(oe,P):void 0,de=L?(0,i.F9)(oe,L):t?.forwardInfo?.hiddenUserName,me=T&&T.id===L?.id,{handleClick:ue,handleMouseDown:pe}=(0,f.Q)(K);return a.Ay.createElement(M.A,{peer:T,emojiIconClassName:"EmbeddedMessage--background-icons",ref:$,shouldReset:!0,noUserColors:z,className:(0,l.A)("EmbeddedMessage",e,te&&"is-quote",Z&&"with-thumb","no-selection",B&&"is-input-forward",m&&"is-suggested-post"),dir:re.isRtl?"rtl":void 0,onClick:ue,onMouseDown:pe},a.Ay.createElement("div",{className:"hover-effect"}),a.Ay.createElement(C.A,null),Z&&function(e,t,n,s,o,r){const{width:i,height:c}=(0,p.mr)(),d=t||e,m=n&&t;return a.Ay.createElement("div",{className:(0,l.A)("embedded-thumb",s&&"round")},!r&&!m&&a.Ay.createElement("img",{src:d,width:i,height:c,alt:"",className:"pictogram",draggable:!1}),!r&&m&&a.Ay.createElement("video",{src:t,width:i,height:c,playsInline:!0,disablePictureInPicture:!0,className:"pictogram"}),a.Ay.createElement(I.A,{thumbDataUri:m?e:d,isVisible:Boolean(r),width:i,height:c}),o&&a.Ay.createElement("span",{className:"protector"}))}(Z,Y,W,X,D,ee),a.Ay.createElement("div",{className:"message-text"},a.Ay.createElement("p",{className:(0,l.A)("embedded-text-wrapper",te&&"multiline")},function(){if(m){if(!m?.price?.amount&&!m.scheduleDate)return re("ComposerEmbeddedMessageSuggestedPostDescription");const e=m.price?m.price.currency===s.ykW?(0,u.Ms)(re,m.price.amount,{className:"suggested-price-ton-icon",shouldConvertFromNanos:!0}):(0,u.U2)(re,m.price.amount,{className:"suggested-price-star-icon"}):"",t=m.scheduleDate?(0,c.e0)(m.scheduleDate,re,oe):"";return e&&!t?a.Ay.createElement("span",{className:"suggested-post-price-wrapper"},re("TitleSuggestedPostAmountForAnyTime",{amount:e},{withNodes:!0,withMarkdown:!0})):a.Ay.createElement("span",{className:"suggested-post-price-wrapper"},e,t?` • ${t}`:"")}return"message"===n?.type&&n.quoteText?(0,g.fd)({text:n.quoteText.text,entities:n.quoteText.entities,asPreview:!0,emojiSize:17}):t?a.Ay.createElement(S.A,{message:t,noEmoji:Boolean(Z),translatedText:se,observeIntersectionForLoading:J,observeIntersectionForPlaying:H,emojiSize:17}):F||function(e){if(!e||e.content.text)return k;const t=(0,r.GG)(oe,e.content,{});return t&&t!==s.bVP?a.Ay.createElement("span",null,(0,h.A)(t)):k}(_)||k}()),a.Ay.createElement("div",{className:"message-title"},function(){if(R)return(0,h.A)(R);if(m&&n)return re("TitleSuggestedChanges");if(m)return re("ComposerEmbeddedMessageSuggestedPostTitle");if(!ie&&!le)return k;let e;P&&((0,o.WX)(P)&&(e="channel-filled"),(0,o.YE)(P)&&(e="group-filled"));const t=O&&Boolean(n&&"quoteText"in n&&n?.quoteText);return a.Ay.createElement("span",{className:"embedded-sender-wrapper"},(!P||!!(0,d.L8)(P?.id)||P.id!==T?.id)&&a.Ay.createElement("span",{className:"embedded-sender"},!B&&ie&&(0,h.A)(t?oe("ReplyToQuote",ie):ie),le&&(0,h.A)(re("ComposerTitleForwardFrom",{users:le},{withNodes:!0,withMarkdown:!0}))),e&&a.Ay.createElement(N.A,{name:e,className:"embedded-chat-icon"}),e&&ce&&a.Ay.createElement("span",{className:"embedded-sender-chat"},(0,h.A)(ce)))}(),de&&!me&&a.Ay.createElement("span",{className:"embedded-forward-sender-wrapper"},a.Ay.createElement(N.A,{name:L?"share-filled":"forward",className:"embedded-origin-icon"}),a.Ay.createElement("span",{className:"forward-sender-title"},(0,h.A)(de))))))},P=(0,m.A)(T),L=T},92111:(e,t,n)=>{"use strict";n.d(t,{A:()=>y});var a=n(84051),s=n(13439),o=n(23174),r=n(90709),i=n(60919),l=n(39761),c=n(87679),d=n(58554),m=n(95704),u=n(37836),p=n(46051),h=n(66991);const g={},A=(0,u.v7)(1e3),y=function(e,t){(0,a.vJ)(()=>{if(void 0===e)return;(Array.isArray(e)?e:[e]).forEach(e=>{const n=t||(0,s.mS)().stories.byPeerId[e]?.orderedIds?.[0];n&&(async e=>{await A,e.forEach(({hash:e,format:t,isStream:n})=>{n?async function(e){const t=(0,m.h)((0,d.RB)(e));let n=0;for await(const e of t)if(n+=e.byteLength,n>=2097152)break}(e):d.hd(e,t).then(e=>{e&&(t===o.qZ.Progressive&&function(e){const t=document.head,n=document.createElement("video");n.preload="auto",n.src=e,n.muted=!0,n.autoplay=!0,n.disableRemotePlayback=!0,n.style.display="none",t.appendChild(n),n.load(),setTimeout(()=>{(0,l.A)(n),t.removeChild(n)},1e3)}(e),t===o.qZ.BlobUrl&&(0,c.NN)(e))})})})(function(e,t){const n=(0,i._bp)((0,s.mS)(),e);if(!n||!n.orderedIds?.length)return[];const a=function(e,t){const n=e.indexOf(t),a=Math.max(n-5,0),s=Math.min(n+5,e.length);return e.slice(a,s)}(n.orderedIds,t),l=[];return a.forEach(t=>{if(g[e]?.has(t))return;const a=n.byId[t];if(!a||!("content"in a))return;const s=Boolean(a.content.video);l.push({hash:(0,r.EN)(a,"full"),format:s?o.qZ.Progressive:o.qZ.BlobUrl,isStream:s&&(0,h.c)(p.G)}),l.push({hash:(0,r.EN)(a),format:o.qZ.BlobUrl}),a.content.altVideos&&l.push({hash:(0,r.EN)(a,"full",!0),format:o.qZ.Progressive}),g[e]=(g[e]||new Set).add(t)}),l}(e,n))})},[t,e])}},93809:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(84051),s=n(30857),o=n(35297);function r(e,t){const n=void 0===t,r=(0,a.li)(n),i=(0,a.li)(),l=(0,s.A)();return(0,o.A)(()=>{n||(r.current=!1,i.current&&(clearTimeout(i.current),i.current=void 0))},e),(0,a.vJ)(()=>{if(n||r.current)return;const e=()=>{r.current=!0,l()};t>0?i.current=window.setTimeout(e,t):e()},e),r.current}},95362:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var a=n(37836);const s=10,o=1e3;let r=[],i=!1;function l(e,t){r.push({url:e,filename:t}),i||(i=!0,setTimeout(async()=>{await async function(){let e=0;for(const t of r)c(t),e++,e===s&&(await(0,a.v7)(o),e=0);r=[]}(),i=!1},o))}function c({url:e,filename:t}){const n=document.createElement("a");n.href=e,n.target="_blank",n.rel="noopener noreferrer",n.download=t;try{n.click()}catch(e){console.error(e)}}},95704:(e,t,n)=>{"use strict";n.d(t,{h:()=>d});var a=n(23174),s=n(24021);const o=262144,r=5242879,i=new Map,l=new Map,c=new Map;async function*d(e,t=0,n=o){const d=e.match(/fileSize=(\d+)/);let m;for(m=d?d&&Number(d[1]):l.get(e);;){if(m&&t>=m)return;let o=t+n-1;m&&o>m&&(o=m-1);const d=`${e}:${t}-${o}`;let u=i.get(d);if(!u){let n=c.get(d);n||(n=(0,s.px)("downloadMedia",{mediaFormat:a.qZ.Progressive,url:e,start:t,end:o}),c.set(d,n));const p=await n.finally(()=>{c.delete(d)});if(!p?.arrayBuffer)return;p.fullSize&&!m&&(m=p.fullSize,l.set(e,p.fullSize)),u=p.arrayBuffer,o<=r&&i.set(d,p.arrayBuffer)}yield u,t=o+1}}},97046:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(84051),s=n(80089),o=n(80464);const r=e=>{const{isOpen:t}=e,n=(0,o.A)(s.ar.Extra,"MuteChatModal",!t);return n?a.Ay.createElement(n,e):void 0}},97967:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(84051),s=n(80089),o=n(80464);const r=e=>{const{isOpen:t}=e,n=(0,o.A)(s.ar.Extra,"ChatFolderModal",!t);return n?a.Ay.createElement(n,e):void 0}},98196:()=>{},99299:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var a=n(96540);class s extends a.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,t){console.error("Error caught by ErrorBoundary:",e,t)}render(){const{hasError:e}=this.state,{children:t}=this.props;return e?null:t}}const o=s}}]);
//# sourceMappingURL=5529.c0dd280c2b513e535bfc.js.map