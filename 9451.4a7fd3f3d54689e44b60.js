"use strict";(self.webpackChunkTelyAI=self.webpackChunkTelyAI||[]).push([[9451],{3178:(e,t,a)=>{a.d(t,{A:()=>A});var n=a(84051),s=a(31481),r=a(58443),i=a(14737),o=a(43874),l=a(37661),c=a(18104);const d=[0,50],m=[0,20],u=[20,0],A=(0,n.ph)(({isPasswordVisible:e,isBig:t})=>{const[a,A]=(0,l.A)(!1),[h,y]=(0,l.A)(!1),{isMobile:p}=(0,o.Ay)(),g=p?s.UyP:s.H6l;(0,i.A)(y,2e3);const v=(0,n.hb)(A,[A]);return n.Ay.createElement("div",{id:"monkey",className:t?"big":""},!a&&n.Ay.createElement("div",{className:"monkey-preview"}),n.Ay.createElement(c.A,{size:t?s.r2x:g,className:h?"hidden":"shown",tgsUrl:r.w.MonkeyClose,playSegment:d,noLoop:!0,onLoad:v}),n.Ay.createElement(c.A,{size:t?s.r2x:g,className:h?"shown":"hidden",tgsUrl:r.w.MonkeyPeek,playSegment:e?m:u,noLoop:!0}))})},69687:(e,t,a)=>{a.r(t),a.d(t,{AIKnowledge:()=>th,AITranslate:()=>ch,AboutAdsModal:()=>Kl,AboutMonetizationModal:()=>jl,AgeVerificationModal:()=>tl,ArchivedChats:()=>Ch,AttachBotInstallModal:()=>lr,AttachBotRecipientPicker:()=>Hn,AttachmentModal:()=>Py,BoostModal:()=>$o,BotCommandMenu:()=>op,BotTrustModal:()=>or,CalendarModal:()=>cs,ChatCommandTooltip:()=>ip,ChatFolderModal:()=>Sh,ChatInviteModal:()=>ml,ChatLanguageModal:()=>Fc,ChatlistModal:()=>ll,CollectibleInfoModal:()=>Uc,ContactList:()=>dh,ContextMenuContainer:()=>Nh.A,CountryPickerModal:()=>ki,CreateTopic:()=>Fg,CreditsModal:()=>fl,CustomEmojiSetsModal:()=>Th,CustomEmojiTooltip:()=>dp,CustomSendMenu:()=>up,DeleteAccountModal:()=>Xo,DeleteFolderDialog:()=>cr,DeleteMessageModal:()=>bc,Dialogs:()=>Wn,DraftRecipientPicker:()=>zn,DropArea:()=>Ap.A,EditTopic:()=>Vg,EmojiInteractionAnimation:()=>Rc,EmojiStatusAccessModal:()=>Wl,EmojiTooltip:()=>Ep,ForwardRecipientPicker:()=>jn,FrozenAccountModal:()=>iE,GifSearch:()=>xp,GiftCodeModal:()=>Yo,GiveawayModal:()=>Yi,HeaderMenuContainer:()=>Rh,HistoryCalendar:()=>ds,InlineBotTooltip:()=>Np,InviteCodeModal:()=>Bl,InviteFriendsModal:()=>Ml,InviteViaLinkModal:()=>aE,LeftSearch:()=>vm,LocationAccessModal:()=>Ql,Management:()=>Ev,MapModal:()=>ts,MediaViewer:()=>Rt,MentionTooltip:()=>Cy,MessageSelectToolbar:()=>wc,MessageStatistics:()=>hg,MiddleSearch:()=>jh,MinimizedWebAppModal:()=>ws,MuteChatModal:()=>wh,NewChat:()=>hh,NewContactModal:()=>us,Notifications:()=>Yn,OneTimeMediaModal:()=>sE,PayPackageModal:()=>Dl,PaymentModal:()=>Qv,PinMessageModal:()=>Cc,PollModal:()=>My,PollResults:()=>Sg,PremiumLimitReachedModal:()=>no,PremiumMainModal:()=>vi,PreparedMessageModal:()=>sc,PrivacySettingsNoticeModal:()=>Bc,ReactionPicker:()=>Zh,ReactorListModal:()=>Lc,ReceiptModal:()=>Xv,ReportAdModal:()=>Zl,ReportModal:()=>tc,SafeLinkModal:()=>Xn,SeenByModal:()=>Nc,SendAsMenu:()=>Ip,Settings:()=>KA,SharePreparedMessageModal:()=>oc,SponsoredContextMenuContainer:()=>_l.A,Statistics:()=>rg,StatusPickerMenu:()=>Uo,StickerSearch:()=>Tp,StickerSetModal:()=>Ph,StickerTooltip:()=>lp,StoryStatistics:()=>fg,StoryViewer:()=>Tn,SuggestMessageModal:()=>dc,SuggestedPostApprovalModal:()=>uc,SuggestedStatusModal:()=>Ko,SymbolMenu:()=>np,TextFormatter:()=>gp,ToDoListModal:()=>xy,UnpinAllMessagesModal:()=>Sc,UrlAuthModal:()=>ns,VerificationMonetizationModal:()=>$l,WebAppModal:()=>ir,WebAppsCloseConfirmationModal:()=>rE});var n=a(84051),s=a(13439),r=a(89925),i=a(31481),o=a(66644),l=a(90709),c=a(60919),d=a(53827),m=a(11778),u=a(14680),A=a(9716),h=a(76023),y=a(49086);function p({message:e,avatarOwner:t,profilePhotos:a,standaloneMedia:n,mediaIndex:s,sponsoredMessage:r}){return t&&a?{type:"avatar",avatarOwner:t,profilePhotos:a,mediaIndex:s}:n?{type:"standalone",media:n,mediaIndex:s}:e?{type:"message",message:e,mediaIndex:s}:r?{type:"sponsoredMessage",message:r,mediaIndex:s}:void 0}function g(e,t){if(!t)return;if("standalone"===t.type)return{media:t.media[t.mediaIndex],isSingle:1===t.media.length};if("avatar"===t.type){const e=t.profilePhotos?.photos[t.mediaIndex];return e?{media:e}:void 0}const{action:a,document:n,photo:s,video:r,paidMedia:i}=(0,l.r_)(t.message);if("chatEditPhoto"===a?.type||"suggestProfilePhoto"===a?.type)return{media:a.photo,isSingle:!0};if(n&&((0,l.Ml)(n)||(0,l.hr)(n)))return{media:n};const o=(0,c.Pn$)(e,t.message);if("full"===o?.webpageType){const{photo:e,video:t,document:a}=o,n=a&&((0,l.Ml)(a)||(0,l.hr)(a)),s=t||(n?a:void 0)||e;if(s)return{media:s,isSingle:!0}}if(i){const e=i.extendedMedia[t.mediaIndex||0];if(!("mediaType"in e)){const{photo:t,video:a}=e;return{media:t||a}}}const d=r||s;return d?{media:d,isSingle:r?.isGif}:void 0}var v=a(19822),E=a(96454),f=a(83868),b=a(16460),C=a(41512),S=a(43503);function k(e,t){const a=document.createElement("div");a.classList.add("ghost");const n=new Image;if(n.draggable=!1,n.oncontextmenu=f.A,"string"==typeof e?n.src=e:e instanceof HTMLVideoElement?n.src=e.poster:n.src=e.src,a.appendChild(n),t===r.TQ.ProfileAvatar||t===r.TQ.SettingsAvatar){a.classList.add("ProfileInfo"),t===r.TQ.SettingsAvatar&&a.classList.add("self");const e=document.querySelector(t===r.TQ.ProfileAvatar?"#RightColumn .ProfileInfo .info":"#Settings .ProfileInfo .info");e&&a.appendChild(e.cloneNode(!0))}return a}function w(e,t,a){let n,s;switch(e){case r.TQ.Album:case r.TQ.ScheduledAlbum:n=`.Transition_slide-active > .MessageList #album-media-${(0,l.GZ)(t.id,a)}`,s=".full-media";break;case r.TQ.PreviewMedia:n=`#preview-media${a}`,s="img";break;case r.TQ.SharedMedia:n=`#shared-media${(0,l.GZ)(t.id,a)}`,s="img";break;case r.TQ.SearchResult:n=`#search-media${(0,l.GZ)(t.id,a)}`,s="img";break;case r.TQ.MiddleHeaderAvatar:n=".MiddleHeader .Transition_slide-active .ChatInfo .Avatar",s=".avatar-media";break;case r.TQ.SettingsAvatar:n="#Settings .ProfileInfo .Transition_slide-active .ProfilePhoto",s=".avatar-media";break;case r.TQ.ProfileAvatar:n="#RightColumn .ProfileInfo .Transition_slide-active .ProfilePhoto",s=".avatar-media";break;case r.TQ.ChannelAvatar:case r.TQ.SuggestedAvatar:n=`.Transition_slide-active > .MessageList #${(0,l.GZ)(t.id,a)}`,s=".Avatar img";break;case r.TQ.StarsTransaction:n=".transaction-media-preview",s=0===a?`.stars-transaction-media-${a} :is(img, video)`:void 0;break;case r.TQ.SponsoredMessage:n=".Transition_slide-active > .MessageList .sponsored-media-preview",s=`${i.KFG} .full-media,${i.KFG} .thumbnail:not(.blurred-bg)`;break;case r.TQ.ScheduledInline:case r.TQ.Inline:default:n=`.Transition_slide-active > .MessageList #${(0,l.GZ)(t.id,a)}`,s=`${i.KFG} .full-media,${i.KFG} .thumbnail:not(.blurred-bg)`}const o=document.querySelector(n),c=s?o?.querySelectorAll(s):void 0;return{container:o,mediaEl:c?.[0]}}function N(e,t){switch(t){case r.TQ.Album:case r.TQ.ScheduledAlbum:case r.TQ.Inline:case r.TQ.ScheduledInline:case r.TQ.StarsTransaction:case r.TQ.PreviewMedia:e.classList.add("rounded-corners");break;case r.TQ.SharedMedia:case r.TQ.SettingsAvatar:case r.TQ.ProfileAvatar:case r.TQ.SearchResult:e.firstChild.style.objectFit="cover";break;case r.TQ.MiddleHeaderAvatar:case r.TQ.SuggestedAvatar:case r.TQ.ChannelAvatar:e.classList.add("circle"),t===r.TQ.SuggestedAvatar&&e.classList.add("transition-circle")}}var I=a(43874),P=a(77523),M=a(37661),T=a(30857),x=a(17712),B=a(59030),L=a(41733),R=a(22237);const F=(0,R.n5)(!1),D=F[1];function V(e){if(e.webkitSupportsPresentationMode&&"function"==typeof e.webkitSetPresentationMode)return e.webkitSetPresentationMode.bind(e)}function _(){if(document.pictureInPictureElement)try{document.exitPictureInPicture()}catch(e){i.Oig&&console.log("[MV] PictureInPicture Error",e)}}var U=a(73767),O=a(34780),J=a(23174),K=a(32610),G=a(87679);const j=new Map;var z=a(35297);var H=a(62587),$=a(69419);const q=h.cf,W=({media:e,isAvatar:t,origin:a,delay:s})=>{const i=t&&"photo"===e?.mediaType&&!e.isVideo,o=t&&"photo"===e?.mediaType&&e.isVideo,c="document"===e?.mediaType,d="video"===e?.mediaType&&!e.isRound||c&&(0,l.hr)(e),m="photo"===e?.mediaType||c&&(0,l.Ml)(e),u="video"===e?.mediaType&&e.isGif,A=a===r.TQ.SharedMedia,y=a===r.TQ.SearchResult,p=(0,n.Kr)(()=>t=>{if(e)return!i&&!o||t?o&&t?(0,l.Pg)(e):(0,l.VO)(e,t?"full":"preview"):(0,l.mU)(e)},[o,i,e]),g=(0,H.A)(e&&(A||y||c)&&(0,l.VO)(e,"pictogram"),void 0,J.qZ.BlobUrl,s),v=p(),E=(0,H.A)(v,void 0,J.qZ.BlobUrl,s),{mediaData:f,loadProgress:b}=(0,$.A)(p(!0),void 0,e&&(0,l.Cz)(e,"full"),s),C=e&&"blobUrl"in e?e.blobUrl:void 0;let S=!d&&(C||f)||E||g;const k=function(e){const t=(0,n.li)();let a=!1;(0,z.A)(()=>{if(a=!0,t.current=void 0,!e)return;const n=new Image;if(n.src=e,!n.width)return;const s=(0,G.PR)(n);(0,K.A)(s.getContext("2d"),0,0,s.width,s.height,2,2),t.current=s.toDataURL()},[e]);const s=function(e,t=!1,a){const s=(0,n.li)(e?j.get(e):void 0),r=(0,n.li)(),i=(0,T.A)();return r.current&&t&&(clearTimeout(r.current),r.current=void 0),(0,n.vJ)(()=>{if(!e||s.current||t)return;const n=new Image;n.onload=()=>{const t=(0,G.PR)(n);(0,K.A)(t.getContext("2d"),0,0,t.width,t.height,2,2);const a=t.toDataURL();s.current=a,i(),j.size>=1e3&&j.clear(),j.set(e,a)},a?r.current=window.setTimeout(()=>{n.src=e},a):n.src=e},[e,a,i,t]),s.current}(e||void 0,Boolean(t.current));return t.current||!a&&s||e||void 0}(!S&&e&&(0,l.VD)(e));S||a===r.TQ.SearchResult||(S=k),o&&E&&(S=E);const w=C||f||(o||d?void 0:E||g||S),N=e&&(0,l.si)(e),I=Boolean(C),P=(0,n.Kr)(()=>t?o?h._e:h.cf:c?e.mediaSize:m?(0,l.Xn)(e):d?(0,l.NZ)(e):q,[t,c,m,d,o,e]);return{getMediaHash:p,media:e,isVideo:d,isPhoto:m,isGif:u,isDocument:c,bestImageData:S,bestData:w,dimensions:P,isFromSharedMedia:A,isVideoAvatar:o,isLocal:I,loadProgress:b,mediaSize:N}};var Q=a(54746),Y=a(64493),Z=a(40664),X=a(22337),ee=a(1087);const te=(0,n.ph)(({isOpen:e,peerId:t,photo:a,onClose:r,onCloseAnimationEnd:i})=>{const{reportProfilePhoto:o}=(0,s.ko)(),[l,c]=(0,n.J0)("spam"),[d,m]=(0,n.J0)(""),u=(0,x.A)(()=>{o({chatId:t,photo:a,reason:l,description:d}),r()}),A=(0,x.A)(e=>{c(e)}),h=(0,x.A)(e=>{m(e.target.value)}),y=(0,B.A)(),p=(0,n.Kr)(()=>[{value:"spam",label:y("lng_report_reason_spam")},{value:"violence",label:y("lng_report_reason_violence")},{value:"pornography",label:y("lng_report_reason_pornography")},{value:"childAbuse",label:y("lng_report_reason_child_abuse")},{value:"copyright",label:y("ReportPeer.ReasonCopyright")},{value:"illegalDrugs",label:"Illegal Drugs"},{value:"personalDetails",label:"Personal Details"},{value:"other",label:y("lng_report_reason_other")}],[y]);if(!t||!a)return;const g=y("ReportPeer.Report");return n.Ay.createElement(X.A,{isOpen:e,onClose:r,onEnter:e?u:void 0,onCloseAnimationEnd:i,className:"narrow",title:g},n.Ay.createElement(ee.A,{className:"dialog-checkbox-group",name:"report-message",options:p,onChange:A,selected:l}),n.Ay.createElement(Z.A,{label:y("lng_report_reason_description"),value:d,onChange:h}),n.Ay.createElement("div",{className:"dialog-buttons"},n.Ay.createElement(Y.A,{color:"danger",className:"confirm-dialog-button",isText:!0,onClick:u},y("lng_report_button")),n.Ay.createElement(Y.A,{className:"confirm-dialog-button",isText:!0,onClick:r},y("Cancel"))))});var ae=a(26607),ne=a(41036);const[se,re]=(0,R.n5)(1);function ie(){return(0,n._W)(()=>{re(1)}),[se,re]}const oe=(0,n.ph)(({isOpen:e,photo:t,profileId:a,onClose:r,onConfirm:i})=>{const{deleteProfilePhoto:o,deleteChatPhoto:l}=(0,s.ko)(),c=(0,n.hb)(()=>{i?.(),(0,A.L8)(a)?o({photo:t}):l({photo:t,chatId:a}),r()},[i,a,r,o,t,l]),d=(0,B.A)();return n.Ay.createElement(X.A,{isOpen:e,onClose:r,onEnter:c,className:"delete dialog-buttons-column",title:d("AreYouSure")},n.Ay.createElement("div",{className:"dialog-buttons mt-2"},n.Ay.createElement(Y.A,{color:"danger",className:"confirm-dialog-button",isText:!0,onClick:c},d("Preview.DeletePhoto")),n.Ay.createElement(Y.A,{className:"confirm-dialog-button",isText:!0,onClick:r},d("Cancel"))))});var le=a(22699),ce=a(24433),de=a(35913);const me=(0,n.ph)((0,s.EK)((e,{item:t,canUpdateMedia:a})=>{const n=(0,c.nTw)(e),{origin:s}=n.mediaViewer,r="message"===t?.type?t.message:void 0,i="avatar"===t?.type?t.avatarOwner:void 0,o="avatar"===t?.type&&t.profilePhotos.photos[t.mediaIndex],l=(0,c.meB)(e),d=(0,c.Xf0)(e),{threadId:m}=(0,c.Xf0)(e)||{},u=(0,c.ynf)(e,r),A=(0,c.yuw)(e),h=r&&(0,c.ryq)(e,r?.chatId),{canDelete:y}=m&&r&&(0,c.WAX)(e,r,m)||{},p=o&&o.id===i?.avatarPhotoId,v=a&&Boolean(o),E=y||v,f=a&&Boolean(o)&&!p,b=d?.type;return{activeDownloads:A,isProtected:u,chat:l,isChatProtected:h,canDelete:E,canUpdate:f,messageListType:b,origin:s,viewableMedia:g(e,t)}})(({item:e,mediaData:t,isVideo:a,chat:r,isChatProtected:i,isProtected:o,canReportAvatar:c,canDelete:d,canUpdate:m,messageListType:u,activeDownloads:h,origin:y,viewableMedia:p,onReportAvatar:g,onCloseMediaViewer:v,onBeforeDelete:E,onForward:f})=>{const[b,C,S]=(0,M.A)(!1),[k,w]=ie(),{isMobile:N}=(0,I.Ay)(),{downloadMedia:P,cancelMediaDownload:T,updateProfilePhoto:L,updateChatPhoto:R,openMediaViewer:F,openDeleteMessageModal:D}=(0,s.ko)(),V="message"===e?.type,{media:_}=p||{},U=_&&(0,l.sd)(_),O=_&&(0,l.$r)(h,_),{loadProgress:J}=(0,$.A)(_&&(0,l.VO)(_,"download"),!O,_&&(0,l.Cz)(_,"download")),K=(0,x.A)(()=>{if(_)if(O)T({media:_});else{const t="message"===e?.type?e.message:void 0;P({media:_,originMessage:t})}}),G=(0,x.A)(()=>{const e=k();w((e<0?e:0)-1)}),j=(0,x.A)(()=>{const e=k();w((e>0?e:0)+1)}),z=(0,x.A)(()=>{if("avatar"!==e?.type)return;const{avatarOwner:t,profilePhotos:a,mediaIndex:n}=e,s=a?.photos[n];(0,A.L8)(t.id)?L({photo:s}):R({chatId:t.id,photo:s}),F({origin:y,chatId:t.id,mediaIndex:0,isAvatarView:!0},{forceOnHeavyAnimation:!0})}),H=(0,B.A)(),q=(0,n.Kr)(()=>({onTrigger:e,isOpen:t})=>n.Ay.createElement(Y.A,{round:!0,size:"smaller",color:"translucent",className:t?"active":void 0,onClick:e,ariaLabel:"More actions"},n.Ay.createElement(Q.A,{name:"more"})),[]);function W(){return"avatar"===e?.type?n.Ay.createElement(oe,{isOpen:b,onClose:S,onConfirm:E,profileId:e.avatarOwner.id,photo:e.profilePhotos.photos[e.mediaIndex]}):void 0}const Z=(0,x.A)(()=>{"message"===e?.type&&r?D({chatId:r?.id,messageIds:[e.message.id],isSchedule:"scheduled"===u,onConfirm:E}):C()});if(N){const s=[];if(V&&e.message.isForwardingAllowed&&!e.message.content.action&&!i&&s.push({icon:"forward",onClick:f,children:H("Forward")}),o||(a?s.push({icon:O?"close":"download",onClick:K,children:O?`${Math.round(100*J)}% Downloading...`:"Download"}):s.push({icon:"download",href:t,download:U,children:H("AccActionDownload")})),c&&s.push({icon:"flag",onClick:g,children:H("ReportPeer.Report")}),m&&s.push({icon:"copy-media",onClick:z,children:H("ProfilePhoto.SetMainPhoto")}),d&&s.push({icon:"delete",onClick:Z,children:H("Delete"),destructive:!0}),0===s.length)return;return n.Ay.createElement("div",{className:"MediaViewerActions-mobile"},n.Ay.createElement(le.A,{trigger:q,positionX:"right"},s.map(({icon:e,onClick:t,href:a,download:s,children:r,destructive:i})=>n.Ay.createElement(ce.A,{key:e,icon:e,href:a,download:s,onClick:t,destructive:i},r))),O&&n.Ay.createElement(de.A,{progress:J,size:"s",noCross:!0}),d&&W())}return n.Ay.createElement("div",{className:"MediaViewerActions"},V&&e.message.isForwardingAllowed&&!i&&n.Ay.createElement(Y.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:H("Forward"),onClick:f},n.Ay.createElement(Q.A,{name:"forward"})),function(){if(!o&&"standalone"!==e?.type)return"sponsoredMessage"!==e?.type&&(a?n.Ay.createElement(Y.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:H("AccActionDownload"),onClick:K},O?n.Ay.createElement(de.A,{progress:J,size:"s",onClick:K}):n.Ay.createElement(Q.A,{name:"download"})):n.Ay.createElement(Y.A,{href:t,download:U,round:!0,size:"smaller",color:"translucent-white",ariaLabel:H("AccActionDownload")},n.Ay.createElement(Q.A,{name:"download"})))}(),n.Ay.createElement(Y.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:H("MediaZoomOut"),onClick:G},n.Ay.createElement(Q.A,{name:"zoom-out"})),n.Ay.createElement(Y.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:H("MediaZoomIn"),onClick:j},n.Ay.createElement(Q.A,{name:"zoom-in"})),c&&n.Ay.createElement(Y.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:H(a?"PeerInfo.ReportProfileVideo":"PeerInfo.ReportProfilePhoto"),onClick:g},n.Ay.createElement(Q.A,{name:"flag"})),m&&n.Ay.createElement(Y.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:H("ProfilePhoto.SetMainPhoto"),onClick:z},n.Ay.createElement(Q.A,{name:"copy-media"})),d&&n.Ay.createElement(Y.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:H("Delete"),onClick:Z},n.Ay.createElement(Q.A,{name:"delete"})),n.Ay.createElement(Y.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:H("Close"),onClick:v},n.Ay.createElement(Q.A,{name:"close"})),d&&W())}));var ue=a(87357),Ae=a(50442),he=a(43336),ye=a(37836),pe=a(14737),ge=a(16581),ve=a(19129),Ee=a(26072),fe=a(15283);function be(e){const t=(0,n.li)(e());return(0,fe.A)(()=>e.subscribe(()=>{t.current=e()})),t}var Ce=a(90423),Se=a(39751),ke=a(83414);const[we,Ne]=(0,R.n5)(!1),[Ie,Pe]=(0,R.n5)(!1);function Me(){return[(0,ke.A)(()=>we()&&!Ie(),[we,Ie]),Ne,Pe]}var Te=a(56494),xe=a(63495);const[Be,Le]=(0,R.n5)(0);function Re(){return(0,n._W)(()=>{Le(0)}),[Be,Le]}var Fe=a(5718),De=a(672),Ve=a(57474);const _e=({text:e="",buttonText:t,isForVideo:a,onClick:s,handleSponsoredClick:r,isProtected:i,isForceMobileVersion:o})=>{const[l,c]=(0,n.J0)(!1),{isMobile:d}=(0,I.Ay)(),[m]=Me(),u=(0,ve.A)(()=>!!E.TF&&!m(),[m]);(0,n.vJ)(()=>{const e=document.querySelector(".MediaViewerFooter .media-text"),t=()=>{const t=e?e.clientHeight:0;c(t>2*h.$)};t();const a=(0,ye.nF)(t,500,!0);return window.addEventListener("resize",a,!1),()=>{window.removeEventListener("resize",a,!1)}},[]);const A=(0,x.A)(()=>{r()}),y=(0,ue.A)("MediaViewerFooter",a&&"is-for-video",u&&"is-hidden",i&&"is-protected",o&&"mobile");return n.Ay.createElement("div",{className:y,onClick:function(t){e&&t.stopPropagation()}},Boolean(e)&&n.Ay.createElement("div",{className:"media-viewer-footer-content",onClick:d?void 0:s},n.Ay.createElement("p",{className:"media-text custom-scroll allow-selection "+(l?"multiline":""),dir:"auto"},e)),Boolean(t)&&n.Ay.createElement(Y.A,{className:(0,ue.A)("media-viewer-footer-content","media-viewer-button"),size:"default",color:"primary",isRectangular:!0,onClick:A},t))};var Ue=a(15640),Oe=a(84313),Je=a(71533),Ke=a(50680),Ge=a(73622);const[je,ze]=(0,R.n5)(!1);function He(){return(0,n._W)(()=>{ze(!1)}),[je,ze]}var $e=a(17663),qe=a(14242),We=a(71429),Qe=a(82497),Ye=a(41074),Ze=a(51580);function Xe(e,t,a){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const et=E.Ni||E.pz,tt=E.Ni||E.pz?.3:.25,at=et?40:80,nt=200,st=(0,Ye.Ay)();let rt;class it{constructor(e,t){Xe(this,"frames",new Map),Xe(this,"currentTime",0),Xe(this,"canvas",void 0),this.canvas=t,st.forEach(({connector:t},a)=>{t.request({name:"video-preview:init",args:[e,at,a,Ye.bP,this.onFrame.bind(this)]})})}onFrame(e,t){this.frames.set(e,t),e===this.currentTime&&this.render(e)}clearCache(){this.frames.forEach(e=>{e.close()}),this.frames.clear()}render(e){this.currentTime=e;const t=this.frames.get(e);return!!t&&((0,o.RK)(()=>{this.canvas.width=t.width,this.canvas.height=t.height,this.canvas.getContext("2d").drawImage(t,0,0,this.canvas.width,this.canvas.height)}),!0)}destroy(){this.clearCache(),st.forEach(({connector:e})=>{e.request({name:"video-preview:destroy",args:[]})})}}st.forEach(({worker:e})=>{e.addEventListener("message",async t=>{const{type:a,messageId:n,params:s}=t.data;if("requestPart"!==a)return;const r=await(0,Ze.px)("downloadMedia",{mediaFormat:J.qZ.Progressive,...s});if(!r)return;const{arrayBuffer:i}=r;e.postMessage({type:"partResponse",messageId:n,result:i},[i])})});var ot=a(63988);const lt="Od9ZSc1U";let ct;const dt=(0,n.ph)(({duration:e,bufferedRanges:t,isReady:a,posterSize:s,playbackRate:r,url:i,isActive:o,isPlaying:l,isPreviewDisabled:c,onSeek:d,onSeekStart:m})=>{const u=(0,n.li)(),[A]=Re(),[h]=He(),y=(0,ot.aG)(A,250),[p,g]=(0,n.Ul)(y()),[f,b]=(0,n.Ul)(0),[C,S]=(0,n.Ul)(0),k=(0,n.li)(!1),[w,N]=(0,n.J0)(!1),[I,P]=(0,n.J0)(!1),M=(0,n.li)(),T=(0,n.li)(),B=(0,n.li)(),L=(0,n.li)(),R=(0,n.Kr)(()=>function(e,t){const a=(e=Math.round(e*tt))/(t=Math.round(t*tt));return e>nt&&(e=nt,t=Math.round(e/a)),t>nt&&(t=nt,e=Math.round(t*a)),{width:e,height:t}}(s?.width||0,s?.height||0),[s]),F=(0,x.A)(e=>{e=Math.floor(e),S(e),function(e){rt&&rt.render(e)}(e)});return(0,n.vJ)(()=>{if(!c&&i&&a)return function(e,t){return rt&&rt.destroy(),rt=new it(e,t),()=>{rt?.destroy(),rt=void 0}}(i,M.current)},[i,a,c]),(0,n.vJ)(()=>{N(!1)},[o]),(0,n.vJ)(()=>{if(ct&&ct(),ct=void 0,!k.current&&!I){const t=y(),a=e-t;ct=(0,v.Hd)({from:t,to:e,duration:1e3*a/r,onUpdate:g})}},[y,I,g,r,e]),(0,n.vJ)(()=>{l&&!h()||(ct&&ct(),ct=void 0)},[l,p,h]),(0,n.vJ)(()=>{if(l){ct&&ct(),ct=void 0;const t=y(),a=e-t;ct=(0,v.Hd)({from:t,to:e,duration:1e3*a/r,onUpdate:g})}},[l,r,e]),(0,n.Nf)(()=>{if(!B.current)return;const t=(0,he.LI)(p()/e*100,2);B.current.style.width=`${t}%`},[p,e]),(0,n.Nf)(()=>{T.current&&(T.current.style.left=`${f()}px`)},[f]),(0,n.Nf)(()=>{L.current&&(L.current.innerText=(0,$e.QO)(C()))},[C]),(0,n.vJ)(()=>{if(!u.current||!o)return;const t=u.current;let a=t.getBoundingClientRect(),n=0,s=0;const r=n=>{const s=(0,Ue.A)(n).x,r=(0,he.qE)(e*((s-a.left)/a.width),0,e);if(c)return[r,0];a.width||(a=t.getBoundingClientRect());const i=T.current;return[r,(0,he.qE)(s-a.left-i.clientWidth/2,-4,a.width-i.clientWidth+4)]},i=()=>{ct&&ct(),ct=void 0},l=()=>{i(),k.current=!0,N(!1),P(!1),g(n),d(n),setTimeout(()=>{k.current=!1},250)},A=(0,Ae.wJ)(t,{onCapture:()=>{i(),N(!0),P(!0),m()},onRelease:l,onClick:l,onDrag:e=>{i(),N(!0),[n,s]=r(e),F(n),b(s),g(n)}});if(E.TF||c)return A;const h=e=>{N(!0),[n,s]=r(e),b(s),F(n)},y=()=>{N(!1)};return t.addEventListener("mousemove",h),t.addEventListener("mouseenter",h),t.addEventListener("mouseleave",y),()=>{A(),t.removeEventListener("mousemove",h),t.removeEventListener("mouseenter",h),t.removeEventListener("mouseleave",y)}},[e,F,o,d,m,b,g,P,c,r]),n.Ay.createElement("div",{className:"ingarEvU",ref:u},!c&&n.Ay.createElement(ae.A,{isOpen:!0,isHidden:!w,className:"TqpEWfl3",style:`width: ${R.width}px; height: ${R.height}px`,ref:T},n.Ay.createElement("canvas",{className:"fKVz2lln",ref:M}),n.Ay.createElement("div",{className:"bGiNvx5D"},n.Ay.createElement("span",{className:"mnkqvOMR",ref:L}))),n.Ay.createElement("div",{className:lt},t.map(({start:e,end:t})=>n.Ay.createElement("div",{key:`${e}-${t}`,className:"ANe2DKfp",style:`left: ${100*e}%; right: ${100-100*t}%`}))),n.Ay.createElement("div",{className:lt},n.Ay.createElement("div",{ref:B,className:(0,ue.A)("igaGLblf",I&&"beUP6SqY")})))}),mt=e=>{e.stopPropagation()},ut=[.5,1,1.5,2],At=(0,n.ph)(({url:e,bufferedRanges:t,bufferedProgress:a,duration:s,isReady:r,fileSize:i,isForceMobileVersion:o,isPlaying:l,isFullscreenSupported:c,isFullscreen:d,isBuffered:m,isPreviewDisabled:u,volume:A,isMuted:h,playbackRate:y,posterSize:p,onChangeFullscreen:g,onVolumeClick:v,onVolumeChange:f,onPlaybackRateChange:b,isPictureInPictureSupported:C,onPictureInPictureChange:S,onPlayPause:k,onSeek:w,onSeekingChange:N})=>{const[P,T,L]=(0,M.A)(),[R]=Re(),F=(0,ve.A)(()=>Math.trunc(R()),[R]),[D,V]=(0,n.Ul)(!1),_=(0,n.li)(),{isMobile:U}=(0,I.Ay)(),[O,J]=Me(),K=(0,ve.A)(O);(0,n.vJ)(()=>{if(E.TF||o){if(K&&l&&!P&&!D())return _.current=window.setTimeout(()=>{J(!1)},3e3),()=>{_.current&&window.clearTimeout(_.current)};_.current&&window.clearTimeout(_.current)}},[l,K,J,P,D,o]),(0,n.Nf)(()=>(K?document.body.classList.add("video-controls-visible"):document.body.classList.remove("video-controls-visible"),()=>{document.body.classList.remove("video-controls-visible")}),[K]),(0,n.vJ)(()=>{K||L()},[L,K]);const G=(0,B.A)(),j=(0,x.A)(e=>{V(!1),w(e),N(!1)}),z=(0,x.A)(()=>{V(!0),N(!0)}),H=(0,n.Kr)(()=>0===A||h?"muted":A<.3?"volume-1":A<.6?"volume-2":"volume-3",[A,h]);return n.Ay.createElement("div",{className:(0,ue.A)("VideoPlayerControls",o&&"mobile",K&&"active"),onClick:mt},n.Ay.createElement(dt,{url:e,duration:s,isReady:r,isPlaying:l,isPreviewDisabled:u,posterSize:p,bufferedRanges:t,playbackRate:y,onSeek:j,onSeekStart:z,isActive:K}),n.Ay.createElement("div",{className:"buttons"},n.Ay.createElement(Y.A,{ariaLabel:G("AccActionPlay"),size:"tiny",ripple:!U,color:"translucent-white",className:"play",round:!0,onClick:k},n.Ay.createElement(Q.A,{name:l?"pause":"play"})),n.Ay.createElement(Y.A,{ariaLabel:"Volume",size:"tiny",color:"translucent-white",className:"volume",round:!0,onClick:v},n.Ay.createElement(Q.A,{name:H})),!E.pz&&n.Ay.createElement(Qe.A,{bold:!0,className:"volume-slider",value:h?0:100*A,onChange:f}),function(e,t){return n.Ay.createElement("div",{className:"player-time"},`${(0,$e.QO)(e)} / ${(0,$e.QO)(t)}`)}(F,s),!m&&n.Ay.createElement("div",{className:"player-file-size"},`${(0,qe.v7)(G,i*a)} / ${(0,qe.v7)(G,i)}`),n.Ay.createElement("div",{className:"spacer"}),n.Ay.createElement(Y.A,{ariaLabel:"Playback rate",size:"tiny",color:"translucent-white",className:"playback-rate",round:!0,onClick:T},`${y}x`),C&&n.Ay.createElement(Y.A,{ariaLabel:"Picture in picture",size:"tiny",color:"translucent-white",className:"fullscreen",round:!0,onClick:S},n.Ay.createElement(Q.A,{name:"pip"})),c&&n.Ay.createElement(Y.A,{ariaLabel:"Fullscreen",size:"tiny",color:"translucent-white",className:"fullscreen",round:!0,onClick:g},n.Ay.createElement(Q.A,{name:d?"smallscreen":"fullscreen"}))),n.Ay.createElement(We.A,{isOpen:P,className:(0,ue.A)("playback-rate-menu",!c&&"no-fullscreen",!C&&"no-pip"),positionX:"right",positionY:"bottom",autoClose:!0,onClose:L},ut.map(e=>n.Ay.createElement(ce.A,{disabled:y===e,onClick:()=>b(e)},`${e}x`))))});function ht(){return ht=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)({}).hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},ht.apply(null,arguments)}const yt=(0,n.ph)(({url:e,isGif:t,posterData:a,posterSize:r,loadProgress:o,fileSize:l,isMediaViewerOpen:c,noPlay:d,volume:m,isMuted:u,playbackRate:A,isForceMobileVersion:h,shouldCloseOnClick:y,isProtected:p,isClickDisabled:g,isPreviewDisabled:v,isSponsoredMessage:b,timestamp:C,handleSponsoredClick:S,onClose:k})=>{const{setMediaViewerVolume:w,setMediaViewerMuted:N,setMediaViewerPlaybackRate:P,setMediaViewerHidden:M}=(0,s.ko)(),T=(0,n.li)(),[B,R]=(0,n.J0)(!E.TF||!E.pz),[F,U,O]=(0,Ce.Ay)(T,R),{isMobile:J}=(0,I.Ay)(),K=T.current?.duration||0,G=t||K<=30,j=(0,x.A)(()=>{E.Nd||M({isHidden:!0})}),z=(0,x.A)(()=>{E.Nd||M({isHidden:!1})}),[H,$,q]=function(e,t,a){const[s,r]=(0,n.J0)(!1),[o,l]=(0,n.J0)(!1);(0,n.Nf)(()=>{if(E.pz&&E._7||!e.current)return;const n=e.current,s=V(n);if((!document.pictureInPictureEnabled||e.current?.disablePictureInPicture)&&void 0===s)return;n.autoPictureInPicture=!0,r(!0);const i=()=>{t(),l(!0),D(!0)},o=()=>{D(!1),l(!1),a()};return n.addEventListener("enterpictureinpicture",i),n.addEventListener("leavepictureinpicture",o),()=>{n.removeEventListener("enterpictureinpicture",i),n.removeEventListener("leavepictureinpicture",o)}},[e,t,a]);const c=(0,n.hb)(()=>{if(!e.current)return;const t=V(e.current);t?t("inline"):_()},[e]),d=(0,n.hb)(()=>{if(!e.current)return;c();const t=e.current,a=(0,L.e)(t),n=V(t);n?n("picture-in-picture"):function(e){if(e.requestPictureInPicture)try{e.requestPictureInPicture()}catch(e){i.Oig&&console.log("[MV] PictureInPicture Error",e)}}(t),a&&(0,L.A)(t)},[e,c]);return s?[s,d,o]:[!1]}(T,j,z),[,W,Z]=Me(),[X,ee]=(0,n.Ul)(!1),te=(0,n.li)({x:0,y:0});(0,n.vJ)(()=>{const e=e=>{te.current=(0,Ue.A)(e)};return window.addEventListener("mousemove",e),window.addEventListener("touchmove",e),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("touchmove",e)}},[]);const ae=(0,x.A)((e,t)=>{const a=T.current?.getBoundingClientRect();a&&(e<=a.left||e>=a.right||t<=a.top||t>=a.bottom)&&(X()||W(!1))}),ne=(0,x.A)(()=>{W(!0)}),se=(0,x.A)(e=>{ae(e.clientX,e.clientY)}),re=(0,x.A)(e=>{if(ee(e),!e){const{x:e,y:t}=te.current;ae(e,t)}}),{isReady:ie,isBuffered:oe,bufferedRanges:le,bufferingHandlers:ce,bufferedProgress:me}=(0,Je.A)(),ue=(0,Oe.A)(T,void 0,!e),{shouldRender:Ae,transitionClassNames:ye}=(0,Ke.A)(!oe&&!ue,void 0,void 0,"slow"),{shouldRender:pe,transitionClassNames:ge}=(0,Ke.A)(E.pz&&!B&&!Ae&&!ue,void 0,void 0,"slow"),[,ve]=Re(),[,Ee]=He();(0,n.vJ)(()=>{Z(Ae)},[Z,Ae]),(0,n.vJ)(()=>{d||!c||ue?T.current.pause():e&&!E.TF&&(0,L.A)(T.current)},[d,c,e,N,ue]),(0,n.vJ)(()=>{T.current.volume=m},[m]),(0,n.vJ)(()=>{T.current.playbackRate=A},[A]),(0,n.vJ)(()=>{C&&(T.current.currentTime=C,ve(C))},[ve,C]);const fe=(0,x.A)(e=>{e.stopPropagation(),B?(T.current.pause(),R(!1)):((0,L.A)(T.current),R(!0))}),be=(0,x.A)(e=>{b&&(S?.(!0),k(e)),g||(y?k(e):fe(e))});(0,Ge.A)(T,ce);const Se=(0,x.A)(e=>{const t=e.currentTarget;t.readyState>=4&&(Ee(!1),ve(t.currentTime)),G||t.currentTime!==t.duration||(ve(0),R(!1))}),ke=(0,x.A)(()=>{G||(ve(0),R(!1),W(!0))}),we=(0,x.A)(()=>{F&&O?O():!F&&U&&U()}),Ne=(0,x.A)(e=>{T.current.currentTime=e}),Ie=(0,x.A)(e=>{w({volume:e/100})}),Pe=(0,x.A)(()=>{T.current.muted=!T.current.muted,N({isMuted:!u})}),Te=(0,x.A)(e=>{P({playbackRate:e})});(0,n.vJ)(()=>{if(!c)return;const e=e=>{if(!F)return;const t=T.current,a=(0,he.qE)(t.currentTime+5*e,0,t.duration);Number.isFinite(a)&&(t.currentTime=a)},t=t=>{if(!q)switch(t.key){case" ":case"Enter":t.preventDefault(),fe(t);break;case"Left":case"ArrowLeft":t.preventDefault(),e(-1);break;case"Right":case"ArrowRight":t.preventDefault(),e(1)}};return document.addEventListener("keydown",t,!1),()=>{document.removeEventListener("keydown",t,!1)}},[fe,c,F,q]);const xe=r&&`width: ${r.width}px; height: ${r.height}px`,Be=`background-image: url(${a})`,Le=!E.TF&&!h;return n.Ay.createElement("div",{className:"VideoPlayer",onMouseMove:Le?ne:void 0,onMouseLeave:Le?se:void 0},n.Ay.createElement("div",{style:xe},p&&n.Ay.createElement("div",{onContextMenu:f.A,onDoubleClick:E.TF?void 0:we,onClick:J?void 0:fe,className:"protector"}),n.Ay.createElement("video",ht({ref:T,autoPlay:E.TF,controlsList:"nodownload",playsInline:!0,loop:G,muted:t||u,id:"media-viewer-video",style:Be,onWaiting:()=>Ee(!0),onPlay:()=>R(!0),onEnded:ke,onClick:J||F?void 0:be,onDoubleClick:E.TF?void 0:we},ce,{onPause:e=>{R(!1),ce.onPause(e)},onTimeUpdate:Se,src:e}))),pe&&n.Ay.createElement(Y.A,{round:!0,className:`play-button ${ge}`,onClick:fe},n.Ay.createElement(Q.A,{name:"play"})),Ae&&n.Ay.createElement("div",{className:["spinner-container",ye].join(" ")},!oe&&n.Ay.createElement("div",{className:"buffering"},"Buffering..."),n.Ay.createElement(de.A,{size:"xl",progress:oe?1:o,onClick:k})),!t&&!b&&!ue&&n.Ay.createElement(At,{url:e,isPlaying:B,bufferedRanges:le,bufferedProgress:me,isBuffered:oe,isFullscreenSupported:Boolean(U),isPictureInPictureSupported:H,isFullscreen:F,isPreviewDisabled:v,fileSize:l,duration:K,isReady:ie,posterSize:r,isForceMobileVersion:h,onSeek:Ne,onChangeFullscreen:we,onPictureInPictureChange:$,onPlayPause:fe,volume:m,playbackRate:A,isMuted:u,onVolumeClick:Pe,onVolumeChange:Ie,onPlaybackRateChange:Te,onSeekingChange:re}))}),pt=(0,n.ph)((0,s.EK)((e,{item:t})=>{const{volume:a,isMuted:n,playbackRate:s,isHidden:r,origin:i,timestamp:o,threadId:l}=(0,c.nTw)(e).mediaViewer,d="message"===t.type?t.message:void 0,m="sponsoredMessage"===t.type?t.message:void 0,u=d||m,A=g(e,t),h=d&&(0,Te.me)(e,d,!0);return{origin:i,textMessage:u,isProtected:d&&(0,c.ynf)(e,d),volume:a,isMuted:n,isHidden:r,playbackRate:s,threadId:l,timestamp:o,maxTimestamp:h,viewableMedia:A}})(({item:e,viewableMedia:t,isActive:a,textMessage:r,origin:o,withAnimation:l,isProtected:c,volume:d,playbackRate:m,isMuted:u,isHidden:A,isMoving:p,threadId:g,timestamp:v,maxTimestamp:b,onClose:C,onFooterClick:S,handleSponsoredClick:k})=>{const{updateLastPlaybackTimestamp:w}=(0,s.ko)(),N=(0,B.A)(),P="avatar"===e.type,M="sponsoredMessage"===e.type,{media:T}=t||{},{isVideo:L,isPhoto:R,bestImageData:F,bestData:D,dimensions:V,isGif:_,isLocal:U,isVideoAvatar:O,mediaSize:J,loadProgress:K}=W({media:T,isAvatar:P,origin:o,delay:!!l&&350}),[,G]=Me(),[j]=Re(),z=Boolean(T),{isMobile:H}=(0,I.Ay)(),$=(0,x.A)(()=>{G(!0)}),q=(0,De.A)(()=>{if(!a||!r||"video"!==T?.mediaType)return;if(T.duration<i.u4b)return;const e="id"in r?r:void 0,t=j();if(!t||!e||e.isInAlbum)return;const n=T.duration-t>1?t:void 0;w({chatId:e.chatId,messageId:e.id,timestamp:n})},[j,a,T,r],1e3);if((0,Fe.R)(q,[j]),!T)return;if("avatar"===e.type)return O?n.Ay.createElement("div",{key:T.id,className:"MediaViewerContent"},n.Ay.createElement(yt,{key:T.id,url:D,isGif:!0,posterData:F,posterSize:(0,h.sk)(V,!1,!0),loadProgress:K,fileSize:J,isMediaViewerOpen:z&&a,isProtected:c,isPreviewDisabled:!xe.G9||U,noPlay:!a,onClose:C,isMuted:!0,shouldCloseOnClick:!0,volume:0,isClickDisabled:p,playbackRate:1,isSponsoredMessage:M,handleSponsoredClick:k})):n.Ay.createElement("div",{key:T.id,className:"MediaViewerContent"},gt(D,(0,h.sk)(V,!1),!H&&!c,c));const Q=r&&(r.content.action?"suggestProfilePhoto"===r.content.action.type?N("Conversation.SuggestedPhotoTitle"):void 0:(0,y.V)({message:r,maxTimestamp:b,threadId:g,forcePlayback:!0,isForMediaViewer:!0})),Y=r&&"buttonText"in r?r.buttonText:void 0,Z=Boolean(Q),X=(0,h.sk)(V,Z,L),ee=H||function(e){return!!e&&e.width<350}(X);return n.Ay.createElement("div",{className:(0,ue.A)("MediaViewerContent",Z&&"has-footer"),onMouseMove:ee&&!E.TF?$:void 0},R&&gt(D,X,!H&&!c,c),L&&(a?n.Ay.createElement(yt,{key:T.id,url:D,isGif:_,posterData:F,posterSize:X,loadProgress:K,fileSize:J,isMediaViewerOpen:z&&a,noPlay:!a,isPreviewDisabled:!xe.G9||U,onClose:C,isMuted:u,isHidden:A,isForceMobileVersion:ee,isProtected:c,volume:d,isClickDisabled:p,playbackRate:m,isSponsoredMessage:M,handleSponsoredClick:k,timestamp:v}):function(e,t,a,s){const r=t&&`width: ${t.width}px; height: ${t.height}px`,i=`background-image: url(${e})`;return e?n.Ay.createElement("div",{className:"VideoPlayer"},s&&n.Ay.createElement("div",{onContextMenu:f.A,className:"protector"}),n.Ay.createElement("div",{style:r},n.Ay.createElement("video",{style:i,className:(0,ue.A)(s&&"is-protected"),draggable:Boolean(a)}))):n.Ay.createElement("div",{className:"spinner-wrapper",style:t?`width: ${t.width}px`:""},n.Ay.createElement(Ve.A,{color:"white"}))}(F,X,!H&&!c,c)),Q&&n.Ay.createElement(_e,{text:Q,buttonText:Y,onClick:S,isProtected:c,isForceMobileVersion:ee,isForVideo:L&&!_,handleSponsoredClick:k}))}));function gt(e,t,a,s){return e?n.Ay.createElement("div",{style:"position: relative;"},s&&n.Ay.createElement("div",{onContextMenu:f.A,className:"protector"}),n.Ay.createElement("img",{src:e,alt:"",className:(0,ue.A)(s&&"is-protected"),style:t?`width: ${t.width}px`:"",draggable:Boolean(a)})):n.Ay.createElement("div",{className:"spinner-wrapper",style:t?`width: ${t.width}px`:""},n.Ay.createElement(Ve.A,{color:"white"}))}const{easeOutCubic:vt,easeOutQuart:Et}=v.qM,ft=E.TF?40:0,bt=350;let Ct,St;var kt=function(e){return e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical",e}(kt||{});const wt=(0,n.ph)(({item:e,isVideo:t,isGif:a,isOpen:s,withAnimation:r,isHidden:i,isLoadingMoreMedia:o,isSynced:l,loadMoreItemsIfNeeded:c,getNextItem:d,selectItem:m,onClose:u,onFooterClick:A,handleSponsoredClick:h})=>{const y=(0,n.li)(),p=(0,n.li)(),g=(0,n.li)(),f=(0,n.li)(),b=(0,n.li)({x:0,y:0,scale:1}),C=(0,n.li)(void 0),S=(0,n.li)(void 0),k=(0,n.li)(!1),[w,N]=(0,n.J0)(!0),[I]=ie(),P=(0,n.li)(I()),M=(0,Ce.zk)(),[T,L]=(0,n.J0)(!1),[R,F]=(0,n.Ul)({x:0,y:0,scale:1}),D=be(R),[V,_]=(0,n.Ul)(e),U=be(V),O=(0,ve.A)(()=>1!==R().scale,[R]),J=(0,ve.A)(V),{height:K,width:G,isResizing:j}=(0,Se.A)(),[z,H,$]=Me(),q=(0,B.A)();(0,Ee.A)({isActive:s,onBack:u,shouldBeReplaced:!0});const W=(0,ge.A)(m,[m],350,!0),Q=(0,ge.A)(()=>{C.current=void 0},[],500,!0),Y=(0,ge.A)(e=>N(e),[],800,!0),Z=Boolean(a&&!E.pz),X=E.TF?40:G/10,ee=(0,x.A)(e=>{if(!E.TF)return;const t=K-e.pageY<80;!t&&e.pageX<X||!t&&e.pageX>G-X||H(!z())});(0,pe.A)(()=>H(!0),bt),(0,n.vJ)(()=>{const{scale:t,x:a,y:n}=D.current;0===a&&0===n&&1===t&&_(e)},[e,_,D]),(0,n.vJ)(()=>{l&&J&&!o&&c(J)},[J,c,l,o]),(0,n.Nf)(()=>{const{x:e,y:t,scale:a}=R();$(1!==a),g.current&&(g.current.style.transform=Nt(-G+e-ft)),p.current&&(p.current.style.transform=Nt(e,t,a)),f.current&&(f.current.style.transform=Nt(G+e+ft))},[R,$,G]),(0,n.vJ)(()=>{if(!y.current||void 0===U.current||i||M)return;let e=b.current;const t={x:0,y:0},a={x:0,y:0},n={x:0,y:0};let s,o=Date.now();const l=(0,ye.sg)(()=>{o=Date.now()},500,!1,!0),c=t=>{const a=U.current;if(void 0===a)return!1;const n=d(a,t);if(void 0!==n){const a=(G+ft)*t,s=D.current.x+a;return N(!1),_(n),W(n),Y(!0),e={x:0,y:0,scale:1},r?(Ct=(0,v.Hd)({from:s,to:0,duration:bt,timing:vt,onUpdate:e=>F({y:0,x:e,scale:1})}),!0):(F(e),!0)}return!1},m=e=>{const{scale:t}=D.current;if(1!==t)return[!1,!1];if(e.target.closest("div.VideoPlayerControls"))return[!1,!1];let a=0;return K-e.pageY<80?[!1,!1]:(e.pageX<X?a=-1:e.pageX>G-X&&(a=1),[0!==a,c(a)])},A=e=>{const{scale:t}=D.current;if(1===t)switch(e.key){case"Left":case"ArrowLeft":c(-1);break;case"Right":case"ArrowRight":c(1)}},h=({x:e,y:t,scale:a},n=0)=>{const s=S.current;if(!s)return[{x:e,y:t,scale:a},!0,!0];let r=!0,i=!0;const o=(G-G*a)/2,l=(K-K*a)/2,c=Math.max(-s.left*a,o),d=G-s.right*a;r=(0,he.Bt)(e,d,c),e=(0,he.qE)(e,d,c);const m=Math.max(-s.top*a+n,l),u=K-s.bottom*a;return i=(0,he.Bt)(t,u,m),[{x:e,y:t=(0,he.qE)(t,u,m),scale:a},r,i]},g=s=>{if(k.current)return void(k.current=!1);"mouseup"===s.type&&L(!1);const r=D.current,{y:i,scale:l}=r;let c=r.x;const m=Math.abs(c),A=Math.abs(i);if(Q(),Y(!0),l<1)return e={x:0,y:0,scale:1},void(Ct=(0,v.Hd)({from:[c,i,l],to:[0,0,1],duration:bt,timing:vt,onUpdate:e=>F({x:e[0],y:e[1],scale:e[2]})}));if(l>1){const r=Math.min(l,4),d=r/l;let m=c*d+(a.x-d*a.x),u=i*d+(a.y-d*a.y);const A=.15;if("wheel"!==s.type&&e.scale===l){const e=Math.abs(t.x)/(Date.now()-o),a=Math.abs(t.y)/(Date.now()-o);m-=Math.abs(t.x)*e*A*n.x,u-=Math.abs(t.y)*a*A*n.y}return[e]=h({x:m,y:u,scale:r},60),void(Ct=(0,v.Hd)({from:[c,i,l],to:[e.x,e.y,e.scale],duration:bt,timing:vt,onUpdate:e=>F({x:e[0],y:e[1],scale:e[2]})}))}if(e={x:c,y:i,scale:l},A>=50)return void u();if(A>0)return void(Ct=(0,v.Hd)({from:i,to:0,duration:bt,timing:vt,onUpdate:e=>F({x:0,y:e,scale:l})}));const y=c<0?1:-1,p=U.current,g=p&&d(p,c<0?1:-1),E=n.x<0?-1:1;void 0!==g&&m>=50&&y===E&&(c+=(G+ft)*y,_(g),W(g)),Ct=(0,v.Hd)({from:c,to:0,duration:bt,timing:vt,onUpdate:e=>F({y:0,x:e,scale:l??1})})},f=(0,Ae.wJ)(y.current,{isNotPassive:!0,withNativeDrag:!0,excludedClosestSelector:".MediaViewerFooter, .ZoomControls, .VideoPlayerControls",minZoom:1,maxZoom:4,doubleTapZoom:3,withWheelDrag:!0,onCapture:e=>{if(Pt(e))return;const{x:t,y:a,scale:n}=D.current;if("mousedown"!==e.type||(L(!0),1===n)){if(o=Date.now(),0===t&&0===a&&1===n){if(!p.current)return;if(s=p.current.querySelector("img, video"),!s)return;S.current=s.getBoundingClientRect()}}else e.preventDefault()},onDrag:(a,s,{dragOffsetX:r,dragOffsetY:i},o)=>{if(k.current||Pt(a))return;if(E.pz&&"touchstart"===s.type){const{pageX:e}=s.touches[0];if(e<=Ae.h6||e>=G-Ae.h6)return}Ct&&(Ct(),Ct=void 0),n.x=t.x-r,n.y=t.y-i,t.x=r,t.y=i;const c=Math.abs(r),d=Math.abs(i),{x:m,y:u,scale:A}=D.current;if(l(),1!==A){const t=e.x+r,n=e.y+i;if(["wheel","mousemove"].includes(a.type)){const[e,a,s]=h({x:t,y:n,scale:A},60);return o&&o(!a,!s),void F(e)}return void("touches"in a&&1===a.touches.length&&F({x:t,y:n,scale:A}))}if("mousemove"!==a.type){if(C.current!==kt.Vertical&&(C.current===kt.Horizontal||Math.abs(m)>Ae.no||c/d>Ae.fG)){C.current=kt.Horizontal,N(!1);const e=G+ft,t=(0,he.qE)(r,-e,e);return F({x:t,y:0,scale:A}),void("wheel"===a.type&&Math.abs(t)>100&&(g(a),k.current=!0))}if(C.current===kt.Vertical||Math.abs(u)>Ae.no||d/c>Ae.fG){C.current=kt.Vertical;const e=K,t=(0,he.qE)(i,-e,e);F({x:0,y:t,scale:A}),"wheel"===a.type&&Math.abs(t)>100&&(g(a),k.current=!0)}}},onZoom:(t,{zoom:n,zoomFactor:s,initialCenterX:r,initialCenterY:i,dragOffsetX:o,dragOffsetY:l,currentCenterX:c,currentCenterY:d})=>{Ct&&Ct(),r=r||G/2,i=i||K/2,c=c||G/2,d=d||K/2;const m=n??(0,he.qE)(e.scale*s,.5,12),u=m/e.scale,A=Math.abs(Math.min(e.x,0)),y=Math.abs(Math.min(e.y,0));a.x=c,a.y=d;const p=A+r,g=y+i,v=p-u*p,E=g-u*g,[f]=h({x:e.x+v+o,y:e.y+E+l,scale:m});F(f)},onClick(t){L(!1);const[a,n]=m(t);if(a){if(t.preventDefault(),t.stopPropagation(),E.TF)return;n||u()}else 1!==e.scale||E.TF||!Z&&It(t.target,".VideoPlayer")||u()},onDoubleClick(t,{centerX:a,centerY:n}){const[s]=m(t);if(s)return t.preventDefault(),void t.stopPropagation();if(!E.TF&&"wheel"!==t.type)return;const{x:r,y:i,scale:o}=D.current;if(1===o){if(0!==r||0!==i)return;e=h({x:a-3*a,y:n-3*n,scale:3})[0]}else e={x:0,y:0,scale:1};Ct=(0,v.Hd)({from:[r,i,o],to:[e.x,e.y,e.scale],duration:bt,timing:vt,onUpdate:e=>{const t={x:e[0],y:e[1],scale:e[2]};F(t)}})},onRelease:g});return document.addEventListener("keydown",A,!1),()=>{f(),document.removeEventListener("keydown",A,!1)}},[U,Q,X,d,M,i,u,W,_,Y,F,Z,D,K,G,r]),(0,n.vJ)(()=>{const e=I(),t=void 0!==P.current&&P.current!==e;if(!y.current||!t||i||M)return;P.current=e;const{scale:a}=D.current,n=e>0?-1:1;let s=100,r=0;a<=.6&&n>0||a>=12&&n<0||(1===a&&n>0&&(s=20),St&&St(),St=(0,v.Hd)({from:n,to:n*s,duration:bt,timing:Et,onUpdate:e=>{if(!y.current)return;const t=(0,he.LI)(e-r,2);r=e;const a=new WheelEvent("wheel",{deltaY:t,ctrlKey:!0});y.current.dispatchEvent(a)}}))},[I,i,M,D]);const[te,ae]=(0,n.Kr)(()=>void 0===J?[void 0,void 0]:[d(J,-1),d(J,1)],[J,d]);if(void 0===J)return;const ne=void 0!==te,se=void 0!==ae,re=T&&O;return n.Ay.createElement("div",{className:"MediaViewerSlides",ref:y},n.Ay.createElement("div",{className:"MediaViewerSlide",ref:g},ne&&!O&&!j&&n.Ay.createElement(pt,{withAnimation:r,isMoving:re,item:te,onClose:u,onFooterClick:A,handleSponsoredClick:h})),n.Ay.createElement("div",{className:(0,ue.A)("MediaViewerSlide","MediaViewerSlide--active",re&&"MediaViewerSlide--moving"),onClick:ee,ref:p},n.Ay.createElement(pt,{item:J,withAnimation:r,isActive:w,isMoving:re,onClose:u,onFooterClick:A,handleSponsoredClick:h})),n.Ay.createElement("div",{className:"MediaViewerSlide",ref:f},se&&!O&&!j&&n.Ay.createElement(pt,{withAnimation:r,isMoving:re,item:ae,onClose:u,onFooterClick:A,handleSponsoredClick:h})),ne&&!O&&!E.TF&&n.Ay.createElement("button",{type:"button",className:`navigation prev ${t&&!a&&"inline"}`,"aria-label":q("AccDescrPrevious"),dir:q.isRtl?"rtl":void 0}),se&&!O&&!E.TF&&n.Ay.createElement("button",{type:"button",className:`navigation next ${t&&!a&&"inline"}`,"aria-label":q("Next"),dir:q.isRtl?"rtl":void 0}))});function Nt(e=0,t=0,a=1){return`translate3d(${e.toFixed(3)}px, ${t.toFixed(3)}px, 0px) scale(${a.toFixed(3)})`}function It(e,t){return!!e&&(!!e.matches(t)||Boolean(e.closest(t)))}function Pt(e){const t=e.target;return!!It(t,".VideoPlayerControls")&&(It(t,".play, .fullscreen, .volume, .volume-slider, .playback-rate, .playback-rate-menu, .SeekLine")||e.preventDefault(),!0)}var Mt=a(70636),Tt=a(4961),xt=a(21849);const Bt=(0,s.EK)((e,{item:t})=>{const a="message"===t?.type?t.message:void 0,n=a&&(0,c.Y7C)(e,a);return{owner:"avatar"===t?.type?t.avatarOwner:n}})(({owner:e,item:t})=>{const{closeMediaViewer:a,focusMessage:r,toggleChatInfo:i}=(0,s.ko)(),{isMobile:o}=(0,I.Ay)(),c=(0,x.A)(()=>{if(a(),"message"!==t?.type)return;const e=t.message;o?setTimeout(()=>{i({force:!1},{forceSyncOnIOs:!0}),r({chatId:e.chatId,messageId:e.id})},350):r({chatId:e.chatId,messageId:e.id})}),d=(0,B.A)(),m=(0,n.Kr)(()=>{if(!t||"standalone"===t.type)return;const e="avatar"===t.type?t.avatarOwner:void 0,a="avatar"===t.type?t.profilePhotos:void 0,n=a?.photos[t.mediaIndex],s=n?.id===a?.fallbackPhoto?.id,r=n?.id===a?.personalPhoto?.id,i="message"===t.type?t.message.date:n?.date;if(!i)return;const o=(0,$e.fS)(d,1e3*i,!0),c=a?.count&&a.count+(a?.fallbackPhoto?1:0),m=t.mediaIndex+1+(a?.personalPhoto?-1:0),u=c&&d("Of",[m,c]),h=[];if(n){const t=(0,A.L8)(e.id)?void 0:e,a=t&&(0,l.WX)(t),n=t&&(0,l.YE)(t);h.push(d(r?"lng_mediaview_profile_photo_by_you":s?"lng_mediaview_profile_public_photo":a?"lng_mediaview_channel_photo":n?"lng_mediaview_group_photo":"lng_mediaview_profile_photo"))}return!u||r||s||h.push(u),h.push(o),h.join(" • ")},[t,d]);if(!e)return;const u=(0,Mt.F9)(d,e);return n.Ay.createElement("div",{className:"SenderInfo",onClick:c},n.Ay.createElement(xt.A,{key:e.id,size:"medium",peer:e}),n.Ay.createElement("div",{className:"meta"},n.Ay.createElement("div",{className:"title",dir:"auto"},u&&(0,Tt.A)(u)),n.Ay.createElement("div",{className:"date",dir:"auto"},m)))}),Lt=250,Rt=(0,n.ph)((0,s.EK)(e=>{const{mediaViewer:t,shouldSkipHistoryAnimations:a}=(0,c.nTw)(e),{chatId:n,threadId:s,messageId:i,origin:o,isHidden:d,withDynamicLoading:m,standaloneMedia:u,mediaIndex:h,isAvatarView:y,isSponsoredMessage:v}=t,E=(0,c.xYJ)(e,"mediaViewerAnimations"),{currentUserId:f,isSynced:b}=e,C=Boolean(n)&&(0,c.nZ4)(e,n);if(y){const t=(0,c.PVB)(e,n);let s=!1;t&&(s=(0,A.L8)(t.id)?t.id===f:(0,l.SJ)(t));const r=(0,c.IVq)(e,n),i=p({avatarOwner:t,standaloneMedia:u,profilePhotos:r,mediaIndex:h}),m=g(e,i);return{profilePhotos:r,avatar:r?.photos[h],avatarOwner:t,isLoadingMoreMedia:r?.isLoading,isChatWithSelf:C,canUpdateMedia:s,withAnimation:E,origin:o,shouldSkipHistoryAnimations:a,isHidden:d,standaloneMedia:u,mediaIndex:h,isSynced:b,currentItem:i,viewableMedia:m}}let S,k,w;n&&i&&(S=o&&[r.TQ.ScheduledAlbum,r.TQ.ScheduledInline].includes(o)?(0,c.Jl6)(e,n,i):(0,c.O5q)(e,n,i)),v&&n&&o===r.TQ.SponsoredMessage&&(k=(0,c.v8U)(e,n)),n&&(w=o&&[r.TQ.ScheduledAlbum,r.TQ.ScheduledInline].includes(o)?(0,c.yFI)(e,n):(0,c.zeq)(e,n));let N=!1;const I=o===r.TQ.Inline,P=o===r.TQ.Album;let M;if(n&&s&&i)if(m&&(I||P)){const t=(0,c.CuV)(e);N=Boolean(t?.isLoading);const{foundIds:a}=t?.currentSegment||{};M=a}else if(o===r.TQ.SharedMedia){const t=(0,c.BU_)(e),{foundIds:a}=t&&t.resultsByType&&t.resultsByType.media||{};M=a}else(I||P)&&(M=(0,c.Lzh)(e,n,s,i)||(0,c.gCU)(e,n,s));const T=p({message:S,standaloneMedia:u,mediaIndex:h,sponsoredMessage:k});return{chatId:n,threadId:s,messageId:i,isChatWithSelf:C,origin:o,message:S,chatMessages:w,sponsoredMessage:k,collectedMessageIds:M,withAnimation:E,isHidden:d,shouldSkipHistoryAnimations:a,withDynamicLoading:m,standaloneMedia:u,mediaIndex:h,isLoadingMoreMedia:N,isSynced:b,currentItem:T,viewableMedia:g(e,T)}})(({chatId:e,threadId:t,messageId:a,message:c,collectedMessageIds:p,isChatWithSelf:g,canUpdateMedia:f,origin:L,avatar:R,avatarOwner:D,profilePhotos:V,chatMessages:J,sponsoredMessage:K,standaloneMedia:G,mediaIndex:j,withAnimation:z,isHidden:H,shouldSkipHistoryAnimations:$,withDynamicLoading:q,isLoadingMoreMedia:Z,isSynced:X,currentItem:ee,viewableMedia:se})=>{const{openMediaViewer:re,closeMediaViewer:ie,openForwardMenu:oe,focusMessage:le,toggleChatInfo:ce,searchChatMediaMessages:de,loadMoreProfilePhotos:ue,clickSponsored:Ae,openUrl:he}=(0,s.ko)(),ye=Boolean(D||c||G||K),{isMobile:pe}=(0,I.Ay)(),{media:ge,isSingle:ve}=se||{},Ee=(0,n.li)(),fe=c?.senderId||D?.id||c?.chatId,be=(0,U.A)(fe),Ce=z?"slideFade":"none",Se=Boolean(z&&!$),[ke,we,Ne]=(0,M.A)(),{isVideo:Ie,isPhoto:Pe,bestImageData:Me,bestData:Te,dimensions:xe,isGif:Be,isFromSharedMedia:Le}=W({media:ge,isAvatar:Boolean(D),origin:L,delay:Se&&Lt}),Re=(()=>{if(g)return!1;if("avatar"!==ee?.type||!D)return!1;const e=ee.profilePhotos;return ge!==e.personalPhoto})(),Fe=!H&&ye,De=(0,n.Kr)(()=>q?p:(0,l.Wm)(J||{},p||[],Le),[J,p,Le,q]);!ye||be&&be===fe&&void 0!==Ee.current||(Ee.current=ve?0:a||j);const[Ve]=F;(0,n.vJ)(()=>{if(!ye||Ve())return;(0,u.FD)();const e=(0,O.w4)();return()=>{e(),(0,u.wb)()}},[ye,Ve]),(0,n.vJ)(()=>{Fe&&_()},[Fe]),(0,n.vJ)(()=>{pe&&(0,o.RK)(()=>{document.body.classList.toggle("is-media-viewer-open",ye)})},[pe,ye]);const _e=(0,n.li)();(0,P.A)(_e);const Ue=(0,T.A)();(0,n.vJ)(()=>{const e=window.matchMedia(h.wy);return e.addEventListener("change",Ue),()=>{e.removeEventListener("change",Ue)}},[Ue]);const Oe=(0,U.A)(c),Je=(0,U.A)(H),Ke=(0,U.A)(L),Ge=(0,U.A)(ee),je=(0,U.A)(Me),ze=c?(0,y.V)({message:c,forcePlayback:!0,isForMediaViewer:!0}):void 0,He=Boolean(ze),$e=Je&&Ge!==ee;(0,n.vJ)(()=>{Se&&ye&&($e||!Ge)&&((0,n.VK)(Lt+i.xB5),function(e,t,a,n,s,l,c){const{mediaEl:d}=w(t,l,c);if(!d)return;const{width:m}=S.A.get(),{width:u,height:A}=(0,h.$w)(e,s),{width:y,height:p}=(0,h.ky)(u,A,n.width,n.height),g=(m-y)/2,f=function(e){const t=window.matchMedia(h.wy);let a=4.125;return e&&!E.TF&&(a+=t.matches?.875:2.125),a*h.$}(e)+(A-p)/2;let{top:b,left:C,width:I,height:P}=d.getBoundingClientRect();if([r.TQ.SharedMedia,r.TQ.Album,r.TQ.ScheduledAlbum,r.TQ.SearchResult].includes(t)){const e=function(e,t,a,n,s,r){if(e===t){const i=Math.max(s,r)*(e/t);n-=(i-s)/2,a-=(i-r)/2,s=i,r=i}else if(e>t){const a=s;n-=((s=r*(e/t))-a)/2}else if(t>e){const n=r;a-=((r=s*(t/e))-n)/2}return{top:a,left:n,width:s,height:r}}(y,p,b,C,I,P);b=e.top,C=e.left,I=e.width,P=e.height}const M=C+I/2-(g+y/2),T=b+P/2-(f+p/2),x=I/y,B=P/p;(0,o.RK)(()=>{const e=k(a||d);(0,v.ZM)(e,{top:`${f}px`,left:`${g}px`,width:`${y}px`,height:`${p}px`,transform:`translate3d(${M}px, ${T}px, 0) scale(${x}, ${B})`}),N(e,t),document.body.appendChild(e),document.body.classList.add("ghost-animating"),(0,o.RK)(()=>{e.style.transform="",function(e){e.firstChild.style.objectFit="default",e.classList.remove("rounded-corners","circle")}(e),setTimeout(()=>{(0,o.RK)(()=>{document.body.contains(e)&&document.body.removeChild(e),document.body.classList.remove("ghost-animating")})},200+i.xB5)})})}(He,L,Me,xe,Ie,c,j)),Se&&!ye&&Ge&&((0,n.VK)(Lt+i.xB5),function(e,t,a,n){const{container:s,mediaEl:l}=w(e,a,n);if(!l)return;const c=document.getElementById("MediaViewer").querySelector(".MediaViewerSlide--active img, .MediaViewerSlide--active video");if(!c)return;const{top:d,left:m,width:u,height:A}=c.getBoundingClientRect(),{top:h,left:y,width:p,height:g}=l.getBoundingClientRect();let E=h;if(!(0,C.Y)(s)){const{height:e}=S.A.get();E=h<d?-g:e}const f=m+u/2-(y+p/2),I=d+A/2-(E+g/2);let P=u/p,M=A/g;const T=[r.TQ.Inline,r.TQ.ScheduledInline,r.TQ.Album,r.TQ.ScheduledAlbum].includes(e)&&!function(e){const t=document.querySelector(".Transition_slide-active > .MessageList"),{top:a}=(0,b.A)(e,t);return a>t.scrollTop&&a+e.offsetHeight<t.scrollTop+t.offsetHeight}(l);[r.TQ.SharedMedia,r.TQ.Album,r.TQ.ScheduledAlbum,r.TQ.SearchResult].includes(e)&&(P>M?P=M:M>P&&(M=P));const x=document.getElementsByClassName("ghost")[0],B=x||k(t||l,e);let L;if(x){const{top:e,left:t,width:a,height:n}=x.getBoundingClientRect();L={transition:"none",top:`${E}px`,left:`${y}px`,transformOrigin:"top left",transform:`translate3d(${t-y}px, ${e-E}px, 0) scale(${a/p}, ${n/g})`,width:`${p}px`,height:`${g}px`}}else L={top:`${E}px`,left:`${y}px`,width:`${p}px`,height:`${g}px`,transform:`translate3d(${f}px, ${I}px, 0) scale(${P}, ${M})`};(0,o.RK)(()=>{(0,v.ZM)(B,L),x||document.body.appendChild(B),document.body.classList.add("ghost-animating"),(0,o.RK)(()=>{x&&(x.style.transition=""),B.style.transform="",T&&(B.style.opacity="0"),N(B,e),setTimeout(()=>{(0,o.RK)(()=>{document.body.contains(B)&&document.body.removeChild(B),document.body.classList.remove("ghost-animating")})},200+i.xB5)})})}(Ke,je,Oe,Ge?.mediaIndex))},[Me,xe,He,Se,ye,Ie,c,L,je,Ge,Oe,Ke,$e,j]);const qe=(0,x.A)(()=>ie()),We=(0,x.A)(n=>{n.target instanceof HTMLElement&&n.target.closest("a")||(qe(),e&&a&&(pe?setTimeout(()=>{ce({force:!1},{forceSyncOnIOs:!0}),le({chatId:e,threadId:t,messageId:a})},Lt):le({chatId:e,threadId:t,messageId:a})))}),Qe=(0,x.A)(t=>{K&&e&&(Ae({isMedia:t,isFullscreen:!0,randomId:K.randomId}),he({url:K.url}),ie())}),Ye=(0,x.A)(()=>{oe({fromChatId:e,messageIds:[a]})});(0,n.vJ)(()=>ye?(0,m.A)(()=>{qe()}):void 0,[qe,ye]),(0,n.vJ)(()=>{Ie&&!Be&&(0,d._K)()},[Be,Ie]);const Ze=(0,x.A)(a=>{if(a&&!Z){if("avatar"===a.type){if(!(a.mediaIndex>=a.profilePhotos.photos.length-4))return;ue({peerId:a.avatarOwner.id})}"message"===a.type&&q&&de({chatId:e,threadId:t,currentMediaMessageId:a.message.id})}}),Xe=(0,x.A)((e,t)=>{if(0===t||ve)return;if("standalone"===e.type){const{media:a,mediaIndex:n}=e,s=n+t;return s>=0&&s<a.length?{type:"standalone",media:a,mediaIndex:s}:void 0}if("avatar"===e.type){const{avatarOwner:a,profilePhotos:n,mediaIndex:s}=e,r=s+t;return r>=0&&n&&r<n.photos.length?{type:"avatar",avatarOwner:a,profilePhotos:n,mediaIndex:r}:void 0}if("sponsoredMessage"===e.type){const{message:a,mediaIndex:n}=e,s=n+t;return s>=0&&a?{type:"sponsoredMessage",message:a,mediaIndex:s}:void 0}const{message:a,mediaIndex:n}=e,s=(0,l.qG)(a);if(s){const e=n+t;if(e>=0&&e<s.extendedMedia.length)return{type:"message",message:a,mediaIndex:e}}const r=De?.indexOf(a.id);if(void 0===r)return;const i=De[r+t],o=J?.[i];return o?{type:"message",message:o}:void 0}),et=(0,x.A)(e=>{if(!e)return void qe();const t="avatar"===e.type?e.avatarOwner.id:"message"===e.type?e.message.chatId:void 0,a="message"===e.type?e.message.id:void 0,n="standalone"===e.type?e.media:void 0;re({origin:L,chatId:t,messageId:a,standaloneMedia:n,mediaIndex:e.mediaIndex,isAvatarView:"avatar"===e.type,withDynamicLoading:q},{forceOnHeavyAnimation:!0})}),tt=(0,x.A)(()=>{if((V?.photos.length||G?.length||De?.length||0)<=1||!ee)return void qe();const e=Xe(ee,-1);e?et(e):"avatar"===ee.type&&(0,A.L8)(ee.avatarOwner.id)||"standalone"===ee.type||qe()}),at=(0,B.A)();return n.Ay.createElement(ae.A,{id:"MediaViewer",isOpen:ye,isHidden:H,shouldAnimateFirstRender:!0,noCloseTransition:$},n.Ay.createElement("div",{className:"media-viewer-head",dir:at.isRtl?"rtl":void 0,ref:_e},pe&&n.Ay.createElement(Y.A,{className:"media-viewer-close",round:!0,size:"smaller",color:"translucent-white",ariaLabel:at("Close"),onClick:qe},n.Ay.createElement(Q.A,{name:"close"})),n.Ay.createElement(ne.Ay,{activeKey:Ee.current,name:Ce},n.Ay.createElement(Bt,{key:ge?.id,item:ee})),n.Ay.createElement(me,{mediaData:Te,isVideo:Ie,item:ee,canUpdateMedia:f,canReportAvatar:Re,onBeforeDelete:tt,onReportAvatar:we,onCloseMediaViewer:qe,onForward:Ye}),n.Ay.createElement(te,{isOpen:ke,onClose:Ne,photo:R,peerId:D?.id})),n.Ay.createElement(wt,{item:ee,loadMoreItemsIfNeeded:Ze,isLoadingMoreMedia:Z,isSynced:X,getNextItem:Xe,chatId:e,isPhoto:Pe,isGif:Be,threadId:t,avatarOwnerId:D?.id,origin:L,isOpen:ye,hasFooter:He,isVideo:Ie,withAnimation:z,onClose:qe,selectItem:et,isHidden:H,onFooterClick:We,handleSponsoredClick:Qe}))}));var Ft=a(2429);const Dt="W9A8SEMl",Vt="gLHHo5k8",_t="GJVwqV9e",Ut="_Yn4SWUB",Ot="hGCH03qc",Jt="ZecqXqKy",Kt="PVZ8TOWS",Gt="Wi0DXPH2",jt="Ka1CGfzq",zt="urTtSsk9",Ht="AjXOHOgE",$t="uAlXNXJN",qt="g8ypsnnC",Wt="hGTnZuar",Qt="TkphaPyQ",Yt="CvnxnCxN",Zt="nZ30pf4g",Xt="MnNC7VHS",ea="G8OgmMDJ",ta=3.5*h.$,aa=.5*h.$;function na(e,t=!1,a=!1){const n=document.createElement("div");n.classList.add(a?"TYicp2_K":"fME2l_yv");const s=new Image;if(s.draggable=!1,s.oncontextmenu=f.A,s.classList.add("HjoURJRK"),t){const t=document.createElement("canvas");t.classList.add(Xt),s.onload=()=>{const e=t.getContext("2d",{alpha:!1}),{width:a,height:n}=s;(0,o.RK)(()=>{t.width=a,t.height=n,E.QH&&(e.filter="blur(2px)"),e.drawImage(s,-4,-4,a+8,n+8),E.QH||(0,K.A)(e,0,0,a,n,2,2)})},s.src=e,n.appendChild(t)}else s.src=e,n.appendChild(s);return n}function sa(e,t){let a;const n=`#${(0,l.kR)(t)}`;switch(e){case r.G9.StoryRibbon:a=`#LeftColumn .${Ft.A.root}`;break;case r.G9.MiddleHeaderAvatar:a=".MiddleHeader .Transition_slide-active .ChatInfo";break;case r.G9.ChatList:a="#LeftColumn .chat-list";break;case r.G9.SearchResult:a="#LeftColumn .LeftSearch--container"}const s=document.querySelector(a),i=s&&s.querySelectorAll(`${n} img`);return{container:s,mediaEl:i?.[0]}}function ra({scale:e,slideAmount:t,isActiveSlideSize:a,isMoveThroughActiveSlide:n,isBackward:s}){const r=40+(a?405:135),i=(Math.abs(t)-1)*(40+(n?405:135)),o=(0,he.Ki)((r+i)*e);return s?-o:o}function ia(){const{width:e,height:t}=(0,Se.A)();return(0,n.Kr)(()=>function(e,t){const a=function(e,t,a,n){const s=a/1200,r=n/800;return Math.min(s,r)}(0,0,e,t),n=(0,he.Ki)(405*a),s=(0,he.Ki)(135*a);return{activeSlide:{width:n,height:(0,he.Ki)(720*a)},slide:{width:s,height:(0,he.Ki)(240*a)},scale:a,toActiveScale:n/s,fromActiveScale:s/n}}(e,t),[e,t])}function oa(e,t=!1,a=!1){const n=e&&"content"in e,s=e&&"isDeleted"in e,r=!!n&&(0,l.XR)(e),i=n&&Boolean(e.forwardInfo);let o;n&&(e.content.photo?.thumbnail&&(o=e.content.photo.thumbnail.dataUri),e.content.video?.thumbnail?.dataUri&&(o=e.content.video.thumbnail.dataUri));const c=n?(0,l.EN)(e):void 0,d=(0,H.A)(c),m=Boolean(n&&e.content.video),u=n&&e.content.video?.noSound,A=n?(0,l.EN)(e,"full"):void 0,h=(0,H.A)(A,!e,m?J.qZ.Progressive:J.qZ.BlobUrl),y=m&&n?(0,l.EN)(e,"full",!0):void 0,p=(0,H.A)(y,!e,J.qZ.Progressive),g=Boolean(h||p),v=m?d:h||d,E=!d&&!g,f=t&&n&&!e.noForwards,b=n?(0,l.EN)(e,"download"):void 0;return{isLoadedStory:n,isDeletedStory:s,hasText:r,hasForwardInfo:i,thumbnail:o,previewHash:c,previewBlobUrl:d,isVideo:m,noSound:u,fullMediaHash:A,fullMediaData:h,altMediaHash:y,altMediaData:p,hasFullData:g,bestImageData:v,hasThumb:E,canDownload:f,downloadMediaData:(0,H.A)(b,!f&&!a)}}var la=a(80140),ca=a(22720),da=a(61361);const ma="RGD70uBt",ua="HCYfPccW",Aa="L8oRQyKb",ha=(0,n.ph)((0,s.EK)(e=>{const t=(0,c.nTw)(e);return{isOpen:t.storyViewer?.isStealthModalOpen,stealthMode:e.stories.stealthMode,isCurrentUserPremium:(0,c.g29)(e)}})(({isOpen:e,stealthMode:t,isCurrentUserPremium:a})=>{const{toggleStealthModal:r,activateStealthMode:i,showNotification:o,openPremiumModal:l}=(0,s.ko)(),[c,d]=(0,n.J0)(!1);(0,n.vJ)(()=>{if(!t)return;const e=(0,la.Fm)();t.cooldownUntil&&t.cooldownUntil>e&&d(!0)},[t,e]);const m=(0,B.A)(),u=(0,x.A)(()=>{d(!1)}),A=(0,x.A)(()=>{r({isOpen:!1})}),h=(0,x.A)(()=>{a?(i(),o({title:m("StealthModeOn"),message:m("StealthModeOnHint")}),r({isOpen:!1})):l({initialSection:"stories"})});return n.Ay.createElement(X.A,{className:"component-theme-dark",contentClassName:"GrE47IXS",isOpen:e,isSlim:!0,onClose:A},n.Ay.createElement(Y.A,{round:!0,color:"translucent",size:"smaller",className:"NlWSF1pA",ariaLabel:m("Close"),onClick:A},n.Ay.createElement(Q.A,{name:"close"})),n.Ay.createElement("div",{className:"qKi5jsGM"},n.Ay.createElement(Q.A,{name:"eye-crossed-outline"})),n.Ay.createElement("div",{className:"BFctFGoT"},m("StealthMode")),n.Ay.createElement("div",{className:"fZIJH4IG"},m(a?"StealthModeHint":"StealthModePremiumHint")),n.Ay.createElement(ca.A,{className:(0,ue.A)(ma,"smaller-icon"),multiline:!0,inactive:!0,leftElement:n.Ay.createElement(Q.A,{name:"stealth-past",className:ua})},n.Ay.createElement("span",{className:"title"},m("HideRecentViews")),n.Ay.createElement("span",{className:(0,ue.A)("subtitle",Aa)},m("HideRecentViewsDescription"))),n.Ay.createElement(ca.A,{className:(0,ue.A)(ma,"smaller-icon"),multiline:!0,inactive:!0,leftElement:n.Ay.createElement(Q.A,{name:"stealth-future",className:ua,"aria-hidden":!0})},n.Ay.createElement("span",{className:"title"},m("HideNextViews")),n.Ay.createElement("span",{className:(0,ue.A)("subtitle",Aa)},m("HideNextViewsDescription"))),n.Ay.createElement(Y.A,{className:"AM_sxoXP",size:"smaller",disabled:c,isShiny:!a,withPremiumGradient:!a,onClick:h},a?c?n.Ay.createElement(da.A,{langKey:"AvailableIn",endsAt:t.cooldownUntil,onEnd:u}):m("EnableStealthMode"):m("UnlockStealthMode")))}));var ya=a(94189);const pa=(0,n.ph)(function({isOpen:e,story:t,onClose:a}){const{deleteStory:r,openNextStory:i}=(0,s.ko)(),o=(0,B.A)(),l=(0,n.hb)(()=>{t&&(i(),r({peerId:t.peerId,storyId:t.id}),a())},[a,t]);return n.Ay.createElement(ya.A,{isOpen:e,onClose:a,title:o("DeleteStoryTitle"),text:o("DeleteStorySubtitle"),confirmLabel:o("Delete"),confirmHandler:l,confirmIsDestructive:!0,className:"component-theme-dark"})});var ga=a(21309),va=a(63152),Ea=a(87894),fa=a(79824),ba=a(54960);const Ca=(0,n.ph)(function({id:e,contactListIds:t,currentUserId:a,selectedIds:s,lockedIds:r,onSelect:i}){const o=(0,B.A)(),[l,c]=(0,n.J0)(""),d=(0,n.Kr)(()=>{const e=(t||[]).filter(e=>e!==a);return(0,Ea.Am)((0,Mt.PU)({ids:[...s||[],...e],query:l,type:"user"}))},[t,a,l,s]);return n.Ay.createElement(ba.A,{key:e,itemIds:d,selectedIds:s??fa.p,lockedSelectedIds:r,filterValue:l,filterPlaceholder:o("Search"),searchInputId:`${e}-picker-search`,isSearchable:!0,withDefaultPadding:!0,forceShowSelf:!0,onSelectedIdsChange:i,onFilterChange:c,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"})});var Sa=a(82117),ka=a(12933);const wa=(0,n.ph)(function({isActive:e,contactListIds:t,usersById:a,currentUserId:r,onClose:i}){const{saveCloseFriends:o}=(0,s.ko)(),l=(0,B.A)(),[c,d]=(0,n.J0)(""),[m,u]=(0,n.J0)(!1),[A,h]=(0,n.J0)([]),y=(0,n.Kr)(()=>(t||[]).filter(e=>a[e]?.isCloseFriend),[t,a]),p=(0,n.Kr)(()=>{const e=(t||[]).filter(e=>e!==r);return(0,Ea.Am)((0,Mt.PU)({ids:[...y,...e],query:c,type:"user"}))},[y,t,r,c]);(0,Sa.A)(([t])=>{!t&&e&&(u(!1),h(y))},[e,y]);const g=(0,n.hb)(e=>{h(e),u(!0)},[]),v=(0,x.A)(()=>{o({userIds:A}),i()});return n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(ba.A,{itemIds:p||[],selectedIds:A,filterValue:c,filterPlaceholder:l("Search"),searchInputId:"close-friends-picker-search",isSearchable:!0,withDefaultPadding:!0,onSelectedIdsChange:g,onFilterChange:d,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"}),n.Ay.createElement("div",{className:(0,ue.A)("BDK_pgpt",m&&"N8ujSwlC")},n.Ay.createElement(ka.A,{isShown:m,onClick:v,ariaLabel:l("Save")},n.Ay.createElement(Q.A,{name:"check"}))))}),Na={modal:"hz7SomkK",header:"NV6Rt2g9",closeButton:"SN1GFS6L",headerTitle:"gi0Y6Ns6",content:"sTaVDkiD",section:"eUiuPoEC",title:"iPPiw9DI",list:"OUP1Ss0W",option:"JL33Sa3b",checked:"qVPo_cVL",input:"zsDaUk0i",icon:"AfYCVlys",action:"njMeBBwY",optionContent:"TUAAnG2w",footer:"r24Qz2bf",info:"ljeRVBOm",submit:"RwNLN_rH"},Ia=[{name:"StoryPrivacyOptionEveryone",value:"everybody",color:["#50ABFF","#007AFF"],icon:"channel-filled",actions:"blockUserIds"},{name:"StoryPrivacyOptionContacts",value:"contacts",color:["#C36EFF","#8B60FA"],icon:"user-filled",actions:"blockContactUserIds"},{name:"StoryPrivacyOptionCloseFriends",value:"closeFriends",color:["#88D93A","#30B73B"],icon:"favorite-filled",actions:"closeFriends"},{name:"StoryPrivacyOptionSelectedContacts",value:"nobody",color:["#FFB743","#F69A36"],icon:"group-filled",actions:"allowUserIds"}];var Pa=function(e){return e[e.privacy=0]="privacy",e[e.allowList=1]="allowList",e[e.closeFriends=2]="closeFriends",e[e.denyList=3]="denyList",e}(Pa||{});const Ma=(0,n.ph)((0,s.EK)(e=>{const{storyViewer:{storyId:t,peerId:a}}=(0,c.nTw)(e),n=a&&t?(0,c.Msb)(e,a,t):void 0;return{story:n&&"content"in n?n:void 0,visibility:n&&"visibility"in n?n.visibility:void 0,contactListIds:e.contactList?.userIds,usersById:e.users.byId,currentUserId:e.currentUserId}})(function({isOpen:e,story:t,visibility:a,contactListIds:r,usersById:i,currentUserId:o,onClose:c}){const{editStoryPrivacy:d,toggleStoryInProfile:m}=(0,s.ko)(),u=(0,B.A)(),[A,h,y]=(0,M.A)(!1),[p,g]=(0,n.J0)(a),[v,E]=(0,n.J0)(t?.isInProfile),[b,C]=(0,n.J0)(Pa.privacy),[S,k]=(0,n.J0)("everybody"),w=b!==Pa.privacy,N=(0,n.Kr)(()=>(r||[]).filter(e=>i[e]?.isCloseFriend),[r,i]),I=(0,n.Kr)(()=>{if(b===Pa.allowList&&(!p?.allowUserIds?.length||p.allowUserIds[0]===o))return[o]},[b,o,p?.allowUserIds]),P=(0,n.Kr)(()=>S!==p?.visibility?[]:p?.blockUserIds||[],[S,p?.blockUserIds,p?.visibility]),T=(0,x.A)(e=>{g({...p,allowUserIds:e?.length?e?.filter(e=>e!==o):[o]})}),L=(0,x.A)(e=>{g({...p,blockUserIds:e,visibility:S})});(0,n.vJ)(()=>{e&&(C(Pa.privacy),h())},[e]),(0,n.vJ)(()=>{g(a)},[a]);const R=(0,x.A)(()=>{b!==Pa.privacy?C(Pa.privacy):y()}),F=(0,x.A)(()=>{E(!v)}),D=(0,x.A)(()=>{d({peerId:t.peerId,storyId:t.id,privacy:p}),t.isInProfile!==v&&m({peerId:t.peerId,storyId:t.id,isInProfile:v}),y()});function V(e){switch(b){case Pa.privacy:return function(){const e=t?(0,ga.qZ)(t.expireDate-t.date):0;return n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:Na.section},n.Ay.createElement("h3",{className:Na.title},u("StoryPrivacyAlertSubtitleProfile")),n.Ay.createElement("div",{className:Na.list},Ia.map(e=>{return n.Ay.createElement("label",{key:e.value,className:(0,ue.A)(Na.option,e.value===p?.visibility&&Na.checked)},n.Ay.createElement("input",{type:"radio",name:"story_privacy",className:Na.input,value:e.value,checked:e.value===p?.visibility,onChange:()=>{return t=e.value,void g({...p,visibility:t});var t},teactExperimentControlled:!0}),n.Ay.createElement("span",{className:Na.icon,style:`--color-from: ${e.color[0]}; --color-to: ${e.color[1]}`},n.Ay.createElement(Q.A,{name:e.icon})),n.Ay.createElement("div",{className:Na.optionContent},n.Ay.createElement("span",{className:(0,ue.A)(Na.option_name)},u(e.name)),e.actions&&n.Ay.createElement("div",{tabIndex:0,role:"button",className:Na.action,"aria-label":u("Edit"),onClick:t=>{!function(e,t){switch((0,f.A)(e),t){case"closeFriends":C(Pa.closeFriends);break;case"allowUserIds":C(Pa.allowList);break;case"blockUserIds":C(Pa.denyList),k("everybody");break;case"blockContactUserIds":C(Pa.denyList),k("contacts")}}(t,e.actions)}},n.Ay.createElement("span",{className:Na.actionInner},"closeFriends"===(t=e.actions)?0===N.length?u("StoryPrivacyOptionCloseFriendsDetail"):1===N.length?(0,Mt.F9)(u,i[N[0]]):u("StoryPrivacyOptionPeople",N.length,"i"):"blockUserIds"===t&&"everybody"===p?.visibility||"blockContactUserIds"===t&&"contacts"===p?.visibility?p?.blockUserIds?.length?1===p.blockUserIds.length?u("StoryPrivacyOptionExcludePerson",(0,l.Yg)(i[p.blockUserIds[0]])):u("StoryPrivacyOptionExcludePeople",p.blockUserIds.length,"i"):u("StoryPrivacyOptionContactsDetail"):p?.allowUserIds&&0!==p.allowUserIds.length?1===p.allowUserIds.length?(0,l.Yg)(i[p.allowUserIds[0]]):u("StoryPrivacyOptionPeople",p.allowUserIds.length,"i"):u("StoryPrivacyOptionSelectedContactsDetail")),n.Ay.createElement(Q.A,{name:"next"}))));var t}))),n.Ay.createElement("div",{className:Na.section},n.Ay.createElement(ca.A,{ripple:!0,onClick:F},n.Ay.createElement("span",null,u("StoryKeep")),n.Ay.createElement(va.A,{id:"group-notifications",label:u("StoryKeep"),checked:v,inactive:!0}))),n.Ay.createElement("div",{className:Na.footer},n.Ay.createElement("div",{className:Na.info},u("StoryKeepInfo",e)),n.Ay.createElement("div",{className:Na.submit},n.Ay.createElement(Y.A,{onClick:D},u("StoryPrivacyButtonSave")))))}();case Pa.closeFriends:return n.Ay.createElement(wa,{key:"close-friends",isActive:e,contactListIds:r,currentUserId:o,usersById:i,onClose:R});case Pa.denyList:return n.Ay.createElement(Ca,{key:"deny-list",id:"deny-list",contactListIds:r,currentUserId:o,selectedIds:P,onSelect:L});case Pa.allowList:return n.Ay.createElement(Ca,{key:"allow-list",id:"allow-list",contactListIds:r,lockedIds:I,currentUserId:o,selectedIds:p?.allowUserIds,onSelect:T})}}return n.Ay.createElement(X.A,{isOpen:A,className:(0,ue.A)(Na.modal,"component-theme-dark"),onClose:y,noBackdrop:!0,onCloseAnimationEnd:c},n.Ay.createElement("div",{className:Na.header},n.Ay.createElement(Y.A,{className:(0,ue.A)(Na.closeButton,"close-button"),round:!0,color:"translucent",size:"smaller",onClick:R,ariaLabel:u(w?"Common.Back":"Common.Close")},n.Ay.createElement("div",{className:(0,ue.A)("animated-close-icon",w&&"state-back")})),n.Ay.createElement(ne.Ay,{name:"slideFade",activeKey:b},function(){switch(b){case Pa.privacy:return n.Ay.createElement("h3",{className:Na.headerTitle},u("StoryPrivacyAlertEditTitle"));case Pa.allowList:return n.Ay.createElement("h3",{className:Na.headerTitle},u("StoryPrivacyAlertSelectContactsTitle"));case Pa.closeFriends:return n.Ay.createElement("h3",{className:Na.headerTitle},u("CloseFriends"));case Pa.denyList:return n.Ay.createElement("h3",{className:Na.headerTitle},u("StoryPrivacyAlertExcludedContactsTitle"))}}())),n.Ay.createElement(ne.Ay,{activeKey:b,name:"slideFade",slideClassName:"ChatOrUserPicker_slide",className:Na.content},V))}));var Ta=a(95807),xa=a(36353),Ba=a(73104),La=a(14),Ra=a(52674),Fa=a(95362),Da=a(48775),Va=a(46051),_a=a(45470),Ua=a(39351),Oa=a(38218),Ja=a(83057),Ka=a(66991),Ga=a(61157),ja=a(92111),za=a(73667),Ha=a(65843),$a=a(55158),qa=a(59816),Wa=a(61433),Qa=a(91800),Ya=a(23565),Za=a(35049),Xa=a(18501),en=a(11217),tn=a(86070),an=a(39877);const nn=(0,n.ph)((0,s.EK)((e,{forwardInfo:t})=>({sender:t.fromPeerId?(0,c.PVB)(e,t.fromPeerId):void 0,story:t.storyId&&t.fromPeerId?(0,c.Msb)(e,t.fromPeerId,t.storyId):void 0}))(({className:e,forwardInfo:t,sender:a,story:r})=>{const{openStoryViewer:i,loadPeerStoriesByIds:o,openChat:l}=(0,s.ko)(),c=(0,n.li)(),d=(0,B.A)();(0,n.vJ)(()=>{!r&&t.fromPeerId&&t.storyId&&o({peerId:t.fromPeerId,storyIds:[t.storyId]})},[t,r]);const m=a?(0,Mt.F9)(d,a):t.fromName,u=(0,x.A)(()=>{const{fromPeerId:e,storyId:a}=t;e&&(!r||"isDeleted"in r&&r.isDeleted?l({id:e}):i({peerId:e,storyId:a,isSingleStory:!0}))}),{handleClick:h,handleMouseDown:y}=(0,en.Q)(u);return n.Ay.createElement(tn.A,{ref:c,className:(0,ue.A)("EmbeddedMessage",e,(0,Za.y)(a,!0,!0)),dir:d.isRtl?"rtl":void 0,onClick:h,onMouseDown:y},a?.color?.backgroundEmojiId&&n.Ay.createElement(an.A,{emojiDocumentId:a.color.backgroundEmojiId,className:"EmbeddedMessage--background-icons"}),n.Ay.createElement("div",{className:"message-text"},function(){if(r&&"content"in r&&r.content.text)return n.Ay.createElement("p",{className:"embedded-text-wrapper"},(0,Xa.fd)(r.content.text))}(),n.Ay.createElement("div",{className:"message-title"},function(){if(!a||!m)return;const e=(0,A.L8)(a.id)?"user-filled":"channel-filled";return n.Ay.createElement(n.Ay.Fragment,null,e&&n.Ay.createElement(Q.A,{name:e,className:"embedded-chat-icon"}),m&&(0,Tt.A)(m))}())))}));var sn=a(74936);const rn=(0,n.ph)(function({story:e,isExpanded:t,className:a,onExpand:s,onFold:r}){const i=(0,B.A)(),l=(0,n.li)(),c=(0,n.li)(),d=(0,n.li)(),m=(0,n.li)(),u=(0,La.A)(e,!0),A=u?.content.text,[h,y]=(0,n.J0)(!1),p=(0,Ya.A)(t||void 0,400),g=t||p;(0,n.vJ)(()=>{(0,o.RK)(()=>{c.current&&(t?(0,Wa.YM)(c.current,Yt):(0,Wa.HW)(c.current,Yt))})},[t]);const v=h&&!g,{shouldRender:E,transitionClassNames:f}=(0,Ke.A)(v,void 0,!0,"slow",!0);(0,n.Nf)(()=>{(0,o.YS)(()=>{const e=c.current,t=m.current;if(!e||!t)return;const{offsetWidth:a}=t;(0,o.RK)(()=>{e.style.setProperty("--expand-button-width",`${a}px`)})})},[E,i]),(0,n.Nf)(()=>{(0,o.gm)(()=>{if(!c.current||!d.current)return;const e=c.current,t=d.current,a=t.offsetTop,{lineHeight:n,totalLines:s}=(0,Qa.A)(t),r=s>3,i=a+3*n;return()=>{r&&((0,Wa.YM)(e,"e1gyTmKe"),y(!0)),e.style.setProperty("--_overflow-shift",`${i}px`)}})},[A]),(0,n.vJ)(()=>{t||l.current?.scrollTo({top:0})},[t]);const b=(0,ue.A)("ilyTRZtw",g&&"HIMnUViv",E&&"Vq8pl_kQ");return n.Ay.createElement("div",{className:(0,ue.A)("RKedwa0I",a)},n.Ay.createElement("div",{ref:c,className:b,role:v?"button":void 0,onClick:v?s:r},n.Ay.createElement("div",{ref:l,className:(0,ue.A)("D_5mWNmi","allow-selection","custom-scroll")},u?.forwardInfo&&n.Ay.createElement(nn,{forwardInfo:u.forwardInfo,className:"_M8CgT7s"}),u&&A&&n.Ay.createElement("div",{ref:d,className:"hmFA5qb1"},n.Ay.createElement(sn.A,{messageOrStory:u,withTranslucentThumbs:!0,forcePlayback:!0})))),E&&n.Ay.createElement("div",{ref:m,className:(0,ue.A)("bM5rlQtM",f),onClick:s},i("Story.CaptionShowMore")))});var on=a(26875),ln=a(11241);const cn="YVD19vOP",dn="vJRk_UUk",mn="nIv3YAnZ",un=(0,n.ph)(({story:e,className:t})=>{const{openStoryViewModal:a,openForwardMenu:r,sendStoryReaction:o}=(0,s.ko)(),c=(0,B.A)(),{views:d,isOut:m,peerId:u,id:h,sentReaction:y}=e,{viewsCount:p,forwardsCount:g,reactionsCount:v}=d||{},E=!(0,A.L8)(u),f=y&&(0,l.a0)(y,i.tNZ),b=Boolean((m||E)&&e.isPublic&&!e.noForwards),C=(0,l.$_)(u,h),S=(0,n.Kr)(()=>{const{users:{byId:e}}=(0,s.mS)(),t=d&&"recentViewerIds"in d?d.recentViewerIds:void 0;if(t)return t.map(t=>e[t]).filter(Boolean)},[d]),k=(0,x.A)(()=>{a({storyId:h})}),w=(0,x.A)(()=>{r({fromChatId:u,storyId:h})}),N=(0,x.A)(()=>{const e=y?void 0:i.tNZ;o({peerId:u,storyId:h,containerId:C,reaction:e})});return p?n.Ay.createElement("div",{className:(0,ue.A)(cn,t)},n.Ay.createElement("div",{className:(0,ue.A)("cknL5COh",!E&&"pJAyeGkG"),onClick:E?void 0:k},Boolean(S?.length)&&n.Ay.createElement(on.A,{size:"small",peers:S,className:"Vz_VtJ16"}),E?n.Ay.createElement("span",{className:mn},n.Ay.createElement(Q.A,{name:"channelviews",className:"WyBiNM6e"}),p):n.Ay.createElement("span",{className:mn},c("Views",p,"i")),Boolean(v)&&!E&&n.Ay.createElement("span",{className:"sf3u_6Vh"},n.Ay.createElement(Q.A,{name:"heart",className:"Er2XKRqi"}),v)),n.Ay.createElement("div",{className:"kKoeDk3Z"}),b&&n.Ay.createElement(Y.A,{color:"translucent",size:"smaller",round:!0,onClick:w,ariaLabel:c("Forward"),className:dn},n.Ay.createElement(Q.A,{name:"forward"})),E&&n.Ay.createElement(n.Ay.Fragment,null,Boolean(g)&&n.Ay.createElement("div",{className:dn},n.Ay.createElement(Y.A,{round:!0,color:"translucent",size:"smaller",nonInteractive:!0,ariaLabel:c("PublicShares")},n.Ay.createElement(Q.A,{name:"loop"})),n.Ay.createElement("span",null,g)),n.Ay.createElement("div",{className:dn},n.Ay.createElement(Y.A,{round:!0,className:"lpDXVIuf",color:"translucent",size:"smaller",onClick:N,ariaLabel:c("AccDescrLike")},y&&n.Ay.createElement(ln.A,{key:(0,l.Jj)(y),containerId:C,reaction:y,withEffectOnly:f}),(!y||f)&&n.Ay.createElement(Q.A,{name:f?"heart":"heart-outline",className:(0,ue.A)(f&&"twgMDT1y")})),Boolean(v)&&n.Ay.createElement("span",null,v)))):n.Ay.createElement("div",{className:(0,ue.A)(cn,t)},c("NobodyViewed"))}),An=(0,n.ph)(function({isActive:e,isViewed:t,isVideo:a,duration:s=6,isPaused:r,onImageComplete:i}){const o=(0,x.A)(e=>{a||"XY98E7VM"!==e.animationName||i()}),l=(0,ue.A)("c1fbGgcx",t&&"xwOKghO2",e&&"ZuByYcIx",r&&"n9V6B7hP");return n.Ay.createElement("span",{className:l,"aria-hidden":!0},e&&n.Ay.createElement("i",{style:`--progress-duration: ${s}s`,className:"qyBCpJct",onAnimationEnd:o}))}),hn=E.Yw?4:3,yn=(0,n.ph)((0,s.EK)((e,{peerId:t,storyId:a,isDeleteModalOpen:n})=>{const{appConfig:s}=e,r=(0,c.mBe)(e,t),i=(0,c.hds)(e,t),o=(0,c.vGo)(e,t),l=(0,c.nTw)(e),{storyViewer:{isMuted:d,viewModal:m,isPrivacyModalOpen:u,isStealthModalOpen:A,storyList:h},forwardMessages:{storyId:y},premiumModal:p,safeLinkModalUrl:g,mapModal:v,reportModal:E,giftInfoModal:f,isPaymentMessageConfirmDialogOpen:b}=l,{isOpen:C}=p||{},S=(0,c.Msb)(e,t,a),k=S&&"content"in S,w=Boolean(b||m||y||l.reactionPicker?.storyId||E||u||C||n||g||A||v||f),N=k?S.forwardInfo:void 0,I=k?S.mediaAreas:void 0,P=N?.fromPeerId||I?.find(e=>"channelPost"===e.type)?.channelId,M=P?(0,c.PVB)(e,P):void 0,T=(0,c.xYJ)(e,"mediaViewerAnimations"),x=k&&S.fromId?(0,c.PVB)(e,S.fromId):void 0,B=(0,c.WA9)(e,t),L=(0,c.trm)(e);return{peer:r||i,forwardSender:M,fromPeer:x,story:S,orderedIds:h?.storyIdsByPeerId[t],isMuted:d,isCurrentUserPremium:(0,c.g29)(e),shouldForcePause:w,storyChangelogUserId:s.storyChangelogUserId,viewersExpirePeriod:s.storyExpirePeriod+s.storyViewersExpirePeriod,isChatExist:Boolean(i),arePeerSettingsLoaded:Boolean(o?.settings),stealthMode:e.stories.stealthMode,withHeaderAnimation:T,paidMessagesStars:B,isAccountFrozen:L}})(function({peerId:e,storyId:t,peer:a,forwardSender:r,fromPeer:o,isMuted:c,isArchivedStories:d,isPrivateStories:m,story:u,orderedIds:h,isSingleStory:y,dimensions:p,shouldForcePause:g,storyChangelogUserId:v,viewersExpirePeriod:E,isChatExist:f,arePeerSettingsLoaded:b,getIsAnimating:C,isCurrentUserPremium:S,stealthMode:k,withHeaderAnimation:w,onDelete:N,onClose:P,onReport:T,paidMessagesStars:L,isAccountFrozen:R}){const{viewStory:F,setStoryViewerMuted:D,openPreviousStory:V,openNextStory:_,loadPeerSkippedStories:U,openForwardMenu:O,copyStoryLink:K,toggleStoryInProfile:G,openChat:j,showNotification:z,openStoryPrivacyEditor:H,loadPeerSettings:$,fetchChat:q,loadStoryViews:W,toggleStealthModal:Z}=(0,s.ko)(),X=(0,la.Fm)(),ee=(0,B.A)(),te=(0,Ua.A)(),{isMobile:ae}=(0,I.Ay)(),[se,re,ie]=(0,M.A)(!1),[oe,de,me]=(0,M.A)(!1),[Ae,ye,pe]=(0,M.A)(!1),[ge,ve,Ee]=(0,M.A)(!0),[fe,be,Ce]=(0,M.A)(!1),[Se,ke]=(0,n.J0)(!1),[we,Ne,Ie]=(0,M.A)(!1),[Pe,Me,Te]=(0,M.A)(!1),xe=(0,n.li)(),{isDeletedStory:Be,hasText:Le,hasForwardInfo:Re,thumbnail:Fe,previewBlobUrl:De,isVideo:Ve,noSound:_e,fullMediaData:Ue,altMediaHash:Je,altMediaData:Ge,hasFullData:je,hasThumb:ze,canDownload:He,downloadMediaData:qe}=oa(u,S,Pe),We=u&&"content"in u,Qe=e===v,Ye=(0,A.L8)(e),Ze=!Ye,Xe=Ze&&(0,l.WX)(a),et=We&&u.isOut,tt=(0,La.A)(et?!u.isInProfile:void 0,!0),at=(0,La.A)(et?u.isInProfile:void 0,!0),nt=Boolean(et&&u.date+E<(0,la.Fm)()),st=r?(0,Mt.F9)(ee,r):We&&u.forwardInfo?.fromName,rt=Boolean(We&&u.isPublic&&!Qe&&a?.hasUsername),it=Boolean(We&&u.isPublic&&!u.noForwards&&!Qe&&!fe),ot=Boolean(je&&!g&&ge&&!se&&!fe&&!Se&&!we),lt=We&&u.content.video?.duration?u.content.video.duration:void 0,ct=!(et&&Ye||Qe||Xe||R),dt=We&&!ct&&(et||Xe),mt=ae&&w?"slideFade":"none",{shouldRender:ut,transitionClassNames:At}=(0,Ke.A)(!je),{transitionClassNames:ht}=(0,Ke.A)(Boolean(Ue)),yt=(0,_a.A)(Fe,!ze),pt=(0,Ja.A)(De),{shouldRender:gt,transitionClassNames:vt}=(0,Ke.A)(ct),{shouldRender:Et,transitionClassNames:ft}=(0,Ke.A)(Le&&fe),{transitionClassNames:bt}=(0,Ke.A)(!0),{shouldRender:Ct,transitionClassNames:St}=(0,Ke.A)(Le||Re),kt=(0,Ka.Y)(xe,Ue,Va.G);(0,ja.A)(e,t),(0,n.vJ)(()=>{t&&F({peerId:e,storyId:t})},[t,e]),(0,n.vJ)(()=>{U({peerId:e})},[e]),(0,n.vJ)(()=>{const t=(0,A.L8)(e);!f&&t&&q({chatId:e})},[f,e]),(0,n.vJ)(()=>{f&&!b&&$({peerId:e})},[b,f,e]);const wt=(0,x.A)(()=>{Ve&&xe.current?.pause(),pe(),me()}),Nt=(0,x.A)(()=>{ot&&(de(),Ve||ye())}),It=(0,x.A)(()=>{Ne()}),Pt=(0,x.A)(()=>{Ie()}),Bt=(0,x.A)(()=>{Me(),wt()}),Lt=(0,x.A)(()=>{Te(),Nt()}),{onMouseDown:Rt,onMouseUp:Ft,onMouseLeave:Vt,onTouchStart:_t,onTouchEnd:Ut}=(0,Oa.A)({onStart:It,onEnd:Pt}),Jt=(0,Oe.A)(xe,void 0,!Ve||!Ue||kt),zt=Ue&&(!Je||Ge);(0,n.vJ)(()=>{zt&&!Jt&&Nt()},[zt,Jt]),(0,Ga.Ay)(Ee,ve),(0,n.vJ)(()=>{zt&&xe.current?.load()},[zt]),(0,n.vJ)(()=>{!We||Be||nt||(et||Xe)&&W({peerId:e,storyId:t})},[Be,nt,We,e,t,et,Xe]),(0,n.vJ)(()=>{g||!ge||se||fe||Se||we?wt():Nt()},[Nt,ge,fe,se,g,Se,we]),(0,n.vJ)(()=>{if(!(se||g||fe))return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)};function e(e){32===e.keyCode&&(e.preventDefault(),ke(!Se))}},[fe,se,Se,g]),(0,Sa.A)(([e,t,a,n,s])=>{!Se||fe||se||g||!ge||we||t===fe&&e===se&&a===g&&n===ge&&s===we||ke(!1)},[se,fe,g,ge,we,Se]);const Ht=(0,x.A)(()=>{P(),j({id:e})}),$t=(0,x.A)(()=>{P(),j({id:r.id})}),Yt=(0,x.A)(()=>{P(),j({id:o.id})}),ta=(0,x.A)(()=>{V()}),aa=(0,x.A)(()=>{_()}),na=(0,x.A)(e=>{const t=e.currentTarget;t.readyState>=hn?ye():pe(),lt&&(0,he.LI)(t.currentTime,2)>=(0,he.LI)(lt,2)&&aa()});(0,n.vJ)(()=>C()||se?void 0:(0,Ra.A)({onRight:aa,onLeft:ta}),[C,se]);const sa=(0,x.A)(()=>{K({peerId:e,storyId:t})}),ra=(0,x.A)(()=>{G({peerId:e,storyId:t,isInProfile:!0})}),ia=(0,x.A)(()=>{G({peerId:e,storyId:t,isInProfile:!1})}),ca=(0,x.A)(()=>{N(u)}),da=(0,x.A)(()=>{T()}),ma=(0,x.A)(()=>{O({fromChatId:e,storyId:t})}),ua=(0,x.A)(()=>{H()}),Aa=(0,x.A)(()=>{const e=!We||u.isPublic?void 0:u.isForContacts?"contacts":u.isForCloseFriends?"closeFriends":"nobody";let t;const n=(0,Mt.F9)(ee,a);switch(e){case"nobody":t=ee("StorySelectedContactsHint",n);break;case"contacts":t=ee("StoryContactsHint",n);break;case"closeFriends":t=ee("StoryCloseFriendsHint",n);break;default:return}z({message:t})}),ha=(0,x.A)(()=>{_e?z({message:ee("Story.TooltipVideoHasNoSound")}):(xe.current.muted=!xe.current.muted,D({isMuted:!c}))}),ya=(0,x.A)(()=>{if(k.activeUntil&&(0,la.Fm)()<k.activeUntil){const e=k.activeUntil-(0,la.Fm)();return void z({title:ee("StealthModeOn"),message:ee("Story.ToastStealthModeActiveText",(0,$e.QO)(e)),duration:4e3})}Z({isOpen:!0})}),pa=(0,x.A)(()=>{qe&&(0,Fa.A)(qe,`story-${e}-${t}.${Ve?"mp4":"jpg"}`)});(0,n.vJ)(()=>{Be&&z({message:ee("StoryNotFound")})},[ee,Be]);const ga=(0,n.Kr)(()=>({onTrigger:e,isOpen:t})=>n.Ay.createElement(Y.A,{round:!0,ripple:!ae,size:"tiny",color:"translucent-white",onClick:e,className:(0,ue.A)(Qt,t&&"active"),ariaLabel:ee("AccDescrOpenMenu2")},n.Ay.createElement(Q.A,{name:"more"})),[ae,ee]),va=L?te("ComposerPlaceholderPaidReply",{amount:(0,Da.U2)(te,L,{asFont:!0,className:"placeholder-star-icon"})},{withNodes:!0}):ee(Ze?"ReplyToGroupStory":"ReplyPrivately");return n.Ay.createElement("div",{className:(0,ue.A)(qt,"component-theme-dark"),onMouseDown:Rt,onMouseUp:Ft,onMouseLeave:Vt,onTouchStart:_t,onTouchEnd:Ut},n.Ay.createElement("div",{className:(0,ue.A)("e7HHuS1g",bt)},n.Ay.createElement("div",{className:"jGDd2sza"},(y?[t]:h??[]).map(e=>n.Ay.createElement(An,{key:`progress-${e}`,isActive:e===u?.id,isVideo:Ve,isViewed:Boolean(u?.id&&(m||d?e>u?.id:e<u?.id)),isPaused:!Ae,duration:lt,onImageComplete:aa}))),n.Ay.createElement("div",{className:"eMYhXF_X"},n.Ay.createElement(ne.Ay,{activeKey:Number(e),name:mt,className:"PXnfXZur"},n.Ay.createElement("div",{className:"WpyVfrsc"},n.Ay.createElement(xt.A,{peer:a,size:"tiny",onClick:Ht}),n.Ay.createElement("div",{className:"jmKI_lhC"},n.Ay.createElement("span",{onClick:Ht,className:"H1uod43o"},(0,Tt.A)((0,Mt.F9)(ee,a)||"")),n.Ay.createElement("div",{className:"zimpR8Hz"},st&&n.Ay.createElement("span",{className:(0,ue.A)(Wt,"JJFtefb9",r&&"BsqMBS2I"),onClick:r?$t:void 0},n.Ay.createElement(Q.A,{name:"loop"}),n.Ay.createElement("span",{className:ea},(0,Tt.A)(st))),o&&n.Ay.createElement("span",{className:(0,ue.A)(Wt,"nJr8QgYX"),onClick:Yt},n.Ay.createElement(xt.A,{peer:o,size:"micro"}),n.Ay.createElement("span",{className:ea},(0,Tt.A)((0,Mt.F9)(ee,o)||""))),u&&"date"in u&&n.Ay.createElement("span",{className:Wt},(0,$e.jy)(ee,X,u.date)),We&&u.isEdited&&n.Ay.createElement("span",{className:Wt},ee("Story.HeaderEdited")))))),n.Ay.createElement("div",{className:"GrsJNw3y"},function(){if(!Ye)return;let e="channel-filled";const t={"channel-filled":["#50ABFF","#007AFF"],"user-filled":["#C36EFF","#8B60FA"],"favorite-filled":["#88D93A","#30B73B"],"group-filled":["#FFB743","#F69A36"]};if(et){const{visibility:t}=u&&"visibility"in u&&u.visibility||{};switch(t){case"everybody":e="channel-filled";break;case"contacts":e="user-filled";break;case"closeFriends":e="favorite-filled";break;case"nobody":e="group-filled"}}else{if(!u||!("content"in u)||u.isPublic)return;e=u.isForCloseFriends?"favorite-filled":u.isForContacts?"user-filled":"group-filled"}return n.Ay.createElement("div",{className:(0,ue.A)("prxptFFf",et&&"_MVsZpgB"),onClick:et?ua:Aa,style:`--color-from: ${t[e][0]}; --color-to: ${t[e][1]}`},n.Ay.createElement(Q.A,{name:e}),et&&n.Ay.createElement(Q.A,{name:"next"}))}(),Ve&&n.Ay.createElement(Y.A,{className:Qt,round:!0,ripple:!ae,size:"tiny",color:"translucent-white",disabled:!je,onClick:ha,ariaLabel:ee("Volume")},n.Ay.createElement(Q.A,{name:c||_e?"speaker-muted-story":"speaker-story"})),n.Ay.createElement(le.A,{className:"K0_xAdzf",trigger:ga,positionX:"right",onOpen:Bt,onClose:Lt},rt&&n.Ay.createElement(ce.A,{icon:"copy",onClick:sa},ee("CopyLink")),tt&&n.Ay.createElement(ce.A,{icon:"save-story",onClick:ra},ee(Ye?"StorySave":"SaveToPosts")),at&&n.Ay.createElement(ce.A,{icon:"delete",onClick:ia},ee(Ye?"ArchiveStory":"RemoveFromPosts")),He&&n.Ay.createElement(ce.A,{icon:"download",disabled:!qe,onClick:pa},ee("lng_media_download")),!et&&Ye&&n.Ay.createElement(ce.A,{icon:"eye-crossed-outline",onClick:ya},ee("StealthMode")),!et&&n.Ay.createElement(ce.A,{icon:"flag",onClick:da},ee("lng_report_story")),et&&n.Ay.createElement(ce.A,{icon:"delete",destructive:!0,onClick:ca},ee("Delete"))),n.Ay.createElement(Y.A,{className:(0,ue.A)(Qt,"WlLsjJ2Z"),round:!0,size:"tiny",color:"translucent-white",ariaLabel:ee("Close"),onClick:P},n.Ay.createElement(Q.A,{name:"close"}))))),n.Ay.createElement("div",{className:"YiuvOPgT",style:`width: ${p.width}px; height: ${p.height}px`},n.Ay.createElement("canvas",{ref:yt,className:Xt}),De&&n.Ay.createElement("img",{key:`preview-${t}`,src:De,draggable:!1,alt:"",className:(0,ue.A)(Kt,"lQfkulvp",pt)}),ut&&n.Ay.createElement($a.A,{className:(0,ue.A)(At,Dt)}),!Ve&&Ue&&n.Ay.createElement("img",{src:Ue,alt:"",className:(0,ue.A)(Kt,ht),draggable:!1}),Ve&&Ue&&n.Ay.createElement(Ha.A,{ref:xe,key:`video-${t}`,className:(0,ue.A)(Kt,ht),canPlay:oe,muted:c,width:720,height:1280,draggable:!1,playsInline:!0,disablePictureInPicture:!0,isPriority:!0,onPause:pe,onWaiting:pe,disableRemotePlayback:!0,onTimeUpdate:na},n.Ay.createElement("source",{src:Ue,type:Va.G,width:"720"}),Ge&&n.Ay.createElement("source",{src:Ge,type:Va.w,width:"480"})),!we&&!se&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("button",{type:"button",className:(0,ue.A)(Zt,"SXpRZiax"),onClick:ta,"aria-label":ee("Previous")}),n.Ay.createElement("button",{type:"button",className:(0,ue.A)(Zt,"twOBFwUE"),onClick:aa,"aria-label":ee("Next")})),We&&Ue&&n.Ay.createElement(qa.A,{key:`area-overlay-${t}-${e}`,story:u,isActive:!0,isStoryPlaying:Pe}),!ae&&n.Ay.createElement("div",{className:Ot},n.Ay.createElement("div",{className:Gt},n.Ay.createElement(xt.A,{peer:a,withStory:!0,storyViewerMode:"disabled"}),n.Ay.createElement("div",{className:jt},(0,Tt.A)((0,Mt.F9)(ee,a)||""))))),dt&&n.Ay.createElement(un,{story:u,className:bt}),Et&&n.Ay.createElement("div",{tabIndex:0,role:"button",className:(0,ue.A)("Jd1DYS6Y",ft),onClick:()=>Ce(),"aria-label":ee("Close")}),Le&&n.Ay.createElement("div",{className:(0,ue.A)("sHNAfxzf",St)}),Ct&&n.Ay.createElement(rn,{key:`caption-${t}-${e}`,story:u,isExpanded:fe,onExpand:be,onFold:Ce,className:St}),gt&&n.Ay.createElement(za.A,{type:"story",chatId:e,threadId:J.l3,storyId:t,isReady:!et,messageListType:"thread",isMobile:(0,I.Ny)(),editableInputCssSelector:i.iKt,editableInputId:i.YVZ,inputId:"story-input-text",className:(0,ue.A)("FXineBYO",vt),inputPlaceholder:va,onForward:it?ma:void 0,onFocus:re,onBlur:ie}))})),pn=(0,n.ph)((0,s.EK)((e,{peer:t})=>{const{storyViewer:{lastViewedByPeerId:a,origin:n,storyList:s}}=(0,c.nTw)(e);return{lastViewedId:t?.id?a?.[t.id]:void 0,origin:n,storyIdsForViewer:t?.id?s?.storyIdsByPeerId[t.id]:void 0}})(function({peer:e,peerStories:t,lastViewedId:a,storyIdsForViewer:r,origin:i}){const{openStoryViewer:o,loadPeerSkippedStories:c}=(0,s.ko)(),d=(0,B.A)(),m=(0,n.Kr)(()=>{if(!t)return;const{orderedIds:e,lastReadId:n,byId:s}=t,i=e[e.length-1]!==n,o=a&&r?.includes(a)?a??(i?n??-1:-1):-1;return s[s[o]?.id||r?.[0]||e[0]]},[a,t,r]),u=m&&"content"in m;(0,n.vJ)(()=>{m&&!u&&c({peerId:m.peerId})},[m,u]);const A=u?m.content.video:void 0,h=u?(0,l.EN)(m):void 0,y=(0,H.A)(h)||A?.thumbnail?.dataUri;if(e&&m&&!("isDeleted"in m))return n.Ay.createElement("div",{className:qt,onClick:()=>{o({peerId:m.peerId,storyId:m.id,origin:i})}},y&&n.Ay.createElement("img",{src:y,alt:"",className:Kt,draggable:!1}),u&&n.Ay.createElement(qa.A,{story:m}),n.Ay.createElement("div",{className:Ot},n.Ay.createElement("div",{className:Gt},n.Ay.createElement(xt.A,{peer:e,withStory:!0,storyViewerMode:"disabled"}),n.Ay.createElement("div",{className:jt},(0,Tt.A)((0,Mt.F9)(d,e)||"")))))}));var gn=function(e){return e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical",e}(gn||{});const vn=(0,n.ph)((0,s.EK)(e=>{const{storyViewer:{peerId:t,storyId:a,isSinglePeer:n,isSingleStory:s,isPrivate:r,isArchive:i,storyList:o}}=(0,c.nTw)(e),{byPeerId:l,orderedPeerIds:{active:d}}=e.stories;return{byPeerId:l,peerIds:o?.peerIds??d,currentPeerId:t,currentStoryId:a,isSinglePeer:n,isSingleStory:s,isPrivate:r,isArchive:i}},e=>(0,c.gd2)(e))(function({peerIds:e,currentPeerId:t,currentStoryId:a,isOpen:r,isSinglePeer:d,isSingleStory:m,isPrivate:u,isArchive:A,byPeerId:h,isDeleteModalOpen:y,onDelete:p,onClose:g,onReport:v}){const{stopActiveReaction:f}=(0,s.ko)(),b=(0,n.li)(),[C,S]=(0,n.J0)(t),[k,w]=(0,n.J0)(a),N=(0,U.A)(t),P=(0,La.A)(A,!0),M=(0,La.A)(u,!0),T=(0,La.A)(d,!0),B=(0,La.A)(m,!0),L=ia(),{height:R,width:F}=(0,Se.A)(),D=(0,n.li)(void 0),V=(0,n.li)(!1),{isMobile:_}=(0,I.Ay)(),O=(0,n.li)({}),[J,K]=(0,n.Ul)(!1);function G(e,t){e&&(O.current[t]?O.current[t].current=e:O.current[t]={current:e})}(0,Ee.A)({isActive:r,onBack:g,shouldBeReplaced:!0});const j=(0,n.Kr)(()=>{if(C&&(T||B))return[C];const t=C?e.indexOf(C):-1;if(!C||-1===t)return[];const a=Math.max(t-4,0),n=Math.min(t+5,e.length);return e.slice(a,n)},[B,T,C,e]),z=(0,n.Kr)(()=>j.length&&C?j.indexOf(C):-1,[C,j]),H=(0,n.Kr)(()=>j.length&&t?j.indexOf(t):-1,[t,j]);(0,n.vJ)(()=>{_&&S(t)},[t,_]),(0,n.vJ)(()=>{C===t&&a!==k&&w(a)},[t,a,C,k]),(0,n.vJ)(()=>{if(!_)return N&&N!==t&&K(!0),()=>{K(!1)}},[N,t,K,_]),(0,n.vJ)(()=>()=>{a&&t&&f({containerId:(0,l.$_)(t,a)})},[a,t]);const $=H-z,q=z>H,W=(0,x.A)(()=>e.reduce((a,n,s)=>{if(n===C)a[n]=ra({scale:L.scale,slideAmount:$,isBackward:q,isActiveSlideSize:q});else{let r=!1;!q&&s>0&&e[s-1]===C&&(r=!0),q&&s<e.length-1&&e[s+1]===C&&(r=!0),a[n]=ra({scale:L.scale,slideAmount:$,isBackward:q,isActiveSlideSize:t===n&&!q,isMoveThroughActiveSlide:r})}return a},{}));(0,n.vJ)(()=>{if(!b.current||!r)return;let e=0;const t=()=>C?O.current[C]?.current:void 0,a=a=>{if(V.current)return void(V.current=!1);const n=t();if(n){if(e<-50){const e=document.getElementById(i.YVZ);return void(e&&(0,o.RK)(()=>{(0,xa.A)(e)}))}e>50?(g(),"wheel"===a.type&&((0,Ba.M6)(),setTimeout(Ba.v5,1500))):(0,o.RK)(()=>{n.style.setProperty("--slide-translate-y","0px")})}};return(0,Ae.wJ)(b.current,{isNotPassive:!0,withNativeDrag:!0,withWheelDrag:!0,excludedClosestSelector:".Composer",onDrag:(n,s,{dragOffsetX:r,dragOffsetY:i})=>{if(V.current)return;if(E.pz&&"touchstart"===s.type){const{pageX:e}=s.touches[0];if(e<=Ae.h6||e>=F-Ae.h6)return}if("mousemove"===n.type)return;const l=Math.abs(r),c=Math.abs(i),d=t();if(d&&(D.current===gn.Vertical||Math.abs(c)>Ae.no||c/l>Ae.fG)){D.current=gn.Vertical;const t=R;e=(0,he.qE)(i,-t,t),e>0&&(0,o.RK)(()=>{d.style.setProperty("--slide-translate-y",e*(_?1:-1)+"px")}),"wheel"===n.type&&Math.abs(e)>100&&(a(n),V.current=!0)}},onRelease:a})},[r,g,F,R,_,C]),(0,n.Nf)(()=>{if(_)return;const e=W();Object.entries(O.current).forEach(([a,{current:n}])=>{if(!n)return;if(!J())return n.classList.remove(_t,Ut,Jt),n.style.setProperty("--slide-translate-x","0px"),n.style.setProperty("--slide-translate-y","0px"),n.style.setProperty("--slide-translate-scale","1"),void n.style.setProperty("--slide-content-scale",String(L.toActiveScale));let s=0;a===C&&(s=-1.75*L.fromActiveScale,n.classList.add(Jt)),a===t&&(s=1.75,n.classList.add(Ut)),n.classList.add(_t),n.style.setProperty("--slide-translate-x",`${e[a]||0}px`),n.style.setProperty("--slide-translate-y",`${s}rem`),n.style.setProperty("--slide-translate-scale",t===a?String(L.toActiveScale):a===C?String(L.fromActiveScale):"1")})},[t,J,C,L,_]);const Q=(0,x.A)(e=>{const n=e.target;n&&n.classList.contains($t)&&(C!==t?(S(t),w(a)):a!==k&&w(a),K(!1))});return _?n.Ay.createElement("div",{className:Vt,ref:b},n.Ay.createElement("div",{className:Ht,ref:e=>G(e,C)},n.Ay.createElement(yn,{peerId:C,storyId:k,onDelete:p,dimensions:L.activeSlide,isPrivateStories:M,isArchivedStories:P,isDeleteModalOpen:y,isSingleStory:m,getIsAnimating:J,onClose:g,onReport:v}))):n.Ay.createElement("div",{className:Vt,ref:b,style:`--story-viewer-scale: ${L.scale}`,onTransitionEnd:Q},n.Ay.createElement("div",{className:Dt,onClick:g}),j.length>1&&n.Ay.createElement("div",{className:"xe67dhtF",style:`height: ${L.slide.height}px`}),j.map((e,t)=>e===C?function(e){const t=_?void 0:(0,Ta.A)(`width: ${L.activeSlide.width}px`,`--slide-media-height: ${L.activeSlide.height}px`);return n.Ay.createElement("div",{key:e,ref:t=>G(t,e),className:(0,ue.A)(zt,$t),style:t},n.Ay.createElement(yn,{peerId:e,storyId:k,onDelete:p,dimensions:L.activeSlide,isPrivateStories:M,isArchivedStories:P,isDeleteModalOpen:y,isSingleStory:m,getIsAnimating:J,onClose:g,onReport:v}))}(C):function(e,t,a){const r=(0,Ta.A)(`width: ${L.slide.width}px`,`height: ${L.slide.height}px`),i=(0,ue.A)(zt,"Sef28wEh",`slide-${a}`);return n.Ay.createElement("div",{key:e,ref:t=>G(t,e),className:i,style:r},n.Ay.createElement(pn,{peer:(0,c.PVB)((0,s.mS)(),e),peerStories:h?.[e]}))}(e,0,t-z)))}));function En(e=5){const[t,a]=(0,n.J0)(!0),[s,r]=(0,n.J0)(!0);return{isAtBeginning:t,isAtEnd:s,handleScroll:(0,x.A)(t=>{const{scrollHeight:n,scrollTop:s,clientHeight:i}=t.target;a(s<e),r(n-s-i<e)})}}var fn=a(46222),bn=a(283),Cn=a(36393),Sn=a(51083),kn=a(17751),wn=a(17794);const Nn={"views-list":"gpDY8bos",viewsList:"gpDY8bos","views-list-loading":"vuRAfQ5v",viewsListLoading:"vuRAfQ5v",info:"AOSUIChK",centeredInfo:"oGLhkkS7","view-reaction":"MLaabS6n",viewReaction:"MLaabS6n",header:"d3N2bktu",content:"QmRA3HZK","top-button":"Dkv8GAxf",topButton:"Dkv8GAxf","contact-filter":"YpB_9VxE",contactFilter:"YpB_9VxE",selected:"DoUlpdZJ",sort:"axDpgq9G","sort-button":"Bm5VA66f",sortButton:"Bm5VA66f","icon-sort":"YVQiH93R",iconSort:"YVQiH93R","icon-down":"NXP9aMD0",iconDown:"NXP9aMD0",search:"QQQqBLK6","bottom-info":"_CSv6suH",bottomInfo:"_CSv6suH",scrolled:"RYQ0liYe",footer:"dUK7rP37",closeButton:"abPzLiCH","opacity-fade-in":"cX8oY3zb",opacityFadeIn:"cX8oY3zb",fadeIn:"Sx_aeh1o",blocked:"L82sciL8",check:"UqGBKwjg",menuBubble:"dRqemuTA","with-colored-status":"GQ96fta9",withColoredStatus:"GQ96fta9"},In=1.5*h.$,Pn=(0,n.ph)((0,s.EK)((e,{storyView:t})=>({peer:(0,c.PVB)(e,t.peerId),availableReactions:e.reactions.availableReactions}))(({storyView:e,peer:t,availableReactions:a})=>{const{openChat:r,closeStoryViewer:i,unblockUser:o,blockUser:c,deleteContact:d,updateStoryView:m,focusMessage:u,openStoryViewer:h,closeStoryViewModal:y}=(0,s.ko)(),p=(0,B.A)(),g=(0,x.A)(()=>{const{type:t}=e;if("repost"===t)return y(),void h({peerId:e.peerId,storyId:e.storyId});i(),setTimeout(()=>{"user"===t?r({id:e.peerId}):"forward"===t&&u({chatId:e.peerId,messageId:e.messageId})},100)}),v=(0,n.Kr)(()=>{if(!(0,A.L8)(e.peerId))return;const{peerId:a,areStoriesBlocked:n,isUserBlocked:s}=e,r=t,{isContact:i}=r||{},u=(0,l.Yg)(r),h=[];return s||(n?h.push({handler:()=>{o({userId:a,isOnlyStories:!0}),m({userId:a,areStoriesBlocked:!1})},title:p("StoryShowBackTo",u),icon:"play-story"}):h.push({handler:()=>{c({userId:a,isOnlyStories:!0}),m({userId:a,areStoriesBlocked:!0})},title:p("StoryHideFrom",u),icon:"hand-stop"})),i?h.push({handler:()=>{d({userId:a})},title:p("DeleteContact"),icon:"delete-user",destructive:!0}):h.push({handler:()=>{s?(o({userId:a}),m({userId:a,isUserBlocked:!1})):(c({userId:a}),m({userId:a,isUserBlocked:!0}))},title:p(s?"Unblock":"BlockUser"),icon:s?"user":"delete-user",destructive:!s}),h},[p,e,t]),E="user"===e.type?"message-read":"forward"===e.type?"forward":"loop",f="forward"===e.type||"repost"===e.type,b=(0,n.Kr)(()=>{const t="repost"===e.type&&e.story.forwardInfo?.isModified,a=[(0,$e.U)(p,1e3*e.date)];return t&&a.push(p("lng_edited")),a.join(" • ")},[p,e]);return n.Ay.createElement(ca.A,{key:e.peerId,className:(0,ue.A)("chat-item-clickable small-icon",Nn.opacityFadeIn,(e.isUserBlocked||e.areStoriesBlocked)&&Nn.blocked),onClick:g,rightElement:"user"===e.type&&e.reaction?n.Ay.createElement(wn.A,{reaction:e.reaction,className:Nn.viewReaction,size:In,availableReactions:a,withIconHeart:!0}):void 0,contextActions:v,withPortalForMenu:!0,menuBubbleClassName:Nn.menuBubble},(0,A.L8)(e.peerId)?n.Ay.createElement(kn.A,{className:(0,ue.A)(f&&Nn.withColoredStatus),userId:e.peerId,noStatusOrTyping:!0,status:b,statusIcon:E,withStory:!0,forceShowSelf:!0}):n.Ay.createElement(Sn.A,{className:(0,ue.A)(f&&Nn.withColoredStatus),chatId:e.peerId,status:b,statusIcon:E,withStory:!0}))})),Mn=(0,n.ph)((0,s.EK)(e=>{const{appConfig:t}=e,{storyViewer:{viewModal:a}}=(0,c.nTw)(e),{storyId:n,views:s,nextOffset:r,isLoading:i}=a||{},o=n?(0,c.Msb)(e,e.currentUserId,n):void 0;return{storyId:n,views:s,viewersExpirePeriod:t.storyExpirePeriod+t.storyViewersExpirePeriod,story:o&&"content"in o?o:void 0,nextOffset:r,isLoading:i,availableReactions:e.reactions.availableReactions,isCurrentUserPremium:(0,c.g29)(e)}})(function({story:e,viewersExpirePeriod:t,views:a,nextOffset:r,isLoading:o,isCurrentUserPremium:l}){const{loadStoryViewList:c,closeStoryViewModal:d,clearStoryViews:m}=(0,s.ko)(),[u,A,h]=(0,M.A)(!1),[y,p,g]=(0,M.A)(!0),[v,E]=(0,n.J0)(""),f=(0,B.A)(),b=Boolean(e),C=Boolean(e?.date)&&e.date+t<(0,la.Fm)(),{viewsCount:S=0,reactionsCount:k=0}=e?.views||{},w=e?.isPublic&&S>i.XQO,N=k>i.$4F,I=S>i.frj,P=w||N||I;(0,n.vJ)(()=>{b||(E(""),h(),p())},[b]);const T=(0,ge.A)(()=>{m({isLoading:!0})},[],250,!0);(0,n.vJ)(()=>{T()},[u,y,v,T]);const L=(0,n.Kr)(()=>a?.sort(function(e){return(t,a)=>{if(e){const e="user"===t.type&&t.reaction,n="user"===a.type&&a.reaction;if(e&&!n)return-1;if(!e&&n)return 1}return a.date-t.date}}(y)),[y,a]),R=L?.length?1:Math.min(S,8),F=Boolean(L?.length)&&L.length<S&&C,D=(0,x.A)(()=>{e?.id&&void 0!==r&&c({peerId:e.peerId,storyId:e.id,offset:r,areReactionsFirst:y||void 0,areJustContacts:u||void 0,query:v})}),{handleScroll:V,isAtBeginning:_}=En(),U=(0,x.A)(()=>{d()}),O=(0,n.Kr)(()=>({onTrigger:e,isOpen:t})=>n.Ay.createElement(Y.A,{fluid:!0,size:"tiny",color:"translucent",className:(0,ue.A)(!t&&"active",Nn.sortButton,Nn.topButton),faded:t,onClick:e,ariaLabel:f("SortBy")},n.Ay.createElement(Q.A,{name:y?"heart-outline":"recent",className:Nn.iconSort}),n.Ay.createElement(Q.A,{name:"down",className:Nn.iconDown})),[y,f]);return n.Ay.createElement(X.A,{isOpen:b,onClose:U,className:"component-theme-dark",contentClassName:Nn.viewsList,isSlim:!0},P&&n.Ay.createElement("div",{className:Nn.header},w&&n.Ay.createElement("div",{className:Nn.contactFilter},n.Ay.createElement(Y.A,{className:(0,ue.A)(!u&&Nn.selected,Nn.topButton),size:"tiny",color:"translucent-white",fluid:!0,onClick:h},f("AllViewers")),n.Ay.createElement(Y.A,{className:(0,ue.A)(u&&Nn.selected,Nn.topButton),size:"tiny",color:"translucent-white",fluid:!0,onClick:A},f("Contacts"))),N&&n.Ay.createElement(le.A,{className:Nn.sort,trigger:O,positionX:"right"},n.Ay.createElement(ce.A,{icon:"heart-outline",onClick:p},f("SortByReactions"),y&&n.Ay.createElement(Q.A,{name:"check",className:Nn.check})),n.Ay.createElement(ce.A,{icon:"recent",onClick:g},f("SortByTime"),!y&&n.Ay.createElement(Q.A,{name:"check",className:Nn.check}))),I&&n.Ay.createElement(Cn.A,{className:Nn.search,value:v,onChange:E})),n.Ay.createElement("div",{className:(0,ue.A)(Nn.content,!_&&Nn.topScrolled,"custom-scroll"),onScroll:V},C&&!o&&!v&&Boolean(!L?.length)&&n.Ay.createElement("div",{className:(0,ue.A)(Nn.info,Nn.centeredInfo)},(0,Tt.A)(f(l?"ServerErrorViewers":"ExpiredViewsStub"),["simple_markdown","emoji"])),!o&&Boolean(v.length)&&!L?.length&&n.Ay.createElement("div",{className:Nn.info},f("Story.ViewList.EmptyTextSearch")),n.Ay.createElement(fn.A,{items:L,onLoadMore:D},L?.map(e=>{const t="forward"===e.type?e.messageId:"repost"===e.type?e.storyId:"user";return n.Ay.createElement(Pn,{key:`${e.peerId}-${e.date}-${t}`,storyView:e})}),o&&Array.from({length:R}).map((e,t)=>n.Ay.createElement(ca.A,{key:`placeholder-${t}`,className:"chat-item-clickable contact-list-item scroll-item small-icon",disabled:!0},n.Ay.createElement(bn.A,null))),F&&n.Ay.createElement("div",{key:"not-all-available",className:(0,ue.A)(Nn.info,Nn.bottomInfo)},f("Story.ViewList.NotFullyRecorded")))),n.Ay.createElement("div",{className:(0,ue.A)(Nn.footer,"dialog-buttons")},n.Ay.createElement(Y.A,{className:(0,ue.A)("confirm-dialog-button",Nn.close),isText:!0,onClick:U},f("Close"))))})),Tn=(0,n.ph)((0,s.EK)(e=>{const{shouldSkipHistoryAnimations:t,storyViewer:{storyId:a,peerId:n,isPrivacyModalOpen:s,origin:r}}=(0,c.nTw)(e),i=n&&a?(0,c.Msb)(e,n,a):void 0,o=(0,c.xYJ)(e,"mediaViewerAnimations");return{isOpen:(0,c.gd2)(e),shouldSkipHistoryAnimations:t,peerId:n,storyId:a,story:i,origin:r,withAnimation:o,isPrivacyModalOpen:s}})(function({isOpen:e,peerId:t,storyId:a,story:r,origin:l,shouldSkipHistoryAnimations:c,withAnimation:d,isPrivacyModalOpen:A}){const{closeStoryViewer:h,closeStoryPrivacyEditor:y,reportStory:p}=(0,s.ko)(),g=(0,B.A)(),[E,f]=(0,n.J0)(void 0),[b,C,k]=(0,M.A)(!1),{bestImageData:w,thumbnail:N}=oa(r),I=ia(),P=(0,U.A)(e),T=(0,U.A)(w),L=(0,U.A)(t),R=(0,U.A)(l),F=Boolean(d&&!c);(0,n.vJ)(()=>{e||(f(void 0),k())},[e]),(0,n.vJ)(()=>{if(!e)return;(0,u.FD)();const t=(0,O.w4)();return()=>{(0,u.wb)(),t()}},[e]);const D=(0,n.hb)(()=>{h()},[h]),V=(0,x.A)(e=>{f(e),C()}),_=(0,x.A)(()=>{k(),f(void 0)}),J=(0,x.A)(()=>{a&&p({storyId:a,peerId:t})});return(0,n.vJ)(()=>e?(0,m.A)(()=>{D()}):void 0,[D,e]),(0,n.vJ)(()=>{F&&!P&&e&&t&&N&&void 0!==l&&((0,n.VK)(250+i.xB5),function(e,t,a,n,s){const{mediaEl:r}=sa(t,e);if(!r)return;const{width:l,height:c}=S.A.get();let{width:d,height:m}=s;const u=l<=600;if(u){d=l-2*aa,m=c-ta-2*aa;const e=getComputedStyle(document.documentElement).getPropertyValue("--safe-area-bottom");e&&(m-=parseFloat(e))}const A=u?aa:(l-d)/2,h=u?aa:(c-(m+ta))/2,{top:y,left:p,width:g,height:E}=r.getBoundingClientRect(),f=p+g/2-(A+d/2),b=y+E/2-(h+m/2),C=g/d,k=E/m;(0,o.RK)(()=>{const e=na(n||a,!n);(0,v.ZM)(e,{top:`${h}px`,left:`${A}px`,width:`${d}px`,height:`${m}px`,transform:`translate3d(${f}px, ${b}px, 0) scale(${C}, ${k})`});const t=document.getElementById("StoryViewer");t.appendChild(e),document.body.classList.add("ghost-animating"),(0,o.RK)(()=>{(0,v.ZM)(e,{transform:""}),setTimeout(()=>{(0,o.RK)(()=>{t.contains(e)&&t.removeChild(e),document.body.classList.remove("ghost-animating")})},200+i.xB5)})})}(t,l,N,w,I.activeSlide)),F&&P&&!e&&L&&T&&void 0!==R&&((0,n.VK)(250+i.xB5),function(e,t,a){const{mediaEl:n}=sa(t,e),s=document.getElementById("StoryViewer").querySelector(`.${Ht} .${Kt}, .${$t} .${Kt}`);if(!s||!n)return;const{top:r,left:l,width:c,height:d}=s.getBoundingClientRect(),{top:m,left:u,width:A,height:h}=n.getBoundingClientRect(),y=u+A/2-(l+c/2),p=m+h/2-(r+d/2),g=A/c,E=h/d;(0,o.RK)(()=>{const e=na(a);(0,v.ZM)(e,{top:`${r}px`,left:`${l}px`,width:`${c}px`,height:`${d}px`});const t=na(n.src,void 0,!0),s=r+d/2-c/2;(0,v.ZM)(t,{top:`${s}px`,left:`${l}px`,width:`${c}px`,height:`${c}px`});const m=document.getElementById("StoryViewer");m.appendChild(e),document.body.appendChild(t),document.body.classList.add("ghost-animating"),(0,o.RK)(()=>{(0,v.ZM)(e,{transform:`translate3d(${y}px, ${p}px, 0) scale(${g}, ${E})`}),(0,v.ZM)(t,{transform:`translate3d(${y}px, ${p}px, 0) scale(${g})`,opacity:"1"}),setTimeout(()=>{(0,o.RK)(()=>{m.contains(e)&&m.removeChild(e),document.body.contains(t)&&document.body.removeChild(t),document.body.classList.remove("ghost-animating")})},200+i.xB5)})})}(L,R,T))},[F,w,T,e,P,I.activeSlide,N,t,L,l,R]),n.Ay.createElement(ae.A,{id:"StoryViewer",className:"bu_hGbaa",isOpen:e,shouldAnimateFirstRender:!0,noCloseTransition:c},n.Ay.createElement("div",{className:"OFh6u50Q",onClick:D}),n.Ay.createElement(Y.A,{className:"Mye8Dwxa",round:!0,size:"smaller",color:"translucent-white",ariaLabel:g("Close"),onClick:D},n.Ay.createElement(Q.A,{name:"close"})),n.Ay.createElement(vn,{isOpen:e,isDeleteModalOpen:b,onReport:J,onClose:D,onDelete:V}),n.Ay.createElement(pa,{isOpen:b,story:E,onClose:_}),n.Ay.createElement(Mn,null),n.Ay.createElement(ha,null),n.Ay.createElement(Ma,{isOpen:A,onClose:y}))}));var xn=a(79582),Bn=a(63527),Ln=a(96374),Rn=a(79174),Fn=a(10328),Dn=a(52745),Vn=a(34431),_n=a(38102),Un=a(45780);const On=2.75*h.$,Jn="ChatOrUserPicker-item",Kn=(0,n.ph)(({isOpen:e,currentUserId:t,chatOrUserIds:a,search:r,searchPlaceholder:o,className:d,loadMore:m,onSearchChange:u,onSelectChatOrUser:A,onClose:h,onCloseAnimationEnd:y,isLowStackPriority:p})=>{const{loadTopics:g}=(0,s.ko)(),v=(0,B.A)(),E=(0,n.li)(),f=(0,n.li)(),b=(0,n.li)(),C=(0,n.li)(),[S,k]=(0,Ln.A)(m,a,Boolean(r)),[w,N]=(0,n.J0)(void 0),[I,P]=(0,n.J0)(""),M=w?1:0,T=a.indexOf(S[0]),L=(0,x.A)(()=>{u("")});(0,Rn.A)(b,e&&0===M,L),(0,Rn.A)(C,e&&1===M);const R=(0,x.A)(e=>{if(w)return(0,c.pSx)(e,w)}),F=(0,Bn.A)(R),[D,V]=(0,n.Kr)(()=>{const e=(0,s.mS)(),t=e.chats.byId,a=e.chats.fullInfoById,n=t[w];if(!n||!F)return[void 0,void 0];const r=I.toLowerCase(),i=F?Object.values(F).reduce((e,t)=>(!(0,l.__)(n,t,void 0,a[w])||r&&!t.title.toLowerCase().includes(r)||(e[t.id]=t),e),{}):F;return[Object.keys(i).map(Number),i]},[w,I,F]),_=(0,x.A)(()=>{N(void 0),P("")}),U=(0,x.A)(e=>{u(e.currentTarget.value)}),O=(0,x.A)(e=>{P(e.currentTarget.value)}),J=(0,Fn.A)(E,e,e=>{if(S&&S.length>0){const t=(0,s.mS)().chats.byId,a=S[-1===e?0:e],n=t[a];n?.isForum?(F||g({chatId:a}),N(a)):A(a)}},`.${Jn}`,!0),K=(0,Fn.A)(f,e,e=>{D?.length&&A(w,D[-1===e?0:e])},`.${Jn}`,!0),G=(0,x.A)(e=>{const t=(0,s.mS)().chats.byId,a=t?.[e];a?.isForum?(F||g({chatId:e}),N(e),L()):A(e)}),j=(0,n.hb)((e,a)=>{const r=(0,s.mS)();let o=(0,c.PVB)(r,e);if(!o)return;const d=(0,c.k2W)(r,e);d&&(o=d);const m=o&&!(0,Mt.vj)(o)?o.isSelf:void 0,[u,A]=function(){if(!o)return;if(o.id===t)return[v("SavedMessagesInfo")];if((0,Mt.vj)(o))return[(0,l.sT)(v,o)];const e=(0,c.K0y)(r,o.id);return[(0,l.CD)(v,o,e),(0,ue.A)((0,l.PF)(o,e,!0)&&"online")]}()||[];return n.Ay.createElement(Un.A,{key:e,className:Jn,title:n.Ay.createElement("div",{className:"title-wrapper"},n.Ay.createElement(Vn.A,{className:"item-title",peer:o,isMonoforum:Boolean(d),isSavedMessages:m})),avatarElement:n.Ay.createElement(xt.A,{peer:o,asMessageBubble:Boolean(d),isSavedMessages:m,size:"medium"}),subtitle:u,subtitleClassName:A,ripple:!0,style:`top: ${(T+a)*i.xw7}px;`,onClick:()=>G(e)})},[t,v,T]);return n.Ay.createElement(X.A,{isOpen:e,className:(0,ue.A)("ChatOrUserPicker",d),onClose:h,onCloseAnimationEnd:y,isLowStackPriority:p},n.Ay.createElement(ne.Ay,{activeKey:M,name:"slideFade",slideClassName:"ChatOrUserPicker_slide"},()=>1===M?n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:"modal-header",dir:v.isRtl?"rtl":void 0},n.Ay.createElement(Y.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:v("Back"),onClick:_},n.Ay.createElement(Q.A,{name:"arrow-left"})),n.Ay.createElement(Z.A,{ref:C,value:I,onChange:O,onKeyDown:K,placeholder:o})),n.Ay.createElement(fn.A,{ref:f,className:"picker-list custom-scroll",items:D,withAbsolutePositioning:!0,maxHeight:56*(D?.length||0),onKeyDown:K},!D&&n.Ay.createElement(Dn.A,null),D?.map((e,t)=>n.Ay.createElement(Un.A,{key:`${w}_${e}`,className:Jn,onClick:()=>A(w,e),style:`top: ${56*(T+t)}px;`,avatarElement:n.Ay.createElement(_n.A,{size:On,topic:V[e],className:"topic-icon",letterClassName:"topic-icon-letter"}),title:(0,Tt.A)(V[e].title)})))):n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:"modal-header",dir:v.isRtl?"rtl":void 0},n.Ay.createElement(Y.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:v("Close"),onClick:h},n.Ay.createElement(Q.A,{name:"close"})),n.Ay.createElement(Z.A,{ref:b,value:r,onChange:U,onKeyDown:J,placeholder:o})),S?.length?n.Ay.createElement(fn.A,{ref:E,className:"picker-list custom-scroll",items:S,itemSelector:`.${Jn}`,onLoadMore:k,withAbsolutePositioning:!0,maxHeight:a.length*i.xw7,onKeyDown:J},S.map(j)):S&&!S.length?n.Ay.createElement("p",{className:"no-results"},v("lng_blocked_list_not_found")):n.Ay.createElement(Dn.A,null))))}),Gn=(0,n.ph)((0,s.EK)(e=>{const{chats:{listIds:t,orderedPinnedIds:a},currentUserId:n}=e;return{activeListIds:t.active,archivedListIds:t.archived,pinnedIds:a.active,contactIds:e.contactList?.userIds,currentUserId:n}})(({isOpen:e,currentUserId:t,activeListIds:a,archivedListIds:r,pinnedIds:o,contactIds:d,filter:m=i.K_A,className:u,searchPlaceholder:A,loadMore:h,onSelectRecipient:y,onClose:p,onCloseAnimationEnd:g,isLowStackPriority:v,isForwarding:E})=>{const[f,b]=(0,n.J0)(""),C=(0,n.Kr)(()=>{if(!e)return;let n=o||[];t&&(n=(0,Ea.Am)([t,...n]));const i=(0,s.mS)(),u=[...a||[],...f&&r||[]].filter(e=>{const t=(0,c.hds)(i,e),a=(0,c.mBe)(i,e),n=t&&(0,l.ub)(t,"postMessages"),s=t&&(0,l.WX)(t);if(E&&s&&!n)return!1;if(a&&!(0,l.PL)(a))return!0;if(!t)return!1;if(t.isMonoforum&&(0,c.ODG)(i,e))return!1;const r=(0,c.AWZ)(i,e);return!r||(0,l.__)(t,void 0,void 0,r)}),A=(0,xn.A)((0,Mt.PU)({ids:(0,Ea.Am)([...t?[t]:[],...u,...d||[]]),query:f}),void 0,n,t);return(0,c.yMZ)(i,A,m)},[e,o,t,a,f,r,d,m,E]),S=(0,La.A)(C,!0);return n.Ay.createElement(Kn,{isOpen:e,className:u,chatOrUserIds:S,currentUserId:t,searchPlaceholder:A,search:f,onSearchChange:b,loadMore:h,onSelectChatOrUser:y,onClose:p,onCloseAnimationEnd:g,isLowStackPriority:v})})),jn=(0,n.ph)((0,s.EK)(e=>{const{messageIds:t,storyId:a}=(0,c.nTw)(e).forwardMessages,n=t&&t.length>0;return{currentUserId:e.currentUserId,isManyMessages:(t?.length||0)>1,isStory:Boolean(a),isForwarding:n}})(({isOpen:e,currentUserId:t,isManyMessages:a,isStory:r,isForwarding:i})=>{const{openChatOrTopicWithReplyInDraft:o,setForwardChatOrTopic:d,exitForwardMode:m,forwardToSavedMessages:u,forwardStory:h,showNotification:y}=(0,s.ko)(),p=(0,B.A)(),g=(0,U.A)(r,!0),[v,E,f]=(0,M.A)();(0,n.vJ)(()=>{e&&E()},[e,E]);const b=(0,n.hb)((e,n)=>{const m=e===t;if(r){h({toChatId:e});const t=(0,s.mS)();if((0,A.L8)(e))y({message:m?p("Conversation.StoryForwardTooltip.SavedMessages.One"):p("StorySharedTo",(0,l.u0)((0,c.mBe)(t,e)))});else{const a=(0,c.hds)(t,e);if(!a)return;y({message:p("StorySharedTo",(0,l.Js)(p,a))})}return}if(m){const e=p(a?"Conversation.ForwardTooltip.SavedMessages.Many":"Conversation.ForwardTooltip.SavedMessages.One");u(),y({message:e})}else{const t=e,a=n?Number(n):void 0;i?d({chatId:t,topicId:a}):o({chatId:t,topicId:a})}},[t,a,r,p,i]),C=(0,n.hb)(()=>{m()},[m]);if(e||v)return n.Ay.createElement(Gn,{isOpen:e,className:g?"component-theme-dark":void 0,searchPlaceholder:p(i?"ForwardTo":"ReplyToDialog"),onSelectRecipient:b,onClose:C,onCloseAnimationEnd:f,isForwarding:i})})),zn=(0,n.ph)(({requestedDraft:e})=>{const t=Boolean(e&&!e.chatId),{openChatWithDraft:a,resetOpenChatWithDraft:r}=(0,s.ko)(),i=(0,B.A)(),[o,l,c]=(0,M.A)();(0,n.vJ)(()=>{t&&l()},[t,l]);const d=(0,n.hb)((t,n)=>{a({chatId:t,threadId:n,text:e.text,files:e.files})},[a,e]),m=(0,n.hb)(()=>{r()},[r]);if(t||o)return n.Ay.createElement(Gn,{isOpen:t,searchPlaceholder:i("ForwardTo"),filter:e?.filter,onSelectRecipient:d,onClose:m,onCloseAnimationEnd:c})}),Hn=(0,n.ph)(({requestedAttachBotInChat:e})=>{const{cancelAttachBotInChat:t,callAttachBot:a}=(0,s.ko)(),r=(0,B.A)(),i=Boolean(e),[o,l,c]=(0,M.A)();(0,n.vJ)(()=>{i&&l()},[i,l]);const{bot:d,filter:m,startParam:u}=e||{},A=(0,n.hb)(e=>{a({bot:d,chatId:e,startParam:u}),t()},[d,a,t,u]);if(i||o)return n.Ay.createElement(Gn,{isOpen:i,searchPlaceholder:r("Search"),filter:m,onSelectRecipient:A,onClose:t,onCloseAnimationEnd:c})});var $n=a(99375);function qn(e){return e.isSlowMode?"Slowmode enabled":e.hasErrorKey?"Something went wrong":"Telegram"}const Wn=(0,n.ph)((0,s.EK)(e=>({dialogs:(0,c.nTw)(e).dialogs,currentMessageList:(0,c.Xf0)(e)}))(({dialogs:e,currentMessageList:t})=>{const{dismissDialog:a,sendMessage:r}=(0,s.ko)(),[i,o,l]=(0,M.A)(),c=(0,B.A)();var d,m,u;if((0,n.vJ)(()=>{e.length>0&&o()},[e,o]),e.length)return Boolean(e.length)&&("phoneNumber"in(d=e[e.length-1])?(m=d,n.Ay.createElement(X.A,{isOpen:i,onClose:l,className:"confirm",title:c("ShareYouPhoneNumberTitle"),onCloseAnimationEnd:a},c("AreYouSureShareMyContactInfoBot"),n.Ay.createElement("div",{className:"dialog-buttons mt-2"},n.Ay.createElement(Y.A,{className:"confirm-dialog-button",isText:!0,onClick:()=>{t&&(r({contact:m,messageList:t}),l())}},c("OK")),n.Ay.createElement(Y.A,{className:"confirm-dialog-button",isText:!0,onClick:l},c("Cancel"))))):(u=d,n.Ay.createElement(X.A,{isOpen:i,onClose:l,onCloseAnimationEnd:a,className:"error",title:qn(u)},u.hasErrorKey?(0,$n.Ay)(u):(0,Tt.A)(u.message,["simple_markdown","emoji","br"]),n.Ay.createElement("div",{className:"dialog-buttons mt-2"},n.Ay.createElement(Y.A,{isText:!0,onClick:l},c("OK"))))))}));var Qn=a(17208);const Yn=(0,n.ph)((0,s.EK)(e=>(0,Ea.Up)((0,c.nTw)(e),["notifications"]))(({notifications:e})=>{if(e.length)return n.Ay.createElement("div",{id:"Notifications"},e.map(e=>n.Ay.createElement(Qn.A,{key:e.localId,notification:e})))}));var Zn=a(93578);const Xn=(0,n.ph)(({url:e})=>{const{toggleSafeLinkModal:t}=(0,s.ko)(),a=(0,Ua.A)(),r=(0,n.hb)(()=>{e&&(window.open((0,Zn.Tc)(e),"_blank","noopener noreferrer"),t({url:void 0}))},[t,e]),i=(0,n.hb)(()=>{t({url:void 0})},[t]),o=(0,La.A)(e);return n.Ay.createElement(ya.A,{isOpen:Boolean(e),onClose:i,title:a("OpenUrlTitle"),textParts:(0,Tt.A)(a("OpenUrlText",{url:o},{withNodes:!0,withMarkdown:!0})),confirmLabel:a("OpenUrlConfirm"),confirmHandler:r})});var es=a(47526);const ts=(0,n.ph)(({modal:e})=>{const{closeMapModal:t}=(0,s.ko)(),{point:a,zoom:r}=e||{},i=(0,B.A)(),o=Boolean(a),l=(0,x.A)(()=>{t()}),[c,d,m,u]=(0,n.Kr)(()=>{if(!a)return[];const e=(0,es.zS)("google",a,r),t=(0,es.zS)("bing",a,r),n=(0,es.zS)("osm",a,r);return[e,t,(0,es.zS)("apple",a,r),n]},[a,r]),A=(0,x.A)(e=>{t(),window.open(e,"_blank","noopener")}),h=(0,x.A)(()=>{A(c)}),y=(0,x.A)(()=>{A(d)}),p=(0,x.A)(()=>{A(m)}),g=(0,x.A)(()=>{A(u)});return n.Ay.createElement(X.A,{contentClassName:"VJDwJpsF",title:i("OpenMapWith"),isOpen:o,onClose:l,isSlim:!0},n.Ay.createElement("div",{className:"aYO2C2Hx"},(E.pz||E.MP)&&n.Ay.createElement(Y.A,{fluid:!0,size:"smaller",onClick:p},"Apple Maps"),n.Ay.createElement(Y.A,{fluid:!0,size:"smaller",onClick:h},"Google Maps"),n.Ay.createElement(Y.A,{fluid:!0,size:"smaller",onClick:y},"Bing Maps"),n.Ay.createElement(Y.A,{fluid:!0,size:"smaller",onClick:g},"OpenStreetMap")),n.Ay.createElement("div",{className:"dialog-buttons mt-2"},n.Ay.createElement(Y.A,{className:"confirm-dialog-button",isText:!0,onClick:l},i("Cancel"))))});var as=a(19806);const ns=(0,n.ph)((0,s.EK)(e=>({currentUser:(0,c.mBe)(e,e.currentUserId)}))(({modal:e,currentUser:t})=>{const{closeUrlAuthModal:a,acceptBotUrlAuth:r,acceptLinkUrlAuth:i}=(0,s.ko)(),[o,c]=(0,n.J0)(!0),[d,m]=(0,n.J0)(!0),u=(0,La.A)(e,!1),{domain:A,botId:h,shouldRequestWriteAccess:y}=u?.request||{},p=h?(0,s.mS)().users.byId[h]:void 0,g=(0,B.A)(),v=(0,n.hb)(()=>{e?.url&&o?(e.button?r:i)({isWriteAllowed:d}):u?.url&&window.open((0,Zn.Tc)(u.url),"_blank","noopener"),a()},[e,o,a,r,i,d,u]),E=(0,n.hb)(()=>{a()},[a]),f=(0,n.hb)(e=>{c(e),m(e)},[c]);return(0,n.vJ)(()=>{A&&(c(!0),m(Boolean(y)))},[y,A]),n.Ay.createElement(ya.A,{isOpen:Boolean(e?.url),onClose:E,title:g("OpenUrlTitle"),confirmLabel:g("OpenUrlTitle"),confirmHandler:v},(0,Tt.A)(g("OpenUrlAlert2",u?.url),["links"]),A&&n.Ay.createElement(as.A,{className:"dialog-checkbox",checked:o,label:n.Ay.createElement(n.Ay.Fragment,null,(0,Tt.A)(g("Conversation.OpenBotLinkLogin",[A,(0,l.Yg)(t)]),["simple_markdown"])),onCheck:f}),y&&n.Ay.createElement(as.A,{className:"dialog-checkbox",checked:d,label:n.Ay.createElement(n.Ay.Fragment,null,(0,Tt.A)(g("Conversation.OpenBotLinkAllowMessages",(0,l.Yg)(p)),["simple_markdown"])),onCheck:m,disabled:!o}))})),ss=1e3*i.fRl,rs=["lng_weekday1","lng_weekday2","lng_weekday3","lng_weekday4","lng_weekday5","lng_weekday6","lng_weekday7"];function is(e,t,a,n,s){const r=new Date(e,t,a),i=n&&(0,$e.pU)(n),o=s&&(0,$e.pU)(s);return!!(o&&r>o)||!!(i&&r<i)}function os(e){return String(e).padStart(2,"0")}function ls(e,t,a){return`${e}-${t+1}-${a}`}const cs=(0,n.ph)(({selectedAt:e,minAt:t,maxAt:a,isFutureMode:s,isPastMode:r,isOpen:i,withTimePicker:o,submitButtonLabel:l,secondButtonLabel:c,description:d,onClose:m,onSubmit:u,onDateChange:A,onSecondButtonClick:h})=>{const y=(0,B.A)(),p=new Date,g=(0,n.Kr)(()=>s&&!t?new Date:new Date(Math.max(t||0,0)),[s,t]),v=(0,n.Kr)(()=>r&&!a?new Date:new Date(Math.min(a||ss,ss)),[r,a]),E=(0,n.Kr)(()=>e?new Date(e):new Date,[e]),f=(0,U.A)(i),[b,C]=(0,M.A)(!1),[S,k]=(0,n.J0)(E),[w,N]=(0,n.J0)(new Date(S.getFullYear(),S.getMonth(),1)),[I,P]=(0,n.J0)(os(E.getHours())),[T,x]=(0,n.J0)(os(E.getMinutes())),L=ls(S.getFullYear(),S.getMonth(),S.getDate()),R=w.getFullYear(),F=w.getMonth(),D=s&&S.getTime()<g.getTime()||r&&S.getTime()>v.getTime();(0,n.vJ)(()=>{!f&&i&&(k(E),N(new Date(E.getFullYear(),E.getMonth(),1)),o&&(P(os(E.getHours())),x(os(E.getMinutes()))))},[E,i,f,o]),(0,n.vJ)(()=>{s&&!b&&S.getTime()<g.getTime()&&(k(g),P(os(g.getHours())),x(os(g.getMinutes())))},[s,b,g,S]),(0,n.vJ)(()=>{r&&!b&&S.getTime()>v.getTime()&&(k(v),P(os(v.getHours())),x(os(v.getMinutes())))},[s,r,b,v,g,S]),(0,n.vJ)(()=>{if(e){const t=new Date(e);k(t),P(os(t.getHours())),x(os(t.getMinutes()))}},[e]);const V=r&&R>=p.getFullYear()&&F>=p.getMonth()||v&&R>=v.getFullYear()&&F>=v.getMonth(),_=s&&R<=p.getFullYear()&&F<=p.getMonth(),{prevMonthGrid:O,currentMonthGrid:J,nextMonthGrid:K}=(0,n.Kr)(()=>function(e,t){const a=[],n=[],s=[],r=new Date;r.setDate(1),r.setMonth(t),r.setFullYear(e);const i=r.getDay()||7,o=new Date(e,t,0).getDate();for(let e=1;e<i;e++)a.push(o-i+e+1);for(;r.getMonth()===t;){const e=r.getDate();n.push(e),r.setDate(e+1)}const l=(n.length+a.length)%7;if(l>0)for(let e=1;e<=7-l;e++)s.push(e);return{prevMonthGrid:a,currentMonthGrid:n,nextMonthGrid:s}}(R,F),[F,R]),G=(0,n.Kr)(()=>l||function(e,t){const a=(0,$e.A)(t,e.code);return a===(0,$e.A)(new Date,e.code)?e("Conversation.ScheduleMessage.SendToday",(0,$e.fU)(e,t)):e("Conversation.ScheduleMessage.SendOn",[a,(0,$e.fU)(e,t)])}(y,S),[y,S,l]),j=(0,n.hb)(()=>{u(s&&S<g?g:r&&S>v?v:S)},[s,r,g,v,u,S]),z=(0,n.hb)(e=>{const t=e.target.value.replace(/[^\d]+/g,"");if(!t.length)return P(""),void(e.target.value="");const a=Math.max(0,Math.min(Number(t),23)),n=new Date(S.getTime());n.setHours(a),k(n),A?.(n);const s=os(a);P(s),e.target.value=s},[S,A]),H=(0,n.hb)(e=>{const t=e.target.value.replace(/[^\d]+/g,"");if(!t.length)return x(""),void(e.target.value="");const a=Math.max(0,Math.min(Number(t),59)),n=new Date(S.getTime());n.setMinutes(a),k(n),A?.(n);const s=os(a);x(s),e.target.value=s},[S,A]);return n.Ay.createElement(X.A,{isOpen:i,onClose:m,className:"CalendarModal",onEnter:j},n.Ay.createElement("div",{className:"container"},n.Ay.createElement("div",{className:"month-selector"},n.Ay.createElement(Y.A,{round:!0,size:"smaller",color:"translucent",onClick:m},n.Ay.createElement(Q.A,{name:"close"})),n.Ay.createElement("h4",null,y(`lng_month${F+1}`)," ",R),n.Ay.createElement(Y.A,{round:!0,size:"smaller",color:"translucent",disabled:_,onClick:_?void 0:function(){N(e=>{const t=new Date(e);return t.setMonth(t.getMonth()-1),t})}},n.Ay.createElement(Q.A,{name:"previous"})),n.Ay.createElement(Y.A,{round:!0,size:"smaller",color:"translucent",disabled:V,onClick:V?void 0:function(){N(e=>{const t=new Date(e);return t.setMonth(t.getMonth()+1),t})}},n.Ay.createElement(Q.A,{name:"next"})))),n.Ay.createElement("div",{className:"calendar-wrapper"},n.Ay.createElement("div",{className:"calendar-grid"},rs.map(e=>n.Ay.createElement("div",{className:"day-button faded weekday"},n.Ay.createElement("span",null,y(e)))),O.map(e=>n.Ay.createElement("div",{className:"day-button disabled"},n.Ay.createElement("span",null,e))),J.map(e=>n.Ay.createElement("div",{role:"button",tabIndex:0,onClick:()=>{return t=e,void k(e=>{const a=new Date(e);return a.setDate(t),a.setMonth(F),a.setFullYear(R),A?.(a),a});var t},className:(0,ue.A)("day-button","div-button",is(R,F,e,g,v)?"disabled":e?"clickable":"",L===ls(R,F,e)&&"selected")},Boolean(e)&&n.Ay.createElement("span",null,e))),K.map(e=>n.Ay.createElement("div",{className:"day-button disabled"},n.Ay.createElement("span",null,e))))),o&&n.Ay.createElement("div",{className:"timepicker"},n.Ay.createElement("input",{type:"text",className:"form-control",inputMode:"decimal",value:I,onChange:z,onFocus:C}),":",n.Ay.createElement("input",{type:"text",className:"form-control",inputMode:"decimal",value:T,onChange:H,onFocus:C})),n.Ay.createElement("div",{className:"footer"},d&&n.Ay.createElement("div",{className:"description"},d),n.Ay.createElement("div",{className:"footer"},n.Ay.createElement(Y.A,{onClick:j,disabled:D},G),c&&n.Ay.createElement(Y.A,{onClick:h,isText:!0},c))))}),ds=(0,n.ph)((0,s.EK)(e=>({selectedAt:(0,c.nTw)(e).historyCalendarSelectedAt}))(({isOpen:e,selectedAt:t})=>{const{searchMessagesByDate:a,closeHistoryCalendar:r}=(0,s.ko)(),i=(0,n.hb)(e=>{a({timestamp:e.getTime()/1e3}),r()},[r,a]),o=(0,B.A)();return n.Ay.createElement(cs,{isOpen:e,selectedAt:t,isPastMode:!0,submitButtonLabel:o("JumpToDate"),onClose:r,onSubmit:i})}));var ms=a(64713);const us=(0,n.ph)((0,s.EK)((e,{userId:t})=>({user:t?(0,c.mBe)(e,t):void 0,userStatus:t?(0,c.K0y)(e,t):void 0,phoneCodeList:e.countryList.phoneCodes}))(({isOpen:e,userId:t,isByPhoneNumber:a,user:r,userStatus:i,phoneCodeList:o})=>{const{updateContact:c,importContact:d,closeNewContactDialog:m}=(0,s.ko)(),u=(0,B.A)(),A=(0,La.A)(r),h=(0,La.A)(a),y=(0,n.li)(),[p,g,v]=(0,M.A)(),[f,b]=(0,n.J0)(A?.firstName??""),[C,S]=(0,n.J0)(A?.lastName??""),[k,w]=(0,n.J0)(A?.phoneNumber??""),[N,I]=(0,n.J0)(!0),P=Boolean(f&&(!a||k));(0,n.vJ)(()=>{e&&(g(),b(A?.firstName??""),S(A?.lastName??""),w(A?.phoneNumber??""),I(!0))},[e,g,A?.firstName,A?.lastName,A?.phoneNumber]),(0,n.vJ)(()=>{!E.TF&&p&&setTimeout(()=>{y.current?.focus()},200)},[p]);const T=(0,n.hb)(e=>{b(e.target.value)},[]),x=(0,n.hb)(e=>{w((0,ms.Ox)(o,e.target.value))},[o]),L=(0,n.hb)(e=>{S(e.target.value)},[]),R=(0,n.hb)(()=>{m(),b(""),S(""),w("")},[m]),F=(0,n.hb)(()=>{a||!t?d({firstName:f,lastName:C,phoneNumber:k}):c({userId:t,firstName:f,lastName:C,shouldSharePhoneNumber:N})},[f,d,a,C,k,N,c,t]);if(e||p)return n.Ay.createElement(X.A,{className:"NewContactModal",title:u("NewContact"),isOpen:e,onClose:R,onCloseAnimationEnd:v},A&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:"NewContactModal__profile",dir:u.isRtl?"rtl":void 0},n.Ay.createElement(xt.A,{size:"jumbo",peer:A,text:`${f} ${C}`}),n.Ay.createElement("div",{className:"NewContactModal__profile-info"},n.Ay.createElement("p",{className:"NewContactModal__phone-number"},A?.phoneNumber?(0,ms.Ox)(o,A.phoneNumber):u("MobileHidden")),n.Ay.createElement("span",{className:"NewContactModal__user-status",dir:"auto"},(0,l.CD)(u,A,i)))),n.Ay.createElement(Z.A,{ref:y,value:f,label:u("FirstName"),tabIndex:0,onChange:T}),n.Ay.createElement(Z.A,{value:C,label:u("LastName"),tabIndex:0,onChange:L}),n.Ay.createElement("p",{className:"NewContactModal__help-text"},(0,Tt.A)(u("NewContact.Phone.Hidden.Text",A?.firstName||""),["emoji","simple_markdown"])),n.Ay.createElement(as.A,{className:"dialog-checkbox",checked:N,tabIndex:0,onCheck:I,label:u("lng_new_contact_share")}),n.Ay.createElement("p",{className:"NewContactModal__help-text NewContactModal__help-text__negative"},(0,Tt.A)(u("AddContact.SharedContactExceptionInfo",A?.firstName)))),h&&n.Ay.createElement("div",{className:"NewContactModal__new-contact",dir:u.isRtl?"rtl":void 0},n.Ay.createElement(xt.A,{size:"jumbo",text:`${f} ${C}`}),n.Ay.createElement("div",{className:"NewContactModal__new-contact-fieldset"},n.Ay.createElement(Z.A,{ref:y,value:k,inputMode:"tel",label:u("lng_contact_phone"),tabIndex:0,onChange:x}),n.Ay.createElement(Z.A,{value:f,label:u("FirstName"),tabIndex:0,onChange:T}),n.Ay.createElement(Z.A,{value:C,label:u("LastName"),tabIndex:0,onChange:L}))),n.Ay.createElement("div",{className:"dialog-buttons"},n.Ay.createElement(Y.A,{isText:!0,className:"confirm-dialog-button",disabled:!P,onClick:F},u("Done")),n.Ay.createElement(Y.A,{isText:!0,className:"confirm-dialog-button",onClick:R},u("Cancel"))))}));var As=a(20179),hs=a(30708),ys=a(48894),ps=a(71322),gs=a(32625),vs=a(10722);let Es=function(e){return e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.TopLeft=4]="TopLeft",e[e.TopRight=5]="TopRight",e[e.BottomLeft=6]="BottomLeft",e[e.BottomRight=7]="BottomRight",e}({});const fs={top:Es.Top,bottom:Es.Bottom,left:Es.Left,right:Es.Right,topLeft:Es.TopLeft,topRight:Es.TopRight,bottomLeft:Es.BottomLeft,bottomRight:Es.BottomRight},bs=Object.keys(fs);let Cs;const Ss={x:0,y:0};var ks=a(36838);const ws=(0,n.ph)((0,s.EK)(e=>{const t=(0,c.nTw)(e).webApps,{botId:a}=(0,c.ES7)(e)||{},{modalState:n,openedWebApps:s}=t||{},r="minimized"===n;return{activeTabBot:a?(0,c.mBe)(e,a):void 0,isMinimizedState:r,openedWebApps:s}})(({activeTabBot:e,isMinimizedState:t,openedWebApps:a})=>{const{changeWebAppModalState:r,closeWebAppModal:i}=(0,s.ko)(),o=(0,B.A)(),l=(0,Ua.A)(),d=(0,n.li)(),m=(0,n.Kr)(()=>a&&Object.values(a),[a]),u=m?.length,A=(0,n.Kr)(()=>{if(!u)return[];const t=(0,s.mS)(),a=e?.id;return(0,Ea.Am)([a,...m.map(e=>e.botId)]).map(e=>e&&(0,c.mBe)(t,e)).filter(Boolean).slice(0,3)},[u,e,m]),h=(0,x.A)(()=>{i()}),y=(0,x.A)(()=>{r({state:"maximized"})});if(t)return n.Ay.createElement("div",{ref:d,className:(0,ue.A)("kUZmBlnN")},n.Ay.createElement(Y.A,{className:"SMRJmUuE",round:!0,color:"translucent",size:"tiny",ariaLabel:o("Close"),onClick:h},n.Ay.createElement(Q.A,{className:"P0P4gW6a",name:"close"})),n.Ay.createElement(on.A,{className:"GP17QhNN",size:"mini",peers:A}),function(){const e=A.length>0&&A[0]?.firstName,t=u&&e&&u>1?l("MiniAppsMoreTabs",{botName:e,count:u-1},{pluralValue:u-1}):e;return n.Ay.createElement("div",{className:"TZFjRaG4"},t)}(),n.Ay.createElement(Y.A,{className:(0,ue.A)("Rax9j_TK","no-drag"),round:!0,color:"translucent",size:"tiny",onClick:y},n.Ay.createElement(Q.A,{className:"sdbTXCxq",name:"expand-modal"})))}));var Ns=a(59852),Is=a(84991);const Ps={container:"RFg0Ey2I","user-count-badge":"UZtJ6ZXb",userCountBadge:"UZtJ6ZXb","user-badge-icon":"pTiZFhsG",userBadgeIcon:"pTiZFhsG",name:"TzA5nqCC"},Ms=(0,n.ph)((0,s.EK)((e,{chatId:t})=>({user:(0,c.mBe)(e,t)}))(function({user:e,isPopularApp:t}){const{requestMainWebView:a}=(0,s.ko)(),r=(0,Ua.A)(),i=(0,x.A)(()=>{if(!e)return;const t=e?.id;if(!t)return;const n=(0,Ns.A)();a({botId:t,peerId:t,theme:n})});if(!e)return;const o=e?.firstName,l=e?.botActiveUsers,c=l&&t?(0,qe.Vw)(r,l):void 0;return n.Ay.createElement("div",{className:Ps.container,onClick:i},n.Ay.createElement(Is.A,{className:(0,ue.A)(Ps.avatarContainer,t&&"PopularAppGridItem"),textClassName:Ps.name,badgeClassName:Ps.userCountBadge,badgeIconClassName:Ps.userBadgeIcon,peer:e,text:o,badgeText:c,badgeIcon:"user-filled"}))})),Ts={root:"BJV09FsC",search:"bdi8G7GR","section-title":"ex3kxgWX",sectionTitle:"ex3kxgWX","section-content":"uIZzLhEh",sectionContent:"uIZzLhEh",showMoreLink:"h_Zs9ypA"},xs=(0,ye.nF)(e=>e(),500,!0),Bs=(0,n.ph)((0,s.EK)(e=>{const t=(0,c.nTw)(e).globalSearch,a=t.popularBotApps?.peerIds;return{isLoading:!a&&t.fetchingStatus?.botApps,foundIds:a,recentBotIds:e.topBotApps.userIds}})(({foundIds:e,recentBotIds:t})=>{const a=(0,B.A)(),i=(0,Ua.A)(),[o,l]=(0,n.J0)(!1),{searchPopularBotApps:c}=(0,s.ko)(),d=(0,x.A)(()=>{l(e=>!e)}),[m,u]=(0,n.J0)(""),A=(0,n.Kr)(()=>e?(0,Mt.PU)({ids:e,query:m,type:"user"}):[],[e,m]),h=(0,n.hb)(({direction:e})=>{e===r.TN.Backwards&&xs(()=>{c()})},[]),y=(0,n.hb)(()=>{u("")},[]);return n.Ay.createElement(fn.A,{className:(0,ue.A)(Ts.root,"custom-scroll"),items:A,onLoadMore:h,itemSelector:".PopularAppGridItem",noFastList:!0,preloadBackwards:30},n.Ay.createElement(Cn.A,{className:Ts.search,value:m,onChange:u,onReset:y,placeholder:i("SearchApps")}),t&&!m&&n.Ay.createElement("div",{className:Ts.section},n.Ay.createElement("div",{className:Ts.sectionTitle},n.Ay.createElement("span",null,a("SearchAppsMine")),n.Ay.createElement("span",{className:Ts.showMoreLink,onClick:d},a(o?"ChatList.Search.ShowLess":"ChatList.Search.ShowMore"))),n.Ay.createElement("div",{className:Ts.sectionContent},t.map((e,t)=>{if(o||!(t>=5))return n.Ay.createElement(Ms,{chatId:e})}))),n.Ay.createElement("div",{className:Ts.section},n.Ay.createElement("div",{className:Ts.sectionTitle},i(m?"Apps":"PopularApps")),n.Ay.createElement("div",{className:Ts.sectionContent},A&&A.map(e=>n.Ay.createElement(Ms,{chatId:e,isPopularApp:!m})))))})),Ls=3.675*h.$,Rs="jEAibDyh",Fs="ablUg8HU",Ds="Wrl63uWL",Vs="vOFiAq3l",_s="KwI4XdkC",Us="oq6HKJur",Os="a0AI_he5",Js="MvCwTbk_",Ks=250,Gs=["allow-scripts","allow-same-origin","allow-popups","allow-forms","allow-modals","allow-storage-access-by-user-activation"].join(" "),js={ok:"OK",cancel:"Cancel",close:"Close"},zs=(0,n.ph)((0,s.EK)((e,{modal:t})=>{const a=t?.activeWebAppKey?(0,c.wtp)(e,t.activeWebAppKey):void 0,{botId:n}=a||{},s=t?.modalState,r=n?e.attachMenu.bots[n]:void 0,i=n?(0,c.mBe)(e,n):void 0,o=n?(0,c.vGo)(e,n):void 0,l=o?.botInfo?.appSettings,d=e.currentUserId?(0,c.mBe)(e,e.currentUserId):void 0,m=(0,c.SJA)(e),{isPaymentModalOpen:u,status:A}=(0,c.nTw)(e).payment,{status:h,inputInvoice:y}=(0,c.nTw)(e).starsPayment,p=i?(0,c.XOs)(e,i.id):void 0,g=h||A;return{attachBot:r,bot:i,currentUser:d,theme:m,isPaymentModalOpen:u||Boolean(y),paymentStatus:g,modalState:s,botAppPermissions:p,botAppSettings:l}})(({modal:e,webApp:t,bot:a,theme:r,isPaymentModalOpen:o,paymentStatus:c,registerSendEventCallback:d,registerReloadFrameCallback:m,isTransforming:u,modalState:A,isMultiTabSupported:h,onContextMenuButtonClick:y,botAppPermissions:p,botAppSettings:g,modalHeight:v})=>{const{closeActiveWebApp:f,sendWebViewData:b,toggleAttachBot:C,openTelegramLink:S,setWebAppPaymentSlug:k,switchBotInline:w,sharePhoneWithBot:N,updateWebApp:P,resetPaymentStatus:T,openChatWithInfo:L,showNotification:R,openEmojiStatusAccessModal:F,openLocationAccessModal:D,changeWebAppModalState:V,closeWebAppModal:_,openPreparedInlineMessageModal:U}=(0,s.ko)(),[O,J]=(0,n.J0)(),[K,G]=(0,n.J0)(),[j,H,$]=(0,M.A)(!1),[q,W]=(0,n.J0)(),[Z,ee]=(0,n.J0)(!1),[te,ae]=(0,n.J0)(!1),[se,re]=(0,n.J0)(),[ie,oe]=(0,n.J0)(),{unlockPopupsAt:le,handlePopupOpened:ce,handlePopupClosed:de}=function(){const[e,t]=(0,n.J0)(0),a=(0,n.li)(0),s=(0,n.li)(0),r=(0,x.A)(()=>{const e=Date.now();e-s.current>2e3&&(a.current=0),a.current+=1,a.current>=3&&t(e+2e3)}),i=(0,x.A)(()=>{e<Date.now()&&(s.current=Date.now())});return{unlockPopupsAt:e,handlePopupOpened:r,handlePopupClosed:i}}(),me=(0,n.li)(),Ae=(0,n.li)(),he=(0,n.li)(),ye="fullScreen"===A,pe="minimized"===A,ge=(0,x.A)(()=>{setTimeout(()=>{V({state:"maximized"})},350)}),ve=(0,n.li)();(0,n.vJ)(()=>{ve.current=document.querySelector("#portals")},[]);const[,Ee,fe]=(0,Ce.Ay)(ve,ge),be=e?.activeWebAppKey?e.openedWebApps[e.activeWebAppKey]:void 0,{appName:ke,backgroundColor:we}=be||{},{url:Ne,buttonText:Ie,isBackButtonVisible:Pe}=t||{},{placeholderPath:Me}=g||{},Te=Boolean(t?.isCloseModalOpen),xe=Boolean(t?.isRemoveModalOpen),Be=t&&(0,As.rp)(t),Le=be&&(0,As.rp)(be),Re=be&&t&&Le===Be,Fe=E.H$,De=void 0!==p?.geolocation,_e=Boolean(p?.geolocation),Ue=(0,x.A)(e=>{Be&&P({key:Be,update:e})}),Oe=(0,n.Kr)(()=>(0,Ns.A)(),[r]);(0,n.vJ)(()=>{oe(Oe.secondary_bg_color)},[Oe]);const Je=Oe.bg_color,[Ke,Ge]=(0,n.J0)(),je="light"===r?g?.backgroundColor:g?.backgroundDarkColor;(0,n.vJ)(()=>{Ue({backgroundColor:Ke||je||Je})},[Je,Ke,je]);const ze=Oe.bg_color,[He,$e]=(0,n.J0)(),qe="light"===r?g?.headerColor:g?.headerDarkColor;(0,n.vJ)(()=>{Ue({headerColor:He||qe||ze})},[ze,He,qe]);const We=(0,n.li)(),Qe=(0,B.A)(),Ye=(0,Ua.A)(),Xe=e?.isModalOpen||!1,et=Boolean(Ie),{reloadFrame:tt,sendEvent:at,sendFullScreenChanged:nt,sendViewport:st,sendSafeArea:rt,sendTheme:it}=((e,t,a,r,o,c,d)=>{const{showNotification:m,setWebAppPaymentSlug:u,openInvoice:A,closeWebApp:h,openSuggestedStatusModal:y,updateWebApp:p,updateContentSettings:g}=(0,s.ko)(),v=(0,n.li)(!1),E=(0,n.li)(),f=(0,n.li)(!1),b=(0,n.li)(),C=(0,Se.A)();(0,n.vJ)(()=>{if(!e.current||!t)return;const a=()=>{d?.()},n=e.current;return n.addEventListener("load",a),()=>{n.removeEventListener("load",a)}},[d,e,t]);const S=(0,n.hb)(t=>{e.current?.contentWindow&&e.current.contentWindow.postMessage(JSON.stringify(t),"*")},[e]),k=(0,n.hb)(e=>{S({eventType:"fullscreen_changed",eventData:{is_fullscreen:e}})},[S]),w=(0,x.A)(t=>{if(!e.current)return;const a=e.current;a.src="about:blank",a.addEventListener("load",()=>{a.src=t},{once:!0})}),N=(0,n.hb)(e=>{if(v.current)return S({eventType:"reload_iframe"}),void(E.current=setTimeout(()=>{w(e)},500));w(e)},[S]),I=(0,n.hb)(t=>{if(!e.current)return;const{width:a,height:n}=e.current.getBoundingClientRect();S({eventType:"viewport_changed",eventData:{width:a,height:n,is_expanded:!0,is_state_stable:!t}})},[S,e]),P=(0,n.hb)(()=>{e.current&&(S({eventType:"safe_area_changed",eventData:{left:0,right:0,top:0,bottom:0}}),S({eventType:"content_safe_area_changed",eventData:{left:0,right:0,top:a?Ls:0,bottom:0}}))},[S,a,e]),M=(0,n.hb)(()=>{S({eventType:"theme_changed",eventData:{theme_params:(0,Ns.A)()}})},[S]),T=(0,n.hb)(e=>{S({eventType:"set_custom_style",eventData:e})},[S]),B=(0,n.hb)(t=>{if(f.current)return;const a=e.current?.contentWindow;if(a===t.source)try{const e=JSON.parse(t.data),{eventType:a,eventData:n}=e;if("web_app_ready"===a&&d?.(),"web_app_close"===a&&c){const e=(0,l.rp)(c);h({key:e,skipClosingConfirmation:!0})}if("web_app_request_viewport"===a&&I(C.isResizing),"web_app_request_safe_area"===a&&P(),"web_app_request_content_safe_area"===a&&P(),"web_app_request_theme"===a&&M(),"iframe_ready"===a){const e=getComputedStyle(document.body).getPropertyValue("--color-scrollbar");T("* {\n  scrollbar-width: thin;\n  scrollbar-color: %SCROLLBAR_COLOR% transparent;\n}\n\n*::-webkit-scrollbar {\n  width: 6px;\n  height: 6px;\n  background-color: transparent;\n}\n\n*::-webkit-scrollbar-thumb {\n  border-radius: 6px;\n  background-color: %SCROLLBAR_COLOR%;\n}\n\n*::-webkit-scrollbar-corner {\n  background-color: transparent;\n}".replace(/%SCROLLBAR_COLOR%/g,e)),v.current=Boolean(n.reload_supported)}if("iframe_will_reload"===a&&clearTimeout(E.current),"web_app_data_send"===a){if(!r)return;f.current=!0}if("web_app_read_text_from_clipboard"===a&&S({eventType:"clipboard_text_received",eventData:{req_id:n.req_id,data:null}}),"web_app_open_scan_qr_popup"===a&&m({message:"Scanning QR code is not supported in this client yet"}),"web_app_open_invoice"===a&&(u({slug:n.slug}),A({type:"slug",slug:n.slug})),"web_app_open_link"===a){const e=n.url;window.open(e,"_blank","noreferrer")}if("web_app_biometry_get_info"===a&&S({eventType:"biometry_info_received",eventData:{available:!1}}),"web_app_device_storage_clear"===a||"web_app_device_storage_get_key"===a||"web_app_device_storage_save_key"===a){const{req_id:e}=n;S({eventType:"device_storage_failed",eventData:{req_id:e,error:"UNSUPPORTED"}})}if("web_app_secure_storage_clear"===a||"web_app_secure_storage_get_key"===a||"web_app_secure_storage_restore_key"===a||"web_app_secure_storage_save_key"===a){const{req_id:e}=n;S({eventType:"secure_storage_failed",eventData:{req_id:e,error:"UNSUPPORTED"}})}if("web_app_start_accelerometer"===a&&S({eventType:"accelerometer_failed",eventData:{error:"UNSUPPORTED"}}),"web_app_start_gyroscope"===a&&S({eventType:"gyroscope_failed",eventData:{error:"UNSUPPORTED"}}),"web_app_start_device_orientation"===a&&S({eventType:"device_orientation_failed",eventData:{error:"UNSUPPORTED"}}),"web_app_add_to_home_screen"===a&&S({eventType:"home_screen_failed",eventData:{error:"UNSUPPORTED"}}),"web_app_check_home_screen"===a&&S({eventType:"home_screen_checked",eventData:{status:"unsupported"}}),"web_app_set_emoji_status"===a){const{custom_emoji_id:e,duration:t}=n;if(!e||"string"!=typeof e)return void S({eventType:"emoji_status_failed",eventData:{error:"SUGGESTED_EMOJI_INVALID"}});if(t)try{BigInt(t)}catch(e){return void S({eventType:"emoji_status_failed",eventData:{error:"DURATION_INVALID"}})}if(!c)return void S({eventType:"emoji_status_failed",eventData:{error:"UNKNOWN_ERROR"}});y({webAppKey:(0,l.rp)(c),customEmojiId:e,duration:Number(t),botId:c.botId})}if("web_app_verify_age"===a){const{passed:e}=n,t=(0,s.mS)().appConfig?.verifyAgeMin||i.lYi,a=n.age||0;e&&a>=t?(m({message:{key:"TitleAgeCheckSuccess"}}),g({isSensitiveEnabled:!0})):m({message:{key:"TitleAgeCheckFailed"}})}o(e)}catch(e){}},[r,S,o,T,c,M,I,P,d,C.isResizing,e]);return(0,n.vJ)(()=>{const{width:e,height:t,isResizing:a}=C;b.current&&b.current.width===e&&b.current.height===t&&!b.current.isResizing||(b.current={width:e,height:t,isResizing:a},I(a))},[I,P,C]),(0,n.vJ)(()=>{c?.plannedEvents?.length&&(c.plannedEvents.forEach(e=>{S(e)}),p({key:(0,l.rp)(c),update:{plannedEvents:[]}}))},[S,c]),(0,n.vJ)(()=>(window.addEventListener("message",B),()=>window.removeEventListener("message",B)),[B,e]),(0,n.vJ)(()=>{t&&e.current?.contentWindow?(I(),P(),f.current=!1):b.current=void 0},[t,a,I,P,e]),{sendEvent:S,sendFullScreenChanged:k,reloadFrame:N,sendViewport:I,sendSafeArea:P,sendTheme:M}})(We,Xe,ye,et,function(e){const{eventType:t,eventData:n}=e;if("web_app_request_fullscreen"===t&&((0,I.cB)()?V({state:"fullScreen"}):at({eventType:"fullscreen_failed",eventData:{error:"UNSUPPORTED"}})),"web_app_exit_fullscreen"===t&&vt(),"web_app_open_tg_link"===t){const e=i.jsp+n.path_full;S({url:e,shouldIgnoreCache:n.force_request}),f()}if("web_app_setup_back_button"===t&&Ue({isBackButtonVisible:n.is_visible}),"web_app_setup_settings_button"===t&&Ue({isSettingsButtonVisible:n.is_visible}),"web_app_set_background_color"===t&&Ge((0,Ns.To)(n.color)?n.color:void 0),"web_app_set_header_color"===t){const e=n.color_key;$e(n.color||(e?Oe[e]:void 0))}if("web_app_set_bottom_bar_color"===t&&oe(n.color),"web_app_data_send"===t&&(f(),b({bot:a,buttonText:Ie,data:n.data})),"web_app_setup_main_button"===t){const e=n.color,t=n.text_color;J({isVisible:n.is_visible&&Boolean(n.text?.trim().length),isActive:n.is_active,text:n.text,color:e,textColor:t,isProgressVisible:n.is_progress_visible})}if("web_app_setup_secondary_button"===t){const e=n.color,t=n.text_color;G({isVisible:n.is_visible&&Boolean(n.text?.trim().length),isActive:n.is_active,text:n.text,color:e,textColor:t,isProgressVisible:n.is_progress_visible,position:n.position})}if("web_app_setup_closing_behavior"===t&&Ue({shouldConfirmClosing:!0}),"web_app_open_popup"===t){if(q||!n.message.trim().length||!n.buttons?.length||n.buttons.length>3||Z||te||le>Date.now())return void ht(void 0);W(n),ce()}if("web_app_switch_inline_query"===t){const e=n.chat_types?.map(l.Xj).filter(Boolean),t=!e?.length;w({botId:a.id,query:n.query,filter:e,isSamePeer:t}),f()}if("web_app_request_phone"===t){if(q||te||le>Date.now())return void Ct();ee(!0),ce()}if("web_app_request_write_access"===t){if(q||Z||le>Date.now())return void wt();!async function(){if(!a)return;const e=await(0,Ze.px)("fetchBotCanSendMessage",{bot:a});e&&at({eventType:"write_access_requested",eventData:{status:"allowed"}}),ae(!e)}(),ce()}if("web_app_invoke_custom_method"===t){const{method:e,params:t,req_id:s}=n;!async function(e,t,n){const s=await(0,Ze.px)("invokeWebViewCustomMethod",{bot:a,customMethod:t,parameters:n});at({eventType:"custom_method_invoked",eventData:{req_id:e,...s}})}(s,e,JSON.stringify(t))}if("web_app_request_file_download"===t){if(se||le>Date.now())return void kt();!async function(e,t){await(0,Ze.px)("checkBotDownloadFileParams",{bot:a,url:e,fileName:t})?(re({url:e,fileName:t}),ce()):at({eventType:"file_download_requested",eventData:{status:"cancelled"}})}(n.url,n.file_name)}if("web_app_send_prepared_message"===t){if(!a||!Be)return;const{id:e}=n;U({botId:a.id,messageId:e,webAppKey:Be})}if("web_app_request_emoji_status_access"===t){if(!a)return;F({bot:a,webAppKey:Be})}"web_app_check_location"===t&&at({eventType:"location_checked",eventData:{available:Fe,access_requested:De,access_granted:_e}}),"web_app_request_location"===t&&(async()=>{const e=await(0,E.Bu)(),{accessRequested:t,accessGranted:n,geolocation:s}=e;if(!n||!t)return at({eventType:"location_requested",eventData:{available:!1}}),R({message:Qe("PermissionNoLocationPosition")}),void ht(void 0);Fe?De?at({eventType:"location_requested",eventData:{available:Boolean(p?.geolocation),latitude:s?.latitude,longitude:s?.longitude,altitude:s?.altitude,course:s?.heading,speed:s?.speed,horizontal_accuracy:s?.accuracy,vertical_accuracy:s?.altitudeAccuracy}}):D({bot:a,webAppKey:Be}):(R({message:Qe("PermissionNoLocationPosition")}),ht(void 0))})(),"web_app_open_location_settings"===t&&Pt()},t,H);(0,n.vJ)(()=>{Re&&d(at)},[at,d,Re]),(0,n.vJ)(()=>{Re&&m(tt)},[tt,m,Re]);const ot=j&&O?.isVisible&&O.text.trim().length>0,lt=j&&K?.isVisible&&K.text.trim().length>0,ct=(0,x.A)(()=>{Ue({isCloseModalOpen:!1})}),dt=(0,x.A)(()=>{Ue({shouldConfirmClosing:!1,isCloseModalOpen:!1}),setTimeout(()=>{f()},400)}),mt=(0,x.A)(()=>{Ue({isRemoveModalOpen:!1})}),ut=(0,x.A)(()=>{at({eventType:"main_button_pressed"})}),At=(0,x.A)(()=>{at({eventType:"secondary_button_pressed"})}),ht=(0,x.A)(e=>{W(void 0),de(),at({eventType:"popup_closed",eventData:{button_id:e}})}),yt=(0,x.A)(()=>{ht()}),pt=(0,x.A)(()=>{it()});(0,z.A)(()=>{setTimeout(()=>{pt()},400)},[r]);const gt=(0,x.A)(()=>{!(0,Ce.j9)()&&Re&&Ee?.()}),vt=(0,x.A)(()=>{(0,Ce.j9)()&&Re&&fe?.()}),Et=(0,x.A)(e=>{Re&&nt(e)});(0,n.vJ)(()=>{ye?(gt(),Et(!0)):(vt(),Et(!1))},[ye]);const ft=(0,x.A)(e=>{at({eventType:"visibility_changed",eventData:{is_visible:e}})});(0,n.vJ)(()=>{j&&ft(Boolean(Re))},[Re,j]),(0,Sa.A)(([e])=>{"minimized"===A&&ft(!1),A&&"minimized"===e&&ft(!0)},[A]),(0,z.A)(([e])=>{o!==e&&t?.slug&&!o&&c&&(at({eventType:"invoice_closed",eventData:{slug:t.slug,status:c}}),k({slug:void 0}),T())},[o,c,at,t?.slug]);const bt=(0,x.A)(()=>{C({botId:a.id,isEnabled:!1}),f()}),Ct=(0,x.A)(()=>{ee(!1),de(),at({eventType:"phone_requested",eventData:{status:"cancelled"}})}),St=(0,x.A)(()=>{N({botId:a.id}),ee(!1),de(),at({eventType:"phone_requested",eventData:{status:"sent"}})}),kt=(0,x.A)(e=>{e&&(re(void 0),de()),at({eventType:"file_download_requested",eventData:{status:"cancelled"}})}),wt=(0,x.A)(()=>{at({eventType:"write_access_requested",eventData:{status:"cancelled"}}),ae(!1),de()}),Nt=(0,x.A)(async()=>{a&&(await(0,Ze.px)("allowBotSendMessages",{bot:a})?(at({eventType:"write_access_requested",eventData:{status:"allowed"}}),ae(!1),de()):wt())}),It=(0,x.A)(()=>{se&&(re(void 0),de(),(0,Fa.A)(se.url,se.fileName),at({eventType:"file_download_requested",eventData:{status:"downloading"}}))});(0,n.vJ)(()=>{Xe||(W(void 0),ee(!1),ae(!1),J(void 0),G(void 0),Ue({isSettingsButtonVisible:!1,shouldConfirmClosing:!1,isBackButtonVisible:!1,isCloseModalOpen:!1,isRemoveModalOpen:!1}),$())},[Xe]);const Pt=(0,x.A)(()=>{L({id:a.id})}),Mt=(0,La.A)(O?.color,!0),xt=(0,La.A)(O?.textColor,!0),Bt=(0,La.A)(O&&Boolean(O.isActive),!0),Lt=(0,La.A)(O?.text,!0),Rt=(0,La.A)(K?.position,!0),Ft=(0,La.A)(K?.color,!0),Dt=(0,La.A)(K?.textColor,!0),Vt=(0,La.A)(K&&Boolean(K.isActive),!0),_t=(0,La.A)(K?.text,!0),[Ut,Ot]=(0,n.J0)(!1),[Jt,Kt]=(0,n.J0)(!0),[Gt,jt]=(0,n.J0)(!0),[zt,Ht]=(0,n.J0)(!1),[$t,qt]=(0,n.J0)(!1),[Wt,Qt]=(0,n.J0)(!1),[Yt,Zt]=(0,n.J0)(0);(0,z.A)(()=>{setTimeout(()=>{st(),rt()},u?0:400)},[$t,Gt,zt,zt,K?.position,st,u,v,rt]);const Xt="top"===Rt||"bottom"===Rt,ea=Xt&&zt&&$t?2:zt||$t?1:0,ta=Xt||Jt||Gt?"vertical":"horizontal",aa=(0,n.li)(),na=(0,n.li)(),sa=(0,n.li)(),ra=(0,n.li)(),ia=(0,n.li)();(0,n.vJ)(()=>(ye&&Xe&&Boolean(ke)?(Qt(!0),ia.current&&clearTimeout(ia.current),ia.current=setTimeout(()=>{Qt(!1),ia.current=void 0},3800)):(Qt(!1),ia.current&&(clearTimeout(ia.current),ia.current=void 0)),()=>{ia.current&&clearTimeout(ia.current)}),[ye,Xe,ke]),(0,n.vJ)(()=>{aa.current&&clearTimeout(aa.current),na.current&&clearTimeout(na.current),ot&&(na.current=setTimeout(()=>{Ht(!0)},35),Kt(!1),aa.current=setTimeout(()=>{Ot(!0)},Ks)),ot||(Ht(!1),aa.current=setTimeout(()=>{Kt(!0)},Ks))},[ot]),(0,n.vJ)(()=>{sa.current&&clearTimeout(sa.current),ra.current&&clearTimeout(ra.current),lt&&(ra.current=setTimeout(()=>{qt(!0)},35),jt(!1),sa.current=setTimeout(()=>{Ot(!0)},Ks)),lt||(qt(!1),sa.current=setTimeout(()=>{jt(!0)},Ks))},[lt]),(0,n.vJ)(()=>{$t||zt||Ot(!1)},[Ot,$t,zt]);const oa=(0,Ta.A)(`background-color: ${we||"var(--color-background)"}`,u&&"pointer-events: none;"),la=(0,x.A)(()=>{Pe?at({eventType:"back_button_pressed"}):(vt(),nt(!1),V({state:"maximized"}),_())}),ca=(0,x.A)(()=>{vt()}),da=(0,x.A)(e=>{y(e)}),ma=(0,ue.A)("BvNtfigU",Pe&&"rC2wkMIk"),ua=Wt?ke:Qe(Pe?"Back":"Close"),Aa=he?.current;return(0,n.vJ)(()=>{Zt(he?.current?.clientWidth||0)},[ua,Aa]),n.Ay.createElement("div",{ref:me,className:(0,ue.A)("LeeJZdwH",!Re&&Vs,h&&"ESsGT5OD")},ye&&(0,I.cB)()&&n.Ay.createElement("div",{className:"eYrhewMy"},n.Ay.createElement("div",{ref:Ae,className:Js,onClick:la},n.Ay.createElement("div",{className:"JXsuZ01s"},n.Ay.createElement("div",{className:ma})),n.Ay.createElement("span",{className:"dpZR3YT7",style:`width: ${Yt}px;`},n.Ay.createElement(ne.Ay,{activeKey:Wt?0:Pe?1:2,name:"slideFade"},n.Ay.createElement("div",{ref:he,className:"dWDprnWa"},ua)))),n.Ay.createElement("div",{className:"Tl4_05AQ"},n.Ay.createElement("div",{className:(0,ue.A)(Js,"emOpAMBm"),tabIndex:0,role:"button","aria-label":Ye("WebAppCollapse"),onClick:ca},n.Ay.createElement(Q.A,{name:"down",className:Os})),n.Ay.createElement("div",{className:(0,ue.A)(Js,"z4C5VD5o"),tabIndex:0,role:"button","aria-haspopup":"menu","aria-label":Ye("AriaMoreButton"),onClick:da},n.Ay.createElement(Q.A,{name:"more",className:(0,ue.A)(Os,"T58ozRyW")})))),!pe&&(Me?n.Ay.createElement("svg",{className:(0,ue.A)(Rs,j&&Ds),viewBox:"0 0 512 512"},n.Ay.createElement("path",{className:"Gx1BIECZ",d:Me})):function(){const e=(0,ue.A)(Rs,"Ig_t1R7i",j&&Ds);return n.Ay.createElement("div",{className:e},n.Ay.createElement("div",{className:Fs}),n.Ay.createElement("div",{className:Fs}),n.Ay.createElement("div",{className:Fs}),n.Ay.createElement("div",{className:Fs}))}()),n.Ay.createElement("iframe",{className:(0,ue.A)("OmY14FFl",Ut&&"liDRl1xT",!j&&Ds),style:oa,src:Ne,title:`${a?.firstName} Web App`,sandbox:Gs,allow:"camera; microphone; geolocation; clipboard-write;",allowFullScreen:!0,ref:We}),!pe&&n.Ay.createElement("div",{style:`background-color: ${ie};`,className:(0,ue.A)("mR_hsBdT","left"===Rt&&"ntESqwQ_","right"===Rt&&"q6IUFEL0","top"===Rt&&"gb4iHJ9H","bottom"===Rt&&"R_bh3GF8","horizontal"===ta&&"oYaRA7u4",1===ea&&"YfQO314y",2===ea&&"gUldkEoy")},n.Ay.createElement(Y.A,{className:(0,ue.A)("ypxiUCFQ",$t&&!Gt&&_s,Gt&&Vs),fluid:!0,style:`background-color: ${Ft}; color: ${Dt}`,disabled:!Vt&&!K?.isProgressVisible,nonInteractive:K?.isProgressVisible,onClick:At,size:"smaller"},!K?.isProgressVisible&&_t,K?.isProgressVisible&&n.Ay.createElement(Ve.A,{className:Us,color:"blue"})),n.Ay.createElement(Y.A,{className:(0,ue.A)("U_ggDKn1",zt&&!Jt&&_s,Jt&&Vs),fluid:!0,style:`background-color: ${Mt}; color: ${xt}`,disabled:!Bt&&!O?.isProgressVisible,nonInteractive:O?.isProgressVisible,onClick:ut,size:"smaller"},!O?.isProgressVisible&&Lt,O?.isProgressVisible&&n.Ay.createElement(Ve.A,{className:Us,color:"white"}))),q&&n.Ay.createElement(X.A,{isOpen:Boolean(q),title:q.title||" ",onClose:yt,hasCloseButton:!0,className:(0,ue.A)("YEOURXza",!q.title?.trim().length&&"gvljUzY9")},q.message,n.Ay.createElement("div",{className:"dialog-buttons mt-2"},q.buttons.map(e=>n.Ay.createElement(Y.A,{key:e.id||e.type,className:"confirm-dialog-button",color:"destructive"===e.type?"danger":"primary",isText:!0,size:"smaller",onClick:()=>ht(e.id)},e.text||Qe(js[e.type]))))),n.Ay.createElement(ya.A,{isOpen:Z,onClose:Ct,title:Qe("ShareYouPhoneNumberTitle"),text:Qe("AreYouSureShareMyContactInfoBot"),confirmHandler:St,confirmLabel:Qe("ContactShare")}),n.Ay.createElement(ya.A,{isOpen:te,onClose:wt,title:Qe("lng_bot_allow_write_title"),text:Qe("lng_bot_allow_write"),confirmHandler:Nt,confirmLabel:Qe("lng_bot_allow_write_confirm")}),n.Ay.createElement(ya.A,{isOpen:Boolean(se),title:Qe("BotDownloadFileTitle"),textParts:Ye("BotDownloadFileDescription",{bot:a?.firstName,filename:se?.fileName},{withNodes:!0,withMarkdown:!0}),confirmLabel:Qe("BotDownloadFileButton"),onClose:kt,confirmHandler:It}),n.Ay.createElement(ya.A,{isOpen:Te,onClose:ct,title:Qe("lng_bot_close_warning_title"),text:Qe("lng_bot_close_warning"),confirmHandler:dt,confirmIsDestructive:!0,confirmLabel:Qe("lng_bot_close_warning_sure")}),n.Ay.createElement(ya.A,{isOpen:xe,onClose:mt,title:Qe("BotRemoveFromMenuTitle"),textParts:(0,Tt.A)(Qe("BotRemoveFromMenu",a?.firstName),["simple_markdown"]),confirmHandler:bt,confirmIsDestructive:!0}))})),Hs="oHX2d8Or",$s="O4NxErFX",qs="dgdyQDsZ",Ws="xGefqS93",Qs="f7EicoVH",Ys="s6pBIYMI",Zs="txS0KiU0",Xs="XpHR_yo0",er="DoeOewUR",tr="YRMGpqUS",ar="b13oE9uA",nr={width:300,height:40},sr={width:420,height:730},rr={width:300,height:300},ir=(0,n.ph)((0,s.EK)((e,{modal:t})=>{const a=t?.activeWebAppKey?(0,c.wtp)(e,t.activeWebAppKey):void 0,{botId:n}=a||{},s=n?e.attachMenu.bots[n]:void 0,r=n?(0,c.mBe)(e,n):void 0,i=(0,c.meB)(e),o=(0,c.SJA)(e),{miniAppsCachedPosition:l,miniAppsCachedSize:d}=(0,hs.l)(e);return{attachBot:s,bot:r,chat:i,theme:o,cachedPosition:l,cachedSize:d}})(({modal:e,chat:t,bot:a,attachBot:r,theme:o,cachedSize:l,cachedPosition:c})=>{const{closeActiveWebApp:d,closeWebAppModal:m,prolongWebView:u,toggleAttachBot:A,openChat:h,changeWebAppModalState:y,openWebAppTab:p,updateWebApp:g,openMoreAppsTab:v,closeMoreAppsTab:E,updateMiniAppCachedPosition:f,updateMiniAppCachedSize:b}=(0,s.ko)(),[C,k]=(0,n.Ul)(l||sr);function w(){return"fullScreen"===e?.modalState?S.A.get():"maximized"===e?.modalState?C():nr}const{openedWebApps:N,activeWebAppKey:P,openedOrderedKeys:T,sessionKeys:L,isMoreAppsTabActive:R}=e||{},F=P?N?.[P]:void 0,{isBackButtonVisible:D,headerColor:V,backgroundColor:_,isSettingsButtonVisible:U}=F||{},O=(0,n.Kr)(()=>T?.map(e=>{const t=N[e];return{bot:(0,s.mS)().users.byId[t.botId],webApp:t,isOpen:Boolean(F&&e===(0,As.rp)(F))}}),[T,N,F]),{isMobile:J}=(0,I.Ay)(),K=e?.isModalOpen||!1,G="maximized"===e?.modalState,j="minimized"===e?.modalState,z="fullScreen"===e?.modalState,H=!J,$=(0,n.li)(),q=(0,n.li)(),W=(0,n.li)(),Z=(0,x.A)(()=>$.current),ee=(0,x.A)(()=>$.current),te=(0,x.A)(()=>W.current),{isContextMenuOpen:ae,contextMenuAnchor:ne,handleContextMenu:se,handleContextMenuClose:re,handleContextMenuHide:ie}=(0,vs.A)($),[oe,de]=(0,n.J0)(!1),me=q.current,he=$.current;(0,n.vJ)(()=>{de(Boolean(H&&me&&he&&!z))},[H,me,he,z]),(0,n.vJ)(()=>{y({state:"maximized"})},[H]);const{isDragging:ye,isResizing:pe,style:ge,size:ve,position:Ee}=function(e,t,a=!0,s,r=!1,o={width:0,height:0},l){const[c,d]=(0,n.J0)(l),[m,u]=(0,n.J0)(void 0),[A,h]=(0,n.Ul)({x:0,y:0}),[y,p]=(0,n.Ul)({width:0,height:0}),[g,v]=(0,n.Ul)({x:0,y:0}),E=A(),f=g(),b=e.current,C=t.current,[S,k]=(0,M.A)(!1),[w,N]=(0,M.A)(!1),[I,P,T]=(0,M.A)(!1),[B,L,R]=(0,M.A)(!1),[F,D,V]=(0,M.A)(!1),[_,U]=(0,n.J0)(void 0);function O(){return{width:window.innerWidth,height:window.innerHeight}}const J=(0,x.A)(e=>{r||d({x:e.x,y:e.y})}),K=(0,x.A)(()=>r?Ss:c),G=(0,x.A)(()=>{if(!m)return;const{width:e,height:t}=m,a=O();return{x:(a.width-e)/2,y:(a.height-t)/2}});(0,n.vJ)(()=>{b&&N()},[b]),(0,n.vJ)(()=>{if(!S&&m){const e=G();if(!e)return;J(e),k()}},[m,S,b]);const j=(0,x.A)(e=>{if(e instanceof MouseEvent&&0!==e.button)return;if(e.target.closest(".no-drag")||!b)return;const{x:t,y:a}=(0,Ue.A)(e),{left:n,top:s}=b.getBoundingClientRect();h({x:n,y:s}),v({x:t,y:a}),P()}),z=(0,x.A)(e=>{if(e instanceof MouseEvent&&0!==e.button)return;const t=e.target;if(!b||!t)return;const a=function(e){const t=t=>e.closest(t);if(t(i.cnh))for(const e of bs)if(t(`.${e}`))return fs[e]}(t);if(void 0===a)return;U(a);const{x:n,y:s}=(0,Ue.A)(e),{left:r,right:o,top:l,bottom:c}=b.getBoundingClientRect();h({x:r,y:l}),p({width:o-r,height:c-l}),v({x:n,y:s}),L()}),H=(0,x.A)(()=>{T()}),$=(0,x.A)(()=>{R()});(0,n.vJ)(()=>{a||T()},[a]);const q=(e,t)=>{const a=O(),n=a.width,s=a.height,r=m.width,i=m.height;let o=e,l=t;return o<0&&(o=0),l<0&&(l=0),o+r>n&&(o=n-r),l+i>s&&(l=s-i),{x:o,y:l}},W=(0,x.A)(()=>{if(r)return;const e=w||l?c:G();if(!m||!e)return;const t=q(e.x,e.y);J(t)}),Q=(0,x.A)(e=>{const t=e,a=O(),n=s.width,r=s.height;return t.width=Math.min(a.width,Math.max(n,t.width)),t.height=Math.min(a.height,Math.max(r,t.height)),t});(0,n.vJ)(()=>{if(B)return;const e=Q({width:s.width,height:s.height});e&&u(e)},[s,B]);const Y=(0,x.A)(()=>{if(!m||B)return;const e=Q(m);e&&u(e)});(0,n.vJ)(()=>{B||W()},[m,B]),(0,n.vJ)(()=>{const e=()=>{D(),Y(),W(),Cs&&(clearTimeout(Cs),Cs=void 0),Cs=window.setTimeout(()=>{Cs=void 0,V()},250)};return window.addEventListener("resize",e),()=>{clearTimeout(Cs),Cs=void 0,window.removeEventListener("resize",e)}},[W]);const Z=(0,x.A)(e=>{if(!I||!b)return;const{x:t,y:a}=(0,Ue.A)(e),n=t-f.x,s=a-f.y,r=E.x+n,i=E.y+s;m&&d(q(r,i))}),X=(0,x.A)(e=>{if(!B||!b||void 0===_)return;const{x:t,y:a}=(0,Ue.A)(e),n=y(),s=Math.min(Math.max(0,t),O().width),r=Math.min(Math.max(0,a),O().height),i=s-f.x,l=r-f.y,c=E.x+n.width-o.width,m=E.y+n.height-o.height,A={x:E.x,y:E.y,width:n.width,height:n.height};_!==Es.Left&&_!==Es.TopLeft&&_!==Es.BottomLeft||(A.width=Math.max(n.width-i,o.width),A.x=Math.min(A.x+i,c)),_!==Es.Right&&_!==Es.TopRight&&_!==Es.BottomRight||(A.width=Math.max(n.width+i,o.width)),_!==Es.Top&&_!==Es.TopLeft&&_!==Es.TopRight||(A.height=Math.max(n.height-l,o.height),A.y=Math.min(A.y+l,m)),_!==Es.Bottom&&_!==Es.BottomLeft&&_!==Es.BottomRight||(A.height=Math.max(n.height+l,o.height)),u({width:A.width,height:A.height}),d({x:A.x,y:A.y})});(0,n.vJ)(()=>{let e;return C&&a&&(e=(0,Ae.wJ)(C,{onCapture:j,onDrag:Z,onRelease:H,onClick:H,onDoubleClick:H})),e},[a,C]),(0,n.vJ)(()=>{const e=[];if(b&&a)for(const t of bs){const a=b.querySelector(`.resizeHandle.${t}`);if(a){const t=(0,Ae.wJ)(a,{onCapture:z,onDrag:X,onRelease:$,onClick:$,onDoubleClick:$});t&&e.push(t)}}return()=>{e.forEach(e=>e())}},[a,b]);const ee=I?"cursor: grabbing !important; ":"",te=K();if(!S||!m||!te)return{isDragging:!1,style:ee};const ae=(0,Ta.A)(`left: ${te.x}px;`,`top: ${te.y}px;`,!r&&`max-width: ${m.width}px;`,!r&&`max-height: ${m.height}px;`,"position: fixed;",(I||B||F)&&"transition: none !important;",ee);return{position:c,size:m,isDragging:I,isResizing:B,style:ae}}($,q,oe,w(),z,function(){if("maximized"===e?.modalState)return rr}(),c),fe=Ee?.x,be=Ee?.y;(0,n.vJ)(()=>{ye||void 0===fe||void 0===be||f({position:{x:fe,y:be}})},[ye,fe,be]),(0,n.vJ)(()=>{!ye&&ve&&G&&b({size:ve})},[ye,G,ve]);const Ce=ve||w(),Se=Ce.width,ke=Ce.height;(0,n.vJ)(()=>{pe&&k({width:Se,height:ke})},[ke,Se,pe,k]);const we=(0,B.A)(),Ne=(0,Ua.A)(),{queryId:Ie}=F||{},Pe=N?Object.values(N).length:0;(0,gs.A)(()=>{N&&Object.keys(N).forEach(e=>{const a=N[e];a.queryId&&u({botId:a.botId,queryId:a.queryId,peerId:a.peerId||t.id,replyInfo:a.replyInfo})})},Ie?45e3:void 0,!0);const Me=(0,n.li)(null),Te=(0,n.li)(null),xe=(0,x.A)(e=>{Me.current=e}),Be=(0,x.A)(e=>{Me.current&&Me.current(e)}),Le=(0,x.A)(e=>{Te.current=e}),Re=(0,x.A)(e=>{Te.current&&Te.current(e)}),Fe=(0,x.A)(()=>{Be({eventType:"settings_button_pressed"})}),De=(0,x.A)(()=>{Re(F.url)}),Ve=(0,x.A)(()=>{m()}),_e=(0,x.A)(()=>{E()}),Oe=(0,x.A)(()=>{Pe>1?d():m()}),Je=(0,x.A)(()=>{if(r){const e=(0,As.rp)(F);return void g({key:e,update:{isRemoveModalOpen:!0}})}A({botId:a.id,isEnabled:!0})}),Ke=(0,x.A)(()=>{D?Be({eventType:"back_button_pressed"}):Ve()}),Ge=(0,x.A)(()=>{y({state:"minimized"})}),je=(0,x.A)(()=>{y({state:"fullScreen"})}),ze=(0,x.A)(()=>{v()}),He=(0,x.A)(e=>{p({webApp:e.webApp})}),$e=(0,x.A)(()=>{h({id:a.id})}),qe=(0,n.Kr)(()=>({onTrigger:e,isOpen:t})=>n.Ay.createElement(Y.A,{className:(0,ue.A)(H?"gkji2_RB":"kKPD09tc",t&&"active"),round:!0,ripple:!J,size:H?"tiny":"smaller",color:"translucent",onClick:e,ariaLabel:"More actions"},n.Ay.createElement(Q.A,{name:"more"})),[J,H]);function Qe(){return n.Ay.createElement(n.Ay.Fragment,null,t&&a&&t.id!==a.id&&n.Ay.createElement(ce.A,{icon:"bots",onClick:$e},we("BotWebViewOpenBot")),n.Ay.createElement(ce.A,{icon:"reload",onClick:De},we("WebApp.ReloadPage")),U&&n.Ay.createElement(ce.A,{icon:"settings",onClick:Fe},we("Settings")),a?.isAttachBot&&n.Ay.createElement(ce.A,{icon:r?"stop":"install",onClick:Je,destructive:Boolean(r)},we(r?"WebApp.RemoveBot":"WebApp.AddToAttachmentAdd")))}function Ye(){return n.Ay.createElement(We.A,{isOpen:ae,anchor:ne,ref:W,className:(0,ue.A)(H?Zs:"web-app-more-menu","with-menu-transitions"),getTriggerElement:Z,getMenuElement:te,getRootElement:ee,autoClose:!0,onClose:re,onCloseAnimationEnd:ie},Qe())}const Ze=(0,ue.A)("RuJ3d9N6",D&&"IWA50OWU"),Xe=(0,n.Kr)(()=>{if(R)return"color-text";if(!V)return;const{r:e,g:t,b:a}=(0,ps.E2)(V),n=(0,ys.LS)([e,t,a]);return("dark"===o?255-n:n)>128?"color-text":"color-background"},[V,o,R]);function et(e){return n.Ay.createElement("svg",{className:e,width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},n.Ay.createElement("path",{className:"bOuMHiVw","fill-rule":"evenodd","clip-rule":"evenodd",d:"M16 16V0C16 12 12 16 0 16H16Z"}))}const tt=(0,n.li)();function at(e){return(0,ue.A)(i.jQ1,e)}return(0,ks.A)(tt,!K||j||!tt.current),n.Ay.createElement(X.A,{dialogRef:$,className:(0,ue.A)("XWfkIDLY",H&&"gBVR7Hec",j&&"dJ1Ld_PX",z&&"ciSTWz16"),dialogStyle:H?ge:void 0,dialogContent:oe&&!j?n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:at("top")}),n.Ay.createElement("div",{className:at("bottom")}),n.Ay.createElement("div",{className:at("left")}),n.Ay.createElement("div",{className:at("right")}),n.Ay.createElement("div",{className:at("topLeft")}),n.Ay.createElement("div",{className:at("topRight")}),n.Ay.createElement("div",{className:at("bottomLeft")}),n.Ay.createElement("div",{className:at("bottomRight")})):void 0,isOpen:K,isLowStackPriority:!0,onClose:Ve,header:n.Ay.createElement("div",{ref:q},H?G?n.Ay.createElement("div",{className:(0,ue.A)("modal-header","multiTab"),style:(0,Ta.A)(Xe&&`--color-header-text: var(--${Xe})`)},n.Ay.createElement(Y.A,{className:"GE5AkJOU",round:!0,color:"translucent",size:"tiny",ariaLabel:we(D?"Back":"Close"),onClick:Ke},n.Ay.createElement("div",{className:Ze})),n.Ay.createElement("div",{className:"X18WbDa5",ref:tt},O?.map(e=>e.isOpen?function(){const e=(0,Ta.A)(Xe&&`--color-header-text: var(--${Xe})`,V&&`--active-tab-background: ${V}`);return n.Ay.createElement("div",{className:Hs,style:e},et(Qs),n.Ay.createElement("div",{className:$s},n.Ay.createElement("div",{className:"z39ojrWc"},n.Ay.createElement(xt.A,{size:"mini",peer:a}),n.Ay.createElement(qe,{onTrigger:se,isOpen:ae})),r?.shortName??a?.firstName,n.Ay.createElement("div",{className:qs}),n.Ay.createElement(Y.A,{className:Ws,round:!0,color:"translucent",size:"tiny",ariaLabel:we("Close"),onClick:Oe},n.Ay.createElement(Q.A,{className:er,name:"close"}))),et(Ys))}():n.Ay.createElement(xt.A,{className:"tI6TE6HP",size:"mini",peer:e.bot,onClick:()=>He(e)})),R&&n.Ay.createElement("div",{className:Hs},et(Qs),n.Ay.createElement("div",{className:$s},n.Ay.createElement("div",{className:"Obu3ui67"},n.Ay.createElement(Q.A,{className:ar,name:"add"})),Ne("OpenApp"),n.Ay.createElement("div",{className:qs}),n.Ay.createElement(Y.A,{className:Ws,round:!0,color:"translucent",size:"tiny",ariaLabel:we("Close"),onClick:_e},n.Ay.createElement(Q.A,{className:er,name:"close"}))),et(Ys))),Ye(),n.Ay.createElement("div",{className:"qK4q0Sat"},!R&&n.Ay.createElement(Y.A,{className:(0,ue.A)("cEuW1_hJ","no-drag"),round:!0,color:"translucent",size:"tiny",onClick:ze},n.Ay.createElement(Q.A,{className:ar,name:"add"})),!R&&n.Ay.createElement(Y.A,{className:(0,ue.A)(Xs,"otlJULGy","no-drag"),round:!0,color:"translucent",size:"tiny",onClick:je},n.Ay.createElement(Q.A,{className:tr,name:"expand-modal"})),n.Ay.createElement(Y.A,{className:(0,ue.A)(Xs,"no-drag"),round:!0,color:"translucent",size:"tiny",onClick:Ge},n.Ay.createElement(Q.A,{className:tr,name:"collapse-modal"})))):n.Ay.createElement(ws,null):n.Ay.createElement("div",{className:"modal-header",style:(0,Ta.A)(V&&`background-color: ${V}`,Xe&&`--color-header-text: var(--${Xe})`)},n.Ay.createElement(Y.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:we(D?"Back":"Close"),onClick:Ke},n.Ay.createElement("div",{className:Ze})),n.Ay.createElement("div",{className:"modal-title"},r?.shortName??a?.firstName),!R&&n.Ay.createElement(le.A,{className:(0,ue.A)(H?Zs:"web-app-more-menu","with-menu-transitions"),trigger:qe,positionX:H?"left":"right"},Qe()))),style:`background-color: ${_||"var(--color-background)"}`,noBackdrop:!0,noBackdropClose:!0},z&&Ye(),N&&L?.map(t=>n.Ay.createElement(zs,{key:t,modal:e,registerSendEventCallback:xe,registerReloadFrameCallback:Le,webApp:N[t],isTransforming:ye||pe,onContextMenuButtonClick:se,isMultiTabSupported:H,modalHeight:ke})),R&&n.Ay.createElement(Bs,null))})),or=(0,n.ph)(({bot:e,type:t,shouldRequestWriteAccess:a})=>{const{cancelBotTrustRequest:r,markBotTrusted:i}=(0,s.ko)(),[o,c]=(0,n.J0)(a||!1),d=(0,B.A)(),m=(0,n.hb)(()=>{i({botId:e.id,isWriteAllowed:o})},[i,o,e]),u=(0,n.hb)(()=>{r()},[]),A=d("game"===t?"AppName":"BotOpenPageTitle"),h=(0,n.Kr)(()=>{switch(t){case"game":return d("BotPermissionGameAlert",(0,l.Yg)(e));case"webApp":return d("BotOpenPageMessage",(0,l.Yg)(e));default:return d("BotWebViewStartPermission")}},[e,t,d]);return n.Ay.createElement(ya.A,{isOpen:Boolean(e),onClose:u,title:A,confirmHandler:m},(0,Tt.A)(h,["simple_markdown"]),a&&n.Ay.createElement(as.A,{className:"dialog-checkbox",checked:o,label:(0,Tt.A)(d("WebApp.AddToAttachmentAllowMessages",e?.firstName),["simple_markdown"]),onCheck:c}))}),lr=(0,n.ph)(({modal:e})=>{const{confirmAttachBotInstall:t,cancelAttachBotInstall:a}=(0,s.ko)(),r=e?.bot,[o,l]=(0,n.J0)(!1),c=(0,B.A)(),d=(0,n.hb)(()=>{t({isWriteAllowed:Boolean(r?.shouldRequestWriteAccess)})},[t,r]);(0,n.vJ)(()=>{r&&l(!1)},[r]);const m=(0,n.Kr)(()=>{const e=c("lng_mini_apps_disclaimer_button").split("{link}"),t=c("lng_mini_apps_disclaimer_link");return[e[0],n.Ay.createElement("a",{href:i.Pje,target:"_blank",rel:"noopener noreferrer"},t),e[1]]},[c]);return n.Ay.createElement(ya.A,{isOpen:Boolean(r),onClose:a,title:c("lng_mini_apps_disclaimer_title"),confirmHandler:d,isConfirmDisabled:!o},(0,Tt.A)(c("lng_mini_apps_disclaimer_text",r?.shortName),["simple_markdown"]),n.Ay.createElement(as.A,{className:"dialog-checkbox",checked:o,label:m,onCheck:l}),(0,Tt.A)(c("WebBot.Account.Desclaimer.Desc",r?.shortName),["simple_markdown"]))}),cr=(0,n.ph)(({folder:e})=>{const{closeDeleteChatFolderModal:t,deleteChatFolder:a,openDeleteChatFolderModal:r}=(0,s.ko)(),i=(0,B.A)(),o=Boolean(e),l=(0,U.A)(e)||e,c=l?.hasMyInvites,d=(0,n.hb)(()=>{t(),c?r({folderId:l.id,isConfirmedForChatlist:!0}):a({id:l.id})},[c,l]);return n.Ay.createElement(ya.A,{isOpen:o,onClose:t,text:i(c?"FilterDeleteAlertLinks":"FilterDeleteAlert"),confirmLabel:i("Delete"),confirmHandler:d,confirmIsDestructive:!0})});var dr=a(64520),mr=a(17142),ur=a(66833),Ar=a(87412),hr=a(38777);const yr={root:"Wn7D2H1e",text:"IQ1U2TrZ",header:"F6qqXRvD",description:"ILLaH6qQ",icon:"DzGwbpu5","font-icon":"Pa9h5mh3",fontIcon:"Pa9h5mh3"},pr=["#F2862D","#EB7B4D","#E46D72","#DD6091","#CC5FBA","#B464E7","#9873FF","#768DFF","#55A5FC","#52B0C9","#4FBC93","#4CC663"].map(ps.E2),gr=(0,n.ph)(({icon:e,isFontIcon:t,title:a,text:s,index:r,count:i,section:o,onClick:l})=>{const c=r/i*pr.length,d=pr[Math.floor(c)],m=pr[Math.ceil(c)]??d,{r:u,g:A,b:h}=(0,ps.dD)(d,m,.5),y=(0,x.A)(()=>{l?.(o)});return n.Ay.createElement(ca.A,{buttonClassName:yr.root,onClick:y,inactive:!l},t?n.Ay.createElement(Q.A,{name:e,className:yr.fontIcon,style:`--item-color: rgb(${u},${A},${h})`}):n.Ay.createElement("img",{src:e,className:yr.icon,alt:"",style:`--item-color: rgb(${u},${A},${h})`,draggable:!1}),n.Ay.createElement("div",{className:yr.text},n.Ay.createElement("div",{className:yr.title},(0,Tt.A)(a,["br"])),n.Ay.createElement("div",{className:yr.description},s)))});var vr=a(57446);const Er="cqNhvdib",fr="wDzTWXzO",br=(0,n.ph)(({length:e,active:t,onSelectSlide:a})=>{const s=Math.max(0,Math.min(e-8,t-4)),r=s===e-8-1,i=s===e-8,o=0===s,l=1===s,c=Math.min(e,8),d=(0,n.hb)(()=>{a(t+1)},[t,a]),m=(0,n.hb)(()=>{a(t-1)},[t,a]),u=Math.min(8,e);return n.Ay.createElement("div",null,!E.TF&&n.Ay.createElement(Y.A,{className:(0,ue.A)(Er,0===t&&fr),color:"translucent",disabled:0===t,round:!0,onClick:m},n.Ay.createElement(Q.A,{name:"previous"})),n.Ay.createElement("div",{className:"HmY1pYD9",style:`--start-from: ${s}; --length: ${e}; --count: ${u};`},Array(e).fill(void 0).map((e,d)=>{const m=d,u=d===s+c-1&&!i&&!r,A=d===s+c-2&&!r&&!i||d===s+c-1&&r,h=d===s&&!o&&!l,y=d===s+1&&!o&&!l||d===s&&l,p=d<s||d>=s+c;return n.Ay.createElement("div",{onClick:()=>a(d),className:(0,ue.A)("Ac0pMX9w",m===t&&"NYDxCNdz",(A||y)&&"yDo_8Y7X",(u||h||p)&&"bhODNwmU",p&&"O9pyrgj0")})})),!E.TF&&n.Ay.createElement(Y.A,{className:(0,ue.A)(Er,t===e-1&&fr,"hIgQCprt"),color:"translucent",round:!0,disabled:t===e-1,onClick:d},n.Ay.createElement(Q.A,{name:"next"})))}),Cr="Hy5kWx0p",Sr=(0,n.ph)(({leftValue:e,rightValue:t,className:a,floatingBadgeIcon:s,rightStyle:r})=>{const i=(0,B.A)();return n.Ay.createElement("div",{className:(0,ue.A)("u84X0r2z",a)},s&&n.Ay.createElement("div",{className:"hPi4fICJ"},n.Ay.createElement(Q.A,{name:s,className:"XkiOXdMP"}),n.Ay.createElement("div",{className:"iC3LJrvy",dir:i.isRtl?"rtl":void 0},e),n.Ay.createElement("div",{className:"jufjjcX9"},n.Ay.createElement("svg",{width:"26",height:"9",viewBox:"0 0 26 9",fill:"none"},n.Ay.createElement("path",{d:"M0 0H26H24.4853C22.894 0 21.3679 0.632141 20.2426 1.75736L14.4142 7.58579C13.6332 8.36684 12.3668 8.36683 11.5858 7.58579L5.75736 1.75736C4.63214 0.632139 3.10602 0 1.51472 0H0Z",fill:"#7E85FF"})))),n.Ay.createElement("div",{className:(0,ue.A)(Cr,"scGr4JS9")},n.Ay.createElement("div",{className:"OejVAPj6 YaiSoFKE YaiSoFKE",dir:i.isRtl?"rtl":void 0},i("LimitFree")),!s&&n.Ay.createElement("div",{className:"RJosx238 YaiSoFKE"},e)),n.Ay.createElement("div",{className:(0,ue.A)(Cr,"nPaUalQf"),style:r},n.Ay.createElement("div",{className:"COQdFBQk YaiSoFKE YaiSoFKE",dir:i.isRtl?"rtl":void 0},i("LimitPremium")),n.Ay.createElement("div",{className:"BEq3jFlz YaiSoFKE YaiSoFKE"},t)))}),kr=[91,160,255],wr=[197,100,243],Nr=(0,n.ph)(({title:e,description:t,leftValue:a,rightValue:s,colorStepProgress:r})=>{const i=(0,n.Kr)(()=>kr.map((e,t)=>(0,he.Cc)(e,wr[t],r)),[r]);return n.Ay.createElement("div",{className:"ZXp65Wgy"},n.Ay.createElement("div",{className:"W1xG3pjS"},e),n.Ay.createElement("div",{className:"b_CBXIkT"},t),n.Ay.createElement(Sr,{leftValue:a,rightValue:s,rightStyle:`background: rgb(${i.join(",")})`}))});var Ir=a(67054),Pr=a(18104);const Mr=({size:e,realIndex:t,canPlay:a,sticker:s,index:r,maxLength:i,onClick:o,onEnded:l})=>{const c=(0,H.A)(`sticker${s.id}`),d=(0,H.A)(`sticker${s.id}?size=f`),m=0===r,[u,A,h]=(0,M.A)(m),y=e-.6*e,p=3*y,g=3.2*y,v=r/i*(2*Math.PI),E=m?1:.66,f=Math.cos(v)*p-2.8*y,b=Math.sin(v)*g,C=(0,x.A)(()=>{o(t)}),S=(0,x.A)(()=>{h(),l(t)});return(0,n.vJ)(()=>{m&&A()},[m,A]),n.Ay.createElement(n.Ay.Fragment,null,m&&n.Ay.createElement(Pr.A,{className:"Stdz4UIW ogaoEAcn",tgsUrl:d,play:a,isLowPriority:!0,noLoop:!0,size:.8*e,style:`--x: calc(${f}px - 10%); --y: ${b}px;`}),n.Ay.createElement(Pr.A,{className:"ogaoEAcn",tgsUrl:c,play:a&&u,noLoop:!0,size:.6*e,style:`--x: ${f}px; --y: ${b}px; --opacity: ${E}`,onClick:C,onEnded:S}))},Tr=(0,n.ph)((0,s.EK)(e=>({stickers:e.stickers.premium.stickers}))(({stickers:e,isActive:t})=>{const a=(0,n.li)(),[s,r]=(0,n.J0)(0),[i,o]=(0,n.J0)(0),l=e?.slice(0,15),c=(0,x.A)(e=>{r(-e)}),d=(0,x.A)(e=>{0===(0,Ir.A)(l.length,e+s)&&setTimeout(()=>{r(e=>(0,Ir.A)(l.length,e+1))},150)});return(0,n.vJ)(()=>{const e=a.current;e&&o(e.closest(".modal-dialog").clientWidth)},[]),n.Ay.createElement("div",{className:"O1fqNCy0",ref:a},Boolean(i)&&l?.map((e,a)=>n.Ay.createElement(Mr,{size:i,sticker:e,realIndex:a,index:(a+s+l.length)%l.length,maxLength:l.length,onClick:c,onEnded:d,canPlay:t})))}));var xr=a(38691),Br=a(88554);const Lr={stories_order:"PremiumStoriesPriority",stories_stealth:"PremiumStoriesStealth",stories_views:"PremiumStoriesViews",stories_timer:"lng_premium_stories_subtitle_expiration",stories_save:"PremiumStoriesSaveToGallery",stories_caption:"lng_premium_stories_subtitle_caption",stories_link:"lng_premium_stories_subtitle_links"},Rr={stories_order:"PremiumStoriesPriorityDescription",stories_stealth:"PremiumStoriesStealthDescription",stories_views:"PremiumStoriesViewsDescription",stories_timer:"PremiumStoriesExpirationDescription",stories_save:"PremiumStoriesSaveToGalleryDescription",stories_caption:"PremiumStoriesCaptionDescription",stories_link:"PremiumStoriesFormattingDescription"},Fr={stories_order:"story-priority",stories_stealth:"eye-crossed-outline",stories_views:"eye-outline",stories_timer:"timer",stories_save:"arrow-down-circle",stories_caption:"story-caption",stories_link:"link-badge"},Dr=Object.keys(Lr),Vr=xt.R.giant+.25*h.$,_r=(0,n.ph)((0,s.EK)(e=>({currentUser:(0,c.mBe)(e,e.currentUserId)}))(({currentUser:e})=>{const t=(0,n.li)(),a=(0,B.A)(),s=(0,xr.A)();(0,n.Nf)(()=>{t.current&&(0,Br.$)({canvas:t.current,size:Vr*s,segmentsCount:8,color:"purple",readSegmentsCount:0,readSegmentColor:"transparent",dpr:s})},[s]);const{handleScroll:r,isAtBeginning:i}=En(),o=Vr;return n.Ay.createElement("div",{className:"mFElmm7a"},n.Ay.createElement("div",{className:"Jjbochk6"},n.Ay.createElement(xt.A,{forPremiumPromo:!0,peer:e,size:"giant"}),n.Ay.createElement("canvas",{className:"ChteQ9C3",ref:t,style:`max-width: ${o}px; max-height: ${o}px`})),n.Ay.createElement("div",{className:"d2ayix6L"},a("UpgradedStories")),n.Ay.createElement("div",{className:(0,ue.A)("ensyCeMe",!i&&"iN1T0a2Y","custom-scroll"),onScroll:r},Dr.map((e,t)=>n.Ay.createElement(gr,{key:e,title:a(Lr[e]),text:a(Rr[e]),icon:Fr[e],isFontIcon:!0,index:t,count:Dr.length,section:e})),n.Ay.createElement("div",{className:"DFbZJafh"},a("lng_premium_stories_about_mobile"))))})),Ur={root:"Ot0dA1yZ",wrapper:"yxSAGAc1",down:"Jcy6cDoc",frame:"Vn81yTTJ",video:"rrVJClLL"},Or=a.p+"DeviceFrame.79271ee0fa60a7b6a1aa.svg",Jr=(0,n.ph)(({videoId:e,isReverseAnimation:t,isDown:a,videoThumbnail:s,index:r,isActive:i})=>{const o=(0,H.A)(`document${e}`),l=(0,_a.A)(s.dataUri),c=(0,Ja.A)(o);return n.Ay.createElement("div",{className:Ur.root},n.Ay.createElement("div",{className:(0,ue.A)(Ur.wrapper,t&&Ur.reverse,a&&Ur.down),id:`premium_feature_preview_video_${r}`},n.Ay.createElement("img",{src:Or,alt:"",className:Ur.frame,draggable:!1}),n.Ay.createElement("canvas",{ref:l,className:Ur.video}),n.Ay.createElement(Ha.A,{canPlay:i,className:(0,ue.A)(Ur.video,c),src:o,disablePictureInPicture:!0,playsInline:!0,muted:!0,loop:!0})))}),Kr="a7IoUtQG",Gr="gubS9KP1",jr="iZLwcL8v",zr="A7YHY8qF",Hr={double_limits:"PremiumPreviewLimits",infinite_reactions:"PremiumPreviewReactions2",premium_stickers:"PremiumPreviewStickers",animated_emoji:"PremiumPreviewEmoji",no_ads:"PremiumPreviewNoAds",voice_to_text:"PremiumPreviewVoiceToText",profile_badge:"PremiumPreviewProfileBadge",faster_download:"PremiumPreviewDownloadSpeed",more_upload:"PremiumPreviewUploads",advanced_chat_management:"PremiumPreviewAdvancedChatManagement",animated_userpics:"PremiumPreviewAnimatedProfiles",emoji_status:"PremiumPreviewEmojiStatus",translations:"PremiumPreviewTranslations",stories:"PremiumPreviewStories",saved_tags:"PremiumPreviewTags2",last_seen:"PremiumPreviewLastSeen",message_privacy:"PremiumPreviewMessagePrivacy",effects:"Premium.MessageEffects",todo:"PremiumPreviewTodo"},$r={double_limits:"PremiumPreviewLimitsDescription",infinite_reactions:"PremiumPreviewReactions2Description",premium_stickers:"PremiumPreviewStickersDescription",no_ads:"PremiumPreviewNoAdsDescription",animated_emoji:"PremiumPreviewEmojiDescription",voice_to_text:"PremiumPreviewVoiceToTextDescription",profile_badge:"PremiumPreviewProfileBadgeDescription",faster_download:"PremiumPreviewDownloadSpeedDescription",more_upload:"PremiumPreviewUploadsDescription",advanced_chat_management:"PremiumPreviewAdvancedChatManagementDescription",animated_userpics:"PremiumPreviewAnimatedProfilesDescription",emoji_status:"PremiumPreviewEmojiStatusDescription",translations:"PremiumPreviewTranslationsDescription",stories:"PremiumPreviewStoriesDescription",saved_tags:"PremiumPreviewTagsDescription2",last_seen:"PremiumPreviewLastSeenDescription",message_privacy:"PremiumPreviewMessagePrivacyDescription",effects:"Premium.MessageEffectsInfo",todo:"PremiumPreviewTodoDescription"},qr={channels:"GroupsAndChannelsLimitTitle",dialogFolderPinned:"PinChatsLimitTitle",channelsPublic:"PublicLinksLimitTitle",savedGifs:"SavedGifsLimitTitle",stickersFaved:"FavoriteStickersLimitTitle",aboutLength:"BioLimitTitle",captionLength:"CaptionsLimitTitle",dialogFilters:"FoldersLimitTitle",dialogFiltersChats:"ChatPerFolderLimitTitle",recommendedChannels:"SimilarChannelsLimitTitle",moreAccounts:"ConnectedAccountsLimitTitle"},Wr={channels:"GroupsAndChannelsLimitSubtitle",dialogFolderPinned:"PinChatsLimitSubtitle",channelsPublic:"PublicLinksLimitSubtitle",savedGifs:"SavedGifsLimitSubtitle",stickersFaved:"FavoriteStickersLimitSubtitle",aboutLength:"BioLimitSubtitle",captionLength:"CaptionsLimitSubtitle",dialogFilters:"FoldersLimitSubtitle",dialogFiltersChats:"ChatPerFolderLimitSubtitle",recommendedChannels:"SimilarChannelsLimitSubtitle",moreAccounts:"ConnectedAccountsLimitSubtitle"},Qr=(0,n.ph)(({promo:e,initialSection:t,isPremium:a,limits:s,premiumPromoOrder:r,subscriptionOption:l,onBack:c,onClickSubscribe:d})=>{const m=(0,B.A)(),u=(0,Ua.A)(),A=(0,n.li)(),[h,y]=(0,n.J0)(i.O2i.indexOf(t)),[p,g]=(0,n.J0)(0),[v,E,f]=(0,M.A)(),[b,C]=(0,n.J0)(!0),[S,k]=(0,n.J0)(!1),w=(0,U.A)(t),N=(0,n.Kr)(()=>r?r.filter(e=>i.O2i.includes(e)):i.O2i,[r]),I=(0,n.Kr)(()=>{if(!l)return;const{amount:e,months:t,currency:n}=l,s=Math.floor(e/t);return a?u("OK"):u("SubscribeToPremium",{price:(0,mr.vv)(u,s,n)},{withNodes:!0})},[a,u,l]),P=(0,x.A)(()=>{d(t)});function T(e){const{scrollTop:t,clientHeight:a,scrollHeight:n}=e.currentTarget;C(t<=20),k(t>=n-a-20)}(0,n.vJ)(()=>{const e=A.current;if(!e||w===t)return;const a=N.indexOf(t);y(a),E(),(0,vr.A)(e,e.clientWidth*a,0).then(f)},[h,N,t,w]);const L=(0,x.A)(async e=>{const t=A.current;t&&(y(e),E(),await(0,vr.A)(t,t.clientWidth*e,800),f())}),R=N[h],F="double_limits"!==R&&"stories"!==R;return n.Ay.createElement("div",{className:"oyUTEj8I"},n.Ay.createElement(Y.A,{round:!0,size:"smaller",className:(0,ue.A)("njYoMrKM",F&&"SB4pczOo"),color:F?"translucent-white":"translucent",onClick:c,ariaLabel:m("Back")},n.Ay.createElement(Q.A,{name:"arrow-left"})),n.Ay.createElement("div",{className:"dIVBSdWi"}),n.Ay.createElement("div",{className:(0,ue.A)("sJubG84j","no-scrollbar"),onScroll:function(e){const t=e.currentTarget,{clientWidth:a,scrollLeft:n}=t,s=Math.round(n),r=s%a/a,i=Math.ceil((s+1)/a);g(i);const l=t.querySelector("#premium_feature_preview_video_"+(i-1)),c=t.querySelector(`#premium_feature_preview_video_${i}`);if((0,o.RK)(()=>{t.style.setProperty("--scroll-progress",r.toString()),t.style.setProperty("--abs-scroll-progress",Math.abs(r).toString()),l&&(0,Wa.dH)(l,"reverse",!1),c&&(0,Wa.dH)(c,"reverse",!0)}),v)return;const d=Math.round(s/a);y(d)},ref:A},N.map((t,a)=>{if("double_limits"===t)return n.Ay.createElement("div",{className:(0,ue.A)(Gr,"U7ePgVBR")},n.Ay.createElement("h2",{className:(0,ue.A)("mz2Hmd83",b&&"AgmNOqi7")},m(Hr.double_limits)),n.Ay.createElement("div",{className:(0,ue.A)("n_rowVPI","custom-scroll"),onScroll:T},i.M$8.map((e,t)=>{const a=s?.[e][0].toString(),r=s?.[e][1].toString();return n.Ay.createElement(Nr,{title:m(qr[e]),description:m(Wr[e],r),leftValue:a,rightValue:r,colorStepProgress:t/(i.M$8.length-1)})})));if("premium_stickers"===t)return n.Ay.createElement("div",{className:Gr},n.Ay.createElement("div",{className:Kr},n.Ay.createElement(Tr,{isActive:h===a})),n.Ay.createElement("h1",{className:jr},m(Hr.premium_stickers)),n.Ay.createElement("div",{className:zr},(0,Tt.A)(m($r.premium_stickers),["br"])));if("stories"===t)return n.Ay.createElement("div",{className:(0,ue.A)(Gr,"J1M6fEdo")},n.Ay.createElement(_r,null));const r=e.videoSections.indexOf(t);if(-1===r)return;const o="todo"===e.videoSections[r];return n.Ay.createElement("div",{className:Gr},n.Ay.createElement("div",{className:Kr},n.Ay.createElement(Jr,{isActive:h===a,videoId:e.videos[r].id,videoThumbnail:e.videos[r].thumbnail,isDown:i.jhT.includes(t),index:a,isReverseAnimation:a===p})),n.Ay.createElement("h1",{className:jr},o?u(Hr[e.videoSections[r]],void 0,{withNodes:!0,renderTextFilters:["br"]}):m(Hr[e.videoSections[r]])),n.Ay.createElement("div",{className:zr},(0,Tt.A)(o?u($r[e.videoSections[r]],void 0,{withNodes:!0,renderTextFilters:["br"]}):m($r[e.videoSections[r]]),["br"])))})),n.Ay.createElement("div",{className:(0,ue.A)("yN2611rA",(S||0!==h)&&"rCHMABcD")},n.Ay.createElement(br,{length:i.O2i.length,active:h,onSelectSlide:L}),Boolean(I)&&n.Ay.createElement(Y.A,{className:(0,ue.A)("EPfM7AgT"),isShiny:!a,withPremiumGradient:!a,onClick:a?c:P},I)))}),Yr=(0,n.ph)(({option:e,checked:t,fullMonthlyAmount:a,onChange:s,className:r,isGiveaway:i})=>{const o=(0,B.A)(),{months:l,amount:c,currency:d}=e,m="users"in e?e.users:void 0,u=Math.floor(c/l),A=m?m>1:void 0,h=(0,n.Kr)(()=>a&&a>u?Math.ceil(100-u/(a/100)):void 0,[a,u]),y=(0,n.hb)(e=>{e.target.checked&&s(l)},[l,s]);return n.Ay.createElement("label",{className:(0,ue.A)(i?"PkseWxFK":"qZA6S2kc",t&&!i&&"EJOQwnRj",r),dir:o.isRtl?"rtl":void 0},n.Ay.createElement("input",{className:"WOEkhx6R",type:"radio",name:"subscription_option",value:l,checked:t,onChange:y}),n.Ay.createElement("div",{className:"BHUCScsU"},n.Ay.createElement("div",{className:"DfYCMUkL"},Boolean(h)&&n.Ay.createElement("span",{className:(0,ue.A)("ublijP0j","uqDlP3Zt"),title:o("GiftDiscount")}," ","−",h,"%"),o("Months",l)),n.Ay.createElement("div",{className:"poxOXJ2o"},i||A?`${(0,mr.Ad)(c,d,o.code)} x ${m}`:o("PricePerMonth",(0,mr.Ad)(u,d,o.code))),n.Ay.createElement("div",{className:"IGMrERf_"},(0,mr.Ad)(c,d,o.code))))}),Zr="yKm9hKQP",Xr=a.p+"PremiumAds.a758f19ece91fe91318e.svg",ei=a.p+"PremiumBadge.1c630afcfd1112ad16d0.svg",ti=a.p+"PremiumChats.89d9d315638e283ca895.svg",ai=a.p+"PremiumEffects.4eab9caad8e9c276842d.svg",ni=a.p+"PremiumEmoji.26515017c8f6dc4f3f67.svg",si=a.p+"PremiumFile.884dd3865acfe594fc61.svg",ri=a.p+"PremiumLastSeen.9575a548770d23785846.svg",ii=a.p+"PremiumLimits.08701cb6df3cf756c5f7.svg",oi=a.p+"PremiumMessagePrivacy.950cab3e87c60c5733a6.svg",li=a.p+"PremiumReactions.7fee56ab6b58c82fd15e.svg",ci=a.p+"PremiumSpeed.d0a43b6780c411c2f84a.svg",di=a.p+"PremiumStatus.c42f9c4b68f9c2c4537a.svg",mi=a.p+"PremiumStickers.7b5a8531a41b43d0da12.svg",ui=a.p+"PremiumTags.3b187054cc90f8e16cb7.svg",Ai=a.p+"PremiumTranslate.cb2dcbb898d96cb35469.svg",hi=a.p+"PremiumVideo.288cb61931e33d913f0a.svg",yi=a.p+"PremiumVoice.b3a2893dbe481108ab94.svg",pi=8*h.$,gi={stories:di,double_limits:ii,infinite_reactions:li,premium_stickers:mi,animated_emoji:ni,no_ads:Xr,voice_to_text:yi,profile_badge:ei,faster_download:ci,more_upload:si,advanced_chat_management:ti,animated_userpics:hi,emoji_status:di,translations:Ai,saved_tags:ui,last_seen:ri,message_privacy:oi,effects:ai,todo:ei},vi=(0,n.ph)((0,s.EK)(e=>{const{premiumModal:t}=(0,c.nTw)(e),a=t?.fromUserId?(0,c.mBe)(e,t.fromUserId):void 0,n=a?.emojiStatus?e.customEmojis.byId[a.emojiStatus.documentId]:void 0,s=n?(0,c.ycM)(e,n.stickerSetInfo):void 0;return{currentUserId:e.currentUserId,promo:t?.promo,isSuccess:t?.isSuccess,isGift:t?.isGift,monthsAmount:t?.monthsAmount,gift:t?.gift,fromUser:a,fromUserStatusEmoji:n,fromUserStatusSet:s,toUser:t?.toUserId?(0,c.mBe)(e,t.toUserId):void 0,initialSection:t?.initialSection,isPremium:(0,c.g29)(e),limitChannels:(0,dr.B)(e,"channels"),limitFolders:(0,dr.B)(e,"dialogFilters"),limitPins:(0,dr.B)(e,"dialogFolderPinned"),limitLinks:(0,dr.B)(e,"channelsPublic"),limits:e.appConfig?.limits,premiumSlug:e.appConfig?.premiumInvoiceSlug,premiumBotUsername:e.appConfig?.premiumBotUsername,premiumPromoOrder:e.appConfig?.premiumPromoOrder}})(({isOpen:e,currentUserId:t,fromUser:a,fromUserStatusEmoji:r,fromUserStatusSet:o,promo:c,initialSection:d,isPremium:m,limitChannels:u,limitLinks:A,limitFolders:h,limitPins:y,limits:p,premiumSlug:g,premiumBotUsername:v,isSuccess:E,isGift:f,toUser:b,monthsAmount:C,premiumPromoOrder:S,gift:k})=>{const w=(0,n.li)(),{closePremiumModal:N,openInvoice:I,requestConfetti:P,openTelegramLink:M,loadStickers:T,openStickerSet:L}=(0,s.ko)(),R=(0,B.A)(),F=(0,Ua.A)(),[D,V]=(0,n.J0)(!0),[_,U]=(0,n.J0)(d),[O,J]=(0,n.J0)();(0,n.vJ)(()=>{e?d&&U(d):(V(!0),U(void 0))},[e,d]);const K=(0,x.A)(e=>{U(e)}),G=(0,x.A)(()=>{U(void 0)}),j=(0,x.A)(e=>{w.current&&(g?I({type:"slug",slug:g}):v&&(M({url:`${i.jsp}${v}?start=${e||"promo"}`}),N()))}),H=(0,x.A)(()=>{O?j(String(O.months)):j()}),$=(0,x.A)(e=>{const t=c?.options.find(t=>t.months===e);J(t)}),q=(0,x.A)(()=>{const t=w.current;if(t&&e){const{top:e,left:a,width:n,height:s}=t.querySelector(".modal-content").getBoundingClientRect();P({top:e,left:a,width:n,height:s,withStars:!0})}});(0,n.vJ)(()=>{E&&q()},[E,q]),(0,z.A)(([e])=>{e!==m&&q()},[m,q]);const W=(0,n.Kr)(()=>S?S.filter(e=>i.O2i.includes(e)):i.O2i,[S]);(0,n.vJ)(()=>{r&&!o&&T({stickerSetInfo:r.stickerSetInfo})},[T,r,o]),(0,n.vJ)(()=>{const[e]=c?.options??[];J(e)},[c]);const Z=(0,x.A)(()=>{o&&L({stickerSetInfo:o})}),ee=(0,n.Kr)(()=>{const e=c?.options.find(e=>1===e.months);if(e)return Number(e.amount)},[c]),te=(0,n.Kr)(()=>{if(!O)return;const{amount:e,months:t,currency:a}=O,n=Math.floor(e/t);return(0,mr.vv)(F,n,a)},[O,F]);if(c&&(!r||o))return n.Ay.createElement(X.A,{className:"sfbpMFHM",onClose:N,isOpen:e,dialogRef:w},n.Ay.createElement(ne.Ay,{name:"slide",activeKey:_?1:0,className:"ELNkgPve"},_?n.Ay.createElement(Qr,{initialSection:_,onBack:G,promo:c,onClickSubscribe:j,isPremium:m,limits:p,premiumPromoOrder:S,subscriptionOption:O}):n.Ay.createElement("div",{className:(0,ue.A)("ZpOIPrhp","custom-scroll"),onScroll:function(e){const{scrollTop:t}=e.currentTarget;V(t<=150)}},n.Ay.createElement(Y.A,{round:!0,size:"smaller",className:"XyN3eWog",color:"translucent",onClick:()=>N(),ariaLabel:R("Close")},n.Ay.createElement(Q.A,{name:"close"})),function(){if(k){const e=(0,ur.yQ)(k);return n.Ay.createElement(hr.A,{model:"sticker",sticker:e,color:"purple",title:ae(),description:(0,Tt.A)(se(),["simple_markdown","emoji"]),className:"lzalivui"})}return r?n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(Ar.A,{className:"mQwvY9LA",onClick:Z,documentId:r.id,isBig:!0,size:pi}),n.Ay.createElement("h2",{className:(0,ue.A)("y71v6ECL",o&&"xw_GbDj7")},ae()),n.Ay.createElement("div",{className:"cUcKXV3j"},(0,Tt.A)(se(),["simple_markdown","emoji"]))):n.Ay.createElement(hr.A,{model:"swaying-star",color:"purple",title:ae(),description:(0,Tt.A)(se(),["simple_markdown","emoji"]),className:"z0zfJObh"})}(),!m&&!f&&n.Ay.createElement("div",{className:"xZC_Oajr"},c?.options.map(e=>n.Ay.createElement(Yr,{className:"gygsbDbE",key:e.amount,option:e,onChange:$,fullMonthlyAmount:ee,checked:O?.months===e.months}))),n.Ay.createElement("div",{className:(0,ue.A)("Bc_F0RKb",D&&"ltXo0Xi7")},n.Ay.createElement("h2",{className:"xysPdANX"},R("TelegramPremium"))),n.Ay.createElement("div",{className:(0,ue.A)("c3Ee2oSo",m&&"yWEHoJOL")},W.map((e,t)=>{const a="todo"===e;return n.Ay.createElement(gr,{key:e,title:a?F(Hr[e]):R(Hr[e]),text:"double_limits"===e?R($r[e],[u,h,y,A,4]):a?F($r[e]):R($r[e]),icon:gi[e],index:t,count:W.length,section:e,onClick:K})}),n.Ay.createElement("div",{className:(0,ue.A)(Zr,"l1WlNpmu"),dir:R.isRtl?"rtl":void 0},n.Ay.createElement("p",null,(0,Tt.A)(R("AboutPremiumDescription"),["simple_markdown"])),n.Ay.createElement("p",null,(0,Tt.A)(R("AboutPremiumDescription2"),["simple_markdown"]))),function(){if(c&&(!f||a?.id!==t))return n.Ay.createElement("div",{className:Zr,dir:R.isRtl?"rtl":void 0},(0,Xa.fd)({text:c.statusText,entities:c.statusEntities}))}()),!m&&O&&n.Ay.createElement("div",{className:"nCnlO9UZ"},n.Ay.createElement(Y.A,{className:"c1tMxuFH",isShiny:!0,withPremiumGradient:!0,onClick:H},R("SubscribeToPremium",te))))));function ae(){if(k)return F("PremiumGiftHeader");if(f)return(0,Tt.A)(a?.id===t?R("TelegramPremiumUserGiftedPremiumOutboundDialogTitle",[(0,l.Yg)(b),C]):R("TelegramPremiumUserGiftedPremiumDialogTitle",[(0,l.Yg)(a),C]),["simple_markdown","emoji"]);if(o&&a){const e=R("lng_premium_emoji_status_title").replace("{user}",(0,l.Yg)(a)),[t,s]=e.split("{link}"),r=o.thumbCustomEmojiId?n.Ay.createElement(Ar.A,{className:"Y0jTcadE",documentId:o.thumbCustomEmojiId}):void 0,i=n.Ay.createElement("span",{className:"FLzl2ng5",onClick:Z},r,(0,Tt.A)(o.title));return[(0,Tt.A)(t),i,(0,Tt.A)(s)]}return(0,Tt.A)(a?R("TelegramPremiumUserDialogTitle",(0,l.Yg)(a)):R(m?"TelegramPremiumSubscribedTitle":"TelegramPremium"),["simple_markdown","emoji"])}function se(){if(k){const e="starGiftUnique"!==k.type?k.perUserTotal:0;return F("DescriptionGiftPremiumRequired",{count:e})}return f?a?.id===t?R("TelegramPremiumUserGiftedPremiumOutboundDialogSubtitle",(0,l.Yg)(b)):R("TelegramPremiumUserGiftedPremiumDialogSubtitle"):R(o?"TelegramPremiumUserStatusDialogSubtitle":a?"TelegramPremiumUserDialogSubtitle":m?"TelegramPremiumSubscribedSubtitle":"TelegramPremiumSubtitle")}}));var Ei=a(24956),fi=a(31722);const bi="ItemPickerItem",Ci=(0,n.ph)(({className:e,isSearchable:t,searchInputId:a,items:s,filterValue:r,notFoundText:i,isLoading:l,noScrollRestore:c,filterPlaceholder:d,isViewOnly:m,itemInputType:u,itemClassName:A,withDefaultPadding:h,forceRenderAllItems:y,onFilterChange:p,onDisabledClick:g,onLoadMore:v,...E})=>{const f=(0,B.A)(),b=(0,n.li)(),C=E.allowMultiple,S=C?E.lockedSelectedValues:void 0,k=C?E.lockedUnselectedValues:void 0;(0,n.vJ)(()=>{if(!t)return;const e=window.setTimeout(()=>{(0,o.YS)(()=>{b.current?.focus()})},500);return()=>{window.clearTimeout(e)}},[t]);const w=(0,n.Kr)(()=>C?E.selectedValues:E.selectedValue?[E.selectedValue]:fa.p,[C,E.selectedValue,E.selectedValues]),N=(0,n.Kr)(()=>new Set(S),[S]),I=(0,n.Kr)(()=>new Set(k),[k]),P=(0,n.Kr)(()=>{if(r)return s.map(e=>e.value);const e=[],t=[],a=[];return s.forEach(n=>{N.has(n.value)?e.push(n):I.has(n.value)?a.push(n):t.push(n)}),e.concat(t,a).map(e=>e.value)},[r,s,N,I]),M=(0,x.A)(e=>{if(C){const t=w.slice(),a=t.indexOf(e);return a>=0?t.splice(a,1):t.push(e),void E.onSelectedValuesChange?.(t)}E.onSelectedValueChange?.(e)}),[T,L]=(0,Ln.A)(v,P,Boolean(y||r)),R=(0,x.A)(e=>{const{value:t}=e.currentTarget;p?.(t)}),F=(0,n.hb)(e=>{const t=s.find(t=>t.value===e);if(!t)return;const{label:a,subLabel:r,isLoading:i}=t,o=I.has(e),l=N.has(e),c=o||l,d=w.includes(e);return n.Ay.createElement(Un.A,{key:e,className:(0,ue.A)(bi,A),title:a,subtitle:r,disabled:c,inactive:m,ripple:!0,inputElement:c?n.Ay.createElement(Q.A,{name:"lock-badge"}):"radio"===u?n.Ay.createElement(Ei.A,{checked:d,disabled:c,isLoading:i,onlyInput:!0}):"checkbox"===u?n.Ay.createElement(as.A,{checked:d,disabled:c,isLoading:i,onlyInput:!0}):void 0,onClick:()=>M(e),onDisabledClick:g&&(()=>g(e,l))})},[s,I,N,w,m,g,u,A]);return n.Ay.createElement("div",{className:(0,ue.A)(fi.A.container,e)},t&&n.Ay.createElement("div",{className:(0,ue.A)(fi.A.header,"custom-scroll"),dir:f.isRtl?"rtl":void 0},n.Ay.createElement(Z.A,{id:a,ref:b,value:r,onChange:R,placeholder:d||f("Search")})),T?.length?n.Ay.createElement(fn.A,{className:(0,ue.A)(fi.A.pickerList,h&&fi.A.padded,"custom-scroll"),items:T,itemSelector:`.${bi}`,onLoadMore:L,noScrollRestore:c},T.map(e=>F(e))):l||!T||T.length?n.Ay.createElement(Dn.A,null):n.Ay.createElement("p",{className:fi.A.noResults},i||f("SearchEmptyViewTitle")))}),Si={root:"wzzA3MFh",pickerSelector:"xhujrq9i",pickerTitle:"YuRK4e7S",picker:"YF9nLkCK",footer:"ATCZ2Q5G"},ki=(0,n.ph)(({isOpen:e,onClose:t,onSubmit:a,countryList:r,selectionLimit:i})=>{const{showNotification:o}=(0,s.ko)(),l=(0,B.A)(),[c,d]=(0,n.J0)([]),m=(0,U.A)(c)===c,u=(0,n.Kr)(()=>r?r.filter(e=>!e.isHidden&&"FT"!==e.iso2).map(({iso2:e,defaultName:t})=>({value:e,label:t})):[],[r]),A=(0,x.A)(e=>{i&&e.length>i?o({message:l("BoostingSelectUpToWarningCountries",i)}):d(e)}),h=(0,x.A)(()=>{a(c),t()});return n.Ay.createElement(X.A,{className:Si.root,isOpen:e,onClose:t,onEnter:h},n.Ay.createElement("div",{className:Si.container},n.Ay.createElement("div",{className:Si.pickerSelector},n.Ay.createElement(Y.A,{round:!0,size:"smaller",color:"translucent",onClick:t},n.Ay.createElement(Q.A,{name:"close"})),n.Ay.createElement("h4",{className:Si.pickerTitle},l("BoostingSelectCountry")))),n.Ay.createElement("div",{className:(0,ue.A)(Si.main,"custom-scroll")},n.Ay.createElement(Ci,{className:Si.picker,items:u,selectedValues:c,onSelectedValuesChange:A,noScrollRestore:m,allowMultiple:!0,itemInputType:"checkbox"})),n.Ay.createElement("div",{className:Si.footer},n.Ay.createElement(Y.A,{size:"smaller",onClick:h},l("SelectCountries.OK"))))});var wi=a(1526),Ni=a(96530),Ii=a(11124),Pi=a(34642);const Mi=(0,n.ph)(({isOpen:e,giveawayChatId:t,selectionLimit:a,initialSelectedIds:r,onSelectedIdsConfirmed:i,onClose:o})=>{const{showNotification:c}=(0,s.ko)(),d=(0,B.A)(),[m,u]=(0,n.J0)(void 0),[A,h]=(0,n.J0)(""),[y,p,g]=(0,M.A)(),[v,E]=(0,n.J0)(r);(0,n.vJ)(()=>{E(r)},[r]);const f=(0,n.Kr)(()=>{const e=(0,s.mS)(),a=e.chats.byId,{active:n,archived:r}=e.chats.listIds,i=(n||[]).concat(r||[]);return(0,Ea.Am)(i).map(e=>a[e]).filter(e=>e&&((0,l.WX)(e)||(0,l.Vs)(e))&&e.id!==t).map(e=>e.id)},[t]),b=(0,n.Kr)(()=>{const e=f?(0,Mt.PU)({ids:f,query:A,type:"chat"}):[];return(0,xn.A)(e,!1,v)},[f,A,v]),C=(0,x.A)(e=>{const t=(0,s.mS)().chats.byId,n=e.filter(e=>!v.includes(e)).find(e=>{const a=t[e];return a&&!(0,l.gA)(a)});v?.length>=a?c({message:d("BoostingSelectUpToWarningChannelsPlural",a)}):n?(u(n),p()):E(e)}),S=(0,x.A)(()=>{m&&E((0,Ea.Am)([...v,m])),g()}),k=(0,x.A)(()=>{i(v),o()});return n.Ay.createElement(Pi.A,{isOpen:e,onClose:o,title:d("RequestPeer.ChooseChannelTitle"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0,confirmButtonText:d("Save"),onConfirm:k,onEnter:k},n.Ay.createElement(ba.A,{itemIds:b,selectedIds:v,filterValue:A,filterPlaceholder:d("Search"),onSelectedIdsChange:C,onFilterChange:h,isSearchable:!0,withDefaultPadding:!0,withStatus:!0,allowMultiple:!0,itemInputType:"checkbox"}),n.Ay.createElement(ya.A,{title:d("BoostingGiveawayPrivateChannel"),text:d("BoostingGiveawayPrivateChannelWarning"),confirmLabel:d("Add"),isOpen:y,onClose:g,confirmHandler:S}))}),Ti=(0,n.ph)(({option:e,checked:t,name:a,text:s,img:r,isLink:i,onChange:o,onClickAction:l,className:c,userNames:d,selectedMemberIds:m})=>{const u=(0,B.A)();let A=u(s);i&&m?.length&&(A=m.length>2?m.length.toString():d);const h=(0,x.A)(t=>{t.target.checked&&o(e)}),y=(0,x.A)(()=>{l?.()});return n.Ay.createElement("label",{className:(0,ue.A)("w3OGYFKn",c),dir:u.isRtl?"rtl":void 0,role:"button",tabIndex:0},n.Ay.createElement("input",{className:"xy4AclZa",type:"radio",name:"giveaway_option",value:e,checked:t,onChange:h,onClick:e=>e.stopPropagation()}),n.Ay.createElement("div",{className:"TTgSI7Xh"},n.Ay.createElement("img",{className:"lGhZJbMF",src:r,alt:"",draggable:!1}),n.Ay.createElement("div",{className:"sEt7TF59"},n.Ay.createElement("h3",{className:"u4NzVBBi"},u(a)),i?n.Ay.createElement("div",{className:"y7XfPOoG",onClick:y},n.Ay.createElement("span",null,A),n.Ay.createElement(Q.A,{name:"next"})):n.Ay.createElement("span",{className:"kt2ZKZ6j"},A))))}),xi=(0,n.ph)((0,s.EK)((e,{giveawayChatId:t})=>{const a=t?(0,c.AWZ)(e,t):void 0;return a?{members:a.members,adminMembersById:a.adminMembersById}:{}})(({isOpen:e,selectionLimit:t,members:a,adminMembersById:r,initialSelectedIds:i,onSelectedIdsConfirmed:o,onClose:c})=>{const{showNotification:d}=(0,s.ko)(),m=(0,B.A)(),[u,A]=(0,n.J0)(""),[h,y]=(0,n.J0)(i);(0,n.vJ)(()=>{y(i)},[i]);const p=(0,n.Kr)(()=>{const e=(0,s.mS)(),{byId:t,statusesById:n}=e.users;if(!a?.length)return[];const i=r&&new Set(Object.keys(r)),o=(0,l.UB)(a.map(({userId:e})=>e),t,n);return i?o.filter(e=>!i.has(e)):o},[r,a]),g=(0,n.Kr)(()=>{const e=(0,s.mS)().users.byId,t=p?(0,Mt.PU)({ids:p,query:u,type:"user"}):[];return(0,xn.A)((0,Ea.Am)(t).filter(t=>{const a=e[t];return!a||!(0,l.tv)(a)}))},[p,u]),v=(0,x.A)(e=>{e.length>t?d({message:m("BoostingSelectUpToWarningUsers",t)}):y(e)}),E=(0,x.A)(()=>{o(h),c()});return n.Ay.createElement(Pi.A,{isOpen:e,onClose:c,title:m("BoostingAwardSpecificUsers"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0,confirmButtonText:m("Save"),onConfirm:E,onEnter:E},n.Ay.createElement(ba.A,{itemIds:g,selectedIds:h,filterValue:u,filterPlaceholder:m("Search"),onSelectedIdsChange:v,onFilterChange:A,isSearchable:!0,withDefaultPadding:!0,withStatus:!0,allowMultiple:!0,itemInputType:"checkbox"}))})),Bi="rZRDMqUL",Li="JjDLNrKG",Ri="p5Hn4Q6E",Fi="rniPcuiP",Di="G9H3tm6D",Vi="xKl2UeV8",_i="HLx3wTBD",Ui="Ftr7zf2v",Oi="Ce0Ob2tg",Ji="rDFQAfTt",Ki="LZ3vPzak",Gi="Z9QJQ6IS",ji="ldn4mh2T";var zi=a(72078),Hi=a(68153),$i=a(65741),qi=a(45318);const Wi=a.p+"PremiumStar.39c1ff364d35554f4b80.svg",Qi={3:Hi,6:zi,12:$i},Yi=(0,n.ph)((0,s.EK)(e=>{const{giveawayModal:t}=(0,c.nTw)(e),a=t?.chatId,n=a?(0,c.hds)(e,a):void 0,s=n&&(0,l.WX)(n);return{chatId:a,gifts:t?.gifts,selectedMemberList:t?.selectedMemberIds,selectedChannelList:t?.selectedChannelIds,giveawayBoostPerPremiumLimit:e.appConfig?.giveawayBoostsPerPremium,isStarsGiftEnabled:e.appConfig?.isStarsGiftEnabled,userSelectionLimit:e.appConfig?.giveawayAddPeersMax,countrySelectionLimit:e.appConfig?.giveawayCountriesMax,countryList:e.countryList.general,prepaidGiveaway:t?.prepaidGiveaway,isChannel:s,starsGiftOptions:t?.starOptions}})(({chatId:e,gifts:t,isOpen:a,isChannel:r,selectedMemberList:o,selectedChannelList:c,giveawayBoostPerPremiumLimit:d=i.CQG,countryList:m,prepaidGiveaway:u,countrySelectionLimit:A=i.y67,userSelectionLimit:h=i.qbC,isStarsGiftEnabled:y,starsGiftOptions:p})=>{const g=(0,n.li)(),{closeGiveawayModal:v,openInvoice:E,openPremiumModal:f,launchPrepaidGiveaway:b,launchPrepaidStarsGiveaway:C}=(0,s.ko)(),S=(0,B.A)(),[k,w,N]=(0,M.A)(),[I,P,T]=(0,M.A)(),[L,R,F]=(0,M.A)(),[D,V,_]=(0,M.A)(),[U,O,J]=(0,M.A)(),K=[{name:"Premium.Title",text:"BoostingWinnersRandomly",value:"premium_giveaway",img:zi,actions:"createPremiumGiveaway",isLink:!0,onClickAction:()=>{V()}}];y&&K.push({name:"TelegramStars",text:"BoostingWinnersRandomly",value:"stars_giveaway",img:qi,actions:"createStarsGiveaway",isLink:!1});const[G,j]=(0,n.J0)(Date.now()+2592e5),[z,H]=(0,n.J0)(!0),[$,q]=(0,n.J0)(5),[W,te]=(0,n.J0)(K[0].value),[ae,ne]=(0,n.J0)(),[se,re]=(0,n.J0)("all"),[ie,oe]=(0,n.J0)(),[le,ce]=(0,n.J0)([]),[de,me]=(0,n.J0)([]),[Ae,he]=(0,n.J0)([]),[ye,pe]=(0,n.J0)(!1),[ge,ve]=(0,n.J0)(!1),[Ee,fe]=(0,n.J0)(void 0),[be,Ce]=(0,n.J0)(void 0),[Se,ke]=(0,n.J0)(void 0),we="premium_giveaway"===W,Ne="stars_giveaway"===W,Ie=we&&!le.length?$:le.length,Pe=Ie*d,Me=ae?.yearlyBoosts,Te=(0,n.Kr)(()=>[{value:"all",label:S(r?"BoostingAllSubscribers":"BoostingAllMembers"),subLabel:Ae&&Ae.length>0?S("Giveaway.ReceiverType.Countries",Ae.length):S("BoostingFromAllCountries")},{value:"new",label:S(r?"BoostingNewSubscribers":"BoostingNewMembers"),subLabel:Ae&&Ae.length>0?S("Giveaway.ReceiverType.Countries",Ae.length):S("BoostingFromAllCountries")}],[r,S,Ae]),xe=S("Months",ie),Be="starsGiveaway"===u?.type,Le="giveaway"===u?.type,Re=(0,n.Kr)(()=>t?.find(e=>e.months===ie&&e.users===Ie),[t,ie,Ie]),Fe=(0,n.Kr)(()=>p?.find(e=>Be&&e.stars===Se?.stars),[Se,p,Be]),De=(0,n.Kr)(()=>t?.filter(e=>e.users===Ie&&e.currency!==i.OUy),[t,Ie]),Ve=(0,n.Kr)(()=>{const e=De?.reduce((e,t)=>t.amount<e.amount?t:e,De[0]);return e&&Math.floor(e.amount/e.months)},[De]),_e=(0,n.Kr)(()=>(0,Ea.Am)(t?.filter(e=>e.currency!==i.OUy)?.map(e=>e.users)||[]).sort((e,t)=>e-t),[t]),Ue=(0,n.Kr)(()=>(0,Ea.Am)(ae?.winners?.map(e=>e.users)||[]).sort((e,t)=>e-t),[ae]);(0,n.vJ)(()=>{a&&t?.length&&!Be&&oe(t?.[0].months)},[a,t,Be]),(0,n.vJ)(()=>{a&&p?.length&&!Le&&ne(p?.[0])},[a,p,Le]),(0,n.vJ)(()=>{a&&Be&&(q(u.quantity),ke(u))},[a,Be,u]),(0,n.vJ)(()=>{a&&Le&&(q(u.quantity),Ce(u),oe(u.months))},[a,Le,u]),(0,n.vJ)(()=>{o&&ce(o)},[o]),(0,n.vJ)(()=>{c&&me(c)},[c]);const Oe=(0,x.A)(()=>{f()}),Je=(0,x.A)(()=>{ke(void 0),Ce(void 0),ne(void 0),oe(void 0),q(5),v()}),Ke=(0,x.A)(()=>{E(we?le?.length?{type:"giftcode",boostChannelId:e,userIds:le,currency:Re.currency,amount:Re.amount,option:Re}:{type:"giveaway",chatId:e,additionalChannelIds:de,isOnlyForNewSubscribers:"new"===se,countries:Ae,areWinnersVisible:ye,prizeDescription:Ee,untilDate:G/1e3,currency:Re.currency,amount:Re.amount,option:Re}:{type:"starsgiveaway",chatId:e,additionalChannelIds:de,isOnlyForNewSubscribers:"new"===se,countries:Ae,areWinnersVisible:ye,prizeDescription:Ee,untilDate:G/1e3,currency:ae.currency,amount:ae.amount,stars:ae.stars,users:$}),Je()}),Ge=(0,x.A)(()=>{Be?C({chatId:e,giveawayId:Se.id,paymentPurpose:{additionalChannelIds:de,countries:Ae,prizeDescription:Ee,areWinnersVisible:ye,untilDate:G/1e3,stars:Se.stars,currency:Fe.currency,amount:Fe.amount,users:Se.quantity}}):b({chatId:e,giveawayId:be.id,paymentPurpose:{additionalChannelIds:de,countries:Ae,prizeDescription:Ee,areWinnersVisible:ye,untilDate:G/1e3,currency:Re.currency,amount:Re.amount}}),F(),Je()}),je=(0,x.A)(e=>{q(e)}),ze=(0,x.A)(e=>{q(e)}),He=(0,x.A)(e=>{fe(e.target.value)}),qe=(0,n.Kr)(()=>{const e=(0,s.mS)().users.byId;return le?.map(t=>(0,l.Yg)(e[t])).join(", ")},[le]),We=(0,x.A)(e=>{re(e)}),Qe=(0,x.A)(e=>{te(e),ce([]),q(5)}),Ye=(0,x.A)(e=>{j(e.getTime()),N()}),Ze=(0,x.A)(e=>{he(e)}),Xe=(0,x.A)(e=>{ce(e),e.length||te("premium_giveaway")}),et=(0,x.A)(e=>{me(e)}),tt=(0,x.A)(e=>{pe(e.target.checked)}),at=(0,x.A)(e=>{ve(e.target.checked)}),nt=(0,x.A)(()=>{P()}),st=(0,x.A)(e=>{ne(e)});function rt(){return n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:Bi},n.Ay.createElement("h2",{className:Ri},S("BoostingChannelsGroupsIncludedGiveaway")),n.Ay.createElement(ca.A,{inactive:!0,className:"chat-item-clickable contact-list-item"},n.Ay.createElement(Sn.A,{chatId:e,status:S(r?"BoostingChannelWillReceiveBoost":"BoostingGroupWillReceiveBoost",Pe||Me,"i")})),de?.map(e=>n.Ay.createElement(ca.A,{ripple:!0,key:e,className:"chat-item-clickable contact-list-item",onClick:()=>function(e){const t=de.filter(t=>t!==e);me(t)}(e),rightElement:n.Ay.createElement(Q.A,{name:"close",className:"UZdErfVI"})},n.Ay.createElement(Sn.A,{chatId:e.toString()}))),de.length<9&&n.Ay.createElement(ca.A,{icon:"add",ripple:!0,onClick:O,className:"sOXvh85b",iconClassName:"aGbyR60s"},S("BoostingAddChannelOrGroup"))),n.Ay.createElement("div",{className:Bi},n.Ay.createElement("h2",{className:Ri},S("BoostingEligibleUsers")),n.Ay.createElement("div",{className:Li},n.Ay.createElement(ee.A,{name:"subscribers",options:Te,selected:se,onChange:We,onClickAction:nt,subLabelClassName:"txXJxVFu",isLink:!0}))),n.Ay.createElement("div",{className:Fi},(0,Tt.A)(S(r?"BoostGift.LimitSubscribersInfo":"lng_giveaway_users_about_group"))),n.Ay.createElement("div",{className:Bi},n.Ay.createElement("div",{className:Gi},n.Ay.createElement("h2",{className:Ki},S("BoostingGiveawayAdditionalPrizes")),n.Ay.createElement(va.A,{label:S("BoostingGiveawayAdditionalPrizes"),checked:ge,onChange:at})),ge&&n.Ay.createElement("div",{className:"eQVP0Nx8"},n.Ay.createElement("h2",{className:Ki},$),n.Ay.createElement(Z.A,{className:"qMYNwiUZ",value:Ee,onChange:He,label:S("BoostingGiveawayEnterYourPrize")}))),ge?Ne||Be?void 0:n.Ay.createElement("div",{className:Fi},Ee?.length?(0,Tt.A)(S("BoostingGiveawayAdditionPrizeCountNameHint",be?[be.quantity,Ee,xe]:[Ie,Ee,xe],void 0,ie),["simple_markdown"]):(0,Tt.A)(S("BoostingGiveawayAdditionPrizeCountHint",be?[be.quantity,xe]:[Ie,xe],void 0,ie),["simple_markdown"])):n.Ay.createElement("div",{className:Fi},(0,Tt.A)(S("BoostingGiveawayAdditionPrizeHint"))),n.Ay.createElement("div",{className:Bi},n.Ay.createElement("div",{className:Gi},n.Ay.createElement("h2",{className:Ki},S("BoostingGiveawayShowWinners")),n.Ay.createElement(va.A,{label:S("BoostingGiveawayAdditionalPrizes"),checked:ye,onChange:tt}))),n.Ay.createElement("div",{className:Fi},(0,Tt.A)(S("BoostingGiveawayShowWinnersHint"))),n.Ay.createElement("div",{className:(0,ue.A)(Bi,(be||Se||Ne)&&Ji)},n.Ay.createElement("h2",{className:Ri},S("BoostingDateWhenGiveawayEnds")),n.Ay.createElement(Y.A,{ariaLabel:S("BoostGift.DateEnds"),className:(0,ue.A)("GeKqKRgP","expire-limit"),isText:!0,onClick:w},n.Ay.createElement("h3",{className:Ki},S("BoostGift.DateEnds")),(0,$e.L2)(G,S.code))))}return n.Ay.createElement(X.A,{className:"P0kLOw15",onClose:Je,isOpen:a,dialogRef:g,onEnter:be||Se?R:Ke},n.Ay.createElement("div",{className:(0,ue.A)("SqiN63Ef","custom-scroll"),onScroll:function(e){const{scrollTop:t}=e.currentTarget;H(t<=150)}},n.Ay.createElement(Y.A,{round:!0,size:"smaller",className:"OX6_HqAd",color:"translucent",onClick:Je,ariaLabel:S("Close")},n.Ay.createElement(Q.A,{name:"close"})),n.Ay.createElement("img",{className:"Me2hCsMs",src:Wi,alt:"",draggable:!1}),n.Ay.createElement("h2",{className:"UVDnB0Wq"},(0,Tt.A)(S("BoostingBoostsViaGifts"))),n.Ay.createElement("div",{className:"v5yGzV6v"},(0,Tt.A)(S(r?"BoostingGetMoreBoost":"BoostingGetMoreBoostsGroup"))),n.Ay.createElement("div",{className:(0,ue.A)("U6XNIToQ",z&&"tDZc21ZC")},n.Ay.createElement("h2",{className:"v6hiGpEn"},S("BoostingBoostsViaGifts"))),be||Se?n.Ay.createElement("div",{className:"q1y2qUTn"},n.Ay.createElement("div",null,Se?n.Ay.createElement("img",{className:ji,src:qi,alt:""}):n.Ay.createElement("img",{className:ji,src:Qi[be.months]||Qi[3],alt:""})),n.Ay.createElement("div",{className:"IsT38nlq"},n.Ay.createElement("h3",{className:Ki},Se?S("Giveaway.Stars.Prepaid.Title",Se?.stars):S("BoostingTelegramPremiumCountPlural",be.quantity)),n.Ay.createElement("p",{className:"TsGuei3B"},Se?S("Giveaway.Stars.Prepaid.Desc",Se?.quantity):S("PrepaidGiveawayMonths",be?.months))),n.Ay.createElement("div",{className:Di},n.Ay.createElement("div",{className:(0,ue.A)(Vi,_i)},n.Ay.createElement(Q.A,{name:"boost",className:Ui}),n.Ay.createElement("div",{className:Oi,dir:S.isRtl?"rtl":void 0},Se?Se?.boosts:be.quantity*(d??i.CQG))))):n.Ay.createElement("div",{className:(0,ue.A)(Bi,"sQ5PkKEs")},n.Ay.createElement("div",{className:Li},K.map(e=>n.Ay.createElement(Ti,{key:e.name,name:e.name,text:e.text,option:e.value,img:e.img,onChange:Qe,checked:W===e.value,isLink:e.isLink,userNames:qe,selectedMemberIds:le,onClickAction:e.onClickAction})))),we&&!le?.length&&n.Ay.createElement(n.Ay.Fragment,null,!be&&!Se&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:Bi},n.Ay.createElement("div",{className:Di},n.Ay.createElement("h2",{className:Ri},S("BoostingQuantityPrizes")),n.Ay.createElement("div",{className:(0,ue.A)(Vi,_i)},n.Ay.createElement(Q.A,{name:"boost",className:Ui}),n.Ay.createElement("div",{className:Oi,dir:S.isRtl?"rtl":void 0},Pe))),n.Ay.createElement(Ii.A,{rangeCount:Ie,marks:_e,onChange:je})),n.Ay.createElement("div",{className:Fi},(0,Tt.A)(S("BoostingChooseHowMany")))),rt()),Ne&&n.Ay.createElement(n.Ay.Fragment,null,!Se&&!be&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:Bi},n.Ay.createElement("div",{className:Di},n.Ay.createElement("h2",{className:Ri},S("BoostingStarsOptions")),n.Ay.createElement("div",{className:(0,ue.A)(Vi,_i)},n.Ay.createElement(Q.A,{name:"boost",className:Ui}),n.Ay.createElement("div",{className:Oi,dir:S.isRtl?"rtl":void 0},Me))),n.Ay.createElement(wi.A,{className:"cLhNkYPB",options:p,selectedStarCount:$,selectedStarOption:ae,onClick:st})),n.Ay.createElement("div",{className:(0,ue.A)(Fi,"bzRAETfR")},(0,Tt.A)(S("BoostGift.Stars.Info"))),n.Ay.createElement("div",{className:Bi},n.Ay.createElement("h2",{className:Ri},S("BoostingStarsQuantityPrizes")),n.Ay.createElement(Ii.A,{rangeCount:$,marks:Ue,onChange:ze}),n.Ay.createElement("div",{className:Fi},(0,Tt.A)(S("BoostingStarsQuantityPrizesInfo"))))),rt()),!be&&!Se&&we&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:Bi},n.Ay.createElement("h2",{className:Ri},S("BoostingDurationOfPremium")),n.Ay.createElement("div",{className:Li},De?.map(e=>n.Ay.createElement(Yr,{isGiveaway:!0,key:e.months,option:e,fullMonthlyAmount:Ve,checked:e.months===ie,onChange:oe})))),n.Ay.createElement("div",{className:(0,ue.A)(Fi,Ji)},function(){const e=S("GiftPremiumListFeaturesAndTerms").match(/([^*]*)\*([^*]+)\*(.*)/);if(e&&!(e.length<4))return n.Ay.createElement("p",{className:"eNQ_nrKr"},e[1],n.Ay.createElement(Ni.A,{isPrimary:!0,onClick:Oe},e[2]),e[3])}())),W&&n.Ay.createElement("div",{className:"hD_AEzjd"},n.Ay.createElement(Y.A,{className:"ILuhBsJG",onClick:be||Se?R:Ke},S("BoostingStartGiveaway")))),n.Ay.createElement(cs,{isOpen:k,isFutureMode:!0,withTimePicker:!0,onClose:N,onSubmit:Ye,selectedAt:G,submitButtonLabel:S("Save")}),n.Ay.createElement(ki,{isOpen:I,onClose:T,countryList:m,onSubmit:Ze,selectionLimit:A}),n.Ay.createElement(xi,{isOpen:D,onClose:_,onSelectedIdsConfirmed:Xe,initialSelectedIds:le,selectionLimit:h,giveawayChatId:e}),n.Ay.createElement(Mi,{isOpen:U,onClose:J,initialSelectedIds:de,onSelectedIdsConfirmed:et,selectionLimit:i.cgU,giveawayChatId:e}),n.Ay.createElement(ya.A,{title:S("BoostingStartGiveawayConfirmTitle"),text:S("BoostingStartGiveawayConfirmText"),confirmLabel:S("Start"),isOpen:L,onClose:F,confirmHandler:Ge}))})),Zi={dialogFiltersChats:"LimitReachedChatInFolders",uploadMaxFileparts:"LimitReachedFileSize",dialogFilters:"LimitReachedFolders",dialogFolderPinned:"LimitReachedPinDialogs",channelsPublic:"LimitReachedPublicLinks",channels:"LimitReachedCommunities",chatlistInvites:"LimitReachedFolderLinks",chatlistJoined:"LimitReachedSharedFolders",savedDialogsPinned:"LimitReachedPinSavedDialogs"},Xi={dialogFiltersChats:"LimitReachedChatInFoldersLocked",uploadMaxFileparts:"LimitReachedFileSizeLocked",dialogFilters:"LimitReachedFoldersLocked",dialogFolderPinned:"LimitReachedPinDialogsLocked",channelsPublic:"LimitReachedPublicLinksLocked",channels:"LimitReachedCommunitiesLocked",chatlistInvites:"LimitReachedFolderLinksLocked",chatlistJoined:"LimitReachedSharedFoldersLocked",savedDialogsPinned:"LimitReachedPinSavedDialogsLocked"},eo={dialogFiltersChats:"LimitReachedChatInFoldersPremium",uploadMaxFileparts:"LimitReachedFileSizePremium",dialogFilters:"LimitReachedFoldersPremium",dialogFolderPinned:"LimitReachedPinDialogsPremium",channelsPublic:"LimitReachedPublicLinksPremium",channels:"LimitReachedCommunitiesPremium",chatlistInvites:"LimitReachedFolderLinksPremium",chatlistJoined:"LimitReachedSharedFoldersPremium",savedDialogsPinned:"LimitReachedPinSavedDialogsPremium"},to={dialogFiltersChats:"chat-badge",uploadMaxFileparts:"file-badge",dialogFilters:"folder-badge",dialogFolderPinned:"pin-badge",channelsPublic:"link-badge",channels:"chats-badge",chatlistInvites:"link-badge",chatlistJoined:"folder-badge",savedDialogsPinned:"pin-badge"},ao={uploadMaxFileparts:(e,t)=>8e3===t?e("FileSize.GB","4"):4e3===t?e("FileSize.GB","2"):(0,qe.v7)(e,t*i.dK5)},no=(0,n.ph)((0,s.EK)((e,{limit:t})=>{const{limits:a}=e.appConfig||{},n=(0,c.g29)(e);return{defaultValue:t?a?.[t][0]:void 0,premiumValue:t?a?.[t][1]:void 0,canBuyPremium:!(0,c.n_C)(e),isPremium:n}})(({defaultValue:e,premiumValue:t,limit:a,isPremium:r,canBuyPremium:i})=>{const{closeLimitReachedModal:o,openPremiumModal:l}=(0,s.ko)(),c=(0,B.A)(),[d,m,u]=(0,M.A)(),A=(0,n.hb)(()=>{l(),m()},[l,m]);(0,n.vJ)(()=>{!a&&d&&u()},[d,a,u]);const h=c("LimitReached"),y=a&&ao[a],p=function({lang:e,limitType:t,isPremium:a,canBuyPremium:n,defaultValue:s,premiumValue:r,valueFormatter:i}){if(!t)return;const o=i?i(e,s):s,l=i?i(e,r):r;return a?e(eo[t],l):n?e(Zi[t],"channelsPublic"===t?l:[o,l]):e(Xi[t],o)}({lang:c,limitType:a,isPremium:r,canBuyPremium:i,defaultValue:e,premiumValue:t,valueFormatter:y}),g=a&&to[a],v=i&&!r;return n.Ay.createElement(X.A,{onClose:m,onCloseAnimationEnd:o,isOpen:Boolean(a)&&!d,title:h,className:"QAs_iFxO"},!v&&n.Ay.createElement("div",{className:"Q5d_7bB4"},n.Ay.createElement("i",{className:(0,ue.A)("rbnU7JVX",g,"icon")}),n.Ay.createElement("div",{className:"ArEy3hhB"},y?.(c,r?t:e)||(r?t:e))),v&&n.Ay.createElement(Sr,{className:"k0O6Rnjh",leftValue:y?.(c,e)||e?.toString(),rightValue:y?.(c,t)||t?.toString(),floatingBadgeIcon:g}),n.Ay.createElement("div",null,(0,Tt.A)(p||"",["simple_markdown","br"])),n.Ay.createElement("div",{className:"RVM_RSap"},n.Ay.createElement(Y.A,{className:"confirm-dialog-button",isText:!0,onClick:m,color:"primary"},c(v?"Cancel":"OK")),v&&n.Ay.createElement(Y.A,{className:"confirm-dialog-button",isText:!0,onClick:A,color:"primary"},c("IncreaseLimit"),n.Ay.createElement(Q.A,{name:"double-badge",className:"esB1OhAF"}))))}));var so=a(93809),ro=a(81954),io=a(5912);const oo=350+i.xB5,lo=.5*h.$;function co(e,t,a,s){const r=(0,n.li)([]),[i,o]=(0,n.J0)(0),{observe:l,freeze:c,unfreeze:d}=(0,io.BL)({rootRef:e},e=>{const t=r.current;e.forEach(e=>{const n=Number(e.target.id.replace(`${a}-`,""));t[n]=e.isIntersecting});const n=t.reduce((e,t,a)=>t&&a<e?a:e,1/0);n!==1/0&&o(n)}),{observe:m,freeze:u,unfreeze:A}=(0,io.BL)({rootRef:e,throttleMs:200,margin:100}),{observe:h}=(0,io.BL)({rootRef:e,throttleMs:200,margin:100}),{observe:y}=(0,io.BL)({rootRef:t});return(0,z.A)(()=>{s?(c(),u()):setTimeout(()=>{A(),d()},oo)},[c,u,s,d,A]),{activeSetIndex:i,observeIntersectionForSet:l,observeIntersectionForShowingItems:m,observeIntersectionForPlayingItems:h,observeIntersectionForCovers:y,selectStickerSet:(0,x.A)(t=>{o(n=>{const s=document.getElementById(`${a}-${t}`),r=1===Math.abs(n-t);return(0,ro.Ay)({container:e.current,element:s,position:"start",margin:lo,maxDistance:r?200:80}),t})})}}var mo=a(37479),uo=a(87094),Ao=a(94519),ho=a(47483);const yo=(0,n.ph)(({stickerSet:e,size:t=i.TBj,noPlay:a,forcePlayback:r,observeIntersection:o,sharedCanvasRef:d})=>{const{loadStickers:m}=(0,s.ko)(),u=(0,n.li)(),{hasThumbnail:A,hasVideoThumb:h,hasAnimatedThumb:y,hasStaticThumb:p,thumbCustomEmojiId:g}=e,{customEmoji:v}=(0,ho.A)(g),f=v?.shouldUseTextColor,b=(0,uo.A)(u,void 0,!f),C=(0,mo.A)(b),S=(0,io.Vz)(u,o),k=S&&!a,w=!A||h&&!E.OF&&!y&&!p,N=w&&e.stickers?.[0]&&(0,l.Mw)(e.stickers[0],"preview"),I=(0,H.A)(N,!S),P=(A&&!N||y)&&`stickerSet${e.id}`,M=(0,H.A)(P,!S),T=g||M||I,x=(0,Ja.A)(T),B=(0,Ao.A)(u,d);return(0,n.vJ)(()=>{S&&!e.stickers?.length&&m({stickerSetInfo:e})},[S,m,e]),n.Ay.createElement("div",{ref:u,className:(0,ue.A)("m6XpTzQX","sticker-set-cover"),style:`--_size: ${t}px`},T?g?n.Ay.createElement(Ar.A,{documentId:g,size:t,observeIntersectionForPlaying:o,noPlay:a}):y?n.Ay.createElement(Pr.A,{className:x,tgsUrl:M,size:t,play:k,isLowPriority:!(0,c.CzR)((0,s.mS)(),e),sharedCanvas:d?.current||void 0,sharedCanvasCoords:B,forceAlways:r}):h&&!w?n.Ay.createElement(Ha.A,{className:(0,ue.A)("OZHqKbDL",x),src:M,canPlay:k,style:C,isPriority:r,loop:!0,disablePictureInPicture:!0}):n.Ay.createElement("img",{src:M||I,style:C,className:(0,ue.A)("enA6c8gc",x),alt:"",draggable:!1}):(0,qe.Qh)(e.title,2))});var po=a(54464),go=a(85118),vo=a(82855);const Eo=[{title:"SetTimeoutFor.Hours",value:1,arg:3600},{title:"SetTimeoutFor.Hours",value:2,arg:7200},{title:"SetTimeoutFor.Hours",value:8,arg:28800},{title:"SetTimeoutFor.Days",value:1,arg:86400},{title:"SetTimeoutFor.Days",value:2,arg:172800}],fo=(0,n.ph)(({sticker:e,size:t,noPlay:a,title:r,className:i,noContextMenu:o,isSavedMessages:l,isStatusPicker:c,canViewSet:d,observeIntersection:m,observeIntersectionForShowing:u,isSelected:A,isCurrentUserPremium:h,shouldIgnorePremium:y,noShowPremium:p,sharedCanvasRef:g,withTranslucentThumb:v,forcePlayback:f,onClick:b,clickArg:C,onFaveClick:S,onUnfaveClick:k,onRemoveRecentClick:w,onContextMenuOpen:N,onContextMenuClose:I,onContextMenuClick:P,isEffectEmoji:M,withSparkles:T})=>{const{openStickerSet:L,openPremiumModal:R,setEmojiStatus:F}=(0,s.ko)(),D=(0,n.li)(),V=(0,n.li)(),_=(0,B.A)(),U=e.shouldUseTextColor,O=(0,uo.A)(D,void 0,!U),{id:J,stickerSetInfo:K}=e,G=!e.isFree&&M||e.hasEffect,j=e.isCustomEmoji||M,z=!h&&G&&!y,H=(0,io.Vz)(D,m),$=H,q=H&&!a,W=(0,io.Vz)(D,u),{isContextMenuOpen:Z,contextMenuAnchor:X,handleBeforeContextMenu:ee,handleContextMenu:te,handleContextMenuClose:ae,handleContextMenuHide:ne}=(0,vs.A)(D),se=Boolean(!o&&X),re=(0,x.A)(()=>D.current),ie=(0,x.A)(()=>D.current.closest(".custom-scroll, .no-scrollbar")),oe=(0,x.A)(()=>c?V.current:D.current.querySelector(".sticker-context-menu .bubble")),le=(0,x.A)(()=>({withPortal:c,shouldAvoidNegativePosition:!0}));(0,n.vJ)(()=>{Z?N?.():I?.()},[Z,I,N]),(0,n.vJ)(()=>{H||ae()},[ae,H]);const de=(0,x.A)(t=>{t.stopPropagation(),t.preventDefault(),w(e)}),me=(0,x.A)(()=>{w(e)}),Ae=(0,x.A)(()=>{k(e)}),he=(0,x.A)(()=>{S(e)}),ye=(0,x.A)(()=>{b?.(C,!0)}),pe=(0,x.A)(()=>{b?.(C,void 0,!0)}),ge=(0,x.A)(()=>{L({stickerSetInfo:K})}),ve=(0,x.A)((t,a=0)=>{t.preventDefault(),t.stopPropagation(),ae(),P?.(),F({emojiStatus:{type:"regular",documentId:e.id,until:(0,la.Fm)()+a}})}),Ee=!E.TF&&w,fe=(0,ue.A)("StickerButton",b&&"interactive",A&&"selected",j&&"custom-emoji",M&&"effect-emoji",i),be=(0,n.Kr)(()=>{if(!se||o||j&&!c)return[];const e=[];return j?(Eo.forEach(t=>{e.push(n.Ay.createElement(ce.A,{onClick:ve,clickArg:t.arg},_(t.title,t.value,"i")))}),e):(k&&e.push(n.Ay.createElement(ce.A,{icon:"favorite",onClick:Ae},_("Stickers.RemoveFromFavorites"))),S&&e.push(n.Ay.createElement(ce.A,{icon:"favorite",onClick:he},_("Stickers.AddToFavorites"))),!z&&b&&(l||e.push(n.Ay.createElement(ce.A,{onClick:ye,icon:"muted"},_("SendWithoutSound"))),e.push(n.Ay.createElement(ce.A,{onClick:pe,icon:"calendar"},_(l?"SetReminder":"ScheduleMessage")))),d&&e.push(n.Ay.createElement(ce.A,{onClick:ge,icon:"stickers"},_("ViewPackPreview"))),w&&e.push(n.Ay.createElement(ce.A,{icon:"delete",onClick:me},_("DeleteFromRecent"))),e)},[se,o,j,c,k,S,z,b,d,w,ve,_,Ae,he,l,pe,ye,ge,me]);return n.Ay.createElement("div",{ref:D,className:fe,title:r||e?.emoji,"data-sticker-id":J,onMouseDown:e=>{(0,po.u)(e),ee(e)},onClick:()=>{Z||(z?R(M?{initialSection:"effects"}:{initialSection:"premium_stickers"}):b?.(C))},onContextMenu:te},T&&n.Ay.createElement(go.A,{preset:"button"}),W&&n.Ay.createElement(vo.A,{containerRef:D,sticker:e,isSmall:!0,size:t,shouldLoop:!0,shouldPreloadPreview:!0,noLoad:!$,noPlay:!q,noVideoOnMobile:!0,withSharedAnimation:!0,sharedCanvasRef:g,withTranslucentThumb:v,customColor:O,forceAlways:f}),!p&&z&&n.Ay.createElement("div",{className:"sticker-locked"},n.Ay.createElement(Q.A,{name:"lock-badge"})),!p&&G&&!z&&n.Ay.createElement("div",{className:"sticker-premium"},n.Ay.createElement(Q.A,{name:"star"})),Ee&&n.Ay.createElement(Y.A,{className:"sticker-remove-button",color:"dark",round:!0,noFastClick:!0,onClick:de},n.Ay.createElement(Q.A,{name:"close"})),Boolean(be.length)&&n.Ay.createElement(We.A,{ref:V,isOpen:Z,anchor:X,getTriggerElement:re,getRootElement:ie,getMenuElement:oe,getLayout:le,className:"sticker-context-menu",autoClose:!0,withPortal:c,onClose:ae,onCloseAnimationEnd:ne},be))});var bo=a(93545),Co=a(58443),So=a(64489);const ko=(0,n.ph)(({reaction:e,availableReactions:t,isSelected:a,loadAndPlay:s,observeIntersection:r,sharedCanvasRef:o,sharedCanvasHqRef:c,forcePlayback:d,onClick:m,onContextMenu:u})=>{const A=(0,n.li)(),h="custom"===e.type,y=(0,n.Kr)(()=>t?.find(t=>(0,l.a0)(t.reaction,e)),[t,e]),p=y?.staticIcon?.thumbnail?.dataUri,g=y?.selectAnimation?.id,v=(0,Ao.A)(A,o),E=(0,H.A)(y?.selectAnimation?(0,l.mr)(y.selectAnimation,"full"):void 0,!g),{isContextMenuOpen:f,handleBeforeContextMenu:b,handleContextMenu:C,handleContextMenuClose:S,handleContextMenuHide:k}=(0,vs.A)(A,"paid"!==e.type,void 0,void 0,void 0,!0);(0,n.vJ)(()=>{f&&(u?.(e),S(),k())},[S,u,k,f,e]);const w="paid"===e.type?Co.w.StarReaction:E,N=(0,x.A)(()=>{m(e)}),I=(0,Ja.A)(E),P=(0,ue.A)("AVrrYEbM",a&&"QkdO_lz1",!h&&"sticker-reaction");return n.Ay.createElement("div",{ref:A,className:P,onClick:N,title:y?.title,"data-sticker-id":h?e.documentId:void 0,onMouseDown:b,onContextMenu:C},h?n.Ay.createElement(Ar.A,{ref:A,documentId:e.documentId,size:i.g0Q,noPlay:!s,observeIntersectionForPlaying:r,sharedCanvasRef:o,sharedCanvasHqRef:c,withTranslucentThumb:!0,forceAlways:d}):n.Ay.createElement(So.A,{tgsUrl:w,thumbDataUri:p,play:s,noLoop:!1,size:i.g0Q,isLowPriority:!0,className:I,sharedCanvas:o.current||void 0,sharedCanvasCoords:v,forceAlways:d}))});var wo=a(38027);const No=(0,n.ph)((0,s.EK)(e=>{const t=e.collectibleEmojiStatuses?.statuses;return{collectibleStatuses:t}})(({stickerSet:e,loadAndPlay:t,index:a,idPrefix:r,isNearActive:o,favoriteStickers:d,availableReactions:m,isSavedMessages:u,isStatusPicker:A,isReactionPicker:h,isCurrentUserPremium:y,shouldHideHeader:p,withDefaultTopicIcon:g,selectedReactionIds:v,withDefaultStatusIcon:E,isChatEmojiSet:f,isChatStickerSet:b,isTranslucent:C,noContextMenus:S,forcePlayback:k,observeIntersection:w,observeIntersectionForPlayingItems:N,observeIntersectionForShowingItems:P,onReactionSelect:T,onReactionContext:L,onStickerSelect:R,onStickerUnfave:F,onStickerFave:D,onStickerRemoveRecent:V,onContextMenuOpen:_,onContextMenuClose:U,onContextMenuClick:O,collectibleStatuses:J})=>{const{clearRecentStickers:K,clearRecentCustomEmoji:G,clearRecentReactions:j,openPremiumModal:z,toggleStickerSet:H,loadStickers:$}=(0,s.ko)(),q=(0,n.li)(),W=(0,n.li)(),Z=(0,n.li)(),X=(0,B.A)(),{width:ee}=(0,Se.A)(),[te,ae,ne]=(0,M.A)(),{isMobile:se}=(0,I.Ay)(),[re,ie]=(0,n.J0)(Io(ee)),oe=(0,io.Vz)(q,w??P),le=(0,Ja.A)(oe),ce=o||oe,de=se?8:4,me=se?8:10,Ae=se?8:4,he=e.id===i.sR2,ye=e.id===i.j1l,pe=e.id===i.tRH,ge=e.id===i.EPW,ve=e.isEmoji,Ee=!he&&(0,c.Q31)(e),fe=(0,x.A)(()=>{h?j():ve?G():K(),ne()}),be=(0,x.A)(()=>{Ee&&!y?z({initialSection:"animated_emoji"}):H({stickerSetId:e.id})}),Ce=(0,x.A)(()=>{R?.({mediaType:"sticker",id:i.MyF,isLottie:!1,isVideo:!1,stickerSetInfo:{shortName:"dummy"}})}),ke=(0,x.A)(()=>{R?.({mediaType:"sticker",id:i.zNY,isLottie:!1,isVideo:!1,stickerSetInfo:{shortName:"dummy"}})}),we=ve?i.g0Q:i.bkT,Ne=ve?me:de,Ie=ve?Ae:de,Pe=(0,x.A)(e=>e?Math.floor((e+Ne)/(we+Ne)):Io(ee)),Me=(0,x.A)(e=>{ie(Pe(e.contentRect.width))});(0,bo.A)(q,Me),(0,n.vJ)(()=>{q.current&&ie(Pe(q.current.clientWidth))},[Pe]),(0,n.vJ)(()=>{ce&&!e.stickers?.length&&!e.reactions?.length&&e.accessHash&&$({stickerSetInfo:{id:e.id,accessHash:e.accessHash}})},[ce,$,e]);const Te=!u&&!y&&Ee&&!f,xe=e.installedDate&&!e.isArchived,Be=!xe&&e.id!==i.sR2&&e.id!==i.EPW&&e.id!==i.hfH&&e.id!==i.Kp3&&!f&&!b,[Le,,Re]=(0,M.A)(Be),Fe=3*re-1,De=g||E?e.count+1:e.count,Ve=we+Ie,_e=Math.ceil(Math.min(Fe,De)/re)*Ve-Ie,Ue=Le?_e:Math.ceil(De/re)*Ve-Ie,Oe=(0,n.Kr)(()=>d?new Set(d.map(({id:e})=>e)):void 0,[d]),Je=(0,n.Kr)(()=>J?new Set(J.map(({documentId:e})=>e)):void 0,[J]),Ke=!p&&!he&&!ye&&ve&&!ge&&!f&&(!xe||!y&&!u),Ge=(0,n.Kr)(()=>X(Te?xe?"lng_emoji_premium_restore":"Unlock":"Add"),[Te,X,xe]);return n.Ay.createElement("div",{ref:q,key:e.id,id:`${r}-${a}`,className:(0,ue.A)("symbol-set",Te&&"symbol-set-locked")},!p&&n.Ay.createElement("div",{className:"symbol-set-header"},n.Ay.createElement("p",{className:(0,ue.A)("symbol-set-title",Ke&&"symbol-set-title-external")},Te&&n.Ay.createElement(Q.A,{name:"lock-badge",className:"symbol-set-locked-icon"}),n.Ay.createElement("span",{className:"symbol-set-name"},e.title),(f||b)&&n.Ay.createElement("span",{className:"symbol-set-chat"},X(f?"GroupEmoji":"GroupStickers")),Ke&&Boolean(e.stickers)&&n.Ay.createElement("span",{className:"symbol-set-amount"},X(ve?"EmojiCount":"Stickers",e.stickers.length,"i"))),he&&n.Ay.createElement(Q.A,{className:"symbol-set-remove",name:"close",onClick:ae}),Ke&&n.Ay.createElement(Y.A,{className:"symbol-set-add-button",withPremiumGradient:Ee&&!y,onClick:be,pill:!0,size:"tiny",fluid:!0},Ge)),n.Ay.createElement("div",{className:(0,ue.A)("symbol-set-container shared-canvas-container",le,e.id===i.hfH&&"effect-emojis"),style:`height: ${Ue}px;`},n.Ay.createElement("canvas",{ref:W,className:"shared-canvas",style:Be?`height: ${_e}px;`:void 0}),(he||pe||Be)&&n.Ay.createElement("canvas",{ref:Z,className:"shared-canvas"}),g&&n.Ay.createElement(Y.A,{className:"StickerButton custom-emoji",color:"translucent",onClick:Ce,key:"default-topic-icon"},n.Ay.createElement("img",{src:wo,alt:"Reset",className:"sticker-media",draggable:!1})),E&&n.Ay.createElement(Y.A,{className:"StickerButton custom-emoji status-default",color:"translucent",onClick:ke,key:"default-status-icon"},n.Ay.createElement(Q.A,{name:"star"})),ce&&e.reactions?.map(a=>{const s=(0,l.Jj)(a),r=s?v?.includes(s):void 0;return n.Ay.createElement(ko,{key:`${e.id}_${s}`,reaction:a,isSelected:r,loadAndPlay:t,availableReactions:m,observeIntersection:N,onClick:T,onContextMenu:L,sharedCanvasRef:W,sharedCanvasHqRef:Z,forcePlayback:k})}),ce&&e.stickers?.slice(0,Le?Fe:e.stickers.length).map((a,r)=>{const o=(he||pe)&&(0,c.CzR)((0,s.mS)(),a.stickerSetInfo),l=Be&&r>=Fe||o?Z:W,d=a.isCustomEmoji?a.id:a.emoji,m=d?v?.includes(d):void 0,h=a.id===i.j1l||Je?.has(a.id);return n.Ay.createElement(fo,{key:a.id,sticker:a,size:we,observeIntersection:N,observeIntersectionForShowing:P,noPlay:!t,isSavedMessages:u,isStatusPicker:A,canViewSet:!0,noContextMenu:S,isCurrentUserPremium:y,shouldIgnorePremium:f,sharedCanvasRef:l,withTranslucentThumb:C,onClick:R,clickArg:a,isSelected:m,onUnfaveClick:pe&&Oe?.has(a.id)?F:void 0,onFaveClick:Oe?.has(a.id)?void 0:D,onRemoveRecentClick:he?V:void 0,onContextMenuOpen:_,onContextMenuClose:U,onContextMenuClick:O,forcePlayback:k,isEffectEmoji:e.id===i.hfH,noShowPremium:y&&(e.id===i.Kp3||e.id===i.hfH),withSparkles:h})}),Le&&De>Fe&&n.Ay.createElement(Y.A,{className:"StickerButton custom-emoji set-expand",round:!0,color:"translucent",onClick:Re,key:"more"},"+",De-Fe)),he&&n.Ay.createElement(ya.A,{text:X(h?"ClearRecentReactionsAlertMessage":"ClearRecentStickersAlertMessage"),isOpen:te,onClose:ne,confirmHandler:fe,confirmIsDestructive:!0}))}));function Io(e){return e>440?8:e<362?6:7}const Po="p7c8y0LH",Mo="zTGriBHY",To="Qn3lBUNs",xo="HMspKpNp",Bo="YKO0Obwy",Lo="BZfaP1GD",Ro=2.5*h.$,Fo=new Set([i.sR2,i.tRH,i.EPW]),Do=new Set([i.sR2,i.tRH,i.EPW]),Vo=(0,n.ph)((0,s.EK)((e,{chatId:t,isStatusPicker:a,isReactionPicker:n})=>{const{stickers:{setsById:s},customEmojis:{byId:r,featuredIds:i,statusRecent:{emojis:o}},recentCustomEmojis:l,reactions:{availableReactions:d,recentReactions:m,topReactions:u,defaultTags:A}}=e,h=Boolean(t&&(0,c.nZ4)(e,t)),y=t?(0,c.AWZ)(e,t):void 0,p=e.collectibleEmojiStatuses?.statuses;return{customEmojisById:r,recentCustomEmojiIds:a?void 0:l,recentStatusEmojis:a?o:void 0,collectibleStatuses:a?p:void 0,stickerSetsById:s,addedCustomEmojiIds:e.customEmojis.added.setIds,canAnimate:(0,c.BWX)(e),isSavedMessages:h,isCurrentUserPremium:(0,c.g29)(e),customEmojiFeaturedIds:i,defaultTopicIconsId:e.defaultTopicIconsId,defaultStatusIconsId:e.defaultStatusIconsId,topReactions:n?u:void 0,recentReactions:n?m:void 0,chatEmojiSetId:y?.emojiSet?.id,isWithPaidReaction:n&&y?.isPaidReactionAvailable,availableReactions:n?d:void 0,defaultTagReactions:n?A:void 0}})(({className:e,pickerListClassName:t,isHidden:a,loadAndPlay:r,addedCustomEmojiIds:o,customEmojisById:d,recentCustomEmojiIds:m,selectedReactionIds:u,recentStatusEmojis:A,collectibleStatuses:h,stickerSetsById:y,chatEmojiSetId:p,topReactions:g,recentReactions:v,availableReactions:f,idPrefix:b="custom-emoji-set",customEmojiFeaturedIds:C,canAnimate:S,isReactionPicker:k,isStatusPicker:w,isTranslucent:N,isSavedMessages:P,isCurrentUserPremium:M,withDefaultTopicIcons:T,defaultTopicIconsId:L,defaultStatusIconsId:R,defaultTagReactions:F,isWithPaidReaction:D,onCustomEmojiSelect:V,onReactionSelect:_,onReactionContext:U,onContextMenuOpen:O,onContextMenuClose:J,onContextMenuClick:K})=>{const G=(0,n.li)(),j=(0,n.li)(),z=(0,n.li)(),H=(0,n.li)(),{isMobile:$}=(0,I.Ay)(),{handleScroll:q,isAtBeginning:W}=En(),Z=(0,n.Kr)(()=>w?A:Object.values((0,Ea._E)(d,m)),[d,w,m,A]),X=(0,n.Kr)(()=>{const e=h?.map(e=>e.documentId);return d&&e?.map(e=>d[e]).filter(Boolean)},[d,h]),ee=`${b}-custom-emoji`,{activeSetIndex:te,observeIntersectionForSet:ae,observeIntersectionForPlayingItems:se,observeIntersectionForShowingItems:re,observeIntersectionForCovers:ie,selectStickerSet:oe}=co(G,j,ee,a),le=(0,Ya.A)(r||void 0,i.jhd),ce=(0,B.A)(),de=(0,Ua.A)(),me=Boolean(o),Ae=(0,n.Kr)(()=>{const e=[];if(k&&P&&F?.length&&e.push({id:i.G3A,accessHash:"",title:ce("PremiumPreviewTags"),reactions:F,count:F.length,isEmoji:!0}),k&&!P){const t=g?.slice(0,16)||[];D&&t.unshift({type:"paid"}),t?.length&&e.push({id:i.G3A,accessHash:"",title:ce("Reactions"),reactions:t,count:t.length,isEmoji:!0});const a=(v||[]).filter(e=>!t.some(t=>(0,l.a0)(t,e))).slice(0,32),n=(f||[]).filter(({isInactive:e})=>!e).map(({reaction:e})=>e).filter(e=>!t.some(t=>(0,l.a0)(t,e))&&!a.some(t=>(0,l.a0)(t,e)));if(n?.length||a?.length){const t=!a?.length,s=a.concat(n);e.push({id:t?i.EPW:i.sR2,accessHash:"",title:ce(t?"PopularReactions":"RecentStickers"),reactions:s,count:s.length,isEmoji:!0})}}else if(w){const t=y[R];if(t?.stickers?.length){const a=(0,Ea.Xd)(t.stickers.slice(0,7).concat(Z||[]),"id");e.push({...t,stickers:a,count:a.length,id:i.sR2,title:ce("RecentStickers"),isEmoji:!0})}X?.length&&e.push({id:i.j1l,accessHash:"",count:X.length,stickers:X,title:de("CollectibleStatusesCategory"),isEmoji:!0})}else if(T){const t=y[L];t.stickers?.length&&e.push({...t,id:i.sR2,title:ce("RecentStickers")})}else Z?.length&&e.push({id:i.sR2,accessHash:"0",title:ce("RecentStickers"),stickers:Z,count:Z.length,isEmoji:!0});const t=[...o||[]];p&&t.unshift(p);const a=(0,Ea.Am)(t.concat(C||[])),n=Object.values((0,Ea._E)(y,a));return[...e,...n]},[o,k,w,T,Z,C,y,g,f,ce,v,R,L,P,F,p,D,X,de]),he=(0,n.Kr)(()=>me&&0===Ae.filter(e=>e.stickers?.length).length,[Ae,me]),ye=(0,so.A)([],i.jhd),pe=me&&ye&&!he;(0,ks.A)(j,$||!pe),(0,n.vJ)(()=>{if(!me)return;const e=j.current;if(!e)return;const t=te*Ro-(e.offsetWidth/2-Ro/2);(0,vr.A)(e,t)},[me,te]);const ge=(0,x.A)(e=>{V(e)}),ve=(0,ue.A)("StickerPicker","Qk9PEGRE",e),Ee=(0,ue.A)(To,"no-scrollbar",!W&&xo),fe=(0,ue.A)(Po,"U0BL1VvK",E.TF?"no-scrollbar":"custom-scroll",t,Mo),be=!pe&&!he;return n.Ay.createElement(ne.Ay,{className:ve,name:"fade",activeKey:be?0:1,shouldCleanup:!0},pe||he?!pe&&he?n.Ay.createElement("div",{className:Lo},ce("NoStickers")):n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{ref:j,className:Ee},n.Ay.createElement("div",{className:"shared-canvas-container"},n.Ay.createElement("canvas",{ref:z,className:"shared-canvas"}),n.Ay.createElement("canvas",{ref:H,className:"shared-canvas"}),Ae.map(function(e,t){const a=e.stickers?.[0],r=(0,ue.A)(Bo,t===te&&"WYeuJNQx"),o=t<i.j41,l=(0,c.CzR)((0,s.mS)(),e);if(e.id!==i.G3A){if(Do.has(e.id)||e.hasThumbnail||!a){const a=e.id===i.sR2||e.id===i.EPW,s=Fo.has(e.id);return n.Ay.createElement(Y.A,{key:e.id,className:r,ariaLabel:e.title,round:!0,faded:s,color:"translucent",onClick:()=>oe(a?0:t)},a?n.Ay.createElement(Q.A,{name:"recent"}):n.Ay.createElement(yo,{stickerSet:e,noPlay:!S||!le,forcePlayback:!0,observeIntersection:ie,sharedCanvasRef:o?l?H:z:void 0}))}return n.Ay.createElement(fo,{key:e.id,sticker:a,size:i.TBj,title:e.title,className:r,noPlay:!S||!le,observeIntersection:ie,noContextMenu:!0,isCurrentUserPremium:!0,sharedCanvasRef:o?l?H:z:void 0,withTranslucentThumb:N,onClick:oe,clickArg:t,forcePlayback:!0})}}))),n.Ay.createElement("div",{ref:G,onScroll:q,className:fe},Ae.map((e,t)=>{const a=e.id===i.G3A||e.id===i.sR2&&(T||w),s=e.id===p;return n.Ay.createElement(No,{key:e.id,stickerSet:e,loadAndPlay:Boolean(S&&le),index:t,idPrefix:ee,observeIntersection:ae,observeIntersectionForPlayingItems:se,observeIntersectionForShowingItems:re,isNearActive:te>=t-1&&te<=t+1,isSavedMessages:P,isStatusPicker:w,isReactionPicker:k,shouldHideHeader:a,withDefaultTopicIcon:T&&e.id===i.sR2,withDefaultStatusIcon:w&&e.id===i.sR2,isChatEmojiSet:s,isCurrentUserPremium:M,selectedReactionIds:u,availableReactions:f,isTranslucent:N,onReactionSelect:_,onReactionContext:U,onStickerSelect:ge,onContextMenuOpen:O,onContextMenuClose:J,onContextMenuClick:K,forcePlayback:!0})}))):n.Ay.createElement(Dn.A,null))}));var _o=a(3325);const Uo=(0,n.ph)((0,s.EK)(e=>({areFeaturedStickersLoaded:Boolean(e.customEmojis.featuredIds?.length),isTranslucent:(0,c.cwE)(e)}))(({isOpen:e,statusButtonRef:t,areFeaturedStickersLoaded:a,isTranslucent:r,onEmojiStatusSelect:i,onClose:o})=>{const{loadFeaturedEmojiStickers:l}=(0,s.ko)(),c=(0,n.li)(),[d,m,u]=(0,M.A)();(0,n.vJ)(()=>{c.current=t.current.getBoundingClientRect().right},[e,t]),(0,n.vJ)(()=>{e&&!a&&l()},[a,e,l]);const A=(0,n.hb)(e=>{i(e),o()},[o,i]);return n.Ay.createElement(_o.A,null,n.Ay.createElement(We.A,{isOpen:e,noCompact:!0,positionX:"right",bubbleClassName:"hRzvfaRb",onClose:o,transformOriginX:c.current,noCloseOnBackdrop:d},n.Ay.createElement(Vo,{idPrefix:"status-emoji-set-",loadAndPlay:e,isHidden:!e,isStatusPicker:!0,isTranslucent:r,onContextMenuOpen:m,onContextMenuClose:u,onCustomEmojiSelect:A,onContextMenuClick:o})))}));var Oo=a(10187);const Jo=6*h.$,Ko=(0,n.ph)((0,s.EK)((e,{modal:t})=>({currentUser:(0,c.mBe)(e,e.currentUserId),bot:t?.botId?(0,c.mBe)(e,t.botId):void 0}))(({modal:e,currentUser:t,bot:a})=>{const{setEmojiStatus:r,closeSuggestedStatusModal:i,sendWebAppEvent:o}=(0,s.ko)(),c=(0,Ua.A)(),d=Boolean(e),m=(0,La.A)(e),u=(0,n.Kr)(()=>{if(t&&m)return{...t,emojiStatus:{type:"regular",documentId:m.customEmojiId}}},[t,m]),A=(0,n.Kr)(()=>{if(!m||!a)return;const e=(0,l.Yg)(a);return m.duration?c("BotSuggestedStatusFor",{bot:e,duration:(0,$e.A$)(c,m.duration)},{withNodes:!0,withMarkdown:!0}):c("BotSuggestedStatus",{bot:e},{withNodes:!0,withMarkdown:!0})},[a,c,m]),h=(0,x.A)(()=>{const e=m?.webAppKey;e&&o({webAppKey:e,event:{eventType:"emoji_status_failed",eventData:{error:"USER_DECLINED"}}}),i()}),y=(0,x.A)(()=>{if(!m)return;const e=m.duration?(0,la.Fm)()+m.duration:void 0;r({referrerWebAppKey:m.webAppKey,emojiStatus:{type:"regular",documentId:m.customEmojiId,until:e}}),i()});return n.Ay.createElement(X.A,{isOpen:d,contentClassName:"C9sWDINB",hasAbsoluteCloseButton:!0,isSlim:!0,onClose:h},m&&n.Ay.createElement(Ar.A,{className:"gdG3oY21",documentId:m.customEmojiId,size:Jo,loopLimit:1,forceAlways:!0}),n.Ay.createElement("div",null,n.Ay.createElement("h3",{className:"KVpsce1g"},c("BotSuggestedStatusTitle")),n.Ay.createElement("p",{className:"p7S4AH8A"},A)),u&&n.Ay.createElement(Oo.A,{mockPeer:u,withEmojiStatus:!0}),n.Ay.createElement(Y.A,{size:"smaller",onClick:y},c("GeneralConfirm")))}));var Go=a(55317),jo=a(20333);const zo="j6xEoljc";function Ho(e,t){return e.find(e=>!e.chatId)||e.filter(e=>t&&e.chatId!==t).sort((e,t)=>e.date-t.date)[0]}const $o=(0,n.ph)((0,s.EK)((e,{modal:t})=>{const a=t&&(0,c.hds)(e,t?.chatId),n=a&&(0,c.AWZ)(e,a.id),s=t?.myBoosts&&Ho(t.myBoosts,t.chatId);return{chat:a,chatFullInfo:n,prevBoostedChat:s?.chatId?(0,c.hds)(e,s?.chatId):void 0,isCurrentUserPremium:(0,c.g29)(e)}})(({modal:e,chat:t,chatFullInfo:a,prevBoostedChat:r,isCurrentUserPremium:i})=>{const{applyBoost:o,closeBoostModal:c,requestConfetti:d,openPremiumModal:m,loadFullChat:u}=(0,s.ko)(),[A,h,y]=(0,M.A)(),[p,g,v]=(0,M.A)(),[E,f,b]=(0,M.A)(),C=t&&(0,l.WX)(t),S=Boolean(e),k=(0,B.A)(),w=(0,Ua.A)();(0,n.vJ)(()=>{t&&!a&&u({chatId:t.id})},[t,a]);const N=(0,n.Kr)(()=>{if(t)return(0,l.Js)(k,t)},[t,k]),I=(0,n.Kr)(()=>{if(r)return(0,l.Js)(k,r)},[r,k]),{isStatusLoaded:P,isBoosted:T,boost:L,title:R,leftText:F,rightText:D,value:V,progress:_,descriptionText:U,canBoostMore:O}=(0,n.Kr)(()=>{if(!e?.boostStatus||!t)return{isStatusLoaded:!1,title:k("Loading")};const{hasMyBoost:n}=e.boostStatus,s=e?.myBoosts&&Ho(e.myBoosts,t.id),r=e?.myBoosts&&(i=e.myBoosts,o=t.id,!i.every(e=>e.chatId===o));var i,o;const{boosts:c,currentLevel:d,hasNextLevel:m,levelProgress:u,remainingBoosts:A,isMaxLevel:h}=(0,Go.z)(e.boostStatus,!0),y=n,p=k("BoostsLevel",d),g=m?k("BoostsLevel",d+1):void 0,v=k("ChannelBoost.MoreBoosts",A),E=k(C?"BoostChannel":"BoostGroup"),f=(a?.boostsToUnrestrict||0)-(a?.boostsApplied||0);let b;if(h)b=k("BoostsMaxLevelReached");else if(f>0&&!(0,l.SJ)(t)){const e=k("GroupBoost.BoostToUnrestrict.Times",f);b=k("GroupBoost.BoostToUnrestrict",[e,N])}else b=k("ChannelBoost.MoreBoostsNeeded.Text",[N,v]);return{isStatusLoaded:!0,title:E,leftText:p,rightText:g,value:c.toString(),progress:u,remainingBoosts:A,descriptionText:b,boost:s,isBoosted:y,canBoostMore:r&&!h}},[t,N,e,k,a,C]),J=!e?.myBoosts?.length&&i,K=L?.chatId&&L.chatId!==e?.chatId,G=(0,x.A)(()=>{y(),o({chatId:t.id,slots:[L.slot]}),d({})}),j=(0,x.A)(()=>{m(),b(),c()}),z=(0,x.A)(()=>{if(!L)return i?void c():void f();O?L.cooldownUntil?g():K?h():G():c()}),H=(0,x.A)(()=>{c()});return n.Ay.createElement(X.A,{isOpen:S,title:R,className:"IK2mBqbm",contentClassName:"pUyNTysT",onClose:c},P?n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(jo.A,{leftText:F,rightText:D,progress:_,floatingBadgeText:V,floatingBadgeIcon:"boost"}),T&&n.Ay.createElement("div",{className:(0,ue.A)(zo,"hAA6B1lc")},k("ChannelBoost.YouBoostedChannelText",N)),n.Ay.createElement("div",{className:zo},(0,Tt.A)(U,["simple_markdown","emoji"])),n.Ay.createElement("div",{className:"dialog-buttons"},n.Ay.createElement(Y.A,{isText:!0,className:"confirm-dialog-button",disabled:J,onClick:z},O?n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(Q.A,{name:"boost"}),k(C?"ChannelBoost.BoostChannel":"GroupBoost.BoostGroup")):k("OK")),n.Ay.createElement(Y.A,{isText:!0,className:"confirm-dialog-button",onClick:H},k("Cancel")))):n.Ay.createElement(Dn.A,{className:"zjXCH3pT"}),K&&I&&n.Ay.createElement(X.A,{isOpen:A,className:"GIFAjZPY",contentClassName:"Jxyz9TaL",onClose:y},n.Ay.createElement("div",{className:"OKp6HS1U"},n.Ay.createElement("div",{className:"NU9itcIm"},n.Ay.createElement(xt.A,{peer:r,size:"large"}),n.Ay.createElement(Q.A,{name:"boostcircle",className:"upXvhNRY"})),n.Ay.createElement(Q.A,{name:"next",className:"WSJdWV7L"}),n.Ay.createElement(xt.A,{peer:t,size:"large"})),n.Ay.createElement("div",null,(0,Tt.A)(k("ChannelBoost.ReplaceBoost",[I,N]),["simple_markdown","emoji"])),n.Ay.createElement("div",{className:"dialog-buttons"},n.Ay.createElement(Y.A,{isText:!0,className:"confirm-dialog-button",onClick:G},k("Replace")),n.Ay.createElement(Y.A,{isText:!0,className:"confirm-dialog-button",onClick:y},k("Cancel")))),Boolean(L?.cooldownUntil)&&n.Ay.createElement(ya.A,{isOpen:p,isOnlyConfirm:!0,confirmLabel:k("OK"),title:k("ChannelBoost.Error.BoostTooOftenTitle"),onClose:v,confirmHandler:v},(0,Tt.A)(k("ChannelBoost.Error.BoostTooOftenText",(0,$e.A$)(w,L.cooldownUntil-(0,la.Fm)())),["simple_markdown","emoji"])),!i&&n.Ay.createElement(ya.A,{isOpen:E,confirmLabel:k("Common.Yes"),title:k("PremiumNeeded"),onClose:b,confirmHandler:j},(0,Tt.A)(k("PremiumNeededForBoosting"),["simple_markdown","emoji"])))}));var qo=a(47058),Wo=a(70046);const Qo="xVLGjLub",Yo=(0,n.ph)((0,s.EK)((e,{modal:t})=>{const{message:a}=t||{},n=a&&(0,c.O5q)(e,a.chatId,a.messageId),s=n&&(0,c.Y7C)(e,n);return{currentUserId:e.currentUserId,messageSender:s}})(({currentUserId:e,modal:t,messageSender:a})=>{const{closeGiftCodeModal:r,applyGiftCode:o,focusMessage:l}=(0,s.ko)(),c=(0,B.A)(),d=Boolean(t),m=!(t?.info.toId&&t?.info.toId!==e||t?.info.usedAt),u=(0,x.A)(()=>{t&&t.info.giveawayMessageId&&(l({chatId:t.info.fromId,messageId:t.info.giveawayMessageId}),r())}),A=(0,x.A)(()=>{m?o({slug:t.slug}):r()}),h=(0,n.Kr)(()=>{if(!t)return;const{slug:e,info:s}=t,r=s.fromId||a?.id,o=n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("img",{src:Wi,alt:"",className:"Mtx4SWww"}),n.Ay.createElement("p",{className:Qo},(0,Tt.A)(c("lng_gift_link_about"),["simple_markdown"])),n.Ay.createElement(qo.A,{title:"BoostingGiftLink",link:`${i.jsp}/giftcode/${e}`})),l=[[c("BoostingFrom"),r?{chatId:r}:c("BoostingNoRecipient")],[c("BoostingTo"),s.toId?{chatId:s.toId}:c("BoostingNoRecipient")],[c("BoostingGift"),c("BoostingTelegramPremiumFor",c("Months",s.months,"i"))]];return s.isFromGiveaway&&l.push([c("BoostingReason"),n.Ay.createElement("span",{className:(0,ue.A)(s.giveawayMessageId&&"IzcASdzD"),onClick:u},s.isFromGiveaway&&!s.toId?c("BoostingIncompleteGiveaway"):c("BoostingGiveaway"))]),l.push([c("BoostingDate"),(0,$e.L2)(1e3*s.date,c.code,!0)]),{header:o,tableData:l,footer:n.Ay.createElement("span",{className:Qo},(0,Tt.A)(s.usedAt?c("BoostingUsedLinkDate",(0,$e.L2)(1e3*s.usedAt,c.code,!0)):c("BoostingSendLinkToAnyone"),["simple_markdown"]))}},[c,a?.id,t]);if(h)return n.Ay.createElement(Wo.A,{isOpen:d,title:c("lng_gift_link_title"),tableData:h.tableData,header:h.header,footer:h.footer,buttonText:c(m?"BoostingUseLink":"Close"),onButtonClick:A,onClose:r})}));function Zo(e,t){return e.reduce((e,a)=>Math.abs(a-t)<Math.abs(e-t)?a:e)}const Xo=(0,n.ph)((0,s.EK)((e,{modal:t})=>{const{selfDestructAccountDays:a}=t||{};return{selfDestructAccountDays:a}})(({modal:e,selfDestructAccountDays:t})=>{const{closeGiftCodeModal:a,closeDeleteAccountModal:r,setAccountTTL:o}=(0,s.ko)(),l=(0,Ua.A)(),c=Boolean(e),[d,m]=(0,n.J0)(),u=(0,x.A)(e=>30*Number(e)),A=(0,n.Kr)(()=>{if(t)return Zo(i.WF4,t/30).toString()},[t]);(0,n.vJ)(()=>{A&&m(A)},[A]);const h=(0,n.Kr)(()=>i.WF4.map(e=>({value:String(e),label:l("Months",{count:e},{pluralValue:1})})),[l]),y=(0,x.A)(e=>{m(e)}),p=(0,x.A)(()=>{d&&o({days:u(d)})}),g=(0,x.A)(()=>{r()});return n.Ay.createElement(X.A,{isOpen:c,title:l("SelfDestructTitle"),onClose:a,className:"X6K5oA8U"},n.Ay.createElement("p",null,l("SelfDestructSessionsDescription")),n.Ay.createElement(ee.A,{className:"dialog-checkbox-group",name:"quick-reaction-settings",options:h,selected:d,onChange:y,withIcon:!0}),n.Ay.createElement("div",{className:"dialog-buttons mt-2"},n.Ay.createElement(Y.A,{className:"confirm-dialog-button",isText:!0,onClick:p},l("Save")),n.Ay.createElement(Y.A,{color:"danger",className:"confirm-dialog-button",isText:!0,onClick:g},l("Cancel"))))})),el={root:"OviJR58x",content:"BlpqzGYt",header:"b9RUzfpF",iconWrapper:"l1X5kBUM",icon:"qOoRnv_Y",mainText:"s2SOQSml",description:"wiKBjcl2"},tl=(0,n.ph)((0,s.EK)(e=>{const t=e.appConfig,a=t?.verifyAgeBotUsername;return{verifyAgeBotUsername:a,verifyAgeMin:t?.verifyAgeMin||i.lYi}})(({modal:e,verifyAgeBotUsername:t,verifyAgeMin:a})=>{const{closeAgeVerificationModal:r,openChatByUsername:i}=(0,s.ko)(),o=(0,Ua.A)(),l=Boolean(e),c=(0,x.A)(()=>{t&&i({shouldStartMainApp:!0,username:t}),r()}),d=(0,x.A)(()=>{r()});return n.Ay.createElement(X.A,{isOpen:l,onClose:d,className:el.root},n.Ay.createElement("div",{className:el.content},n.Ay.createElement("div",{className:el.header},n.Ay.createElement("div",{className:el.iconWrapper},n.Ay.createElement(Q.A,{name:"user",className:el.icon}))),n.Ay.createElement("h2",{className:el.title},o("TitleAgeVerificationModal")),n.Ay.createElement("p",{className:el.mainText},o("TextAgeVerificationModal",{count:a},{withMarkdown:!0,withNodes:!0,pluralValue:a})),n.Ay.createElement("p",{className:el.description},o("DescriptionAgeVerificationModal"))),n.Ay.createElement("div",{className:"dialog-buttons mt-2"},n.Ay.createElement(Y.A,{onClick:c},o("ButtonAgeVerification"))))}));var al=a(34132),nl=a(24713);const sl={description:"dl10exNi","picker-wrapper":"gxWY5c6x",pickerWrapper:"gxWY5c6x","picker-header":"h8N7eyob",pickerHeader:"h8N7eyob","picker-header-info":"Rth2Qu07",pickerHeaderInfo:"Rth2Qu07","selection-toggle":"B6eAugx8",selectionToggle:"B6eAugx8",foldersWrapper:"mwcvgD2S",folders:"LKavx8ww",folder:"qglLx5Dn","button-text":"bgaRuEMs",buttonText:"bgaRuEMs","button-badge":"rTe14Z22",buttonBadge:"rTe14Z22"},rl=(0,n.ph)(({invite:e,folder:t})=>{const{closeChatlistModal:a,joinChatlistInvite:r}=(0,s.ko)(),i=(0,Ua.A)(),o=(0,B.A)(),[l,c]=(0,n.J0)(e.missingPeerIds),d=Boolean(e.missingPeerIds.length),m=0===e.alreadyPeerIds.length,u=d?e.missingPeerIds.length:0,A=l.length?l.length.toString():void 0,h=m?i("FolderLinkSubtitleNew"):u?i("FolderLinkSubtitleAdd",{chats:i("FolderLinkSubtitleAddCount",{count:u},{pluralValue:u}),title:(0,Xa.fd)({text:t.title.text,entities:t.title.entities,noCustomEmojiPlayback:t.noTitleAnimations})},{withNodes:!0,withMarkdown:!0}):i("FolderLinkSubtitleAlready"),y=(0,n.hb)(()=>{a(),l.length&&r({invite:e,peerIds:l})},[e,l]),p=(0,n.hb)(()=>{const t=l.length===e.missingPeerIds.length;c(t?[]:e.missingPeerIds)},[e.missingPeerIds,l.length]);return n.Ay.createElement("div",{className:sl.content},n.Ay.createElement("div",{className:sl.description},(0,Tt.A)(h,["simple_markdown","emoji"])),n.Ay.createElement("div",{className:(0,ue.A)(sl.pickerWrapper,"custom-scroll")},Boolean(e.missingPeerIds.length)&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:sl.pickerHeader},n.Ay.createElement("div",{className:sl.pickerHeaderInfo},o("FolderLinkHeaderChatsJoin",l.length,"i")),n.Ay.createElement("div",{className:sl.selectionToggle,role:"button",tabIndex:0,onClick:p},l.length===e.missingPeerIds.length?o("DeselectAll"):o("SelectAll"))),n.Ay.createElement(ba.A,{itemIds:e.missingPeerIds,onSelectedIdsChange:c,selectedIds:l,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"})),n.Ay.createElement("div",{className:sl.pickerHeader},n.Ay.createElement("div",{className:sl.pickerHeaderInfo},o("FolderLinkHeaderAlready"))),n.Ay.createElement(ba.A,{itemIds:e.alreadyPeerIds,lockedSelectedIds:e.alreadyPeerIds,selectedIds:e.alreadyPeerIds,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"})),n.Ay.createElement(Y.A,{size:"smaller",onClick:y},n.Ay.createElement("div",{className:sl.buttonText},!l.length&&o("OK"),Boolean(l.length)&&n.Ay.createElement(n.Ay.Fragment,null,o("FolderLinkButtonJoinPlural",l.length,"i"),n.Ay.createElement(nl.A,{className:sl.buttonBadge,text:A,isAlternateColor:!0})))))}),il=(0,n.ph)(({folder:e,suggestedPeerIds:t=fa.p})=>{const{closeChatlistModal:a,leaveChatlist:r}=(0,s.ko)(),i=(0,B.A)(),[o,l]=(0,n.J0)([]),c=o.length?o.length.toString():void 0,d=(0,n.hb)(()=>{const e=o.length===t.length;l(e?[]:t)},[t,o.length]),m=(0,n.hb)(()=>{a(),r({folderId:e.id,peerIds:o})},[e.id,o]);return n.Ay.createElement("div",{className:sl.content},Boolean(t?.length)&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:sl.description},(0,Tt.A)(i("FolderLinkSubtitleRemove"),["simple_markdown","emoji"])),n.Ay.createElement("div",{className:(0,ue.A)(sl.pickerWrapper,"custom-scroll")},n.Ay.createElement("div",{className:sl.pickerHeader},n.Ay.createElement("div",{className:sl.pickerHeaderInfo},i("FolderLinkHeaderChatsQuit",o.length,"i")),n.Ay.createElement("div",{className:sl.selectionToggle,role:"button",tabIndex:0,onClick:d},o.length===t.length?i("DeselectAll"):i("SelectAll"))),n.Ay.createElement(ba.A,{itemIds:t,onSelectedIdsChange:l,selectedIds:o,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"}))),n.Ay.createElement(Y.A,{size:"smaller",onClick:m},n.Ay.createElement("div",{className:sl.buttonText},!o.length&&i("FolderLinkButtonRemove"),Boolean(o.length)&&n.Ay.createElement(n.Ay.Fragment,null,i("FolderLinkButtonRemoveChats"),n.Ay.createElement(nl.A,{className:sl.buttonBadge,text:c,isAlternateColor:!0})))))}),ol=(0,n.ph)(({invite:e})=>{const{closeChatlistModal:t,joinChatlistInvite:a}=(0,s.ko)(),r=(0,Ua.A)(),i=(0,B.A)(),[o,l]=(0,n.J0)(e.peerIds),c=(0,n.Kr)(()=>{const t=(0,s.mS)().chats.byId;return e.peerIds.filter(e=>!t[e].isNotJoined)},[e.peerIds]),d=o.length-c.length,m=d?d.toString():void 0,u=(0,n.hb)(()=>{t(),a({invite:e,peerIds:o})},[e,o]),A=(0,n.hb)(()=>{const t=o.length===e.peerIds.length;l(t?c:e.peerIds)},[e.peerIds,c,o.length]);return n.Ay.createElement("div",{className:sl.content},n.Ay.createElement("div",{className:sl.description},r("FolderLinkSubtitleNew")),n.Ay.createElement("div",{className:(0,ue.A)(sl.pickerWrapper,"custom-scroll")},n.Ay.createElement("div",{className:sl.pickerHeader},n.Ay.createElement("div",{className:sl.pickerHeaderInfo},i("FolderLinkHeaderChatsJoin",d,"i")),n.Ay.createElement("div",{className:sl.selectionToggle,role:"button",tabIndex:0,onClick:A},o.length===e.peerIds.length?i("DeselectAll"):i("SelectAll"))),n.Ay.createElement(ba.A,{itemIds:e.peerIds,lockedSelectedIds:c,onSelectedIdsChange:l,selectedIds:o,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"})),n.Ay.createElement(Y.A,{onClick:u,size:"smaller",disabled:!o.length},n.Ay.createElement("div",{className:sl.buttonText},r("FolderLinkAddFolder"),n.Ay.createElement(nl.A,{className:sl.buttonBadge,text:m,isAlternateColor:!0}))))}),ll=(0,n.ph)((0,s.EK)((e,{modal:t})=>{const{invite:a,removal:n}=t||{},s=n?.folderId||(a&&"folderId"in a?a.folderId:void 0);return{folder:s?(0,c.$aQ)(e,s):void 0}})(({modal:e,folder:t})=>{const{closeChatlistModal:a}=(0,s.ko)(),r=(0,B.A)(),i=Boolean(e),o=(0,U.A)(e)||e,l=(0,U.A)(t)||t,c=(0,n.Kr)(()=>{if(o){if(o.invite){const e=o.invite;return"alreadyPeerIds"in e?e.missingPeerIds.length?r("FolderLinkTitleAddChats"):r("FolderLinkTitleAlready"):r("FolderLinkTitleAdd")}return o.removal?r("FolderLinkTitleRemove"):void 0}},[r,o]),d=(0,n.Kr)(()=>l?(0,Xa.fd)({text:l.title.text,entities:l.title.entities,noCustomEmojiPlayback:l.noTitleAnimations}):o?.invite&&"title"in o.invite?(0,Xa.fd)({text:o.invite.title.text,entities:o.invite.title.entities,noCustomEmojiPlayback:o.invite.noTitleAnimations}):void 0,[l,o]),m=(0,n.Kr)(()=>{if(o?.invite)return"missingPeerIds"in o.invite?o.invite.missingPeerIds.length:void 0},[o]),u=(0,n.hb)(()=>{if(o){if(o.invite){const e=o.invite;return"alreadyPeerIds"in e?n.Ay.createElement(rl,{invite:e,folder:l}):n.Ay.createElement(ol,{invite:e})}return o.removal?n.Ay.createElement(il,{folder:l,suggestedPeerIds:o.removal.suggestedPeerIds}):void 0}},[l,o]);return n.Ay.createElement(X.A,{isOpen:i,title:c,onClose:a,isSlim:!0,hasCloseButton:!0},d&&(A=d,n.Ay.createElement("div",{className:sl.foldersWrapper},n.Ay.createElement("div",{className:sl.folders},n.Ay.createElement(al.A,{className:sl.folder,title:r("FolderLinkPreviewLeft")}),n.Ay.createElement(al.A,{className:sl.folder,isActive:!0,badgeCount:m,isBadgeActive:!0,title:A}),n.Ay.createElement(al.A,{className:sl.folder,title:r("FolderLinkPreviewRight")})))),u());var A}));var cl=a(29886);const dl={content:"MZ0RCecx",title:"ar8XeydN",participantCount:"un00TXYY",participants:"YvkZ6c2D",participant:"DHJSBDeE",buttons:"KFtrPtNr"},ml=(0,n.ph)(({modal:e})=>{const{acceptChatInvite:t,closeChatInviteModal:a,showNotification:r}=(0,s.ko)(),i=(0,n.li)(),o=(0,B.A)(),d=(0,cl.A)(e),{hash:m,inviteInfo:u}=e||d||{},{about:A,isBroadcast:h,participantIds:y,participantsCount:p,photo:g,isRequestNeeded:v}=u||{},E=(0,x.A)(()=>{a()}),f=(0,x.A)(()=>{t({hash:m}),v&&r({message:o(h?"RequestToJoinChannelSentDescription":"RequestToJoinGroupSentDescription")}),E()}),b=h?"ProfileJoinChannel":"JoinGroup",C=h?"MemberRequests.RequestToJoinChannel":"MemberRequests.RequestToJoinGroup",S=(0,n.Kr)(()=>{if(u)return(0,l.nr)(u)},[u]),k=(0,n.Kr)(()=>{if(!y)return;const e=(0,s.mS)();return y.map(t=>(0,c.mBe)(e,t)).filter(Boolean)},[y]);return(0,ks.A)(i,!e||!k),n.Ay.createElement(X.A,{isOpen:Boolean(e),contentClassName:dl.content,isSlim:!0,onClose:E,onEnter:f},S&&n.Ay.createElement(xt.A,{size:"jumbo",photo:g,peer:S,withVideo:!0}),S&&n.Ay.createElement(Vn.A,{className:dl.title,peer:S}),A&&n.Ay.createElement("p",{className:dl.about},A),n.Ay.createElement("p",{className:dl.participantCount},o(h?"Subscribers":"Members",p,"i")),k&&n.Ay.createElement("div",{ref:i,className:(0,ue.A)(dl.participants,"no-scrollbar")},k.map(e=>n.Ay.createElement(Is.A,{className:dl.participant,peer:e,text:(0,l.Yg)(e)}))),n.Ay.createElement("div",{className:(0,ue.A)("dialog-buttons",dl.buttons)},n.Ay.createElement(Y.A,{isText:!0,className:"confirm-dialog-button",onClick:f},o(v?C:b)),n.Ay.createElement(Y.A,{isText:!0,className:"confirm-dialog-button",onClick:E},o("Cancel"))))});var ul=a(45227),Al=a(96540),hl=a(5131),yl=a(39875),pl=a(3547),gl=a(73039),vl=a(22199);const El=()=>{const[e,t]=(0,Al.useState)(1),[a,n]=(0,Al.useState)(10),[r,i]=(0,Al.useState)([]),[o,l]=(0,Al.useState)(!0),{defaultAlgorithm:d,darkAlgorithm:m}=hl.A,u=(0,s.mS)(),A=(0,c.SJA)(u),h=[{title:"Detail",dataIndex:"description",key:"description"},{title:"Credits",dataIndex:"amount",key:"amount"},{title:"Time",dataIndex:"createdAt",key:"createdAt",render:e=>(0,vl.xp)(e)}],y=async e=>{const a=await(0,gl.G3)(e);l(!1);const{records:s,pagination:r}=a.data;r.total>0&&(n(r.total),t(e)),s.length>0&&i(s)};return(0,Al.useEffect)(()=>{y(1)},[]),Al.createElement(yl.Ay,{theme:{algorithm:"dark"===A?m:d}},Al.createElement(pl.A,{columns:h,dataSource:r,loading:o,pagination:{showSizeChanger:!1,current:e,pageSize:10,total:a,onChange:e=>{l(!0),y(e)}}}))},fl=(0,n.ph)(({modal:e})=>{const t=(0,n.li)(),{closeCreditsModal:a}=(0,s.ko)(),r=(0,ul.P)({component:El}),i=(0,x.A)(()=>{a()});if((0,n.vJ)(()=>{let e;return t.current&&(e=r(t.current)),()=>{e?.unmount()}},[r]),e?.isOpen)return n.Ay.createElement(X.A,{isOpen:Boolean(e?.isOpen),contentClassName:"aZyt0u4J",title:"Credits Detail",hasCloseButton:!0,onClose:i},n.Ay.createElement("div",{ref:t}))}),bl=a.p+"link.faf12a928d821100c82a.svg",Cl=a.p+"user-group.a38c9d162cae6ec43000.svg";var Sl=a(46942),kl=a.n(Sl),wl=a(17965),Nl=a.n(wl),Il=a(29356);const Pl=()=>{const[e,t]=(0,Al.useState)(1),[a,n]=(0,Al.useState)(10),[r,i]=(0,Al.useState)([]),[o,l]=(0,Al.useState)(!0),{defaultAlgorithm:d,darkAlgorithm:m}=hl.A,u=(0,s.mS)(),A=(0,c.SJA)(u),h=[{title:"Code",dataIndex:"inviteCode",key:"inviteCode",render:(e,t)=>Al.createElement("div",{className:kl()("w-[100px] h-[36px] text-white text-[14px] flex items-center justify-center gap-[6px] rounded-[8px] bg-[#369CFF]",{"bg-[#D6D6D6]":"used"===t.status}),onClick:()=>{return t=e,Nl()(t),void(0,s.ko)().showNotification({message:"TextCopied"});var t}},Al.createElement("span",null,e),Al.createElement(Il.A,{name:"copy",className:"cursor-pointer text-[18px]"}))},{title:"Invitees",dataIndex:"invitedUserName",key:"invitedUserName"},{title:"Credits",dataIndex:"points",key:"points",render:e=>e||""},{title:"Time",dataIndex:"invitedAt",key:"invitedAt",render:e=>e?(0,vl.xp)(e):""}],y=async e=>{const a=await(0,gl.O9)(e);l(!1);const{records:s,pagination:r}=a.data;r.total>0&&(n(r.total),t(e)),s.length>0&&i(s)};return(0,Al.useEffect)(()=>{y(1)},[]),Al.createElement(yl.Ay,{theme:{algorithm:"dark"===A?m:d}},Al.createElement(pl.A,{columns:h,dataSource:r,loading:o,pagination:{showSizeChanger:!1,current:e,pageSize:10,total:a,onChange:e=>{l(!0),y(e)}}}))},Ml=(0,n.ph)(({modal:e})=>{const{closeInviteFriendsModal:t}=(0,s.ko)(),[a,r]=(0,n.J0)(null),i=(0,n.li)(),o=(0,ul.P)({component:Pl});(0,n.vJ)(()=>{let e;return i.current&&(e=o(i.current)),()=>{e?.unmount()}},[o]),(0,n.vJ)(()=>{if(e?.isOpen){const e=localStorage.getItem("user-invitation"),t=e?JSON.parse(e):{};t?.inviteCode?r(t.inviteCode):(0,gl.AG)().then(e=>{0===e.code&&r(e.data.inviteCode)})}},[e?.isOpen]);const l=(0,n.hb)(()=>{t()},[t]);if(e?.isOpen)return n.Ay.createElement(X.A,{isOpen:e.isOpen,onClose:l,className:"Atk759rS"},n.Ay.createElement("div",{className:"JncR5ehY"},n.Ay.createElement("div",{className:"b_IDNEEX"}),n.Ay.createElement(Q.A,{className:"text-[18px] cursor-pointer z-10 mt-[1rem]",name:"close",onClick:l})),n.Ay.createElement("div",{className:"EsOVcnjd"},n.Ay.createElement("div",{className:"flex flex-col gap-[12px]"},n.Ay.createElement("div",{className:"flex items-center gap-[10px]"},n.Ay.createElement("img",{className:"w-[20px] h-[20px]",src:bl,alt:""}),n.Ay.createElement("span",{className:"text-[16px] text-[var(--color-text)] font-semibold"},"My Code")),n.Ay.createElement("div",{className:"text-[var(--color-text-secondary)] text-[14px]"},"This is your exclusive invitation code, it has already been linked to your account."),n.Ay.createElement("div",{className:"text-[14px] text-[var(--color-text)]"},n.Ay.createElement("span",{className:"font-bold"},a),n.Ay.createElement("span",null,"(Used by my account)"))),n.Ay.createElement("div",{className:"flex flex-col gap-[12px] mt-[18px]"},n.Ay.createElement("div",{className:"flex items-center gap-[10px]"},n.Ay.createElement("img",{className:"w-[20px] h-[20px]",src:Cl,alt:""}),n.Ay.createElement("span",{className:"text-[16px] text-[var(--color-text)] font-semibold"},"Get Credits for Inviting Friends")),n.Ay.createElement("div",{className:"text-[var(--color-text-secondary)] text-[14px]"},"Share the invitation codes below with your friends! When a new user signs up and uses your invitation code, both you and the invitee will each receive a 100 credit bonus."),n.Ay.createElement("div",{ref:i}))))});var Tl=a(11780);const xl={modal:"tHOvsXvB",container:"aE_tTreD",header:"pvOW79XD",title:"QQrZjQwa",subtitle:"mNshS0kL",content:"VPxgzl1P",input:"AAMVR_VT",error:"hHHsDtnR",footer:"qoqDTwEz",submitButton:"PoDbRDyr"},Bl=(0,n.ph)(({modal:e})=>{const{closeInviteCodeModal:t}=(0,s.ko)(),[a,r]=(0,n.J0)(""),[i,o]=(0,n.J0)(!1),[l,c]=(0,n.J0)("");if(e?.isOpen)return n.Ay.createElement(X.A,{isOpen:e.isOpen,onClose:()=>{},className:xl.modal},n.Ay.createElement("div",{className:xl.container},n.Ay.createElement("div",{className:xl.header},n.Ay.createElement("img",{src:Tl,alt:""})),n.Ay.createElement("div",{className:xl.content},n.Ay.createElement("h3",{className:xl.title},"Invitation Code"),n.Ay.createElement(Z.A,{value:a,onChange:e=>{r(e.target.value)},placeholder:"Please enter the invitation code",className:xl.input}),n.Ay.createElement("div",{className:xl.error},l),n.Ay.createElement("div",{className:xl.actions},n.Ay.createElement(Y.A,{onClick:()=>{if(a.trim()){o(!0);try{(0,gl.V)(a).then(e=>{0===e.code?(t(),c("")):(console.log("Failed to submit invite code:",e),c(e.error))})}catch(e){console.error("Failed to submit invite code:",e)}finally{o(!1)}}},disabled:!a.trim()||i,className:xl.submitButton,noForcedUpperCase:!0},i?"Confirm...":"Confirm")))))}),Ll={modal:"iPYLjGRN",container:"bXjDu4AH",headerBadge:"MVw30piB",header:"Ew6sXI7m",title:"xxS1QyO1",closeButton:"f2Wsapg3",pricingCards:"BDPB7EkE",pricingCard:"bYO5T_qM",selected:"BE9SgHCo",planTitle:"IlfR09Hu",price:"DftVWLUr",creditsInfo:"y999O3nR",featuresTitle:"u2kltuIN",feature:"WBuVoBis",upgradeButton:"jOxFhAVG",creditsInfoDescription:"ngIi6AD9",period:"tcBLDlq0",topContent:"fbVKY2k0",cardHeader:"DXcB0v5g",pricing:"UmPmxmgp",priceRow:"lxGKzaAX",botInfo:"J76Z3ZQP",features:"UkLVxigA",listdot:"uZi2jyLW",checkIcon:"DLjk4XGB"},Rl={free:0,basic:1,pro:2,plus:3},Fl={basic:{planType:"basic",title:"Basic",price:"$4.99",period:"/month",creditsInfo:"10,000 Credits monthly",creditsInfoDescription:"10,000 extra credits first month [LIMITED TIME]",buttonLink:"https://buy.stripe.com/28E8wQeqhfPK2g5g014Ni05",features:["Global Chat Summary (1 every 24h)","Up to 250 Group Chat Summary ","Up to 200 Images Summary ","Up to 60 mins video & Voice Summary","Up to 10k-characters AI Translation","Up to 10k-characters Grammar Check","Up to 60-pages Web & Doc Summary","AI Chat Folders"],buttonText:"Get Started",isSelected:!1},pro:{planType:"pro",title:"Pro",price:"$9.99",period:"/month",creditsInfo:"60,000 Credits monthly",creditsInfoDescription:"60,000 extra credits first month [LIMITED TIME]",buttonLink:"https://buy.stripe.com/28EdRa2HzdHC3k9g014Ni07",features:["Global Chat Summary (1 every 8h）","Up to 1k Group Chat Summary","Up to 1k Images Summary","Up to 300 min Video & Voice Summary","Up to 300k-characters AI Translation","Up to 300k-characters Grammar Check","Up to 300 pages Web & Doc Summary","Up to 120 Schedule Meetings","Urgent Alert","AI Chat Folders","Priority Support"],buttonText:"Upgrade",isSelected:!0},plus:{planType:"plus",title:"Plus",price:"$19.99",period:"/month",creditsInfo:"120,000 Credits monthly",creditsInfoDescription:"120,000 extra credits first month [LIMITED TIME]",buttonLink:"https://buy.stripe.com/14A3cwbe5fPKcUJ4hj4Ni08",features:["Global Chat Summary (1 every 8h）","Up to 2k Group Chat Summary ","Up to 2k Images Summary ","Up to 600 min Video & Voice Summary","Up to 600k-characters AI Translation","Up to 600k-characters Grammar Check","Up to 600 pages Web & Doc Summary","Unlimited Schedule Meetings","Urgent Alert","AI Chat Folders","Users Portrait","Priority Support"],buttonText:"Upgrade",isSelected:!1}},Dl=(0,n.ph)(({modal:e})=>{const{subscriptionInfo:t}=(0,s.mS)(),{subscriptionType:a}=t,{closePayPackageModal:r,updateSubscriptionInfo:i}=(0,s.ko)(),[o,l]=(0,n.J0)("basic"===a?"pro":"pro"===a||"plus"===a?"plus":"basic"),[c,d]=(0,n.J0)(t);(0,n.vJ)(()=>{e?.isOpen&&(0,gl.GH)().then(({code:e,data:t})=>{if(0===e){d(t);const{subscriptionType:e,creditBalance:a,createdAt:n,subscriptionExpiresAt:s,isExpirated:r}=t;l("basic"===e?"pro":"pro"===e||"plus"===e?"plus":"basic"),i({subscriptionType:e,creditBalance:a,createdAt:n,subscriptionExpiresAt:s,isExpirated:r})}})},[e?.isOpen]);const m=(0,n.hb)(()=>{r()},[r]),u=(0,n.hb)(e=>{const t=Fl[e].buttonLink,a=(0,s.mS)().currentUserId,n=c.subscriptionType;a&&(Rl[e]>Rl[n]?window.open(`${t}?client_reference_id=${a}`,"_blank"):console.warn("只能升级到比当前更高的套餐"),r())},[c.subscriptionType]),A=(0,n.hb)(e=>{l(e)},[]);if(e?.isOpen)return n.Ay.createElement(X.A,{isOpen:e.isOpen,onClose:m,className:Ll.modal},n.Ay.createElement("div",{className:Ll.container},n.Ay.createElement("div",{className:Ll.header},n.Ay.createElement("div",{className:Ll.headerBadge}),n.Ay.createElement("h2",{className:Ll.title},"Upgrade your plan"),n.Ay.createElement(Q.A,{className:Ll.closeButton,name:"close",onClick:m})),n.Ay.createElement("div",{className:Ll.pricingCards},Object.keys(Fl).map(e=>{const t=Fl[e],a=o===e;return n.Ay.createElement("div",{key:e,className:`${Ll.pricingCard} ${a?Ll.selected:""} ${Ll[`card${t.title}`]}`,onClick:()=>A(e)},n.Ay.createElement("div",{className:Ll.topContent},n.Ay.createElement("div",{className:Ll.cardHeader},n.Ay.createElement("h3",{className:Ll.planTitle},t.title)),n.Ay.createElement("div",{className:Ll.pricing},n.Ay.createElement("div",{className:Ll.priceRow},n.Ay.createElement("span",{className:Ll.price},t.price),n.Ay.createElement("span",{className:Ll.period},t.period))),n.Ay.createElement("div",null,n.Ay.createElement("div",{className:Ll.creditsInfo},t.creditsInfo),n.Ay.createElement("div",{className:Ll.creditsInfoDescription},t.creditsInfoDescription)),n.Ay.createElement("button",{className:Ll.upgradeButton,onClick:t=>{t.stopPropagation(),u(e)}},n.Ay.createElement("span",null,c.subscriptionType===e?"Your current plan":"Upgrade"),c.subscriptionType!==e&&n.Ay.createElement(Q.A,{name:"arrow-right"}))),n.Ay.createElement("div",{className:Ll.botInfo},n.Ay.createElement("div",{className:Ll.featuresTitle},"Features included:"),n.Ay.createElement("ul",{className:Ll.features},t.features.map((e,t)=>n.Ay.createElement("li",{key:t,className:Ll.feature},n.Ay.createElement("span",{className:Ll.listdot},n.Ay.createElement(Q.A,{name:"check",className:Ll.checkIcon})),e)))))}))))});var Vl=a(84685),_l=a(89873),Ul=a(5463);const Ol="La4sUYaq",Jl="Bn5kz5br",Kl=(0,n.ph)((0,s.EK)(e=>{const t=e.appConfig?.channelRestrictAdsLevelMin;return{minLevelToRestrictAds:t}})(({modal:e,minLevelToRestrictAds:t})=>{const{closeAboutAdsModal:a}=(0,s.ko)(),r=(0,n.li)(),i=Boolean(e),o=(0,La.A)(e),{canReport:l,randomId:c,additionalInfo:d,sponsorInfo:m}=o||{},u=l,A=(0,La.A)(u),h=(0,B.A)(),y=(0,n.Kr)(()=>n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("h3",null,h("SponsoredMessageInfoScreen.Title")),n.Ay.createElement("p",null,(0,Tt.A)(h("SponsoredMessageInfoDescription1"),["br"])),n.Ay.createElement("p",null,(0,Tt.A)(h("SponsoredMessageInfoDescription2"),["br"])),n.Ay.createElement("p",null,(0,Tt.A)(h("SponsoredMessageInfoDescription3"),["br"])),n.Ay.createElement("p",null,n.Ay.createElement(Vl.A,{url:h("SponsoredMessageAlertLearnMoreUrl"),text:h("SponsoredMessageAlertLearnMoreUrl")})),n.Ay.createElement("p",null,(0,Tt.A)(h("SponsoredMessageInfoDescription4"),["br"]))),[h]),{isContextMenuOpen:p,contextMenuAnchor:g,handleContextMenu:v,handleContextMenuClose:E,handleContextMenuHide:f}=(0,vs.A)(r,!A),b=(0,x.A)(()=>{a(),E(),f()}),C=(0,n.Kr)(()=>{if(i)return{header:n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("h3",{className:Ol},h("AboutRevenueSharingAds")),n.Ay.createElement("p",{className:(0,ue.A)(Jl,"hbsLlXSH")},h("RevenueSharingAdsAlertSubtitle")),n.Ay.createElement(Y.A,{ref:r,round:!0,size:"smaller",color:"translucent",className:"JdN5pGTw",onClick:v},n.Ay.createElement(Q.A,{name:"more"}))),listItemData:[["lock",h("RevenueSharingAdsInfo1Title"),(0,Tt.A)(h("RevenueSharingAdsInfo1Subtitle"),["simple_markdown"])],["revenue-split",h("RevenueSharingAdsInfo2Title"),(0,Tt.A)(h("RevenueSharingAdsInfo2Subtitle"),["simple_markdown"])],["nochannel",h("RevenueSharingAdsInfo3Title"),(0,Tt.A)(h("RevenueSharingAdsInfo3Subtitle",t),["simple_markdown"])]],footer:n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("h3",{className:Ol},(0,Tt.A)(h("RevenueSharingAdsInfo4Title"),["simple_markdown"])),n.Ay.createElement("p",{className:Jl},(0,Tt.A)(h("RevenueSharingAdsInfo4Subtitle2",""),["simple_markdown"]),n.Ay.createElement(Vl.A,{url:h("PromoteUrl"),text:h("LearnMoreArrow")})))}},[i,h,v,t]);return A?n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(Ul.A,{isOpen:i,listItemData:C?.listItemData,headerIconName:"channel",withSeparator:!0,header:C?.header,footer:C?.footer,buttonText:h("RevenueSharingAdsUnderstood"),onClose:b}),g&&c&&n.Ay.createElement(_l.A,{isOpen:p,anchor:g,triggerRef:r,randomId:c,additionalInfo:d,canReport:l,sponsorInfo:m,shouldSkipAbout:!0,onItemClick:b,onClose:E,onCloseAnimationEnd:f})):n.Ay.createElement(X.A,{isOpen:i,className:"LFkgLoAk",contentClassName:"TZE15Pt_",onClose:b},y,n.Ay.createElement(Y.A,{size:"smaller",onClick:b},h("RevenueSharingAdsUnderstood")))})),Gl="t9iZUzOj",jl=(0,n.ph)(({isOpen:e,onClose:t})=>{const a=(0,B.A)(),s=(0,Ua.A)(),r=(0,n.Kr)(()=>{const e=a("LearnMore");return s("ChannelEarnLearnCoinAbout",{link:n.Ay.createElement(Vl.A,{url:a("MonetizationInfoTONLink"),text:e},e,n.Ay.createElement(Q.A,{name:"next"}))},{withNodes:!0})},[s,a]),i=(0,n.Kr)(()=>s("MonetizationInfoTONTitle",void 0,{withNodes:!0,specialReplacement:{"💎":n.Ay.createElement(Q.A,{className:"ATkOSqJ7",name:"toncoin"})}}),[s]),o=(0,n.Kr)(()=>{if(e)return{header:n.Ay.createElement("h3",{className:Gl},a("lng_channel_earn_learn_title")),listItemData:[["channel",a("lng_channel_earn_learn_in_subtitle"),(0,Tt.A)(a("lng_channel_earn_learn_in_about"),["simple_markdown"])],["revenue-split",a("lng_channel_earn_learn_split_subtitle"),(0,Tt.A)(a("Monetization.Intro.Split.Text"),["simple_markdown"])],["cash-circle",a("lng_channel_earn_learn_out_subtitle"),(0,Tt.A)(a("lng_channel_earn_learn_out_about"),["simple_markdown"])]],footer:n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("h3",{className:Gl},i),n.Ay.createElement("p",{className:"mjveZmdr"},r))}},[e,a,i,r]);if(o)return n.Ay.createElement(Ul.A,{isOpen:e,listItemData:o.listItemData,headerIconName:"cash-circle",withSeparator:!0,header:o.header,footer:o.footer,buttonText:a("RevenueSharingAdsUnderstood"),onClose:t})});var zl=a(15535);const Hl="oofoCYlu",$l=(0,n.ph)((0,s.EK)(e=>{const{twoFaSettings:{hint:t}}=e;return{passwordHint:t}})(({modal:e,passwordHint:t})=>{const{closeMonetizationVerificationModal:a,clearMonetizationVerificationError:r,processMonetizationRevenueWithdrawalUrl:i}=(0,s.ko)(),o=Boolean(e),l=(0,La.A)(e),c=(0,Ua.A)(),[d,m]=(0,n.J0)(!1),u=(0,x.A)(e=>{l&&i({peerId:l.chatId,currentPassword:e})}),A=(0,x.A)(()=>{r()}),h=(0,x.A)(()=>{a()});return n.Ay.createElement(X.A,{isOpen:o,hasCloseButton:!0,title:c("CheckPasswordTitle"),className:"WqeWhMAS",contentClassName:Hl,onClose:h},n.Ay.createElement("div",{className:(0,ue.A)(Hl,"settings-content password-form custom-scroll")},n.Ay.createElement("div",{className:"settings-item pt-0"},n.Ay.createElement(zl.A,{shouldShowSubmit:!0,placeholder:c("CheckPasswordPlaceholder"),error:l?.errorKey&&c.withRegular(l.errorKey),description:c("CheckPasswordDescription"),clearError:A,isLoading:l?.isLoading,hint:t,isPasswordVisible:d,shouldResetValue:o,onChangePasswordVisibility:m,onSubmit:u}))))})),ql={content:"MKdSUg2P",chatItem:"qEIwBtp0"},Wl=(0,n.ph)((0,s.EK)(e=>{const t=(0,c.mBe)(e,e.currentUserId),a=(0,c.g29)(e);return{currentUser:t,stickerSet:e.defaultStatusIconsId?(0,c.ycM)(e,e.defaultStatusIconsId):void 0,isPremium:a,isAccountFrozen:(0,c.trm)(e)}})(({modal:e,currentUser:t,stickerSet:a,isPremium:r,isAccountFrozen:i})=>{const{closeEmojiStatusAccessModal:o,toggleUserEmojiStatusPermission:c,sendWebAppEvent:d,openPremiumModal:m,loadDefaultStatusIcons:u}=(0,s.ko)(),A=Boolean(e),h=(0,B.A)(),y=(0,Ua.A)(),p=(0,n.li)(),[g,v]=(0,n.J0)(0);(0,n.vJ)(()=>{!A||a?.stickers||i||u()},[A,a,i]);const E=(0,n.Kr)(()=>{if(t&&a?.stickers)return{...t,emojiStatus:{type:"regular",documentId:a.stickers[g].id}}},[t,a,g]),f=a?.stickers?.length;(0,gs.A)(()=>{f&&v(e=>(e+1)%f)},f?3200:void 0);const b=(0,x.A)(()=>n.Ay.createElement(Oo.A,{withEmojiStatus:!0,className:ql.chatItem,itemClassName:ql.itemName,mockPeer:E})),C=(0,x.A)(()=>{e?.bot?.id&&(o(),e?.webAppKey&&(r?(d({webAppKey:e.webAppKey,event:{eventType:"emoji_status_access_requested",eventData:{status:"allowed"}}}),c({botId:e.bot.id,isEnabled:!0,isBotAccessEmojiGranted:!0})):(m(),d({webAppKey:e.webAppKey,event:{eventType:"emoji_status_access_requested",eventData:{status:"cancelled"}}}))))}),S=(0,x.A)(()=>{e?.bot?.id&&(o(),e?.webAppKey&&d({webAppKey:e.webAppKey,event:{eventType:"emoji_status_access_requested",eventData:{status:"cancelled"}}}),r&&c({botId:e.bot.id,isEnabled:!1}))}),k=(0,x.A)(()=>{if(e?.bot)return y("EmojiStatusAccessText",{name:(0,l.Yg)(e?.bot)},{withNodes:!0,withMarkdown:!0})});return n.Ay.createElement(X.A,{className:(0,ue.A)("confirm"),contentClassName:ql.content,isOpen:A,onClose:S},b(),n.Ay.createElement("div",null,k(),n.Ay.createElement("div",{className:"dialog-buttons mt-2",ref:p},n.Ay.createElement(Y.A,{className:"confirm-dialog-button",isText:!0,onClick:C,color:"primary"},h("lng_bot_allow_write_confirm")),n.Ay.createElement(Y.A,{className:"confirm-dialog-button",isText:!0,onClick:S},y("Cancel")))))})),Ql=(0,n.ph)((0,s.EK)(e=>({currentUser:(0,c.mBe)(e,e.currentUserId)}))(({modal:e,currentUser:t})=>{const{closeLocationAccessModal:a,toggleUserLocationPermission:r,sendWebAppEvent:i}=(0,s.ko)(),o=Boolean(e),c=(0,B.A)(),d=(0,Ua.A)(),m=(0,n.li)(),u=(0,x.A)(async()=>{const t=await(0,E.Bu)(),{geolocation:n}=t;e?.bot?.id&&(a(),e?.webAppKey&&(r({botId:e.bot.id,isAccessGranted:!0}),i({webAppKey:e.webAppKey,event:{eventType:"location_requested",eventData:{available:!0,latitude:n?.latitude,longitude:n?.longitude,altitude:n?.altitude,course:n?.heading,speed:n?.speed,horizontal_accuracy:n?.accuracy,vertical_accuracy:n?.accuracy}}})))}),A=(0,x.A)(()=>{e?.bot?.id&&(a(),e?.webAppKey&&(r({botId:e.bot.id,isAccessGranted:!1}),i({webAppKey:e.webAppKey,event:{eventType:"location_requested",eventData:{available:!1}}})))}),h=(0,x.A)(()=>{if(e?.bot)return n.Ay.createElement("div",{className:"CGPoDaLo"},n.Ay.createElement(xt.A,{size:"large",peer:t}),n.Ay.createElement(Q.A,{name:"next",className:"pzERgD5x"}),n.Ay.createElement(xt.A,{size:"large",peer:e.bot}))}),y=(0,x.A)(()=>{if(e?.bot)return d("LocationPermissionText",{name:(0,l.Yg)(e?.bot)},{withNodes:!0,withMarkdown:!0})});return n.Ay.createElement(X.A,{className:(0,ue.A)("confirm"),isOpen:o,onClose:A},h(),n.Ay.createElement("div",null,y(),n.Ay.createElement("div",{className:"dialog-buttons mt-2",ref:m},n.Ay.createElement(Y.A,{className:"confirm-dialog-button",isText:!0,onClick:u,color:"primary"},c("lng_bot_allow_write_confirm")),n.Ay.createElement(Y.A,{className:"confirm-dialog-button",isText:!0,onClick:A},d("Cancel")))))})),Yl="qJDgUtjV",Zl=(0,n.ph)(({modal:e})=>{const{reportSponsored:t,closeReportAdModal:a,openPreviousReportAdModal:r}=(0,s.ko)(),i=(0,B.A)(),l=Boolean(e),c=(0,n.li)(),d=(0,x.A)((a,n)=>{const{chatId:s,randomId:r}=e;t({peerId:s,randomId:r,option:n})}),[m,u]=(0,n.Kr)(()=>{if(!e)return[void 0,0];const t=e.sections.length-1;return[e.sections[t],t]},[e]),A=(0,x.A)(()=>{u?r():a()}),h=(0,n.Kr)(()=>{if(!e)return;const t=i("lng_report_sponsored_reported_learn").split("{link}");return[t[0],n.Ay.createElement(Vl.A,{text:i("lng_report_sponsored_reported_link"),url:i("ReportAd.Help_URL")}),t[1]]},[i,e]),y=(0,n.Kr)(()=>{if(!e)return;const t=Boolean(m?.subtitle);return n.Ay.createElement("div",{className:"modal-header-condensed"},n.Ay.createElement(Y.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:i(u?"Back":"Close"),onClick:A},n.Ay.createElement(Q.A,{name:u?"arrow-left":"close"})),n.Ay.createElement("div",{className:(0,ue.A)("modal-title","ZAdG13Ah",t&&"lVVyV0py")},n.Ay.createElement("h3",{className:"mMmY6YR4"},i("ReportAd")),t&&n.Ay.createElement("span",{className:"gSkAFc4u"},m.subtitle)))},[i,e,u,m?.subtitle]);(0,n.vJ)(()=>{if(!e)return;const t=document.querySelector(`.${ne.uo} > .${Yl}`);if(!t)return;const a=t.scrollHeight;(0,o.RK)(()=>{c.current.style.height=`${a+56}px`})},[e]);const p=(0,x.A)(()=>{const e=document.querySelector(`.${ne.VY} > .${Yl}`);(0,o.YS)(()=>{const t=e.scrollHeight;(0,o.RK)(()=>{c.current.style.height=`${t+56}px`})})});return n.Ay.createElement(X.A,{isOpen:l,hasCloseButton:!0,className:"njPBcVYr",header:y,onClose:a},n.Ay.createElement(ne.Ay,{name:"slide",className:"HjsGIG6e",ref:c,activeKey:u,onStart:p},n.Ay.createElement("div",{className:Yl},n.Ay.createElement("h3",{className:"jrA2dOiw"},m?.title),m?.options.map(e=>n.Ay.createElement(ca.A,{narrow:!0,secondaryIcon:"next",className:"aFbjDzNo",buttonClassName:"VbE0HzDs",clickArg:e.option,onClick:d},n.Ay.createElement("div",{className:"oWujoaSC"},e.text)))),n.Ay.createElement("p",{className:"k71Zrc_P"},h)))});var Xl=a(94079);const ec="kq9LwNTZ",tc=(0,n.ph)(({modal:e})=>{const{reportMessages:t,reportStory:a,closeReportModal:r,openPreviousReportModal:i}=(0,s.ko)(),l=(0,B.A)(),c=Boolean(e),d=(0,n.li)(),[m,u]=(0,n.J0)(""),A=(0,x.A)((n,s)=>{const{messageIds:r,subject:i,peerId:o,chatId:l}=e;if(r)switch(i){case"message":t({chatId:l,messageIds:r,option:s});break;case"story":a({storyId:r[0],peerId:o,option:s})}}),[h,y]=(0,n.Kr)(()=>{if(!e)return[void 0,0];const t=e.sections.length-1;return[e?.sections[t],t]},[e]),p=(0,x.A)(()=>{i()}),g=(0,x.A)(()=>{r()}),v=(0,n.Kr)(()=>{if(!e)return;const t=Boolean(h?.subtitle);return n.Ay.createElement("div",{className:"modal-header-condensed"},y?n.Ay.createElement(Y.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:l("Back"),onClick:p},n.Ay.createElement(Q.A,{name:"arrow-left"})):n.Ay.createElement(Y.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:l("Close"),onClick:g},n.Ay.createElement(Q.A,{name:"close"})),n.Ay.createElement("div",{className:(0,ue.A)("modal-title","Lj_ezEWU",t&&"OYFbu8fQ")},n.Ay.createElement("h3",{className:(0,ue.A)("QawchdxB",y&&"CV7kzv9H")},h?.options?l("story"===e?.subject?"ReportStory":"Report"):h?.title),t&&n.Ay.createElement("span",{className:"OUFckTb7"},h.subtitle)))},[l,e,y,h?.options,h?.subtitle,h?.title]),E=(0,x.A)(e=>{u(e.target.value)});(0,n.vJ)(()=>{if(!e)return;const t=document.querySelector(`.${ne.uo} > .${ec}`);if(!t)return;const a=t.scrollHeight;(0,o.RK)(()=>{d.current.style.height=`${a}px`})},[e]);const f=(0,x.A)(()=>{const e=document.querySelector(`.${ne.VY} > .${ec}`);(0,o.YS)(()=>{const t=e.scrollHeight;(0,o.RK)(()=>{d.current.style.height=`${t+20}px`})})}),b=(0,x.A)(()=>{u(""),r()}),C=(0,x.A)(()=>{const{messageIds:n,subject:s,peerId:r,chatId:i}=e;switch(s){case"message":t({chatId:i,messageIds:n,option:h?.option,description:m});break;case"story":a({storyId:n?.[0],peerId:r,option:h?.option,description:m})}b()});return n.Ay.createElement(X.A,{isOpen:c,header:v,onClose:b,contentClassName:"tNysQgHL",className:(0,ue.A)("E1bGWeON","story"===e?.subject&&"component-theme-dark")},n.Ay.createElement(ne.Ay,{name:"slide",className:"n2VxPirU",ref:d,activeKey:y,onStart:f},n.Ay.createElement("div",{className:ec},h?.options?n.Ay.createElement("h3",{className:"GSfUuTet"},h?.title):void 0,h?.options?.map(e=>n.Ay.createElement(ca.A,{narrow:!0,nonInteractive:!0,secondaryIcon:"next",className:"RoxwMzvA",buttonClassName:"Z6skYdvb",clickArg:e.option,onClick:A},n.Ay.createElement("div",{className:"FU8m6NUU"},e.text))),h?.option?n.Ay.createElement("div",{className:"KpptZ3Mk"},n.Ay.createElement(So.A,{tgsUrl:Co.w.Report,size:100,className:"kO8JC4gK",nonInteractive:!0,forceAlways:!0,noLoop:!1}),n.Ay.createElement(Xl.A,{id:"option",className:"yc3szGcx",label:h.isOptional?l("Report2CommentOptional"):l("Report2Comment"),onChange:E,value:m,maxLength:512,maxLengthIndicator:(512-m.length).toString(),noReplaceNewlines:!0}),n.Ay.createElement(Y.A,{size:"smaller",onClick:C,disabled:h.isOptional?void 0:!m.length},l("ReportSend"))):void 0)))});var ac=a(65632),nc=a(54172);const sc=(0,n.ph)((0,s.EK)((e,{modal:t})=>{const a=(0,c.SJA)(e),{isBlurred:n,patternColor:s,background:r,backgroundColor:i}=(0,c.Gyz)(e,a)||{};return{theme:a,isBackgroundBlurred:n,patternColor:s,customBackground:r,backgroundColor:i,bot:t?(0,c.mBe)(e,t?.botId):void 0,currentUserId:e.currentUserId}})(({modal:e,theme:t,isBackgroundBlurred:a,patternColor:r,customBackground:i,backgroundColor:o,bot:c})=>{const{closePreparedInlineMessageModal:d,sendWebAppEvent:m,openSharePreparedMessageModal:u}=(0,s.ko)(),A=(0,Ua.A)(),h=Boolean(e),{webAppKey:y,message:p,botId:g}=e||{},v=(0,n.li)(),E=(0,ac.A)(t,i),f=(0,x.A)(()=>{y&&g&&p&&(u({webAppKey:y,message:p}),d())}),b=(0,x.A)(()=>{d(),y&&m({webAppKey:y,event:{eventType:"prepared_message_failed",eventData:{error:"USER_DECLINED"}}})}),C=(0,n.Kr)(()=>{if(e)return n.Ay.createElement("div",{className:"P1fPh6h8"},n.Ay.createElement(Y.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:A("Close"),onClick:b},n.Ay.createElement(Q.A,{name:"close"})),n.Ay.createElement("h3",{className:(0,ue.A)("modal-title","E42tgAwD")},A("BotShareMessage")))},[A,e]),S=(0,n.Kr)(()=>{if(g&&p&&y)return(0,l.i7)(g,p)},[g,p,y]),k=(0,ue.A)("_6w75ldP","lElCwweL",i&&"CZkpv8n0",o&&"VJAYrDF_",i&&a&&"m8xzfVvU");return n.Ay.createElement(X.A,{dialogRef:v,isOpen:h,header:C,onClose:b,className:"Rzj2LMLf",contentClassName:"Ve4u2KVI"},n.Ay.createElement("div",{className:(0,ue.A)("McJgXCtB","MessageList"),inert:!0,style:(0,Ta.A)(`--pattern-color: ${r}`,o&&`--theme-background-color: ${o}`)},n.Ay.createElement("div",{className:k,style:E?`--custom-background: ${E}`:void 0}),S&&n.Ay.createElement(nc.A,{key:g,message:S,threadId:J.l3,messageListType:"thread",noComments:!0,noReplies:!0,appearanceOrder:0,isJustAdded:!1,isFirstInGroup:!0,isLastInGroup:!0,isLastInList:!1,isFirstInDocumentGroup:!1,isLastInDocumentGroup:!1})),n.Ay.createElement("div",{className:"pNSCKAVN"},n.Ay.createElement("p",{className:"xWnXsG7q"},A("WebAppShareMessageInfo",{user:(0,l.Yg)(c)})),n.Ay.createElement(Y.A,{size:"smaller",onClick:f},A("BotShareMessageShare"))))}));var rc=a(20247),ic=a(48227);const oc=(0,n.ph)((0,s.EK)(e=>{const t=(0,c.nTw)(e),{isPaymentMessageConfirmDialogOpen:a}=t;return{isPaymentMessageConfirmDialogOpen:a,starsBalance:e.stars?.balance.amount||0,isStarsBalanceModalOpen:Boolean(t.starsBalanceModal)}})(({modal:e,isPaymentMessageConfirmDialogOpen:t,isStarsBalanceModalOpen:a,starsBalance:r})=>{const{closeSharePreparedMessageModal:i,sendInlineBotResult:o,sendWebAppEvent:l,showNotification:d,updateSharePreparedMessageModalSendArgs:m}=(0,s.ko)(),u=(0,B.A)(),A=Boolean(e),[h,y,p]=(0,M.A)();(0,n.vJ)(()=>{A&&y()},[A,y]);const{message:g,filter:v,webAppKey:E,pendingSendArgs:f}=e||{},{starsForSendMessage:b}=f||{},{closeConfirmDialog:C,dialogHandler:S,shouldAutoApprove:k,setAutoApprove:w,handleWithConfirmation:N}=(0,rc.A)(b||0,a,r),I=(0,x.A)(()=>{i(),E&&l({webAppKey:E,event:{eventType:"prepared_message_failed",eventData:{error:"USER_DECLINED"}}})}),P=(0,x.A)((e,t)=>{if(g&&E){const a=(0,s.mS)(),n=(0,c.PVB)(a,e);o({chatId:e,threadId:t||J.l3,id:g.result.id,queryId:g.result.queryId}),b||d({message:u("BotSharedToOne",(0,Mt.F9)(u,n))}),l({webAppKey:E,event:{eventType:"prepared_message_sent"}}),i(),m({args:void 0})}}),T=(0,x.A)((e,t)=>{m({args:{peerId:e,threadId:t}})}),L=(0,x.A)(()=>{f&&N(P,f.peerId,f.threadId)}),R=(0,x.A)(()=>{C(),m({args:void 0})});(0,n.vJ)(()=>{f&&L()},[f]);const F=(0,s.mS)(),D=f?(0,c.PVB)(F,f.peerId):void 0,V=D?(0,Mt.F9)(u,D):void 0;if(A||h)return n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(Gn,{isOpen:A,searchPlaceholder:u("Search"),filter:v,onSelectRecipient:T,onClose:I,onCloseAnimationEnd:p,isLowStackPriority:!0}),n.Ay.createElement(ic.A,{isOpen:t,onClose:R,userName:V,messagePriceInStars:b||0,messagesCount:1,shouldAutoApprove:k,setAutoApprove:w,confirmHandler:S}))}));var lc=a(19408);const cc={content:"iGABsB4C",modalHeader:"Ofq4u4pq",section:"k44LZ99u",form:"VhNBPaMY",label:"anDcU5bi",input:"kYxuUcwe",description:"A_JjwhXv",timeInputIcon:"pHne2E6K",offerButton:"d_PCM2tC",currencySelector:"genSNudF",currencyIcon:"fT5aRs0H"},dc=(0,n.ph)((0,s.EK)((e,{modal:t})=>{const a=e.stars?.balance,n=t?(0,c.PVB)(e,t.chatId):void 0,s=t?(0,lc.GA)(e,t.chatId,J.l3):void 0,{appConfig:r}=e,o=r?.starsSuggestedPostAmountMax||i.PAU,l=r?.starsSuggestedPostAmountMin||i.tek,d=r?.starsSuggestedPostAgeMin||i.Qep,m=r?.starsSuggestedPostFutureMin||i.WHU,u=r?.starsSuggestedPostFutureMax||i.cX7,A=r?.tonSuggestedPostAmountMax||i.nqT,h=r?.tonSuggestedPostAmountMin||i.tOS,y=!!t&&(0,c.ODG)(e,t.chatId);return{peer:n,starBalance:a,tonBalance:e.ton?.balance?.amount,currentDraft:s,maxStarsAmount:o,minStarsAmount:l,tonMaxAmount:A,tonMinAmount:h,ageMinSeconds:d,futureMin:m,futureMax:u,isMonoforumAdmin:y}})(({modal:e,starBalance:t,tonBalance:a,peer:r,currentDraft:o,maxStarsAmount:l,minStarsAmount:c,tonMaxAmount:d,tonMinAmount:m,ageMinSeconds:u,futureMin:A,futureMax:h,isMonoforumAdmin:y})=>{const{closeSuggestMessageModal:p,updateDraftSuggestedPostInfo:g,openStarsBalanceModal:v}=(0,s.ko)(),[E,f,b]=(0,M.A)(),C=o?.suggestedPostInfo,S=o?.replyInfo,k=Boolean(S),[w,N]=(0,n.J0)(C?.price?.amount||void 0),[I,P]=(0,n.J0)(C?.price?.currency||i.OUy),[T,L]=(0,n.J0)(C?.scheduleDate?1e3*C.scheduleDate:void 0);(0,n.vJ)(()=>{const e=C?.price,t=e?.currency===i.ykW?(0,mr.wD)(e.amount):e?.amount;N(t),P(C?.price?.currency||i.OUy),L(C?.scheduleDate?1e3*C.scheduleDate:void 0)},[C]);const R=(0,Ua.A)(),F=(0,B.A)(),D=I===i.OUy,V=Math.floor(Date.now()/1e3),_=1e3*(V+A),U=1e3*(V+h),O=1e3*(V+2*A),J=(0,x.A)(e=>{const t=e.target.value,a=parseFloat(t),n=""===t||Number.isNaN(a)?void 0:Math.min(Math.max(a,0),z);N(n)}),K=(0,x.A)(e=>{L(e.getTime()),b()}),G=(0,x.A)(()=>{L(void 0),b()}),j=D?c:(0,mr.wD)(m),z=D?l:(0,mr.wD)(d),H=Boolean(w)&&w<j,$=(0,x.A)(()=>{const e=w?D?w:(0,mr.tT)(w):0;if(!H){if(!y)if(D){if(e>(t?.amount||0))return void v({topup:{balanceNeeded:e}})}else if(e>(a||0))return void v({currency:i.ykW});g({price:{currency:I,amount:e,nanos:0},scheduleDate:T?T/1e3:void 0}),p()}});return n.Ay.createElement(X.A,{headerClassName:cc.modalHeader,isOpen:Boolean(e),onClose:p,isSlim:!0,isLowStackPriority:!0,hasCloseButton:!0,contentClassName:cc.content,title:R(k?"TitleSuggestedChanges":"TitleSuggestMessage")},n.Ay.createElement("div",{className:cc.form},n.Ay.createElement("div",{className:cc.section},n.Ay.createElement("div",{className:cc.currencySelector},n.Ay.createElement(Y.A,{className:cc.currencyButton,color:D?"primary":"translucent",pill:!0,fluid:!0,size:"tiny",noFastClick:!0,onClick:()=>P(i.OUy)},n.Ay.createElement(Q.A,{name:"star",className:cc.currencyIcon}),R("CurrencyStars")),n.Ay.createElement(Y.A,{className:cc.currencyButton,fluid:!0,color:D?"translucent":"primary",pill:!0,size:"tiny",noFastClick:!0,onClick:()=>P(i.ykW)},n.Ay.createElement(Q.A,{name:"toncoin",className:cc.currencyIcon}),R("CurrencyTon"))),n.Ay.createElement(Z.A,{label:R("InputPlaceholderPrice"),className:(0,ue.A)(cc.input),value:w?.toString(),onChange:J,inputMode:"numeric",tabIndex:0,teactExperimentControlled:D}),n.Ay.createElement("div",{className:cc.description},void 0!==w&&w>0&&w<j?R("DescriptionSuggestedPostMinimumOffer",{amount:D?(0,Da.Kk)(R,j):(0,Da.QH)(R,j)},{withNodes:!0,withMarkdown:!0}):R(D?"SuggestMessagePriceDescriptionStars":"SuggestMessagePriceDescriptionTon"))),n.Ay.createElement("div",{className:cc.section},n.Ay.createElement("div",{className:(0,ue.A)(cc.input,"input-group","touched")},n.Ay.createElement("input",{type:"text",className:(0,ue.A)("form-control",E&&"focus"),value:T?(0,$e.e0)(T/1e3,R,F):R("SuggestMessageAnytime"),autoComplete:"off",onClick:f,onFocus:f,readOnly:!0}),n.Ay.createElement("label",null,R("InputTitleSuggestMessageTime")),n.Ay.createElement(Q.A,{name:"down",className:cc.timeInputIcon})),n.Ay.createElement("div",{className:cc.description},R("SuggestMessageTimeDescription",{hint:R("SuggestMessageDateTimeHint"),duration:(0,$e.A$)(R,u,!0)}))),n.Ay.createElement(cs,{isOpen:E,isFutureMode:!0,withTimePicker:!0,minAt:_,maxAt:U,onClose:b,onSubmit:K,selectedAt:T||O,submitButtonLabel:R("Save"),secondButtonLabel:R("SuggestMessageAnytime"),onSecondButtonClick:G,description:R("SuggestMessageDateTimeHint")}),n.Ay.createElement(Y.A,{className:cc.offerButton,onClick:$,size:"smaller",disabled:H},k?R("ButtonUpdateTerms"):w?R("ButtonOfferAmount",{amount:D?(0,Da.U2)(R,w,{asFont:!0}):(0,Da.Ms)(R,w)},{withNodes:!0,withMarkdown:!0}):R("ButtonOfferFree"))))})),mc="xqyFGV8R",uc=(0,n.ph)((0,s.EK)((e,{modal:t})=>{const a=t&&(0,c.O5q)(e,t.chatId,t.messageId),n=a?(0,c.Y7C)(e,a):void 0,s=t&&(0,c.ODG)(e,t.chatId),{appConfig:r}=e,o=r?.starsSuggestedPostCommissionPermille||i.U$s,l=r?.tonSuggestedPostCommissionPermille||i.UdF,d=r?.starsSuggestedPostAgeMin||i.Qep,m=2*(r?.starsSuggestedPostFutureMin||i.WHU),u=r?.starsSuggestedPostFutureMax||i.cX7,A=a?.suggestedPostInfo?.scheduleDate;return{minAge:d,futureMin:m,futureMax:u,message:a,sender:n,isAdmin:s,commissionPermille:o,tonCommissionPermille:l,scheduleDate:A}})(({modal:e,message:t,sender:a,isAdmin:r,commissionPermille:o,tonCommissionPermille:l,minAge:c,futureMin:d,futureMax:m,scheduleDate:u})=>{const{closeSuggestedPostApprovalModal:A,approveSuggestedPost:h}=(0,s.ko)(),y=(0,Ua.A)(),p=(0,B.A)(),[g,v,E]=(0,M.A)(),f=Math.floor(Date.now()/1e3),b=1e3*(f+d),C=1e3*(f+m),S=f+2*d,[k,w]=(0,n.J0)(S),N=(0,x.A)(()=>{A()}),I=(0,x.A)(t=>{e&&(h({chatId:e.chatId,messageId:e.messageId,scheduleDate:t}),A())}),P=(0,x.A)(e=>{const t=Math.floor(e.getTime()/1e3);w(t)}),T=(0,x.A)(e=>{const t=Math.floor(e.getTime()/1e3);E(),I(t)}),L=(0,x.A)(()=>{E(),I()}),R=(0,x.A)(()=>{u?I(u):v()});if(!e||!t)return;const F=a?(0,Mt.em)(p,a):"";return n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(ya.A,{isOpen:Boolean(e)&&!g,onClose:N,title:y("SuggestedPostConfirmTitle"),confirmHandler:R,confirmLabel:y(u?"ButtonPublish":"Next")},(()=>{const e=t?.suggestedPostInfo?.price,a=e?.amount,s=e?.currency||i.OUy,d=y("SuggestedPostConfirmMessage",{peer:F},{withNodes:!0,withMarkdown:!0}),m=(0,Tt.A)(d);if(!a)return m;const A=(s===i.ykW?l:o)/10,h=a/100*A,g=s===i.ykW?(0,Da.QH)(y,(0,mr.wD)(h)):(0,Da.Kk)(y,h),v=c,E=(0,$e.A$)(y,v,!0);if(u){const e=(0,$e.e0)(u,y,p),t=r?"SuggestedPostConfirmDetailsWithTimeAdmin":"SuggestedPostConfirmDetailsWithTimeUser";return n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",null,m),n.Ay.createElement("div",{className:mc},(0,Tt.A)(y(t,{amount:g,commission:A,duration:E,time:e},{withNodes:!0,withMarkdown:!0}))))}const f=r?"SuggestedPostConfirmDetailsAdmin":"SuggestedPostConfirmDetailsUser";return n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",null,m),n.Ay.createElement("div",{className:mc},(0,Tt.A)(y(f,{amount:g,commission:A,duration:E},{withNodes:!0,withMarkdown:!0}))))})()),n.Ay.createElement(cs,{isOpen:g,isFutureMode:!0,withTimePicker:!0,minAt:b,maxAt:C,onClose:E,onSubmit:T,onDateChange:P,selectedAt:1e3*k,submitButtonLabel:y("ButtonPublishAtTime",{time:(0,$e.e0)(k,y,p)}),secondButtonLabel:y("PublishNow"),onSecondButtonClick:L,description:y("SuggestMessageDateTimeHint")}))})),Ac=["embedLinks","sendPolls","sendPhotos","sendVideos","sendRoundvideos","sendVoices","sendAudios","sendDocs","sendStickers","sendGifs"],hc=[...Ac,"sendPlain"];function yc(e){const[t,a]=(0,n.J0)({}),[s,r]=(0,n.J0)(!1),[i,o]=(0,n.J0)(!1);(0,n.vJ)(()=>{a(e||{}),r(!1),setTimeout(()=>{o(!1)},250)},[e]);const l=(0,n.hb)(n=>{const{name:s}=n.target,i=s;function o(e){return!e||void 0}const l=t;let c={...l,[i]:o(l[i]),..."sendStickers"===i&&{sendGifs:o(l[i])}};const d=()=>{const e=Ac.map(e=>c[e]);e.some(e=>!e)?c={...c,sendMedia:void 0}:e.every(Boolean)&&(c={...c,sendMedia:!0})};"sendMedia"!==i?d():c={...c,...Ac.reduce((e,t)=>Object.assign(e,{[t]:c.sendMedia}),{})},"embedLinks"!==i&&!c.embedLinks&&c.sendPlain&&(c={...c,embedLinks:!0}),"sendPlain"!==i&&!c.embedLinks&&c.sendPlain&&(c={...c,sendPlain:void 0}),"sendMedia"!==i&&d();const m=hc.every(e=>c[e]);c={...c,sendMessages:!!m||void 0},a(c),r(!e||Object.keys(c).some(t=>{const a=t;return Boolean(e[a])!==Boolean(c[a])}))},[e,t]),c=(0,n.hb)(()=>{a(e||{}),r(!1)},[e]);return{permissions:t,isLoading:i,havePermissionChanged:s,handlePermissionChange:l,setIsLoading:o,resetPermissions:c}}const pc=["sendPhotos","sendVideos","sendStickers","sendAudios","sendDocs","sendVoices","sendRoundvideos","embedLinks","sendPolls"],gc=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const a=t?(0,c.hds)(e,t):void 0,n=a&&(0,c.AWZ)(e,a.id);return{chat:a,hasLinkedChat:Boolean(n?.linkedChatId)}})(({chat:e,isMediaDropdownOpen:t,setIsMediaDropdownOpen:a,hasLinkedChat:r,permissions:i,handlePermissionChange:o,className:c,shiftedClassName:d,dropdownClassName:m,withCheckbox:u,getControlIsDisabled:A,permissionGroup:h})=>{const{showNotification:y}=(0,s.ko)(),{isForum:p}=e||{},g=(0,B.A)(),v=(0,n.Kr)(()=>e&&(0,l.gA)(e),[e]),E=r||v,b=(0,n.Kr)(()=>pc.reduce((e,t)=>(i[t]||(e+=1),e),0),[i]),C=(0,x.A)(e=>{(0,f.A)(e),a(!t)}),S=(0,x.A)(()=>{y({message:g("lng_rights_permission_unavailable")})});return n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:(0,ue.A)("ListItem",u&&"with-checkbox")},n.Ay.createElement(as.A,{name:"sendPlain",checked:!i.sendPlain,label:g("UserRestrictionsSend"),blocking:!0,permissionGroup:h,onChange:o,disabled:A&&A("sendPlain")})),n.Ay.createElement("div",{className:(0,ue.A)("ListItem",u&&"with-checkbox")},n.Ay.createElement(as.A,{name:"sendMedia",checked:!i.sendMedia,label:g("UserRestrictionsSendMedia"),labelText:`${b}/${pc.length}`,blocking:!0,permissionGroup:h,rightIcon:t?"up":"down",onChange:o,onClickLabel:C,disabled:A&&A("sendMedia")})),n.Ay.createElement("div",{className:m},n.Ay.createElement("div",{className:c},n.Ay.createElement("div",{className:(0,ue.A)("ListItem",u&&"with-checkbox")},n.Ay.createElement(as.A,{name:"sendPhotos",checked:!i.sendPhotos,label:g("UserRestrictionsSendPhotos"),blocking:!0,permissionGroup:h,onChange:o,disabled:A&&A("sendPhotos")})),n.Ay.createElement("div",{className:(0,ue.A)("ListItem",u&&"with-checkbox")},n.Ay.createElement(as.A,{name:"sendVideos",checked:!i.sendVideos,label:g("UserRestrictionsSendVideos"),blocking:!0,permissionGroup:h,onChange:o,disabled:A&&A("sendVideos")})),n.Ay.createElement("div",{className:(0,ue.A)("ListItem",u&&"with-checkbox")},n.Ay.createElement(as.A,{name:"sendStickers",checked:!i.sendStickers&&!i.sendGifs,label:g("UserRestrictionsSendStickers"),blocking:!0,permissionGroup:h,onChange:o,disabled:A&&A("sendStickers")})),n.Ay.createElement("div",{className:(0,ue.A)("ListItem",u&&"with-checkbox")},n.Ay.createElement(as.A,{name:"sendAudios",checked:!i.sendAudios,label:g("UserRestrictionsSendMusic"),blocking:!0,permissionGroup:h,onChange:o,disabled:A&&A("sendAudios")})),n.Ay.createElement("div",{className:(0,ue.A)("ListItem",u&&"with-checkbox")},n.Ay.createElement(as.A,{name:"sendDocs",checked:!i.sendDocs,label:g("UserRestrictionsSendFiles"),blocking:!0,permissionGroup:h,onChange:o,disabled:A&&A("sendDocs")})),n.Ay.createElement("div",{className:(0,ue.A)("ListItem",u&&"with-checkbox")},n.Ay.createElement(as.A,{name:"sendVoices",checked:!i.sendVoices,label:g("UserRestrictionsSendVoices"),blocking:!0,permissionGroup:h,onChange:o,disabled:A&&A("sendVoices")})),n.Ay.createElement("div",{className:(0,ue.A)("ListItem",u&&"with-checkbox")},n.Ay.createElement(as.A,{name:"sendRoundvideos",checked:!i.sendRoundvideos,label:g("UserRestrictionsSendRound"),blocking:!0,permissionGroup:h,onChange:o,disabled:A&&A("sendRoundvideos")})),n.Ay.createElement("div",{className:(0,ue.A)("ListItem",u&&"with-checkbox")},n.Ay.createElement(as.A,{name:"embedLinks",checked:!i.embedLinks,label:g("UserRestrictionsEmbedLinks"),blocking:!0,permissionGroup:h,onChange:o,disabled:A&&A("embedLinks")})),n.Ay.createElement("div",{className:(0,ue.A)("ListItem",u&&"with-checkbox")},n.Ay.createElement(as.A,{name:"sendPolls",checked:!i.sendPolls,label:g("UserRestrictionsSendPolls"),blocking:!0,permissionGroup:h,onChange:o,disabled:A&&A("sendPolls")})))),n.Ay.createElement("div",{className:d},n.Ay.createElement("div",{className:(0,ue.A)("ListItem",u&&"with-checkbox")},n.Ay.createElement(as.A,{name:"inviteUsers",checked:!i.inviteUsers,label:g("UserRestrictionsInviteUsers"),blocking:!0,permissionGroup:h,onChange:o,disabled:A&&A("inviteUsers")})),n.Ay.createElement("div",{className:(0,ue.A)("ListItem",u&&"with-checkbox"),onClick:E?S:void 0},n.Ay.createElement(as.A,{name:"pinMessages",checked:!i.pinMessages,label:g("UserRestrictionsPinMessages"),disabled:A?A("pinMessages"):E,blocking:!0,permissionGroup:h,onChange:o})),n.Ay.createElement("div",{className:(0,ue.A)("ListItem",u&&"with-checkbox"),onClick:E?S:void 0},n.Ay.createElement(as.A,{name:"changeInfo",checked:!i.changeInfo,label:g("UserRestrictionsChangeInfo"),blocking:!0,permissionGroup:h,disabled:A?A("changeInfo"):E,onChange:o})),p&&n.Ay.createElement("div",{className:(0,ue.A)("ListItem",u&&"with-checkbox")},n.Ay.createElement(as.A,{name:"manageTopics",checked:!i.manageTopics,label:g("CreateTopicsPermission"),blocking:!0,permissionGroup:h,onChange:o,disabled:A&&A("manageTopics")}))))}));var vc=a(77561);const Ec="yGhFKTl5",fc="goI3MITH",bc=(0,n.ph)((0,s.EK)(e=>{const{deleteMessageModal:t}=(0,c.nTw)(e),a=t?.messageIds,n=t?.chatId,{canDeleteForAll:s}=(0,c.jyG)(e,a),r=n?(0,c.hds)(e,n):void 0,i=r&&(0,c.AWZ)(e,r.id),o=i?.linkedChatId,d=Boolean(r)&&(0,l.WX)(r),m=Boolean(r)&&(0,l.Vs)(r),u=t?.isSchedule,h=t?.onConfirm,y=r&&(0,A.L8)(r.id)?(0,l.u0)((0,c.mBe)(e,(0,l.e7)(r))):void 0,p=Boolean(r&&!(0,l.DX)(r.id)&&(0,c.yps)(e,r.id)),g=i?.adminMembersById,v=r&&(0,l.ub)(r,"banUsers"),E=r?.isCreator,f=r?(0,c.ALW)(e,r):void 0,b=r&&(0,l.yn)(r)&&!s||f,C=r&&((0,l.Vs)(r)||d);return{chat:r,isChannel:d,isSuperGroup:m,messageIds:a,currentUserId:e.currentUserId,canDeleteForAll:!u&&s,contactName:y,willDeleteForCurrentUserOnly:b,willDeleteForAll:C,adminMembersById:g,chatBot:p,canBanUsers:v,linkedChatId:o,isSchedule:u,isCreator:E,onConfirm:h}})(({isOpen:e,chat:t,isChannel:a,isSuperGroup:r,isSchedule:i,currentUserId:o,messageIds:l,isCreator:d,canDeleteForAll:m,contactName:u,willDeleteForCurrentUserOnly:A,willDeleteForAll:h,chatBot:y,adminMembersById:p,canBanUsers:g,linkedChatId:v,onConfirm:E})=>{const{closeDeleteMessageModal:f,deleteMessages:b,reportChannelSpam:C,deleteChatMember:S,deleteScheduledMessages:k,exitMessageSelectMode:w,updateChatMemberBannedRights:N,deleteParticipantHistory:I}=(0,s.ko)(),P=(0,U.A)(e),M=(0,B.A)(),T=(0,Ua.A)(),{permissions:L,havePermissionChanged:R,handlePermissionChange:F,resetPermissions:D}=yc(t?.defaultBannedRights),[V,_]=(0,n.J0)([]),[O,J]=(0,n.J0)([]),[K,G]=(0,n.J0)([]),[j,z]=(0,n.J0)(!1),[H,$]=(0,n.J0)(!1),[q,W]=(0,n.J0)(!0),Z=(0,n.Kr)(()=>{if(a||!l||!t)return fa.p;const e=(0,s.mS)(),n=(0,c.SpN)(e,t.id,l);return n?(0,Ea.Am)(n).filter(e=>e?.id!==t?.id&&e?.id!==v&&e?.id!==t?.linkedMonoforumId):fa.p},[t,a,v,l]),ee=(0,x.A)(()=>Z.map(e=>({value:e.id,label:(0,Mt.F9)(T,e)||"",leftElement:n.Ay.createElement(xt.A,{size:"small",peer:e})}))),te=(0,n.Kr)(()=>Z.filter(e=>e.id!==v&&e.id!==t?.linkedMonoforumId&&e.id!==o),[Z,o,v,t?.linkedMonoforumId]),ae=(0,n.Kr)(()=>Z.filter(e=>e.id!==o&&e.id!==v&&e.id!==t?.linkedMonoforumId),[Z,o,v,t?.linkedMonoforumId]),ne=(0,n.Kr)(()=>{const e=Z.some(e=>e.id===o);return!g||e||t?.isMonoforum?fa.p:Z.filter(e=>{const t=p?.[e.id];return d||!t})},[Z,d,o,g,p,t?.isMonoforum]),se=(0,n.Kr)(()=>Boolean(te.length||ae.length||ne.length),[te,ae,ne])&&!m&&!i&&r,re=(0,n.Kr)(()=>!Z||i?{}:(0,Ea.pA)(Z,e=>[e.id,(0,Mt.F9)(T,e)]),[i,T,Z]),ie=(0,n.Kr)(()=>[{value:l&&Z.length>=2?"spam":Z?.[0]?.id,label:M("ReportSpamTitle"),nestedOptions:l&&Z.length>=2?[...ee().filter(e=>e.value!==v&&e.value!==t?.linkedMonoforumId&&e.value!==o)]:void 0}],[l,Z,M,v,t?.linkedMonoforumId,o]),oe=(0,n.Kr)(()=>[{value:l&&Z.length>=2?"delete_all":Z?.[0]?.id,label:l&&Z.length>=2?M("DeleteAllFromUsers"):M("DeleteAllFrom",Object.values(re)[0]),nestedOptions:l&&Z.length>=2?[...ee().filter(e=>e.value!==v&&e.value!==t?.linkedMonoforumId&&e.value!==o)]:void 0}],[l,Z,M,re,v,t?.linkedMonoforumId,o]),le=(0,n.Kr)(()=>[{value:l&&Z.length>=2?"ban":Z?.[0]?.id,label:l&&Z.length>=2?M(H?"DeleteRestrictUsers":"DeleteBanUsers"):H?M("KickFromSupergroup"):M("DeleteBan",Object.values(re)[0]),nestedOptions:l&&Z.length>=2?[...ee()]:void 0}],[H,M,l,Z,re]),ce=(0,x.A)(()=>{$(e=>!e)}),de=(0,x.A)((e,a)=>{if(!t)return fa.p;const n=(0,s.mS)();return a.filter(a=>{const s=(0,c.LM$)(n,t.id,a);return s&&e.includes(s.id)})}),me=(0,x.A)(e=>{Object.entries(e).forEach(([e,a])=>{a.length&&C({participantId:e,chatId:t.id,messageIds:a})})}),Ae=(0,x.A)(e=>{b({messageIds:e,shouldDeleteForAll:!0})}),he=(0,x.A)(e=>{t&&e.forEach(e=>{I({peerId:e,chatId:t.id})})}),ye=(0,x.A)(e=>{e.forEach(e=>{S({chatId:t.id,userId:e})})}),pe=(0,x.A)(e=>{e.forEach(e=>{N({chatId:t.id,userId:e,bannedRights:L})})}),ge=(0,x.A)(()=>{if(t&&l){if(E?.(),i)k({messageIds:l});else if(se){if(K?.length){const e=(0,s.mS)(),a=K.filter(e=>!Number.isNaN(Number(e))),n=l.reduce((n,s)=>{const r=(0,c.LM$)(e,t.id,s);return r&&a.includes(r.id)&&(n[r.id]||(n[r.id]=[]),n[r.id].push(Number(s))),n},{});me(n)}if(V?.length){const e=V.filter(e=>!Number.isNaN(Number(e)));he(e)}if(O?.length&&!R){const e=O.filter(e=>!Number.isNaN(Number(e)));ye(e);const t=de(e,l);Ae(t)}if(O?.length&&R){const e=O.filter(e=>!Number.isNaN(Number(e)));pe(e)}K?.length&&V?.length&&O?.length||b({messageIds:l,shouldDeleteForAll:q})}else b({messageIds:l,shouldDeleteForAll:q});f(),w()}}),ve=(0,x.A)(()=>{f()});return(0,n.vJ)(()=>{!e&&P&&(G([]),_([]),J([]),W(!0),z(!1),$(!1),D())},[e,P,D]),n.Ay.createElement(X.A,{isOpen:e,onClose:ve,onEnter:m?void 0:ge,className:"SeaF_shb"},n.Ay.createElement("div",{className:"_YNfwDqt"},n.Ay.createElement("div",{className:se&&"axa67kqo",dir:M.isRtl?"rtl":void 0},se&&n.Ay.createElement(on.A,{size:"small",peers:Z}),n.Ay.createElement("h3",{className:(0,ue.A)(se?"U4IFhV0a":"qd6OFHiG")},M("Chat.DeleteMessagesConfirmation",l?.length))),se&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("p",{className:Ec},M("DeleteAdditionalActions")),n.Ay.createElement("div",{className:"b6847Kh3"},n.Ay.createElement(vc.A,{options:ie,onChange:G,selected:K,nestedCheckbox:l&&Z.length>=2}),te?.length>0&&n.Ay.createElement(vc.A,{options:oe,onChange:_,selected:V,nestedCheckbox:l&&Z.length>=2}),ne?.length>0&&n.Ay.createElement(vc.A,{options:le,onChange:J,selected:O,nestedCheckbox:l&&Z.length>=2})),n.Ay.createElement("div",{className:(0,ue.A)("iv0u9Zw6",H&&"qCQftA04")},n.Ay.createElement("h3",{className:(0,ue.A)(Ec,"t3KOsBfm")},M("UserRestrictionsCanDoUsers",Z.length)),n.Ay.createElement(gc,{withCheckbox:!0,chatId:t?.id,isMediaDropdownOpen:j,setIsMediaDropdownOpen:z,handlePermissionChange:F,permissions:L,className:(0,ue.A)("czTjjKim",j&&"Ifpyv7Jp")})),O?.length&&g?n.Ay.createElement(ca.A,{narrow:!0,buttonClassName:fc,onClick:ce},M(H?"DeleteToggleBanUsers":"DeleteToggleRestrictUsers"),n.Ay.createElement(Q.A,{name:H?"up":"down",className:(0,ue.A)(fc,"ml-2")})):$(!1)),(m||y||!se)&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("p",null,l&&l.length>1?T("AreYouSureDeleteFewMessages"):T("AreYouSureDeleteSingleMessage")),A&&n.Ay.createElement("p",null,M("lng_delete_for_me_chat_hint",1,"i")),h&&n.Ay.createElement("p",null,M("lng_delete_for_everyone_hint",1,"i"))),m&&n.Ay.createElement(as.A,{className:"dialog-checkbox",label:u?(0,Tt.A)(M("DeleteMessagesOptionAlso",u)):M("Conversation.DeleteMessagesForEveryone"),checked:q,onCheck:W}),n.Ay.createElement("div",{className:(0,ue.A)("dialog-buttons",j?"JTT_DIRv":"L4YzeG91")},n.Ay.createElement(Y.A,{color:"danger",className:"confirm-dialog-button",isText:!0,onClick:ge},se?M("DeleteProceedBtn"):T("Delete")),n.Ay.createElement(Y.A,{className:"confirm-dialog-button",isText:!0,onClick:ve},M("Cancel")))))})),Cc=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const a=(0,A.L8)(t),n=(0,c.nZ4)(e,t),s=(0,c.hds)(e,t),r=Boolean(s)&&(0,l.WX)(s),i=Boolean(s)&&(0,l.yn)(s),o=Boolean(s)&&(0,l.Vs)(s);return{isPrivateChat:a,isChatWithSelf:n,isChannel:r,isGroup:i,isSuperGroup:o,canPinForAll:a&&!n||o||i,contactName:s&&(0,A.L8)(s.id)?(0,l.u0)((0,c.mBe)(e,(0,l.e7)(s))):void 0}})(({isOpen:e,chatId:t,messageId:a,isChannel:r,isGroup:i,isSuperGroup:o,canPinForAll:l,contactName:c,onClose:d})=>{const{pinMessage:m}=(0,s.ko)(),[u,A]=(0,n.J0)(!0),h=(0,x.A)(()=>{m({chatId:t,messageId:a,isUnpin:!1,isOneSide:!u,isSilent:!u}),d()}),y=(0,B.A)();return n.Ay.createElement(X.A,{isOpen:e,onClose:d,className:"pin",title:y("PinMessageAlertTitle")},n.Ay.createElement("p",null,y(r?"PinMessageAlertChannel":i||o?"PinMessageAlert":"PinMessageAlertChat")),l&&n.Ay.createElement(as.A,{className:"dialog-checkbox",label:c?(0,Tt.A)(y("Conversation.PinMessagesFor",c)):y("Conversation.PinMessageAlert.PinAndNotifyMembers"),checked:u,onCheck:A}),n.Ay.createElement("div",{className:"dialog-buttons"},n.Ay.createElement(Y.A,{className:"confirm-dialog-button",isText:!0,onClick:h},y("DialogPin")),n.Ay.createElement(Y.A,{className:"confirm-dialog-button",isText:!0,onClick:d},y("Cancel"))))})),Sc=(0,n.ph)(({isOpen:e,pinnedMessagesCount:t=0,onClose:a,onUnpin:s})=>{const r=(0,B.A)();return n.Ay.createElement(X.A,{isOpen:e,onClose:a,className:"unpin-all",title:r("Chat.PanelUnpinAllMessages")},n.Ay.createElement("p",null,r("Chat.UnpinAllMessagesConfirmation",t,"i")),n.Ay.createElement("div",{className:"dialog-buttons mt-2"},n.Ay.createElement(Y.A,{className:"confirm-dialog-button",isText:!0,onClick:s},r("DialogUnpin")),n.Ay.createElement(Y.A,{className:"confirm-dialog-button",isText:!0,onClick:a},r("Cancel"))))});var kc=a(2178);const wc=(0,n.ph)((0,s.EK)(e=>{const t=(0,c.nTw)(e),{shouldWarnAboutSvg:a}=(0,hs.l)(e),n=(0,c.meB)(e),{type:s,chatId:r}=(0,c.Xf0)(e)||{},i="scheduled"===s,{canDelete:o}=(0,c.jyG)(e),l=Boolean(!i&&(0,c.mDG)(e)),d=(0,c.ori)(e),{messageIds:m}=t.selectedMessages||{},u=!!r&&(0,c.o45)(e,r,m),A=!(i||!r)&&(0,c.Y8y)(e,r,m),h=!(!m||!r)&&(0,c.H_s)(e,r,m),y=t.isShareMessageModalShown,p=Boolean(y||t.requestedDraft||t.requestedAttachBotInChat||t.requestedAttachBotInstall||t.reportModal||t.deleteMessageModal);return{chat:n,isSchedule:i,selectedMessagesCount:(0,c.ZZ2)(e),canDeleteMessages:o,canReportMessages:l,canDownloadMessages:d,canForwardMessages:A,selectedMessageIds:m,hasProtectedMessage:u,isAnyModalOpen:p,shouldWarnAboutSvg:a,hasSvgs:h}})(({chat:e,canPost:t,isActive:a,messageListType:r,isSchedule:i,selectedMessagesCount:o,canDeleteMessages:l,canReportMessages:c,canDownloadMessages:d,canForwardMessages:m,hasProtectedMessage:u,isAnyModalOpen:A,selectedMessageIds:h,shouldWarnAboutSvg:y,hasSvgs:p})=>{const{exitMessageSelectMode:g,openForwardMenuForSelectedMessages:v,downloadSelectedMessages:E,copySelectedMessages:f,showNotification:b,reportMessages:C,openDeleteMessageModal:S,setSharedSettingOption:k}=(0,s.ko)(),w=(0,B.A)();(e=>{function t(e){e.preventDefault(),(0,s.ko)().copySelectedMessages()}(0,kc.v)((0,n.Kr)(()=>e?{"Mod+C":t}:void 0,[e]))})(a);const[N,I,P]=(0,M.A)(),[T,L]=(0,n.J0)(!1),R=(0,x.A)(()=>{g()}),F=(0,x.A)(()=>{h&&e&&S({chatId:e.id,messageIds:h,isSchedule:i})});(0,n.vJ)(()=>a&&!A?(0,Ra.A)({onBackspace:l?F:void 0,onDelete:l?F:void 0,onEsc:R}):void 0,[a,F,R,A,l]);const D=(0,x.A)(()=>{f(),b({message:w("Share.Link.Copied")}),g()}),V=(0,x.A)(()=>{E(),g()}),_=(0,x.A)(()=>{y&&p?I():V()}),O=(0,x.A)(()=>{k({shouldWarnAboutSvg:!T}),P(),V()}),J=(0,U.A)(o||void 0,!0),K=w("VoiceOver.Chat.MessagesSelected",a?o:J,"i"),G=(0,x.A)(()=>{h&&e&&(C({chatId:e.id,messageIds:h}),g())}),j=(0,ue.A)("MessageSelectToolbar",t&&"with-composer",a&&"shown"),z=(e,t,a,s)=>n.Ay.createElement("div",{role:"button",tabIndex:0,className:(0,ue.A)("div-button","item",s&&"destructive"),onClick:a,title:t,"aria-label":t},n.Ay.createElement(Q.A,{name:e}));return n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:j},n.Ay.createElement("div",{className:"MessageSelectToolbar-inner"},n.Ay.createElement(Y.A,{color:"translucent",round:!0,onClick:R,ariaLabel:"Exit select mode"},n.Ay.createElement(Q.A,{name:"close"})),n.Ay.createElement("span",{className:"MessageSelectToolbar-count",title:K},K),Boolean(o)&&n.Ay.createElement("div",{className:"MessageSelectToolbar-actions"},"scheduled"!==r&&m&&z("forward",w("Chat.ForwardActionHeader"),v),c&&z("flag",w("Conversation.ReportMessages"),G),d&&!u&&z("download",w("lng_media_download"),_),!u&&z("copy",w("lng_context_copy_selected_items"),D),l&&z("delete",w("EditAdminGroupDeleteMessages"),F,!0)))),n.Ay.createElement(ya.A,{isOpen:N,onClose:P,confirmHandler:O},w("lng_launch_svg_warning"),n.Ay.createElement(as.A,{className:"dialog-checkbox",checked:T,label:w("lng_launch_exe_dont_ask"),onCheck:L})))})),Nc=(0,n.ph)((0,s.EK)(e=>{const{chatId:t,messageId:a}=(0,c.nTw)(e).seenByModal||{};return t&&a?{seenByDates:(0,c.O5q)(e,t,a)?.seenByDates}:{}})(function({isOpen:e,seenByDates:t}){const{openChat:a,closeSeenByModal:r}=(0,s.ko)(),i=(0,B.A)(),o=(0,La.A)(t,!0),l=(0,n.Kr)(()=>{if(!o)return;const e=Object.keys(o);return e.sort((e,t)=>o[t]-o[e]),e},[o]),c=(0,x.A)(e=>{r(),setTimeout(()=>{a({id:e})},100)}),d=(0,x.A)(()=>{r()});return n.Ay.createElement(X.A,{isOpen:e,onClose:r,className:(0,ue.A)("slqA9gR2","narrow"),title:`Seen by ${l?.length} users`},n.Ay.createElement("div",{dir:i.isRtl?"rtl":void 0},l&&l.map(e=>n.Ay.createElement(ca.A,{key:e,className:"chat-item-clickable scroll-item small-icon",onClick:()=>c(e)},n.Ay.createElement(kn.A,{userId:e,noStatusOrTyping:!0,status:(0,$e.U)(i,1e3*o[e]),statusIcon:"message-read"})))),n.Ay.createElement("div",{className:"dialog-buttons mt-2"},n.Ay.createElement(Y.A,{className:"confirm-dialog-button",isText:!0,onClick:d},i("Close"))))}));var Ic=a(32581);const Pc="MQxuEIRA",Mc="AEAN1Au4",Tc="F7owtTHj",xc=X.U+i.xB5,Bc=(0,n.ph)((0,s.EK)(e=>{const{chatId:t,isReadDate:a}=(0,c.nTw)(e).privacySettingsNoticeModal||{};return{user:t?(0,c.mBe)(e,t):void 0,isReadDate:a}})(({isOpen:e,isReadDate:t,user:a})=>{const r=(0,B.A)(),{updateGlobalPrivacySettings:i,openPremiumModal:o,closePrivacySettingsNoticeModal:c,showNotification:d,setPrivacyVisibility:m,loadUser:u}=(0,s.ko)(),A=(0,l.u0)(a),h=(0,x.A)(()=>{i({shouldHideReadMarks:!1}),c(),setTimeout(()=>{d({message:r("PremiumReadSet")})},xc)}),y=(0,x.A)(()=>{m({privacyKey:"lastSeen",visibility:"everybody",onSuccess:()=>u({userId:a.id})}),c(),setTimeout(()=>{d({message:r("PremiumLastSeenSet")})},xc)}),p=(0,x.A)(()=>{c(),setTimeout(()=>{o({initialSection:"last_seen"})},xc)}),g=(0,x.A)(()=>{c()});return n.Ay.createElement(X.A,{isSlim:!0,isOpen:e,onClose:g},n.Ay.createElement("div",{className:"tauadiDm",dir:r.isRtl?"rtl":void 0},n.Ay.createElement(Y.A,{className:"i6iFv9YE",color:"translucent",round:!0,size:"smaller",onClick:g,ariaLabel:"Close"},n.Ay.createElement(Q.A,{name:"close"})),n.Ay.createElement(So.A,{tgsUrl:t?Co.w.ReadTime:Co.w.LastSeen,size:84,className:"i4wZg_0J",nonInteractive:!0,noLoop:!0}),n.Ay.createElement("h2",{className:Pc},r(t?"PremiumReadHeader1":"PremiumLastSeenHeader1")),n.Ay.createElement("p",{className:Mc},(0,Tt.A)(r(t?"PremiumReadText1":"PremiumLastSeenText1Locked",A),["simple_markdown"])),n.Ay.createElement(Y.A,{size:"smaller",onClick:t?h:y,className:Tc},r(t?"PremiumReadButton1":"PremiumLastSeenButton1")),n.Ay.createElement(Ic.A,{className:"sXXb5yOS"},r("PremiumOr")),n.Ay.createElement("h2",{className:Pc},r("PremiumReadHeader2")),n.Ay.createElement("p",{className:Mc},(0,Tt.A)(r(t?"PremiumReadText2":"PremiumLastSeenText2",A),["simple_markdown"])),n.Ay.createElement(Y.A,{withPremiumGradient:!0,size:"smaller",onClick:p,className:Tc},r("PremiumLastSeenButton2"))))})),Lc=(0,n.ph)((0,s.EK)(e=>{const{chatId:t,messageId:a}=(0,c.nTw)(e).reactorModal||{},n=t&&a?(0,c.O5q)(e,t,a):void 0;return{chatId:t,messageId:a,reactions:n?.reactions,reactors:n?.reactors,seenByDates:n?.seenByDates,availableReactions:e.reactions.availableReactions}})(({isOpen:e,reactors:t,reactions:a,chatId:i,messageId:o,seenByDates:c,availableReactions:d})=>{const{loadReactors:m,closeReactorListModal:u,openChat:A}=(0,s.ko)(),h=(0,s.mS)().chats.byId,y=(0,s.mS)().users.byId,p=(0,B.A)(),g=(0,Ua.A)(),[v,E,f]=(0,M.A)(!1),[b,C]=(0,n.J0)(void 0),S=t&&a&&t.count>=10&&a.results.length>1,k=(0,n.li)();(0,n.vJ)(()=>{e&&!v&&(k.current=void 0),v&&!e&&(f(),C(void 0))},[v,e,f]);const w=(0,x.A)(()=>{k.current&&A({id:k.current}),u()}),N=(0,x.A)(()=>{E()}),I=(0,x.A)(e=>{k.current=e,N()}),P=(0,x.A)(()=>{m({chatId:i,messageId:o})}),T=(0,n.Kr)(()=>{const e=[];return t?.reactions?.forEach(({reaction:t})=>{e.some(e=>(0,l.a0)(e,t))||e.push(t)}),e},[t]),L=(0,n.Kr)(()=>{if(b)return t?.reactions.filter(({reaction:e})=>(0,l.a0)(e,b)).map(({peerId:e})=>e);const e=Object.keys(c||{});return(0,Ea.Am)(t?.reactions.map(({peerId:e})=>e).concat(e||[])||[])},[b,t,c]),[R,F]=(0,Ln.A)(P,L,t&&void 0===t.nextOffset);return(0,n.vJ)(()=>{F?.({direction:r.TN.Backwards})},[F]),n.Ay.createElement(X.A,{isOpen:e&&!v,onClose:N,className:"ReactorListModal narrow",title:p("Reactions"),onCloseAnimationEnd:w},S&&n.Ay.createElement("div",{className:"Reactions",dir:p.isRtl?"rtl":void 0},n.Ay.createElement(Y.A,{className:(0,ue.A)(!b&&"chosen"),size:"tiny",ripple:!0,onClick:()=>C(void 0)},n.Ay.createElement(Q.A,{name:"heart"}),Boolean(t?.count)&&(0,qe.Vw)(g,t.count)),T.map(e=>{const t=a?.results.find(t=>(0,l.a0)(t.reaction,e))?.count;return n.Ay.createElement(Y.A,{key:(0,l.Jj)(e),className:(0,ue.A)((0,l.a0)(b,e)&&"chosen"),size:"tiny",ripple:!0,onClick:()=>C(e)},n.Ay.createElement(wn.A,{reaction:e,className:"reaction-filter-emoji",availableReactions:d}),Boolean(t)&&(0,qe.Vw)(g,t))})),n.Ay.createElement("div",{dir:p.isRtl?"rtl":void 0,className:"reactor-list-wrapper"},R?.length?n.Ay.createElement(fn.A,{className:"reactor-list custom-scroll",items:R,onLoadMore:F},R?.flatMap(e=>{const a=y[e]||h[e],s=t?.reactions.filter(t=>t.peerId===e),r=[],i=c?.[e];return s?.forEach(t=>{b&&!(0,l.a0)(t.reaction,b)||r.push(n.Ay.createElement(ca.A,{key:`${e}-${(0,l.Jj)(t.reaction)}`,className:"chat-item-clickable reactors-list-item",onClick:()=>I(e)},n.Ay.createElement(xt.A,{peer:a,size:"medium"}),n.Ay.createElement("div",{className:"info"},n.Ay.createElement(Vn.A,{peer:a,withEmojiStatus:!0}),n.Ay.createElement("span",{className:"status",dir:"auto"},n.Ay.createElement(Q.A,{name:"heart-outline",className:"status-icon"}),(0,$e.U)(p,1e3*t.addedDate))),t.reaction&&n.Ay.createElement(wn.A,{className:"reactors-list-emoji",reaction:t.reaction,availableReactions:d})))}),b||s?.length||r.push(n.Ay.createElement(ca.A,{key:`${e}-seen-by`,className:"chat-item-clickable scroll-item small-icon",onClick:()=>I(e)},n.Ay.createElement(kn.A,{userId:e,noStatusOrTyping:!0,avatarSize:"medium",status:i?(0,$e.U)(p,1e3*i):void 0,statusIcon:"message-read"}))),r})):n.Ay.createElement(Dn.A,null)),n.Ay.createElement(Y.A,{className:"confirm-dialog-button",isText:!0,onClick:N},p("Close")))})),Rc=(0,n.ph)((0,s.EK)((e,{activeEmojiInteraction:t})=>{const a=void 0!==t.animatedEffect&&(0,c.Nr8)(e,t.animatedEffect);return{effectAnimationId:a?a.id:void 0}})(({effectAnimationId:e,activeEmojiInteraction:t})=>{const{stopActiveEmojiInteraction:a}=(0,s.ko)(),[r,i]=(0,M.A)(!1),[o,l]=(0,M.A)(!1),c=(0,n.li)(),d=(0,x.A)(()=>{i(),c.current&&clearTimeout(c.current),setTimeout(()=>{a({id:t.id})},250)}),m=(0,x.A)(e=>{e.target?.closest(".AnimatedEmoji")||d()});(0,n.vJ)(()=>(document.addEventListener("touchstart",m),document.addEventListener("touchmove",m),document.addEventListener("mousedown",m),document.addEventListener("wheel",m),()=>{document.removeEventListener("touchstart",m),document.removeEventListener("touchmove",m),document.removeEventListener("mousedown",m),document.removeEventListener("wheel",m)}),[m]),(0,n.Nf)(()=>{const e=(0,n.VK)();c.current=setTimeout(()=>{d(),e()},3e3)},[d]);const u=e&&`sticker${e}`,A=(0,H.A)(u,!e);if(!t.startSize)return;const h=(t.startSize||0)/309;return n.Ay.createElement("div",{className:(0,ue.A)("EmojiInteractionAnimation",r&&"hiding",o&&"playing",t.isReversed&&"reversed"),style:`--scale: ${h}; --start-x: ${t.x}px; --start-y: ${t.y}px;`},n.Ay.createElement(Pr.A,{key:`effect_${e}`,size:309,tgsUrl:A,play:!0,quality:E.Ni?.5:void 0,forceAlways:!0,noLoop:!0,onLoad:l}))})),Fc=(0,n.ph)((0,s.EK)(e=>{const{chatId:t,messageId:a}=(0,c.nTw)(e).chatLanguageModal||{},n=(0,c.wmb)(e);return{chatId:t,messageId:a,activeTranslationLanguage:t?a?(0,c.Rny)(e,t,a):(0,c.qZq)(e,t):void 0,currentLanguageCode:n}})(({isOpen:e,chatId:t,messageId:a,activeTranslationLanguage:r,currentLanguageCode:o})=>{const{requestMessageTranslation:l,closeChatLanguageModal:c,setSettingOption:d,requestChatTranslation:m}=(0,s.ko)(),[u,A]=(0,n.J0)(""),h=(0,B.A)(),y=(0,x.A)(e=>{t&&(a?l({chatId:t,id:a,toLanguageCode:e}):(d({translationLanguage:e}),m({chatId:t,toLanguageCode:e})),c())}),p=(0,x.A)(e=>{A(e.target.value)}),g=(0,n.Kr)(()=>i.N89.map(e=>({langCode:e,translatedName:new Intl.DisplayNames([o],{type:"language"}).of(e),originalName:new Intl.DisplayNames([e],{type:"language"}).of(e)})),[o]);(0,n.vJ)(()=>{e||A("")},[e]);const v=(0,n.Kr)(()=>u.trim()?g.filter(({langCode:e,translatedName:t,originalName:a})=>t.toLowerCase().includes(u.toLowerCase())||a.toLowerCase().includes(u.toLowerCase())||e.toLowerCase().includes(u.toLowerCase())):g,[g,u]);return n.Ay.createElement(X.A,{className:"aMjNU9gm",isSlim:!0,isOpen:e,hasCloseButton:!0,title:h("Language"),onClose:c},n.Ay.createElement(Z.A,{key:"search",value:u,onChange:p,placeholder:h("Search"),teactExperimentControlled:!0}),n.Ay.createElement("div",{className:(0,ue.A)("r3YNWDQr","custom-scroll")},v.map(({langCode:e,originalName:t,translatedName:a})=>n.Ay.createElement(ca.A,{key:e,className:(0,ue.A)("T3An6Hoz","no-icon"),secondaryIcon:r===e?"check":void 0,disabled:r===e,multiline:!0,narrow:!0,onClick:()=>y(e)},n.Ay.createElement("span",{className:(0,ue.A)("title","dQ9wwFu1")},(0,Tt.A)(t,["highlight"],{highlight:u})),n.Ay.createElement("span",{className:(0,ue.A)("subtitle","m_J41YYl")},(0,Tt.A)(a,["highlight"],{highlight:u}))))))}));var Dc=a(85982),Vc=a(24899);const _c={content:"WEJIbFQj",closeButton:"_vwPuDEM",icon:"BUiGM8qZ",title:"Q3NhXpNI",description:"frZbGQ0G"},Uc=(0,n.ph)((0,s.EK)(e=>{const{countryList:t}=e;return{phoneCodeList:t.phoneCodes}})(({modal:e,phoneCodeList:t})=>{const{closeCollectibleInfoModal:a,openChat:r,openUrl:i,showNotification:o}=(0,s.ko)(),l=(0,B.A)(),c="username"===e?.type,d=(0,x.A)(()=>{a()}),m=(0,x.A)(()=>{r({id:e.peerId}),d()}),u=(0,x.A)(()=>{i({url:e.url,shouldSkipModal:!0}),d()}),A=(0,x.A)(()=>{const a=c?(0,Vc.A)(e.collectible):(0,ms.Ox)(t,e.collectible);(0,Dc.eM)(a),o({message:l(c?"UsernameCopied":"PhoneCopied")}),d()}),h=(0,n.Kr)(()=>{if(!e)return;const a=c?"FragmentUsernameTitle":"FragmentPhoneTitle",n=c?(0,Vc.A)(e.collectible):(0,ms.Ox)(t,e.collectible);return l(a,n)},[e,c,t,l]),y=(0,n.Kr)(()=>{if(!e)return;const t=c?"FragmentUsernameMessage":"FragmentPhoneMessage",a=(0,$e.U)(l,1e3*e.purchaseDate),n=(0,mr.Ad)(e.amount,e.currency,l.code),s=(0,mr.Ad)(e.cryptoAmount,e.cryptoCurrency,l.code);return l(t,[a,`${s} (${n})`])},[e,c,l]);return n.Ay.createElement(X.A,{isOpen:Boolean(e),isSlim:!0,contentClassName:_c.content,onClose:a},n.Ay.createElement(Y.A,{round:!0,color:"translucent",size:"smaller",className:_c.closeButton,ariaLabel:l("Close"),onClick:d},n.Ay.createElement(Q.A,{name:"close"})),n.Ay.createElement("div",{className:_c.icon},n.Ay.createElement(So.A,{tgsUrl:c?Co.w.Mention:Co.w.Fragment,size:60})),n.Ay.createElement("h3",{className:_c.title},h&&(0,Tt.A)(h,["simple_markdown"])),n.Ay.createElement(Oo.A,{className:_c.chip,peerId:e?.peerId,forceShowSelf:!0,clickArg:e?.peerId,onClick:m}),n.Ay.createElement("p",{className:_c.description},y&&(0,Tt.A)(y,["simple_markdown"])),n.Ay.createElement("div",{className:"dialog-buttons dialog-buttons-centered"},n.Ay.createElement(Y.A,{className:"confirm-dialog-button",onClick:u},l("FragmentUsernameOpen")),n.Ay.createElement(Y.A,{isText:!0,className:"confirm-dialog-button",onClick:A},l(c?"FragmentUsernameCopy":"FragmentPhoneCopy"))))}));var Oc=a(31460),Jc=a(24680),Kc=a(66049),Gc=a(25279),jc=a(75304),zc=a(54769),Hc=a(62718),$c=a(77787),qc=a(95815),Wc=a(81120),Qc=a(85935),Yc=a(60602);function Zc(e,t){let a=e;return t&&(t.include&&(a=a.filter(e=>Xc(e,t.include))),t.exclude&&(a=a.filter(e=>!Xc(e,t.exclude)))),a}function Xc(e,t){if(t.metadata)for(const a in t.metadata)if(e.metadata[a]!==t.metadata[a])return!1;return!(t.text&&!(Array.isArray(t.text)?t.text:[t.text]).includes(e.text))}function ed(e,t,a){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class td{constructor(e){ed(this,"db",void 0),ed(this,"documents",[]),ed(this,"maxSizeInMB",void 0),ed(this,"debounceTime",void 0),ed(this,"openaiModel",void 0),ed(this,"openaiApiKey",void 0),ed(this,"embedTextsFn",void 0),ed(this,"dbName",void 0),ed(this,"dbVersion",void 0),this.dbName=e.dbName??"VectorStorage",this.dbVersion=e.dbVersion??1,this.maxSizeInMB=e.maxSizeInMB??128,this.debounceTime=e.debounceTime??0,this.openaiModel=e.openaiModel??"text-embedding-ada-002",this.embedTextsFn=e.embedTextsFn,this.openaiApiKey=e.openAIApiKey,this.openaiApiKey||e.embedTextsFn?this.startPeriodicCleanup():console.error("VectorStorage: pass as an option either an OpenAI API key or a custom embedTextsFn function.")}async addText(e,t,a){const n={metadata:a,text:e,id:t,timestamp:Date.now(),vector:[],vectorMag:0};return await this.addDocuments(n)}async updateText(e,t,a){const n={metadata:a,text:e,id:t,timestamp:Date.now(),vector:[],vectorMag:0};return await this.updateDocument(n)}async deleteText(e){this.db||(this.db=await this.initDB());try{const t=this.db.transaction("documents","readwrite");t.objectStore("documents").delete(e),await t.done}catch(e){console.error("Error deleting text:",e)}}async getText(e){this.db||(this.db=await this.initDB());const t=this.db.transaction("documents","readonly");return await t.objectStore("documents").get(e)}async similaritySearch(e){const{query:t,k:a=4,filterOptions:n,includeValues:s}=e;let{queryEmbedding:r}=e;r&&0!==r.length||(r=await this.embedText(t));const i=this.calculateMagnitude(r),o=Zc(await this.loadFromIndexDbStorage(),n),l=this.calculateSimilarityScores(o,r,i).sort((e,t)=>t[1]-e[1]).slice(0,a).map(e=>({...e[0],score:e[1]}));return this.updateHitCounters(l),s||l.forEach(e=>{delete e.vector,delete e.vectorMag}),{query:{embedding:r,text:t},similarItems:l}}async documentSearch(e){const{filterOptions:t}=e;return Zc(await this.loadAllFromIndexDbStorage(),t)}async initDB(){return(0,Yc.P2)(this.dbName,this.dbVersion,{upgrade(e){for(const t of e.objectStoreNames)e.deleteObjectStore(t);const t=e.createObjectStore("documents",{autoIncrement:!0,keyPath:"id"});t.createIndex("text","text",{unique:!1}),t.createIndex("metadata","metadata"),t.createIndex("timestamp","timestamp"),t.createIndex("vector","vector"),t.createIndex("vectorMag","vectorMag"),t.createIndex("hits","hits"),t.createIndex("id","id",{unique:!0})}})}async addDocuments(e){const t=await this.embedTextsFn(e.text);return e.vector=t,e.vectorMag=ad(e),await this.addToIndexDbStorage([e]),e}async updateDocument(e){const t=await this.embedTextsFn(e.text);return e.vector=t,e.vectorMag=ad(e),await this.addToIndexDbStorage([e]),e}async embedTexts(e){const t=await fetch("https://api.openai.com/v1/embeddings",{body:JSON.stringify({input:e,model:this.openaiModel}),headers:{Authorization:`Bearer ${this.openaiApiKey}`,"Content-Type":"application/json"},method:"POST"});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return(await t.json()).data.map(e=>e.embedding)}async embedText(e){return await this.embedTextsFn(e)}calculateMagnitude(e){return Math.sqrt(e.reduce((e,t)=>e+t*t,0))}calculateSimilarityScores(e,t,a){return e.map(e=>{let n=(s=e.vector.reduce((e,a,n)=>e+a*t[n],0),r=e.vectorMag,s/(r*a));var s,r;return n=function(e){return(e+1)/2}(n),[e,n]})}updateHitCounters(e){e.forEach(e=>{e.hits=(e.hits??0)+1})}async loadFromIndexDbStorage(){this.db||(this.db=await this.initDB());const e=this.db.transaction("documents","readonly"),t=e.store.index("timestamp"),a=[];let n=0;for await(const e of t.iterate(null,"prev"))if(a.push(e.value),n++,n>=3e3)break;return await e.done,a}async loadAllFromIndexDbStorage(){this.db||(this.db=await this.initDB());const e=this.db.transaction("documents","readonly"),t=e.store.index("timestamp"),a=[];for await(const e of t.iterate(null,"prev"))a.push(e.value);return await e.done,a}async addToIndexDbStorage(e){this.db||(this.db=await this.initDB());try{const t=this.db.transaction("documents","readwrite");for(const a of e)await t.objectStore("documents").put(a);await t.done}catch(e){console.error("Failed to save to IndexedDB:",e.message)}}startPeriodicCleanup(){this.checkAndCleanupData(),setInterval(()=>{this.checkAndCleanupData()},36e5)}async checkAndCleanupData(){try{this.db||(this.db=await this.initDB());const e=this.db.transaction("documents","readwrite"),t=e.objectStore("documents"),a=t.index("timestamp"),n=await t.count();if(n>4e4){console.log(`VectorStorage: 检测到数据量超过限制 (${n} > 40000)，开始清理老数据...`);const s=[];for await(const e of a.iterate(null,"prev"))s.push(e.value);const r=s.slice(0,35e3),i=s.slice(35e3);await t.clear();for(const e of r)await t.put(e);await e.done,console.log(`VectorStorage: 清理完成，删除了 ${i.length} 条老数据，保留了 ${r.length} 条最新数据`)}else console.log(`VectorStorage: 数据量检查完成，当前数据量: ${n}`)}catch(e){console.error("VectorStorage: 数据清理过程中发生错误:",e)}}async manualCleanup(){await this.checkAndCleanupData()}async getDocumentCount(){try{this.db||(this.db=await this.initDB());const e=this.db.transaction("documents","readonly"),t=await e.objectStore("documents").count();return await e.done,t}catch(e){return console.error("VectorStorage: 获取文档数量时发生错误:",e),0}}}function ad(e){return Math.sqrt(e.vector.reduce((e,t)=>e+t*t,0))}async function nd(e){const t=await fetch("http://47.85.96.140:8100/v1/embeddings",{body:JSON.stringify({dimensions:null,encoding_format:"float",input:e,model:"null",user:"null"}),headers:{"Content-Type":"application/json"},method:"POST"});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const a=await t.json();return a.data?.[0]?.embedding}const sd=new Map;function rd(e,t){return sd.has(e)||sd.set(e,new td({embedTextsFn:nd,dbName:e,dbVersion:t})),sd.get(e)}const id=rd("tools-embedding",2),od=rd("message-embedding",2);rd("knowledge-embedding"),window.toolsEmbeddingStore=id;var ld=a(64721),cd=a(88486),dd=a(57674),md=a(10587),ud=a(4955),Ad=a(70809);function hd({status:e,stop:t,setMessages:a,handleSearch:n,className:s}){const r=(0,Al.useRef)(null),{width:i}=(0,cd.lW)();(0,Al.useEffect)(()=>{r.current&&o()},[]);const o=()=>{r.current&&(r.current.style.height="auto",r.current.style.height=`${Math.min(200,Math.max(90,r.current.scrollHeight+2))}px`)},[l,c]=(0,cd.Mj)("input",""),[d,m]=(0,Al.useState)("");(0,Al.useEffect)(()=>{if(r.current){const e=r.current.value;m(e||l||""),o()}},[]),(0,Al.useEffect)(()=>{c(d)},[d,c]);const u=(0,Al.useCallback)(()=>{d&&(n(d),m(""),c(""),r.current&&(r.current.style.height="auto",r.current.style.height="90px"),i&&i>768&&r.current?.focus())},[n,d,c,i]);return Al.createElement("div",{className:"relative w-full mx-[22px] flex flex-col gap-4"},Al.createElement(md.X,{ref:r,placeholder:"Send a message...",value:d,onChange:e=>{m(e.target.value),o()},className:kl()("h-[90px] overflow-y-auto border-[#7D40FF] resize-none rounded-2xl !text-base pb-10 focus-visible:!ring-0 !ring-offset-0",s),rows:2,autoFocus:!0,onKeyDown:t=>{"Enter"!==t.key||t.shiftKey||(t.preventDefault(),"ready"!==e?ld.oR.error("Please wait for the model to finish its response!"):u())}}),Al.createElement("div",{className:"absolute bottom-0 right-0 p-2 w-fit flex flex-col justify-end"},"submitted"===e?Al.createElement(gd,{stop:t,setMessages:a}):Al.createElement(Ed,{input:d,submitForm:u})))}const yd=(0,Al.memo)(hd,(e,t)=>e.status===t.status);function pd({stop:e,setMessages:t}){return Al.createElement(ud.$,{className:"rounded-full p-1.5 h-fit border dark:border-zinc-600",onClick:a=>{a.preventDefault(),e(),t(e=>(0,dd.y8)(e))}},Al.createElement(Ad.wF,{size:14}))}const gd=(0,Al.memo)(pd);function vd({submitForm:e,input:t}){return Al.createElement(ud.$,{className:"!px-0 !py-0 !w-[24px] !h-[24px] !bg-transparent ",onClick:t=>{t.preventDefault(),e()},disabled:0===t.length},Al.createElement("i",{className:"icon icon-send text-[#B27AFF] text-[24px]"}))}const Ed=(0,Al.memo)(vd,(e,t)=>e.input===t.input),fd="777889",bd=(0,ul.P)({component:()=>{const e=(0,s.mS)(),{userId:t,userName:a}=(0,Wc.pD)(),[n,r]=(0,Al.useState)({lastTime:void 0,hasMore:!0}),{scrollToBottom:o,scrollLocked:l,isScrollLock:d}=(0,jc.R)(),{messages:m,setMessages:u,append:A,status:h,stop:y}=(0,Kc.Y_)({id:fd,api:`${i.Vjs}/chat?userId=${t}&userName=${a}&platform=web`,sendExtraMessageFields:!0,onError:e=>{try{const t=JSON.parse(e.message);if(102===t.code||103===t.code){const e=(0,Hc.NH)();u(t=>[...t,e])}}catch(t){console.error("error.message is not JSON:",e.message)}}});(0,Al.useEffect)(()=>{d||o()},[d,m,o]),(0,Al.useEffect)(()=>($c.zs.message?.getMessages(fd,void 0,20)?.then(e=>{if(e.messages.length>0){const t=(0,qc.Lf)(e.messages);u(e=>[...t,...e])}else{const e={role:"assistant",id:(0,Gc.A)(),createdAt:new Date,content:"",annotations:[{type:"ai-search-sugesstion"}]};u([e])}r({lastTime:e.lastTime,hasMore:e.hasMore})}),()=>{u([])}),[]),(0,Al.useEffect)(()=>{if(m.length>0&&"ready"===h){const e=(0,qc.Jr)(fd,m);$c.zs.message?.storeMessages([...e])}},[h,m]);const p=(0,Al.useCallback)(()=>(l(),new Promise(e=>{$c.zs.message?.getMessages(fd,n?.lastTime,20)?.then(t=>{if(t.messages){const e=(0,qc.Lf)(t.messages);u(t=>[...e,...t])}r({lastTime:t.lastTime,hasMore:t.hasMore}),e()})})),[n?.lastTime,l,u]),g=(0,Al.useCallback)(async e=>{const t=(await od.similaritySearch({query:e,k:100,filterOptions:{include:{metadata:{chatType:"group"}}}})).similarItems;let a=null;if(t.length>0){const e=Array.from(new Set(t.map(e=>{if(e.score>.7)return e?.metadata?.chatId}).filter(Boolean)));e.length>0&&(a=JSON.stringify(e))}if(a){const e={id:(0,Gc.A)(),role:"assistant",content:a,createdAt:new Date,parts:[],annotations:[{type:"group-search"}]};u(t=>[...t,e])}else{const e={id:(0,Gc.A)(),role:"assistant",content:"No relevant group was found",createdAt:new Date,parts:[]};u(t=>[...t,e])}},[u]),v=(0,Al.useCallback)(async e=>{const t=(await od.similaritySearch({query:e,k:100,filterOptions:{include:{metadata:{chatType:"private"}}}})).similarItems;let a=null;if(t.length>0){const e=Array.from(new Set(t.map(e=>{if(e.score>.7)return e?.metadata?.senderId}).filter(Boolean)));e.length>0&&(a=JSON.stringify(e))}if(a){const e={id:(0,Gc.A)(),role:"assistant",content:a,createdAt:new Date,parts:[],annotations:[{type:"user-search"}]};u(t=>[...t,e])}else{const e={id:(0,Gc.A)(),role:"assistant",content:"No relevant users was found",createdAt:new Date,parts:[]};u(t=>[...t,e])}},[u]),E=(0,Al.useCallback)(async t=>{const a=(await od.similaritySearch({query:t,k:100})).similarItems;if(a.length>0){const n=a.map(t=>{const{chatId:a,senderId:n}=t.metadata,s=(0,c.hds)(e,a);if(s){const r=n?(0,c.mBe)(e,n):void 0;return{chatId:a,chatTitle:s?.title??"Unknown",senderName:r?`${r.firstName||""} ${r.lastName||""}`:"",content:t.text}}return null});A({role:"user",content:`你是一个专业的聊天记录分析师,用户输入的关键词是${t},下面是根据关键词检索出来的相关的聊天记录,请对此加以总结:\n          # 总结消息偏好:\n              ## 根据消息的内容选择合适的语种进行总结\n              ## 过滤所有的无意义消息；\n              ## 尽量提取关键信息(如任务、问题、请求等),并简要总结。\n              ## 为保证输出内容的完整性,尽量精简总结内容；\n              ## 主话题不超过5个,子话题总数不超过15个\n          # 消息内容\n          ${JSON.stringify(n)}\n        `,id:Math.random().toString(),annotations:[{isAuxiliary:!0}]},{headers:(0,Qc.RR)()}),o()}},[A,e,o]),f=(0,Al.useCallback)(e=>{fetch(`${i.Vjs}/tool-check`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:[{id:(0,Gc.A)(),content:e,role:"user"}]})}).then(e=>e.json()).then(t=>{t&&t.length>0&&t.forEach(t=>{"checkIsSearchGroup"===t.toolName?g(t.result.keyword):"checkIsSearchUser"===t.toolName?v(t.result.keyword):"nullTool"===t.toolName&&(console.log("没有命中工具"),E(e))})})},[g,E,v]),b=(0,Al.useCallback)(e=>{u(t=>[...t,{role:"user",content:e,id:Math.random().toString(),createdAt:new Date}]),f(e)},[u,f]);return Al.createElement("div",{className:"pb-[28px] flex-1 flex flex-col h-full gap-[8px] overflow-hidden"},Al.createElement(zc.B,{className:"chat-ai-output-wrapper flex-1",status:h,messages:m,loadMore:p,hasMore:n.hasMore,chatId:fd}),Al.createElement("form",{className:"flex mx-auto gap-2 w-full"},Al.createElement(yd,{status:h,stop:y,setMessages:u,handleSearch:b})))}}),Cd=()=>{const e=(0,n.li)(void 0);return(0,n.vJ)(()=>{let t;return e.current&&(t=bd(e.current)),()=>{t?.unmount()}},[]),n.Ay.createElement("div",{className:"LeftSearch--content",ref:e})};var Sd=a(57309);function kd(e){return(t,a)=>{const n=(0,c.nTw)(t),{byId:s}=t.chats,{byId:r}=t.users,{fetchingStatus:i,resultsByType:o,chatId:l}=n.globalSearch,{shouldWarnAboutSvg:d}=(0,hs.l)(t),m="audio"!==e?e:a?.isVoice?"voice":"audio",{byChatId:u}=t.messages,A=o?.[m]?.foundIds,h=n.activeDownloads;return{theme:(0,c.SJA)(t),isLoading:void 0===A||!!i&&Boolean(i.chats||i.messages),chatsById:s,usersById:r,globalMessagesByChatId:u,foundIds:A,searchChatId:l,activeDownloads:h,isChatProtected:l?(0,c.hds)(t,l)?.isProtected:void 0,shouldWarnAboutSvg:d}}}var wd=a(55429),Nd=a(65240),Id=a(42827);const Pd=(0,ye.nF)(e=>e(),500,!0),Md=(0,n.ph)((0,s.EK)(kd("audio"))(({theme:e,isVoice:t,searchQuery:a,isLoading:o,chatsById:c,usersById:d,globalMessagesByChatId:m,foundIds:u,activeDownloads:A})=>{const{searchMessagesGlobal:h,focusMessage:y,openAudioPlayer:p}=(0,s.ko)(),g=(0,B.A)(),v=t?"voice":"audio",E=(0,n.hb)(({direction:e})=>{e===r.TN.Backwards&&Pd(()=>{h({type:v})})},[v,h,a]),f=(0,n.Kr)(()=>u&&m?u.map(e=>{const[t,a]=(0,Sd.a)(e);return m[t]?.byId[a]}).filter(Boolean):fa.p,[m,u]),b=(0,n.hb)(e=>{y({chatId:e.chatId,messageId:e.id})},[y]),C=(0,n.hb)((e,t)=>{p({chatId:t,messageId:e})},[p]),S=(0,so.A)([a],i.jhd)&&!o;return n.Ay.createElement(ne.Ay,{slideClassName:"LeftSearch--content",name:"fade",activeKey:S?1:0,shouldCleanup:!0},n.Ay.createElement(fn.A,{className:"search-content documents-list custom-scroll",items:S?f:void 0,onLoadMore:E,noFastList:!0},!S&&n.Ay.createElement(Dn.A,null),S&&(!u||0===u.length)&&n.Ay.createElement(Id.A,{withSticker:!0,text:g("ChatList.Search.NoResults"),description:g("ChatList.Search.NoResultsDescription")}),S&&u&&u.length>0&&f.map((t,a)=>{const i=(0,s.mS)(),o=0===a||(0,$e.$$)(t.date)!==(0,$e.$$)(f[a-1].date),m=(0,Te.iS)(i,t);return n.Ay.createElement(n.Ay.Fragment,null,o&&n.Ay.createElement("p",{className:"section-heading",key:t.date,dir:g.isRtl?"rtl":void 0},(0,$e.i6)(g,new Date(1e3*t.date))),n.Ay.createElement("div",{className:"ListItem small-icon",key:t.id},n.Ay.createElement(Nd.Ay,{key:t.id,theme:e,message:t,origin:r.d9.Search,senderTitle:(0,wd.N)(g,t,c,d),date:t.date,className:"scroll-item",onPlay:C,onDateClick:b,canDownload:!c[t.chatId]?.isProtected&&!t.isProtected,isDownloading:(0,l.$r)(A,m)})))})))}));var Td=a(27109),xd=a(47067);const Bd=e=>{const t=(0,n.li)(),a=(0,n.hb)(a=>{"Enter"===a.key&&t.current===document.activeElement&&e()},[e]);return(0,n.vJ)(()=>(window.addEventListener("keydown",a,!1),()=>window.removeEventListener("keydown",a,!1)),[a]),t};var Ld=a(97967),Rd=a(97046);const Fd=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const a=(0,c.hds)(e,t);return{chat:a,user:(0,c.mBe)(e,t),isPinned:(0,c.D3D)(e,t),isMuted:a&&(0,Td.If)(a,(0,c.K52)(e),(0,c.P5N)(e,a.id)),canChangeFolder:Boolean(e.chatFolders.orderedIds?.length)}})(({chatId:e,withUsername:t,chat:a,user:i,isPinned:o,isMuted:l,canChangeFolder:c,withOpenAppButton:d,onClick:m})=>{const{requestMainWebView:u}=(0,s.ko)(),h=(0,B.A)(),[y,p,g]=(0,M.A)(),[v,E,f]=(0,M.A)(),[b,C,S]=(0,M.A)(),[k,w,N]=(0,M.A)(),I=(0,n.hb)(()=>{C(),E()},[C,E]),P=(0,n.hb)(()=>{w(),p()},[w,p]),T=(0,xd.A)({chat:a,user:i,isPinned:o,isMuted:l,canChangeFolder:c,handleMute:P,handleChatFolderChange:I},!0),L=(0,x.A)(()=>{m(e)}),R=(0,x.A)(t=>{t.stopPropagation();const a=(0,Ns.A)();u({botId:e,peerId:e,theme:a})}),F=Bd(L);return n.Ay.createElement(ca.A,{className:"chat-item-clickable search-result",onClick:L,contextActions:T,buttonRef:F},(0,A.L8)(e)?n.Ay.createElement(kn.A,{userId:e,withUsername:t,withStory:!0,avatarSize:"medium",storyViewerOrigin:r.G9.SearchResult}):n.Ay.createElement(Sn.A,{chatId:e,withUsername:t,avatarSize:"medium",withStory:!0,storyViewerOrigin:r.G9.SearchResult}),d&&i?.hasMainMiniApp&&n.Ay.createElement(Y.A,{className:"ChatBadge miniapp",pill:!0,fluid:!0,size:"tiny",onClick:R},h("BotOpen")),k&&n.Ay.createElement(Rd.A,{isOpen:y,onClose:g,onCloseAnimationEnd:N,chatId:e}),b&&n.Ay.createElement(Ld.A,{isOpen:v,onClose:f,onCloseAnimationEnd:S,chatId:e}))})),Dd=(0,ye.nF)(e=>e(),500,!0),Vd=(0,n.ph)((0,s.EK)(e=>{const t=(0,c.nTw)(e).globalSearch,a=t.popularBotApps?.peerIds;return{isLoading:!a&&t.fetchingStatus?.botApps,foundIds:a,recentBotIds:e.topBotApps.userIds}})(({searchQuery:e,isLoading:t,foundIds:a,recentBotIds:o})=>{const{searchPopularBotApps:l,openChatWithInfo:c}=(0,s.ko)(),d=(0,n.li)(),m=(0,B.A)(),[u,A]=(0,n.J0)(!1),h=(0,n.Kr)(()=>{if(!a)return[];const t=new Set(o),n=a.filter(e=>!t.has(e));return(0,Mt.PU)({ids:n,query:e,type:"user"})},[a,o,e]),y=(0,x.A)(e=>{c({id:e,shouldReplaceHistory:!0})}),p=(0,n.hb)(({direction:e})=>{e===r.TN.Backwards&&Dd(()=>{l()})},[]),g=(0,x.A)(()=>{A(e=>!e)}),v=(0,so.A)([e],i.jhd)&&!t;return n.Ay.createElement(ne.Ay,{ref:d,slideClassName:"LeftSearch--content",name:"fade",activeKey:v?1:0,shouldCleanup:!0},n.Ay.createElement(fn.A,{className:"search-content custom-scroll",items:v?h:void 0,onLoadMore:p,noFastList:!0},!v&&n.Ay.createElement(Dn.A,null),v&&!h?.length&&n.Ay.createElement(Id.A,{withSticker:!0,text:m("ChatList.Search.NoResults"),description:m("ChatList.Search.NoResultsDescription")}),v&&!e&&Boolean(o?.length)&&n.Ay.createElement("div",{className:"search-section"},n.Ay.createElement("h3",{className:"section-heading"},o.length>5&&n.Ay.createElement(Ni.A,{className:"Link",onClick:g},m(u?"ChatList.Search.ShowLess":"ChatList.Search.ShowMore")),m("SearchAppsMine")),o.map((e,t)=>{if(u||!(t>=5))return n.Ay.createElement(Fd,{chatId:e,onClick:y,withOpenAppButton:!0})})),v&&Boolean(h?.length)&&n.Ay.createElement("div",{className:"search-section"},n.Ay.createElement("h3",{className:"section-heading"},m("SearchAppsPopular")),h.map(e=>n.Ay.createElement(Fd,{chatId:e,onClick:y,withOpenAppButton:!0})))))}));var _d=a(35749),Ud=a(2338);const Od=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const a=(0,c.hds)(e,t);if(!a)return{};const n=(0,l.e7)(a),s=n?(0,c.mBe)(e,n):void 0;return{chat:a,...n&&{privateChatUser:s}}})(({message:e,searchQuery:t,chatId:a,chat:r,privateChatUser:i})=>{const{focusMessage:o}=(0,s.ko)(),{isMobile:c}=(0,I.Ay)(),d=(0,Ud.A)(e),m=(0,l.fP)(e)?void 0:d,u=(0,_d.A)(e,"micro"),A=(0,H.A)(u),h=Boolean((0,l.lk)(e)),p=(0,x.A)(()=>{o({chatId:a,messageId:e.id,shouldReplaceHistory:!0})}),g=(0,B.A)(),v=Bd(p);if(!r)return;const E=i||r;return n.Ay.createElement(ca.A,{className:"ChatMessage chat-item-clickable",ripple:!c,onClick:p,buttonRef:v},n.Ay.createElement(xt.A,{peer:E,isSavedMessages:i?.isSelf}),n.Ay.createElement("div",{className:"info"},n.Ay.createElement("div",{className:"info-row"},n.Ay.createElement(Vn.A,{peer:E,withEmojiStatus:!0,isSavedMessages:a===i?.id&&i?.isSelf}),n.Ay.createElement("div",{className:"message-date"},n.Ay.createElement(Ni.A,{className:"date"},(0,$e.be)(g,1e3*e.date)))),n.Ay.createElement("div",{className:"subtitle"},n.Ay.createElement("div",{className:"message",dir:"auto"},function(e,t,a,s,r){if(!a)return(0,y.C)(e,t,void 0,s);const i=(0,l.y2)(t);return n.Ay.createElement("span",{className:"media-preview"},n.Ay.createElement("img",{src:a,alt:"",className:(0,ue.A)("media-preview--image",r&&"round",i&&"media-preview-spoiler"),draggable:!1}),(0,l.zX)(t)&&n.Ay.createElement(Q.A,{name:"play"}),(0,y.C)(e,t,!0,s))}(g,e,A||m,t,h)))))})),Jd=(0,n.ph)(({searchDate:e,onSelect:t})=>{const a=(0,n.Kr)(()=>function(e){if(e.match(/^\d{2,4}-\d{2}-\d{2}$/g)){const t=new Date(e);return[{date:t,text:(0,$e.A)(t)}]}const t=[],a=new Date,n=a.getFullYear(),s=a.getTime()>new Date(`${n}-${e}`).getTime()?n:n-1;for(let a=0;a<8;a++){const n=new Date(`${s-a}-${e}`);t.push({date:n,text:(0,$e.A)(n)})}return t}(e),[e]);return n.Ay.createElement("section",{className:"DateSuggest custom-scroll custom-scroll-x"},a.map(({date:e,text:a})=>n.Ay.createElement("div",{onClick:()=>t(e),className:"date-item",key:a},n.Ay.createElement(Q.A,{name:"calendar"}),n.Ay.createElement("span",null,a))))}),Kd=2*h.$,Gd=(0,n.ph)((0,s.EK)((e,{chatId:t,topicId:a})=>({topic:(0,c.S0q)(e,t,a)}))(({topicId:e,topic:t,onClick:a})=>{const s=(0,n.hb)(()=>{a(e)},[e,a]),r=Bd(s);if(t)return n.Ay.createElement(ca.A,{className:"chat-item-clickable search-result",onClick:s,buttonClassName:"topic-item",buttonRef:r},n.Ay.createElement(_n.A,{size:Kd,topic:t,className:"topic-icon",letterClassName:"topic-icon-letter"}),n.Ay.createElement("div",{dir:"auto",className:"fullName"},(0,Tt.A)(t.title)))})),jd=(0,ye.nF)(e=>e(),500,!0),zd=(0,n.ph)((0,s.EK)(e=>{const{byId:t}=e.chats,{currentUserId:a,messages:{byChatId:n}}=e,{fetchingStatus:s,resultsByType:r,foundTopicIds:i,chatId:o}=(0,c.nTw)(e).globalSearch,{foundIds:l}=r?.text||{};return{currentUserId:a,foundIds:l,globalMessagesByChatId:n,chatsById:t,fetchingStatus:s,foundTopicIds:i,searchChatId:o}})(({searchQuery:e,dateSearchQuery:t,foundIds:a,globalMessagesByChatId:i,chatsById:o,fetchingStatus:l,foundTopicIds:c,searchChatId:d,onSearchDateSelect:m,onReset:u})=>{const{searchMessagesGlobal:A,openThread:h}=(0,s.ko)(),p=(0,B.A)(),{isMobile:g}=(0,I.Ay)(),v=(0,n.hb)(({direction:e})=>{e===r.TN.Backwards&&jd(()=>{A({type:"text"})})},[e]),E=(0,n.hb)(e=>{d&&(h({chatId:d,threadId:e,shouldReplaceHistory:!0}),g||u())},[d,g,u]),f=(0,n.Kr)(()=>a&&0!==a.length?a.map(e=>{const[t,a]=(0,Sd.a)(e);return i?.[t]?.byId[a]}).filter(Boolean).sort((e,t)=>t.date-e.date):fa.p,[a,i]),b=l&&!l.chats&&!l.messages&&!f.length&&!c?.length;return n.Ay.createElement("div",{className:"LeftSearch--content"},n.Ay.createElement(fn.A,{className:"search-content custom-scroll chat-list",items:f,onLoadMore:v,noFastList:!0},t&&n.Ay.createElement("div",{className:"chat-selection no-scrollbar"},n.Ay.createElement(Jd,{searchDate:t,onSelect:m})),b&&n.Ay.createElement(Id.A,{withSticker:!0,text:p("ChatList.Search.NoResults"),description:p("ChatList.Search.NoResultsDescription")}),Boolean(c?.length)&&n.Ay.createElement("div",{className:"pb-2"},n.Ay.createElement("h3",{className:"section-heading topic-search-heading",dir:p.isRtl?"auto":void 0},p("Topics")),c.map(e=>n.Ay.createElement(Gd,{chatId:d,topicId:e,onClick:E}))),Boolean(f.length)&&n.Ay.createElement("div",{className:"pb-2"},n.Ay.createElement("h3",{className:"section-heading topic-search-heading",dir:p.isRtl?"auto":void 0},p("SearchMessages")),f.map(function(t){const a=(0,y.C)(p,t),s=o[t.chatId];if(a&&s)return n.Ay.createElement(Od,{chatId:t.chatId,message:t,searchQuery:e})}))))}));var Hd=a(60048),$d=a(81949);const qd=(0,n.ph)(({sponsoredPeer:e,observeIntersection:t})=>{const a=(0,n.li)(),{clickSponsored:i,viewSponsored:o,openChat:l}=(0,s.ko)(),c=(0,Ua.A)(),{peerId:d,randomId:m,additionalInfo:u,sponsorInfo:h}=e;(0,io.mv)(a,t,e=>{1===e.intersectionRatio&&o({randomId:m})});const y=(0,x.A)(()=>{i({randomId:m}),l({id:d})}),{isContextMenuOpen:p,contextMenuAnchor:g,handleBeforeContextMenu:v,handleContextMenu:E,handleContextMenuClose:f,handleContextMenuHide:b}=(0,vs.A)(a),{handleClick:C,handleMouseDown:S}=(0,en.Q)(e=>{e.stopPropagation(),E(e)}),k=Bd(y);return n.Ay.createElement(ca.A,{ref:a,className:"chat-item-clickable search-result",onClick:y,onMouseDown:v,onContextMenu:E,buttonRef:k},(0,A.L8)(d)?n.Ay.createElement(kn.A,{userId:d,withUsername:!0,withStory:!0,avatarSize:"medium",storyViewerOrigin:r.G9.SearchResult}):n.Ay.createElement(Sn.A,{chatId:d,withUsername:!0,avatarSize:"medium",withStory:!0,storyViewerOrigin:r.G9.SearchResult}),n.Ay.createElement($d.A,{className:"search-sponsored-badge",onMouseDown:S,onClick:C},c("SponsoredPeerBadge"),n.Ay.createElement(Q.A,{name:"more"})),g&&n.Ay.createElement(_l.A,{isOpen:p,anchor:g,triggerRef:a,randomId:m,additionalInfo:u,canReport:!0,sponsorInfo:h,onClose:f,onCloseAnimationEnd:b}))}),Wd=(0,ye.nF)(e=>e(),6e4,!0),Qd=(0,n.ph)((0,s.EK)(e=>{const{userIds:t}=e.topPeers,a=e.users.byId,{recentlyFoundChatIds:n}=e;return{topUserIds:t,usersById:a,recentlyFoundChatIds:n}})(({topUserIds:e,usersById:t,recentlyFoundChatIds:a,onReset:r})=>{const{loadTopUsers:i,openChat:o,addRecentlyFoundChatId:c,clearRecentlyFoundChats:d}=(0,s.ko)(),m=(0,n.li)();(0,n.vJ)(()=>{Wd(()=>{i()})},[i]),(0,ks.A)(m,!e);const u=(0,n.hb)(e=>{o({id:e,shouldReplaceHistory:!0}),r(),setTimeout(()=>{c({id:e})},250)},[o,c,r]),A=(0,n.hb)(()=>{d()},[d]),h=(0,B.A)();return n.Ay.createElement("div",{className:"RecentContacts custom-scroll"},e&&n.Ay.createElement("div",{className:"top-peers-section",dir:h.isRtl?"rtl":void 0},n.Ay.createElement("div",{ref:m,className:"top-peers"},e.map(e=>n.Ay.createElement("div",{key:e,className:"top-peer-item",onClick:()=>u(e),dir:h.isRtl?"rtl":void 0},n.Ay.createElement(xt.A,{peer:t[e]}),n.Ay.createElement("div",{className:"top-peer-name"},(0,Tt.A)((0,l.u0)(t[e])||" ")))))),a&&n.Ay.createElement("div",{className:"search-section pt-1"},n.Ay.createElement("h3",{className:(0,ue.A)("section-heading mt-0 recent-chats-header",!e&&"without-border"),dir:h.isRtl?"rtl":void 0},h("Recent"),n.Ay.createElement(Y.A,{className:"clear-recent-chats",round:!0,size:"smaller",color:"translucent",ariaLabel:h("Clear"),onClick:A,isRtl:h.isRtl},n.Ay.createElement(Q.A,{name:"close"}))),a.map(e=>n.Ay.createElement(Fd,{chatId:e,withOpenAppButton:!0,onClick:u}))))})),Yd=(0,ye.nF)(e=>e(),500,!1),Zd=(0,n.ph)((0,s.EK)((e,{isChannelList:t})=>{const{userIds:a}=e.contactList||{},{currentUserId:n,messages:s}=e;if(!a)return{};const{fetchingStatus:r,globalResults:o,localResults:l,resultsByType:d,sponsoredPeer:m}=(0,c.nTw)(e).globalSearch,{peerIds:u}=o||{},{peerIds:A}=l||{},{byChatId:h}=s,y=d?.[t?"channels":"text"]?.foundIds,{similarChannelIds:p}=(0,c.dg4)(e,i.rBM)||{};return{currentUserId:n,contactIds:a,accountPeerIds:A,globalPeerIds:u,foundIds:y,globalMessagesByChatId:h,fetchingStatus:r,sponsoredPeer:m,suggestedChannelIds:p}})(({isChannelList:e,searchQuery:t,searchDate:a,dateSearchQuery:o,currentUserId:c,contactIds:d,accountPeerIds:m,globalPeerIds:u,foundIds:A,globalMessagesByChatId:h,fetchingStatus:p,suggestedChannelIds:g,sponsoredPeer:v,onReset:E,onSearchDateSelect:f})=>{const{openChat:b,addRecentlyFoundChatId:C,searchMessagesGlobal:S,setGlobalSearchChatId:k,loadChannelRecommendations:w}=(0,s.ko)(),N=(0,n.li)(),P=(0,n.li)(),M=(0,B.A)(),T=(0,Ua.A)(),{isMobile:L}=(0,I.Ay)(),[R,F]=(0,n.J0)(!1),[D,V]=(0,n.J0)(!1),[_,U]=(0,n.J0)("all"),O=(0,n.li)();(0,fe.A)(()=>{e&&w({})});const J=(0,n.hb)(({direction:t})=>{t===r.TN.Backwards&&Yd(()=>{S({type:e?"channels":"text",context:_})})},[t,_]),K=(0,n.hb)(e=>{b({id:e,shouldReplaceHistory:!0}),e!==c&&C({id:e}),L||E()},[b,c,L,C,E]),G=(0,n.hb)(e=>{k({id:e})},[k]);function j(e){return T("users"===e?"PrivateChatsSearchContext":"groups"===e?"GroupChatsSearchContext":"channels"===e?"ChannelsSearchContext":"AllChatsSearchContext")}const{isContextMenuOpen:z,contextMenuAnchor:H,handleContextMenu:$,handleContextMenuClose:q,handleContextMenuHide:W}=(0,vs.A)(O),Y=(0,x.A)(()=>O.current),Z=(0,x.A)(()=>O.current.querySelector(".chatResultsContextMenu .bubble")),X=(0,x.A)(()=>O.current.querySelector(".menuTrigger")),ee=(0,x.A)(e=>{$(e)}),te=(0,ue.A)("icon","iconPlaceholder"),ae=(0,n.Kr)(()=>{if(!e&&(!t||t.startsWith("@")&&t.length<2))return fa.p;const a=(0,s.mS)().chats.byId,n=((0,Hd.YA)(i.DSF)??[]).filter(t=>{if(!e)return!0;const n=a[t];return n&&(0,l.WX)(n)}),r=(0,Mt.PU)({ids:n,query:t,type:"chat"});if(e)return r;const o=[...c?[c]:[],...d||[]],u=[...(0,Mt.PU)({ids:o,query:t,type:"user"}),...r];return(0,Ea.Am)([...(0,xn.A)(u,void 0,c?[c]:void 0),...(0,xn.A)(m||[])])},[t,c,d,m,e]);(0,ks.A)(P,!ae.length||e,!0);const se=(0,n.Kr)(()=>{if(!t||t.length<4||!u)return fa.p;const a=(0,s.mS)().chats.byId,n=u.filter(t=>{if(!e)return!0;const n=a[t];return n&&(0,l.WX)(n)});return(0,xn.A)(n,!0)},[u,e,t]),re=(0,n.Kr)(()=>{if(!t&&!a||!A||0===A.length)return fa.p;const n=(0,s.mS)().chats.byId;return A.map(t=>{const[a,s]=(0,Sd.a)(t),r=n[a];if(r&&(!e||(0,l.WX)(r)))return h?.[a]?.byId[s]}).filter(Boolean)},[t,a,A,e,h]);(0,n.vJ)(()=>{t&&S({type:e?"channels":"text",context:_,shouldResetResultsByType:!0,shouldCheckFetchingMessagesStatus:!0})},[_]);const ie=(0,n.hb)(()=>{F(!R)},[R]),oe=(0,n.hb)(()=>{V(!D)},[D]),le=re,de="all"===_&&p&&!p.chats&&!p.messages&&!ae.length&&!se.length&&!le.length,me=p?.messages,Ae=!t&&!a&&!e,{observe:he}=(0,io.BL)({rootRef:N,throttleMs:200,isDisabled:!Ae});if(Ae)return n.Ay.createElement(Qd,{onReset:E});const ye="all"!==_||Boolean(le.length);return n.Ay.createElement(fn.A,{ref:N,className:"LeftSearch--content custom-scroll",items:le,onLoadMore:J,noScrollRestoreOnTop:!0,noFastList:!0},o&&n.Ay.createElement("div",{className:"chat-selection no-scrollbar"},n.Ay.createElement(Jd,{searchDate:o,onSelect:f})),de&&n.Ay.createElement(Id.A,{withSticker:!0,text:M("ChatList.Search.NoResults"),description:M("ChatList.Search.NoResultsDescription")}),Boolean(ae.length)&&!e&&n.Ay.createElement("div",{className:"chat-selection no-scrollbar",dir:M.isRtl?"rtl":void 0,ref:P},ae.map(e=>n.Ay.createElement(Oo.A,{peerId:e,className:"left-search-local-suggestion",onClick:G,clickArg:e}))),Boolean(ae.length)&&n.Ay.createElement("div",{className:"search-section"},n.Ay.createElement("h3",{className:"section-heading",dir:M.isRtl?"auto":void 0},ae.length>5&&n.Ay.createElement(Ni.A,{className:"Link",onClick:ie},M(R?"ChatList.Search.ShowLess":"ChatList.Search.ShowMore")),M(e?"SearchMyChannels":"DialogList.SearchSectionDialogs")),ae.map((e,t)=>{if(R||!(t>=5))return n.Ay.createElement(Fd,{withOpenAppButton:!0,chatId:e,onClick:K})})),Boolean(se.length)&&n.Ay.createElement("div",{className:"search-section"},n.Ay.createElement("h3",{className:"section-heading",dir:M.isRtl?"auto":void 0},se.length>5&&n.Ay.createElement(Ni.A,{className:"Link",onClick:oe},M(D?"ChatList.Search.ShowLess":"ChatList.Search.ShowMore")),M("DialogList.SearchSectionGlobal")),v&&n.Ay.createElement(qd,{sponsoredPeer:v,observeIntersection:he}),se.map((e,t)=>{if(D||!(t>=5))return n.Ay.createElement(Fd,{chatId:e,withUsername:!0,onClick:K})})),Boolean(g?.length)&&!t&&n.Ay.createElement("div",{className:"search-section"},n.Ay.createElement("h3",{className:"section-heading",dir:M.isRtl?"auto":void 0},M("SearchRecommendedChannels")),g.map(e=>n.Ay.createElement(Fd,{chatId:e,withUsername:!0,onClick:K}))),n.Ay.createElement("div",{className:"menuOwner",ref:O},n.Ay.createElement(We.A,{isOpen:z,anchor:H,getTriggerElement:X,getRootElement:Y,getMenuElement:Z,className:"chatResultsContextMenu",onClose:q,onCloseAnimationEnd:W,autoClose:!0},n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(ce.A,{icon:"all"===_?"check":void 0,customIcon:"all"!==_?n.Ay.createElement("i",{className:te}):void 0,onClick:()=>U("all")},j("all")),n.Ay.createElement(ce.A,{icon:"users"===_?"check":void 0,customIcon:"users"!==_?n.Ay.createElement("i",{className:te}):void 0,onClick:()=>U("users")},j("users")),n.Ay.createElement(ce.A,{icon:"groups"===_?"check":void 0,customIcon:"groups"!==_?n.Ay.createElement("i",{className:te}):void 0,onClick:()=>U("groups")},j("groups")),n.Ay.createElement(ce.A,{icon:"channels"===_?"check":void 0,customIcon:"channels"!==_?n.Ay.createElement("i",{className:te}):void 0,onClick:()=>U("channels")},j("channels")))),ye&&n.Ay.createElement("div",{className:"search-section"},n.Ay.createElement("h3",{className:"section-heading",dir:M.isRtl?"auto":void 0},!e&&n.Ay.createElement(Ni.A,{className:"Link menuTrigger dropDownLink",onClick:ee},T("SearchContextCaption",{type:j(_)},{withNodes:!0}),n.Ay.createElement(ne.Ay,{name:"fade",shouldCleanup:!0,activeKey:Number(me),className:"iconContainer",slideClassName:"iconContainerSlide"},me&&n.Ay.createElement(Dn.A,null),!me&&n.Ay.createElement(Q.A,{name:"down"}))),M("SearchMessages")),le.map(function(e){const a=(0,s.mS)().chats.byId,r=(0,y.C)(M,e),i=a[e.chatId];if(r&&i)return n.Ay.createElement(Od,{chatId:e.chatId,message:e,searchQuery:t})}))))}));var Xd=a(44589);const em="documents",tm=(0,ye.nF)(e=>e(),500,!0),am=(0,n.ph)((0,s.EK)(kd(em))(({searchQuery:e,isLoading:t,chatsById:a,usersById:o,globalMessagesByChatId:c,foundIds:d,activeDownloads:m,shouldWarnAboutSvg:u})=>{const{searchMessagesGlobal:A,focusMessage:h}=(0,s.ko)(),y=(0,n.li)(),p=(0,B.A)(),{observe:g}=(0,io.BL)({rootRef:y,throttleMs:500}),v=(0,n.hb)(({direction:e})=>{e===r.TN.Backwards&&tm(()=>{A({type:em})})},[e]),E=(0,n.Kr)(()=>d&&c?d.map(e=>{const[t,a]=(0,Sd.a)(e),n=c[t]?.byId[a];return n&&(0,l.zC)(n)?n:void 0}).filter(Boolean):fa.p,[c,d]),f=(0,n.hb)(e=>{h({chatId:e.chatId,messageId:e.id})},[h]),b=(0,so.A)([e],i.jhd)&&!t;return n.Ay.createElement(ne.Ay,{ref:y,slideClassName:"LeftSearch--content",name:"fade",activeKey:b?1:0,shouldCleanup:!0},n.Ay.createElement(fn.A,{className:"search-content documents-list custom-scroll",items:b?E:void 0,onLoadMore:v,noFastList:!0},!b&&n.Ay.createElement(Dn.A,null),b&&(!d||0===d.length)&&n.Ay.createElement(Id.A,{withSticker:!0,text:p("ChatList.Search.NoResults"),description:p("ChatList.Search.NoResultsDescription")}),b&&d&&d.length>0&&E.map((e,t)=>{const s=0===t||(0,$e.$$)(e.date)!==(0,$e.$$)(E[t-1].date);return n.Ay.createElement(n.Ay.Fragment,null,s&&n.Ay.createElement("p",{className:"section-heading",dir:p.isRtl?"rtl":void 0,key:e.date},(0,$e.i6)(p,new Date(1e3*e.date))),n.Ay.createElement("div",{className:"ListItem small-icon",key:e.id},n.Ay.createElement(Xd.A,{document:(0,l.zC)(e),message:e,withDate:!0,datetime:e.date,smaller:!0,sender:(0,wd.N)(p,e,a,o),className:"scroll-item",isDownloading:(0,l.$r)(m,e.content.document),shouldWarnAboutSvg:u,observeIntersection:g,onDateClick:f})))})))}));var nm=a(37378);const sm="links",rm=(0,ye.nF)(e=>e(),500,!0),im=(0,n.ph)((0,s.EK)(kd(sm))(({searchQuery:e,isLoading:t,chatsById:a,usersById:o,globalMessagesByChatId:l,foundIds:c,isChatProtected:d})=>{const{searchMessagesGlobal:m,focusMessage:u}=(0,s.ko)(),A=(0,n.li)(),h=(0,B.A)(),{observe:y}=(0,io.BL)({rootRef:A,throttleMs:500}),p=(0,n.hb)(({direction:e})=>{e===r.TN.Backwards&&rm(()=>{m({type:sm})})},[e]),g=(0,n.Kr)(()=>c&&l?c.map(e=>{const[t,a]=(0,Sd.a)(e);return l[t]?.byId[a]}).filter(Boolean):fa.p,[l,c]),v=(0,n.hb)(e=>{u({chatId:e.chatId,messageId:e.id})},[u]),E=(0,so.A)([e],i.jhd)&&!t;return n.Ay.createElement(ne.Ay,{ref:A,slideClassName:"LeftSearch--content",name:"fade",activeKey:E?1:0,shouldCleanup:!0},n.Ay.createElement(fn.A,{className:"search-content documents-list custom-scroll",items:E?g:void 0,onLoadMore:p,noFastList:!0},!E&&n.Ay.createElement(Dn.A,null),E&&(!c||0===c.length)&&n.Ay.createElement(Id.A,{withSticker:!0,text:h("ChatList.Search.NoResults"),description:h("ChatList.Search.NoResultsDescription")}),E&&c&&c.length>0&&g.map((e,t)=>{const s=0===t||(0,$e.$$)(e.date)!==(0,$e.$$)(g[t-1].date);return n.Ay.createElement(n.Ay.Fragment,null,s&&n.Ay.createElement("p",{className:"section-heading",key:e.date,dir:h.isRtl?"rtl":void 0},(0,$e.i6)(h,new Date(1e3*e.date))),n.Ay.createElement("div",{className:"ListItem small-icon",dir:h.isRtl?"rtl":void 0,key:e.id},n.Ay.createElement(nm.A,{key:e.id,message:e,senderTitle:(0,wd.N)(h,e,a,o),isProtected:d||e.isProtected,observeIntersection:y,onMessageClick:v})))})))}));var om=a(81524);const lm="media",cm=(0,ye.nF)(e=>e(),500,!0),dm=(0,n.ph)((0,s.EK)(kd(lm))(({searchQuery:e,isLoading:t,globalMessagesByChatId:a,foundIds:o,isChatProtected:l})=>{const{searchMessagesGlobal:c,openMediaViewer:d}=(0,s.ko)(),m=(0,n.li)(),u=(0,B.A)(),{observe:A}=(0,io.BL)({rootRef:m,throttleMs:500}),h=(0,n.hb)(({direction:e})=>{e===r.TN.Backwards&&cm(()=>{c({type:lm})})},[c,e]),y=(0,n.Kr)(()=>o&&a?o.map(e=>{const[t,n]=(0,Sd.a)(e);return a[t]?.byId[n]}).filter(Boolean):fa.p,[a,o]),p=(0,n.hb)((e,t)=>{d({chatId:t,messageId:e,origin:r.TQ.SearchResult})},[d]),g=(0,so.A)([e],i.jhd)&&!t,v=g&&o&&o.length>0&&!e,E=g&&o&&o.length>0&&e,f=(0,ue.A)("search-content custom-scroll",E&&"chat-list");return n.Ay.createElement(ne.Ay,{ref:m,slideClassName:"LeftSearch--content LeftSearch--media",name:"fade",activeKey:g?1:0,shouldCleanup:!0},n.Ay.createElement(fn.A,{className:f,items:g?y:void 0,itemSelector:e?".ListItem":".Media",onLoadMore:h,noFastList:!0},!g&&n.Ay.createElement(Dn.A,null),g&&(!o||0===o.length)&&n.Ay.createElement(Id.A,{withSticker:!0,text:u("ChatList.Search.NoResults"),description:u("ChatList.Search.NoResultsDescription")}),v&&n.Ay.createElement("div",{className:"media-list",dir:u.isRtl?"rtl":void 0},y.map(e=>n.Ay.createElement(om.A,{key:`${e.chatId}-${e.id}`,idPrefix:"search-media",message:e,isProtected:l||e.isProtected,observeIntersection:A,onClick:p}))),E&&y.map(e=>n.Ay.createElement(Od,{key:e.id,chatId:e.chatId,message:e}))))}));var mm=a(537);const um={container:"fHc6WtIe",content:"N8GlyYo0",loadingScreen:"l7JTscdP",searchButtonContent:"dqfofU9e",sticker:"bhaEA7Az",title:"HkiOz0kI",description:"B5FR0TSV",searchButton:"Ii0w2ObZ",remainingSearches:"fYxU7PVl",searchIcon:"NMdA935k",searchIconWithNext:"NqAG2PXY",searchQuery:"eRsI0lkH",limitTitle:"uAggPEqN",limitDescription:"oirV9yqd",paidSearchButton:"LMu5PMXS",freeSearchUnlock:"IdgXsecy",premiumTitle:"SBmNHjsL",premiumDescription:"KoW3G8Sv",subscribePremiumButton:"tGWjYFeK",premiumSubtitle:"o2V6uF3Y"},Am=(0,n.ph)((0,s.EK)(e=>({isCurrentUserPremium:(0,c.g29)(e),starsBalance:e.stars?.balance?.amount||0}))(({searchQuery:e,searchFlood:t,onSearch:a,isLoading:r,isCurrentUserPremium:o,starsBalance:l})=>{const c=(0,Ua.A)(),d=t?.queryIsFree,m=t?.query,u=(0,mm.A)([e?.slice(0,18).trimEnd()]),A=(0,x.A)(()=>{a()});(0,n.vJ)(()=>{d&&e&&m===e&&a()},[d,e,m,a]);const h=(0,x.A)(()=>{const e=t?.starsAmount||0;l<e?g({topup:{balanceNeeded:e}}):a()}),{checkSearchPostsFlood:y,openPremiumModal:p,openStarsBalanceModal:g}=(0,s.ko)(),v=(0,x.A)(()=>{y({})}),E=(0,x.A)(()=>{p()}),f=(0,la.Fm)(),b=0===t?.remains||t?.waitTill&&t.waitTill>f;return n.Ay.createElement(ne.Ay,{name:"fade",activeKey:o?r?2:b?0:1:3},o?r?n.Ay.createElement("div",{className:um.container},n.Ay.createElement("div",{className:(0,ue.A)(um.content,um.loadingScreen)},n.Ay.createElement(Dn.A,null))):b?(()=>{const a=t?.waitTill,s=t?.starsAmount||i._tP,r=t?.totalDaily||i.M3$;return n.Ay.createElement("div",{className:um.container},n.Ay.createElement("div",{className:um.content},n.Ay.createElement(So.A,{className:um.sticker,size:120,tgsUrl:Co.w.Search,previewUrl:Co.d.Search,nonInteractive:!0,noLoop:!1}),n.Ay.createElement("div",{className:um.limitTitle},c("PublicPostsLimitReached")),n.Ay.createElement("div",{className:um.limitDescription},c("HintPublicPostsSearchQuota",{count:r},{pluralValue:r})),n.Ay.createElement(Y.A,{className:um.paidSearchButton,color:"primary",size:"smaller",disabled:!e,noForcedUpperCase:!0,onClick:h},c("PublicPostsSearchForStars",{stars:(0,Da.U2)(c,s,{asFont:!0})},{withNodes:!0})),Boolean(a)&&n.Ay.createElement("div",{className:um.freeSearchUnlock},n.Ay.createElement(da.A,{langKey:"UnlockTimerPublicPostsSearch",endsAt:a+2,onEnd:v}))))})():(()=>{const a=t?.remains||0;return n.Ay.createElement("div",{className:um.container},n.Ay.createElement("div",{className:um.content},n.Ay.createElement(So.A,{className:um.sticker,size:120,tgsUrl:Co.w.Search,previewUrl:Co.d.Search,nonInteractive:!0,noLoop:!1}),n.Ay.createElement("div",{className:um.title},c("GlobalSearch")),n.Ay.createElement("div",{className:um.description},c("DescriptionPublicPostsSearch")),n.Ay.createElement(Y.A,{className:um.searchButton,color:"primary",size:"smaller",noForcedUpperCase:!0,disabled:!e,onClick:A},n.Ay.createElement(ne.Ay,{name:"fade",activeKey:u},n.Ay.createElement("div",{className:um.searchButtonContent},n.Ay.createElement(Q.A,{name:"search",className:(0,ue.A)(um.searchIcon,e&&um.searchIconWithNext)}),c("ButtonSearchPublicPosts",{query:e?n.Ay.createElement("span",{className:um.searchQuery},e):""},{withNodes:!0}),e&&n.Ay.createElement(Q.A,{name:"next",className:um.nextIcon})))),n.Ay.createElement("div",{className:um.remainingSearches},c("RemainingPublicPostsSearch",{count:a},{pluralValue:a}))))})():n.Ay.createElement("div",{className:um.container},n.Ay.createElement("div",{className:um.content},n.Ay.createElement("div",{className:um.premiumTitle},c("GlobalSearch")),n.Ay.createElement("div",{className:um.premiumDescription},c("PublicPostsPremiumFeatureDescription")),n.Ay.createElement(Y.A,{className:um.subscribePremiumButton,color:"primary",size:"smaller",noForcedUpperCase:!0,onClick:E},c("PublicPostsSubscribeToPremium")),n.Ay.createElement("div",{className:um.premiumSubtitle},c("PublicPostsPremiumFeatureSubtitle")))))})),hm=(0,ye.nF)(e=>e(),500,!0),ym=(0,n.ph)((0,s.EK)(e=>{const{messages:{byChatId:t}}=e,{resultsByType:a,searchFlood:n,fetchingStatus:s}=(0,c.nTw)(e).globalSearch,r=a?.publicPosts,{foundIds:i}=r||{},o=Boolean(s?.publicPosts&&!r),l=!r&&!o,d=r&&!i?.length,{animationLevel:m}=(0,hs.l)(e);return{foundIds:i,globalMessagesByChatId:t,searchFlood:n,shouldShowSearchLauncher:l,isNothingFound:d,isLoading:o,animationLevel:m}})(({searchQuery:e,foundIds:t,globalMessagesByChatId:a,searchFlood:i,shouldShowSearchLauncher:o,isNothingFound:l,isLoading:c,animationLevel:d})=>{const{searchMessagesGlobal:m}=(0,s.ko)(),u=(0,Ua.A)(),A=(0,B.A)(),h=(0,x.A)(()=>{e&&m({type:"publicPosts",shouldResetResultsByType:!0})}),p=(0,n.hb)(({direction:e})=>{e===r.TN.Backwards&&hm(()=>{m({type:"publicPosts"})})},[]),g=(0,n.Kr)(()=>t&&0!==t.length?t.map(e=>{const[t,n]=(0,Sd.a)(e);return a?.[t]?.byId[n]}).filter(Boolean):fa.p,[t,a]);return n.Ay.createElement(ne.Ay,{name:(0,Oc.P)("slideOptimized",d,void 0,u.isRtl),activeKey:o||c?0:1},o||c?n.Ay.createElement(Am,{searchQuery:e,searchFlood:i,onSearch:h,isLoading:c}):n.Ay.createElement("div",{className:"LeftSearch--content"},n.Ay.createElement(fn.A,{key:e,className:"search-content custom-scroll chat-list",items:g,onLoadMore:p,noFastList:!0},l&&n.Ay.createElement(Id.A,{text:A("ChatList.Search.NoResults"),description:A("ChatList.Search.NoResultsDescription"),withSticker:!0}),Boolean(g.length)&&n.Ay.createElement("div",{className:"pb-2"},n.Ay.createElement("h3",{className:"section-heading",dir:u.isRtl?"auto":void 0},u("PublicPosts")),g.map(function(t){const a=(0,s.mS)().chats.byId,r=(0,y.C)(A,t),i=a[t.chatId];if(r&&i)return n.Ay.createElement(Od,{key:`${t.chatId}-${t.id}`,chatId:t.chatId,message:t,searchQuery:e})})))))})),pm=[{type:r.$C.ChatList,key:"SearchTabChats"},{type:r.$C.ChannelList,key:"SearchTabChannels"},{type:r.$C.BotApps,key:"SearchTabApps"},{type:r.$C.PublicPosts,key:"SearchTabPublicPosts"},{type:r.$C.Media,key:"SearchTabMedia"},{type:r.$C.Links,key:"SearchTabLinks"},{type:r.$C.Files,key:"SearchTabFiles"},{type:r.$C.Music,key:"SearchTabMusic"},{type:r.$C.Voice,key:"SearchTabVoice"}],gm=[{type:r.$C.ChatList,key:"SearchTabMessages"},...pm.slice(3)],vm=(0,n.ph)((0,s.EK)(e=>{const{currentContent:t,chatId:a}=(0,c.nTw)(e).globalSearch,{animationLevel:n}=(0,hs.l)(e);return{currentContent:t,chatId:a,animationLevel:n}})(({searchQuery:e,searchDate:t,isActive:a,currentContent:i=r.$C.ChatList,chatId:o,animationLevel:l,onReset:c})=>{const{setGlobalSearchContent:d,setGlobalSearchDate:m,checkSearchPostsFlood:u}=(0,s.ko)(),A=(0,Ua.A)(),[h,y]=(0,n.J0)(i),p=(0,n.Kr)(()=>(0,$e.Rm)(e),[e]);(0,n.vJ)(()=>{a&&u({})},[a]);const g=(0,n.Kr)(()=>(o?gm:pm).map(e=>({...e,title:A(e.key)})),[o,A]),v=(0,x.A)(e=>{const t=g[e];d({content:t.type}),y(e)}),E=(0,x.A)(e=>{m({date:e.getTime()/1e3})});(0,Ee.A)({isActive:a,onBack:c});const f=(0,n.li)(),b=(0,Fn.A)(f,a,void 0,".ListItem-button",!0);return n.Ay.createElement("div",{className:"LeftSearch",ref:f,onKeyDown:b},n.Ay.createElement(Jc.A,{activeTab:h,tabs:g,onSwitchTab:v}),n.Ay.createElement(ne.Ay,{name:(0,Oc.P)("slideOptimized",l,void 0,A.isRtl),renderCount:g.length,activeKey:i},(()=>{switch(i){case r.$C.ChatList:case r.$C.ChannelList:return o?n.Ay.createElement(zd,{searchQuery:e,dateSearchQuery:p,onReset:c,onSearchDateSelect:E}):n.Ay.createElement(Zd,{isChannelList:i===r.$C.ChannelList,searchQuery:e,searchDate:t,dateSearchQuery:p,onReset:c,onSearchDateSelect:E});case r.$C.Media:return n.Ay.createElement(dm,{searchQuery:e});case r.$C.Links:return n.Ay.createElement(im,{searchQuery:e});case r.$C.Files:return n.Ay.createElement(am,{searchQuery:e});case r.$C.Music:return n.Ay.createElement(Md,{key:"audio",searchQuery:e});case r.$C.Voice:return n.Ay.createElement(Md,{key:"voice",isVoice:!0,searchQuery:e});case r.$C.BotApps:return n.Ay.createElement(Vd,{key:"botApps",searchQuery:e});case r.$C.AI:return n.Ay.createElement(Cd,null);case r.$C.PublicPosts:return n.Ay.createElement(ym,{key:"publicPosts",searchQuery:e});default:return}})()))}));var Em=a(42215);const fm={currentPassword:"",password:"",hint:"",email:""},bm=(e,t)=>{switch(t.type){case"setCurrentPassword":return{...e,currentPassword:t.payload};case"setPassword":return{...e,password:t.payload};case"setHint":return{...e,hint:t.payload};case"setEmail":return{...e,email:t.payload};case"reset":return fm;default:return e}};var Cm=a(60406),Sm=a(31880),km=a(58968),wm=a(74984);const Nm=(0,n.ph)((0,s.EK)(e=>({maxChats:(0,dr.d)(e,"dialogFiltersChats")}))(({mode:e,state:t,dispatch:a,isActive:r,onReset:o,onSaveFilter:l,maxChats:c})=>{const d=(0,B.A)(),{openLimitReachedModal:m}=(0,s.ko)(),{chatFilter:u}=t,{selectedChatIds:A,selectedChatTypes:h}=(0,n.Kr)(()=>(0,Sm.a)(t,e,!0),[e,t]),y="included"===e?km.V2:km.LS,[p,g]=(0,n.J0)(!1),v=(0,wm.Rh)(i.DSF),E=(0,wm.Rh)(i._E9),f=t.folder.isChatList;(0,n.vJ)(()=>{r||g(!1)},[r]);const b=(0,n.Kr)(()=>{const e=[...v||[],...E||[]];return(0,Ea.Am)([...(0,Mt.PU)({ids:e,query:u,type:"chat"})])},[v,E,u]),C=(0,x.A)(e=>{a({type:"setChatFilter",payload:e}),g(!0)}),S=(0,x.A)(n=>{if("included"===e){if(n.length>=c)return void m({limit:"dialogFiltersChats"});a({type:"setIncludeFilters",payload:{...t.includeFilters,includedChatIds:n}})}else a({type:"setExcludeFilters",payload:{...t.excludeFilters,excludedChatIds:n}});g(!0)}),k=(0,x.A)(t=>{const n={};t.forEach(e=>{n[e]=!0}),a("included"===e?{type:"setIncludeFilters",payload:{includedChatIds:A,...n}}:{type:"setExcludeFilters",payload:{excludedChatIds:A,...n}}),g(!0)});return(0,Ee.A)({isActive:r,onBack:o}),b?n.Ay.createElement("div",{className:"Picker settings-folders-chat-list"},n.Ay.createElement(ba.A,{categories:f?void 0:y,itemIds:b,selectedIds:A,selectedCategories:h,filterValue:u,filterPlaceholder:d("Search"),categoryPlaceholderKey:"FilterChatTypes",searchInputId:"new-group-picker-search",isSearchable:!0,withDefaultPadding:!0,withPeerTypes:!0,allowMultiple:!0,itemInputType:"checkbox",onSelectedIdsChange:S,onSelectedCategoriesChange:k,onFilterChange:C}),n.Ay.createElement(ka.A,{isShown:p,onClick:l,ariaLabel:d("Save")},n.Ay.createElement(Q.A,{name:"check"}))):n.Ay.createElement(Dn.A,null)})),Im="Please provide a title for this folder.",Pm="ChatList.Filter.Error.Empty",Mm=(0,n.ph)((0,s.EK)((e,{state:t})=>{const{listIds:a}=e.chats,{byId:n,invites:s}=e.chatFolders,r=Object.values(n).reduce((e,t)=>e+(t.isChatList?1:0),0);return{loadedActiveChatIds:a.active,loadedArchivedChatIds:a.archived,invites:t.folderId?s[t.folderId]||fa.p:void 0,isRemoved:void 0!==t.folderId&&!n[t.folderId],maxInviteLinks:(0,dr.d)(e,"chatlistInvites"),maxChatLists:(0,dr.d)(e,"chatlistJoined"),chatListCount:r}})(({state:e,dispatch:t,onAddIncludedChats:a,onAddExcludedChats:r,onShareFolder:o,onOpenInvite:l,isActive:d,onReset:m,isRemoved:u,onBack:h,loadedActiveChatIds:y,isOnlyInvites:p,loadedArchivedChatIds:g,invites:v,maxInviteLinks:E,maxChatLists:f,chatListCount:b,onSaveFolder:C})=>{const{loadChatlistInvites:S,openLimitReachedModal:k,showNotification:w}=(0,s.ko)(),N="create"===e.mode,I=e.folder.isChatList,[P,M]=(0,n.J0)(!1),[T,x]=(0,n.J0)(!1);(0,n.vJ)(()=>{u&&m()},[u,m]),(0,n.vJ)(()=>{d&&e.folderId&&e.folder.isChatList&&S({folderId:e.folderId})},[d,e.folder.isChatList,e.folderId]);const{selectedChatIds:L,selectedChatTypes:R}=(0,n.Kr)(()=>(0,Sm.a)(e,"included"),[e]),{selectedChatIds:F,selectedChatTypes:D}=(0,n.Kr)(()=>(0,Sm.a)(e,"excluded"),[e]);(0,n.vJ)(()=>{M(!1),x(!1)},[e.folderId]);const[V,_]=(0,n.Kr)(()=>{const e=new Set([...y||[],...g||[]]),t=(0,Ea.$h)(L,e),a=(0,Ea.$h)(F,e);return[P?t:t.slice(0,5-R.length),T?a:a.slice(0,5-D.length)]},[F,L,R,D,T,P,y,g]),U=(0,B.A)();(0,Ee.A)({isActive:d,onBack:h});const O=(0,n.hb)(e=>{const{currentTarget:a}=e;t({type:"setTitle",payload:a.value.trim()})},[t]),J=(0,n.hb)(()=>{t({type:"setIsLoading",payload:!0}),C(()=>{setTimeout(()=>{m()},500)})},[t,C,m]),K=(0,n.hb)(()=>{v?(0,c.w5O)((0,s.mS)(),e.folderId)?b>=f&&!e.folder.isChatList?k({limit:"chatlistJoined"}):v.length<E?e.isTouched?C(o):o():k({limit:"chatlistInvites"}):w({message:U("ChatList.Filter.InviteLink.IncludeExcludeError")}):N&&C(o)},[v,e.folderId,e.isTouched,b,E,N,C,o,U,f,e.folder.isChatList]),G=(0,n.hb)((t,a)=>{e.isTouched?C(()=>l(a)):l(a)},[C,l,e.isTouched]);function j(e){const t="included"===e?R:D,a="included"===e?V:_,s="included"===e?P:T,r=("included"===e?L:F).length-a.length,i="included"===e?()=>M(!0):()=>x(!0);return n.Ay.createElement(n.Ay.Fragment,null,t.map(t=>function(e,t){const a="included"===t?km.V2.find(({type:t})=>t===e):km.LS.find(({type:t})=>t===e);if(a)return n.Ay.createElement(ca.A,{key:a.type,className:"settings-folders-list-item mb-1",narrow:!0,inactive:!0},n.Ay.createElement(kn.A,{avatarSize:"small",customPeer:a}))}(t,e)),a.map(e=>n.Ay.createElement(ca.A,{className:"settings-folders-list-item mb-1",narrow:!0,inactive:!0},(0,A.L8)(e)?n.Ay.createElement(kn.A,{avatarSize:"small",userId:e}):n.Ay.createElement(Sn.A,{avatarSize:"small",chatId:e}))),!s&&r>0&&n.Ay.createElement(ca.A,{key:"load-more",className:"settings-folders-list-item",narrow:!0,onClick:i,icon:"down"},U("FilterShowMoreChats",r,"i")))}return n.Ay.createElement("div",{className:"settings-fab-wrapper"},n.Ay.createElement("div",{className:"settings-content no-border custom-scroll"},n.Ay.createElement("div",{className:"settings-content-header"},n.Ay.createElement(So.A,{size:i.fwn,tgsUrl:Co.w.FoldersNew,play:String(e.folderId),className:"settings-content-icon"}),N&&n.Ay.createElement("p",{className:"settings-item-description mb-3",dir:U.isRtl?"rtl":void 0},U("FilterIncludeInfo")),n.Ay.createElement(Z.A,{className:"mb-0",label:U("FilterNameHint"),value:e.folder.title.text,onChange:O,error:e.error&&e.error===Im?Im:void 0})),!p&&n.Ay.createElement("div",{className:"settings-item"},e.error&&e.error===Pm&&n.Ay.createElement("p",{className:"settings-item-description color-danger mb-2",dir:U.isRtl?"rtl":void 0},U(e.error)),n.Ay.createElement("h4",{className:"settings-item-header mb-3",dir:U.isRtl?"rtl":void 0},U("FilterInclude")),n.Ay.createElement(ca.A,{className:"settings-folders-list-item color-primary",icon:"add",narrow:!0,onClick:a},U("FilterAddChats")),j("included")),!p&&!I&&n.Ay.createElement("div",{className:"settings-item pt-3"},n.Ay.createElement("h4",{className:"settings-item-header mb-3",dir:U.isRtl?"rtl":void 0},U("FilterExclude")),n.Ay.createElement(ca.A,{className:"settings-folders-list-item color-primary",icon:"add",narrow:!0,onClick:r},U("FilterAddChats")),j("excluded")),n.Ay.createElement("div",{className:"settings-item pt-3"},n.Ay.createElement("h4",{className:"settings-item-header mb-3",dir:U.isRtl?"rtl":void 0},U("FolderLinkScreen.Title")),n.Ay.createElement(ca.A,{className:"settings-folders-list-item color-primary",icon:"add",narrow:!0,onClick:K},U("ChatListFilter.CreateLinkNew")),v?.map(e=>n.Ay.createElement(ca.A,{className:"settings-folders-list-item",icon:"link",narrow:!0,multiline:!0,onClick:G,clickArg:e.url},n.Ay.createElement("span",{className:"title",dir:"auto"},e.title||e.url),n.Ay.createElement("span",{className:"subtitle"},U("ChatListFilter.LinkLabelChatCount",e.peerIds.length,"i")))))),n.Ay.createElement(ka.A,{isShown:Boolean(e.isTouched),disabled:e.isLoading,onClick:J,ariaLabel:"edit"===e.mode?"Save changes":"Create folder"},e.isLoading?n.Ay.createElement(Ve.A,{color:"white"}):n.Ay.createElement(Q.A,{name:"check"})))}));var Tm=a(96140),xm=a(80401);const Bm=(0,ye.nF)(e=>e(),6e4,!0),Lm=(0,n.ph)((0,s.EK)(e=>{const{byId:t,recommended:a}=e.chatFolders;let n=e.chatFolders.orderedIds;const{aiChatFolders:s}=(0,hs.l)(e);return!0!==s&&(n=(0,Tm.hc)(n)),{folderIds:n,foldersById:t,isPremium:(0,c.g29)(e),recommendedChatFolders:a,maxFolders:(0,dr.d)(e,"dialogFilters")}})(({isActive:e,onCreateFolder:t,onEditFolder:a,onReset:r,folderIds:o,foldersById:c,isPremium:d,recommendedChatFolders:m,maxFolders:u})=>{const{loadRecommendedChatFolders:A,addChatFolder:h,openLimitReachedModal:y,openDeleteChatFolderModal:p,sortChatFolders:g}=(0,s.ko)(),[v,E]=(0,n.J0)({orderedFolderIds:o,dragOrderIds:o,draggedIndex:void 0}),f=(0,U.A)(o);(0,n.vJ)(()=>{f!==o&&E({orderedFolderIds:o,dragOrderIds:o,draggedIndex:void 0})},[f,o,v.orderedFolderIds?.length]),(0,n.vJ)(()=>{Bm(()=>{A()})},[A]);const b=(0,n.hb)(()=>{Object.keys(c).length>=u-1?y({limit:"dialogFilters"}):t()},[c,u,t,y]),C=(0,B.A)();(0,Ee.A)({isActive:e,onBack:r});const S=(0,wm.g5)(),k=(0,n.Kr)(()=>{if(o)return o.length<=1?fa.p:o.map(e=>{const t=c[e];return e===i.DSF?{id:e,title:{text:C("FilterAllChats"),entities:[]}}:e===i.LFk?{id:e,title:{text:"Preset",entities:[]}}:e===i.j7l?{id:e,title:{text:"Unread",entities:[]}}:e===i.Sab?{id:e,title:{text:"AI",entities:[]}}:{id:t.id,title:t.title,subtitle:(0,l.A5)(C,t,S[t.id]),isChatList:t.isChatList,noTitleAnimations:t.noTitleAnimations}})},[o,c,C,S]),w=(0,n.hb)(e=>{Object.keys(c).length>=u-1?y({limit:"dialogFilters"}):h({folder:e})},[c,u,h,y]),N=(0,n.hb)((e,t)=>{const a=Math.round(e.y/56),n=v.orderedFolderIds?.indexOf(t)||0,s=v.orderedFolderIds?.filter(e=>e!==t);s&&(0,he.Bt)(n+a,0,o?.length||0)&&(s.splice(n+a+(d?0:1),0,t),E(e=>({...e,draggedIndex:n,dragOrderIds:s})))},[o?.length,d,v.orderedFolderIds]),I=(0,n.hb)(()=>{E(e=>(g({folderIds:e.dragOrderIds}),{...e,orderedFolderIds:e.dragOrderIds,draggedIndex:void 0}))},[g]),P=(0,n.Kr)(()=>!d||Object.keys(c).length<u-1,[c,d,u]);return n.Ay.createElement("div",{className:"settings-content no-border custom-scroll"},n.Ay.createElement("div",{className:"settings-content-header"},n.Ay.createElement(So.A,{size:i.fwn,tgsUrl:Co.w.FoldersAll,className:"settings-content-icon"}),n.Ay.createElement("p",{className:"settings-item-description mb-3",dir:"auto"},C("CreateNewFilterInfo")),P&&n.Ay.createElement(Y.A,{className:"settings-button with-icon",color:"primary",size:"smaller",pill:!0,fluid:!0,onClick:b,isRtl:C.isRtl},n.Ay.createElement(Q.A,{name:"add"}),C("CreateNewFilter"))),n.Ay.createElement("div",{className:"settings-item pt-3"},n.Ay.createElement("h4",{className:"settings-item-header mb-3",dir:C.isRtl?"rtl":void 0},C("Filters")),n.Ay.createElement("div",{className:"settings-sortable-container",style:`height: ${56*(o?.length||0)}px`},k?.length?k.map((t,s)=>{const r=s>u-1,o=v.draggedIndex===s,l=56*(v.orderedFolderIds?.indexOf(t.id)??0),m=56*(v.dragOrderIds?.indexOf(t.id)??0);return t.id===i.DSF||t.id===i.LFk||t.id===i.j7l||t.id===i.Sab?n.Ay.createElement(xm.A,{key:t.id,id:t.id,onDrag:N,onDragEnd:I,style:`top: ${o?l:m}px;`,knobStyle:(C.isRtl?"left":"right")+": 0.375rem;",isDisabled:!d||!e},n.Ay.createElement(ca.A,{key:t.id,className:"drag-item no-icon settings-sortable-item",narrow:!0,inactive:!0,multiline:!0,isStatic:!0,allowSelection:!0},n.Ay.createElement("span",{className:"title"},(0,Xa.fd)({text:t.title.text,entities:t.title.entities,noCustomEmojiPlayback:t.noTitleAnimations})),n.Ay.createElement("span",{className:"subtitle"},t.id===i.j7l?C("FoldersUnreadChatsDesc"):t.id===i.LFk?"Preset Tags":t.id===i.Sab?"AI-Generated Tags":C("FoldersAllChatsDesc")))):n.Ay.createElement(xm.A,{key:t.id,id:t.id,onDrag:N,onDragEnd:I,style:`top: ${o?l:m}px;`,knobStyle:(C.isRtl?"left":"right")+": 3rem;",isDisabled:r||!e},n.Ay.createElement(ca.A,{className:"drag-item no-icon settings-sortable-item",narrow:!0,secondaryIcon:"more",multiline:!0,contextActions:[{handler:()=>{p({folderId:t.id})},destructive:!0,title:C("Delete"),icon:"delete"}],onClick:()=>{r?y({limit:"dialogFilters"}):a(c[t.id])}},n.Ay.createElement("span",{className:"title"},(0,Xa.fd)({text:t.title.text,entities:t.title.entities,noCustomEmojiPlayback:t.noTitleAnimations}),r&&n.Ay.createElement(Q.A,{name:"lock-badge",className:"settings-folders-blocked-icon"})),n.Ay.createElement("span",{className:"subtitle"},t.isChatList&&n.Ay.createElement(Q.A,{name:"link",className:"mr-1"}),t.subtitle)))}):k&&!k.length?n.Ay.createElement("p",{className:"settings-item-description my-4",dir:"auto"},"You have no folders yet."):n.Ay.createElement(Dn.A,null))),m&&Boolean(m.length)&&n.Ay.createElement("div",{className:"settings-item pt-3"},n.Ay.createElement("h4",{className:"settings-item-header mb-3",dir:C.isRtl?"rtl":void 0},C("FilterRecommended")),m.map(e=>n.Ay.createElement(ca.A,{narrow:!0,onClick:()=>w(e)},n.Ay.createElement("div",{className:"settings-folders-recommended-item"},n.Ay.createElement("div",{className:"multiline-item"},n.Ay.createElement("span",{className:"title"},(0,Xa.fd)({text:e.title.text,entities:e.title.entities,noCustomEmojiPlayback:e.noTitleAnimations})),n.Ay.createElement("span",{className:"subtitle"},e.description)),n.Ay.createElement(Y.A,{className:"px-3",color:"primary",size:"tiny",pill:!0,fluid:!0,isRtl:C.isRtl},C("Add")))))))}));var Rm=a(4438);const Fm=(0,n.ph)((0,s.EK)(e=>{const{folderId:t,url:a,isLoading:n}=(0,c.nTw)(e).shareFolderScreen||{},s=t?(0,c.$aQ)(e,t):void 0,r=t?e.chatFolders.invites[t]?.find(e=>e.url===a):void 0;return{folderId:t,folder:s,url:a,isLoading:n,peerIds:r?.peerIds}})(({isActive:e,onReset:t,folderId:a,folder:r,peerIds:o,url:d,isLoading:m})=>{const{createChatlistInvite:u,deleteChatlistInvite:A,editChatlistInvite:h,showNotification:y}=(0,s.ko)(),p=(0,Ua.A)(),g=(0,B.A)(),[v,E]=(0,n.J0)(!1);(0,Ee.A)({isActive:e,onBack:t}),(0,n.vJ)(()=>{m||E(!1)},[m]),(0,n.vJ)(()=>{!d&&a&&e&&u({folderId:a})},[a,e,d]);const f=(0,x.A)(()=>{d&&a&&(A({folderId:a,url:d}),t())}),b=(0,n.Kr)(()=>(r?.includedChatIds||[]).concat(r?.pinnedChatIds||[]),[r?.includedChatIds,r?.pinnedChatIds]),[C,S]=(0,n.Kr)(()=>{const e=(0,s.mS)();return(0,Ea.jB)(b,t=>(0,c.hXb)(e,t))},[b]),[k,w]=(0,n.J0)(o||[]),N=(0,n.li)(!0);(0,Sa.A)(([e])=>{e!==d&&(N.current=!0),N.current&&(N.current=!1,d?o&&w(o):w(C))},[d,C,o]);const I=(0,x.A)(e=>{const t=(0,s.mS)(),a=(0,c.mBe)(t,e),n=(0,c.hds)(t,e);a&&(0,l.tv)(a)?y({message:g("FolderLinkScreen.AlertTextUnavailableBot")}):a?y({message:g("FolderLinkScreen.AlertTextUnavailableUser")}):n&&(0,l.WX)(n)?y({message:g("FolderLinkScreen.AlertTextUnavailablePublicChannel")}):y({message:g("FolderLinkScreen.AlertTextUnavailablePublicGroup")})}),P=(0,x.A)(e=>{w(e),E(!0)}),M=(0,x.A)(()=>{a&&d&&v&&h({folderId:a,peerIds:k,url:d})}),T=k.length,L=!T||m;return n.Ay.createElement("div",{className:"settings-content no-border custom-scroll SettingsFoldersChatsPicker"},n.Ay.createElement("div",{className:"settings-content-header"},n.Ay.createElement(Rm.A,{size:i.fwn,tgsUrl:Co.w.FoldersShare,className:"settings-content-icon"}),r&&n.Ay.createElement("p",{className:"settings-item-description mb-3",dir:"auto"},p("FolderLinkTitleDescription",{folder:(0,Xa.fd)({text:r.title.text,entities:r.title.entities,noCustomEmojiPlayback:r.noTitleAnimations}),chats:p("FolderLinkTitleDescriptionChats",{count:T},{pluralValue:T})},{withMarkdown:!0,withNodes:!0}))),n.Ay.createElement(qo.A,{className:"settings-item",link:d||g("Loading"),withShare:!0,onRevoke:f,isDisabled:!T||v}),n.Ay.createElement("div",{className:"settings-item settings-item-picker"},n.Ay.createElement(ba.A,{itemIds:b,lockedUnselectedIds:S,onSelectedIdsChange:P,selectedIds:k,onDisabledClick:I,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"})),n.Ay.createElement(ka.A,{isShown:m||v,disabled:L,onClick:M,ariaLabel:"Save changes"},m?n.Ay.createElement(Ve.A,{color:"white"}):n.Ay.createElement(Q.A,{name:"check"})))})),Dm=(0,n.ph)(({currentScreen:e,shownScreen:t,state:a,dispatch:i,isActive:o,onReset:l})=>{const{openShareChatFolderModal:c,editChatFolder:d,addChatFolder:m,openSettingsScreen:u}=(0,s.ko)(),A=(0,n.hb)(()=>{e!==r.VS.FoldersCreateFolder&&e!==r.VS.FoldersEditFolder&&e!==r.VS.FoldersEditFolderFromChatList&&e!==r.VS.FoldersEditFolderInvites||setTimeout(()=>{i({type:"reset"})},200),e!==r.VS.FoldersIncludedChats&&e!==r.VS.FoldersExcludedChats?l():"create"===a.mode?u({screen:r.VS.FoldersCreateFolder}):u({screen:r.VS.FoldersEditFolder})},[a.mode,i,e,l]),h="create"===a.mode,y=(0,n.hb)(e=>{const{title:t}=e.folder;if(!t)return i({type:"setError",payload:Im}),!1;const{selectedChatIds:a,selectedChatTypes:n}=(0,Sm.a)(e,"included");return a.length||Object.keys(n).length?(h?m({folder:e.folder}):d({id:e.folderId,folderUpdate:e.folder}),i({type:"setError",payload:void 0}),i({type:"setIsTouched",payload:!1}),!0):(i({type:"setError",payload:Pm}),!1)},[i,h]),p=(0,n.hb)(e=>{y(a)&&e?.()},[y,a]),g=(0,n.hb)(()=>{const e=i({type:"saveFilters"});A(),y(e)},[i,A,y]),v=(0,n.hb)(()=>{i({type:"reset"}),u({screen:r.VS.FoldersCreateFolder})},[i]),E=(0,n.hb)(e=>{i({type:"editFolder",payload:e}),u({screen:r.VS.FoldersEditFolder})},[i]),f=(0,n.hb)(()=>{i({type:"editIncludeFilters"}),u({screen:e===r.VS.FoldersEditFolderFromChatList?r.VS.FoldersIncludedChatsFromChatList:r.VS.FoldersIncludedChats})},[e,i]),b=(0,n.hb)(()=>{i({type:"editExcludeFilters"}),u({screen:e===r.VS.FoldersEditFolderFromChatList?r.VS.FoldersExcludedChatsFromChatList:r.VS.FoldersExcludedChats})},[e,i]),C=(0,n.hb)(()=>{c({folderId:a.folderId,noRequestNextScreen:!0}),i({type:"setIsChatlist",payload:!0}),u({screen:r.VS.FoldersShare})},[i,a.folderId]),S=(0,n.hb)(e=>{c({folderId:a.folderId,url:e,noRequestNextScreen:!0}),u({screen:r.VS.FoldersShare})},[a.folderId]);switch(e){case r.VS.Folders:return n.Ay.createElement(Lm,{onCreateFolder:v,onEditFolder:E,isActive:o||[r.VS.FoldersCreateFolder,r.VS.FoldersEditFolder,r.VS.FoldersIncludedChats,r.VS.FoldersExcludedChats].includes(t),onReset:l});case r.VS.FoldersCreateFolder:case r.VS.FoldersEditFolder:case r.VS.FoldersEditFolderFromChatList:case r.VS.FoldersEditFolderInvites:return n.Ay.createElement(Mm,{state:a,dispatch:i,onAddIncludedChats:f,onAddExcludedChats:b,onShareFolder:C,onOpenInvite:S,onReset:A,isActive:o||[r.VS.FoldersIncludedChats,r.VS.FoldersExcludedChats].includes(t),isOnlyInvites:e===r.VS.FoldersEditFolderInvites,onBack:l,onSaveFolder:p});case r.VS.FoldersIncludedChats:case r.VS.FoldersIncludedChatsFromChatList:return n.Ay.createElement(Nm,{mode:"included",state:a,dispatch:i,onReset:A,onSaveFilter:g,isActive:o});case r.VS.FoldersExcludedChats:case r.VS.FoldersExcludedChatsFromChatList:return n.Ay.createElement(Nm,{mode:"excluded",state:a,dispatch:i,onReset:A,onSaveFilter:g,isActive:o});case r.VS.FoldersShare:return n.Ay.createElement(Fm,{isActive:o,onReset:A});default:return}});var Vm=a(70934),_m=a(3178);const Um=(0,n.ph)(({isActive:e,onReset:t,error:a,isLoading:s,shouldDisablePasswordManager:r,expectedPassword:i,placeholder:o="Current Password",hint:l,submitLabel:c,clearError:d,onSubmit:m})=>{const[u,A]=(0,n.J0)(""),[h,y]=(0,n.J0)(!1),p=(0,n.hb)(e=>{i&&e!==i?A("Passwords Should Be Equal"):m(e)},[m,i]),g=(0,n.hb)(()=>{d&&d(),A("")},[d]),v=(0,B.A)();return(0,Ee.A)({isActive:e,onBack:t}),n.Ay.createElement("div",{className:"settings-content password-form custom-scroll"},n.Ay.createElement("div",{className:"settings-content-header no-border"},n.Ay.createElement(_m.A,{isBig:!0,isPasswordVisible:h})),n.Ay.createElement("div",{className:"settings-item settings-group"},n.Ay.createElement(zl.A,{error:u||a,hint:l,placeholder:o,shouldDisablePasswordManager:r,submitLabel:c||v("Next"),clearError:g,isLoading:s,isPasswordVisible:h,shouldResetValue:e,onChangePasswordVisibility:y,onSubmit:p})))}),Om=(0,n.ph)(({isActive:e,onReset:t})=>{const a=(0,B.A)(),s=(0,n.hb)(()=>{t(!0)},[t]);return(0,Ee.A)({isActive:e,onBack:t}),n.Ay.createElement("div",{className:"settings-content local-passcode custom-scroll"},n.Ay.createElement("div",{className:"settings-content-header no-border"},n.Ay.createElement(Rm.A,{size:i.BYH,tgsUrl:Co.w.Congratulations,className:"settings-content-icon"}),n.Ay.createElement("p",{className:"settings-item-description mb-3",dir:"auto"},"Congratulations!"),n.Ay.createElement("p",{className:"settings-item-description mb-3",dir:"auto"},"Now you can lock the app with a passcode so that others can't open it.")),n.Ay.createElement("div",{className:"settings-item settings-group"},n.Ay.createElement(Y.A,{onClick:s},a("Back"))))});var Jm=a(89704);const Km=(0,n.ph)(({isActive:e,onReset:t})=>{const{openSettingsScreen:a}=(0,s.ko)(),i=(0,B.A)();return(0,Ee.A)({isActive:e,onBack:t}),n.Ay.createElement("div",{className:"settings-content local-passcode custom-scroll"},n.Ay.createElement("div",{className:"settings-content-header no-border"},n.Ay.createElement(So.A,{tgsUrl:Co.w.Lock,previewUrl:Jm,size:160,className:"settings-content-icon"}),n.Ay.createElement("p",{className:"settings-item-description mb-3",dir:"auto"},"Local passcode is enabled.")),n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement(ca.A,{icon:"edit",onClick:()=>a({screen:r.VS.PasscodeChangePasscodeCurrent})},i("Passcode.Change")),n.Ay.createElement(ca.A,{icon:"password-off",onClick:()=>a({screen:r.VS.PasscodeTurnOff})},i("Passcode.TurnOff"))))}),Gm=(0,n.ph)(({isActive:e,onReset:t,onStart:a})=>{const s=(0,B.A)();return(0,Ee.A)({isActive:e,onBack:t}),n.Ay.createElement("div",{className:"settings-content local-passcode custom-scroll"},n.Ay.createElement("div",{className:"settings-content-header no-border"},n.Ay.createElement(So.A,{tgsUrl:Co.w.Lock,previewUrl:Jm,size:i.BYH,className:"settings-content-icon"}),n.Ay.createElement("p",{className:"settings-item-description",dir:"auto"},"When you set up an additional passcode, a lock icon will appear on the chats page. Tap it to lock and unlock your Telegram Web A."),n.Ay.createElement("p",{className:"settings-item-description mb-3",dir:"auto"},"Note: if you forget your local passcode, you'll need to log out of Telegram Web A and log in again.")),n.Ay.createElement("div",{className:"settings-item settings-group"},n.Ay.createElement(Y.A,{onClick:a},s("EnablePasscode"))))}),jm=(0,n.ph)((0,s.EK)(e=>({...e.passcode}))(({passcode:e,currentScreen:t,shownScreen:a,error:i,isActive:o,isLoading:l,onSetPasscode:c,onReset:d})=>{const{setPasscode:m,clearPasscode:u,setPasscodeError:A,clearPasscodeError:h,openSettingsScreen:y}=(0,s.ko)(),p=(0,B.A)(),g=(0,n.hb)(()=>{c(""),y({screen:r.VS.PasscodeNewPasscode})},[c]),v=(0,n.hb)(e=>{c(e),y({screen:r.VS.PasscodeNewPasscodeConfirm})},[c]),E=(0,n.hb)(()=>{m({passcode:e}),c(""),y({screen:r.VS.PasscodeCongratulations})},[c,e]),f=(0,n.hb)(e=>{c(""),(0,Vm.UQ)(e).then(()=>{y({screen:r.VS.PasscodeChangePasscodeNew})},()=>{A({error:p("PasscodeController.Error.Current")})})},[p,c]),b=(0,n.hb)(e=>{c(e),y({screen:r.VS.PasscodeChangePasscodeConfirm})},[c]),C=(0,n.hb)(e=>{(0,Vm.UQ)(e).then(()=>{u(),y({screen:r.VS.Privacy})},()=>{A({error:p("PasscodeController.Error.Current")})})},[p]);switch(t){case r.VS.PasscodeDisabled:return n.Ay.createElement(Gm,{onStart:g,isActive:o||[r.VS.PasscodeNewPasscode,r.VS.PasscodeNewPasscodeConfirm,r.VS.PasscodeCongratulations].includes(a),onReset:d});case r.VS.PasscodeNewPasscode:return n.Ay.createElement(Um,{shouldDisablePasswordManager:!0,placeholder:p("EnterNewPasscode"),submitLabel:p("Continue"),onSubmit:v,isActive:o||[r.VS.PasscodeNewPasscodeConfirm,r.VS.PasscodeCongratulations].includes(a),onReset:d});case r.VS.PasscodeNewPasscodeConfirm:return n.Ay.createElement(Um,{shouldDisablePasswordManager:!0,expectedPassword:e,placeholder:p("ReEnterYourPasscode"),submitLabel:p("Continue"),isLoading:l,onSubmit:E,isActive:o||[r.VS.PasscodeCongratulations].includes(a),onReset:d});case r.VS.PasscodeCongratulations:return n.Ay.createElement(Om,{isActive:o,onReset:d});case r.VS.PasscodeEnabled:return n.Ay.createElement(Km,{isActive:o||[r.VS.PasscodeChangePasscodeCurrent,r.VS.PasscodeChangePasscodeNew,r.VS.PasscodeChangePasscodeConfirm,r.VS.PasscodeCongratulations,r.VS.PasscodeTurnOff].includes(a),onReset:d});case r.VS.PasscodeChangePasscodeCurrent:return n.Ay.createElement(Um,{shouldDisablePasswordManager:!0,error:i,clearError:h,placeholder:p("PasscodeController.Current.Placeholder"),onSubmit:f,isActive:o||[r.VS.PasscodeChangePasscodeNew,r.VS.PasscodeChangePasscodeConfirm,r.VS.PasscodeCongratulations].includes(a),onReset:d});case r.VS.PasscodeChangePasscodeNew:return n.Ay.createElement(Um,{shouldDisablePasswordManager:!0,placeholder:p("PleaseEnterNewFirstPassword"),onSubmit:b,isActive:o||[r.VS.PasscodeChangePasscodeConfirm,r.VS.PasscodeCongratulations].includes(a),onReset:d});case r.VS.PasscodeChangePasscodeConfirm:return n.Ay.createElement(Um,{shouldDisablePasswordManager:!0,expectedPassword:e,placeholder:p("PasscodeController.ReEnterPasscode.Placeholder"),isLoading:l,onSubmit:E,isActive:o||[r.VS.PasscodeCongratulations].includes(a),onReset:d});case r.VS.PasscodeTurnOff:return n.Ay.createElement(Um,{shouldDisablePasswordManager:!0,error:i?p(i):void 0,clearError:h,placeholder:p("PasscodeController.Current.Placeholder"),onSubmit:C,isActive:o,onReset:d});default:return}})),zm=[50,100,500,1e3,2e3,5e3,1e4];function Hm(e,t){const a=e.findIndex(e=>t<=e),n=e[a-1]||1,s=e[a]||e[e.length-1];return a+(t-n)/(s-n)}function $m(e,t){const a=Math.floor(t),n=e[a-1]||1,s=n+((e[a]||e[e.length-1])-n)*(t-a);return s<100?Math.round(s):10*Math.round(s/10)}const qm=(0,n.ph)(({min:e=0,max:t,value:a,disabled:s,readOnly:r,bold:i,className:o,defaultValue:l,onChange:c,canChangeChargeForMessages:d})=>{const m=(0,Ua.A)(),u=(0,n.Kr)(()=>{const e=[];for(let a=0;a<zm.length;a++)if(zm[a]<t&&e.push(zm[a]),zm[a]>=t){e.push(t);break}return e},[t]),A=(0,x.A)(e=>{const t=Number(e.currentTarget.value);c($m(u,t))}),h=(0,ue.A)(o,"RangeSlider",s&&"disabled",r&&"readOnly",i&&"bold");return n.Ay.createElement("div",{className:h},n.Ay.createElement("div",{className:"slider-top-row",dir:m.isRtl?"rtl":void 0},n.Ay.createElement("span",{className:"value-min",dir:"auto"},m.number(e)),n.Ay.createElement("span",{className:"settings-range-value"},!d&&n.Ay.createElement(Q.A,{name:"lock-badge"}),(0,Da.Kk)(m,$m(u,Hm(u,a)))),n.Ay.createElement("span",{className:"value-max",dir:"auto"},m.number(t))),n.Ay.createElement("div",{className:"slider-main"},n.Ay.createElement("div",{className:"slider-fill-track",style:`width: ${Hm(u,a)/u.length*100}%`}),n.Ay.createElement("input",{min:0,max:u.length,defaultValue:Hm(u,l),step:"any",type:"range",className:"RangeSlider__input",onChange:A})))}),Wm=(0,n.ph)((0,s.EK)(e=>{const t=e.appConfig?.starsUsdWithdrawRateX1000,a=t?t/1e3:1,n=e.appConfig?.starsPaidMessageCommissionPermille;return{starsPaidMessageCommissionPermille:n?n/1e3:100,starsUsdWithdrawRate:a,starsPaidMessageAmountMax:e.appConfig?.starsPaidMessageAmountMax||i.$$v}})(function({starsUsdWithdrawRate:e,starsPaidMessageAmountMax:t,starsPaidMessageCommissionPermille:a,canChangeChargeForMessages:r,isGroupChat:o,chargeForMessages:l,onChange:c}){const{openPremiumModal:d}=(0,s.ko)(),m=(0,Ua.A)(),u=(0,x.A)(e=>{c?.(e)}),A=(0,x.A)(()=>{d({initialSection:"message_privacy"})});return n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("h4",{className:"settings-item-header",dir:m.isRtl?"rtl":void 0},m("SectionTitleStarsForForMessages")),n.Ay.createElement(qm,{defaultValue:l,min:i.BSg,max:t,value:l,onChange:u,canChangeChargeForMessages:r,readOnly:!r}),!r&&n.Ay.createElement(Y.A,{color:"primary",fluid:!0,size:"smaller",noForcedUpperCase:!0,className:"settings-unlock-button",onClick:A},n.Ay.createElement("span",{className:"settings-unlock-button-title"},m("UnlockButtonTitle"),n.Ay.createElement(Q.A,{name:"lock-badge",className:"settings-unlock-button-icon"}))),r&&n.Ay.createElement("p",{className:"settings-item-description-larger",dir:m.isRtl?"rtl":void 0},m(o?"SetPriceGroupDescription":"SectionDescriptionStarsForForMessages",{percent:(0,qe.l9)(100*a),amount:(0,mr.Ad)(l*e*a,"USD",m.code)},{withNodes:!0})))}));var Qm=a(9267);const Ym=(0,n.ph)(function({premiumSection:e}){const{openPremiumModal:t}=(0,s.ko)(),a=(0,B.A)(),r=(0,x.A)(()=>t({initialSection:e}));return n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement(ca.A,{leftElement:n.Ay.createElement(Qm.A,{className:"icon ListItem-main-icon",type:"premium",size:"big"}),onClick:r},a("PrivacyLastSeenPremium")),n.Ay.createElement("p",{className:"settings-item-description-larger premium-info",dir:a.isRtl?"rtl":void 0},a("lng_messages_privacy_premium_about")))}),Zm=(0,n.ph)(function({label:e,isChecked:t}){const a=(0,B.A)(),{showNotification:r}=(0,s.ko)();return n.Ay.createElement("div",{className:(0,ue.A)("sBptmiga",t&&"U_6O1ebL"),onClick:()=>r({message:a("OptionPremiumRequiredMessage")})},n.Ay.createElement("span",null,e),n.Ay.createElement(Q.A,{name:"lock-badge",className:"jWxrRbkh"}))}),Xm=(0,n.ph)((0,s.EK)(e=>{const{settings:{privacy:t}}=e,a=(0,c.Iv$)(e),n=e.settings.privacy.noPaidMessages?.allowUserIds.length||0;return{shouldNewNonContactPeersRequirePremium:(0,c.BSN)(e),shouldChargeForMessages:Boolean(a),nonContactPeersPaidStars:a||i.wZe,isCurrentUserPremium:(0,c.g29)(e),canLimitNewMessagesWithoutPremium:e.appConfig?.canLimitNewMessagesWithoutPremium,canChargeForMessages:e.appConfig?.starsPaidMessagesAvailable,noPaidReactionsForUsersCount:n,privacy:t}})(function({isActive:e,canLimitNewMessagesWithoutPremium:t,canChargeForMessages:a,shouldNewNonContactPeersRequirePremium:i,shouldChargeForMessages:o,nonContactPeersPaidStars:l,isCurrentUserPremium:c,noPaidReactionsForUsersCount:d,onReset:m,privacy:u}){const{updateGlobalPrivacySettings:A,openSettingsScreen:h,showNotification:y}=(0,s.ko)(),p=(0,B.A)(),g=(0,Ua.A)(),v=c||t,E=c&&a,[f,b]=(0,n.J0)(l),[C,S]=(0,n.J0)(!1),k=(0,n.Kr)(()=>o?"charge_for_messages":i?"contacts_and_premium":"everybody",[o,i]);(0,Sa.A)(([e])=>{C||void 0===e||"everybody"===k||k===e||("everybody"===u.chatInvite?.visibility&&y({message:g("CheckPrivacyInviteText"),action:{action:"openSettingsScreen",payload:{screen:r.VS.PrivacyGroupChats}},actionText:{key:"Review"},duration:8e3}),"everybody"===u.phoneCall?.visibility&&y({message:g("CheckPrivacyCallsText"),action:{action:"openSettingsScreen",payload:{screen:r.VS.PrivacyPhoneCall}},actionText:{key:"Review"},duration:8e3}),S(!0))},[k,o,u,g,C]);const w=(0,n.Kr)(()=>[{value:"everybody",label:p("P2PEverybody")},{value:"contacts_and_premium",label:v?p("PrivacyMessagesContactsAndPremium"):n.Ay.createElement(Zm,{label:p("PrivacyMessagesContactsAndPremium"),isChecked:"contacts_and_premium"===k}),hidden:!v,isCanCheckedInDisabled:!0},{value:"charge_for_messages",label:E?g("PrivacyChargeForMessages"):n.Ay.createElement(Zm,{label:g("PrivacyChargeForMessages"),isChecked:"charge_for_messages"===k}),hidden:!E,isCanCheckedInDisabled:!0}],[p,g,v,E,k]),N=(0,x.A)(e=>{A({shouldNewNonContactPeersRequirePremium:"contacts_and_premium"===e,nonContactPeersPaidStars:"charge_for_messages"===e?f:null})}),I=(0,ge.A)(e=>{A({nonContactPeersPaidStars:e})},[A],300,!0),P=(0,n.hb)(e=>{b(e),I(e)},[b,I]);(0,Ee.A)({isActive:e,onBack:m});const M=(0,n.Kr)(()=>g(o?"PrivacyDescriptionChargeForMessages":"PrivacyDescriptionMessagesContactsAndPremium"),[o,g]);return n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:p.isRtl?"rtl":void 0},p("PrivacyMessagesTitle")),n.Ay.createElement(ee.A,{name:"privacy-messages",options:w,onChange:N,selected:k}),n.Ay.createElement("p",{className:"settings-item-description-larger",dir:p.isRtl?"rtl":void 0},M)),"charge_for_messages"===k&&n.Ay.createElement("div",{className:"settings-item fluid-container"},n.Ay.createElement(Wm,{canChangeChargeForMessages:E,chargeForMessages:f,onChange:P})),E&&"charge_for_messages"===k&&function(){const e=d?p("Users",d,"i"):g("SubtitlePrivacyAddUsers");return n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:p.isRtl?"rtl":void 0},g("RemoveFeeTitle")),n.Ay.createElement(ca.A,{narrow:!0,icon:"delete-user",onClick:()=>{h({screen:r.VS.PrivacyNoPaidMessages})}},n.Ay.createElement("div",{className:"multiline-item full-size"},n.Ay.createElement("span",{className:"title"},g("ExceptionTitlePrivacyChargeForMessages")),n.Ay.createElement("span",{className:"subtitle"},e))))}(),!c&&"charge_for_messages"!==k&&n.Ay.createElement(Ym,{premiumSection:"message_privacy"}))}));function eu(e){const t=e.platform.toLowerCase(),a=e.deviceModel.toLowerCase(),n=e.systemVersion.toLowerCase();return a.includes("xbox")?"xbox":a.includes("chrome")&&!a.includes("chromebook")?"chrome":a.includes("brave")?"brave":a.includes("vivaldi")?"vivaldi":a.includes("safari")?"safari":a.includes("firefox")?"firefox":a.includes("opera")?"opera":a.includes("samsungbrowser")?"samsung":t.includes("android")?"android":a.includes("iphone")||a.includes("ipad")||t.includes("ios")||t.includes("macos")||n.includes("macos")?"apple":t.includes("ubuntu")||n.includes("ubuntu")?"ubuntu":t.includes("linux")||n.includes("linux")?"linux":t.includes("windows")||n.includes("windows")?"windows":"unknown"}const tu={SettingsActiveSession:"M84mrPgu",settingsActiveSession:"M84mrPgu",iconDevice:"Add8P_K4",iconDevice__android:"onkXVGY4",iconDeviceAndroid:"onkXVGY4",iconDevice__apple:"xw13aT8u",iconDeviceApple:"xw13aT8u",iconDevice__brave:"HESrGUdv",iconDeviceBrave:"HESrGUdv",iconDevice__chrome:"Vpej7wm7",iconDeviceChrome:"Vpej7wm7",iconDevice__edge:"ueWE77x9",iconDeviceEdge:"ueWE77x9",iconDevice__firefox:"_lMTmvya",iconDeviceFirefox:"_lMTmvya",iconDevice__linux:"cDVfvyG_",iconDeviceLinux:"cDVfvyG_",iconDevice__opera:"nWqlTxZt",iconDeviceOpera:"nWqlTxZt",iconDevice__safari:"ldFLp1Gf",iconDeviceSafari:"ldFLp1Gf",iconDevice__samsung:"VHNORBGL",iconDeviceSamsung:"VHNORBGL",iconDevice__ubuntu:"QBVivtdu",iconDeviceUbuntu:"QBVivtdu",iconDevice__unknown:"GbjIgrwU",iconDeviceUnknown:"GbjIgrwU",iconDevice__vivaldi:"yieVnjoI",iconDeviceVivaldi:"yieVnjoI",iconDevice__windows:"_0dnTFOE",iconDeviceWindows:"_0dnTFOE",iconDevice__xbox:"fbCjjDpU",iconDeviceXbox:"fbCjjDpU",title:"c6edjhlh",note:"lRqTZAYn",date:"oLnN6crs",box:"wVEXuPlZ",actionHeader:"olQS2T1n",actionName:"KuX1APpO",headerButton:"VT8pZfMu"},au=(0,n.ph)((0,s.EK)((e,{hash:t})=>({session:t?e.activeSessions.byHash[t]:void 0}))(({isOpen:e,session:t,onClose:a})=>{const{changeSessionSettings:r,terminateAuthorization:i}=(0,s.ko)(),o=(0,B.A)(),l=(0,La.A)(t,!0),c=(0,n.hb)(()=>{r({hash:t.hash,areSecretChatsEnabled:!t.areSecretChatsEnabled})},[r,t]),d=(0,n.hb)(()=>{r({hash:t.hash,areCallsEnabled:!t.areCallsEnabled})},[r,t]),m=(0,n.hb)(()=>{i({hash:t.hash}),a()},[a,t,i]);if(l)return n.Ay.createElement(X.A,{header:n.Ay.createElement("div",{className:"modal-header-condensed",dir:o.isRtl?"rtl":void 0},n.Ay.createElement(Y.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:o("Close"),onClick:a},n.Ay.createElement(Q.A,{name:"close"})),n.Ay.createElement("div",{className:"modal-title"},o("SessionPreview.Title")),n.Ay.createElement(Y.A,{color:"danger",onClick:m,className:(0,ue.A)("modal-action-button",tu.headerButton)},o("SessionPreview.TerminateSession"))),isOpen:e,hasCloseButton:!0,onClose:a,className:tu.SettingsActiveSession},n.Ay.createElement("div",{className:(0,ue.A)(tu.iconDevice,l&&tu[`iconDevice__${eu(l)}`])}),n.Ay.createElement("h3",{className:tu.title,dir:"auto"},l?.deviceModel),n.Ay.createElement("div",{className:tu.date,"aria-label":o("PrivacySettings.LastSeen")},(0,$e.L2)(1e3*l.dateActive,o.code)),n.Ay.createElement("dl",{className:tu.box},n.Ay.createElement("dt",null,o("SessionPreview.App")),n.Ay.createElement("dd",null,l?.appName," ",l?.appVersion,","," ",l?.platform," ",l?.systemVersion),n.Ay.createElement("dt",null,o("SessionPreview.Ip")),n.Ay.createElement("dd",null,l?.ip),n.Ay.createElement("dt",null,o("SessionPreview.Location")),n.Ay.createElement("dd",null,l&&function(e){return[e.region,e.country].filter(Boolean).join(", ")}(l))),n.Ay.createElement("p",{className:tu.note},o("SessionPreview.IpDesc")),n.Ay.createElement("h4",{className:tu.actionHeader},o("AuthSessions.View.AcceptTitle")),n.Ay.createElement(ca.A,{onClick:c},n.Ay.createElement("span",{className:tu.actionName},o("SessionPreview.Accept.Secret")),n.Ay.createElement(va.A,{id:"accept_secrets",label:"On",checked:l.areSecretChatsEnabled})),n.Ay.createElement(ca.A,{onClick:d},n.Ay.createElement("span",{className:tu.actionName},o("SessionPreview.Accept.Calls")),n.Ay.createElement(va.A,{id:"accept_calls",label:"On",checked:l.areCallsEnabled})))}));function nu(e){return[e.region,e.country].filter(Boolean).join(", ")}const su=(0,n.ph)((0,s.EK)(e=>e.activeSessions)(({isActive:e,onReset:t,byHash:a,orderedHashes:r,ttlDays:i})=>{const{terminateAuthorization:o,terminateAllAuthorizations:l,changeSessionTtl:c}=(0,s.ko)(),d=(0,B.A)(),[m,u,A]=(0,M.A)(),[h,y]=(0,n.J0)(),[p,g,v]=(0,M.A)(),E=(0,n.Kr)(()=>{if(void 0!==i)return i<=7?"7":i<=30?"30":i<=93?"90":i<=183?"183":i>183?"365":void 0},[i]),f=(0,n.Kr)(()=>{const e=[{label:d("Weeks",1,"i"),value:"7"},{label:d("Months",1,"i"),value:"30"},{label:d("Months",3,"i"),value:"90"},{label:d("Months",6,"i"),value:"183"}];return i&&i>=365&&e.push({label:d("Years",1,"i"),value:"365"}),e},[d,i]),b=(0,n.hb)(e=>{o({hash:e})},[o]),C=(0,n.hb)(()=>{A(),l()},[A,l]),S=(0,n.hb)(e=>{y(e),g()},[g]),k=(0,n.hb)(()=>{y(void 0),v()},[v]),w=(0,n.hb)(e=>{c({days:Number(e)})},[c]),N=(0,n.Kr)(()=>{const e=r.find(e=>a[e].isCurrent);return e?a[e]:void 0},[a,r]),I=(0,n.Kr)(()=>r.filter(e=>!a[e].isCurrent),[a,r]),P=Boolean(I.length);return(0,Ee.A)({isActive:e,onBack:t}),n.Ay.createElement("div",{className:"settings-content custom-scroll SettingsActiveSessions"},N&&(x=N,n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:d.isRtl?"rtl":void 0},d("AuthSessions.CurrentSession")),n.Ay.createElement(ca.A,{narrow:!0,inactive:!0,icon:`device-${eu(x)}`,iconClassName:"icon-device"},n.Ay.createElement("div",{className:"multiline-item full-size",dir:"auto"},n.Ay.createElement("span",{className:"title",dir:"auto"},x.deviceModel),n.Ay.createElement("span",{className:"subtitle black tight"},x.appName," ",x.appVersion,","," ",x.platform," ",x.systemVersion),n.Ay.createElement("span",{className:"subtitle"},x.ip," ","-"," ",nu(x)))),P&&n.Ay.createElement(ca.A,{className:"destructive mb-0 no-icon",icon:"stop",ripple:!0,narrow:!0,onClick:u},d("TerminateAllSessions")))),P&&(T=I,n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:d.isRtl?"rtl":void 0},d("OtherSessions")),T.map(function(e){const t=a[e];return n.Ay.createElement(ca.A,{key:t.hash,ripple:!0,narrow:!0,contextActions:[{title:"Terminate",icon:"stop",destructive:!0,handler:()=>{b(t.hash)}}],icon:`device-${eu(t)}`,iconClassName:"icon-device",onClick:()=>{S(t.hash)}},n.Ay.createElement("div",{className:"multiline-item full-size",dir:"auto"},n.Ay.createElement("span",{className:"date"},(0,$e.be)(d,1e3*t.dateActive)),n.Ay.createElement("span",{className:"title"},t.deviceModel),n.Ay.createElement("span",{className:"subtitle black tight"},t.appName," ",t.appVersion,","," ",t.platform," ",t.systemVersion),n.Ay.createElement("span",{className:"subtitle"},t.ip," ",nu(t))))}))),n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:d.isRtl?"rtl":void 0},d("TerminateOldSessionHeader")),n.Ay.createElement("p",{className:"settings-item-description-larger"},d("IfInactiveFor")),n.Ay.createElement(ee.A,{name:"session_ttl",options:f,selected:E,onChange:w})),P&&n.Ay.createElement(ya.A,{isOpen:m,onClose:A,text:d("AreYouSureSessions"),confirmLabel:d("TerminateAllSessions"),confirmHandler:C,confirmIsDestructive:!0,areButtonsInColumn:!0}),n.Ay.createElement(au,{isOpen:p,hash:h,onClose:k}));var T,x})),ru="YRYk96ki",iu=(0,n.ph)((0,s.EK)((e,{hash:t})=>{const a=t?e.activeWebSessions.byHash[t]:void 0;return{session:a,bot:a?e.users.byId[a.botId]:void 0}})(({isOpen:e,session:t,bot:a,onClose:r})=>{const{terminateWebAuthorization:i}=(0,s.ko)(),o=(0,B.A)(),l=(0,La.A)(t,!0),c=(0,La.A)(a,!0),d=(0,n.hb)(()=>{i({hash:t.hash}),r()},[r,t,i]);if(l)return n.Ay.createElement(X.A,{header:n.Ay.createElement("div",{className:"modal-header-condensed",dir:o.isRtl?"rtl":void 0},n.Ay.createElement(Y.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:o("Close"),onClick:r},n.Ay.createElement(Q.A,{name:"close"})),n.Ay.createElement("div",{className:"modal-title"},o("WebSessionsTitle")),n.Ay.createElement(Y.A,{color:"danger",onClick:d,className:(0,ue.A)("modal-action-button","lUf0RJ2h")},o("AuthSessions.LogOut"))),isOpen:e,hasCloseButton:!0,onClose:r,className:"Wd0fmiSY"},n.Ay.createElement(xt.A,{className:"OhZHdRsP",peer:c,size:"large"}),c&&n.Ay.createElement(Vn.A,{className:"EQ7__xGn",peer:c}),n.Ay.createElement("div",{className:ru},l?.domain),n.Ay.createElement("dl",{className:"kmCTIfvf"},n.Ay.createElement("dt",null,o("AuthSessions.View.Browser")),n.Ay.createElement("dd",null,l?.browser),n.Ay.createElement("dt",null,o("SessionPreview.Ip")),n.Ay.createElement("dd",null,l?.ip),n.Ay.createElement("dt",null,o("SessionPreview.Location")),n.Ay.createElement("dd",null,l?.region)),n.Ay.createElement("p",{className:ru},o("AuthSessions.View.LocationInfo")))})),ou={avatar:"v0wP46TR","clear-help":"WnnxcARX",clearHelp:"WnnxcARX",subtitle:"uEUfjByC"},lu=(0,n.ph)((0,s.EK)(e=>{const{byHash:t,orderedHashes:a}=e.activeWebSessions;return{byHash:t,orderedHashes:a}})(({isActive:e,byHash:t,orderedHashes:a,onReset:r})=>{const{terminateWebAuthorization:i,terminateAllWebAuthorizations:o}=(0,s.ko)(),l=(0,B.A)(),[c,d,m]=(0,M.A)(),[u,A]=(0,n.J0)(),[h,y,p]=(0,M.A)(),g=(0,n.hb)(e=>{i({hash:e})},[i]),v=(0,n.hb)(()=>{m(),o()},[m,o]),E=(0,n.hb)(e=>{A(e),y()},[y]),f=(0,n.hb)(()=>{A(void 0),p()},[p]);var b;if((0,n.vJ)(()=>{a.length||r()},[r,a]),(0,Ee.A)({isActive:e,onBack:r}),a.length)return n.Ay.createElement("div",{className:"settings-content custom-scroll"},n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement(ca.A,{className:"destructive mb-0 no-icon",icon:"stop",ripple:!0,narrow:!0,onClick:d},l("AuthSessions.LogOutApplications")),n.Ay.createElement("p",{className:(0,ue.A)("settings-item-description",ou.clearHelp)},l("ClearOtherWebSessionsHelp"))),(b=a,n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:l.isRtl?"rtl":void 0},l("WebSessionsTitle")),b.map(function(e){const a=t[e],r=(0,s.mS)().users.byId[a.botId];return n.Ay.createElement(ca.A,{key:a.hash,ripple:!0,narrow:!0,contextActions:[{title:"Terminate",icon:"stop",destructive:!0,handler:()=>{g(a.hash)}}],onClick:()=>E(a.hash)},n.Ay.createElement(xt.A,{className:ou.avatar,peer:r,size:"tiny"}),n.Ay.createElement("div",{className:"multiline-item full-size",dir:"auto"},n.Ay.createElement("span",{className:"date"},(0,$e.be)(l,1e3*a.dateActive)),r&&n.Ay.createElement(Vn.A,{className:ou.title,peer:r}),n.Ay.createElement("span",{className:(0,ue.A)("subtitle","black","tight",ou.platform)},a.domain,",",a.browser,",",a.platform),n.Ay.createElement("span",{className:(0,ue.A)("subtitle",ou.subtitle)},a.ip," ",a.region)))}))),n.Ay.createElement(ya.A,{isOpen:c,onClose:m,title:l("AuthSessions.LogOutApplications"),text:l("AreYouSureWebSessions"),confirmHandler:v,confirmIsDestructive:!0}),n.Ay.createElement(iu,{isOpen:h,hash:u,onClose:f}))})),cu=(0,n.ph)(({stickerSet:e,noPlay:t,className:a,observeIntersection:s,onClick:r})=>{const o=(0,B.A)(),l=e?.stickers?.[0],c=(0,x.A)(()=>{l&&r(l)});if(e?.stickers)return n.Ay.createElement(ca.A,{className:(0,ue.A)("StickerSetCard","small-icon",a),style:"height: 56px;",inactive:!l,onClick:c},function(){if(e)return e.hasThumbnail||!l?n.Ay.createElement(Y.A,{ariaLabel:e.title,color:"translucent",isRtl:o.isRtl},n.Ay.createElement(yo,{stickerSet:e,size:i.RCH,noPlay:t,observeIntersection:s})):n.Ay.createElement(fo,{sticker:l,size:i.RCH,title:e.title,noPlay:t,observeIntersection:s,noContextMenu:!0,isCurrentUserPremium:!0,clickArg:void 0})}(),n.Ay.createElement("div",{className:"multiline-item"},n.Ay.createElement("div",{className:"title"},e.title),n.Ay.createElement("div",{className:"subtitle"},o("StickerPack.StickerCount",e.count,"i"))))}),du=(0,n.ph)((0,s.EK)(e=>({...(0,Ea.Up)(e.settings.byKey,["shouldSuggestCustomEmoji"]),customEmojiSetIds:e.customEmojis.added.setIds,stickerSetsById:e.stickers.setsById,canPlayAnimatedEmojis:(0,c.BWX)(e)}))(({isActive:e,customEmojiSetIds:t,stickerSetsById:a,shouldSuggestCustomEmoji:r,canPlayAnimatedEmojis:i,onReset:o})=>{const{openStickerSet:l,setSettingOption:c}=(0,s.ko)(),d=(0,B.A)(),m=(0,n.li)(),{observe:u}=(0,io.BL)({rootRef:m});(0,Ee.A)({isActive:e,onBack:o});const A=(0,n.hb)(e=>{l({stickerSetInfo:e.stickerSetInfo})},[l]),h=(0,n.hb)(e=>{c({shouldSuggestCustomEmoji:e})},[c]),y=(0,n.Kr)(()=>t&&Object.values((0,Ea.Up)(a,t)),[t,a]);return n.Ay.createElement("div",{className:"settings-content custom-scroll"},y&&n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement(as.A,{label:d("SuggestAnimatedEmoji"),checked:r,onCheck:h}),n.Ay.createElement("div",{className:"mt-4",ref:m},y.map(e=>n.Ay.createElement(cu,{key:e.id,stickerSet:e,observeIntersection:u,onClick:A,noPlay:!i}))),n.Ay.createElement("p",{className:"settings-item-description mt-3",dir:"auto"},(0,Tt.A)(d("EmojiBotInfo"),["links"]))))})),mu=(0,n.ph)((0,s.EK)(e=>(0,Ea.Up)(e.settings.byKey,["canAutoLoadPhotoFromContacts","canAutoLoadPhotoInPrivateChats","canAutoLoadPhotoInGroups","canAutoLoadPhotoInChannels","canAutoLoadVideoFromContacts","canAutoLoadVideoInPrivateChats","canAutoLoadVideoInGroups","canAutoLoadVideoInChannels","canAutoLoadFileFromContacts","canAutoLoadFileInPrivateChats","canAutoLoadFileInGroups","canAutoLoadFileInChannels","autoLoadFileMaxSizeMb"]))(({isActive:e,onReset:t,canAutoLoadPhotoFromContacts:a,canAutoLoadPhotoInPrivateChats:r,canAutoLoadPhotoInGroups:o,canAutoLoadPhotoInChannels:l,canAutoLoadVideoFromContacts:c,canAutoLoadVideoInPrivateChats:d,canAutoLoadVideoInGroups:m,canAutoLoadVideoInChannels:u,canAutoLoadFileFromContacts:A,canAutoLoadFileInPrivateChats:h,canAutoLoadFileInGroups:y,canAutoLoadFileInChannels:p,autoLoadFileMaxSizeMb:g})=>{const{setSettingOption:v}=(0,s.ko)(),E=(0,Ua.A)();(0,Ee.A)({isActive:e,onBack:t});const f=(0,n.hb)(e=>E("AutodownloadSizeLimitUpTo",{limit:E("FileSizeMB",{count:i.$gx[e]})}),[E]),b=(0,n.hb)(e=>{v({autoLoadFileMaxSizeMb:i.$gx[e]})},[v]);function C(e,t,a,s,r,o){return n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:E.isRtl?"rtl":void 0},e),n.Ay.createElement(as.A,{label:E("AutoDownloadSettingsContacts"),checked:a,onCheck:e=>v({[`canAutoLoad${t}FromContacts`]:e})}),n.Ay.createElement(as.A,{label:E("AutoDownloadSettingsPrivateChats"),checked:s,onCheck:e=>v({[`canAutoLoad${t}InPrivateChats`]:e})}),n.Ay.createElement(as.A,{label:E("AutoDownloadSettingsGroupChats"),checked:r,onCheck:e=>v({[`canAutoLoad${t}InGroups`]:e})}),n.Ay.createElement(as.A,{label:E("AutoDownloadSettingsChannels"),checked:o,onCheck:e=>v({[`canAutoLoad${t}InChannels`]:e})}),"File"===t&&function(){const e=i.$gx.indexOf(g);return n.Ay.createElement("div",{className:"pt-5"},n.Ay.createElement(Qe.A,{label:E("AutoDownloadMaxFileSize"),min:0,max:5,value:-1!==e?e:2,renderValue:f,onChange:b}))}())}return n.Ay.createElement("div",{className:"settings-content custom-scroll"},C(E("AutoDownloadPhotosTitle"),"Photo",a,r,o,l),C(E("AutoDownloadVideosTitle"),"Video",c,d,m,u),C(E("AutoDownloadFilesTitle"),"File",A,h,y,p))})),uu={root:"Ys1i4ssl",item:"skaVPMTF"},Au=["af","als","am","an","ar","arz","as","ast","av","az","azb","ba","bar","bcl","be","bg","bh","bn","bo","bpy","br","bs","bxr","ca","cbk","ce","ceb","ckb","co","cs","cv","cy","da","de","diq","dsb","dty","dv","el","eml","en","eo","es","et","eu","fa","fi","fr","frr","fy","ga","gd","gl","gn","gom","gu","gv","he","hi","hif","hr","hsb","ht","hu","hy","ia","id","ie","ilo","io","is","it","ja","jbo","jv","ka","kk","km","kn","ko","krc","ku","kv","kw","ky","la","lb","lez","li","lmo","lo","lrc","lt","lv","mai","mg","mhr","min","mk","ml","mn","mr","mrj","ms","mt","mwl","my","myv","mzn","nah","nap","nds","ne","new","nl","nn","no","oc","or","os","pa","pam","pfl","pl","pms","pnb","ps","pt","qu","rm","ro","ru","rue","sa","sah","sc","scn","sco","sd","sh","si","sk","sl","so","sq","sr","su","sv","sw","ta","te","tg","th","tk","tl","tr","tt","tyv","ug","uk","ur","uz","vec","vep","vi","vls","vo","wa","war","wuu","xal","xmf","yi","yo","yue","zh"],hu=i.N89.filter(e=>Au.includes(e)),yu=(0,n.ph)((0,s.EK)(e=>{const{doNotTranslate:t}=e.settings.byKey;return{doNotTranslate:t}})(({isActive:e,doNotTranslate:t,onReset:a})=>{const{setSettingOption:r}=(0,s.ko)(),i=(0,B.A)().code||"en",[o,l]=(0,n.J0)([]),[c,d]=(0,n.J0)(""),m=(0,n.Kr)(()=>{const e=hu.map(e=>({langCode:e,translatedName:new Intl.DisplayNames([i],{type:"language"}).of(e),originalName:new Intl.DisplayNames([e],{type:"language"}).of(e)})).filter(Boolean).map(({langCode:e,translatedName:t,originalName:a})=>({label:t,subLabel:a,value:e}));if(!c.trim()){const t=e.find(e=>e.value===i),a=e.filter(e=>e.value!==i);return t?[t,...a]:e}return e?.filter(e=>e.label.toLowerCase().includes(c.toLowerCase()))},[i,c]);(0,Sa.A)(([a,n])=>{if(a===e&&n?.find(e=>e===i))return;const[s]=(0,Ea.jB)(m,e=>t.includes(e.value));l([...s.map(e=>e.value)])},[e,t,o.length,i,m]);const u=(0,x.A)(e=>{l(e),r({doNotTranslate:e})});return(0,Ee.A)({isActive:e,onBack:a}),n.Ay.createElement("div",{className:(0,ue.A)(uu.root,"settings-content infinite-scroll")},n.Ay.createElement("div",{className:(0,ue.A)(uu.item)},n.Ay.createElement(Ci,{className:uu.picker,items:m,selectedValues:o,onSelectedValuesChange:u,filterValue:c,onFilterChange:d,isSearchable:!0,allowMultiple:!0,withDefaultPadding:!0,itemInputType:"checkbox",searchInputId:"lang-picker-search"})))})),pu=(0,n.ph)(({chatId:e,usernames:t,onEditUsername:a})=>{const{showNotification:r,toggleUsername:i,toggleChatUsername:o,sortUsernames:l,sortChatUsernames:c}=(0,s.ko)(),d=(0,B.A)(),[m,u]=(0,n.J0)(),A=(0,n.Kr)(()=>t.map(({username:e})=>e),[t]),h=(0,U.A)(A),[y,p]=(0,n.J0)({orderedUsernames:A,dragOrderUsernames:A,draggedIndex:void 0});(0,n.vJ)(()=>{h!==A&&p({orderedUsernames:A,dragOrderUsernames:A,draggedIndex:void 0})},[h,A]);const g=(0,n.hb)(e=>{(0,Dc.eM)(`@${e}`),r({message:d("UsernameCopied")})},[d,r]),v=(0,n.hb)(e=>{e.isEditable?a(e.username):u(e)},[a]),E=(0,n.hb)(()=>{u(void 0)},[]),f=(0,n.hb)(()=>{m&&(e?o({chatId:e,username:m.username,isActive:!m.isActive}):i({username:m.username,isActive:!m.isActive}),E())},[e,E,o,i,m]),b=(0,n.hb)((e,t)=>{const a=Math.round(e.y/56),n=y.orderedUsernames?.indexOf(t)||0,s=y.orderedUsernames?.filter(e=>e!==t);s&&(0,he.Bt)(n+a,0,A.length)&&(s.splice(n+a,0,t),p(e=>({...e,draggedIndex:n,dragOrderUsernames:s})))},[y.orderedUsernames,A.length]),C=(0,n.hb)(()=>{p(t=>(e?c({chatId:e,usernames:t.dragOrderUsernames}):l({usernames:t.dragOrderUsernames}),{...t,orderedUsernames:t.dragOrderUsernames,draggedIndex:void 0}))},[e,c,l]);return n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:"PaO1MMi5"},n.Ay.createElement("h4",{className:"wSswdVkR",dir:d.isRtl?"rtl":void 0},d("lng_usernames_subtitle")),n.Ay.createElement("div",{className:"lAeeBh9K",style:`height: ${56*t.length}px`},t.map((e,t)=>{const a=y.draggedIndex===t,s=56*(y.orderedUsernames?.indexOf(e.username)??0),r=56*(y.dragOrderUsernames?.indexOf(e.username)??0),i=e.isEditable?"lng_usernames_edit":e.isActive?"lng_usernames_active":"lng_usernames_non_active";return n.Ay.createElement(xm.A,{key:e.username,id:e.username,onDrag:b,onDragEnd:C,style:`top: ${a?s:r}px;`,knobStyle:(d.isRtl?"left":"right")+": 3rem;",isDisabled:!e.isActive},n.Ay.createElement(ca.A,{key:e.username,className:(0,ue.A)("drag-item no-icon","l04OwRBg"),narrow:!0,secondaryIcon:"more",icon:e.isActive?"link":"link-broken",multiline:!0,contextActions:[{handler:()=>{g(e.username)},title:d("Copy"),icon:"copy"}],onClick:()=>{v(e)}},n.Ay.createElement("span",{className:"title"},"@",e.username),n.Ay.createElement("span",{className:"subtitle"},d(i))))})),n.Ay.createElement("p",{className:"oiJc22Aj",dir:d.isRtl?"rtl":void 0},d("lng_usernames_description"))),n.Ay.createElement(ya.A,{isOpen:Boolean(m),onClose:E,title:d(m?.isActive?"Username.DeactivateAlertTitle":"Username.ActivateAlertTitle"),text:d(m?.isActive?"Username.DeactivateAlertText":"Username.ActivateAlertText"),confirmLabel:d(m?.isActive?"Username.DeactivateAlertHide":"Username.ActivateAlertShow"),confirmHandler:f,confirmIsDestructive:!m?.isActive}))});var gu=a(11116);const vu=/https:\/\/t\.me\/?/i,Eu=(0,ye.sg)(e=>e(),250,!1),fu=(0,n.ph)(({currentUsername:e,asLink:t,isLoading:a,isUsernameAvailable:r,checkedUsername:o,onChange:l})=>{const{checkUsername:c,checkPublicLink:d}=(0,s.ko)(),[m,u]=(0,n.J0)(e||""),A=(0,B.A)(),h=t?"SetUrl":"Username",y=A(t?"SetUrlPlaceholder":"Username"),p=(0,U.A)(r),g=e!==m?r??p:void 0,v=m&&e!==m&&o!==m,[E,f]=(0,n.Kr)(()=>m.length?m.length<gu.tX?[void 0,A(`${h}InvalidShort`)]:m.length>gu.Tk?[void 0,A(`${h}InvalidLong`)]:gu.Ny.test(m)?void 0===g||v?[]:[g?A(`${h}Available`,y):void 0,!1===g?A(`${h}InUse`):void 0]:[void 0,A(`${h}Invalid`)]:[],[m,g,v,A,h,y]);(0,n.vJ)(()=>{u(e||"")},[t,e]);const b=(0,n.hb)(a=>{const n=a.target.value.trim();if(t&&!n.match(vu))return void(n.length||(u(""),l?.("")));const s=n.replace(vu,"");u(s),(""===s||(0,gu.BU)(s,!0))&&(l?.(s),Eu(()=>{s!==e&&(t?d:c)({username:s})}))},[t,d,c,e,l]);return n.Ay.createElement(Z.A,{value:`${t?i.jsp:""}${m}`,onChange:b,label:v?A("Checking"):y,error:f,success:E,readOnly:a,teactExperimentControlled:!0})});var bu=a(43434);const Cu=(0,ye.nF)(e=>e(),6e4,!0),Su="Please provide your first name",ku=(0,n.ph)((0,s.EK)(e=>{const{currentUserId:t}=e,{progress:a,isUsernameAvailable:n,checkedUsername:s,error:r}=(0,c.nTw)(e).profileEdit||{},i=t?(0,c.mBe)(e,t):void 0,o=(0,dr.d)(e,"aboutLength");if(!i)return{progress:a,checkedUsername:s,isUsernameAvailable:n,editUsernameError:r,maxBioLength:o};const{firstName:d,lastName:m,usernames:u}=i,A=t?(0,c.vGo)(e,t):void 0;return{currentAvatarHash:(0,l.cP)(i),currentFirstName:d,currentLastName:m,currentBio:A?.bio,progress:a,isUsernameAvailable:n,checkedUsername:s,editUsernameError:r,maxBioLength:o,usernames:u}})(({isActive:e,currentAvatarHash:t,currentFirstName:a,currentLastName:o,currentBio:l,progress:c,checkedUsername:d,editUsernameError:m,isUsernameAvailable:u,maxBioLength:A,usernames:h,onReset:y})=>{const{loadCurrentUser:p,updateProfile:g}=(0,s.ko)(),v=(0,B.A)(),E=(0,n.Kr)(()=>h?.find(({isEditable:e})=>e),[h]),f=E?.username||"",[b,C]=(0,n.J0)(!1),[S,k]=(0,n.J0)(!1),[w,N]=(0,n.J0)(),[I,P]=(0,n.J0)(),[M,T]=(0,n.J0)(a||""),[x,L]=(0,n.J0)(o||""),[R,F]=(0,n.J0)(l||""),[D,V]=(0,n.J0)(f),_=(0,H.A)(t,!1,J.qZ.BlobUrl),O=c===r.DV.InProgress,K=!1===D,G=(0,U.A)(u),j=u??G,z=h&&h.length>1,$=(0,n.Kr)(()=>!K&&(Boolean(I)||S||b&&!0===j),[K,I,S,b,j]);(0,Ee.A)({isActive:e,onBack:y}),(0,n.vJ)(()=>{Cu(()=>{p()})},[p]),(0,n.vJ)(()=>{P(void 0)},[_]),(0,n.vJ)(()=>{T(a||""),L(o||""),F(l||"")},[a,o,l]),(0,n.vJ)(()=>{V(f||"")},[f]),(0,n.vJ)(()=>{c===r.DV.Complete&&(k(!1),C(!1),N(void 0))},[c]);const q=(0,n.hb)(e=>{P(e)},[]),W=(0,n.hb)(e=>{T(e.target.value),k(!0)},[]),Y=(0,n.hb)(e=>{L(e.target.value),k(!0)},[]),X=(0,n.hb)(e=>{F(e.target.value),k(!0)},[]),ee=(0,n.hb)(e=>{V(e),C(f!==e)},[f]),te=(0,n.hb)(()=>{const e=M.trim(),t=x.trim(),a=R.trim();D&&(e.length?g({photo:I,...S&&{firstName:e,lastName:t,bio:a},...b&&{username:D}}):N(Su))},[I,M,x,R,S,D,b,g]);return n.Ay.createElement("div",{className:"settings-fab-wrapper"},n.Ay.createElement("div",{className:"settings-content no-border custom-scroll"},n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("div",{className:"settings-input"},n.Ay.createElement(bu.A,{currentAvatarBlobUrl:_,onChange:q,title:"Edit your profile photo",disabled:O}),n.Ay.createElement(Z.A,{value:M,onChange:W,label:v("FirstName"),disabled:O,error:w===Su?w:void 0}),n.Ay.createElement(Z.A,{value:x,onChange:Y,label:v("LastName"),disabled:O}),n.Ay.createElement(Xl.A,{value:R,onChange:X,label:v("UserBio"),disabled:O,maxLength:A,maxLengthIndicator:A?(A-R.length).toString():void 0})),n.Ay.createElement("p",{className:"settings-item-description",dir:v.isRtl?"rtl":void 0},(0,Tt.A)(v("lng_settings_about_bio"),["br","simple_markdown"]))),n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:v.isRtl?"rtl":void 0},v("Username")),n.Ay.createElement("div",{className:"settings-input"},n.Ay.createElement(fu,{currentUsername:f,isLoading:O,isUsernameAvailable:u,checkedUsername:d,onChange:ee})),m===i.Y3M&&function(){const e=`${i.jsp}${i.NjX}`;return n.Ay.createElement("p",{className:"settings-item-description",dir:v.isRtl?"rtl":void 0},v("lng_username_purchase_available").replace("{link}","%PURCHASE_LINK%").split("%").map(t=>"PURCHASE_LINK"===t?n.Ay.createElement(Vl.A,{url:e,text:`@${i.NjX}`}):t))}(),n.Ay.createElement("p",{className:"settings-item-description",dir:v.isRtl?"rtl":void 0},(0,Tt.A)(v("UsernameHelp"),["br","simple_markdown"])),D&&n.Ay.createElement("p",{className:"settings-item-description",dir:v.isRtl?"rtl":void 0},v("lng_username_link"),n.Ay.createElement("br",null),n.Ay.createElement("span",{className:"username-link"},i.jsp,D))),z&&n.Ay.createElement(pu,{usernames:h,onEditUsername:V})),n.Ay.createElement(ka.A,{isShown:$,onClick:te,disabled:O,ariaLabel:v("Save")},O?n.Ay.createElement(Ve.A,{color:"white"}):n.Ay.createElement(Q.A,{name:"check"})))}));var wu=a(61182),Nu=a(15006);const Iu=(0,n.ph)((0,s.EK)(e=>{const{shouldForceHttpTransport:t,shouldAllowHttpTransport:a,shouldCollectDebugLogs:n,shouldDebugExportedSenders:s}=(0,hs.l)(e);return{shouldForceHttpTransport:t,shouldAllowHttpTransport:a,shouldCollectDebugLogs:n,shouldDebugExportedSenders:s}})(({isActive:e,onReset:t,shouldForceHttpTransport:a,shouldAllowHttpTransport:r,shouldCollectDebugLogs:o,shouldDebugExportedSenders:l})=>{const{requestConfetti:c,setSharedSettingOption:d,requestWave:m}=(0,s.ko)(),u=(0,n.li)(),[A,h]=(0,n.J0)(!1),y=(0,B.A)(),[p,g]=(0,n.J0)(!1);(0,n.vJ)(()=>{window.electron?.getIsAutoUpdateEnabled().then(g)},[]),(0,Ee.A)({isActive:e,onBack:t});const v=(0,x.A)(()=>{const e=new File([(0,wu.F8)()],i.lFE,{type:"text/plain"}),t=URL.createObjectURL(e);(0,Fa.A)(t,i.lFE)}),f=(0,n.hb)(e=>{window.electron?.setIsAutoUpdateEnabled(e)},[]),b=(0,x.A)(e=>{m({startX:e.clientX,startY:e.clientY})}),C=(0,x.A)(()=>{c({withStars:!0})}),S=(0,x.A)(()=>{const e=u.current;e&&(0,Nu.U)(e)&&(h(!0),setTimeout(()=>{h(!1)},1500))});return n.Ay.createElement("div",{className:"settings-content custom-scroll"},n.Ay.createElement("div",{className:"settings-content-header no-border"},n.Ay.createElement(So.A,{tgsUrl:Co.w.Experimental,size:200,className:"experimental-duck",nonInteractive:!0,noLoop:!1}),n.Ay.createElement("p",{className:"settings-item-description pt-3",dir:"auto"},y("lng_settings_experimental_about"))),n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement(ca.A,{onClick:C,icon:"animations"},n.Ay.createElement("div",{className:"title"},"Launch some confetti!")),n.Ay.createElement(ca.A,{onClick:b,icon:"story-expired",disabled:!E.J6},n.Ay.createElement("div",{className:"title"},"Start wave")),n.Ay.createElement(ca.A,{ref:u,onClick:S,icon:"spoiler",disabled:!E.bW,style:A?"visibility: hidden":""},n.Ay.createElement("div",{className:"title"},"Vaporize this button")),n.Ay.createElement(as.A,{label:"Allow HTTP Transport",checked:Boolean(r),onCheck:()=>d({shouldAllowHttpTransport:!r})}),n.Ay.createElement(as.A,{label:"Force HTTP Transport",disabled:!r,checked:Boolean(a),onCheck:()=>d({shouldForceHttpTransport:!a})}),n.Ay.createElement(as.A,{label:y("DebugMenuEnableLogs"),checked:Boolean(o),onCheck:()=>d({shouldCollectDebugLogs:!o})}),n.Ay.createElement(as.A,{label:"Enable exported senders debug",checked:Boolean(l),onCheck:()=>d({shouldDebugExportedSenders:!l})}),E.cp&&n.Ay.createElement(as.A,{label:"Enable autoupdates",checked:Boolean(p),onCheck:f}),n.Ay.createElement(ca.A,{onClick:v,icon:"bug"},n.Ay.createElement("div",{className:"title"},"Download log"))))}));var Pu=a(6e4),Mu=a(84382);const Tu=(0,n.ph)((0,s.EK)(e=>{const{theme:t,shouldUseSystemTheme:a,messageSendKeyCombo:n,messageTextSize:s,timeFormat:r}=(0,hs.l)(e);return{messageSendKeyCombo:n,messageTextSize:s,timeFormat:r,theme:t,shouldUseSystemTheme:a}})(({isActive:e,messageTextSize:t,messageSendKeyCombo:a,timeFormat:i,theme:o,shouldUseSystemTheme:l,onReset:c})=>{const{setSharedSettingOption:d,openSettingsScreen:m}=(0,s.ko)(),u=(0,Ua.A)(),{isMobile:A}=(0,I.Ay)(),h=A&&(E.pz||E.Ni),y=[{label:u("SettingsTimeFormat12"),value:"12h"},{label:u("SettingsTimeFormat24"),value:"24h"}],p=[{label:u("EmptyChatAppearanceLight"),value:"light"},{label:u("EmptyChatAppearanceDark"),value:"dark"},{label:u("EmptyChatAppearanceSystem"),value:"auto"}],g=h?void 0:[{value:"enter",label:u("SettingsSendEnter"),subLabel:u("SettingsSendEnterDescription")},{value:"ctrl-enter",label:u(E.MP||E.pz?"SettingsSendCmdenter":"SettingsSendCtrlenter"),subLabel:u("SettingsSendPlusEnterDescription")}],v=(0,n.hb)(e=>{document.documentElement.style.setProperty("--composer-text-size",`${Math.max(e,E.pz?16:15)}px`),document.documentElement.style.setProperty("--message-meta-height",`${Math.floor(1.3125*e)}px`),document.documentElement.style.setProperty("--message-text-size",`${e}px`),document.documentElement.setAttribute("data-message-text-size",e.toString()),d({messageTextSize:e})},[]),f=(0,n.hb)(e=>{const t="auto"===e?(0,Mu.V)():e;d({theme:t}),d({shouldUseSystemTheme:"auto"===e})},[]),b=(0,n.hb)(e=>{d({timeFormat:e}),d({wasTimeFormatSetManually:!0}),(0,Pu.bV)(e)},[]),C=(0,n.hb)(e=>{d({messageSendKeyCombo:e})},[]),[S,k]=(0,n.J0)(!1);(0,n.vJ)(()=>{window.electron?.getIsTrayIconEnabled().then(k)},[]);const w=(0,n.hb)(e=>{window.electron?.setIsTrayIconEnabled(e)},[]);return(0,Ee.A)({isActive:e,onBack:c}),n.Ay.createElement("div",{className:"settings-content custom-scroll"},n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:u.isRtl?"rtl":void 0},u("Settings")),n.Ay.createElement(Qe.A,{label:u("TextSize"),min:12,max:20,value:t,onChange:v}),n.Ay.createElement(ca.A,{icon:"photo",narrow:!0,onClick:()=>m({screen:r.VS.GeneralChatBackground})},u("ChatBackground")),E.cp&&E.H8&&n.Ay.createElement(as.A,{label:u("SettingsTray"),checked:Boolean(S),onCheck:w})),n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:u.isRtl?"rtl":void 0},u("Theme")),n.Ay.createElement(ee.A,{name:"theme",options:p,selected:l?"auto":o,onChange:f})),n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:u.isRtl?"rtl":void 0},u("SettingsTimeFormat")),n.Ay.createElement(ee.A,{name:"timeformat",options:y,selected:i,onChange:b})),g&&n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:u.isRtl?"rtl":void 0},u("SettingsKeyboard")),n.Ay.createElement(ee.A,{name:"keyboard-send-settings",options:g,onChange:C,selected:a})))}));var xu=a(52844),Bu=a(74824);const Lu=(0,n.ph)(({wallpaper:e,theme:t,isSelected:a,onClick:s})=>{const{slug:o,document:l}=e,c=`wallpaper${l.id}`,d=l.previewBlobUrl,m=(0,H.A)(`${c}?size=m`),u=(0,_a.A)(l.thumbnail?.dataUri,Boolean(m),!0),{transitionClassNames:A}=(0,Ke.A)(Boolean(m||d),void 0,void 0,"slow"),h=(0,n.li)(!1),[y,p]=(0,n.J0)(!1),{mediaData:g,loadProgress:v}=(0,$.A)(c,!y),E=!1===(0,U.A)(y),{shouldRender:f,transitionClassNames:b}=(0,Ke.A)(y&&!g||o===r.Vw,void 0,E,"slow"),C=(0,n.li)();C.current=t;const S=(0,n.hb)(()=>{(async()=>{const e=await(0,G.sZ)(g);await Bu.save(i.nfi,C.current,e),s(o)})()},[g,s,o]);(0,n.vJ)(()=>{g&&h.current&&(S(),h.current=!1)},[g,S]);const k=(0,n.hb)(()=>{g?S():(h.current=!0,p(e=>!e))},[g,S]),w=(0,ue.A)("WallpaperTile",a&&"selected");return n.Ay.createElement("div",{className:w,onClick:k},n.Ay.createElement("div",{className:"media-inner"},n.Ay.createElement("canvas",{ref:u,className:"thumbnail"}),n.Ay.createElement("img",{src:m||d,className:(0,ue.A)("full-media",A),alt:"",draggable:!1}),f&&n.Ay.createElement("div",{className:(0,ue.A)("spinner-container",b)},n.Ay.createElement(de.A,{progress:v,onClick:k}))))}),Ru=(0,ye.nF)(e=>e(),6e4,!0),Fu=(0,n.ph)((0,s.EK)(e=>{const t=(0,c.SJA)(e),{background:a,isBlurred:n}=(0,c.Gyz)(e,t)||{},{loadedWallpapers:s}=e.settings;return{background:a,isBlurred:n,loadedWallpapers:s,theme:t}})(({isActive:e,onReset:t,background:a,isBlurred:o,loadedWallpapers:l,theme:c})=>{const{loadWallpapers:d,uploadWallpaper:m,setThemeSettings:u,openSettingsScreen:A}=(0,s.ko)(),h=(0,n.li)();h.current=c,(0,n.vJ)(()=>{Ru(()=>{d()})},[d]);const y=(0,n.hb)(e=>{const{files:t}=e.target,a=(0,G.kc)(t);a?.length&&m(a[0])},[m]),p=(0,n.hb)(()=>{(0,xu.p)("image/jpeg",y,!0)},[y]),g=(0,n.hb)(()=>{A({screen:r.VS.GeneralChatBackgroundColor})},[]),v=(0,n.hb)(()=>{u({theme:c,background:void 0,backgroundColor:void 0,isBlurred:!0,patternColor:"dark"===c?i.MkD:i.be8})},[u,c]),E=(0,n.hb)(e=>{u({theme:h.current,background:e});const t=l&&l.find(t=>t.slug===e);t?.document.thumbnail&&(0,ys.rX)(t.document.thumbnail.dataUri).then(e=>{const t=(0,ys.Yi)(e),a=`#${(0,ys.v2)(e)}`;u({theme:h.current,backgroundColor:a,patternColor:t})})},[l,u]),f=(0,n.hb)(e=>{u({theme:h.current,isBlurred:e.target.checked})},[u]),b=(0,B.A)();(0,Ee.A)({isActive:e,onBack:t});const C=l?.[0]&&l[0].slug===r.Vw;return n.Ay.createElement("div",{className:"SettingsGeneralBackground settings-content custom-scroll"},n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement(ca.A,{icon:"camera-add",className:"mb-0",disabled:C,onClick:p},b("UploadImage")),n.Ay.createElement(ca.A,{icon:"colorize",className:"mb-0",onClick:g},b("SetColor")),n.Ay.createElement(ca.A,{icon:"favorite",onClick:v},b("ThemeResetToDefaults")),n.Ay.createElement(as.A,{label:b("BackgroundBlurred"),checked:Boolean(o),onChange:f})),l?n.Ay.createElement("div",{className:"settings-wallpapers"},l.map(e=>n.Ay.createElement(Lu,{key:e.slug,wallpaper:e,theme:c,isSelected:a===e.slug,onClick:E}))):n.Ay.createElement(Dn.A,null))})),Du=(0,ys.bM)((0,ys.xp)("e6ebee")),Vu=["#e6ebee","#b2cee1","#008dd0","#c6e7cb","#c4e1a6","#60b16e","#ccd0af","#a6a997","#7a7072","#fdd7af","#fdb76e","#dd8851"];function _u(e,t){return{colorPosition:[Math.round(e[1]*(t.colorRect.width-1)),Math.round((1-e[2])*(t.colorRect.height-1))],huePosition:Math.round(e[0]*(t.hueRect.width-1))}}function Uu({colorPosition:e,huePosition:t},a){return[t/(a.hueRect.width-1),e[0]/(a.colorRect.width-1),1-e[1]/(a.colorRect.height-1)]}const Ou=(0,n.ph)((0,s.EK)(e=>{const t=(0,c.SJA)(e),{backgroundColor:a}=(0,c.Gyz)(e,t)||{};return{backgroundColor:a,theme:t}})(({isActive:e,onReset:t,theme:a,backgroundColor:r})=>{const{setThemeSettings:i}=(0,s.ko)(),o=(0,n.li)();o.current=a;const l=(0,n.li)(),c=(0,n.li)(),d=(0,n.li)(),m=(0,n.li)(!0),[u,A]=(0,n.J0)(function(e){return e&&e.startsWith("#")?(0,ys.bM)((0,ys.xp)(e.replace("#",""))):Du}(r)),h=(0,n.li)(u);(0,n.vJ)(()=>{h.current=u},[u]);const[y,p,g]=(0,M.A)(),[v,E]=(0,n.J0)(""),[f,b]=(0,n.J0)(""),C=(0,n.li)(),S=(0,n.li)();(0,n.vJ)(()=>{const e={offsetLeft:c.current.offsetLeft,...(0,Ea.Up)(c.current.getBoundingClientRect(),["top","width","height"])},t={offsetLeft:d.current.offsetLeft,...(0,Ea.Up)(d.current.getBoundingClientRect(),["width"])};function a(t){const a=[Math.min(Math.max(0,t.pageX-e.offsetLeft),e.width-1),Math.min(Math.max(0,t.pageY-e.top+l.current.scrollTop),e.height-1)],{huePosition:n}=_u(h.current,C.current);return A(Uu({colorPosition:a,huePosition:n},C.current)),p(),!0}function n(e){const{colorPosition:a}=_u(h.current,C.current),n=Math.min(Math.max(0,e.pageX-t.offsetLeft),t.width-1);return A(Uu({colorPosition:a,huePosition:n},C.current)),p(),!0}C.current={colorRect:e,hueRect:t},(0,Ae.wJ)(c.current,{onCapture:a,onDrag:a,onRelease:g,onClick:g,selectorToPreventScroll:".SettingsGeneralBackgroundColor",withCursor:!0}),(0,Ae.wJ)(d.current,{onCapture:n,onDrag:n,onRelease:g,onClick:g,selectorToPreventScroll:".SettingsGeneralBackgroundColor",withCursor:!0})},[p,g]);const{colorPosition:k=[0,0],huePosition:w=0}=C.current?_u(u,C.current):{},N=(0,ys.v2)((0,ys.Zf)(u)),I=u[0],P=(0,ys.v2)((0,ys.Zf)([I,1,1]));(0,n.vJ)(()=>{const e=(0,ys.Zf)(u),t=`#${(0,ys.v2)(e)}`;if(E(e.join(", ")),b(t),!m.current){const a=(0,ys.Yi)(e);i({theme:o.current,background:void 0,backgroundColor:t,patternColor:a})}m.current=!1},[u,i]),(0,n.vJ)(()=>{!function(e,t,a,n){let s,r,i;a.current&&n.current?(s=n.current.colorRect.width,r=n.current.colorRect.height,i=a.current):(s=e.offsetWidth,r=e.offsetHeight,i=e.getContext("2d"),e.width=s,e.height=r,a.current=i);const o=i.createImageData(s,r),l=o.data,c=(0,ys.Zf)([t,1,1]);let d=0;for(let e=0;e<r;e++){const t=1-e/(r-1),a=[255*t,255*t,255*t],n=[c[0]*t,c[1]*t,c[2]*t];for(let e=0;e<s;e++){const t=e/(s-1);l[d++]=a[0]+(n[0]-a[0])*t,l[d++]=a[1]+(n[1]-a[1])*t,l[d++]=a[2]+(n[2]-a[2])*t,l[d++]=255}}i.putImageData(o,0,0)}(c.current.firstChild,I,S,C)},[I]),(0,n.vJ)(()=>{!function(e){const t=e.offsetWidth;e.width=t,e.height=1;const a=e.getContext("2d"),n=a.createImageData(t,1),s=n.data;let r=0;for(let e=0;e<t;e++){const a=e/(t-1),n=(0,ys.Zf)([a,1,1]);s[r++]=n[0],s[r++]=n[1],s[r++]=n[2],s[r++]=255}a.putImageData(n,0,0)}(d.current.firstChild)},[]);const T=(0,n.hb)(e=>{const t=e.currentTarget.value.replace(/[^\d, ]/g,"").slice(0,13);if(t.match(/^\d{1,3},\s?\d{1,3},\s?\d{1,3}$/)){const e=t.split(",").map(e=>Number(e.trim()));A((0,ys.bM)(e))}e.currentTarget.value=t},[]),x=(0,n.hb)(e=>{const t=e.currentTarget.value.replace(/[^0-9a-fA-F]/g,"").slice(0,6);t.match(/^#?[0-9a-fA-F]{6}$/)&&A((0,ys.bM)((0,ys.xp)(t.replace("#","")))),e.currentTarget.value=t},[]),B=(0,n.hb)(e=>{A((0,ys.bM)((0,ys.xp)(e.currentTarget.dataset.color.replace("#",""))))},[]),L=(0,ue.A)("SettingsGeneralBackgroundColor settings-content custom-scroll",y&&"is-dragging");return(0,Ee.A)({isActive:e,onBack:t}),n.Ay.createElement("div",{ref:l,className:L},n.Ay.createElement("div",{className:"settings-item pt-3"},n.Ay.createElement("div",{ref:c,className:"color-picker"},n.Ay.createElement("canvas",null),n.Ay.createElement("div",{className:"handle",style:`transform: translate(${k[0]}px, ${k[1]}px); background-color: #${N};`})),n.Ay.createElement("div",{ref:d,className:"hue-picker"},n.Ay.createElement("canvas",null),n.Ay.createElement("div",{className:"handle",style:`transform: translateX(${w}px); background-color: #${P};`})),n.Ay.createElement("div",{className:"tools"},n.Ay.createElement(Z.A,{value:f,label:"HEX",onChange:x}),n.Ay.createElement(Z.A,{value:v,label:"RGB",onChange:T}))),n.Ay.createElement("div",{className:"predefined-colors"},Vu.map(e=>n.Ay.createElement("div",{className:(0,ue.A)("predefined-color",e===`#${N}`?"active":void 0),"data-color":e,style:`background-color: ${e};`,onClick:B}))))})),Ju=(0,n.ph)(({currentScreen:e,editedFolderId:t,onReset:a})=>{const{signOut:i,openDeleteChatFolderModal:o,openSettingsScreen:l}=(0,s.ko)(),{isMobile:c}=(0,I.Ay)(),[d,m]=(0,n.J0)(!1),u=function(e,t){const a=(0,n.li)(0),s=(0,n.li)();return(0,n.hb)(()=>{if(a.current++,5===a.current)return a.current=0,void t();s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{a.current=0},300)},[5,t])}(0,()=>{l({screen:r.VS.Experimental})}),A=(0,n.hb)(()=>{m(!0)},[]),h=(0,n.hb)(()=>{m(!1)},[]),y=(0,n.hb)(()=>{t&&o({folderId:t})},[t,o]),p=(0,n.hb)(()=>{h(),i({forceInitApi:!0})},[h,i]),g=(0,n.Kr)(()=>({onTrigger:e,isOpen:t})=>n.Ay.createElement(Y.A,{round:!0,ripple:!c,size:"smaller",color:"translucent",className:t?"active":"",onClick:e,ariaLabel:"More actions"},n.Ay.createElement(Q.A,{name:"more"})),[c]),v=(0,B.A)(),E=(0,Ua.A)();return n.Ay.createElement("div",{className:"left-header"},n.Ay.createElement(Y.A,{round:!0,size:"smaller",color:"translucent",onClick:a,ariaLabel:v("AccDescrGoBack")},n.Ay.createElement(Q.A,{name:"arrow-left"})),function(){switch(e){case r.VS.EditProfile:return n.Ay.createElement("h3",null,v("lng_settings_information"));case r.VS.General:return n.Ay.createElement("h3",null,v("General"));case r.VS.QuickReaction:return n.Ay.createElement("h3",null,v("DoubleTapSetting"));case r.VS.CustomEmoji:return n.Ay.createElement("h3",null,v("Emoji"));case r.VS.Notifications:return n.Ay.createElement("h3",null,v("Notifications"));case r.VS.DataStorage:return n.Ay.createElement("h3",null,v("DataSettings"));case r.VS.Privacy:return n.Ay.createElement("h3",null,v("PrivacySettings"));case r.VS.Language:return n.Ay.createElement("h3",null,v("Language"));case r.VS.DoNotTranslate:return n.Ay.createElement("h3",null,v("DoNotTranslate"));case r.VS.Stickers:return n.Ay.createElement("h3",null,v("StickersName"));case r.VS.Experimental:return n.Ay.createElement("h3",null,v("lng_settings_experimental"));case r.VS.GeneralChatBackground:return n.Ay.createElement("h3",null,v("ChatBackground"));case r.VS.GeneralChatBackgroundColor:return n.Ay.createElement("h3",null,v("SetColor"));case r.VS.PrivacyPhoneNumber:return n.Ay.createElement("h3",null,v("PrivacyPhone"));case r.VS.PrivacyLastSeen:return n.Ay.createElement("h3",null,v("PrivacyLastSeen"));case r.VS.PrivacyProfilePhoto:return n.Ay.createElement("h3",null,v("Privacy.ProfilePhoto"));case r.VS.PrivacyBio:return n.Ay.createElement("h3",null,v("PrivacyBio"));case r.VS.PrivacyBirthday:return n.Ay.createElement("h3",null,v("PrivacyBirthday"));case r.VS.PrivacyGifts:return n.Ay.createElement("h3",null,E("PrivacyGifts"));case r.VS.PrivacyForwarding:return n.Ay.createElement("h3",null,v("PrivacyForwards"));case r.VS.PrivacyVoiceMessages:return n.Ay.createElement("h3",null,v("PrivacyVoiceMessages"));case r.VS.PrivacyMessages:return n.Ay.createElement("h3",null,v("PrivacyMessages"));case r.VS.PrivacyGroupChats:return n.Ay.createElement("h3",null,v("AutodownloadGroupChats"));case r.VS.PrivacyPhoneCall:return n.Ay.createElement("h3",null,v("Calls"));case r.VS.PrivacyLastSeenAllowedContacts:case r.VS.PrivacyProfilePhotoAllowedContacts:case r.VS.PrivacyBioAllowedContacts:case r.VS.PrivacyGroupChatsAllowedContacts:return n.Ay.createElement("h3",null,v("AlwaysShareWith"));case r.VS.PrivacyLastSeenDeniedContacts:case r.VS.PrivacyProfilePhotoDeniedContacts:case r.VS.PrivacyBioDeniedContacts:case r.VS.PrivacyGroupChatsDeniedContacts:return n.Ay.createElement("h3",null,v("NeverShareWith"));case r.VS.PrivacyPhoneNumberAllowedContacts:case r.VS.PrivacyBirthdayAllowedContacts:case r.VS.PrivacyGiftsAllowedContacts:case r.VS.PrivacyForwardingAllowedContacts:case r.VS.PrivacyVoiceMessagesAllowedContacts:case r.VS.PrivacyPhoneCallAllowedContacts:case r.VS.PrivacyPhoneP2PAllowedContacts:return n.Ay.createElement("h3",null,v("AlwaysAllow"));case r.VS.PrivacyPhoneNumberDeniedContacts:case r.VS.PrivacyBirthdayDeniedContacts:case r.VS.PrivacyGiftsDeniedContacts:case r.VS.PrivacyForwardingDeniedContacts:case r.VS.PrivacyVoiceMessagesDeniedContacts:case r.VS.PrivacyPhoneCallDeniedContacts:case r.VS.PrivacyPhoneP2PDeniedContacts:return n.Ay.createElement("h3",null,v("NeverAllow"));case r.VS.PrivacyNoPaidMessages:return n.Ay.createElement("h3",null,E("RemoveFeeTitle"));case r.VS.Performance:return n.Ay.createElement("h3",null,E("MenuAnimations"));case r.VS.ActiveSessions:return n.Ay.createElement("h3",null,v("SessionsTitle"));case r.VS.ActiveWebsites:return n.Ay.createElement("h3",null,v("OtherWebSessions"));case r.VS.PrivacyBlockedUsers:return n.Ay.createElement("h3",null,v("BlockedUsers"));case r.VS.TwoFaDisabled:case r.VS.TwoFaEnabled:return n.Ay.createElement("h3",null,v("TwoStepVerification"));case r.VS.TwoFaNewPassword:case r.VS.TwoFaChangePasswordNew:case r.VS.TwoFaChangePasswordConfirm:return n.Ay.createElement("h3",null,v("PleaseEnterCurrentPassword"));case r.VS.TwoFaNewPasswordConfirm:return n.Ay.createElement("h3",null,v("PleaseReEnterPassword"));case r.VS.TwoFaNewPasswordHint:case r.VS.TwoFaChangePasswordHint:return n.Ay.createElement("h3",null,v("PasswordHint"));case r.VS.TwoFaNewPasswordEmail:case r.VS.TwoFaRecoveryEmail:return n.Ay.createElement("h3",null,v("RecoveryEmailTitle"));case r.VS.TwoFaNewPasswordEmailCode:case r.VS.TwoFaRecoveryEmailCode:return n.Ay.createElement("h3",null,"Recovery Email Code");case r.VS.TwoFaCongratulations:return n.Ay.createElement("h3",null,v("TwoStepVerificationPasswordSet"));case r.VS.TwoFaChangePasswordCurrent:case r.VS.TwoFaTurnOff:case r.VS.TwoFaRecoveryEmailCurrentPassword:return n.Ay.createElement("h3",null,v("PleaseEnterCurrentPassword"));case r.VS.PasscodeDisabled:case r.VS.PasscodeEnabled:case r.VS.PasscodeNewPasscode:case r.VS.PasscodeNewPasscodeConfirm:case r.VS.PasscodeCongratulations:return n.Ay.createElement("h3",null,v("Passcode"));case r.VS.PasscodeTurnOff:return n.Ay.createElement("h3",null,v("PasscodeController.Disable.Title"));case r.VS.PasscodeChangePasscodeCurrent:case r.VS.PasscodeChangePasscodeNew:return n.Ay.createElement("h3",null,v("PasscodeController.Change.Title"));case r.VS.PasscodeChangePasscodeConfirm:return n.Ay.createElement("h3",null,v("PasscodeController.ReEnterPasscode.Placeholder"));case r.VS.Folders:return n.Ay.createElement("h3",null,v("Filters"));case r.VS.FoldersCreateFolder:return n.Ay.createElement("h3",null,v("FilterNew"));case r.VS.FoldersShare:return n.Ay.createElement("h3",null,v("FolderLinkScreen.Title"));case r.VS.FoldersEditFolder:case r.VS.FoldersEditFolderFromChatList:case r.VS.FoldersEditFolderInvites:return n.Ay.createElement("div",{className:"settings-main-header"},n.Ay.createElement("h3",null,v("FilterEdit")),Boolean(t)&&n.Ay.createElement(le.A,{className:"settings-more-menu",trigger:g,positionX:"right"},n.Ay.createElement(ce.A,{icon:"delete",destructive:!0,onClick:y},v("Delete"))));case r.VS.FoldersIncludedChats:case r.VS.FoldersIncludedChatsFromChatList:case r.VS.FoldersExcludedChats:case r.VS.FoldersExcludedChatsFromChatList:return n.Ay.createElement("h3",null,v(e===r.VS.FoldersIncludedChats||e===r.VS.FoldersIncludedChatsFromChatList?"FilterInclude":"FilterExclude"));default:return n.Ay.createElement("div",{className:"settings-main-header"},n.Ay.createElement("h3",{onClick:u},v("SETTINGS")),n.Ay.createElement(Y.A,{round:!0,ripple:!c,size:"smaller",color:"translucent",onClick:()=>l({screen:r.VS.EditProfile}),ariaLabel:v("lng_settings_information")},n.Ay.createElement(Q.A,{name:"edit"})),n.Ay.createElement(le.A,{className:"settings-more-menu",trigger:g,positionX:"right"},n.Ay.createElement(ce.A,{icon:"logout",onClick:A},v("LogOutTitle"))))}}(),n.Ay.createElement(ya.A,{isOpen:d,onClose:h,text:v("lng_sure_logout"),confirmLabel:v("AccountSettings.Logout"),confirmHandler:p,confirmIsDestructive:!0}))}),Ku=(0,n.ph)((0,s.EK)(e=>{const{canTranslate:t,canTranslateChats:a,doNotTranslate:n}=e.settings.byKey,{language:s,languages:r}=(0,hs.l)(e);return{isCurrentUserPremium:(0,c.g29)(e),languages:r,language:s,canTranslate:t,canTranslateChats:a,doNotTranslate:n}})(({isActive:e,isCurrentUserPremium:t,languages:a,language:i,canTranslate:o,canTranslateChats:l,doNotTranslate:c,onReset:d})=>{const{loadLanguages:m,setSettingOption:u,setSharedSettingOption:A,openPremiumModal:h,openSettingsScreen:y}=(0,s.ko)(),[p,g]=(0,n.J0)(i),[v,f,b]=(0,M.A)(),C=t&&l,S=(0,B.A)();(0,n.vJ)(()=>{a?.length||m()},[a]);const k=(0,x.A)(e=>{g(e),f(),(0,Pu.wT)(e,()=>{b(),A({language:e})})}),w=(0,n.Kr)(()=>{if(!a)return;const e=(window.navigator.language||"en").toLowerCase(),t=e.substr(0,2);return a.map(({langCode:e,nativeName:t,name:a})=>({value:e,label:t,subLabel:a,isLoading:e===p&&v})).sort(a=>!e||a.value!==e&&a.value!==t?0:-1)},[v,a,p]),N=(0,x.A)(e=>{u({canTranslate:e})}),I=(0,x.A)(e=>{u({canTranslateChats:e})}),P=(0,x.A)(()=>{t||h({initialSection:"translations"})}),T=(0,n.Kr)(()=>{if(E.CM&&c.length)return 1===c.length?new Intl.DisplayNames([i],{type:"language"}).of(c[0]):S("Languages",c.length)},[c,S,i]),L=(0,x.A)(()=>{y({screen:r.VS.DoNotTranslate})});return(0,Ee.A)({isActive:e,onBack:d}),n.Ay.createElement("div",{className:"settings-content settings-language custom-scroll"},E.CM&&n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement(as.A,{label:S("ShowTranslateButton"),checked:o,onCheck:N}),n.Ay.createElement(as.A,{label:S("ShowTranslateChatButton"),checked:C,disabled:!t,rightIcon:t?void 0:"lock",onClickLabel:P,onCheck:I}),(o||C)&&n.Ay.createElement(ca.A,{narrow:!0,onClick:L},S("DoNotTranslate"),n.Ay.createElement("span",{className:"settings-item__current-value"},T)),n.Ay.createElement("p",{className:"settings-item-description mb-0 mt-1"},S("lng_translate_settings_about"))),n.Ay.createElement("div",{className:"settings-item settings-item-picker"},n.Ay.createElement("h4",{className:"settings-item-header"},S("Localization.InterfaceLanguage")),w?n.Ay.createElement(Ci,{items:w,selectedValue:p,forceRenderAllItems:!0,onSelectedValueChange:k,itemInputType:"radio",className:"settings-picker"}):n.Ay.createElement(Dn.A,null)))}));var Gu=a(86046),ju=a(15591),zu=a(90254);const Hu=(0,n.ph)((0,s.EK)(e=>{const{currentUserId:t}=e,a=(0,c.hc)(e),n=e.stars?.balance,s=e.ton?.balance;return{sessionCount:e.activeSessions.orderedHashes.length,currentUserId:t,canBuyPremium:!(0,c.n_C)(e),isGiveawayAvailable:a,starsBalance:n,tonBalance:s}})(({isActive:e,currentUserId:t,sessionCount:a,canBuyPremium:o,isGiveawayAvailable:l,starsBalance:c,tonBalance:d,onReset:m})=>{const{loadMoreProfilePhotos:u,openPremiumModal:A,openSupportChat:h,openUrl:y,openGiftRecipientPicker:p,openStarsBalanceModal:g,openSettingsScreen:v}=(0,s.ko)(),[E,f,b]=(0,M.A)(!1),C=(0,Ua.A)();(0,n.vJ)(()=>{t&&u({peerId:t,isPreload:!0})},[t]),(0,Ee.A)({isActive:e,onBack:m});const S=(0,x.A)(()=>{h(),b()});return n.Ay.createElement("div",{className:"settings-content custom-scroll"},n.Ay.createElement("div",{className:"settings-main-menu self-profile"},t&&n.Ay.createElement(zu.A,{peerId:t,canPlayVideo:Boolean(e),forceShowSelf:!0}),t&&n.Ay.createElement(ju.A,{chatOrUserId:t,isInSettings:!0})),n.Ay.createElement("div",{className:"settings-main-menu"},n.Ay.createElement(ca.A,{icon:"settings",narrow:!0,onClick:()=>v({screen:r.VS.General})},C("TelegramGeneralSettingsViewController")),n.Ay.createElement(ca.A,{icon:"animations",narrow:!0,onClick:()=>v({screen:r.VS.Performance})},C("MenuAnimations")),n.Ay.createElement(ca.A,{icon:"unmute",narrow:!0,onClick:()=>v({screen:r.VS.Notifications})},C("Notifications")),n.Ay.createElement(ca.A,{icon:"data",narrow:!0,onClick:()=>v({screen:r.VS.DataStorage})},C("DataSettings")),n.Ay.createElement(ca.A,{icon:"lock",narrow:!0,onClick:()=>v({screen:r.VS.Privacy})},C("PrivacySettings")),n.Ay.createElement(ca.A,{icon:"folder",narrow:!0,onClick:()=>v({screen:r.VS.Folders})},C("Filters")),n.Ay.createElement(ca.A,{icon:"active-sessions",narrow:!0,onClick:()=>v({screen:r.VS.ActiveSessions})},C("SessionsTitle"),a>0&&n.Ay.createElement("span",{className:"settings-item__current-value"},a)),n.Ay.createElement(ca.A,{icon:"language",narrow:!0,onClick:()=>v({screen:r.VS.Language})},C("Language"),n.Ay.createElement("span",{className:"settings-item__current-value"},C.languageInfo.nativeName)),n.Ay.createElement(ca.A,{icon:"stickers",narrow:!0,onClick:()=>v({screen:r.VS.Stickers})},C("MenuStickers"))),n.Ay.createElement("div",{className:"settings-main-menu"},o&&n.Ay.createElement(ca.A,{leftElement:n.Ay.createElement(Qm.A,{className:"icon ListItem-main-icon",type:"premium",size:"big"}),narrow:!0,onClick:()=>A()},C("TelegramPremium")),n.Ay.createElement(ca.A,{leftElement:n.Ay.createElement(Qm.A,{className:"icon ListItem-main-icon",type:"gold",size:"big"}),narrow:!0,onClick:()=>g({})},C("MenuStars"),Boolean(c)&&n.Ay.createElement("span",{className:"settings-item__current-value"},(0,Gu.ZF)(C,c))),n.Ay.createElement(ca.A,{leftElement:n.Ay.createElement(Q.A,{className:"icon ListItem-main-icon",name:"toncoin"}),narrow:!0,onClick:()=>g({currency:i.ykW})},C("MenuTon"),Boolean(d)&&n.Ay.createElement("span",{className:"settings-item__current-value"},(0,mr.UL)(d.amount,d.currency))),l&&n.Ay.createElement(ca.A,{icon:"gift",narrow:!0,onClick:()=>p()},C("MenuSendGift"))),n.Ay.createElement("div",{className:"settings-main-menu"},n.Ay.createElement(ca.A,{icon:"ask-support",narrow:!0,onClick:f},C("AskAQuestion")),n.Ay.createElement(ca.A,{icon:"help",narrow:!0,onClick:()=>y({url:i.r9K})},C("MenuTelegramFaq")),n.Ay.createElement(ca.A,{icon:"privacy-policy",narrow:!0,onClick:()=>y({url:i.pkx})},C("MenuPrivacyPolicy"))),n.Ay.createElement(ya.A,{isOpen:E,confirmLabel:C("OK"),title:C("AskAQuestion"),textParts:C("MenuAskText",void 0,{withNodes:!0,renderTextFilters:["br"]}),confirmHandler:S,onClose:b}))}));var $u=a(5560),qu=a(56133);const Wu=(0,n.ph)((0,s.EK)(e=>({hasContactJoinedNotifications:Boolean(e.settings.byKey.hasContactJoinedNotifications),hasWebNotifications:e.settings.byKey.hasWebNotifications,hasPushNotifications:e.settings.byKey.hasPushNotifications,notificationSoundVolume:e.settings.byKey.notificationSoundVolume}))(({isActive:e,onReset:t,notifyDefaults:a,hasContactJoinedNotifications:r,hasPushNotifications:i,hasWebNotifications:o,notificationSoundVolume:l})=>{const{loadNotificationSettings:c,updateContactSignUpNotification:d,updateNotificationSettings:m,updateWebNotificationSettings:u}=(0,s.ko)();(0,n.vJ)(()=>{c()},[c]);const A=(0,qu.A)(500,!0),h=(0,$u.M2)(),y=h&&!(0,$u.Ac)(),p=(0,n.hb)((e,t,n)=>{const s=Boolean(a?.[t]?.mutedUntil),r=Boolean(a?.[t]?.shouldShowPreviews);m({peerType:t,isMuted:"mute"===n?!e.target.checked:s,shouldShowPreviews:"showPreviews"===n?e.target.checked:r})},[a]),g=(0,n.hb)(e=>{const t=e.target.checked;u({hasWebNotifications:t,...!t&&{hasPushNotifications:!1}})},[u]),v=(0,n.hb)(e=>{u({hasPushNotifications:e.target.checked})},[u]),E=(0,n.hb)(e=>{p(e,"users","mute")},[p]),f=(0,n.hb)(e=>{p(e,"users","showPreviews")},[p]),b=(0,n.hb)(e=>{p(e,"groups","mute")},[p]),C=(0,n.hb)(e=>{p(e,"groups","showPreviews")},[p]),S=(0,n.hb)(e=>{p(e,"channels","mute")},[p]),k=(0,n.hb)(e=>{p(e,"channels","showPreviews")},[p]),w=(0,n.hb)(e=>{d({isSilent:!e.target.checked})},[d]),N=(0,n.hb)(e=>{u({notificationSoundVolume:e}),A(()=>(0,$u.BA)(void 0,e))},[A,u]),I=(0,Ua.A)();return(0,Ee.A)({isActive:e,onBack:t}),n.Ay.createElement("div",{className:"settings-content custom-scroll"},n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:I.isRtl?"rtl":void 0},I("NotificationsWeb")),n.Ay.createElement(as.A,{label:I("NotificationsWeb"),subLabel:I(o?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled"),checked:o,disabled:!h,onChange:g}),n.Ay.createElement(as.A,{label:I("NotificationsOffline"),disabled:!o||!y,subLabel:I(y?i?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled":"SettingsOfflineNotificationUnsupported"),checked:i,onChange:v}),n.Ay.createElement("div",{className:"settings-item-slider"},n.Ay.createElement(Qe.A,{label:I("NotificationsSound"),min:0,max:10,disabled:!h,value:l,onChange:N}))),n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:I.isRtl?"rtl":void 0},I("AutodownloadPrivateChats")),n.Ay.createElement(as.A,{label:I("NotificationsForPrivateChats"),subLabel:I(a?.users?.mutedUntil?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled"),checked:Boolean(a?.users?.mutedUntil),onChange:E}),n.Ay.createElement(as.A,{label:I("MessagePreview"),disabled:!a?.users?.mutedUntil,subLabel:I(a?.users?.shouldShowPreviews?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled"),checked:Boolean(a?.users?.shouldShowPreviews),onChange:f})),n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:I.isRtl?"rtl":void 0},I("FilterGroups")),n.Ay.createElement(as.A,{label:I("NotificationsForGroups"),subLabel:I(a?.groups?.mutedUntil?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled"),checked:Boolean(a?.groups?.mutedUntil),onChange:b}),n.Ay.createElement(as.A,{label:I("MessagePreview"),disabled:!a?.groups?.mutedUntil,subLabel:I(a?.groups?.shouldShowPreviews?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled"),checked:Boolean(a?.groups?.shouldShowPreviews),onChange:C})),n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:I.isRtl?"rtl":void 0},I("FilterChannels")),n.Ay.createElement(as.A,{label:I("NotificationsForChannels"),subLabel:I(a?.channels?.mutedUntil?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled"),checked:Boolean(a?.channels?.mutedUntil),onChange:S}),n.Ay.createElement(as.A,{label:I("MessagePreview"),disabled:!a?.channels?.mutedUntil,subLabel:I(a?.channels?.shouldShowPreviews?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled"),checked:Boolean(a?.channels?.shouldShowPreviews),onChange:k})),n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:I.isRtl?"rtl":void 0},I("PhoneOther")),n.Ay.createElement(as.A,{label:I("ContactJoined"),checked:r,onChange:w})))}));var Qu=a(20714),Yu=a(22986);const Zu=["SettingsPerformanceSliderLow","SettingsPerformanceSliderMedium","SettingsPerformanceSliderHigh"],Xu=["SettingsPerformanceSliderLow","SettingsPerformanceSliderCustom","SettingsPerformanceSliderHigh"],eA=[["SettingsPerformanceInterfaceAnimations",[{key:"pageTransitions",label:"SettingsPerformancePageTransitions"},{key:"messageSendingAnimations",label:"SettingsPerformanceSending"},{key:"mediaViewerAnimations",label:"SettingsPerformanceMediaViewer"},{key:"messageComposerAnimations",label:"SettingsPerformanceComposer"},{key:"contextMenuAnimations",label:"SettingsPerformanceContextAnimation"},{key:"contextMenuBlur",label:"SettingsPerformanceContextBlur",disabled:!E.Fy},{key:"rightColumnAnimations",label:"SettingsPerformanceRightColumn"},{key:"snapEffect",label:"SettingsPerformanceThanos"}]],["SettingsPerformanceStickers",[{key:"animatedEmoji",label:"SettingsPerformanceAnimatedEmoji"},{key:"loopAnimatedStickers",label:"SettingsPerformanceLoopStickers"},{key:"reactionEffects",label:"SettingsPerformanceReactionEffects"},{key:"stickerEffects",label:"SettingsPerformanceStickerEffects"}]],["SettingsPerformanceMediaAutoplay",[{key:"autoplayGifs",label:"SettingsPerformanceAutoplayGif"},{key:"autoplayVideos",label:"SettingsPerformanceAutoplayVideo"}]]],tA=(0,n.ph)((0,s.EK)(e=>({performanceSettings:(0,c.Cw0)(e)}))(function({isActive:e,performanceSettings:t,onReset:a}){const{setSharedSettingOption:r,updatePerformanceSettings:o}=(0,s.ko)();(0,Ee.A)({isActive:e,onBack:a});const l=(0,Ua.A)(),[c,d]=(0,n.J0)({}),m=(0,n.Kr)(()=>eA.reduce((e,[,a],n)=>(e[n]=a.every(({key:e})=>t[e]),e),{}),[t]),u=(0,n.Kr)(()=>(0,Yu.T)(t,Qu.LH)?i.zP3:(0,Yu.T)(t,Qu.PI)?i.dnp:(0,Yu.T)(t,Qu.tS)?i.zHL:i.M8B,[t]),A=(0,n.Kr)(()=>(u===i.M8B?Xu:Zu).map(e=>l(e)),[u,l]),h=(0,n.hb)((e,t)=>{e.preventDefault();const a=Number(t);d(e=>({...e,[a]:!e[a]}))},[]),y=(0,n.hb)(e=>{const t=e===i.dnp?Qu.PI:e===i.zHL?Qu.tS:Qu.LH;r({animationLevel:e,wasAnimationLevelSetManually:!0}),o(t)},[]),p=(0,n.hb)(e=>{const{name:t,checked:a}=e.target,n=eA.find(([e])=>e===t);if(!n)return;const s=n[1].reduce((e,{key:t})=>(e[t]=a,e),{});o(s)},[]),g=(0,n.hb)(e=>{const{name:t,checked:a}=e.target;o({[t]:a})},[]);return n.Ay.createElement("div",{className:"settings-content custom-scroll"},n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:l.isRtl?"rtl":void 0},l("SettingsPerformanceSliderTitle")),n.Ay.createElement("p",{className:"settings-item-description",dir:l.isRtl?"rtl":void 0},l("SettingsPerformanceSliderSubtitle")),n.Ay.createElement(Qe.A,{options:A,value:u===i.M8B?i.zHL:u,onChange:y})),n.Ay.createElement("div",{className:"settings-item-simple settings-item__with-shifted-dropdown"},n.Ay.createElement("h3",{className:"settings-item-header",dir:"auto"},"Resource-Intensive Processes"),eA.map(([e,a],s)=>n.Ay.createElement("div",{key:e,className:"settings-dropdown-section"},n.Ay.createElement("div",{className:"ListItem with-checkbox"},n.Ay.createElement(as.A,{name:e,value:s.toString(),checked:m[s],label:l(e),rightIcon:c[s]?"up":"down",onChange:p,onClickLabel:h})),Boolean(c[s])&&n.Ay.createElement("div",{className:"DropdownList DropdownList--open"},a.map(({key:e,label:a,disabled:s})=>{if("snapEffect"!==e||E.bW)return n.Ay.createElement(as.A,{key:e,name:e,checked:t[e],label:l(a),disabled:s,onChange:g})}))))))})),aA=(0,n.ph)((0,s.EK)(e=>{const{settings:{byKey:{hasPassword:t,isSensitiveEnabled:a,canChangeSensitive:n,shouldArchiveAndMuteNewNonContact:s,shouldNewNonContactPeersRequirePremium:r,nonContactPeersPaidStars:i},privacy:o,accountDaysTtl:l},blocked:d,passcode:{hasPasscode:m},appConfig:u}=e,{canDisplayChatInTitle:A}=(0,hs.l)(e),h=Boolean(i),y=(0,c.trm)(e);return{isCurrentUserPremium:(0,c.g29)(e),hasPassword:t,hasPasscode:Boolean(m),blockedCount:d.totalCount,webAuthCount:e.activeWebSessions.orderedHashes.length,isSensitiveEnabled:a,canDisplayAutoarchiveSetting:Boolean(u?.canDisplayAutoarchiveSetting),shouldArchiveAndMuteNewNonContact:s,canChangeSensitive:n,shouldNewNonContactPeersRequirePremium:r,shouldChargeForMessages:h,needAgeVideoVerification:Boolean(u?.needAgeVideoVerification),privacy:o,canDisplayChatInTitle:A,canSetPasscode:(0,c.Ntz)(e),isCurrentUserFrozen:y,accountDaysTtl:l}})(({isActive:e,isCurrentUserPremium:t,hasPassword:a,hasPasscode:o,blockedCount:l,webAuthCount:c,isSensitiveEnabled:d,canChangeSensitive:m,canDisplayAutoarchiveSetting:u,shouldArchiveAndMuteNewNonContact:A,shouldNewNonContactPeersRequirePremium:h,shouldChargeForMessages:y,canDisplayChatInTitle:p,canSetPasscode:g,needAgeVideoVerification:v,privacy:E,onReset:f,isCurrentUserFrozen:b,accountDaysTtl:C})=>{const{openDeleteAccountModal:S,loadPrivacySettings:k,loadBlockedUsers:w,updateContentSettings:N,loadGlobalPrivacySettings:I,updateGlobalPrivacySettings:P,loadWebAuthorizations:M,setSharedSettingOption:T,openSettingsScreen:L,loadAccountDaysTtl:R,openAgeVerificationModal:F}=(0,s.ko)();(0,n.vJ)(()=>{b||(w(),k(),M())},[b]),(0,n.vJ)(()=>{e&&!b&&(I(),R())},[e,b,I]);const D=(0,B.A)(),V=(0,Ua.A)();(0,Ee.A)({isActive:e,onBack:f});const _=(0,n.hb)(e=>{P({shouldArchiveAndMuteNewNonContact:e})},[P]),U=(0,n.hb)(e=>{T({canDisplayChatInTitle:e})},[]),O=(0,n.hb)(e=>{N({isSensitiveEnabled:e})},[N]),J=(0,n.hb)(()=>{F()},[F]),K=(0,x.A)(()=>{C&&S({days:C})}),G=(0,n.Kr)(()=>{if(C)return Zo(i.WF4,C/30).toString()},[C]);function j(e){if(!e)return D("Loading");const{visibility:t,shouldAllowPremium:a,botsPrivacy:n}=e,s="everybody"===t,r="allow"===n&&!s,i=e.blockChatIds.length+e.blockUserIds.length,o=e.allowChatIds.length+e.allowUserIds.length,l=[];i&&l.push(`-${i}`),o&&!s&&l.push(`+${o}`);const c=[r?V("PrivacyValueBots"):"",V.conjunction(l)].filter(Boolean).join(" ");if(r&&!s)return c;if(a)return D(c?"ContactsAndPremium":"PrivacyPremium");switch(t){case"everybody":return`${D("P2PEverybody")} ${c}`;case"contacts":return`${D("P2PContacts")} ${c}`;case"nobody":return`${D("P2PNobody")} ${c}`}}return n.Ay.createElement("div",{className:"settings-content custom-scroll"},n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement(ca.A,{icon:"delete-user",narrow:!0,onClick:()=>L({screen:r.VS.PrivacyBlockedUsers})},D("BlockedUsers"),n.Ay.createElement("span",{className:"settings-item__current-value"},l||"")),g&&n.Ay.createElement(ca.A,{icon:"key",narrow:!0,onClick:()=>L({screen:o?r.VS.PasscodeEnabled:r.VS.PasscodeDisabled})},n.Ay.createElement("div",{className:"multiline-item"},n.Ay.createElement("span",{className:"title"},D("Passcode")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},D(o?"PasswordOn":"PasswordOff")))),n.Ay.createElement(ca.A,{icon:"lock",narrow:!0,onClick:()=>L({screen:a?r.VS.TwoFaEnabled:r.VS.TwoFaDisabled})},n.Ay.createElement("div",{className:"multiline-item"},n.Ay.createElement("span",{className:"title"},D("TwoStepVerification")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},D(a?"PasswordOn":"PasswordOff")))),c>0&&n.Ay.createElement(ca.A,{icon:"web",narrow:!0,onClick:()=>L({screen:r.VS.ActiveWebsites})},D("PrivacySettings.WebSessions"),n.Ay.createElement("span",{className:"settings-item__current-value"},c))),n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:D.isRtl?"rtl":void 0},D("PrivacyTitle")),n.Ay.createElement(ca.A,{narrow:!0,className:"no-icon",onClick:()=>L({screen:r.VS.PrivacyPhoneNumber})},n.Ay.createElement("div",{className:"multiline-item"},n.Ay.createElement("span",{className:"title"},D("PrivacyPhoneTitle")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},j(E.phoneNumber)))),n.Ay.createElement(ca.A,{narrow:!0,className:"no-icon",onClick:()=>L({screen:r.VS.PrivacyLastSeen})},n.Ay.createElement("div",{className:"multiline-item"},n.Ay.createElement("span",{className:"title"},D("LastSeenTitle")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},j(E.lastSeen)))),n.Ay.createElement(ca.A,{narrow:!0,className:"no-icon",onClick:()=>L({screen:r.VS.PrivacyProfilePhoto})},n.Ay.createElement("div",{className:"multiline-item"},n.Ay.createElement("span",{className:"title"},D("PrivacyProfilePhotoTitle")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},j(E.profilePhoto)))),n.Ay.createElement(ca.A,{narrow:!0,className:"no-icon",onClick:()=>L({screen:r.VS.PrivacyBio})},n.Ay.createElement("div",{className:"multiline-item"},n.Ay.createElement("span",{className:"title"},D("PrivacyBio")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},j(E.bio)))),n.Ay.createElement(ca.A,{narrow:!0,className:"no-icon",onClick:()=>L({screen:r.VS.PrivacyBirthday})},n.Ay.createElement("div",{className:"multiline-item"},n.Ay.createElement("span",{className:"title"},D("PrivacyBirthday")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},j(E.birthday)))),n.Ay.createElement(ca.A,{narrow:!0,className:"no-icon",onClick:()=>L({screen:r.VS.PrivacyGifts})},n.Ay.createElement("div",{className:"multiline-item"},n.Ay.createElement("span",{className:"title"},V("PrivacyGifts")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},j(E.gifts)))),n.Ay.createElement(ca.A,{narrow:!0,className:"no-icon",onClick:()=>L({screen:r.VS.PrivacyForwarding})},n.Ay.createElement("div",{className:"multiline-item"},n.Ay.createElement("span",{className:"title"},D("PrivacyForwardsTitle")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},j(E.forwards)))),n.Ay.createElement(ca.A,{narrow:!0,className:"no-icon",onClick:()=>L({screen:r.VS.PrivacyPhoneCall})},n.Ay.createElement("div",{className:"multiline-item"},n.Ay.createElement("span",{className:"title"},D("WhoCanCallMe")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},j(E.phoneCall)))),n.Ay.createElement(ca.A,{narrow:!0,allowDisabledClick:!0,rightElement:t&&n.Ay.createElement(Qm.A,{size:"big",type:"premium"}),className:"no-icon",onClick:()=>L({screen:r.VS.PrivacyVoiceMessages})},n.Ay.createElement("div",{className:"multiline-item"},n.Ay.createElement("span",{className:"title"},D("PrivacyVoiceMessagesTitle")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},j(E.voiceMessages)))),n.Ay.createElement(ca.A,{narrow:!0,rightElement:t&&n.Ay.createElement(Qm.A,{size:"big",type:"premium"}),className:"no-icon",onClick:()=>L({screen:r.VS.PrivacyMessages})},n.Ay.createElement("div",{className:"multiline-item"},n.Ay.createElement("span",{className:"title"},D("PrivacyMessagesTitle")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},y?V("PrivacyPaidMessagesValue"):D(h?"PrivacyMessagesContactsAndPremium":"P2PEverybody")))),n.Ay.createElement(ca.A,{narrow:!0,className:"no-icon",onClick:()=>L({screen:r.VS.PrivacyGroupChats})},n.Ay.createElement("div",{className:"multiline-item"},n.Ay.createElement("span",{className:"title"},D("WhoCanAddMe")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},j(E.chatInvite))))),m&&n.Ay.createElement("div",{className:"settings-item fluid-container"},n.Ay.createElement("h4",{className:"settings-item-header",dir:D.isRtl?"rtl":void 0},D("lng_settings_sensitive_title")),n.Ay.createElement(as.A,{label:D("lng_settings_sensitive_disable_filtering"),subLabel:D("lng_settings_sensitive_about"),checked:Boolean(d),disabled:!m||!d&&v,onCheck:O}),!d&&v&&n.Ay.createElement(Y.A,{color:"primary",fluid:!0,size:"smaller",noForcedUpperCase:!0,className:"settings-unlock-button",onClick:J},n.Ay.createElement("span",{className:"settings-unlock-button-title"},V("ButtonAgeVerification")))),u&&n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:D.isRtl?"rtl":void 0},D("NewChatsFromNonContacts")),n.Ay.createElement(as.A,{label:D("ArchiveAndMute"),subLabel:D("ArchiveAndMuteInfo"),checked:Boolean(A),onCheck:_})),n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:D.isRtl?"rtl":void 0},D("lng_settings_window_system")),n.Ay.createElement(as.A,{label:D("lng_settings_title_chat_name"),checked:Boolean(p),onCheck:U})),n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:D.isRtl?"rtl":void 0},V("DeleteMyAccount")),n.Ay.createElement(ca.A,{narrow:!0,onClick:K},V("DeleteAccountIfAwayFor"),n.Ay.createElement("span",{className:"settings-item__current-value"},V("Months",{count:G},{pluralValue:1})))))})),nA=(0,n.ph)((0,s.EK)(e=>{const{users:{byId:t},blocked:{ids:a},contactList:n,currentUserId:s}=e;return{usersById:t,blockedIds:a,contactIds:n?.userIds,localContactIds:(0,c.nTw)(e).userSearch.localUserIds,currentUserId:s}})(({usersById:e,blockedIds:t,contactIds:a,localContactIds:r,currentUserId:i,isOpen:o,onClose:c})=>{const{setUserSearchQuery:d,blockUser:m}=(0,s.ko)(),u=(0,B.A)(),[A,h]=(0,n.J0)("");(0,n.vJ)(()=>{d({query:A})},[A,d]);const y=(0,n.Kr)(()=>{const n=(0,Ea.Am)([...a||[],...r||[]].filter(e=>e!==i&&!t.includes(e)));return(0,Mt.PU)({ids:n,query:A,type:"user"}).sort((t,a)=>{const n=(0,l.Yg)(e[t])||"",s=(0,l.Yg)(e[a])||"";return n.localeCompare(s)})},[t,a,i,A,r,e]),p=(0,n.hb)(e=>{m({userId:e}),c()},[c]);return n.Ay.createElement(Kn,{isOpen:o,chatOrUserIds:y,searchPlaceholder:u("BlockedUsers.BlockUser"),search:A,onSearchChange:h,onSelectChatOrUser:p,onClose:c})})),sA=(0,n.ph)((0,s.EK)(e=>{const{chats:{byId:t},users:{byId:a},blocked:{ids:n},countryList:{phoneCodes:s}}=e;return{chatsByIds:t,usersByIds:a,blockedIds:n,phoneCodeList:s}})(({isActive:e,onReset:t,chatsByIds:a,usersByIds:r,blockedIds:o,phoneCodeList:c})=>{const{unblockUser:d}=(0,s.ko)(),m=(0,B.A)(),[u,h,y]=(0,M.A)(),p=(0,n.hb)(e=>{d({userId:e})},[d]);(0,Ee.A)({isActive:e,onBack:t});const g=(0,n.Kr)(()=>o.reduce((e,t)=>{const a=(0,A.L8)(t)?r[t]:void 0,n=a&&!a.phoneNumber&&(0,l.Kl)(a);return n&&(e[t]=n),e},{}),[o,r]);return n.Ay.createElement("div",{className:"settings-fab-wrapper"},n.Ay.createElement("div",{className:"settings-content infinite-scroll"},n.Ay.createElement("div",{className:"settings-item no-border"},n.Ay.createElement("p",{className:"settings-item-description-larger mt-0 mb-2",dir:m.isRtl?"rtl":void 0},m("BlockedUsersInfo"))),n.Ay.createElement("div",{className:"chat-list custom-scroll"},o?.length?n.Ay.createElement("div",{className:"scroll-container settings-item"},o.map((e,t)=>function(e,t){const s=(0,A.L8)(e),o=r[e],l=a[e],d=o||l,m=(0,ue.A)("Chat chat-item-clickable blocked-list-item small-icon",s?"private":"group"),u=g[e];return n.Ay.createElement(ca.A,{key:`blocked_${e}`,className:m,ripple:!0,narrow:!0,contextActions:[{title:"Unblock",icon:"unlock",handler:()=>{p(e)}}],style:`top: ${(0+t)*i.yq1}px;`},n.Ay.createElement(xt.A,{size:"medium",peer:d}),n.Ay.createElement("div",{className:"contact-info",dir:"auto"},d&&n.Ay.createElement(Vn.A,{peer:d}),o?.phoneNumber&&n.Ay.createElement("div",{className:"contact-phone",dir:"auto"},(0,ms.Ox)(c,o.phoneNumber)),u&&n.Ay.createElement("div",{className:"contact-username",dir:"auto"},"@",u),u&&n.Ay.createElement("div",{className:"contact-username",dir:"auto"},"@",u)))}(e,t))):o&&!o.length?n.Ay.createElement("div",{className:"no-results",dir:"auto"},m("NoBlocked")):n.Ay.createElement(Dn.A,{key:"loading"}))),n.Ay.createElement(ka.A,{isShown:!0,className:"block-user-button",onClick:h,ariaLabel:m("BlockContact")},n.Ay.createElement(Q.A,{name:"add"})),n.Ay.createElement(nA,{isOpen:u,onClose:y}))}));function rA(e){switch(e){case r.VS.PrivacyPhoneNumber:case r.VS.PrivacyPhoneNumberAllowedContacts:case r.VS.PrivacyPhoneNumberDeniedContacts:return"phoneNumber";case r.VS.PrivacyLastSeen:case r.VS.PrivacyLastSeenAllowedContacts:case r.VS.PrivacyLastSeenDeniedContacts:return"lastSeen";case r.VS.PrivacyProfilePhoto:case r.VS.PrivacyProfilePhotoAllowedContacts:case r.VS.PrivacyProfilePhotoDeniedContacts:return"profilePhoto";case r.VS.PrivacyBio:case r.VS.PrivacyBioAllowedContacts:case r.VS.PrivacyBioDeniedContacts:return"bio";case r.VS.PrivacyBirthday:case r.VS.PrivacyBirthdayAllowedContacts:case r.VS.PrivacyBirthdayDeniedContacts:return"birthday";case r.VS.PrivacyGifts:case r.VS.PrivacyGiftsAllowedContacts:case r.VS.PrivacyGiftsDeniedContacts:return"gifts";case r.VS.PrivacyForwarding:case r.VS.PrivacyForwardingAllowedContacts:case r.VS.PrivacyForwardingDeniedContacts:return"forwards";case r.VS.PrivacyVoiceMessages:case r.VS.PrivacyVoiceMessagesAllowedContacts:case r.VS.PrivacyVoiceMessagesDeniedContacts:return"voiceMessages";case r.VS.PrivacyGroupChats:case r.VS.PrivacyGroupChatsAllowedContacts:case r.VS.PrivacyGroupChatsDeniedContacts:return"chatInvite";case r.VS.PrivacyPhoneCall:case r.VS.PrivacyPhoneCallAllowedContacts:case r.VS.PrivacyPhoneCallDeniedContacts:return"phoneCall";case r.VS.PrivacyPhoneP2P:case r.VS.PrivacyPhoneP2PAllowedContacts:case r.VS.PrivacyPhoneP2PDeniedContacts:return"phoneP2P";case r.VS.PrivacyAddByPhone:return"addByPhone";case r.VS.PrivacyNoPaidMessages:return"noPaidMessages"}}const iA=(0,n.ph)((0,s.EK)(e=>{const{settings:{byKey:{disallowedGifts:t}}}=e;return{disallowedGifts:t,isCurrentUserPremium:(0,c.g29)(e)}})(({disallowedGifts:e,isCurrentUserPremium:t})=>{const{showNotification:a,updateGlobalPrivacySettings:r}=(0,s.ko)(),i=(0,Ua.A)(),o=(0,x.A)(()=>{a({message:i("PrivacySubscribeToTelegramPremium"),action:{action:"openPremiumModal",payload:{}},actionText:{key:"Open"},icon:"star"})}),l=(0,x.A)(()=>{t?r({disallowedGifts:{...e,shouldDisallowLimitedStarGifts:!e?.shouldDisallowLimitedStarGifts||void 0}}):o()}),c=(0,x.A)(()=>{t?r({disallowedGifts:{...e,shouldDisallowUnlimitedStarGifts:!e?.shouldDisallowUnlimitedStarGifts||void 0}}):o()}),d=(0,x.A)(()=>{t?r({disallowedGifts:{...e,shouldDisallowUniqueStarGifts:!e?.shouldDisallowUniqueStarGifts||void 0}}):o()}),m=(0,x.A)(()=>{t?r({disallowedGifts:{...e,shouldDisallowPremiumGifts:!e?.shouldDisallowPremiumGifts||void 0}}):o()});return n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:i.isRtl?"rtl":void 0},i("PrivacyAcceptedGiftTitle")),n.Ay.createElement(ca.A,{onClick:l},n.Ay.createElement("span",null,i("PrivacyGiftLimitedEdition")),n.Ay.createElement(va.A,{id:"limited_edition",label:i(e?.shouldDisallowLimitedStarGifts?"PrivacyDisableLimitedEditionStarGifts":"PrivacyEnableLimitedEditionStarGifts"),disabled:!t,checked:!t||!e?.shouldDisallowLimitedStarGifts})),n.Ay.createElement(ca.A,{onClick:c},n.Ay.createElement("span",null,i("PrivacyGiftUnlimited")),n.Ay.createElement(va.A,{id:"unlimited",label:i(e?.shouldDisallowUnlimitedStarGifts?"PrivacyDisableUnlimitedStarGifts":"PrivacyEnableUnlimitedStarGifts"),disabled:!t,checked:!t||!e?.shouldDisallowUnlimitedStarGifts})),n.Ay.createElement(ca.A,{onClick:d},n.Ay.createElement("span",null,i("PrivacyGiftUnique")),n.Ay.createElement(va.A,{id:"unique",label:i(e?.shouldDisallowUniqueStarGifts?"PrivacyDisableUniqueStarGifts":"PrivacyEnableUniqueStarGifts"),disabled:!t,checked:!t||!e?.shouldDisallowUniqueStarGifts})),n.Ay.createElement(ca.A,{onClick:m},n.Ay.createElement("span",null,i("PrivacyGiftPremiumSubscription")),n.Ay.createElement(va.A,{id:"premium_subscription",label:i(e?.shouldDisallowPremiumGifts?"PrivacyDisablePremiumGifts":"PrivacyEnablePremiumGifts"),disabled:!t,checked:!t||!e?.shouldDisallowPremiumGifts})),n.Ay.createElement("p",{className:"settings-item-description-larger",dir:i.isRtl?"rtl":void 0},i("PrivacyAcceptedGiftInfo")))})),oA=(0,n.ph)((0,s.EK)(e=>({isCurrentUserPremium:(0,c.g29)(e),shouldHideReadMarks:Boolean((0,c.KIM)(e))}))(({isCurrentUserPremium:e,shouldHideReadMarks:t,visibility:a})=>{const{updateGlobalPrivacySettings:r,openPremiumModal:i}=(0,s.ko)(),o=(0,B.A)(),l="nobody"===a||"contacts"===a,c=(0,x.A)(e=>r({shouldHideReadMarks:e})),d=(0,x.A)(()=>{i({initialSection:"last_seen"})});return n.Ay.createElement(n.Ay.Fragment,null,l&&n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement(as.A,{label:o("HideReadTime"),checked:t,onCheck:c}),n.Ay.createElement("p",{className:"settings-item-description-larger",dir:o.isRtl?"rtl":void 0},(0,Tt.A)(o("HideReadTimeInfo"),["br"]))),n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement(ca.A,{leftElement:n.Ay.createElement(Qm.A,{className:"icon ListItem-main-icon",type:"premium",size:"big"}),onClick:d},o(e?"PrivacyLastSeenPremiumForPremium":"PrivacyLastSeenPremium")),n.Ay.createElement("p",{className:"settings-item-description-larger premium-info",dir:o.isRtl?"rtl":void 0},o(e?"PrivacyLastSeenPremiumInfoForPremium":"PrivacyLastSeenPremiumInfo"))))}));var lA=a(91356);const cA=(0,n.ph)(({currentUserId:e,hasCurrentUserFullInfo:t,currentUserFallbackPhoto:a})=>{const{loadFullUser:r,uploadProfilePhoto:i,deleteProfilePhoto:o,showNotification:l}=(0,s.ko)(),c=(0,B.A)(),[d,m,u]=(0,M.A)(!1),A=(0,n.li)();(0,n.vJ)(()=>{t||r({userId:e})},[t,e,r]);const h=(0,n.hb)(e=>{i({file:e,isFallback:!0}),l({message:c("Privacy.ProfilePhoto.PublicPhotoSuccess")})},[c,l,i]),y=(0,n.hb)(()=>{u(),o({photo:a})},[u,o,a]),p=(0,n.hb)(()=>{A.current?.click()},[]);return n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement(ca.A,{narrow:!0,icon:"camera-add",onClick:p},n.Ay.createElement(lA.A,{onChange:h,inputRef:A}),c(a?"Privacy.ProfilePhoto.UpdatePublicPhoto":"Privacy.ProfilePhoto.SetPublicPhoto")),a&&n.Ay.createElement(ca.A,{narrow:!0,leftElement:n.Ay.createElement(xt.A,{photo:a,size:"mini",className:"Qvhl9Jjv"}),onClick:m,destructive:!0},c(a.isVideo?"Privacy.ProfilePhoto.RemovePublicVideo":"Privacy.ProfilePhoto.RemovePublicPhoto"),n.Ay.createElement(ya.A,{isOpen:d,onClose:u,text:c("Privacy.ResetPhoto.Confirm"),confirmLabel:c("Delete"),confirmHandler:y,confirmIsDestructive:!0})),n.Ay.createElement("p",{className:"settings-item-description-larger",dir:c.isRtl?"rtl":void 0},c("Privacy.ProfilePhoto.PublicPhotoInfo")))});function dA({screen:e,privacy:t,isPremiumRequired:a}){const{setPrivacyVisibility:i,openSettingsScreen:o}=(0,s.ko)(),l=(0,B.A)(),c=(0,Ua.A)(),d=(0,n.Kr)(()=>{const t=e!==r.VS.PrivacyAddByPhone,s=[{value:"everybody",label:l("P2PEverybody")},{value:"contacts",label:a?n.Ay.createElement(Zm,{label:l("P2PContacts")}):l("P2PContacts"),hidden:a}];return t&&s.push({value:"nobody",label:a?n.Ay.createElement(Zm,{label:l("P2PNobody")}):l("P2PNobody"),hidden:a}),s},[l,e,a]),m=(0,n.Kr)(()=>e===r.VS.PrivacyAddByPhone?{shouldShowDenied:!1,shouldShowAllowed:!1}:{shouldShowDenied:"nobody"!==t?.visibility,shouldShowAllowed:"everybody"!==t?.visibility},[t,e]),u=rA(e),A=(0,n.Kr)(()=>{switch(e){case r.VS.PrivacyGifts:return c("PrivacyGiftsInfo");case r.VS.PrivacyLastSeen:return l("CustomHelp");case r.VS.PrivacyAddByPhone:return l("everybody"===t?.visibility?"PrivacyPhoneInfo":"PrivacyPhoneInfo3");case r.VS.PrivacyVoiceMessages:return l("PrivacyVoiceMessagesInfo");default:return}},[l,c,e,t]),h=(0,n.Kr)(()=>{switch(e){case r.VS.PrivacyPhoneNumber:return l("PrivacyPhoneTitle");case r.VS.PrivacyAddByPhone:return l("PrivacyPhoneTitle2");case r.VS.PrivacyLastSeen:return l("LastSeenTitle");case r.VS.PrivacyProfilePhoto:return l("PrivacyProfilePhotoTitle");case r.VS.PrivacyBio:return l("PrivacyBioTitle");case r.VS.PrivacyBirthday:return l("PrivacyBirthdayTitle");case r.VS.PrivacyGifts:return c("PrivacyGiftsTitle");case r.VS.PrivacyForwarding:return l("PrivacyForwardsTitle");case r.VS.PrivacyVoiceMessages:return l("PrivacyVoiceMessagesTitle");case r.VS.PrivacyGroupChats:return l("WhoCanAddMe");case r.VS.PrivacyPhoneCall:return l("WhoCanCallMe");case r.VS.PrivacyPhoneP2P:return l("PrivacyP2P");default:return}},[l,c,e]),y=(0,x.A)((e,t,a,n)=>{const s=e?.length||0,r=t?.length||0,i="allow"===n;if(!s&&!r&&!i)return l(a?"PrivacyPremium":"EditAdminAddUsers");if(a)return l("ContactsAndPremium");const o=s>0?l("Users",s):void 0,d=r>0?l("Chats",r):void 0;return[i?c("PrivacyValueBots"):"",c.conjunction([o,d].filter(Boolean))].filter(Boolean).join(" ")}),p=(0,n.Kr)(()=>y(t?.allowUserIds,t?.allowChatIds,t?.shouldAllowPremium,t?.botsPrivacy),[t]),g=(0,n.Kr)(()=>y(t?.blockUserIds,t?.blockChatIds),[t]),v=(0,n.hb)(e=>{i({privacyKey:u,visibility:e})},[u]),E=(()=>{switch(e){case r.VS.PrivacyPhoneNumber:return r.VS.PrivacyPhoneNumberAllowedContacts;case r.VS.PrivacyLastSeen:return r.VS.PrivacyLastSeenAllowedContacts;case r.VS.PrivacyProfilePhoto:return r.VS.PrivacyProfilePhotoAllowedContacts;case r.VS.PrivacyBio:return r.VS.PrivacyBioAllowedContacts;case r.VS.PrivacyBirthday:return r.VS.PrivacyBirthdayAllowedContacts;case r.VS.PrivacyGifts:return r.VS.PrivacyGiftsAllowedContacts;case r.VS.PrivacyForwarding:return r.VS.PrivacyForwardingAllowedContacts;case r.VS.PrivacyPhoneCall:return r.VS.PrivacyPhoneCallAllowedContacts;case r.VS.PrivacyPhoneP2P:return r.VS.PrivacyPhoneP2PAllowedContacts;case r.VS.PrivacyVoiceMessages:return r.VS.PrivacyVoiceMessagesAllowedContacts;default:return r.VS.PrivacyGroupChatsAllowedContacts}})(),f=(()=>{switch(e){case r.VS.PrivacyPhoneNumber:return r.VS.PrivacyPhoneNumberDeniedContacts;case r.VS.PrivacyLastSeen:return r.VS.PrivacyLastSeenDeniedContacts;case r.VS.PrivacyProfilePhoto:return r.VS.PrivacyProfilePhotoDeniedContacts;case r.VS.PrivacyBio:return r.VS.PrivacyBioDeniedContacts;case r.VS.PrivacyBirthday:return r.VS.PrivacyBirthdayDeniedContacts;case r.VS.PrivacyGifts:return r.VS.PrivacyGiftsDeniedContacts;case r.VS.PrivacyForwarding:return r.VS.PrivacyForwardingDeniedContacts;case r.VS.PrivacyPhoneCall:return r.VS.PrivacyPhoneCallDeniedContacts;case r.VS.PrivacyPhoneP2P:return r.VS.PrivacyPhoneP2PDeniedContacts;case r.VS.PrivacyVoiceMessages:return r.VS.PrivacyVoiceMessagesDeniedContacts;default:return r.VS.PrivacyGroupChatsDeniedContacts}})();return n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:l.isRtl?"rtl":void 0},h),n.Ay.createElement(ee.A,{name:`visibility-${u}`,options:d,onChange:v,selected:t?.visibility}),A&&n.Ay.createElement("p",{className:"settings-item-description-larger",dir:l.isRtl?"rtl":void 0},A)),!a&&(m.shouldShowAllowed||m.shouldShowDenied)&&n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:l.isRtl?"rtl":void 0},l("PrivacyExceptions")),m.shouldShowAllowed&&n.Ay.createElement(ca.A,{narrow:!0,icon:"add-user",onClick:()=>{o({screen:E})}},n.Ay.createElement("div",{className:"multiline-item full-size"},n.Ay.createElement("span",{className:"title"},l("AlwaysAllow")),n.Ay.createElement("span",{className:"subtitle"},p))),m.shouldShowDenied&&n.Ay.createElement(ca.A,{narrow:!0,icon:"delete-user",onClick:()=>{o({screen:f})}},n.Ay.createElement("div",{className:"multiline-item full-size"},n.Ay.createElement("span",{className:"title"},l("NeverAllow")),n.Ay.createElement("span",{className:"subtitle"},g)))),a&&n.Ay.createElement(Ym,null))}const mA=(0,n.ph)((0,s.EK)((e,{screen:t})=>{let a,n;const{currentUserId:s,settings:{privacy:i,byKey:{shouldDisplayGiftsButton:o}}}=e,l=(0,c.vGo)(e,s);switch(t){case r.VS.PrivacyPhoneNumber:a=i.phoneNumber,n=i.addByPhone;break;case r.VS.PrivacyLastSeen:a=i.lastSeen;break;case r.VS.PrivacyProfilePhoto:a=i.profilePhoto;break;case r.VS.PrivacyBio:a=i.bio;break;case r.VS.PrivacyBirthday:a=i.birthday;break;case r.VS.PrivacyGifts:a=i.gifts;break;case r.VS.PrivacyPhoneP2P:case r.VS.PrivacyPhoneCall:a=i.phoneCall,n=i.phoneP2P;break;case r.VS.PrivacyForwarding:a=i.forwards;break;case r.VS.PrivacyVoiceMessages:a=i.voiceMessages;break;case r.VS.PrivacyGroupChats:a=i.chatInvite}return a?{primaryPrivacy:a,secondaryPrivacy:n,currentUserId:s,hasCurrentUserFullInfo:Boolean(l),currentUserFallbackPhoto:l?.fallbackPhoto,isPremiumRequired:t===r.VS.PrivacyVoiceMessages&&!(0,c.g29)(e),shouldDisplayGiftsButton:o,isCurrentUserPremium:(0,c.g29)(e)}:{currentUserId:s,hasCurrentUserFullInfo:Boolean(l),currentUserFallbackPhoto:l?.fallbackPhoto}})(({screen:e,isActive:t,primaryPrivacy:a,secondaryPrivacy:i,currentUserId:o,hasCurrentUserFullInfo:l,currentUserFallbackPhoto:c,isPremiumRequired:d,onReset:m,shouldDisplayGiftsButton:u,isCurrentUserPremium:A})=>{const{updateGlobalPrivacySettings:h,showNotification:y}=(0,s.ko)(),p=(0,Ua.A)();(0,Ee.A)({isActive:t,onBack:m});const g=(0,x.A)(()=>{A?h({shouldDisplayGiftsButton:!u}):y({message:p("PrivacySubscribeToTelegramPremium"),action:{action:"openPremiumModal",payload:{}},actionText:{key:"Open"},icon:"star"})}),v=(0,n.Kr)(()=>{switch(e){case r.VS.PrivacyPhoneCall:return r.VS.PrivacyPhoneP2P;case r.VS.PrivacyPhoneNumber:return"nobody"===a?.visibility?r.VS.PrivacyAddByPhone:void 0;default:return}},[a,e]);return n.Ay.createElement("div",{className:"settings-content custom-scroll"},e===r.VS.PrivacyGifts&&n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement(ca.A,{onClick:g},n.Ay.createElement("span",null,p("PrivacyDisplayGiftsButton")),n.Ay.createElement(va.A,{id:"gift",disabled:!A,label:p(u?"HideGiftsButton":"DisplayGiftsButton"),checked:u})),n.Ay.createElement("p",{className:"settings-item-description-larger",dir:p.isRtl?"rtl":void 0},p("PrivacyDisplayGiftIconInChats",{icon:n.Ay.createElement(Q.A,{name:"gift",className:"gift-icon"}),gift:p("PrivacyDisplayGift")},{withNodes:!0}))),n.Ay.createElement(dA,{screen:e,privacy:a,isPremiumRequired:d}),e===r.VS.PrivacyProfilePhoto&&"everybody"!==a?.visibility&&n.Ay.createElement(cA,{currentUserId:o,hasCurrentUserFullInfo:l,currentUserFallbackPhoto:c}),e===r.VS.PrivacyLastSeen&&n.Ay.createElement(oA,{visibility:a?.visibility}),e===r.VS.PrivacyGifts&&n.Ay.createElement(iA,null),Boolean(v)&&n.Ay.createElement(dA,{screen:v,privacy:i}))})),uA=[km.lw];function AA(e,t){const{privacy:a}=e.settings;switch(t){case r.VS.PrivacyPhoneNumberAllowedContacts:case r.VS.PrivacyPhoneNumberDeniedContacts:return a.phoneNumber;case r.VS.PrivacyLastSeenAllowedContacts:case r.VS.PrivacyLastSeenDeniedContacts:return a.lastSeen;case r.VS.PrivacyProfilePhotoAllowedContacts:case r.VS.PrivacyProfilePhotoDeniedContacts:return a.profilePhoto;case r.VS.PrivacyBioAllowedContacts:case r.VS.PrivacyBioDeniedContacts:return a.bio;case r.VS.PrivacyBirthdayAllowedContacts:case r.VS.PrivacyBirthdayDeniedContacts:return a.birthday;case r.VS.PrivacyGiftsAllowedContacts:case r.VS.PrivacyGiftsDeniedContacts:return a.gifts;case r.VS.PrivacyPhoneCallAllowedContacts:case r.VS.PrivacyPhoneCallDeniedContacts:return a.phoneCall;case r.VS.PrivacyPhoneP2PAllowedContacts:case r.VS.PrivacyPhoneP2PDeniedContacts:return a.phoneP2P;case r.VS.PrivacyForwardingAllowedContacts:case r.VS.PrivacyForwardingDeniedContacts:return a.forwards;case r.VS.PrivacyVoiceMessagesAllowedContacts:case r.VS.PrivacyVoiceMessagesDeniedContacts:return a.voiceMessages;case r.VS.PrivacyGroupChatsDeniedContacts:case r.VS.PrivacyGroupChatsAllowedContacts:return a.chatInvite;case r.VS.PrivacyNoPaidMessages:return a.noPaidMessages}}const hA=(0,n.ph)((0,s.EK)((e,{screen:t})=>({currentUserId:e.currentUserId,settings:AA(e,t)}))(({isAllowList:e,withPremiumCategory:t,withMiniAppsCategory:a,screen:r,isActive:o,currentUserId:c,settings:d,usersOnly:m=!1,onReset:u})=>{const{setPrivacySettings:A}=(0,s.ko)(),h=(0,B.A)(),y=(0,Ua.A)(),p=(0,n.Kr)(()=>({isCustomPeer:!0,type:"bots",title:y("PrivacyValueBots"),avatarIcon:"bots",isAvatarSquare:!0,peerColorId:6}),[y]),g=(0,n.Kr)(()=>[p],[p]),v=(0,n.Kr)(()=>d?e?[...d.allowUserIds,...d.allowChatIds]:[...d.blockUserIds,...d.blockChatIds]:[],[e,d]),E=(0,n.Kr)(()=>d?d.shouldAllowPremium?[km.lw.type]:"allow"===d.botsPrivacy&&e?[p.type]:[]:[],[d,e,p]),[f,b]=(0,n.J0)(""),[C,S]=(0,n.J0)(!1),[k,w]=(0,n.J0)(v),[N,I]=(0,n.J0)(E);(0,n.vJ)(()=>{o||(w(v),I(E))},[o,E,v]);const P=(0,wm.Rh)(i.DSF),M=(0,wm.Rh)(i._E9),T=(0,n.Kr)(()=>{const e=(0,s.mS)().chats.byId,t=(0,s.mS)().users.byId,a=(0,Ea.Am)([...P||[],...M||[]]).filter(a=>{const n=e[a],s=t[a],r=s&&(0,l.PL)(s),o=n&&(0,l.WX)(n);return(!m||s)&&a!==c&&a!==i.zv8&&!o&&!r}),n=(0,Mt.PU)({ids:a,query:f});return f?n:(0,Ea.Am)([...v,...a])},[P,M,v,f,c,m]),x=(0,n.hb)(e=>{I(e),S(!0)},[]),L=(0,n.hb)(e=>{w(e),S(!0)},[]),R=(0,n.hb)(()=>{A({privacyKey:rA(r),isAllowList:Boolean(e),updatedIds:k,isPremiumAllowed:N.includes(km.lw.type)||void 0,botsPrivacy:a?N.includes(p.type)?"allow":"disallow":"none"}),u()},[e,a,N,k,u,r,p]);return(0,Ee.A)({isActive:o,onBack:u}),n.Ay.createElement("div",{className:"NewChat-inner step-1"},n.Ay.createElement(ba.A,{categories:t?uA:a&&e?g:void 0,itemIds:T||[],selectedIds:k,selectedCategories:N,filterValue:f,filterPlaceholder:h(e?"AlwaysAllowPlaceholder":"NeverAllowPlaceholder"),categoryPlaceholderKey:"PrivacyUserTypes",searchInputId:"new-group-picker-search",isSearchable:!0,onSelectedIdsChange:L,onSelectedCategoriesChange:x,onFilterChange:b,allowMultiple:!0,itemInputType:"checkbox",withDefaultPadding:!0,withStatus:!0}),n.Ay.createElement(ka.A,{isShown:C,onClick:R,ariaLabel:h(e?"AlwaysAllow":"NeverAllow")},n.Ay.createElement(Q.A,{name:"check"})))})),yA=(0,n.ph)((0,s.EK)(e=>{const{config:t,reactions:a}=e;return{availableReactions:a.availableReactions,selectedReaction:t?.defaultReaction}})(({isActive:e,availableReactions:t,selectedReaction:a,onReset:r})=>{const{setDefaultReaction:i}=(0,s.ko)();(0,Ee.A)({isActive:e,onBack:r});const o=(0,n.Kr)(()=>(t||[]).filter(e=>!e.isInactive).map(e=>({label:n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(wn.A,{reaction:e.reaction,availableReactions:t}),e.title),value:e.reaction.emoticon})),[t]),l=(0,n.hb)(e=>{i({reaction:{type:"emoji",emoticon:e}})},[i]);return n.Ay.createElement("div",{className:"settings-content settings-item custom-scroll settings-quick-reaction"},n.Ay.createElement(ee.A,{name:"quick-reaction-settings",options:o,selected:a,onChange:l,withIcon:!0}))})),pA=1.5*h.$,gA=(0,n.ph)((0,s.EK)(e=>({...(0,Ea.Up)(e.settings.byKey,["shouldSuggestStickers","shouldUpdateStickerSetOrder"]),addedSetIds:e.stickers.added.setIds,customEmojiSetIds:e.customEmojis.added.setIds,stickerSetsById:e.stickers.setsById,defaultReaction:e.config?.defaultReaction,availableReactions:e.reactions.availableReactions,canPlayAnimatedEmojis:(0,c.BWX)(e)}))(({isActive:e,addedSetIds:t,customEmojiSetIds:a,stickerSetsById:i,defaultReaction:o,shouldSuggestStickers:l,shouldUpdateStickerSetOrder:c,availableReactions:d,canPlayAnimatedEmojis:m,onReset:u})=>{const{setSettingOption:A,openStickerSet:h,openSettingsScreen:y}=(0,s.ko)(),p=(0,B.A)(),g=(0,n.li)(),{observe:v}=(0,io.BL)({rootRef:g}),E=(0,n.hb)(e=>{h({stickerSetInfo:e.stickerSetInfo})},[h]),f=(0,n.hb)(e=>{A({shouldUpdateStickerSetOrder:e})},[A]),b=(0,n.hb)(e=>{A({shouldSuggestStickers:e})},[A]),C=(0,n.Kr)(()=>t&&Object.values((0,Ea.Up)(i,t)),[t,i]);return(0,Ee.A)({isActive:e,onBack:u}),n.Ay.createElement("div",{className:"settings-content custom-scroll"},n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement(as.A,{label:p("SuggestStickers"),checked:l,onCheck:b}),n.Ay.createElement(ca.A,{narrow:!0,onClick:()=>y({screen:r.VS.CustomEmoji}),icon:"smile"},p("StickersList.EmojiItem"),a&&n.Ay.createElement("span",{className:"settings-item__current-value"},a.length)),o&&n.Ay.createElement(ca.A,{className:"SettingsDefaultReaction",narrow:!0,onClick:()=>y({screen:r.VS.QuickReaction})},n.Ay.createElement(wn.A,{reaction:o,className:"current-default-reaction",size:pA,availableReactions:d}),n.Ay.createElement("div",{className:"title"},p("DoubleTapSetting")))),n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:p.isRtl?"rtl":void 0},p("InstalledStickers.DynamicPackOrder")),n.Ay.createElement(as.A,{label:p("InstalledStickers.DynamicPackOrder"),checked:c,onCheck:f}),n.Ay.createElement("p",{className:"settings-item-description mt-3",dir:"auto"},p("InstalledStickers.DynamicPackOrderInfo"))),C&&n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:p.isRtl?"rtl":void 0},p("ChooseStickerMyStickerSets")),n.Ay.createElement("div",{ref:g},C.map(e=>n.Ay.createElement(cu,{key:e.id,stickerSet:e,observeIntersection:v,onClick:E,noPlay:!m}))),n.Ay.createElement("p",{className:"settings-item-description mt-3",dir:"auto"},(0,Tt.A)(p("StickersBotInfo"),["links"]))))})),vA=(0,n.ph)(({isActive:e,onReset:t})=>{const{openSettingsScreen:a}=(0,s.ko)(),o=(0,B.A)(),l=(0,x.A)(()=>{a({screen:r.VS.Privacy})});return(0,Ee.A)({isActive:e,onBack:t}),n.Ay.createElement("div",{className:"settings-content two-fa custom-scroll"},n.Ay.createElement("div",{className:"settings-content-header no-border"},n.Ay.createElement(Rm.A,{size:i.r2x,tgsUrl:Co.w.Congratulations,className:"settings-content-icon"}),n.Ay.createElement("p",{className:"settings-item-description mb-3",dir:"auto"},o("TwoStepVerificationPasswordSetInfo"))),n.Ay.createElement("div",{className:"settings-item settings-group"},n.Ay.createElement(Y.A,{onClick:l},o("TwoStepVerificationPasswordReturnSettings"))))});var EA=a(79577);const fA=(0,n.ph)((0,s.EK)(e=>{const t=(0,c.nTw)(e).recoveryEmail;return{animatedEmoji:(0,c.oei)(e,"💌"),codeLength:e.twoFaSettings.waitingEmailCodeLength,recoveryEmail:t}})(({animatedEmoji:e,codeLength:t,isLoading:a,error:s,clearError:r,onSubmit:i,isActive:o,onReset:l,recoveryEmail:c})=>{const d=(0,n.li)(),{isMobile:m}=(0,I.Ay)(),u=m?550:400,[A,h]=(0,n.J0)("");(0,n.vJ)(()=>{E.TF||setTimeout(()=>{d.current.focus()},u)},[u]);const y=(0,B.A)();(0,Ee.A)({isActive:o,onBack:l});const p=(0,n.hb)(e=>{s&&r&&r();const a=e.target.value.slice(0,t);a.length===t&&i(a),h(a),e.target.value=a},[r,t,s,i]);return n.Ay.createElement("div",{className:"settings-content two-fa custom-scroll"},n.Ay.createElement("div",{className:"settings-content-header no-border"},n.Ay.createElement(EA.A,{sticker:e,size:160,className:"settings-content-icon"}),c&&n.Ay.createElement("p",{className:"settings-item-description mb-3",dir:"auto"},y("TwoStepAuth.ConfirmEmailDescription",c))),n.Ay.createElement("div",{className:"settings-item settings-group"},n.Ay.createElement(Z.A,{value:A,ref:d,inputMode:"decimal",label:y("YourEmailCode"),error:s,onChange:p}),a&&n.Ay.createElement(Dn.A,null)))})),bA=(0,n.ph)(({isActive:e,onReset:t})=>{const{openSettingsScreen:a}=(0,s.ko)(),i=(0,B.A)();return(0,Ee.A)({isActive:e,onBack:t}),n.Ay.createElement("div",{className:"settings-content two-fa custom-scroll"},n.Ay.createElement("div",{className:"settings-content-header no-border"},n.Ay.createElement(So.A,{tgsUrl:Co.w.Lock,previewUrl:Jm,size:160,className:"settings-content-icon"}),n.Ay.createElement("p",{className:"settings-item-description mb-3",dir:"auto"},(0,Tt.A)(i("EnabledPasswordText"),["br"]))),n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement(ca.A,{icon:"edit",onClick:()=>a({screen:r.VS.TwoFaChangePasswordCurrent})},i("ChangePassword")),n.Ay.createElement(ca.A,{icon:"password-off",onClick:()=>a({screen:r.VS.TwoFaTurnOff})},i("TurnPasswordOff")),n.Ay.createElement(ca.A,{icon:"email",onClick:()=>a({screen:r.VS.TwoFaRecoveryEmailCurrentPassword})},i("SetRecoveryEmail"))))}),CA=(0,n.ph)((0,s.EK)((e,{icon:t})=>({animatedEmoji:(0,c.oei)(e,"email"===t?"💌":"💡")}))(({animatedEmoji:e,type:t="text",isLoading:a,error:s,placeholder:r,shouldConfirm:i,clearError:o,onSubmit:l,isActive:c,onReset:d})=>{const m=(0,n.li)(),{isMobile:u}=(0,I.Ay)(),A=u?550:400,[h,y]=(0,n.J0)(""),[p,g,v]=(0,M.A)(!1);(0,n.vJ)(()=>{E.TF||setTimeout(()=>{m.current.focus()},A)},[A]);const f=(0,n.hb)(e=>{s&&o&&o(),y(e.target.value)},[o,s]),b=(0,n.hb)(()=>{l()},[l]),C=(0,n.hb)(()=>{v(),l()},[l,v]),S=(0,B.A)();return(0,Ee.A)({isActive:c,onBack:d}),n.Ay.createElement("div",{className:"settings-content two-fa custom-scroll"},n.Ay.createElement("div",{className:"settings-content-header no-border"},n.Ay.createElement(EA.A,{sticker:e,size:160,className:"settings-content-icon"}),"email"===t&&n.Ay.createElement("p",{className:"settings-item-description mb-3",dir:"auto"},S("RecoveryEmailSubtitle"))),n.Ay.createElement("div",{className:"settings-item settings-group"},n.Ay.createElement("form",{action:"",onSubmit:e=>{e.preventDefault(),m.current&&l(h)}},n.Ay.createElement(Z.A,{ref:m,value:h,inputMode:t,label:r,error:s,onChange:f}),h?n.Ay.createElement(Y.A,{type:"submit",isLoading:a,ripple:!0},S("Continue")):n.Ay.createElement(Y.A,{isText:!0,isLoading:a,ripple:!0,onClick:i?g:b},S("YourEmailSkip"))),i&&n.Ay.createElement(X.A,{className:"narrow",isOpen:p,title:S("YourEmailSkipWarning"),onClose:v},(0,Tt.A)(S("YourEmailSkipWarningText"),["br","simple_markdown"]),n.Ay.createElement("div",{className:"dialog-buttons"},n.Ay.createElement(Y.A,{color:"danger",ripple:!0,isText:!0,className:"confirm-dialog-button",onClick:C},S("YourEmailSkip")),n.Ay.createElement(Y.A,{color:"primary",ripple:!0,isText:!0,className:"confirm-dialog-button",onClick:v},S("Cancel"))))))})),SA=(0,n.ph)(({isActive:e,onReset:t,onStart:a})=>{const s=(0,B.A)();return(0,Ee.A)({isActive:e,onBack:t}),n.Ay.createElement("div",{className:"settings-content two-fa custom-scroll"},n.Ay.createElement("div",{className:"settings-content-header no-border"},n.Ay.createElement(So.A,{tgsUrl:Co.w.Lock,previewUrl:Jm,size:160,className:"settings-content-icon"}),n.Ay.createElement("p",{className:"settings-item-description mb-3",dir:"auto"},s("SetAdditionalPasswordInfo"))),n.Ay.createElement("div",{className:"settings-item settings-group"},n.Ay.createElement(Y.A,{onClick:a},s("EditAdminTransferSetPassword"))))}),kA=(0,n.ph)((0,s.EK)(e=>({...e.twoFaSettings}))(({currentScreen:e,shownScreen:t,state:a,hint:i,isLoading:o,errorKey:l,waitingEmailCodeLength:c,dispatch:d,isActive:m,onReset:u})=>{const{updatePassword:A,checkPassword:h,clearTwoFaError:y,updateRecoveryEmail:p,provideTwoFaEmailCode:g,clearPassword:v,openSettingsScreen:E}=(0,s.ko)(),f=(0,Ua.A)(),b=(0,B.A)();(0,n.vJ)(()=>{c&&(e===r.VS.TwoFaNewPasswordEmail?E({screen:r.VS.TwoFaNewPasswordEmailCode}):e===r.VS.TwoFaRecoveryEmail&&E({screen:r.VS.TwoFaRecoveryEmailCode}))},[e,c,E]);const C=(0,n.hb)(()=>{d({type:"reset"}),E({screen:r.VS.TwoFaNewPassword})},[d,E]),S=(0,n.hb)(e=>{d({type:"setPassword",payload:e}),E({screen:r.VS.TwoFaNewPasswordConfirm})},[d,E]),k=(0,n.hb)(()=>{E({screen:r.VS.TwoFaNewPasswordHint})},[E]),w=(0,n.hb)(e=>{d({type:"setHint",payload:e}),E({screen:r.VS.TwoFaNewPasswordEmail})},[d,E]),N=(0,n.hb)(e=>{d({type:"setEmail",payload:e}),A({...a,email:e,onSuccess:()=>{E({screen:r.VS.TwoFaCongratulations})}})},[d,a,A,E]),I=(0,n.hb)(e=>{d({type:"setCurrentPassword",payload:e}),h({currentPassword:e,onSuccess:()=>{E({screen:r.VS.TwoFaChangePasswordNew})}})},[h,d,E]),P=(0,n.hb)(e=>{d({type:"setPassword",payload:e}),E({screen:r.VS.TwoFaChangePasswordConfirm})},[d,E]),M=(0,n.hb)(()=>{E({screen:r.VS.TwoFaChangePasswordHint})},[E]),T=(0,n.hb)(e=>{d({type:"setHint",payload:e}),A({...a,hint:e,onSuccess:()=>{E({screen:r.VS.TwoFaCongratulations})}})},[d,a,A,E]),x=(0,n.hb)(e=>{v({currentPassword:e,onSuccess:()=>{E({screen:r.VS.Privacy})}})},[v,E]),L=(0,n.hb)(e=>{d({type:"setCurrentPassword",payload:e}),h({currentPassword:e,onSuccess:()=>{E({screen:r.VS.TwoFaRecoveryEmail})}})},[h,d,E]),R=(0,n.hb)(e=>{d({type:"setEmail",payload:e}),p({...a,email:e,onSuccess:()=>{E({screen:r.VS.TwoFaCongratulations})}})},[d,a,p,E]),F=(0,n.hb)(e=>{g({code:e})},[g]);switch(e){case r.VS.TwoFaDisabled:return n.Ay.createElement(SA,{onStart:C,isActive:m||[r.VS.TwoFaNewPassword,r.VS.TwoFaNewPasswordConfirm,r.VS.TwoFaNewPasswordHint,r.VS.TwoFaNewPasswordEmail,r.VS.TwoFaNewPasswordEmailCode,r.VS.TwoFaCongratulations].includes(t),onReset:u});case r.VS.TwoFaNewPassword:return n.Ay.createElement(Um,{placeholder:b("PleaseEnterPassword"),submitLabel:b("Continue"),onSubmit:S,isActive:m||[r.VS.TwoFaNewPasswordConfirm,r.VS.TwoFaNewPasswordHint,r.VS.TwoFaNewPasswordEmail,r.VS.TwoFaNewPasswordEmailCode,r.VS.TwoFaCongratulations].includes(t),onReset:u});case r.VS.TwoFaNewPasswordConfirm:return n.Ay.createElement(Um,{expectedPassword:a.password,placeholder:b("PleaseReEnterPassword"),submitLabel:b("Continue"),onSubmit:k,isActive:m||[r.VS.TwoFaNewPasswordHint,r.VS.TwoFaNewPasswordEmail,r.VS.TwoFaNewPasswordEmailCode,r.VS.TwoFaCongratulations].includes(t),onReset:u});case r.VS.TwoFaNewPasswordHint:return n.Ay.createElement(CA,{icon:"hint",placeholder:b("PasswordHintPlaceholder"),onSubmit:w,isActive:m||[r.VS.TwoFaNewPasswordEmail,r.VS.TwoFaNewPasswordEmailCode,r.VS.TwoFaCongratulations].includes(t),onReset:u});case r.VS.TwoFaNewPasswordEmail:return n.Ay.createElement(CA,{icon:"email",type:"email",isLoading:o,error:l&&f.withRegular(l),clearError:y,placeholder:b("RecoveryEmailTitle"),shouldConfirm:!0,onSubmit:N,isActive:m||[r.VS.TwoFaNewPasswordEmailCode,r.VS.TwoFaCongratulations].includes(t),onReset:u});case r.VS.TwoFaNewPasswordEmailCode:return n.Ay.createElement(fA,{isLoading:o,error:l&&f.withRegular(l),clearError:y,onSubmit:F,isActive:m||t===r.VS.TwoFaCongratulations,onReset:u});case r.VS.TwoFaCongratulations:return n.Ay.createElement(vA,{isActive:m,onReset:u});case r.VS.TwoFaEnabled:return n.Ay.createElement(bA,{isActive:m||[r.VS.TwoFaChangePasswordCurrent,r.VS.TwoFaChangePasswordNew,r.VS.TwoFaChangePasswordConfirm,r.VS.TwoFaChangePasswordHint,r.VS.TwoFaTurnOff,r.VS.TwoFaRecoveryEmailCurrentPassword,r.VS.TwoFaRecoveryEmail,r.VS.TwoFaRecoveryEmailCode,r.VS.TwoFaCongratulations].includes(t),onReset:u});case r.VS.TwoFaChangePasswordCurrent:return n.Ay.createElement(Um,{isLoading:o,error:l&&f.withRegular(l),clearError:y,hint:i,onSubmit:I,isActive:m||[r.VS.TwoFaChangePasswordNew,r.VS.TwoFaChangePasswordConfirm,r.VS.TwoFaChangePasswordHint,r.VS.TwoFaCongratulations].includes(t),onReset:u});case r.VS.TwoFaChangePasswordNew:return n.Ay.createElement(Um,{placeholder:b("PleaseEnterNewFirstPassword"),onSubmit:P,isActive:m||[r.VS.TwoFaChangePasswordConfirm,r.VS.TwoFaChangePasswordHint,r.VS.TwoFaCongratulations].includes(t),onReset:u});case r.VS.TwoFaChangePasswordConfirm:return n.Ay.createElement(Um,{expectedPassword:a.password,placeholder:b("PleaseReEnterPassword"),onSubmit:M,isActive:m||[r.VS.TwoFaChangePasswordHint,r.VS.TwoFaCongratulations].includes(t),onReset:u});case r.VS.TwoFaChangePasswordHint:return n.Ay.createElement(CA,{isLoading:o,error:l&&f.withRegular(l),clearError:y,icon:"hint",placeholder:b("PasswordHintPlaceholder"),onSubmit:T,isActive:m||t===r.VS.TwoFaCongratulations,onReset:u});case r.VS.TwoFaTurnOff:return n.Ay.createElement(Um,{isLoading:o,error:l&&f.withRegular(l),clearError:y,hint:i,onSubmit:x,isActive:m,onReset:u});case r.VS.TwoFaRecoveryEmailCurrentPassword:return n.Ay.createElement(Um,{isLoading:o,error:l&&f.withRegular(l),clearError:y,hint:i,onSubmit:L,isActive:m||[r.VS.TwoFaRecoveryEmail,r.VS.TwoFaRecoveryEmailCode,r.VS.TwoFaCongratulations].includes(t),onReset:u});case r.VS.TwoFaRecoveryEmail:return n.Ay.createElement(CA,{icon:"email",type:"email",placeholder:b("RecoveryEmailTitle"),onSubmit:R,isActive:m||[r.VS.TwoFaRecoveryEmailCode,r.VS.TwoFaCongratulations].includes(t),onReset:u});case r.VS.TwoFaRecoveryEmailCode:return n.Ay.createElement(fA,{isLoading:o,error:l&&f.withRegular(l),clearError:y,onSubmit:F,isActive:m||t===r.VS.TwoFaCongratulations,onReset:u});default:return}})),wA=Object.keys(r.VS).length/2,NA=[r.VS.TwoFaDisabled,r.VS.TwoFaNewPassword,r.VS.TwoFaNewPasswordConfirm,r.VS.TwoFaNewPasswordHint,r.VS.TwoFaNewPasswordEmail,r.VS.TwoFaNewPasswordEmailCode,r.VS.TwoFaCongratulations,r.VS.TwoFaEnabled,r.VS.TwoFaChangePasswordCurrent,r.VS.TwoFaChangePasswordNew,r.VS.TwoFaChangePasswordConfirm,r.VS.TwoFaChangePasswordHint,r.VS.TwoFaTurnOff,r.VS.TwoFaRecoveryEmailCurrentPassword,r.VS.TwoFaRecoveryEmail,r.VS.TwoFaRecoveryEmailCode],IA=[r.VS.PasscodeDisabled,r.VS.PasscodeEnabled],PA=[r.VS.Folders,r.VS.FoldersCreateFolder,r.VS.FoldersEditFolder,r.VS.FoldersEditFolderFromChatList,r.VS.FoldersEditFolderInvites,r.VS.FoldersIncludedChats,r.VS.FoldersIncludedChatsFromChatList,r.VS.FoldersExcludedChats,r.VS.FoldersExcludedChatsFromChatList,r.VS.FoldersShare],MA=[r.VS.PrivacyBlockedUsers,r.VS.ActiveWebsites],TA=[r.VS.PrivacyPhoneNumberAllowedContacts,r.VS.PrivacyPhoneNumberDeniedContacts],xA=[r.VS.PrivacyLastSeenAllowedContacts,r.VS.PrivacyLastSeenDeniedContacts],BA=[r.VS.PrivacyProfilePhotoAllowedContacts,r.VS.PrivacyProfilePhotoDeniedContacts],LA=[r.VS.PrivacyBioAllowedContacts,r.VS.PrivacyBioDeniedContacts],RA=[r.VS.PrivacyBirthdayAllowedContacts,r.VS.PrivacyBirthdayDeniedContacts],FA=[r.VS.PrivacyGiftsAllowedContacts,r.VS.PrivacyGiftsDeniedContacts],DA=[r.VS.PrivacyPhoneCallAllowedContacts,r.VS.PrivacyPhoneCallDeniedContacts],VA=[r.VS.PrivacyPhoneP2PAllowedContacts,r.VS.PrivacyPhoneP2PDeniedContacts],_A=[r.VS.PrivacyForwardingAllowedContacts,r.VS.PrivacyForwardingDeniedContacts],UA=[r.VS.PrivacyVoiceMessagesAllowedContacts,r.VS.PrivacyVoiceMessagesDeniedContacts],OA=[r.VS.PrivacyGroupChatsAllowedContacts,r.VS.PrivacyGroupChatsDeniedContacts],JA=[r.VS.PrivacyNoPaidMessages],KA=(0,n.ph)(({isActive:e,currentScreen:t,foldersState:a,foldersDispatch:i,onReset:o,animationLevel:l,shouldSkipTransition:d})=>{const{closeShareChatFolderModal:m,openSettingsScreen:u}=(0,s.ko)(),A=(0,n.li)(),[h,y]=(0,Em.A)(bm,fm),[p,g]=(0,n.J0)("");(0,Cm.A)({containerRef:A,selector:".settings-content"},[t]);const v=(0,x.A)(e=>{const n=(0,c.nTw)((0,s.mS)()).shareFolderScreen?.isFromSettings;t===r.VS.FoldersShare&&m(),!0===e||void 0!==n&&!n?o(!0):(t!==r.VS.FoldersCreateFolder&&t!==r.VS.FoldersEditFolder&&t!==r.VS.FoldersEditFolderFromChatList&&t!==r.VS.FoldersEditFolderInvites||setTimeout(()=>{i({type:"reset"})},200),t!==r.VS.FoldersIncludedChats&&t!==r.VS.FoldersExcludedChats?o():"create"===a.mode?u({screen:r.VS.FoldersCreateFolder}):u({screen:r.VS.FoldersEditFolder}))});function E(s,o,l,c){return n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(Ju,{currentScreen:t,onReset:v,editedFolderId:a.folderId}),function(s,o){const l={[r.VS.PrivacyPhoneNumber]:TA.includes(o),[r.VS.PrivacyLastSeen]:xA.includes(o),[r.VS.PrivacyProfilePhoto]:BA.includes(o),[r.VS.PrivacyBio]:LA.includes(o),[r.VS.PrivacyBirthday]:RA.includes(o),[r.VS.PrivacyGifts]:FA.includes(o),[r.VS.PrivacyPhoneCall]:DA.includes(o),[r.VS.PrivacyPhoneP2P]:VA.includes(o),[r.VS.PrivacyForwarding]:_A.includes(o),[r.VS.PrivacyVoiceMessages]:UA.includes(o),[r.VS.PrivacyGroupChats]:OA.includes(o),[r.VS.PrivacyMessages]:JA.includes(o)},c=NA.includes(o),d=IA.includes(o),m=PA.includes(o),u=MA.includes(o)||c||d||Object.keys(l).map(Number).includes(o)||Object.values(l).includes(!0);switch(t){case r.VS.Main:return n.Ay.createElement(Hu,{isActive:e,onReset:v});case r.VS.EditProfile:return n.Ay.createElement(ku,{isActive:e&&s,onReset:v});case r.VS.General:return n.Ay.createElement(Tu,{isActive:s||o===r.VS.GeneralChatBackgroundColor||o===r.VS.GeneralChatBackground||o===r.VS.QuickReaction||o===r.VS.CustomEmoji||u||m,onReset:v});case r.VS.QuickReaction:return n.Ay.createElement(yA,{isActive:s,onReset:v});case r.VS.CustomEmoji:return n.Ay.createElement(du,{isActive:s,onReset:v});case r.VS.Notifications:return n.Ay.createElement(Wu,{isActive:s,onReset:v});case r.VS.DataStorage:return n.Ay.createElement(mu,{isActive:s,onReset:v});case r.VS.Privacy:return n.Ay.createElement(aA,{isActive:s||u,onReset:v});case r.VS.Language:return n.Ay.createElement(Ku,{isActive:s||o===r.VS.DoNotTranslate,onReset:v});case r.VS.DoNotTranslate:return n.Ay.createElement(yu,{isActive:s,onReset:v});case r.VS.Stickers:return n.Ay.createElement(gA,{isActive:s,onReset:v});case r.VS.Experimental:return n.Ay.createElement(Iu,{isActive:s,onReset:v});case r.VS.GeneralChatBackground:return n.Ay.createElement(Fu,{isActive:s||o===r.VS.GeneralChatBackgroundColor,onReset:v});case r.VS.GeneralChatBackgroundColor:return n.Ay.createElement(Ou,{isActive:s,onReset:v});case r.VS.ActiveSessions:return n.Ay.createElement(su,{isActive:s,onReset:v});case r.VS.ActiveWebsites:return n.Ay.createElement(lu,{isActive:s,onReset:v});case r.VS.PrivacyBlockedUsers:return n.Ay.createElement(sA,{isActive:s,onReset:v});case r.VS.PrivacyPhoneNumber:case r.VS.PrivacyLastSeen:case r.VS.PrivacyProfilePhoto:case r.VS.PrivacyBio:case r.VS.PrivacyBirthday:case r.VS.PrivacyGifts:case r.VS.PrivacyPhoneCall:case r.VS.PrivacyForwarding:case r.VS.PrivacyVoiceMessages:case r.VS.PrivacyGroupChats:return n.Ay.createElement(mA,{screen:t,isActive:s||l[t],onReset:v});case r.VS.PrivacyPhoneNumberAllowedContacts:case r.VS.PrivacyLastSeenAllowedContacts:case r.VS.PrivacyProfilePhotoAllowedContacts:case r.VS.PrivacyBioAllowedContacts:case r.VS.PrivacyBirthdayAllowedContacts:case r.VS.PrivacyGiftsAllowedContacts:case r.VS.PrivacyPhoneCallAllowedContacts:case r.VS.PrivacyPhoneP2PAllowedContacts:case r.VS.PrivacyForwardingAllowedContacts:case r.VS.PrivacyVoiceMessagesAllowedContacts:case r.VS.PrivacyGroupChatsAllowedContacts:case r.VS.PrivacyNoPaidMessages:return n.Ay.createElement(hA,{isAllowList:!0,usersOnly:t===r.VS.PrivacyNoPaidMessages,withPremiumCategory:t===r.VS.PrivacyGroupChatsAllowedContacts,withMiniAppsCategory:t===r.VS.PrivacyGiftsAllowedContacts,screen:t,isActive:s||l[t],onReset:v});case r.VS.PrivacyPhoneNumberDeniedContacts:case r.VS.PrivacyLastSeenDeniedContacts:case r.VS.PrivacyProfilePhotoDeniedContacts:case r.VS.PrivacyBioDeniedContacts:case r.VS.PrivacyBirthdayDeniedContacts:case r.VS.PrivacyGiftsDeniedContacts:case r.VS.PrivacyPhoneCallDeniedContacts:case r.VS.PrivacyPhoneP2PDeniedContacts:case r.VS.PrivacyForwardingDeniedContacts:case r.VS.PrivacyVoiceMessagesDeniedContacts:case r.VS.PrivacyGroupChatsDeniedContacts:return n.Ay.createElement(hA,{screen:t,isActive:s,onReset:v});case r.VS.PrivacyMessages:return n.Ay.createElement(Xm,{isActive:s,onReset:v});case r.VS.Folders:case r.VS.FoldersCreateFolder:case r.VS.FoldersEditFolder:case r.VS.FoldersEditFolderFromChatList:case r.VS.FoldersEditFolderInvites:case r.VS.FoldersIncludedChats:case r.VS.FoldersIncludedChatsFromChatList:case r.VS.FoldersExcludedChats:case r.VS.FoldersExcludedChatsFromChatList:case r.VS.FoldersShare:return n.Ay.createElement(Dm,{currentScreen:t,shownScreen:o,state:a,dispatch:i,isActive:s,onReset:v});case r.VS.TwoFaDisabled:case r.VS.TwoFaNewPassword:case r.VS.TwoFaNewPasswordConfirm:case r.VS.TwoFaNewPasswordHint:case r.VS.TwoFaNewPasswordEmail:case r.VS.TwoFaNewPasswordEmailCode:case r.VS.TwoFaCongratulations:case r.VS.TwoFaEnabled:case r.VS.TwoFaChangePasswordCurrent:case r.VS.TwoFaChangePasswordNew:case r.VS.TwoFaChangePasswordConfirm:case r.VS.TwoFaChangePasswordHint:case r.VS.TwoFaTurnOff:case r.VS.TwoFaRecoveryEmailCurrentPassword:case r.VS.TwoFaRecoveryEmail:case r.VS.TwoFaRecoveryEmailCode:return n.Ay.createElement(kA,{currentScreen:t,state:h,dispatch:y,shownScreen:o,isActive:s,onReset:v});case r.VS.PasscodeDisabled:case r.VS.PasscodeNewPasscode:case r.VS.PasscodeNewPasscodeConfirm:case r.VS.PasscodeChangePasscodeCurrent:case r.VS.PasscodeChangePasscodeNew:case r.VS.PasscodeChangePasscodeConfirm:case r.VS.PasscodeCongratulations:case r.VS.PasscodeEnabled:case r.VS.PasscodeTurnOff:return n.Ay.createElement(jm,{currentScreen:t,passcode:p,onSetPasscode:g,shownScreen:o,isActive:s,onReset:v});case r.VS.Performance:return n.Ay.createElement(tA,{isActive:s,onReset:v});default:return}}(s,c))}return n.Ay.createElement(ne.Ay,{ref:A,id:"Settings",name:(0,Oc.P)("layers",l,d),activeKey:t,renderCount:wA,shouldWrap:!0,withSwipeControl:!0},E)});var GA=a(10504),jA=a(52014),zA=a(21468),HA=a(19828);const $A=({message:e})=>Al.createElement("div",{className:"text-[12px] leading-[18px] text-red-400"},e),qA=e=>{const{type:t,knowledge:a,onClose:n,onUpdate:s}=e,r=(0,Al.useRef)((0,Gc.A)()),[i,o]=(0,Al.useState)(a?.richText||[{type:"paragraph",children:[{text:""}]}]),[l,c]=(0,Al.useState)(a?.question||""),[d,m]=(0,Al.useState)(""),[u,A]=(0,Al.useState)(""),h=(0,Al.useRef)(null),y=(0,Al.useCallback)(e=>{c(e.target.value)},[]),p=(0,Al.useCallback)(()=>{const e=i.map(e=>HA.bP.string(e)).join("\n");if(!e)return void A("Please enter your notes");if(A(""),!l)return void m("Please enter a question");m("");const o="add"===t?r.current:a?.id;$c.zs.knowledge?.addKnowledge({id:o,richText:i,plainText:e,question:l}).then(()=>{n(),s()})},[a?.id,n,s,l,t,i]);return Al.createElement("div",{className:"flex flex-col gap-[20px] h-full"},Al.createElement("div",{className:"flex-1 flex flex-col overflow-hidden"},Al.createElement(GA.Ay,{className:"flex-1 flex flex-col overflow-hidden",ref:h,value:i,onChange:o,toolbar:["history","bold","italic","decoration","text-align","list"],placeholder:"Save your most-used answers as Quick Replies — e.g. your email, Calendly link, or a short project intro. Next time someone asks, insert it in one tap. "}),u&&Al.createElement($A,{message:u})),Al.createElement("div",{className:"flex flex-col gap-[8px]"},Al.createElement("div",null,"Preset standard questions",Al.createElement("span",{className:"text-[#FF543D]"},"*")),Al.createElement(jA.A,{value:l,onChange:y}),d&&Al.createElement($A,{message:d})),Al.createElement("div",{className:"flex flex-row gap-8 justify-end"},Al.createElement(zA.Ay,{className:"!w-[120px] !h-[42px]",onClick:n},"Cancel"),Al.createElement(zA.Ay,{type:"primary",className:"!w-[120px] !h-[42px]",onClick:p},"Add")))},WA=({type:e,knowledge:t,isOpen:a,onClose:s,onUpdate:r})=>{const i=(0,ul.P)({component:qA,props:{knowledge:t,type:e,onClose:s,onUpdate:r}});return n.Ay.createElement(X.A,{title:"Notes",hasCloseButton:!0,isOpen:a,onClose:s,dialogStyle:"max-width: 1000px; width: 70vw; height: 60vh;"},n.Ay.createElement("div",{className:"knowledge-editor",ref:i}))},QA=a.p+"ai-knowledge-empty.15bc7ca6bb594e3cd5fd.png",YA=({onAdd:e})=>n.Ay.createElement("div",{className:"flex flex-col justify-center items-center px-[30px] pt-[120px]"},n.Ay.createElement("img",{src:QA,alt:"AIKnowledge",className:"w-[125px] h-[125px] mb-[12px]"}),n.Ay.createElement("span",{className:"text-[14px] text-[#676B74]"},"Store your frequently used personal info, company details, and business materials here.During chats, AI will reference this content to deliver more relevant and intelligent responses."),n.Ay.createElement(Y.A,{round:!0,color:"translucent",className:"!bg-[#8C42F0] flex flex-row items-center gap-[8px] !w-[148px] !h-[42px] !p-0 !rounded-[21px] mt-[20px]",onClick:e},n.Ay.createElement(Q.A,{className:"text-white text-[14px]",name:"add"}),n.Ay.createElement("span",{className:"text-white"},"Add"))),ZA=({knowledgeList:e,onEdit:t,onDelete:a})=>{const{showNotification:r}=(0,s.ko)(),i=(0,n.hb)(e=>{Nl()(e.plainText),r({message:"TextCopied"})},[]),o=(0,n.hb)(e=>{t(e)},[t]),l=(0,n.hb)(e=>{a(e.id)},[a]);return n.Ay.createElement("div",{className:"px-[20px]"},e.map(e=>n.Ay.createElement("div",{key:e.id,className:"bg-[#F7F7F7] rounded-[12px] px-[16px] py-[15px] mb-[12px]"},n.Ay.createElement("div",{className:"white-space-pre-wrap line-clamp-3 overflow-hidden text-ellipsis"},e?.question||""),n.Ay.createElement("div",{className:"white-space-pre-wrap line-clamp-3 overflow-hidden text-ellipsis"},e.plainText.replace(/\\n/g,"")),n.Ay.createElement("div",{className:"flex justify-end gap-[8px] items-center"},n.Ay.createElement(Y.A,{round:!0,size:"smaller",color:"translucent",onClick:()=>i(e)},n.Ay.createElement(Q.A,{name:"copy",className:"text-[14px]"})),n.Ay.createElement(Y.A,{round:!0,size:"smaller",color:"translucent",onClick:()=>o(e)},n.Ay.createElement(Q.A,{name:"edit",className:"text-[14px]"})),n.Ay.createElement(Y.A,{round:!0,size:"smaller",color:"translucent",onClick:()=>l(e)},n.Ay.createElement(Q.A,{name:"delete",className:"text-[14px]"}))))))},XA=(0,n.ph)(({knowledgeList:e,onShowAddModal:t,onEdit:a,onDelete:s})=>{const r=(0,n.hb)(()=>{t("add")},[t]);return n.Ay.createElement("div",{className:"pt-[20px] h-full box-border"},0===e.length?n.Ay.createElement(YA,{onAdd:r}):n.Ay.createElement(ZA,{knowledgeList:e,onEdit:a,onDelete:s}))}),eh=(0,n.ph)(({onReset:e,showAddButton:t,onShowAddModal:a})=>{const s=(0,B.A)(),r=(0,n.hb)(()=>{a("add")},[a]);return n.Ay.createElement("div",{className:"left-header"},n.Ay.createElement(Y.A,{round:!0,size:"smaller",color:"translucent",onClick:e,ariaLabel:s("AccDescrGoBack")},n.Ay.createElement(Q.A,{name:"arrow-left"})),n.Ay.createElement("h3",null,s("Quick Replies")),t&&n.Ay.createElement(Y.A,{round:!0,color:"translucent",className:"!bg-[#8C42F0] flex flex-row items-center gap-[8px] !w-[92px] !h-[30px] !p-0 !rounded-[21px] !text-[14px]",onClick:r},n.Ay.createElement(Q.A,{className:"text-white text-[14px]",name:"add"}),n.Ay.createElement("span",{className:"text-white"},"Add")))}),th=(0,n.ph)(({onReset:e})=>{const[t,a]=(0,n.J0)([]),[s,r]=(0,n.J0)(!1),[i,o]=(0,n.J0)("add"),[l,c]=(0,n.J0)(null);(0,n.vJ)(()=>{$c.zs.knowledge?.getAllKnowledge().then(e=>{a(e||[])})},[]);const d=(0,x.A)(()=>{e(!0)}),m=(0,n.hb)(()=>{r(!1)},[]),u=(0,n.hb)(e=>{r(!0),o(e)},[]),A=(0,n.hb)(e=>{o("edit"),c(e),r(!0)},[]),h=(0,n.hb)(()=>{c(null),$c.zs.knowledge?.getAllKnowledge().then(e=>{a(e||[])})},[]),y=(0,n.hb)(e=>{$c.zs.knowledge?.deleteKnowledge(e).then(()=>{a(t=>t.filter(t=>t.id!==e))})},[]);function p(){return n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(eh,{onReset:d,showAddButton:t.length>0,onShowAddModal:u}),n.Ay.createElement(XA,{knowledgeList:t,onShowAddModal:u,onEdit:A,onDelete:y}),s&&n.Ay.createElement(WA,{type:i,isOpen:s,onClose:m,knowledge:l,onUpdate:h}))}return n.Ay.createElement(ne.Ay,{id:"AiKnowledge",name:"fade",activeKey:0,renderCount:1,shouldWrap:!0,withSwipeControl:!0},p)});var ah=a(48862);const nh={root:"T_GGJ8J2",item:"fe7VNmNB"},sh=["af","als","am","an","ar","arz","as","ast","av","az","azb","ba","bar","bcl","be","bg","bh","bn","bo","bpy","br","bs","bxr","ca","cbk","ce","ceb","ckb","co","cs","cv","cy","da","de","diq","dsb","dty","dv","el","eml","en","eo","es","et","eu","fa","fi","fr","frr","fy","ga","gd","gl","gn","gom","gu","gv","he","hi","hif","hr","hsb","ht","hu","hy","ia","id","ie","ilo","io","is","it","ja","jbo","jv","ka","kk","km","kn","ko","krc","ku","kv","kw","ky","la","lb","lez","li","lmo","lo","lrc","lt","lv","mai","mg","mhr","min","mk","ml","mn","mr","mrj","ms","mt","mwl","my","myv","mzn","nah","nap","nds","ne","new","nl","nn","no","oc","or","os","pa","pam","pfl","pl","pms","pnb","ps","pt","qu","rm","ro","ru","rue","sa","sah","sc","scn","sco","sd","sh","si","sk","sl","so","sq","sr","su","sv","sw","ta","te","tg","th","tk","tl","tr","tt","tyv","ug","uk","ur","uz","vec","vep","vi","vls","vo","wa","war","wuu","xal","xmf","yi","yo","yue","zh"],rh=i.N89.filter(e=>sh.includes(e)),ih=(0,n.ph)((0,s.EK)(e=>{const{autoTranslateLanguage:t}=e.settings.byKey;return{autoTranslateLanguage:t}})(({autoTranslateLanguage:e})=>{const{setSettingOption:t}=(0,s.ko)(),a=(0,B.A)().code||"en",[r,i]=(0,n.J0)(e),[o,l]=(0,n.J0)(""),c=(0,n.Kr)(()=>{const e=rh.map(e=>({langCode:e,translatedName:new Intl.DisplayNames([a],{type:"language"}).of(e),originalName:new Intl.DisplayNames([e],{type:"language"}).of(e)})).filter(Boolean).map(({langCode:e,translatedName:t,originalName:a})=>({label:t,subLabel:a,value:e}));if(!o.trim()){const t=e.find(e=>e.value===a),n=e.filter(e=>e.value!==a);return t?[t,...n]:e}return e?.filter(e=>e.label.toLowerCase().includes(o.toLowerCase()))},[a,o]),d=(0,x.A)(e=>{i(e),t({autoTranslateLanguage:e,translationLanguage:e}),ah.Hk.setSettingOption({autotranslatelanguage:e})});return n.Ay.createElement("div",{className:(0,ue.A)(nh.root,"settings-content infinite-scroll")},n.Ay.createElement("div",{className:(0,ue.A)(nh.item)},n.Ay.createElement(Ci,{className:nh.picker,items:c,selectedValue:r,onSelectedValueChange:d,filterValue:o,onFilterChange:l,isSearchable:!1,allowMultiple:!1,withDefaultPadding:!0,itemInputType:"radio",searchInputId:"lang-picker-search"})))})),oh=(0,n.ph)((0,s.EK)(e=>{const{autoTranslate:t}=e.settings.byKey;return{autoTranslate:t}})(({autoTranslate:e,isActive:t,onReset:a})=>{const{setSettingOption:r}=(0,s.ko)(),i=(0,B.A)(),[o,l]=(0,n.J0)(e),c=(0,x.A)(e=>{l(e),r({autoTranslate:e}),ah.Hk.setSettingOption({autotranslate:e})});return(0,Ee.A)({isActive:t,onBack:a}),n.Ay.createElement("div",{className:"settings-content settings-language custom-scroll"},n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement(as.A,{label:i("Auto Translate"),checked:o,onCheck:c})),n.Ay.createElement("div",{className:"settings-item settings-item-picker"},n.Ay.createElement("h4",{className:"settings-item-header"},i("Language")),n.Ay.createElement(ih,null)))})),lh=(0,n.ph)(({onReset:e})=>{const t=(0,B.A)();return n.Ay.createElement("div",{className:"left-header"},n.Ay.createElement(Y.A,{round:!0,size:"smaller",color:"translucent",onClick:e,ariaLabel:t("AccDescrGoBack")},n.Ay.createElement(Q.A,{name:"arrow-left"})),n.Ay.createElement("h3",null,t("AI Translate")))}),ch=(0,n.ph)(({onReset:e})=>{function t(){return n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(lh,{onReset:e}),n.Ay.createElement(oh,{onReset:e}))}return n.Ay.createElement(ne.Ay,{id:"AiTranslate",name:"fade",activeKey:0,renderCount:1,shouldWrap:!0,withSwipeControl:!0},t)}),dh=(0,n.ph)((0,s.EK)(e=>{const{userIds:t}=e.contactList||{},{byId:a,statusesById:n}=e.users;return{usersById:a,userStatusesById:n,contactIds:t}})(({isActive:e,filter:t,usersById:a,userStatusesById:i,contactIds:o,onReset:c})=>{const{openChat:d,openNewContactDialog:m}=(0,s.ko)(),u=(0,B.A)(),{isMobile:A}=(0,I.Ay)();(0,Ee.A)({isActive:e,onBack:c});const h=(0,n.hb)(e=>{d({id:e,shouldReplaceHistory:!0})},[d]),y=(0,n.Kr)(()=>{if(!o)return;const e=(0,Mt.PU)({ids:o,query:t,type:"user"});return(0,l.UB)(e,a,i)},[o,t,a,i]),[p,g]=(0,Ln.A)(void 0,y,Boolean(t));return n.Ay.createElement(fn.A,{items:p,onLoadMore:g,className:"chat-list custom-scroll"},p?.length?p.map(e=>n.Ay.createElement(ca.A,{key:e,className:"chat-item-clickable contact-list-item",onClick:()=>h(e)},n.Ay.createElement(kn.A,{userId:e,forceShowSelf:!0,avatarSize:"large",withStory:!0,storyViewerOrigin:r.G9.ChatList,ripple:!A}))):p&&!p.length?n.Ay.createElement("p",{className:"no-results",key:"no-results",dir:"auto"},t.length?"No contacts matched your search.":"Contact list is empty."):n.Ay.createElement(Dn.A,{key:"loading"}),n.Ay.createElement(ka.A,{key:"create-new-contact",isShown:!0,onClick:m,ariaLabel:u("CreateNewContact")},n.Ay.createElement(Q.A,{name:"add-user-filled"})))})),mh=(0,n.ph)((0,s.EK)(e=>{const{userIds:t}=e.contactList||{},{query:a,fetchingStatus:n,globalResults:s,localResults:r}=(0,c.nTw)(e).globalSearch,{peerIds:i}=s||{},{peerIds:o}=r||{};return{localContactIds:t,searchQuery:a,isSearching:n?.chats,globalPeerIds:i,localPeerIds:o}})(({isChannel:e,isActive:t,selectedMemberIds:a,localContactIds:r,searchQuery:i,isSearching:o,localPeerIds:c,globalPeerIds:d,onSelectedMemberIdsChange:m,onNextStep:u,onReset:A})=>{const{setGlobalSearchQuery:h}=(0,s.ko)(),y=(0,B.A)();(0,Ee.A)({isActive:t,onBack:A});const p=(0,n.hb)(e=>{h({query:e})},[]),g=(0,n.Kr)(()=>{const e=(0,s.mS)().users.byId,t=r?(0,Mt.PU)({ids:r,query:i,type:"user"}):[];return(0,xn.A)((0,Ea.Am)([...t,...c||[],...d||[]]).filter(t=>{const a=e[t];return a&&!a.isSelf&&(a.canBeInvitedToGroup||!(0,l.tv)(a))}),!1,a)},[r,i,c,d,a]),v=(0,n.hb)(()=>{h({query:""}),u()},[u]);return n.Ay.createElement("div",{className:"NewChat step-1"},n.Ay.createElement("div",{className:"left-header"},n.Ay.createElement(Y.A,{round:!0,size:"smaller",color:"translucent",onClick:A,ariaLabel:"Return to Chat List"},n.Ay.createElement(Q.A,{name:"arrow-left"})),n.Ay.createElement("h3",null,y("GroupAddMembers"))),n.Ay.createElement("div",{className:"NewChat-inner step-1"},n.Ay.createElement(ba.A,{itemIds:g,selectedIds:a,filterValue:i,filterPlaceholder:y("SendMessageTo"),searchInputId:"new-group-picker-search",isLoading:o,isSearchable:!0,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox",withDefaultPadding:!0,onSelectedIdsChange:m,onFilterChange:p}),n.Ay.createElement(ka.A,{isShown:!0,onClick:v,ariaLabel:e?"Continue To Channel Info":"Continue To Group Info"},n.Ay.createElement(Q.A,{name:"arrow-right"}))))})),uh=(0,n.ph)((0,s.EK)(e=>{const{progress:t,error:a}=(0,c.nTw)(e).chatCreation||{};return{creationProgress:t,creationError:a,maxGroupSize:e.config?.maxGroupSize}})(({isChannel:e,isActive:t,memberIds:a,maxGroupSize:i,creationProgress:o,creationError:c,onReset:d})=>{const{createGroupChat:m,createChannel:u}=(0,s.ko)(),A=(0,B.A)();(0,Ee.A)({isActive:t,onBack:d});const[h,y]=(0,n.J0)(""),[p,g]=(0,n.J0)(""),[v,E]=(0,n.J0)(),[f,b]=(0,n.J0)(),C="Chat title can't be empty",S="Channel title can't be empty",k=o===r.n7.InProgress;(0,n.vJ)(()=>{if(e)return;if(!a.length||a.length>4)return void y("");const t=(0,s.mS)(),n=t.users.byId,r=[t.currentUserId,...a].map(e=>(0,l.u0)(n[e])).filter(Boolean),i=r.slice(0,-1).join(", ")+A("CreateGroup.PeersTitleLastDelimeter")+r[r.length-1];y(i)},[e,a,A]);const w=(0,n.hb)(e=>{const{value:t}=e.currentTarget,a=t.replace(/^\s+/,"");y(a),a!==t&&(e.currentTarget.value=a)},[]),N=(0,n.hb)(e=>{g(e.currentTarget.value)},[]),I=(0,n.hb)(()=>{h.length?i&&a.length>=i?b("Sorry, creating supergroups is not yet supported"):m({title:h,photo:v,memberIds:a}):b(C)},[h,a,i,m,v]),P=(0,n.hb)(()=>{h.length?u({title:h,about:p,photo:v,memberIds:a,isChannel:!0}):b(S)},[h,u,p,v,a,S]);(0,n.vJ)(()=>{o===r.n7.Complete&&d(!0)},[o,d]);const M=c&&A(c)||(f!==C&&f!==S?f:void 0);return n.Ay.createElement("div",{className:"NewChat"},n.Ay.createElement("div",{className:"left-header"},n.Ay.createElement(Y.A,{round:!0,size:"smaller",color:"translucent",onClick:()=>d(),ariaLabel:"Return to member selection"},n.Ay.createElement(Q.A,{name:"arrow-left"})),n.Ay.createElement("h3",null,A(e?"NewChannel":"NewGroup"))),n.Ay.createElement("div",{className:"NewChat-inner step-2"},n.Ay.createElement(bu.A,{onChange:E,title:A("AddPhoto")}),n.Ay.createElement(Z.A,{value:h,onChange:w,label:A(e?"EnterChannelName":"GroupName"),error:f===C||f===S?f:void 0}),e&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(Z.A,{value:p,onChange:N,label:A("DescriptionOptionalPlaceholder")}),n.Ay.createElement("p",{className:"note"},A("DescriptionInfo"))),M&&n.Ay.createElement("p",{className:"error"},M),a.length>0&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("h3",{className:"chat-members-heading"},A("GroupInfo.ParticipantCount",a.length,"i")),n.Ay.createElement("div",{className:"chat-members-list custom-scroll"},a.map(e=>n.Ay.createElement(ca.A,{inactive:!0,className:"chat-item-clickable"},n.Ay.createElement(kn.A,{userId:e})))))),n.Ay.createElement(ka.A,{isShown:0!==h.length,onClick:e?P:I,disabled:k,ariaLabel:e?A("ChannelIntro.CreateChannel"):"Create Group"},k?n.Ay.createElement(Ve.A,{color:"white"}):n.Ay.createElement(Q.A,{name:"arrow-right"})))})),Ah=Object.keys(r.Bn).length/2,hh=(0,n.ph)(({isActive:e,isChannel:t=!1,content:a,animationLevel:i,onReset:o})=>{const{openLeftColumnContent:l,setGlobalSearchQuery:c}=(0,s.ko)(),[d,m]=(0,n.J0)([]),u=(0,n.hb)(()=>{l({contentKey:t?r.Bn.NewChannelStep2:r.Bn.NewGroupStep2})},[t]),A=(0,x.A)(e=>{const t=e.length>d.length;m(e),t&&c({query:""})});return n.Ay.createElement(ne.Ay,{id:"NewChat",name:(0,Oc.P)("layers",i),renderCount:Ah,activeKey:a},s=>{switch(a){case r.Bn.NewChannelStep1:case r.Bn.NewGroupStep1:return n.Ay.createElement(mh,{isChannel:t,isActive:e,selectedMemberIds:d,onSelectedMemberIdsChange:A,onNextStep:u,onReset:o});case r.Bn.NewChannelStep2:case r.Bn.NewGroupStep2:return n.Ay.createElement(uh,{isChannel:t,isActive:s&&e,memberIds:d,onReset:o});default:return}})});var yh=a(34458),ph=a(11462),gh=a(24920),vh=a(75343),Eh=a(40175),fh=a(9740),bh=a(90054);const Ch=(0,n.ph)(({isActive:e,isForumPanelOpen:t,archiveSettings:a,isStoryRibbonShown:r,onReset:o,onTopicSearch:l,foldersDispatch:c})=>{const{updateArchiveSettings:d}=(0,s.ko)(),m=(0,B.A)();(0,Ee.A)({isActive:e,onBack:o});const u=(0,x.A)(()=>{d({isHidden:!1})}),{shouldDisableDropdownMenuTransitionRef:A,handleDropdownMenuTransitionEnd:h}=(0,gh.A)(t),{shouldRender:y,transitionClassNames:p}=(0,Ke.A)(!t,void 0,void 0,!1),{shouldRenderForumPanel:g,handleForumPanelAnimationEnd:v,handleForumPanelAnimationStart:E,isAnimationStarted:f}=(0,ph.A)(t),b=t&&f,{shouldRender:C,transitionClassNames:S,isClosing:k}=(0,Ke.A)(r,void 0,void 0,"",!1,yh.UG+i.xB5);return n.Ay.createElement("div",{className:"ArchivedChats"},n.Ay.createElement("div",{className:(0,ue.A)("left-header",!C&&"left-header-shadow")},m.isRtl&&n.Ay.createElement("div",{className:"DropdownMenuFiller"}),n.Ay.createElement(Y.A,{round:!0,size:"smaller",color:"translucent",onClick:o,ariaLabel:"Return to chat list",className:(0,ue.A)(m.isRtl&&"rtl",b&&m.isRtl&&"right-aligned",A.current&&m.isRtl&&"disable-transition"),onTransitionEnd:h},n.Ay.createElement(Q.A,{name:"arrow-left"})),y&&n.Ay.createElement("h3",{className:p},m("ArchivedChats")),n.Ay.createElement("div",{className:"story-toggler-wrapper"},n.Ay.createElement(Eh.A,{canShow:!0,isArchived:!0})),a.isHidden&&n.Ay.createElement(le.A,{className:"archived-chats-more-menu",positionX:"right",onTransitionEnd:m.isRtl?h:void 0},n.Ay.createElement(ce.A,{icon:"archive-from-main",onClick:u},m("lng_context_archive_to_list")))),n.Ay.createElement("div",{className:(0,ue.A)("chat-list-wrapper",C&&"with-story-ribbon",S)},C&&n.Ay.createElement(vh.A,{isArchived:!0,className:"left-header-shadow",isClosing:k}),n.Ay.createElement(fh.A,{folderType:"archived",isActive:e,isForumPanelOpen:b,isMainList:!0,foldersDispatch:c,archiveSettings:a})),g&&n.Ay.createElement(bh.A,{isOpen:t,onTopicSearch:l,onOpenAnimationStart:E,onCloseAnimationEnd:v}))}),Sh=(0,n.ph)((0,s.EK)(e=>{const{byId:t,orderedIds:a}=e.chatFolders;return{foldersById:t,folderOrderedIds:a}})(({isOpen:e,chatId:t,foldersById:a,folderOrderedIds:r,onClose:o,onCloseAnimationEnd:l})=>{const{editChatFolders:c}=(0,s.ko)(),d=(0,B.A)(),m=(0,n.Kr)(()=>a?Object.keys(a).reduce((e,n)=>{const{includedChatIds:s,pinnedChatIds:r}=a[Number(n)];return(s.includes(t)||r?.includes(t))&&e.push(n),e},[]):[],[t,a]),[u,A]=(0,n.J0)(m),h=(0,n.Kr)(()=>r?.filter(e=>e!==i.DSF).map(e=>{const t=a?a[e]:void 0;return{label:t?(0,Xa.fd)({text:t.title.text,entities:t.title.entities,noCustomEmojiPlayback:t.noTitleAnimations}):"",value:String(e)}})||[],[r,a]),y=(0,n.hb)(()=>{const e=m.filter(e=>!u.includes(e)).map(Number),a=u.filter(e=>!m.includes(e)).map(Number);c({chatId:t,idsToRemove:e,idsToAdd:a}),o()},[t,c,m,o,u]);if(a&&r)return n.Ay.createElement(X.A,{isOpen:e,onClose:o,onCloseAnimationEnd:l,onEnter:y,className:(0,ue.A)("_fJBBCCE","delete"),contentClassName:"EG5lPWY1",title:d("FilterAddTo")},n.Ay.createElement("div",{className:(0,ue.A)("heYMHiUt","custom-scroll")},n.Ay.createElement(vc.A,{options:h,selected:u,onChange:A})),n.Ay.createElement("div",{className:"_jtqAaUU"},n.Ay.createElement("div",{className:"dialog-buttons"},n.Ay.createElement(Y.A,{color:"primary",className:"confirm-dialog-button",isText:!0,onClick:y},d("FilterAddTo")),n.Ay.createElement(Y.A,{className:"confirm-dialog-button",isText:!0,onClick:o},d("Cancel")))))}));var kh=function(e){return e.OneHour="3600",e.FourHours="14400",e.EightHours="28800",e.OneDay="86400",e.ThreeDays="259200",e.Forever="-1",e}(kh||{});const wh=(0,n.ph)(({isOpen:e,chatId:t,topicId:a,onClose:r,onCloseAnimationEnd:o})=>{const[l,c]=(0,n.J0)(kh.Forever),{updateChatMutedState:d,updateTopicMutedState:m}=(0,s.ko)(),u=(0,B.A)(),A=(0,n.Kr)(()=>[{label:u("MuteFor.Hours",1),value:kh.OneHour},{label:u("MuteFor.Hours",4),value:kh.FourHours},{label:u("MuteFor.Hours",8),value:kh.EightHours},{label:u("MuteFor.Days",1),value:kh.OneDay},{label:u("MuteFor.Days",3),value:kh.ThreeDays},{label:u("MuteFor.Forever"),value:kh.Forever}],[u]),h=(0,n.hb)(()=>{let e;e=l===kh.Forever?i.fRl:Math.floor(Date.now()/1e3)+Number(l),a?m({chatId:t,topicId:a,mutedUntil:e}):d({chatId:t,mutedUntil:e}),r()},[t,l,r,a]);return n.Ay.createElement(X.A,{isOpen:e,onClose:r,onCloseAnimationEnd:o,onEnter:h,className:"delete",title:u("Notifications")},n.Ay.createElement(ee.A,{className:"dialog-checkbox-group",name:"muteFor",options:A,selected:l,onChange:c}),n.Ay.createElement("div",{className:"dialog-buttons"},n.Ay.createElement(Y.A,{color:"primary",className:"confirm-dialog-button",isText:!0,onClick:h},u("Common.Done")),n.Ay.createElement(Y.A,{className:"confirm-dialog-button",isText:!0,onClick:r},u("Cancel"))))});var Nh=a(99515),Ih=a(24531);const Ph=(0,n.ph)((0,s.EK)((e,{fromSticker:t,stickerSetShortName:a})=>{const n=(0,c.Xf0)(e),{chatId:s,threadId:r}=n||{},i=s&&(0,c.hds)(e,s),o=s?(0,c.AWZ)(e,s):void 0,d=s&&(0,c.yps)(e,s),m=s?(0,c.nZ4)(e,s):void 0,u=i?(0,l.Q_)(i,o,Boolean(d),m):void 0,A=s&&r?(0,c.Vw0)(e,s,r):void 0,h=Boolean(!A?.isCommentsInfo&&A?.fromChannelId),y=s&&r?(0,c.S0q)(e,s,r):void 0,p=Boolean(i&&r&&(0,l.__)(i,y,h,o)&&u?.canSendStickers),g=t?t.stickerSetInfo:a?{shortName:a}:void 0,v=g?(0,c.ycM)(e,g):void 0,E=s?(0,c.WA9)(e,s):void 0;return{canScheduleUntilOnline:Boolean(s)&&(0,c.RBq)(e,s),canSendStickers:p,isSavedMessages:m,shouldSchedule:!E&&(0,c.PIP)(e),stickerSet:v,isCurrentUserPremium:(0,c.g29)(e),shouldUpdateStickerSetOrder:e.settings.byKey.shouldUpdateStickerSetOrder,currentMessageList:n}})(({isOpen:e,fromSticker:t,stickerSetShortName:a,stickerSet:r,canSendStickers:o,canScheduleUntilOnline:l,shouldSchedule:c,isSavedMessages:d,isCurrentUserPremium:m,shouldUpdateStickerSetOrder:u,currentMessageList:A,onClose:h})=>{const{loadStickers:y,toggleStickerSet:p,sendMessage:g,showNotification:v}=(0,s.ko)(),E=(0,n.li)(),f=(0,n.li)(),b=(0,B.A)(),{isMobile:C}=(0,I.Ay)(),S=(0,U.A)(r),k=r||S,w=Boolean(!k?.isArchived&&k?.installedDate),N=k?.isEmoji,[P,M]=(0,Ih.A)(l),{handleScroll:T,isAtBeginning:x}=En(),{observe:L}=(0,io.BL)({rootRef:E,throttleMs:200,isDisabled:!e});(0,n.vJ)(()=>{e&&!k?.stickers&&y({stickerSetInfo:t?t.stickerSetInfo:{shortName:a}})},[e,t,y,a,k]);const R=(0,n.hb)((e,t,a)=>{A&&(e={...e,isPreloadedGlobally:!0},c||a?P(a=>{g({messageList:A,sticker:e,isSilent:t,scheduledAt:a}),h()}):(g({messageList:A,sticker:e,isSilent:t,shouldUpdateStickerSetOrder:u&&w}),h()))},[A,c,P,h,u,w]),F=(0,n.hb)(()=>{k&&(p({stickerSetId:k.id}),h())},[h,k,p]),D=(0,n.hb)(()=>{if(!k)return;const{shortName:e}=k,t=N?"addemoji":"addstickers",a=`${i.jsp}${t}/${e}`;(0,Dc.eM)(a),v({message:b("LinkCopied")})},[N,b,k,v]),V=(0,n.Kr)(()=>({onTrigger:e,isOpen:t})=>n.Ay.createElement(Y.A,{round:!0,ripple:!C,size:"smaller",color:"translucent",className:t?"active":"",onClick:e,ariaLabel:"More actions"},n.Ay.createElement(Q.A,{name:"more"})),[C]);return n.Ay.createElement(X.A,{className:(0,ue.A)("StickerSetModal",N&&"custom-emoji"),isOpen:e,onClose:h,header:function(){const e=(0,ue.A)("modal-header",!x&&"with-top-border");return n.Ay.createElement("div",{className:e,dir:b.isRtl?"rtl":void 0},n.Ay.createElement(Y.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:b("Close"),onClick:h},n.Ay.createElement(Q.A,{name:"close"})),n.Ay.createElement("div",{className:"modal-title"},k?(0,Tt.A)(k.title,["emoji","links"]):b("AccDescrStickerSet")),n.Ay.createElement(le.A,{className:"stickers-more-menu with-menu-transitions",trigger:V,positionX:"right"},n.Ay.createElement(ce.A,{icon:"copy",onClick:D},b("StickersCopy"))))}()},k?.stickers?n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{ref:E,className:"stickers custom-scroll",onScroll:T},n.Ay.createElement("div",{className:"shared-canvas-container stickers-grid"},n.Ay.createElement("canvas",{ref:f,className:"shared-canvas"}),k.stickers.map(e=>n.Ay.createElement(fo,{sticker:e,size:N?i.$nk:i.GhT,observeIntersection:L,onClick:o&&!N?R:void 0,clickArg:e,isSavedMessages:d,isCurrentUserPremium:m,sharedCanvasRef:f})))),n.Ay.createElement("div",{className:"button-wrapper"},n.Ay.createElement(Y.A,{size:"smaller",fluid:!0,color:w?"danger":"primary",onClick:F},(()=>{if(!k)return b("Loading");const e=N?"Emoji":"Sticker";return b(w?`StickerPack.Remove${e}Count`:`StickerPack.Add${e}Count`,k.count,"i")})()))):n.Ay.createElement(Dn.A,null),M)})),Mh={root:"nZYT4vJ3",sets:"JzkmXjFF"},Th=(0,n.ph)((0,s.EK)(e=>({canPlayAnimatedEmojis:(0,c.BWX)(e)}))(({customEmojiSetIds:e,canPlayAnimatedEmojis:t,onClose:a})=>{const{openStickerSet:r}=(0,s.ko)(),i=(0,B.A)(),o=(0,n.Kr)(()=>e?.map(e=>(0,s.mS)().stickers.setsById[e]),[e]),l=(0,n.li)(),{observe:c}=(0,io.BL)({rootRef:l,isDisabled:!o}),d=(0,U.A)(o),m=o||d,u=(0,x.A)(e=>{r({stickerSetInfo:e.stickerSetInfo})});return n.Ay.createElement(X.A,{isOpen:Boolean(o),className:Mh.root,onClose:a,hasCloseButton:!0,title:i("lng_custom_emoji_used_sets")},n.Ay.createElement("div",{className:(0,ue.A)(Mh.sets,"custom-scroll"),ref:l,teactFastList:!0},m?.map(e=>n.Ay.createElement(cu,{key:e.id,className:Mh.setCard,stickerSet:e,onClick:u,observeIntersection:c,noPlay:!t}))))}));var xh=a(54314),Bh=a(60859);const Lh={settings:{icon:"bots",label:"BotSettings"},help:{icon:"help",label:"BotHelp"}},Rh=(0,n.ph)((0,s.EK)((e,{chatId:t,threadId:a})=>{const n=(0,c.hds)(e,t),s=(0,c._ls)(e,t);if(!n||s)return{};const r=(0,A.L8)(n.id),i=r?(0,c.mBe)(e,t):void 0,o=i&&(0,l.Gh)(i),d=a===J.l3,m=(0,c.nZ4)(e,t),{chatId:u,threadId:h}=(0,c.Xf0)(e)||{},y=d&&!i&&((0,l.WX)(n)||(0,l.YE)(n))&&!(0,l.SJ)(n),p=(0,l.DX)(t)?void 0:(0,c.yps)(e,t),g=r?(0,c.vGo)(e,t):void 0,v=r?void 0:(0,c.AWZ)(e,t),E=g||v,f=(0,c.X2D)(e,t),b=(0,c.S0q)(e,t,a),C=n.isForum&&(n.isCreator||!(0,l.Sq)(n,"manageTopics")||(0,l.ub)(n,"manageTopics")),S=b&&(0,l.l1)(n,b),k=(0,c.e5V)(e,t),w=(0,c.jGY)(e,t)&&E?.isTranslationDisabled,N=(0,l.cG)(t,a,e.currentUserId)?(0,c.hds)(e,String(a)):void 0,I=(0,c.trm)(e);return{chat:n,isMuted:(0,Td.If)(n,(0,c.K52)(e),(0,c.P5N)(e,n.id)),isPrivate:r,isTopic:n?.isForum&&!d,isForum:n?.isForum,isForumAsMessages:n?.isForumAsMessages,canAddContact:o,canDeleteChat:(0,l.IC)(n),canReportChat:y,canGift:f,hasLinkedChat:Boolean(v?.linkedChatId),botCommands:p?g?.botInfo?.commands:void 0,botPrivacyPolicyUrl:p?g?.botInfo?.privacyPolicyUrl:void 0,isChatInfoShown:(0,c.nTw)(e).isChatInfoShown&&u===t&&h===a,canCreateTopic:C,canEditTopic:S,canManage:k,isRightColumnShown:(0,c.gjV)(e),canTranslate:w,isBlocked:g?.isBlocked,isBot:Boolean(p),isChatWithSelf:m,savedDialog:N,disallowedGifts:g?.disallowedGifts,isAccountFrozen:I}})(({chatId:e,threadId:t,isOpen:a,withExtraActions:r,anchor:i,isChannel:o,botCommands:l,botPrivacyPolicyUrl:c,withForumActions:d,isTopic:m,isForum:u,isForumAsMessages:A,isChatInfoShown:h,canStartBot:y,canSubscribe:p,canReportChat:g,canSearch:v,canCall:E,canMute:f,canViewStatistics:b,canViewMonetization:C,canViewBoosts:S,pendingJoinRequests:k,canLeave:w,canEnterVoiceChat:N,canCreateVoiceChat:P,chat:T,isPrivate:L,isMuted:R,canDeleteChat:F,canGift:D,hasLinkedChat:V,canAddContact:_,canCreateTopic:U,canEditTopic:O,canManage:J,isRightColumnShown:K,canTranslate:G,isBlocked:j,isBot:z,isChatWithSelf:H,savedDialog:$,canShowBoostModal:q,disallowedGifts:W,isAccountFrozen:Q,channelMonoforumId:Y,onJoinRequestsClick:Z,onSubscribeChannel:X,onSearchClick:ee,onAsMessagesClick:te,onClose:ae,onCloseAnimationEnd:ne})=>{const{updateChatMutedState:se,enterMessageSelectMode:re,sendBotCommand:ie,restartBot:oe,requestMasterAndJoinGroupCall:le,createGroupCall:de,openLinkedChat:me,openAddContactDialog:ue,openFrozenAccountModal:Ae,requestMasterAndRequestCall:he,toggleStatistics:ye,openMonetizationStatistics:pe,openBoostStatistics:ge,openGiftModal:ve,openThreadWithInfo:Ee,openCreateTopicPanel:fe,openEditTopicPanel:be,openChat:Ce,openUrl:Se,toggleManagement:ke,togglePeerTranslations:we,blockUser:Ne,unblockUser:Ie,setViewForumAsMessages:Pe,openBoostModal:Me,reportMessages:Te,showNotification:xe}=(0,s.ko)(),Be=(0,B.A)(),Le=(0,Ua.A)(),{isMobile:Re}=(0,I.Ay)(),[Fe,De]=(0,n.J0)(!0),[Ve,_e]=(0,n.J0)(!1),[Ue,Oe]=(0,n.J0)(!1),[Je,Ge]=(0,n.J0)(!1),[je,ze,He]=(0,M.A)(),{x:$e,y:qe}=i;(0,Ke.A)(a,ne,void 0,!1);const Qe=(0,Ya.A)(!(h||!u)||void 0,200),Ye=(0,n.Kr)(()=>{if(W)return Object.values(W).every(Boolean)},[W]),Ze=(0,x.A)(()=>{Ge(!1),ae()}),Xe=(0,x.A)(()=>{Q?Ae():(De(!1),Te({chatId:e,messageIds:[]})),ae()}),et=(0,x.A)(()=>{Q?(Ae(),ae()):Oe(!0),De(!1)}),tt=(0,x.A)(()=>{De(!1),ae()}),at=(0,x.A)(()=>{Ee({chatId:e,threadId:t}),_e(!K),tt()}),nt=(0,x.A)(()=>{Oe(!1),ae()}),st=(0,x.A)(()=>{Q?Ae():ie({command:"/start"})}),rt=(0,x.A)(()=>{Q?Ae():oe({chatId:e})}),it=(0,x.A)(()=>{Q?Ae():se({chatId:e,isMuted:!1}),tt()}),ot=(0,x.A)(()=>{Q?(Ae(),tt()):(ze(),Ge(!0)),De(!1)}),lt=(0,x.A)(()=>{Q?Ae():(fe({chatId:e}),_e(!K)),tt()}),ct=(0,x.A)(()=>{Q?Ae():(ke({force:!0}),_e(!K)),tt()}),dt=(0,x.A)(()=>{Q?Ae():(be({chatId:e,topicId:Number(t)}),_e(!K)),tt()}),mt=(0,x.A)(()=>{Ce({id:void 0}),Pe({chatId:e,isEnabled:!1}),tt()}),ut=(0,x.A)(()=>{Q?Ae():P?de({chatId:e}):le({chatId:e}),tt()}),At=(0,x.A)(()=>{me({id:e}),tt()}),ht=(0,x.A)(()=>{Ye&&T?xe({message:Le("SendDisallowError")}):(ve({forUserId:e}),Q?Ae():ve({forUserId:e}),tt())}),yt=(0,x.A)(()=>{Q?Ae():ue({userId:e}),tt()}),pt=(0,x.A)(()=>{Q?Ae():X(),tt()}),gt=(0,x.A)(()=>{Q?Ae():he({userId:e,isVideo:!0}),tt()}),vt=(0,x.A)(()=>{Q?Ae():he({userId:e}),tt()}),Et=(0,x.A)(()=>{ee(),tt()}),ft=(0,x.A)(()=>{ye(),_e(!K),tt()}),bt=(0,x.A)(()=>{pe({chatId:e}),_e(!K),tt()}),Ct=(0,x.A)(()=>{Q?Ae():S?(ge({chatId:e}),_e(!K)):Me({chatId:e}),tt()}),St=(0,x.A)(()=>{we({chatId:e,isEnabled:!0}),tt()}),kt=(0,x.A)(()=>{Q?Ae():re(),tt()}),wt=(0,x.A)(()=>{te(),tt()}),Nt=(0,x.A)(()=>{Q?Ae():Ne({userId:e}),tt()}),It=(0,x.A)(()=>{Q?Ae():Ie({userId:e}),tt()}),Pt=(0,x.A)(()=>{Ce({id:Y}),tt()});(0,n.vJ)(Ba.M6,[]);const Mt=(0,n.Kr)(()=>{const e=l?.map(({command:e})=>{const t=Lh[e];if(t)return n.Ay.createElement(ce.A,{key:e,icon:t.icon,onClick:()=>{ie({command:`/${e}`}),tt()}},Be(t.label))}),t=l?.some(({command:e})=>"privacy"===e);return[...e||[],z&&n.Ay.createElement(ce.A,{icon:"privacy-policy",onClick:()=>{t&&!c?ie({command:"/privacy"}):Se({url:c||Be("BotDefaultPrivacyPolicy")}),tt()}},Be("BotPrivacyPolicy"))].filter(Boolean)},[l,Be,c,z]),Tt=(0,n.Kr)(()=>{if(T)return Be($?"Delete":L?"DeleteChatUser":F?"GroupInfo.DeleteAndExit":o?"LeaveChannel":"Group.LeaveGroup")},[F,T,o,L,$,Be]);return n.Ay.createElement(_o.A,null,n.Ay.createElement("div",{className:"HeaderMenuContainer"},n.Ay.createElement(We.A,{isOpen:Fe,positionX:"right",style:`left: ${$e}px;top: ${qe}px;`,onClose:tt,shouldCloseFast:Ve},Re&&v&&n.Ay.createElement(ce.A,{icon:"search",onClick:Et},Be("Search")),d&&U&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(ce.A,{icon:"comments",onClick:lt},Be("lng_forum_create_topic")),n.Ay.createElement(Bh.A,null)),Y&&n.Ay.createElement(ce.A,{icon:"message",onClick:Pt},Le("ChannelSendMessage")),Qe&&n.Ay.createElement(ce.A,{icon:"info",onClick:at},Be(m?"lng_context_view_topic":"lng_context_view_group")),J&&!O&&n.Ay.createElement(ce.A,{icon:"edit",onClick:ct},Be("Edit")),O&&n.Ay.createElement(ce.A,{icon:"edit",onClick:dt},Be("lng_forum_topic_edit")),Re&&!d&&u&&!m&&n.Ay.createElement(ce.A,{icon:"forums",onClick:mt},Be("Chat.ContextViewAsTopics")),d&&Boolean(k)&&n.Ay.createElement(ce.A,{icon:"user",onClick:Z},Be(o?"SubscribeRequests":"MemberRequests"),n.Ay.createElement("div",{className:"right-badge"},k)),d&&!m&&!A&&n.Ay.createElement(ce.A,{icon:"message",onClick:wt},Be("lng_forum_view_as_messages")),r&&y&&n.Ay.createElement(ce.A,{icon:"bots",onClick:st},Be("BotStart")),r&&p&&n.Ay.createElement(ce.A,{icon:o?"channel":"group",onClick:pt},Be(o?"ProfileJoinChannel":"ProfileJoinGroup")),q&&!S&&n.Ay.createElement(ce.A,{icon:"boost-outline",onClick:Ct},Be(o?"BoostingBoostChannelMenu":"BoostingBoostGroupMenu")),_&&n.Ay.createElement(ce.A,{icon:"add-user",onClick:yt},Be("AddContact")),Re&&E&&n.Ay.createElement(ce.A,{icon:"phone",onClick:vt},Be("Call")),E&&n.Ay.createElement(ce.A,{icon:"video-outlined",onClick:gt},Be("VideoCall")),f&&(R?n.Ay.createElement(ce.A,{icon:"unmute",onClick:it},Be("ChatsUnmute")):n.Ay.createElement(ce.A,{icon:"mute",onClick:ot},Be("ChatsMute"),"...")),(N||P)&&n.Ay.createElement(ce.A,{icon:"voice-chat",onClick:ut},Be(P?"StartVoipChat":"VoipGroupJoinCall")),V&&n.Ay.createElement(ce.A,{icon:o?"comments":"channel",onClick:At},Be(o?"ViewDiscussion":"lng_profile_view_channel")),!d&&n.Ay.createElement(ce.A,{icon:"select",onClick:kt},Be("ReportSelectMessages")),S&&n.Ay.createElement(ce.A,{icon:"boost-outline",onClick:Ct},Be("Boosts")),b&&n.Ay.createElement(ce.A,{icon:"stats",onClick:ft},Be("Statistics")),o&&C&&n.Ay.createElement(ce.A,{icon:"cash-circle",onClick:bt},Be("lng_channel_earn_title")),G&&n.Ay.createElement(ce.A,{icon:"language",onClick:St},Be("lng_context_translate")),g&&n.Ay.createElement(ce.A,{icon:"flag",onClick:Xe},Be("ReportPeer.Report")),Mt,D&&n.Ay.createElement(ce.A,{icon:"gift",onClick:ht},Be("ProfileSendAGift")),z&&n.Ay.createElement(ce.A,{icon:j?"bots":"hand-stop",onClick:j?rt:Nt},Be(j?"BotRestart":"Bot.Stop")),L&&!H&&!z&&n.Ay.createElement(ce.A,{icon:j?"user":"hand-stop",onClick:j?It:Nt},Be(j?"Unblock":"BlockUser")),w&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(Bh.A,null),n.Ay.createElement(ce.A,{destructive:!0,icon:"delete",onClick:et},Tt))),T&&n.Ay.createElement(xh.A,{isOpen:Ue,onClose:nt,chat:$||T,isSavedDialog:Boolean($)}),f&&je&&T?.id&&n.Ay.createElement(Rd.A,{isOpen:Je,onClose:Ze,onCloseAnimationEnd:He,chatId:T.id})))}));var Fh=a(92915),Dh=a(81642),Vh=a(18653);const _h={root:"vv5ppXel",active:"FVgqrSSK",info:"DboxqiZd",topRow:"Ymu2m1PR",meta:"A2rsvUBm",subtitle:"qUzmwaIn"},Uh=(0,n.ph)(({isActive:e,message:t,senderPeer:a,messageChat:s,shouldShowChat:r,query:i,className:o,onClick:l})=>{const c=(0,B.A)(),d=t.forwardInfo?.hiddenUserName,m=r?s:a,u=r&&a?(0,Mt.Q5)(c,t.chatId,a):void 0,A=(0,x.A)(()=>{l(t)});return n.Ay.createElement("div",{role:"button",tabIndex:0,className:(0,ue.A)(_h.root,e&&_h.active,o),onClick:A},n.Ay.createElement(xt.A,{className:_h.avatar,peer:m,text:d,size:"medium"}),n.Ay.createElement("div",{className:_h.info},n.Ay.createElement("div",{className:_h.topRow},m&&n.Ay.createElement(Vn.A,{peer:m,withEmojiStatus:!0})||d,n.Ay.createElement(Dh.A,{className:_h.meta,message:t})),n.Ay.createElement("div",{className:_h.subtitle,dir:"auto"},u&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("span",{className:"sender-name"},(0,Tt.A)(u)),n.Ay.createElement("span",{className:"colon"},":")),n.Ay.createElement(Vh.A,{message:t,highlight:i,truncateLength:200}))))}),Oh={root:"FTMljUuX",header:"OvmjSMwA",active:"DEIUzXQd",avatar:"mp1PmoMq",input:"z2K8Q7ib",mobile:"u0fb78AA",focused:"dqF8dYNx",withDropdown:"AqhBggrp",adaptSearchBorders:"Q9RZQaTu",dropdown:"MFGvbICO",dropdownHidden:"Alee0CKy",results:"RtfTOE72",placeholder:"O1HoZFge",separator:"_Yy43QLl",savedTags:"BcvAfv1E",wrap:"JkESCST6",searchTags:"rO3pH3LI",savedSearchTag:"qA4gov4D",hash:"q5NOmUAM",searchTypes:"rVYZG__K",searchType:"nE1Xwoo7",selectedType:"i29dP8iT",footer:"jyS1l9yn","keyboard-visible":"ao05jKHW",keyboardVisible:"ao05jKHW",counter:"NmmL_cO3",mobileNavigation:"dLO1hlHU",navigationButton:"Z4vLAlsu",navigationDisabled:"IqA7R2xO",jumpIn:"n9kXbTu6"},Jh={isCustomPeer:!0,avatarIcon:"channel-filled",titleKey:"SearchPublicPosts"},Kh="MiddleSearchResult",Gh=(0,ye.sg)(e=>e(),200,!1),jh=(0,n.ph)((0,s.EK)(e=>{const t=(0,c.Xf0)(e);if(!t)return{};const{chatId:a,threadId:n}=t,s=(0,c.hds)(e,a);if(!s)return{};const{requestedQuery:r,savedTag:i,results:o,fetchingQuery:d,isHashtag:m,type:u}=(0,c.TCk)(e)||{},{totalCount:A,foundIds:h,query:y}=o||{},p=e.currentUserId,g=(0,c.nZ4)(e,a),v=(0,l.cG)(a,n,p),E=g&&!v?e.savedReactionTags?.byKey:void 0;return{chat:s,monoforumChat:(0,c.k2W)(e,a),requestedQuery:r,totalCount:A,threadId:n,foundIds:h,isHistoryCalendarOpen:Boolean((0,c.nTw)(e).historyCalendarSelectedAt),savedTags:E,savedTag:i,isCurrentUserPremium:(0,c.g29)(e),isSavedMessages:g,fetchingQuery:d,isHashtagQuery:m,currentUserId:p,searchType:u,lastSearchQuery:y}})(({isActive:e,chat:t,monoforumChat:a,threadId:r,requestedQuery:d,savedTags:u,savedTag:A,totalCount:h,lastSearchQuery:y,foundIds:p,isHistoryCalendarOpen:g,isCurrentUserPremium:v,isSavedMessages:f,fetchingQuery:b,isHashtagQuery:C,searchType:S="chat",currentUserId:k})=>{const{updateMiddleSearch:w,resetMiddleSearch:N,performMiddleSearch:P,focusMessage:T,closeMiddleSearch:L,openHistoryCalendar:R,openPremiumModal:F,loadSavedReactionTags:D}=(0,s.ko)(),V=(0,n.li)(),_=(0,n.li)(),U=(0,n.li)(),O=(0,n.li)(!1),{isMobile:J}=(0,I.Ay)(),K=(0,B.A)(),G=(0,Ua.A)(),[j,z]=(0,n.J0)(d||""),[H,$]=(0,n.J0)(0),q=p&&H>0,W=p&&H<p.length-1,[Z,X]=(0,n.J0)(!e),ee=(0,n.li)(),te=(0,n.li)(!0),[ae,ne,se]=(0,M.A)(),[re,ie]=(0,n.J0)(!0),[oe,le]=(0,n.J0)(!1);!function(e,t){const a=(0,x.A)(a=>{e.every(e=>e.current&&!e.current.contains(a.target))&&t(a)});(0,n.vJ)(()=>(document.addEventListener("click",a),()=>{document.removeEventListener("click",a)}),[a])}([V],(0,x.A)(e=>{te.current||e.target.closest(".Modal")||se()}));const ce=Boolean(j&&p||C),de=C&&!j,me=Boolean(j&&p&&!p.length&&!oe&&!de),Ae=e&&(re||!J)&&(ae||"myChats"===S||"channels"===S)&&Boolean(ce||me||de||u),he=Boolean(j&&!de||A),pe="chat"===S&&Boolean(p?.length),ge=(0,x.A)(()=>{L()}),ve=(0,x.A)(()=>{(0,o.YS)(()=>{_.current?.focus()})}),fe=(0,x.A)(()=>{_.current?.blur()});(0,n.vJ)(()=>{const{visualViewport:e}=window;if(!e)return;const t=document.getElementById("Main"),a=()=>{const{activeElement:a}=document;if(a&&a===_.current){const{pageTop:a,height:n}=e;(0,o.RK)(()=>{t.style.transform=`translateY(${a}px)`,t.style.height=`${n}px`,document.documentElement.scrollTop=a})}else(0,o.RK)(()=>{t.style.transform="",t.style.height=""})};return e.addEventListener("resize",a),()=>{e.removeEventListener("resize",a)}},[]),(0,n.vJ)(()=>{$(-1)},[y]),(0,n.Nf)(()=>{E.pz&&Array.from(document.querySelectorAll("input")).forEach(t=>{t.disabled=Boolean(e&&t!==_.current)})},[e]),(0,n.vJ)(()=>{e?(X(!1),clearTimeout(ee.current)):(_.current.blur(),ie(!0),$(0),z(""),ee.current=window.setTimeout(()=>X(!0),200))},[e]),(0,n.vJ)(()=>{d&&t?.id&&(z(d),w({chatId:t.id,threadId:r,update:{requestedQuery:void 0}}),le(!0),(0,o.Uz)(()=>{const e=_.current;e&&((0,xa.A)(e,!0,!0),ne())}))},[t?.id,d,r]),(0,Sa.A)(([t])=>{e!==t&&!j&&y&&z(y)},[e,y,j]),(0,Sa.A)(([t])=>{e&&t!==g&&(g?(fe(),se()):ve())},[g,e]);const be=(0,x.A)(()=>{j?.length||A?(z(""),le(!1),N(),ve()):ge()});(0,n.vJ)(()=>e?(0,m.A)(be):void 0,[e,ge]);const Ce=(0,n.Kr)(()=>{if(u)return Object.values(u)},[u]),Se=Boolean(Ce?.length),ke=Se&&!v;(0,n.vJ)(()=>{f&&e&&D()},[f,e]);const we=(0,x.A)(()=>{const e=t?.id;e&&Gh(()=>{O.current||P({chatId:e,threadId:r,query:j})})}),Ne=(0,x.A)(e=>{if(O.current=!1,e.startsWith("#")&&!C)return w({chatId:t.id,threadId:r,update:{isHashtag:!0}}),z(e.slice(1)),void we();z(e),e||(le(!1),N(),O.current=!0)});(0,n.vJ)(()=>{j&&we()},[j]),(0,n.vJ)(()=>{le(Boolean(b))},[b]),(0,n.vJ)(()=>{p?.length&&p.length-H<5&&we()},[H,p?.length]),(0,n.vJ)(()=>{if(e)return te.current=!0,window.addEventListener("touchend",t),window.addEventListener("mouseup",t),window.addEventListener("touchstart",a),window.addEventListener("mousedown",a),()=>{a(),window.removeEventListener("touchstart",a),window.removeEventListener("mousedown",a)};function t(){_.current?.focus(),ne(),(0,ye.IJ)(()=>{te.current=!1})}function a(){window.removeEventListener("touchend",t),window.removeEventListener("mouseup",t),(0,ye.IJ)(()=>{te.current=!1})}},[e]),(0,Ee.A)({isActive:e,onBack:ge});const[Ie,Pe,Me=0]=(0,Ln.A)(we,p),Te=(0,n.Kr)(()=>{if(!j&&!A||!Ie?.length)return fa.p;const e=(0,s.mS)();return Ie.map(t=>{const[a,n]=(0,Sd.a)(t),s=(0,c.O5q)(e,a,n);if(!s)return;const r=f||(0,l.DX)(a)||a===i.Ckz?(0,c.Szq)(e,s):void 0,o=(0,c.Y7C)(e,s);return{searchResultKey:t,message:s,messageChat:(0,c.hds)(e,s.chatId),senderPeer:r||o}}).filter(Boolean)},[j,A,Ie,f]),xe=(0,x.A)(e=>{const t=(0,Sd.D)(e),a=p?.indexOf(t)||0;$(a+Me),"chat"===S&&ie(!1),T({chatId:e.chatId,messageId:e.id,threadId:C?void 0:r}),se()}),Be=(0,x.A)(()=>{ie(e=>!e),ne()}),Le=(0,Fn.A)(U,ce,e=>{const t=Te?.[-1===e?0:e];t&&(xe(t.message),$(e+Me))},`.${Kh}`,!0),Re=(0,x.A)(e=>{w({chatId:t.id,threadId:r,update:e}),we()}),Fe=(0,x.A)(e=>{ke?F({initialSection:"saved_tags"}):Re({savedTag:e})}),De=(0,x.A)(()=>{Re({savedTag:void 0})}),Ve=(0,x.A)(()=>{C?Re({isHashtag:!1}):A&&De()}),_e=(0,x.A)(e=>{Re({type:e}),ie(!0)}),Ue=(0,x.A)(()=>{if("chat"===S&&(se(),fe(),p)){const e=H+1,[t,a]=(0,Sd.a)(p[e]);T({chatId:t,messageId:a,threadId:r}),$(e)}}),Oe=(0,x.A)(()=>{if("chat"===S&&(se(),fe(),p)){const e=H-1,[t,a]=(0,Sd.a)(p[e]);T({chatId:t,messageId:a,threadId:r}),$(e)}});function Je(e,a){const s=!a&&S===e;switch(e){case"chat":return n.Ay.createElement(Oo.A,{className:(0,ue.A)(Oh.searchType,s&&Oh.selectedType),peerId:t?.id,title:K("SearchThisChat"),clickArg:"chat",onClick:a?Ve:_e});case"myChats":return n.Ay.createElement(Oo.A,{className:(0,ue.A)(Oh.searchType,s&&Oh.selectedType),peerId:k,forceShowSelf:!0,title:K("SearchMyMessages"),clickArg:"myChats",onClick:a?Ve:_e});case"channels":return n.Ay.createElement(Oo.A,{className:(0,ue.A)(Oh.searchType,s&&Oh.selectedType),customPeer:Jh,title:K("SearchPublicPosts"),clickArg:"channels",onClick:a?Ve:_e})}}function Ke(){return n.Ay.createElement("div",{className:(0,ue.A)(Oh.dropdown,!Ae&&Oh.dropdownHidden)},!J&&n.Ay.createElement("div",{className:Oh.separator}),Se&&!C&&n.Ay.createElement("div",{className:(0,ue.A)(Oh.savedTags,!J&&Oh.wrap,"no-scrollbar")},Ce.map(e=>{const t=(0,l.a0)(e.reaction,A);return n.Ay.createElement(Fh.A,{containerId:"local-search",key:(0,l.Jj)(e.reaction),reaction:e.reaction,tag:e,withCount:!0,isDisabled:ke,isChosen:t,onClick:t?De:Fe})})),C&&n.Ay.createElement("div",{className:(0,ue.A)(Oh.searchTypes,"no-scrollbar")},Je("chat"),Je("myChats"),Je("channels")),ce&&n.Ay.createElement(fn.A,{ref:U,className:(0,ue.A)(Oh.results,"custom-scroll"),items:Te,itemSelector:`.${Kh}`,preloadBackwards:0,onLoadMore:Pe,onKeyDown:Le},me&&n.Ay.createElement("span",{key:"nothing",className:Oh.placeholder},K("NoResultFoundFor",j)),de&&n.Ay.createElement("span",{key:"enterhash",className:Oh.placeholder},K("HashtagSearchPlaceholder")),Te?.map(({message:e,senderPeer:t,messageChat:a,searchResultKey:s},r)=>n.Ay.createElement(Uh,{key:s,teactOrderKey:-e.date,className:Kh,query:j,message:e,senderPeer:t,messageChat:a,shouldShowChat:C,isActive:H-Me===r,onClick:xe}))))}return n.Ay.createElement("div",{id:"MiddleSearch",className:(0,ue.A)(Oh.root,e&&Oh.active,!e&&Z&&"visually-hidden",ae&&Oh.focused,J&&Oh.mobile),ref:V},n.Ay.createElement("div",{className:Oh.header},!J&&n.Ay.createElement(xt.A,{className:Oh.avatar,peer:a||t,size:"medium",isSavedMessages:f}),n.Ay.createElement(Cn.A,{ref:_,value:j,className:(0,ue.A)(Oh.input,Ae&&Oh.withDropdown,Ae&&!J&&Oh.adaptSearchBorders),canClose:!J,isLoading:oe,resultsItemSelector:`.${Oh.results} .${Kh}`,hasUpButton:pe&&!J,hasDownButton:pe&&!J,placeholder:K(C?"SearchHashtagsHint":"Search"),onChange:Ne,onStartBackspace:Ve,onReset:be,withBackIcon:J,onFocus:ne,focused:ae,onUpClick:W?Ue:void 0,onDownClick:q?Oe:void 0},n.Ay.createElement("div",{className:Oh.searchTags},A&&n.Ay.createElement(Fh.A,{containerId:"local-search-tags",className:Oh.savedSearchTag,reaction:A,tag:u[(0,l.Jj)(A)],onClick:De}),C&&n.Ay.createElement("div",{className:Oh.hash},"#")),!J&&Ke()),!J&&n.Ay.createElement("div",{className:Oh.icons},n.Ay.createElement(Y.A,{round:!0,size:"smaller",color:"translucent",onClick:()=>R({selectedAt:(0,$e.CS)(Date.now())}),ariaLabel:K("JumpToDate")},n.Ay.createElement(Q.A,{name:"calendar"})))),J&&Ke(),J&&n.Ay.createElement("div",{className:Oh.footer},n.Ay.createElement(Y.A,{round:!0,size:"smaller",color:"translucent",onClick:()=>R({selectedAt:(0,$e.CS)(Date.now())}),ariaLabel:K("JumpToDate")},n.Ay.createElement(Q.A,{name:"calendar"})),n.Ay.createElement("div",{className:Oh.counter},he&&(p?.length?K("Of",[Math.max(H+1,1),h]):p&&!p.length&&K("NoResult"))),"chat"===S&&Boolean(p?.length)&&n.Ay.createElement(Y.A,{className:Oh.viewStyle,size:"smaller",isText:!0,fluid:!0,noForcedUpperCase:!0,onClick:Be},K(re?"SearchAsChat":"SearchAsList")),pe&&!Ae&&n.Ay.createElement("div",{className:Oh.mobileNavigation},n.Ay.createElement(Y.A,{className:(0,ue.A)(Oh.navigationButton,!W&&Oh.navigationDisabled),round:!0,size:"smaller",color:"secondary",onClick:Ue,nonInteractive:!W,ariaLabel:G("AriaSearchOlderResult")},n.Ay.createElement(Q.A,{name:"up"})),n.Ay.createElement(Y.A,{className:(0,ue.A)(Oh.navigationButton,!q&&Oh.navigationDisabled),round:!0,size:"smaller",color:"secondary",onClick:Oe,nonInteractive:!q,ariaLabel:G("AriaSearchNewerResult")},n.Ay.createElement(Q.A,{name:"down"})))))}));var zh=a(80539),Hh=a(58734),$h=a(73172);const qh=2.5*h.$,Wh=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const{setsById:a,added:n,recent:s,favorite:r,effect:i}=e.stickers,o=(0,c.nZ4)(e,t),l=(0,c.hds)(e,t),d=(0,A.L8)(t)?void 0:(0,c.AWZ)(e,t)?.stickerSet?.id;return{chat:l,effectStickers:i?.stickers,effectEmojis:i?.emojis,recentStickers:s.stickers,favoriteStickers:r.stickers,stickerSetsById:a,addedSetIds:n.setIds,canAnimate:(0,c.ML4)(e),isSavedMessages:o,isCurrentUserPremium:(0,c.g29)(e),chatStickerSetId:d}})(({chat:e,threadId:t,className:a,isHidden:r,isTranslucent:o,loadAndPlay:l,canSendStickers:c,recentStickers:d,favoriteStickers:m,effectStickers:u,effectEmojis:A,addedSetIds:h,stickerSetsById:y,chatStickerSetId:p,canAnimate:g,isSavedMessages:v,isCurrentUserPremium:f,noContextMenus:b,idPrefix:C,onStickerSelect:S,isForEffects:k})=>{const{loadRecentStickers:w,addRecentSticker:N,unfaveSticker:I,faveSticker:P,removeRecentSticker:M}=(0,s.ko)(),T=(0,n.li)(),L=(0,n.li)(),R=(0,n.li)(),{handleScroll:F,isAtBeginning:D}=En(),V=(0,$h.A)(e?.id,t),_=`${C}-sticker-set`,{activeSetIndex:U,observeIntersectionForSet:O,observeIntersectionForPlayingItems:J,observeIntersectionForShowingItems:K,observeIntersectionForCovers:G,selectStickerSet:j}=co(T,L,_,r),z=(0,B.A)(),H=Boolean(h),$=(0,n.Kr)(()=>{if(k&&u){const e=[];return A?.length&&e.push({id:i.hfH,accessHash:"0",title:"",stickers:A,count:A.length,isEmoji:!0}),u?.length&&e.push({id:i.Kp3,accessHash:"0",title:z("StickerEffects"),stickers:u,count:u.length}),e}if(!h)return fa.p;const e=[];m.length&&e.push({id:i.tRH,accessHash:"0",title:z("FavoriteStickers"),stickers:m,count:m.length}),d.length&&e.push({id:i.sR2,accessHash:"0",title:z("RecentStickers"),stickers:d,count:d.length});const t=[...h||[]];p&&t.unshift(p);const a=Object.values((0,Ea._E)(y,t));return[...e,...a]},[h,y,m,d,p,z,u,k,A]),q=(0,n.Kr)(()=>H&&0===$.filter(e=>e.stickers?.length).length,[$,H]);(0,n.vJ)(()=>{l&&(w(),c&&V({type:"chooseSticker"}))},[c,l,w,V]);const W=(0,so.A)([],i.jhd),Z=H&&W&&!q&&(c||k);(0,ks.A)(L,!Z||!L.current),(0,n.vJ)(()=>{if(!H)return;const e=L.current;if(!e)return;const t=U*qh-(e.offsetWidth/2-qh/2);(0,vr.A)(e,t)},[H,U]);const X=(0,x.A)((e,t,a)=>{S(e,t,a,!0),N({sticker:e})}),ee=(0,x.A)(e=>{I({sticker:e})}),te=(0,x.A)(e=>{P({sticker:e})}),ae=(0,x.A)(()=>{c&&V({type:"chooseSticker"})}),se=(0,x.A)(e=>{M({sticker:e})});if(!e)return;const re=(0,ue.A)("lq8BD6Hc",a),ie=(0,ue.A)(To,"no-scrollbar",!D&&xo),oe=!Z&&(c||k)&&!q;return n.Ay.createElement(ne.Ay,{className:re,activeKey:oe?0:1,name:"fade",shouldCleanup:!0},Z?n.Ay.createElement(n.Ay.Fragment,null,!k&&n.Ay.createElement("div",{ref:L,className:ie},n.Ay.createElement("div",{className:"shared-canvas-container"},n.Ay.createElement("canvas",{ref:R,className:"shared-canvas"}),$.map(function(t,a){const s=t.stickers?.[0],r=(0,ue.A)(Bo,a===U&&"y02WwQk6"),c=a<i.j41;return t.id===i.sR2||t.id===i.tRH||t.id===i.eKB||t.hasThumbnail||!s?n.Ay.createElement(Y.A,{key:t.id,className:r,ariaLabel:t.title,round:!0,faded:t.id===i.sR2||t.id===i.tRH,color:"translucent",onClick:()=>j(a)},t.id===i.sR2?n.Ay.createElement(Q.A,{name:"recent"}):t.id===i.tRH?n.Ay.createElement(Q.A,{name:"favorite"}):t.id===i.eKB?n.Ay.createElement(xt.A,{peer:e,size:"small"}):n.Ay.createElement(yo,{stickerSet:t,noPlay:!g||!l,observeIntersection:G,sharedCanvasRef:c?R:void 0,forcePlayback:!0})):n.Ay.createElement(fo,{key:t.id,sticker:s,size:i.TBj,title:t.title,className:r,noPlay:!g||!l,observeIntersection:G,noContextMenu:!0,isCurrentUserPremium:!0,sharedCanvasRef:c?R:void 0,withTranslucentThumb:o,onClick:j,clickArg:a,forcePlayback:!0})}))),n.Ay.createElement("div",{ref:T,onMouseMove:ae,onScroll:F,className:(0,ue.A)(Po,E.TF?"no-scrollbar":"custom-scroll",!k&&Mo)},$.map((e,t)=>n.Ay.createElement(No,{key:e.id,stickerSet:e,loadAndPlay:Boolean(g&&l),noContextMenus:b,index:t,idPrefix:_,observeIntersection:O,observeIntersectionForPlayingItems:J,observeIntersectionForShowingItems:K,isNearActive:U>=t-1&&U<=t+1,favoriteStickers:m,isSavedMessages:v,isCurrentUserPremium:f,isTranslucent:o,isChatStickerSet:e.id===p,onStickerSelect:X,onStickerUnfave:ee,onStickerFave:te,onStickerRemoveRecent:se,forcePlayback:!0,shouldHideHeader:e.id===i.hfH})))):c||k?q?n.Ay.createElement("div",{className:Lo},z("NoStickers")):n.Ay.createElement(Dn.A,null):n.Ay.createElement("div",{className:Lo},z("ErrorSendRestrictedStickersAll")))})),Qh=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const{availableReactions:a,topReactions:n}=e.reactions,{maxUniqueReactions:s}=e.appConfig||{},{enabledReactions:r,isPaidReactionAvailable:i}=(0,c.AWZ)(e,t)||{};return{enabledReactions:r,availableReactions:a,topReactions:n,reactionsLimit:s,isWithPaidReaction:i}})(({loadAndPlay:e,enabledReactions:t,availableReactions:a,topReactions:s,selectedReactionIds:r,isWithPaidReaction:i,message:o,reactionsLimit:c,onReactionSelect:d,onReactionContext:m})=>{const u=(0,n.li)(),A=(0,n.li)(),{width:y}=(0,Se.A)(),{isTouchScreen:p}=(0,I.Ay)(),g=o?.reactions?.results,v=c&&g&&g.length>=c,E=(0,n.Kr)(()=>{if(v){const e=g.map(({reaction:e})=>e);return i&&e.unshift({type:"paid"}),e}if(!t)return[];if("all"===t.type){const e=(a||[]).map(({reaction:e})=>e);return i&&e.unshift({type:"paid"}),(0,l.fu)(e,s)}const e=t.allowed.slice();return i&&e.unshift({type:"paid"}),(0,l.fu)(e,s)},[a,t,s,v,g,i]),f=(0,n.Kr)(()=>{const e=Math.min(26.25*h.$,y),t=(y>600?.625:.5)*h.$,a=e-.5*h.$,n=Math.floor((a+t)/(36+t)),s=Math.ceil(E.length/n),r=36*s+(s-1)*t+.5*h.$*2;return Math.min(18*h.$,r)},[E.length,y]);return n.Ay.createElement("div",{className:"MhpiTAwi",style:`height: ${f}px`},n.Ay.createElement("div",{className:(0,ue.A)("NIaqmosK",p?"no-scrollbar":"custom-scroll")},n.Ay.createElement("div",{className:"symbol-set-container shared-canvas-container"},n.Ay.createElement("canvas",{ref:u,className:"shared-canvas"}),n.Ay.createElement("canvas",{ref:A,className:"shared-canvas"}),E.map(t=>{const s=(0,l.Jj)(t),i=s?r?.includes(s):void 0;return n.Ay.createElement(ko,{key:s,reaction:t,isSelected:i,loadAndPlay:e,availableReactions:a,onClick:d,onContextMenu:m,sharedCanvasRef:u,sharedCanvasHqRef:A})}))))})),Yh=16.375*h.$,Zh=(0,n.ph)((0,s.EK)(e=>{const t=(0,c.nTw)(e),a=e.availableEffectById,{chatId:n,messageId:s,storyPeerId:r,storyId:i,position:o,sendAsMessage:l,isForEffects:d}=t.reactionPicker||{},m=r&&i?(0,c.Msb)(e,r,i):void 0,u=n?(0,c.hds)(e,n):void 0,h=n?(0,c.AWZ)(e,n):void 0,y=n&&s?(0,c.O5q)(e,n,s):void 0,p=(0,A.L8)(n||r||""),g="some"===h?.enabledReactions?.type,{maxUniqueReactions:v}=e.appConfig||{},E="all"===h?.enabledReactions?.type&&h?.enabledReactions?.areCustomAllowed,f=y?.reactions?.results,b=Boolean(v&&f&&f.length>=v);return{message:y,story:m,position:o,shouldUseFullPicker:!(u?.isForbidden||g||b)&&(E||p),isTranslucent:(0,c.cwE)(e),isCurrentUserPremium:(0,c.g29)(e),sendAsMessage:l,isForEffects:d,chatId:n,availableEffectById:a}})(({isOpen:e,message:t,story:a,position:r,isTranslucent:i,isCurrentUserPremium:o,shouldUseFullPicker:c,sendAsMessage:d,chatId:m,isForEffects:u,availableEffectById:A})=>{const{toggleReaction:h,closeReactionPicker:y,sendMessage:p,showNotification:g,sendStoryReaction:v,saveEffectInDraft:E,requestEffectInComposer:f,addLocalPaidReaction:b,openPaidReactionModal:C}=(0,s.ko)(),S=(0,B.A)(),k=(0,La.A)(t?.id,!0),w=(0,La.A)(t?.chatId,!0),N=(0,La.A)(a?.peerId,!0),P=(0,La.A)(a?.id),M=(0,La.A)(r,!0),T=(0,n.li)(),L=(0,n.Kr)(()=>{if(M)return P?M:{x:M.x+(c?-23:-21),y:M.y+(c?-64:-10)}},[P,M,c]),R=(0,x.A)(()=>T.current),F=(0,x.A)(()=>({withPortal:!0,isDense:!N,deltaX:!(0,I.Ny)()&&T.current?-(T.current.offsetWidth-Yh)/2- -11.5:0})),D=(0,x.A)(e=>{if(!w||!k)return;const t=e.isCustomEmoji?{type:"custom",documentId:e.id}:{type:"emoji",emoticon:e.emoji};h({chatId:w,messageId:k,reaction:t,shouldAddToRecent:!0}),y()}),V=(0,x.A)(e=>{w&&k&&("paid"===e.type?b({chatId:w,messageId:k,count:1}):h({chatId:w,messageId:k,reaction:e,shouldAddToRecent:!0}),y())}),_=(0,x.A)(e=>{"paid"===e.type&&(C({chatId:w,messageId:k}),y())}),U=(0,x.A)(e=>{if("type"in e&&"paid"===e.type)return;const t="id"in e?{type:"custom",documentId:e.id}:e,a="type"in e&&"custom"===e.type?(0,s.mS)().customEmojis.byId[e.documentId]:"id"in e?e:void 0;if(a&&!a.isFree&&!o)return g({message:S("UnlockPremiumEmojiHint"),action:{action:"openPremiumModal",payload:{initialSection:"animated_emoji"}},actionText:S("PremiumMore")}),void y();if(!d)return v({peerId:N,storyId:P,containerId:(0,l.$_)(N,P),reaction:t,shouldAddToRecent:!0}),void y();let n,r;if("type"in e&&"emoji"===e.type)n=e.emoticon;else{const e=(0,zh.Ay)((0,Hh.hB)(a));n=e.text,r=e.entities}p({text:n,entities:r,isReaction:!0}),y()}),O=(0,x.A)(e=>{const t=Object.values(A),a=t.find(t=>t.effectStickerId===e.id)?.id;m&&E({chatId:m,threadId:J.l3,effectId:a}),a&&f({}),y()}),K=(0,n.Kr)(()=>(t?.reactions?.results||[]).reduce((e,{chosenOrder:t,reaction:a})=>(void 0!==t&&e.push((0,l.Jj)(a)),e),[]),[t?.reactions?.results]);return n.Ay.createElement(We.A,{isOpen:e,ref:T,className:(0,ue.A)("gBh4WvBC","ReactionPicker"),bubbleClassName:(0,ue.A)("qSfKwMzX",!c&&!P&&"dRNSqkOC",P&&"srpBMrqr"),withPortal:!0,noCompact:!0,anchor:L,positionY:a&&"bottom",getTriggerElement:Xh,getRootElement:ey,getMenuElement:R,getLayout:F,backdropExcludedSelector:".Modal.confirm",onClose:y},u&&m?n.Ay.createElement(Wh,{className:"",isHidden:!e,loadAndPlay:Boolean(e&&c),idPrefix:"message-effect",canSendStickers:!1,noContextMenus:!1,chatId:m,isTranslucent:i,onStickerSelect:O,isForEffects:u}):n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(Vo,{chatId:w,idPrefix:"message-emoji-set-",isHidden:!e||!(c||P),loadAndPlay:Boolean(e&&c),isReactionPicker:!0,className:c||P?void 0:"KVwgF6DG",selectedReactionIds:K,isTranslucent:i,onCustomEmojiSelect:P?U:D,onReactionSelect:P?U:V,onReactionContext:_}),!c&&Boolean(w)&&n.Ay.createElement(Qh,{chatId:w,loadAndPlay:e,onReactionSelect:P?U:V,onReactionContext:_,selectedReactionIds:K,message:t})))}));function Xh(){return document.querySelector("body")}function ey(){return document.querySelector("body")}var ty=a(39074),ay=a(45761);const ny=document.createElement("div");var sy=a(41316),ry=a(3225),iy=a(25498),oy=a(9442),ly=a(91525),cy=a(52988),dy=a(27860);const my="SHoF85Vw",uy="Zo7u5epf",Ay=15*h.$,hy=(0,n.ph)(({attachment:e,className:t,isSingle:a,shouldDisplayCompressed:s,shouldDisplayGrouped:r,index:o,onDelete:l,onToggleSpoiler:c})=>{const d=function(e,t){if(t&&e.quick){if(i.gex.has(e.mimeType))return"photo";if(i.fNs.has(e.mimeType))return"video"}return"file"}(e,s),m=(0,x.A)(()=>{c?.(o)}),u=(0,n.Kr)(()=>{switch(d){case"photo":return n.Ay.createElement("img",{className:my,src:e.blobUrl,alt:"",draggable:!1});case"video":return n.Ay.createElement(n.Ay.Fragment,null,Boolean(e.quick?.duration)&&n.Ay.createElement("div",{className:"nI2M1SBH"},(0,$e.QO)(e.quick.duration)),n.Ay.createElement("video",{className:my,src:e.blobUrl,autoPlay:!0,muted:!0,loop:!0,disablePictureInPicture:!0}));default:return n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(cy.A,{className:"B6f6GcvN",name:e.filename,extension:(0,ly.QC)(e.filename,e.mimeType),previewData:e.previewBlobUrl,size:e.size,smaller:!0}),l&&n.Ay.createElement(Q.A,{name:"delete",className:(0,ue.A)(uy,"CYJwy9T_"),onClick:()=>l(o)}))}},[e,d,o,l]),A="file"===d||!r,h=Boolean("file"!==d&&e.shouldSendAsSpoiler),y="file"!==d,p=(0,ue.A)(t,"QucaiGVU",a&&"FjrnqGba",A&&"g0cTsM9d");return n.Ay.createElement("div",{className:p},u,n.Ay.createElement(dy.A,{isVisible:h,thumbDataUri:e.previewBlobUrl||e.blobUrl,width:Ay,height:Ay}),y&&n.Ay.createElement("div",{className:"bX7LdgxW"},n.Ay.createElement(Q.A,{name:e.shouldSendAsSpoiler?"spoiler-disable":"spoiler",className:uy,onClick:m}),l&&n.Ay.createElement(Q.A,{name:"delete",className:uy,onClick:()=>l(o)})))});var yy=a(25897),py=a(6070),gy=a(49068);function vy(e,t,a=!1){const n=e[a?"scrollLeft":"scrollTop"],s=n+e[a?"offsetWidth":"offsetHeight"],r=t[a?"offsetLeft":"offsetTop"],i=r+t[a?"offsetWidth":"offsetHeight"];return r>n&&i<s}function Ey(e,t,a=0,n=!1,s=!1,r=!1){const i=e[r?"scrollLeft":"scrollTop"],o=i+e[r?"offsetWidth":"offsetHeight"],l="string"==typeof t?e.querySelectorAll(t):t,{length:c}=l,d=[];let m=!1;for(let e=0;e<c;e++){const t=l[e],c=t[r?"offsetLeft":"offsetTop"],u=c+t[r?"offsetWidth":"offsetHeight"];if(s?u>=i-a&&u<=o+a:c<=o+a&&u>=i-a)d.push(e),m=!0;else if(m&&!n)break}return{allElements:l,visibleIndexes:d}}function fy(e,t,a){const n=a.current;if(!n||t<0)return;const{visibleIndexes:s,allElements:r}=Ey(n,e,8,!0,!0);if(!r.length||!r[t])return;const i=s[0];if(!s.includes(t)||t===i&&!vy(n,r[i])){const e=t>s[s.length-1]?"start":"end";(0,ro.Ay)({container:n,element:r[t],position:e,margin:10})}}function by({isActive:e,isHorizontal:t,shouldSaveSelectionOnUpdateItems:a,shouldRemoveSelectionOnReset:s,noArrowNavigation:r,items:i,shouldSelectOnTab:o,onSelect:l,onClose:c}){const[d,m]=(0,n.J0)(-1),u=(0,x.A)(e=>i?(0,Ir.A)(i.length,e):-1),A=(0,x.A)((e,t)=>{t.preventDefault(),m(t=>u(t+e))}),h=(0,x.A)(t=>{if(t.altKey||t.ctrlKey||t.metaKey||t.shiftKey)return!1;if(!e)return!1;if(i&&i.length&&d>-1){const e=i[d];if(e){if(!1===l(e))return!1;t.preventDefault()}}return!0});(0,n.vJ)(()=>{e||m(s?-1:0)},[e,s]);const y=!i||d>i.length-1;return(0,n.vJ)(()=>{a&&!y||m(s?-1:0)},[y,s,a]),(0,n.vJ)(()=>e?(0,Ra.A)({onEsc:c,onUp:r||t?void 0:e=>A(-1,e),onDown:r||t?void 0:e=>A(1,e),onLeft:r||!t?void 0:e=>A(-1,e),onRight:r||!t?void 0:e=>A(1,e),onTab:o?h:void 0,onEnter:h}):void 0,[r,A,h,e,t,c,o]),d}const Cy=(0,n.ph)(({isOpen:e,onClose:t,onInsertUserName:a,filteredUsers:r})=>{const i=(0,n.li)(),{shouldRender:o,transitionClassNames:l}=(0,Ke.A)(e,void 0,void 0,!1),c=(0,x.A)((e,t=!1)=>{const n=(0,s.mS)().users.byId[e];n&&a(n,t)}),d=(0,x.A)((e,t)=>{e.preventDefault(),c(t)}),m=(0,x.A)(e=>{c(e.id,!0)}),u=by({isActive:e,items:r,onSelect:m,shouldSelectOnTab:!0,shouldSaveSelectionOnUpdateItems:!0,onClose:t});(0,n.vJ)(()=>{fy(".chat-item-clickable",u,i)},[u]),(0,n.vJ)(()=>{r&&!r.length&&t()},[r,t]);const A=(0,U.A)(r?.length?r:void 0,o),h=r&&!r.length?A:r;if(!o||h&&!h.length)return;const y=(0,ue.A)("MentionTooltip composer-tooltip custom-scroll",l);return n.Ay.createElement("div",{className:y,ref:i},h?.map(({id:e},t)=>n.Ay.createElement(ca.A,{key:e,className:"chat-item-clickable scroll-item smaller-icon",onClick:d,clickArg:e,focus:u===t},n.Ay.createElement(kn.A,{userId:e,avatarSize:"small",withUsername:!0}))))});var Sy=a(60474),ky=a(26440);const wy="AT_d9l0W",Ny="AnO3BgVv",Iy="caption-input-text",Py=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const{currentUserId:a,recentEmojis:n,customEmojis:s,attachmentSettings:r}=e,o=(0,c.AWZ)(e,t),l=(0,c.nZ4)(e,t),{shouldSuggestCustomEmoji:d}=e.settings.byKey,{language:m}=(0,hs.l)(e),u=e.emojiKeywords[i.cUY],A=m!==i.cUY?e.emojiKeywords[m]:void 0;return{isChatWithSelf:l,currentUserId:a,groupChatMembers:o?.members,recentEmojis:n,baseEmojiKeywords:u?.keywords,emojiKeywords:A?.keywords,shouldSuggestCustomEmoji:d,customEmojiForEmoji:s.forEmoji.stickers,captionLimit:(0,dr.d)(e,"captionLength"),attachmentSettings:r}})(({chatId:e,threadId:t,attachments:a,getHtml:r,editingMessage:c,canShowCustomSendMenu:d,captionLimit:u,isReady:A,isChatWithSelf:h,currentUserId:y,groupChatMembers:p,recentEmojis:g,baseEmojiKeywords:v,emojiKeywords:E,isForMessage:f,shouldSchedule:b,shouldSuggestCustomEmoji:C,customEmojiForEmoji:S,attachmentSettings:k,shouldForceCompression:w,shouldForceAsFile:N,isForCurrentMessageList:P,forceDarkTheme:T,onAttachmentsUpdate:L,onCaptionUpdate:R,onSend:F,onFileAppend:D,onClear:V,onSendSilent:_,onSendScheduled:O,onCustomEmojiSelect:J,onRemoveSymbol:K,onEmojiSelect:j,canScheduleUntilOnline:z,canSchedule:H,onSendWhenOnline:$,paidMessagesStars:q})=>{const W=(0,n.li)(),Z=(0,n.li)(),{addRecentCustomEmoji:ee,addRecentEmoji:te,updateAttachmentSettings:ae}=(0,s.ko)(),ne=(0,B.A)(),se=(0,Ua.A)(),re=(0,n.li)(),ie=(0,n.li)(),oe=(0,n.li)(),de=(0,U.A)(a),me=a.length?a:de,{isMobile:Ae}=(0,I.Ay)(),he=c&&Boolean(c),ye=c&&c?.groupedId,pe="file"!==(he&&a?.length&&(0,l.ES)(a[0])),[ge,Ee,be]=(0,M.A)(),Ce=k.shouldCompress,Se=Boolean((Ce||w||ye)&&!N),[ke,we]=(0,n.J0)(k.shouldSendGrouped),Ne=k.isInvertedMedia,[Ie,Pe]=(0,n.J0)(k.shouldSendInHighQuality),[Me,Te]=(0,n.J0)(Ie),{handleScroll:xe,isAtBeginning:Be,isAtEnd:Le}=En(),{handleScroll:Re,isAtBeginning:Fe}=En(),De=Boolean(a.length),Ve=Boolean(me?.length),[_e,Ue,Oe]=(0,M.A)(),Je=(0,n.li)();(0,n.vJ)(()=>{De||(be(),ae({isInvertedMedia:void 0}))},[be,De]);const[Ke,Ge]=(0,n.Kr)(()=>Boolean(me?.every(e=>e.quick||e.audio))?[!0,!0]:[Boolean(me?.some(e=>e.quick||e.audio)),!1],[me]),[je,ze]=(0,n.Kr)(()=>Boolean(me?.every(e=>e.shouldSendAsSpoiler))?[!0,!0]:[Boolean(me?.some(e=>e.shouldSendAsSpoiler)),!1],[me]),He=(0,sy.A)(`#${i.e0F}`),{isEmojiTooltipOpen:$e,filteredEmojis:qe,filteredCustomEmojis:We,insertEmoji:Qe,closeEmojiTooltip:Ye}=(0,iy.A)(Boolean(A&&(P||!f)&&Ve),r,R,i.e0F,g,v,E),{isCustomEmojiTooltipOpen:Ze,insertCustomEmoji:Xe,closeCustomEmojiTooltip:et}=(0,ry.A)(Boolean(A&&(P||!f)&&Ve&&C),r,R,He,ie,S),{isMentionTooltipOpen:tt,closeMentionTooltip:at,insertMention:nt,mentionFilteredUsers:st}=(0,oy.A)(Boolean(A&&P&&Ve),r,R,He,ie,p,void 0,y);function rt(e){ae({isInvertedMedia:e})}(0,n.vJ)(()=>De?(0,m.A)(V):void 0,[De,V]),(0,n.vJ)(()=>{De&&(we(k.shouldSendGrouped),Pe(k.shouldSendInHighQuality))},[k,De]),(0,n.vJ)(()=>{De||ae({isInvertedMedia:void 0})},[ae,De]),(0,n.vJ)(()=>{De&&Ae&&(0,ty.DY)()},[Ae,De]);const{isContextMenuOpen:it,handleContextMenu:ot,handleContextMenuClose:lt,handleContextMenuHide:ct}=(0,vs.A)(re,!d||!De),dt=(0,x.A)((e,t)=>{De&&(((b||t)&&f&&!c?O:e?_:F)(Se,ke,Ne),ae({shouldCompress:Se,shouldSendGrouped:ke,isInvertedMedia:Ne,shouldSendInHighQuality:Ie}))}),mt=(0,x.A)(()=>{dt(!0)}),ut=(0,x.A)(()=>{dt()}),At=(0,x.A)(()=>{dt(!1,!0)}),ht=(0,x.A)(async e=>{e.preventDefault(),Oe();const{dataTransfer:t}=e,a=await(0,ay.A)(t.items);a?.length&&D(a,ze)}),yt=(0,x.A)(e=>{const{files:t}=e.target,a=(0,G.kc)(t);a?.length&&D(a,ze)}),pt=(0,x.A)(()=>{(0,xu.p)("*",e=>yt(e))}),gt=(0,x.A)(e=>{L(a.filter((t,a)=>a!==e))}),vt=(0,x.A)(()=>{L(a.map(e=>({...e,shouldSendAsSpoiler:!0})))}),Et=(0,x.A)(()=>{ae({shouldCompress:!Ce})}),ft=(0,x.A)(()=>{const e=!Ie;Pe(e),ae({shouldSendInHighQuality:e})}),bt=(0,x.A)(()=>{L(a.map(e=>({...e,shouldSendAsSpoiler:void 0})))}),Ct=(0,x.A)(e=>{L(a.map((t,a)=>a===e?{...t,shouldSendAsSpoiler:!t.shouldSendAsSpoiler||void 0}:t))}),St=(0,x.A)(()=>{const e=Z.current;if(!e)return;const{width:t,height:a}=e.getBoundingClientRect();e.viewBox.baseVal.width=t,e.viewBox.baseVal.height=a});(0,bo.A)(W,St),(0,fe.A)(St),(0,n.vJ)(()=>{const e=re.current,t=document.getElementById(Iy);if(!e||!t)return;const{width:a}=e.getBoundingClientRect();(0,o.RK)(()=>{t.style.setProperty("--margin-for-scrollbar",`${a}px`)})},[ne,De]);const kt=(0,n.Kr)(()=>({onTrigger:e,isOpen:t})=>n.Ay.createElement(Y.A,{round:!0,ripple:!Ae,size:"smaller",color:"translucent",className:t?"active":"",onClick:e,ariaLabel:"More actions"},n.Ay.createElement(Q.A,{name:"more"})),[Ae]),wt=(0,ve.A)(()=>{if(!Ve)return;const e=u-(t=r(),ny.innerHTML=t,(0,zh.g4)(ny),ny.querySelectorAll("br").forEach(e=>{e.replaceWith("\n")}),ny.textContent?.trim().length||0);var t;return e<=100?e:void 0},[u,r,Ve]),Nt=Se&&Ge,[It,Pt,Mt,Tt]=(0,n.Kr)(()=>Nt&&me?[me.every(e=>i.gex.has(e.mimeType)),me.every(e=>i.fNs.has(e.mimeType)),me.every(e=>i.IH3.has(e.mimeType)),me.some(e=>i.gex.has(e.mimeType))]:[!1,!1,!1],[me,Nt]),xt=(0,n.Kr)(()=>!!me&&me.some(e=>!i.IH3.has(e.mimeType)),[me]);if((0,n.vJ)(()=>{if(Ie!==Me)return Je.current&&clearTimeout(Je.current),Je.current=window.setTimeout(()=>{Te(Ie)},200),()=>{Je.current&&(clearTimeout(Je.current),Je.current=void 0)}},[Ie,Me]),!me)return;const Bt=me.length>1,Lt=!(he||!Ke||!(N||w||Se)||Bt&&ke);let Rt="";const Ft=me.length;Rt=ne(It?he?"EditMessageReplacePhoto":"PreviewSender.SendPhoto":Pt?he?"EditMessageReplaceVideo":"PreviewSender.SendVideo":Mt?he?"EditMessageReplaceAudio":"PreviewSender.SendAudio":he?"EditMessageReplaceFile":"PreviewSender.SendFile",Ft,"i");const Dt=!Le||!Fe,Vt=q?(0,Da.U2)(se,Ft*q,{className:"C1OOt81o",asFont:!0}):ne("Send");return n.Ay.createElement(X.A,{isOpen:De,onClose:V,header:function(){if(me)return n.Ay.createElement("div",{className:"modal-header-condensed",dir:ne.isRtl?"rtl":void 0},n.Ay.createElement(Y.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:"Cancel attachments",onClick:V},n.Ay.createElement(Q.A,{name:"close"})),n.Ay.createElement("div",{className:"modal-title"},Rt),pe&&!ye&&n.Ay.createElement(le.A,{className:"attachmeneditingMessaget-modal-more-menu with-menu-transitions",trigger:kt,positionX:"right"},Boolean(!c)&&n.Ay.createElement(ce.A,{icon:"add",onClick:pt},ne("Add")),Ke&&n.Ay.createElement(n.Ay.Fragment,null,Lt&&(Ne?n.Ay.createElement(ce.A,{icon:"move-caption-down",onClick:()=>rt(void 0)},se("ContextMoveTextDown")):n.Ay.createElement(ce.A,{icon:"move-caption-up",onClick:()=>rt(!0)},se("ContextMoveTextUp"))),!N&&!w&&(Se?n.Ay.createElement(ce.A,{icon:"document",onClick:Et},ne(Bt?"Attachment.SendAsFiles":"Attachment.SendAsFile")):n.Ay.createElement(ce.A,{icon:"photo",onClick:Et},Bt?"Send All as Media":"Send as Media")),Se&&!c&&Tt&&n.Ay.createElement(ce.A,{icon:Me?"sd-photo":"hd-photo",onClick:ft},se(Me?"SendInStandardQuality":"SendInHighQuality")),Se&&xt&&Boolean(!c)&&(je?n.Ay.createElement(ce.A,{icon:"spoiler-disable",onClick:bt},ne("Attachment.DisableSpoiler")):n.Ay.createElement(ce.A,{icon:"spoiler",onClick:vt},ne("Attachment.EnableSpoiler")))),Bt&&(ke?n.Ay.createElement(ce.A,{icon:"grouped-disable",onClick:()=>we(!1)},"Ungroup All Media"):n.Ay.createElement(ce.A,{icon:"grouped",onClick:()=>we(!0)},"Group All Media"))))}(),className:(0,ue.A)("a27O2Qlr",_e&&Ny,!Be&&"Pc1k8G8s",Ae&&"khvUZbGZ",ge&&"ir5kkMy1",T&&"component-theme-dark"),noBackdropClose:!0,isLowStackPriority:!0},n.Ay.createElement("div",{className:wy,onDragEnter:Ue,onDrop:ht,onDragOver:function(e){e.preventDefault(),oe.current&&(window.clearTimeout(oe.current),oe.current=void 0)},onDragLeave:e=>{const{relatedTarget:t,target:a}=e;a.matches(`.${wy}`)&&!t&&(oe.current=window.setTimeout(Oe,150)),a&&a.closest(`.${Ny}`)||(t&&e.stopPropagation(),Oe())},onClick:Oe,"data-attach-description":ne("Preview.Dragging.AddItems",10),"data-dropzone":!0},n.Ay.createElement("svg",{className:"d9O65j_I"},n.Ay.createElement("rect",{className:"jzCBDWMw",x:"0",y:"0",width:"100%",height:"100%",rx:"8"})),n.Ay.createElement("div",{className:(0,ue.A)("_bxSIFgj","custom-scroll",Dt&&"RPVunBe2"),onScroll:xe},me.map((e,t)=>n.Ay.createElement(hy,{attachment:e,shouldDisplayCompressed:Se,shouldDisplayGrouped:ke,isSingle:1===me.length,index:t,key:e.uniqueId||t,onDelete:gt,onToggleSpoiler:Ct}))),n.Ay.createElement("div",{className:(0,ue.A)("EtmiUn2k",Dt&&"FjjSKMYe")},n.Ay.createElement(Cy,{isOpen:tt,filteredUsers:st,onInsertUserName:nt,onClose:at}),n.Ay.createElement(gy.A,{isOpen:$e,emojis:qe,customEmojis:We,addRecentEmoji:te,addRecentCustomEmoji:ee,onEmojiSelect:Qe,onCustomEmojiSelect:Qe,onClose:Ye}),n.Ay.createElement(yy.A,{chatId:e,isOpen:Ze,addRecentCustomEmoji:ee,onCustomEmojiSelect:Xe,onClose:et}),n.Ay.createElement("div",{className:"Te7lIfpB"},n.Ay.createElement(ky.A,{chatId:e,threadId:t,isMobile:Ae,isReady:A,isSymbolMenuOpen:ge,openSymbolMenu:Ee,closeSymbolMenu:be,onCustomEmojiSelect:J,onRemoveSymbol:K,onEmojiSelect:j,isAttachmentModal:!0,canSendPlainText:!0,className:"attachment-modal-symbol-menu with-menu-transitions",idPrefix:"attachment",forceDarkTheme:T}),n.Ay.createElement(Sy.A,{ref:ie,id:Iy,chatId:e,threadId:t,isAttachmentModalInput:!0,customEmojiPrefix:"attachment",isReady:A,isActive:De,getHtml:r,editableInputId:i.e0F,placeholder:ne("AddCaption"),onUpdate:R,onSend:ut,onScroll:Re,canAutoFocus:Boolean(A&&P&&a.length),captionLimit:wt,shouldSuppressFocus:Ae&&ge,onSuppressedFocus:be}),n.Ay.createElement("div",{className:"wDqWK9MD"},n.Ay.createElement(Y.A,{ref:re,className:"kNlWmBJI",size:"smaller",onClick:ut,onContextMenu:d?ot:void 0},b&&!c?ne("Next"):c?ne("Save"):Vt),d&&n.Ay.createElement(py.A,{isOpen:it,canSchedule:H&&f,onSendSilent:h?void 0:mt,onSendSchedule:At,onClose:lt,onCloseAnimationEnd:ct,isSavedMessages:h,onSendWhenOnline:$,canScheduleUntilOnline:z}))))))})),My=(0,n.ph)(({isOpen:e,isQuiz:t,shouldBeAnonymous:a,maxOptionsCount:s=12,onSend:r,onClear:i})=>{const l=(0,n.li)(),c=(0,n.li)(),[d,u]=(0,n.J0)(""),[A,h]=(0,n.J0)([""]),[y,p]=(0,n.J0)(!0),[g,v]=(0,n.J0)(!1),[E,f]=(0,n.J0)(t||!1),[b,C]=(0,n.J0)(""),[S,k]=(0,n.J0)(),[w,N]=(0,n.J0)(!1),I=(0,B.A)(),P=(0,x.A)(e=>{C(e.target.value)}),M=(0,x.A)(t=>{e&&t.current&&t.current.focus()});(0,n.vJ)(()=>e?(0,m.A)(i):void 0,[e,i]),(0,n.vJ)(()=>{e||(u(""),h([""]),p(!0),v(!1),f(t||!1),C(""),k(void 0),N(!1))},[t,e]),(0,n.vJ)(()=>M(l),[M,e]);const T=(0,x.A)((e=[])=>{h([...e,""]),(0,o.Uz)(()=>{const e=c.current;e&&(0,o.YS)(()=>{e.scrollTo({top:e.scrollHeight,behavior:"smooth"})})})}),L=(0,x.A)(()=>{if(N(!1),!e)return;const t=E&&(void 0===S||!A[S].trim()),a=A.map((e,t)=>{if(e=e.trim())return{text:{text:e},option:String(t),...t===S&&{correct:!0}}}).filter(Boolean),n=d.trim().substring(0,255);if(!n||a.length<2){if(u(n),a.length){const e=A.map(e=>e.trim().substring(0,100)).filter(Boolean);e.length<2?T(e):h(e)}else T();return void N(!0)}if(t)return void N(!0);const s={summary:{question:{text:n},answers:a,...!y&&{isPublic:!0},...g&&{multipleChoice:!0},...E&&{quiz:!0}}};if(E){const{text:e,entities:t}=b&&(0,zh.Ay)(b.substring(0,200))||{};s.quiz={correctAnswers:[String(S)],...e&&{solution:e},...t&&{solutionEntities:t}}}r(s)}),R=(0,x.A)((e,t)=>{const a=[...A];a[e]=t,a[a.length-1].trim().length&&a.length<s?T(a):h(a)}),F=(0,x.A)(e=>{const t=[...A];t.splice(e,1),h(t),void 0!==S&&(S===e?k(void 0):e<S&&k(S-1)),(0,o.Uz)(()=>{c.current&&c.current.classList.toggle("overflown",c.current.scrollHeight>320)})}),D=(0,x.A)(e=>{k(Number(e))}),V=(0,x.A)(e=>{p(e.target.checked)}),_=(0,x.A)(e=>{v(e.target.checked)}),U=(0,x.A)(e=>{f(e.target.checked)}),O=(0,x.A)(e=>{13===e.keyCode&&L()}),J=(0,x.A)(e=>{u(e.target.value)}),K=(0,x.A)(()=>{if(w&&!d.trim().length)return I("lng_polls_choose_question")}),G=(0,x.A)(e=>{const t=A.map(e=>e.trim()).filter(e=>e.length);if(w&&t.length<2&&!A[e].trim().length)return I("lng_polls_choose_answers")});function j(){return A.map((e,t)=>n.Ay.createElement("div",{className:"option-wrapper"},n.Ay.createElement(Z.A,{maxLength:100,label:t!==A.length-1||A.length===s?I("OptionHint"):I("CreatePoll.AddOption"),error:G(t),value:e,onChange:e=>R(t,e.currentTarget.value),onKeyPress:O}),t!==A.length-1&&n.Ay.createElement(Y.A,{className:"option-remove-button",round:!0,color:"translucent",size:"smaller",ariaLabel:I("Delete"),onClick:()=>F(t)},n.Ay.createElement(Q.A,{name:"close"}))))}return n.Ay.createElement(X.A,{isOpen:e,onClose:i,header:n.Ay.createElement("div",{className:"modal-header-condensed"},n.Ay.createElement(Y.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:"Cancel poll creation",onClick:i},n.Ay.createElement(Q.A,{name:"close"})),n.Ay.createElement("div",{className:"modal-title"},I("NewPoll")),n.Ay.createElement(Y.A,{color:"primary",size:"smaller",className:"modal-action-button",onClick:L},I("Create"))),className:"PollModal"},n.Ay.createElement(Z.A,{ref:l,label:I("AskAQuestion"),value:d,error:K(),onChange:J,onKeyPress:O}),n.Ay.createElement("div",{className:"options-divider"}),n.Ay.createElement("div",{className:"options-list custom-scroll",ref:c},n.Ay.createElement("h3",{className:"options-header"},I("PollOptions")),w&&function(){const e=A.map(e=>e.trim()).filter(e=>e.length);return E&&(void 0===S||!e[S])&&n.Ay.createElement("p",{className:"poll-error"},I("lng_polls_choose_correct"))}(),E?n.Ay.createElement(ee.A,{name:"correctOption",options:j().map((e,t)=>({value:String(t),label:e,hidden:!A[t].trim()})),selected:String(S),onChange:D}):j()),n.Ay.createElement("div",{className:"options-divider"}),n.Ay.createElement("div",{className:"quiz-mode"},n.Ay.createElement("div",{className:"dialog-checkbox-group"},!a&&n.Ay.createElement(as.A,{label:I("PollAnonymous"),checked:y,onChange:V}),n.Ay.createElement(as.A,{label:I("PollMultiple"),checked:g,disabled:E,onChange:_}),n.Ay.createElement(as.A,{label:I("PollQuiz"),checked:E,disabled:g||void 0!==t,onChange:U})),E&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("h3",{className:"options-header"},I("lng_polls_solution_title")),n.Ay.createElement(Xl.A,{value:b,onChange:P,noReplaceNewlines:!0}),n.Ay.createElement("div",{className:"note"},I("CreatePoll.ExplanationInfo")))))});var Ty=a(14235);const xy=(0,n.ph)((0,s.EK)((e,{modal:t})=>{const{appConfig:a}=e;return{editingMessage:t?.messageId?(0,c.O5q)(e,t.chatId,t.messageId):void 0,maxItemsCount:a?.todoItemsMax,maxTitleLength:a?.todoTitleLengthMax,maxItemLength:a?.todoItemLengthMax}})(({modal:e,maxItemsCount:t=i.gyE,maxTitleLength:a=i.B_P,maxItemLength:r=i.QU5,editingMessage:l,onSend:c,onClear:d})=>{const{editTodo:u,closeTodoListModal:A,appendTodoList:h}=(0,s.ko)(),y=(0,n.li)(),p=(0,n.li)(),[g,v]=(0,n.J0)(""),[E,f]=(0,n.J0)([{id:(0,Ty.t)(),text:""}]),[b,C]=(0,n.J0)(!0),[S,k]=(0,n.J0)(!0),[w,N]=(0,n.J0)(!1),I=(0,Ua.A)(),P=Boolean(e),M=(0,La.A)(e),T=M?.forNewTask&&!l?.isOutgoing,B=l?.content.todo?.todo,L=(0,n.Kr)(()=>T&&B?B.items.map(e=>({id:e.id,text:e.title.text,isDisabled:!0})):fa.p,[T,B]),R=(0,x.A)(e=>{P&&e.current&&e.current.focus()});(0,n.Nf)(()=>{if(B&&(v(B.title.text),C(B.othersCanAppend??!1),k(B.othersCanComplete??!1),!T)){const e=B.items.map(e=>({id:e.id,text:e.title.text}));e.length<t&&e.push({id:(0,Ty.t)(),text:""}),f(e)}},[B,T,t]),(0,n.vJ)(()=>P?(0,m.A)(d):void 0,[P,d]),(0,n.vJ)(()=>{P||(v(""),f([{id:(0,Ty.t)(),text:""}]),C(!0),k(!0),N(!1))},[P]),(0,n.vJ)(()=>{P&&(0,o.YS)(()=>{if(M?.forNewTask){const e=p.current?.querySelectorAll("input"),t=e?.[e.length-1];t?.focus()}else R(y)})},[R,P,M?.forNewTask]);const F=(0,x.A)(e=>{const t=(0,Ty.t)();f([...e,{id:t,text:""}]),(0,o.Uz)(()=>{const e=p.current;e&&(0,o.YS)(()=>{e.scrollTo({top:e.scrollHeight,behavior:"smooth"})})})}),D=(0,x.A)(()=>{if(N(!1),!P)return;const e=E.map(e=>{const t=e.text.trim();if(t)return{id:e.id,title:{text:t.substring(0,r)}}}).filter(Boolean),t=g.trim().substring(0,a);if(!t||0===e.length){if(v(t),e.length){const e=E.map(e=>({...e,text:e.text.trim().substring(0,r)})).filter(e=>e.text.length);0===e.length?F([]):f([...e,{id:(0,Ty.t)(),text:""}])}else F([]);return void N(!0)}if(T&&l)return h({chatId:l.chatId,messageId:l.id,items:e}),void A();const n={todo:{title:{text:t},items:e,othersCanAppend:b,othersCanComplete:S}};l?u({chatId:l.chatId,todo:n,messageId:l.id}):c(n),A()}),V=(0,x.A)((e,a)=>{const n=[...E];n[e]={...n[e],text:a},n[n.length-1].text.trim().length&&n.length<t?F(n):f(n)}),_=(0,x.A)(e=>{const t=[...E];t.splice(e,1),f(t),(0,o.Uz)(()=>{p.current&&p.current.classList.toggle("overflown",p.current.scrollHeight>320)})}),U=(0,x.A)(e=>{C(e.target.checked)}),O=(0,x.A)(e=>{k(e.target.checked)}),J=(0,x.A)(e=>{"Enter"===e.key&&D()}),K=(0,x.A)(e=>{v(e.target.value)}),G=(0,x.A)(()=>{if(w&&!g.trim().length)return I("ToDoListErrorChooseTitle")}),j=(0,x.A)(e=>{const t=E.map(e=>e.text.trim()).filter(e=>e.length);if(w&&t.length<1&&!E[e].text.trim().length)return I("ToDoListErrorChooseTasks")});return n.Ay.createElement(X.A,{isOpen:P,onClose:d,header:function(){const e=T?"TitleAppendToDoList":l?"TitleEditToDoList":"TitleNewToDoList";return n.Ay.createElement("div",{className:"modal-header-condensed"},n.Ay.createElement(Y.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:I("AriaToDoCancel"),onClick:d},n.Ay.createElement(Q.A,{name:"close"})),n.Ay.createElement("div",{className:"modal-title"},I(e)),n.Ay.createElement(Y.A,{color:"primary",size:"smaller",className:"modal-action-button",onClick:D},I(T?"Add":l?"Save":"Create")))}(),className:"ToDoListModal"},!T&&n.Ay.createElement(Z.A,{ref:y,label:I("InputTitle"),value:g,error:G(),onChange:K,onKeyPress:J}),T&&n.Ay.createElement("div",{className:"readonly-title"},g),n.Ay.createElement("div",{className:"options-divider"}),n.Ay.createElement("div",{className:"options-list custom-scroll",ref:p},n.Ay.createElement("h3",{className:"items-header"},I("TitleToDoList")),function(){const e=[...L,...E];return e.map((a,s)=>{const r=s-L.length;return n.Ay.createElement("div",{className:"item-wrapper"},n.Ay.createElement(Z.A,{maxLength:100,label:s!==e.length-1||e.length===t?I("TitleTask"):I("TitleAddTask"),error:j(r),value:a.text,disabled:a.isDisabled,onChange:e=>V(r,e.currentTarget.value),onKeyPress:J}),s!==e.length-1&&!a.isDisabled&&n.Ay.createElement(Y.A,{className:"item-remove-button",round:!0,color:"translucent",size:"smaller",ariaLabel:I("Delete"),onClick:()=>_(r)},n.Ay.createElement(Q.A,{name:"close"})))})}()),n.Ay.createElement("div",{className:"items-count-hint"},I("HintTodoListTasksCount",{count:t-E.length-(T&&B?B.items.length:0)})),n.Ay.createElement("div",{className:"options-divider"}),!T&&n.Ay.createElement("div",{className:"options-footer"},n.Ay.createElement("div",{className:"dialog-checkbox-group"},n.Ay.createElement(as.A,{label:I("AllowOthersAddTasks"),checked:b,onChange:U}),n.Ay.createElement(as.A,{label:I("AllowOthersMarkAsDone"),checked:S,onChange:O}))))}));var By=a(36680),Ly=a(52491);const Ry=(0,n.ph)(({emoji:e,focus:t,onClick:a})=>{const s=(0,x.A)(t=>{t.preventDefault(),a(e.native,e.id)}),r=(0,ue.A)("EmojiButton",t&&"focus"),o=`${i.jht?i.C1b:"."}/img-apple-64/${e.image}.png`,l=Ly.On.has(o);return n.Ay.createElement("div",{className:r,onMouseDown:s,title:`:${e.names[0]}:`},E.TL?e.native:n.Ay.createElement("img",{src:o,className:l?void 0:"opacity-transition shown",alt:e.native,loading:"lazy","data-path":o,onLoad:l?void 0:Ly.P_,draggable:!1}))}),Fy=.625*h.$,Dy=.25*h.$,Vy=.5*h.$,_y=.5*h.$,Uy=(0,n.ph)(({category:e,index:t,allEmojis:a,observeIntersection:s,shouldRender:r,onEmojiSelect:o})=>{const l=(0,n.li)();(0,io.mv)(l,s);const c=(0,Ja.A)(r),d=(0,B.A)(),{isMobile:m}=(0,I.Ay)(),u=m?Math.floor((S.A.get().width-_y+Fy)/(i.g0Q+Fy)):8,A=Math.ceil(e.emojis.length/u)*(i.g0Q+(m?Vy:Dy));return n.Ay.createElement("div",{ref:l,key:e.id,id:`emoji-category-${t}`,className:"symbol-set"},n.Ay.createElement("div",{className:"symbol-set-header"},n.Ay.createElement("p",{className:"symbol-set-name",dir:"auto"},d(e.id===i.sR2?"RecentStickers":`Emoji${t}`))),n.Ay.createElement("div",{className:(0,ue.A)("symbol-set-container",c),style:`height: ${A}px;`,dir:d.isRtl?"rtl":void 0},r&&e.emojis.map(e=>{const t=a[e];if(!t)return;const s="id"in t?t:t[1];return n.Ay.createElement(Ry,{key:s.id,emoji:s,onClick:o})})))}),Oy={recent:"recent",people:"smile",nature:"animals",foods:"eats",activity:"sport",places:"car",objects:"lamp",symbols:"language",flags:"flag"},Jy=3.25*h.$,Ky=2.625*h.$,Gy=[];let jy,zy,Hy;const $y=(0,n.ph)((0,s.EK)(e=>(0,Ea.Up)(e,["recentEmojis"]))(({className:e,recentEmojis:t,onEmojiSelect:s})=>{const r=(0,n.li)(),o=(0,n.li)(),[l,c]=(0,n.J0)(),[d,m]=(0,n.J0)(),[u,A]=(0,n.J0)(0),{isMobile:h}=(0,I.Ay)(),{handleScroll:y,isAtBeginning:p}=En(),{observe:g}=(0,io.BL)({rootRef:r,throttleMs:200},e=>{e.forEach(e=>{const{id:t}=e.target;if(!t||!t.startsWith("emoji-category-"))return;const a=Number(t.replace("emoji-category-",""));Gy[a]=e.isIntersecting});const t=Gy.reduce((e,t,a)=>t&&a<e?a:e,1/0);t!==1/0&&A(t)}),v=(0,so.A)([],i.vVF),f=d&&v;(0,ks.A)(o,!(h&&f)),(0,n.vJ)(()=>{if(!l)return;const e=o.current;if(!e)return;const t=u*Ky-e.offsetWidth/2+Ky/2;(0,vr.A)(e,t)},[l,u]);const b=(0,B.A)(),C=(0,n.Kr)(()=>{if(!l)return fa.p;const e=[...l];return t?.length&&e.unshift({id:i.sR2,name:b("RecentStickers"),emojis:t}),e},[l,b,t]);(0,n.vJ)(()=>{setTimeout(()=>{const e=()=>{c(Hy.categories),m(Hy.emojis)};Hy?e():async function(){return jy||(jy=a.e(996).then(a.t.bind(a,20996,19)),zy=(await jy).default,Hy=(0,Ly.cp)(zy)),jy}().then(e)},200)},[]);const S=(0,x.A)(e=>{A(e);const t=r.current.closest(".SymbolMenu-main").querySelector(`#emoji-category-${e}`);(0,ro.Ay)({container:r.current,element:t,position:"start",margin:Jy,maxDistance:100})}),k=(0,x.A)((e,t)=>{s(e,t)}),w=(0,ue.A)("EmojiPicker",e),N=(0,ue.A)("EmojiPicker-header",!p&&"with-top-border");return n.Ay.createElement(ne.Ay,{className:w,activeKey:f?1:0,name:"fade",shouldCleanup:!0},f?n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{ref:o,className:N,dir:b.isRtl?"rtl":void 0},C.map(function(e,t){const a=Oy[e.id];return a&&n.Ay.createElement(Y.A,{className:"symbol-set-button "+(t===u?"activated":""),round:!0,faded:!0,color:"translucent",onClick:()=>S(t),ariaLabel:e.name},n.Ay.createElement(Q.A,{name:a}))})),n.Ay.createElement("div",{ref:r,onScroll:y,className:(0,ue.A)("EmojiPicker-main",E.TF?"no-scrollbar":"custom-scroll")},C.map((e,t)=>n.Ay.createElement(Uy,{category:e,index:t,allEmojis:d,observeIntersection:g,shouldRender:u>=t-1&&u<=t+1,onEmojiSelect:k})))):n.Ay.createElement(Dn.A,null))}));function qy(){return qy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)({}).hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},qy.apply(null,arguments)}const Wy=(0,n.ph)(({gif:e,isDisabled:t,className:a,observeIntersection:s,onClick:r,onUnsaveClick:i,isSavedMessages:o})=>{const c=(0,n.li)(),d=(0,B.A)(),m=(0,io.Vz)(c,s)&&!t,u=!e.hasVideoPreview&&e.thumbnail&&(0,l.sC)(e,"pictogram"),A=(0,H.A)(u,!m),[h]=(0,n.J0)(e.thumbnail?.dataUri&&!A),y=(0,_a.A)(e.thumbnail?.dataUri,!h),p=(0,l.Ct)(e)||(0,l.sC)(e,"full"),g=(0,H.A)(p,!m),v=Boolean(m&&g),{isBuffered:f,bufferingHandlers:b}=(0,Je.A)(!0),C=m&&!f,S=m&&f,{isContextMenuOpen:k,contextMenuAnchor:w,handleBeforeContextMenu:N,handleContextMenu:I,handleContextMenuClose:P,handleContextMenuHide:M}=(0,vs.A)(c),T=(0,x.A)(()=>c.current),L=(0,x.A)(()=>c.current.closest(".custom-scroll, .no-scrollbar")),R=(0,x.A)(()=>c.current.querySelector(".gif-context-menu .bubble")),F=(0,x.A)(()=>{!k&&r&&r({...e,blobUrl:g})}),D=(0,x.A)(t=>{t.stopPropagation(),t.preventDefault(),i(e)}),V=(0,x.A)(()=>{i?.(e)}),_=(0,x.A)(()=>{r({...e,blobUrl:g},!0)}),U=(0,x.A)(()=>{r({...e,blobUrl:g},void 0,!0)}),O=(0,x.A)(e=>{(0,po.u)(e),N(e)});(0,n.vJ)(()=>{t&&P()},[P,t]);const J=(0,ue.A)("GifButton",e.width&&e.height&&e.width<e.height?"vertical":"horizontal",r&&"interactive",a);return n.Ay.createElement("div",{ref:c,className:J,onMouseDown:O,onClick:F,onContextMenu:I},!E.TF&&i&&n.Ay.createElement(Y.A,{className:"gif-unsave-button",color:"dark",pill:!0,noFastClick:!0,onClick:D},n.Ay.createElement(Q.A,{name:"close",className:"gif-unsave-button-icon"})),h&&n.Ay.createElement("canvas",{ref:y,className:"thumbnail"}),A&&!S&&n.Ay.createElement("img",{src:A,alt:"",className:"preview",draggable:!1}),v&&n.Ay.createElement(Ha.A,qy({canPlay:!0,src:g,autoPlay:!0,loop:!0,muted:!0,disablePictureInPicture:!0,playsInline:!0,preload:"none"},b)),C&&n.Ay.createElement(Ve.A,{color:A||h?"white":"black"}),r&&void 0!==w&&n.Ay.createElement(We.A,{isOpen:k,anchor:w,getTriggerElement:T,getRootElement:L,getMenuElement:R,className:"gif-context-menu",autoClose:!0,onClose:P,onCloseAnimationEnd:M},!o&&n.Ay.createElement(ce.A,{onClick:_,icon:"mute"},d("SendWithoutSound")),n.Ay.createElement(ce.A,{onClick:U,icon:"calendar"},d(o?"SetReminder":"ScheduleMessage")),i&&n.Ay.createElement(ce.A,{destructive:!0,icon:"delete",onClick:V},d("Delete"))))}),Qy=(0,n.ph)((0,s.EK)(e=>{const{chatId:t}=(0,c.Xf0)(e)||{},a=Boolean(t)&&(0,c.nZ4)(e,t);return{savedGifs:e.gifs.saved.gifs,isSavedMessages:a}})(({className:e,loadAndPlay:t,canSendGifs:a,savedGifs:r,isSavedMessages:o,onGifSelect:l})=>{const{loadSavedGifs:c,saveGif:d}=(0,s.ko)(),m=(0,n.li)(),{observe:u}=(0,io.BL)({rootRef:m,debounceMs:300});(0,n.vJ)(()=>{t&&c()},[t,c]);const A=(0,x.A)(e=>{d({gif:e,shouldUnsave:!0})}),h=(0,so.A)([],i.jhd),y=a&&(!h||!r);return n.Ay.createElement(ne.Ay,{ref:m,className:(0,ue.A)("GifPicker",e,E.TF?"no-scrollbar":"custom-scroll"),slideClassName:"GifPickerGrid",activeKey:y?0:1,name:"fade",shouldCleanup:!0},a?h&&r&&r.length?r.map(e=>n.Ay.createElement(Wy,{key:e.id,gif:e,observeIntersection:u,isDisabled:!t,onClick:a?l:void 0,onUnsaveClick:A,isSavedMessages:o})):h&&r?n.Ay.createElement("div",{className:"picker-disabled"},"No saved GIFs."):n.Ay.createElement(Dn.A,{color:"yellow"}):n.Ay.createElement("div",{className:"picker-disabled"},"Sending GIFs is not allowed in this chat."))}));let Yy=function(e){return e[e.Emoji=0]="Emoji",e[e.CustomEmoji=1]="CustomEmoji",e[e.Stickers=2]="Stickers",e[e.GIFs=3]="GIFs",e}({});const Zy={[Yy.Emoji]:"Emoji",[Yy.CustomEmoji]:"StickersList.EmojiItem",[Yy.Stickers]:"AccDescrStickers",[Yy.GIFs]:"GifsTab"},Xy={[Yy.Emoji]:"icon-smile",[Yy.CustomEmoji]:"icon-favorite",[Yy.Stickers]:"icon-stickers",[Yy.GIFs]:"icon-gifs"},ep=(0,n.ph)(({activeTab:e,onSwitchTab:t,onRemoveSymbol:a,onSearchOpen:s,isAttachmentModal:r,canSendPlainText:i,canSearch:o})=>{const l=(0,B.A)();function c(a){return n.Ay.createElement(Y.A,{className:"symbol-tab-button "+(e===a?"activated":""),onClick:()=>t(a),ariaLabel:l(Zy[a]),round:!0,faded:!0,color:"translucent"},n.Ay.createElement("i",{className:(0,ue.A)("icon",Xy[a])}))}const d=(0,x.A)(()=>{s(e===Yy.Stickers?"stickers":"gifs")});return n.Ay.createElement("div",{className:"SymbolMenu-footer",onClick:function(e){e.stopPropagation()},dir:l.isRtl?"rtl":void 0},e!==Yy.Emoji&&e!==Yy.CustomEmoji&&o&&n.Ay.createElement(Y.A,{className:"symbol-search-button",ariaLabel:e===Yy.Stickers?"Search Stickers":"Search GIFs",round:!0,faded:!0,color:"translucent",onClick:d},n.Ay.createElement(Q.A,{name:"search"})),i&&c(Yy.Emoji),i&&c(Yy.CustomEmoji),!r&&c(Yy.Stickers),!r&&c(Yy.GIFs),(e===Yy.Emoji||e===Yy.CustomEmoji)&&n.Ay.createElement(Y.A,{className:"symbol-delete-button",onClick:a,ariaLabel:"Remove Symbol",round:!0,faded:!0,color:"translucent"},n.Ay.createElement(Q.A,{name:"delete-left"})))});function tp(){return tp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)({}).hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},tp.apply(null,arguments)}let ap=!1;const np=(0,n.ph)((0,s.EK)(e=>({isLeftColumnShown:(0,c.nTw)(e).isLeftColumnShown,isBackgroundTranslucent:(0,c.cwE)(e),animationLevel:(0,hs.l)(e).animationLevel}))(({chatId:e,threadId:t,isOpen:a,canSendStickers:s,canSendGifs:r,isMessageComposer:i,idPrefix:l,isAttachmentModal:c,canSendPlainText:d,className:m,onLoad:u,onClose:A,onEmojiSelect:h,onCustomEmojiSelect:y,onStickerSelect:p,onGifSelect:g,onRemoveSymbol:v,onSearchOpen:f,addRecentEmoji:b,addRecentCustomEmoji:C,isLeftColumnShown:S,isBackgroundTranslucent:k,animationLevel:w,...N})=>{const[P,M]=(0,n.J0)(Yy.Emoji),[T,L]=(0,n.J0)([]),[R,F]=(0,n.J0)([]),{isMobile:D}=(0,I.Ay)(),[V,_]=(0,By.A)(a,A,void 0,D),{shouldRender:U,transitionClassNames:O}=(0,Ke.A)(a,A,!1,!1),J=(0,B.A)();!ap&&a&&(ap=!0),(0,n.vJ)(()=>{u()},[u]),(0,n.vJ)(()=>{d||M(2)},[d]),(0,n.Nf)(()=>{if(D&&a&&!c)return document.body.classList.add("enable-symbol-menu-transforms"),document.body.classList.add("is-symbol-menu-open"),()=>{document.body.classList.remove("is-symbol-menu-open"),setTimeout(()=>{(0,o.RK)(()=>{document.body.classList.remove("enable-symbol-menu-transforms")})},350)}},[c,D,a]);const K=(0,n.li)(T);K.current=T,(0,n.vJ)(()=>{K.current.length&&!a&&(K.current.forEach(e=>{b({emoji:e})}),L([]))},[a,b]);const G=(0,x.A)((e,t)=>{L(e=>[...e,t]),h(e)}),j=(0,n.li)(R);j.current=R,(0,n.vJ)(()=>{j.current.length&&!a&&(j.current.forEach(e=>{C({documentId:e})}),L([]))},[a,C]);const z=(0,x.A)(e=>{F(t=>[...t,e.id]),y(e)}),H=(0,x.A)(e=>{A(),f(e)}),$=(0,x.A)((e,t,a,n)=>{p?.(e,t,a,!0,n)});function q(o,c){switch(P){case Yy.Emoji:return n.Ay.createElement($y,{className:"picker-tab",onEmojiSelect:G});case Yy.CustomEmoji:return n.Ay.createElement(Vo,{className:"picker-tab",isHidden:!a||!o,idPrefix:l,loadAndPlay:a&&(o||c),chatId:e,isTranslucent:!D&&k,onCustomEmojiSelect:z});case Yy.Stickers:return n.Ay.createElement(Wh,{className:"picker-tab",isHidden:!a||!o,loadAndPlay:!!s&&a&&(o||c),idPrefix:l,canSendStickers:s,noContextMenus:!i,chatId:e,threadId:t,isTranslucent:!D&&k,onStickerSelect:$});case Yy.GIFs:return n.Ay.createElement(Qy,{className:"picker-tab",loadAndPlay:!!r&&a&&(o||c),canSendGifs:r,onGifSelect:g})}}const W=n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:"SymbolMenu-main",onClick:function(e){e.stopPropagation()}},ap&&n.Ay.createElement(ne.Ay,{name:(0,Oc.P)("slide",w),activeKey:P,renderCount:Object.values(Zy).length},q)),D&&n.Ay.createElement(Y.A,{round:!0,faded:!0,color:"translucent",ariaLabel:J("Close"),className:"symbol-close-button",size:"tiny",onClick:A},n.Ay.createElement(Q.A,{name:"close"})),n.Ay.createElement(ep,{activeTab:P,onSwitchTab:M,onRemoveSymbol:v,canSearch:i,onSearchOpen:H,isAttachmentModal:c,canSendPlainText:d}));if(D){if(!U)return;const e=(0,ue.A)("SymbolMenu mobile-menu",O,S&&"left-column-open",c&&"in-attachment-modal",i&&"in-middle-column");return c?n.Ay.createElement("div",{className:e},W):n.Ay.createElement(_o.A,null,n.Ay.createElement("div",{className:e},W))}return n.Ay.createElement(We.A,tp({isOpen:a,onClose:A,withPortal:c,className:(0,ue.A)("SymbolMenu",m),onCloseAnimationEnd:A,onMouseEnter:E.TF?void 0:V,onMouseLeave:E.TF?void 0:_,noCloseOnBackdrop:!E.TF,noCompact:!0},c?N:{positionX:"left",positionY:"bottom"}),W)}));var sp=a(91034);const rp=(0,n.ph)(({withAvatar:e,focus:t,command:a,description:s,peer:r,clickArg:i,onClick:o})=>{const l=(0,x.A)(()=>{o(i)});return n.Ay.createElement(ca.A,{key:a,className:(0,ue.A)("BotCommand chat-item-clickable scroll-item",e&&"with-avatar"),multiline:!0,onClick:l,focus:t},e&&n.Ay.createElement(xt.A,{size:"small",peer:r}),n.Ay.createElement("div",{className:"content-inner"},n.Ay.createElement("span",{className:"title"},"/",a),n.Ay.createElement("span",{className:"subtitle"},(0,Tt.A)(s))))}),ip=(0,n.ph)((0,sp.A)(({isOpen:e,chatId:t,withUsername:a,botCommands:r,quickReplies:i,quickReplyMessages:o,self:c,getHtml:d,onClick:m,onClose:u})=>{const{sendBotCommand:A,sendQuickReply:h}=(0,s.ko)(),y=(0,n.li)(),{shouldRender:p,transitionClassNames:g}=(0,Ke.A)(e,void 0,void 0,!1),v=(0,x.A)(({botId:e,command:t})=>{const n=(0,s.mS)().users.byId[e];A({command:`/${t}${a&&n?`@${(0,l.Kl)(n)}`:""}`}),m()}),E=(0,x.A)(e=>{h({chatId:t,quickReplyId:e}),m()}),f=(0,n.Kr)(()=>{if(i?.length&&o)return i.map(e=>{const t=o[e.topMessageId];return{id:e.id,command:e.shortcut,description:t?.content.text?.text||""}})},[i,o]),b=(0,x.A)(e=>!!e.command.startsWith(d().slice(1))&&("id"in e?E(e.id):v(e),!0)),C=by({isActive:e,items:(0,n.Kr)(()=>{if(r||f)return[].concat(f||[],r||[])},[r,f]),onSelect:b,onClose:u}),S=r&&!r.length||i&&!i.length;if((0,n.vJ)(()=>{S&&u()},[S,u]),(0,n.vJ)(()=>{fy(".chat-item-clickable",C,y)},[C]),!p||S)return;const k=(0,ue.A)("iaTB59vy","composer-tooltip custom-scroll",g);return n.Ay.createElement("div",{className:k,ref:y},f?.map((e,t)=>n.Ay.createElement(rp,{key:`quickReply_${e.id}`,command:e.command,description:e.description,peer:c,withAvatar:!0,clickArg:e.id,onClick:E,focus:C===t})),r?.map((e,t)=>n.Ay.createElement(rp,{key:`${e.botId}_${e.command}`,command:e.command,description:e.description,peer:(0,s.mS)().users.byId[e.botId],withAvatar:!0,clickArg:e,onClick:v,focus:C+(f?.length||0)===t})))})),op=(0,n.ph)(({isOpen:e,botCommands:t,onClose:a})=>{const{sendBotCommand:r}=(0,s.ko)(),{isMobile:i}=(0,I.Ay)(),[o,l]=(0,By.A)(e,a,void 0,i),c=(0,x.A)(e=>{r({command:`/${e}`}),a()});return n.Ay.createElement(We.A,{isOpen:e,positionX:"left",positionY:"bottom",onClose:a,className:"BotCommandMenu",onCloseAnimationEnd:a,onMouseEnter:E.TF?void 0:o,onMouseLeave:E.TF?void 0:l,noCloseOnBackdrop:!E.TF,noCompact:!0},t.map(e=>n.Ay.createElement(rp,{key:e.command,command:e.command,description:e.description,clickArg:e.command,onClick:c})))}),lp=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const{stickers:a}=e.stickers.forEmoji;return{stickers:a,isSavedMessages:(0,c.nZ4)(e,t),isCurrentUserPremium:(0,c.g29)(e)}})(({chatId:e,threadId:t,isOpen:a,onStickerSelect:s,onClose:r,stickers:o,isSavedMessages:l,isCurrentUserPremium:c})=>{const d=(0,n.li)(),{shouldRender:u,transitionClassNames:A}=(0,Ke.A)(a,void 0,void 0,!1),h=(0,U.A)(o,!0),y=o||h,p=(0,$h.A)(e,t),{observe:g}=(0,io.BL)({rootRef:d,throttleMs:200});(0,n.vJ)(()=>a?(0,m.A)(r):void 0,[a,r]);const v=(0,ue.A)("StickerTooltip composer-tooltip custom-scroll",A,!y?.length&&"hidden");return n.Ay.createElement("div",{ref:d,className:v,onMouseMove:()=>{p({type:"chooseSticker"})}},u&&y?y.map(e=>n.Ay.createElement(fo,{key:e.id,sticker:e,size:i.bkT,observeIntersection:g,onClick:a?s:void 0,clickArg:e,isSavedMessages:l,canViewSet:!0,isCurrentUserPremium:c})):u?n.Ay.createElement(Dn.A,null):void 0)})),cp={root:"_8sFuAomM",emojiButton:"crWzZ2jr"},dp=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const{stickers:a}=e.customEmojis.forEmoji;return{customEmoji:a,isSavedMessages:(0,c.nZ4)(e,t),isCurrentUserPremium:(0,c.g29)(e)}})(({isOpen:e,addRecentCustomEmoji:t,onCustomEmojiSelect:a,onClose:r,customEmoji:o,isSavedMessages:l,isCurrentUserPremium:c,noPlay:d})=>{const{clearCustomEmojiForEmoji:u}=(0,s.ko)(),A=(0,n.li)(),{shouldRender:h,transitionClassNames:y}=(0,Ke.A)(e,void 0,void 0,!1),p=(0,U.A)(o,!0),g=o||p;(0,ks.A)(A);const{observe:v}=(0,io.BL)({rootRef:A,throttleMs:200,isDisabled:!e});(0,n.vJ)(()=>e?(0,m.A)(r):void 0,[e,r]);const E=(0,x.A)(n=>{e&&(a(n),t({documentId:n.id}),u())}),f=(0,ue.A)(cp.root,"composer-tooltip custom-scroll-x",y,!g?.length&&cp.hidden);return n.Ay.createElement("div",{ref:A,className:f},h&&g?g.map(e=>n.Ay.createElement(fo,{key:e.id,sticker:e,className:cp.emojiButton,size:i.x6_,observeIntersection:v,onClick:E,clickArg:e,isSavedMessages:l,canViewSet:!0,isCurrentUserPremium:c,noPlay:d})):h?n.Ay.createElement(Dn.A,null):void 0)}));var mp=a(76283);const up=(0,n.ph)(({isOpen:e,isOpenToBottom:t=!1,isSavedMessages:a,canSchedule:r,canScheduleUntilOnline:i,onSendSilent:o,onSendSchedule:l,onSendWhenOnline:c,onRemoveEffect:d,onClose:m,onCloseAnimationEnd:u,chatId:A,withEffects:h,hasCurrentEffect:y,effectReactions:p,allAvailableReactions:g,onToggleReaction:v,canBuyPremium:f,isCurrentUserPremium:b,isInSavedMessages:C,isInStoryViewer:S,canPlayAnimatedEmojis:k})=>{const{openEffectPicker:w}=(0,s.ko)(),[N,I]=(0,By.A)(e,m),[P,T]=(0,n.J0)(!1),L=(0,B.A)(),R=(0,Ua.A)(),[F,D,V]=(0,M.A)();(0,Sa.A)(([t])=>{e&&!t&&(V(),T(Boolean(i)))},[e,i]);const[_,U,O]=(0,M.A)(),J=(0,x.A)(e=>{D(),A&&w({chatId:A,position:e})});return(0,n.vJ)(()=>{e?setTimeout(()=>{U()},200):O()},[e,U,O]),n.Ay.createElement(We.A,{isOpen:e,autoClose:!0,positionX:"right",positionY:t?"top":"bottom",className:(0,ue.A)("CustomSendMenu","fluid","with-menu-transitions",h&&"with-effects"),onClose:m,onCloseAnimationEnd:u,onMouseEnter:E.TF?void 0:N,onMouseLeave:E.TF?void 0:I,noCloseOnBackdrop:!E.TF},h&&!S&&n.Ay.createElement(mp.A,{allAvailableReactions:g,effectReactions:p,currentReactions:void 0,onToggleReaction:v,isPrivate:!0,isReady:_,canBuyPremium:f,isCurrentUserPremium:b,isInSavedMessages:C,isForEffects:!0,canPlayAnimatedEmojis:k,onShowMore:J,onClose:m,className:(0,ue.A)(F&&"ReactionSelector-hidden")}),n.Ay.createElement("div",{className:(0,ue.A)("CustomSendMenu_items",F&&"CustomSendMenu_items-hidden"),dir:L.isRtl?"rtl":void 0},o&&n.Ay.createElement(ce.A,{icon:"mute",onClick:o},L("SendWithoutSound")),r&&l&&n.Ay.createElement(ce.A,{icon:"schedule",onClick:l},L(a?"SetReminder":"ScheduleMessage")),r&&l&&P&&n.Ay.createElement(ce.A,{icon:"user-online",onClick:c},L("SendWhenOnline")),h&&y&&n.Ay.createElement(ce.A,{icon:"delete",onClick:d},R("RemoveEffect"))))});var Ap=a(41510),hp=a(22802);const yp={B:"bold",STRONG:"bold",I:"italic",EM:"italic",U:"underline",DEL:"strikethrough",CODE:"monospace",SPAN:"spoiler"},pp=document.createElement("div"),gp=(0,n.ph)(({isOpen:e,anchorPosition:t,selectedRange:a,setSelectedRange:s,onClose:r})=>{const o=(0,n.li)(),l=(0,n.li)(),{shouldRender:c,transitionClassNames:d}=(0,Ke.A)(e),[u,A,h]=(0,M.A)(),[y,p]=(0,n.J0)(""),[g,v]=(0,n.J0)(!1),[E,b]=(0,n.J0)(),[C,S]=(0,n.J0)({});(0,n.vJ)(()=>e?(0,m.A)(r):void 0,[e,r]),(0,hp.A)(e,o,r,!0),(0,n.vJ)(()=>{u?l.current.focus():(p(""),v(!1))},[u]),(0,n.vJ)(()=>{c||(h(),S({}),b(void 0))},[h,c]),(0,n.vJ)(()=>{if(!e||!a)return;const t={};let{parentElement:n}=a.commonAncestorContainer;for(;n&&n.id!==i.CfG;){const e=yp[n.tagName];e&&(t[e]=!0),n=n.parentElement}S(t)},[e,a,A]);const k=(0,x.A)(()=>{if(!a)return;const e=window.getSelection();e&&(e.removeAllRanges(),e.addRange(a))}),w=(0,x.A)(()=>{const e=window.getSelection();e&&s(e.getRangeAt(0))}),N=(0,x.A)(e=>{if(a)return pp.replaceChildren(a.cloneContents()),e&&pp.querySelectorAll(Hh._p).forEach(e=>{e.replaceWith(e.getAttribute("alt"))}),pp.innerHTML}),I=(0,x.A)(()=>{if(a)return a.commonAncestorContainer.parentElement});function P(){const e=l.current;if(!e)return;const{offsetWidth:t,scrollWidth:a,scrollLeft:n}=e;if(a<=t)return void b(void 0);let s="";n<a-t&&(s="mask-right"),n>0&&(s+=" mask-left"),b(s)}function T(e){if(C[e])return"active";if("monospace"===e||"strikethrough"===e){if(Object.keys(C).some(t=>t!==e&&Boolean(C[t])))return"disabled"}else if(C.monospace||C.strikethrough)return"disabled"}const L=(0,x.A)(()=>{if(C.spoiler){const e=I();if(!a||!e||e.dataset.entityType!==J.C7.Spoiler||!e.textContent)return;return e.replaceWith(e.textContent),void S(e=>({...e,spoiler:!1}))}const e=N();document.execCommand("insertHTML",!1,`<span class="spoiler" data-entity-type="${J.C7.Spoiler}">${e}</span>`),r()}),R=(0,x.A)(()=>{S(e=>(document.execCommand(e.bold?"removeFormat":"bold"),Object.keys(e).forEach(t=>{"italic"!==t&&"underline"!==t||!Boolean(e[t])||document.execCommand(t)}),w(),{...e,bold:!e.bold}))}),F=(0,x.A)(()=>{document.execCommand("italic"),w(),S(e=>({...e,italic:!e.italic}))}),D=(0,x.A)(()=>{document.execCommand("underline"),w(),S(e=>({...e,underline:!e.underline}))}),V=(0,x.A)(()=>{if(C.strikethrough){const e=I();if(!a||!e||"DEL"!==e.tagName||!e.textContent)return;return e.replaceWith(e.textContent),void S(e=>({...e,strikethrough:!1}))}const e=N();document.execCommand("insertHTML",!1,`<del>${e}</del>`),r()}),_=(0,x.A)(()=>{if(C.monospace){const e=I();if(!a||!e||"CODE"!==e.tagName||!e.textContent)return;return e.replaceWith(e.textContent),void S(e=>({...e,monospace:!1}))}const e=N(!0);document.execCommand("insertHTML",!1,`<code class="text-entity-code" dir="auto">${e}</code>`),r()}),U=(0,x.A)(()=>{const e=((0,Zn.Tc)(y)||"").split("%").map(encodeURI).join("%");if(g){const t=I();if(!t||"A"!==t.tagName)return;return t.href=e,void r()}const t=N(!0);k(),document.execCommand("insertHTML",!1,`<a href=${e} class="text-entity-link" dir="auto">${t}</a>`),r()}),O=(0,x.A)(e=>{const t={k:A,b:R,u:D,i:F,m:_,s:V,p:L}[function(e){const t=e.key||e.code;return t.startsWith("Key")?t.slice(3).toLowerCase():t}(e)];!e.altKey&&(e.ctrlKey||e.metaKey)&&t&&(e.preventDefault(),e.stopPropagation(),t())});(0,n.vJ)(()=>(e&&document.addEventListener("keydown",O),()=>document.removeEventListener("keydown",O)),[e,O]);const K=(0,B.A)();if(!c)return;const G=(0,ue.A)("TextFormatter",d,u&&"link-control-shown"),j=(0,ue.A)("TextFormatter-link-url-confirm",Boolean(y.length)&&"shown"),z=t?`left: ${t.x}px; top: ${t.y}px;--text-formatter-left: ${t.x}px;`:"";return n.Ay.createElement("div",{ref:o,className:G,style:z,onKeyDown:function(e){"Enter"===e.key&&u&&(U(),e.preventDefault())},onMouseDown:f.A},n.Ay.createElement("div",{className:"TextFormatter-buttons"},n.Ay.createElement(Y.A,{color:"translucent",ariaLabel:"Spoiler text",className:T("spoiler"),onClick:L},n.Ay.createElement(Q.A,{name:"eye-crossed"})),n.Ay.createElement("div",{className:"TextFormatter-divider"}),n.Ay.createElement(Y.A,{color:"translucent",ariaLabel:"Bold text",className:T("bold"),onClick:R},n.Ay.createElement(Q.A,{name:"bold"})),n.Ay.createElement(Y.A,{color:"translucent",ariaLabel:"Italic text",className:T("italic"),onClick:F},n.Ay.createElement(Q.A,{name:"italic"})),n.Ay.createElement(Y.A,{color:"translucent",ariaLabel:"Underlined text",className:T("underline"),onClick:D},n.Ay.createElement(Q.A,{name:"underlined"})),n.Ay.createElement(Y.A,{color:"translucent",ariaLabel:"Strikethrough text",className:T("strikethrough"),onClick:V},n.Ay.createElement(Q.A,{name:"strikethrough"})),n.Ay.createElement(Y.A,{color:"translucent",ariaLabel:"Monospace text",className:T("monospace"),onClick:_},n.Ay.createElement(Q.A,{name:"monospace"})),n.Ay.createElement("div",{className:"TextFormatter-divider"}),n.Ay.createElement(Y.A,{color:"translucent",ariaLabel:K("TextFormat.AddLinkTitle"),onClick:A},n.Ay.createElement(Q.A,{name:"link"}))),n.Ay.createElement("div",{className:"TextFormatter-link-control"},n.Ay.createElement("div",{className:"TextFormatter-buttons"},n.Ay.createElement(Y.A,{color:"translucent",ariaLabel:K("Cancel"),onClick:h},n.Ay.createElement(Q.A,{name:"arrow-left"})),n.Ay.createElement("div",{className:"TextFormatter-divider"}),n.Ay.createElement("div",{className:(0,ue.A)("TextFormatter-link-url-input-wrapper",E)},n.Ay.createElement("input",{ref:l,className:"TextFormatter-link-url-input",type:"text",value:y,placeholder:"Enter URL...",autoComplete:"off",inputMode:"url",dir:"auto",onChange:function(e){p(e.target.value),P()},onScroll:P})),n.Ay.createElement("div",{className:j},n.Ay.createElement("div",{className:"TextFormatter-divider"}),n.Ay.createElement(Y.A,{color:"translucent",ariaLabel:K("Save"),className:"color-primary",onClick:U},n.Ay.createElement(Q.A,{name:"check"}))))))}),vp=(0,n.ph)(({emoji:e,focus:t,onClick:a,observeIntersection:s})=>{const r=(0,x.A)(t=>{t.preventDefault(),a?.(e)}),i=(0,ue.A)("EmojiButton",t&&"focus");return n.Ay.createElement("div",{className:i,onMouseDown:r,title:e.emoji},n.Ay.createElement(Ar.A,{documentId:e.id,size:32,withSharedAnimation:!0,shouldPreloadPreview:!0,observeIntersectionForPlaying:s}))}),Ep=(0,n.ph)(({isOpen:e,emojis:t,customEmojis:a,onClose:s,onEmojiSelect:r,onCustomEmojiSelect:i,addRecentEmoji:o,addRecentCustomEmoji:l})=>{const c=(0,n.li)(),{shouldRender:d,transitionClassNames:m}=(0,Ke.A)(e,void 0,void 0,!1),u=(0,Ya.A)(t.length?[...a,...t]:void 0,350)||[];(0,ks.A)(c);const{observe:A}=(0,io.BL)({rootRef:c,throttleMs:200,isDisabled:!e}),h=(0,x.A)(e=>{r(e.native),o({emoji:e.id})}),y=(0,x.A)(e=>{i(e),l({documentId:e.id})}),p=(0,x.A)(e=>{"native"in e?h(e):y(e)}),g=(0,x.A)((e,t)=>{r(e),o({emoji:t})}),v=(0,x.A)(e=>{i(e),l({documentId:e.id})}),E=by({isActive:e,isHorizontal:!0,items:u,shouldRemoveSelectionOnReset:!0,onSelect:p,onClose:s});(0,Sa.A)(([e])=>{void 0!==e&&-1!==e&&function(e,t){const a=t.current;if(!a)return;const{visibleIndexes:n,allElements:s}=Ey(a,".EmojiButton",8,!0,!0,!0);if(!s.length||!s[e])return;const r=n[0];if(!n.includes(e)||e===r&&!vy(a,s[r],!0)){const t="start"==(e>n[n.length-1]?"start":"end")?44*e:0;(0,vr.A)(a,t)}}(E,c)},[E]);const f=(0,ue.A)("EmojiTooltip composer-tooltip custom-scroll-x",m);return n.Ay.createElement("div",{ref:c,className:f},d&&u?u.map((e,t)=>"native"in e?n.Ay.createElement(Ry,{key:e.id,emoji:e,focus:E===t,onClick:g}):n.Ay.createElement(vp,{key:e.id,emoji:e,focus:E===t,onClick:v,observeIntersection:A})):d?n.Ay.createElement(Dn.A,null):void 0)}),fp=(0,n.ph)(({title:e,description:t,thumbnail:a,thumbUrl:s,focus:r,transitionClassNames:i="",onClick:o})=>{let c;const d=(0,H.A)(a?(0,l.cy)(a):void 0);return(s=s||d)?c=n.Ay.createElement("img",{src:s,className:i,alt:"",decoding:"async",draggable:!1}):e&&(c=(0,qe.Qh)(e,1)),n.Ay.createElement(ca.A,{focus:r,className:(0,ue.A)("BaseResult chat-item-clickable","string"==typeof c&&"with-text"),onMouseDown:po.u,onClick:o},n.Ay.createElement("span",{className:"thumb"},"string"==typeof c?(0,Tt.A)(c):c),n.Ay.createElement("div",{className:"content-inner"},e&&n.Ay.createElement("div",{className:"title"},e),t&&n.Ay.createElement("div",{className:"description"},t)))}),bp=(0,n.ph)(({focus:e,inlineResult:t,onClick:a})=>{const{title:s,description:r}=t,i="url"in t?t.url:void 0,o="webThumbnail"in t?t.webThumbnail:void 0,l=(0,x.A)(()=>{a(t)});return n.Ay.createElement(fp,{focus:e,thumbnail:o,title:s||i,description:r,onClick:l})}),Cp=(0,n.ph)(({inlineResult:e,isSavedMessages:t,canSendGifs:a,observeIntersection:s,onClick:r})=>{const{gif:i}=e,o=(0,x.A)((t,a,n)=>{r(e,a,n)});if(i)return n.Ay.createElement(Wy,{gif:i,observeIntersection:s,className:"chat-item-clickable",onClick:a?o:void 0,isSavedMessages:t})}),Sp=(0,n.ph)(({focus:e,isForGallery:t,inlineResult:a,onClick:s})=>{let r,i,o;"photo"in a&&(r=a.photo),"thumbnail"in a&&(i=a.thumbnail),"webThumbnail"in a&&(o=a.webThumbnail);const c=(0,H.A)((0,l.cy)(o)),d=(0,H.A)(r&&(0,l.rI)(r,"pictogram")),m=(0,Ja.A)(d||c),u=(0,x.A)(()=>{s(a)});if(t)return n.Ay.createElement("div",{className:"MediaResult chat-item-clickable",onClick:u},n.Ay.createElement("img",{src:r?.thumbnail?.dataUri||c,alt:"",draggable:!1}),n.Ay.createElement("img",{src:d,className:(0,ue.A)("full-media",m),alt:"",draggable:!1}));const{title:A,description:h}=a;return n.Ay.createElement(fp,{focus:e,thumbnail:o,thumbUrl:d||i?.dataUri,transitionClassNames:m,title:A,description:h,onClick:u})}),kp=(0,n.ph)(({inlineResult:e,isSavedMessages:t,observeIntersection:a,onClick:s,isCurrentUserPremium:r})=>{const{sticker:o}=e;if(o)return n.Ay.createElement(fo,{sticker:o,size:i.mD0,observeIntersection:a,title:o.emoji,className:"chat-item-clickable",onClick:s,clickArg:e,isSavedMessages:t,canViewSet:!0,noShowPremium:!0,isCurrentUserPremium:r})}),wp=(0,ye.nF)(e=>e(),500,!0),Np=(0,n.ph)(({isOpen:e,botId:t,isGallery:a,inlineBotResults:i,switchPm:o,switchWebview:l,isSavedMessages:c,canSendGifs:d,loadMore:m,onClose:u,onSelectResult:A,isCurrentUserPremium:h})=>{const{openChat:y,startBot:p,requestSimpleWebView:g}=(0,s.ko)(),v=(0,n.li)(),{shouldRender:f,transitionClassNames:b}=(0,Ke.A)(e,void 0,void 0,!1),C=(0,La.A)(a,f),{observe:S}=(0,io.BL)({rootRef:v,debounceMs:200,isDisabled:!e}),k=(0,x.A)(({direction:e})=>{e===r.TN.Backwards&&wp(m)}),w=by({isActive:e,shouldRemoveSelectionOnReset:C,noArrowNavigation:C,items:i,onSelect:A,onClose:u});(0,n.vJ)(()=>{fy(".chat-item-clickable",w,v)},[w]);const N=(0,x.A)(()=>{y({id:t}),p({botId:t,param:o.startParam})}),I=(0,x.A)(()=>{const e=(0,Ns.A)();g({botId:t,url:l.url,buttonText:l.text,theme:e,isFromSwitchWebView:!0})}),P=(0,U.A)(i?.length?i:void 0,f),M=i?.length?i:P;if(!f||!M?.length&&!o)return;const T=(0,ue.A)("InlineBotTooltip composer-tooltip",E.TF?"no-scrollbar":"custom-scroll",C&&"gallery",b);return n.Ay.createElement(fn.A,{ref:v,className:T,items:M,itemSelector:".chat-item-clickable",noFastList:!0,onLoadMore:k,sensitiveArea:160},o&&n.Ay.createElement(ca.A,{ripple:!0,className:"switch-pm scroll-item",onClick:N},n.Ay.createElement("span",{className:"title"},o.text)),l&&n.Ay.createElement(ca.A,{ripple:!0,className:"switch-pm scroll-item",onClick:I},n.Ay.createElement("span",{className:"title"},l.text)),Boolean(M?.length)&&M.map((e,t)=>{switch(e.type){case"gif":return n.Ay.createElement(Cp,{key:e.id,inlineResult:e,observeIntersection:S,onClick:A,isSavedMessages:c,canSendGifs:d});case"photo":return n.Ay.createElement(Sp,{key:e.id,isForGallery:C,inlineResult:e,onClick:A});case"sticker":return n.Ay.createElement(kp,{key:e.id,inlineResult:e,observeIntersection:S,onClick:A,isSavedMessages:c,isCurrentUserPremium:h});case"video":case"file":case"game":return n.Ay.createElement(Sp,{key:e.id,focus:w===t,inlineResult:e,onClick:A});case"article":case"audio":case"voice":return n.Ay.createElement(bp,{key:e.id,focus:w===t,inlineResult:e,onClick:A});default:return}}))}),Ip=(0,n.ph)(({isOpen:e,chatId:t,selectedSendAsId:a,sendAsPeerIds:r,isCurrentUserPremium:i,onClose:o})=>{const{saveDefaultSendAs:l,showNotification:c}=(0,s.ko)(),d=(0,s.mS)().users.byId,m=(0,s.mS)().chats.byId,u=(0,B.A)(),A=(0,n.li)(),[h,y,p]=(0,By.A)(e,o,void 0);(0,n.vJ)(()=>{e&&p()},[e,p]);const g=(0,x.A)(e=>{o(),l({chatId:t,sendAsId:e})}),v=by({isActive:e,items:r,onSelect:g,shouldSelectOnTab:!0,shouldSaveSelectionOnUpdateItems:!0,onClose:o});return(0,n.vJ)(()=>{fy(".chat-item-clickable",v,A)},[v]),(0,n.vJ)(()=>{r&&!r.length&&o()},[r,o]),n.Ay.createElement(We.A,{isOpen:e,positionX:"left",positionY:"bottom",onClose:o,className:"SendAsMenu",onCloseAnimationEnd:o,onMouseEnter:E.TF?void 0:h,onMouseLeave:E.TF?void 0:y,noCloseOnBackdrop:!E.TF,noCompact:!0},n.Ay.createElement("div",{className:"send-as-title",dir:"auto"},u("SendMessageAsTitle")),d&&m&&r?.map(({id:e,isPremium:t},s)=>{const r=d[e],o=m[e],l=r||o,A=(0,ue.A)(a===e&&"selected");return n.Ay.createElement(ca.A,{key:e,className:"SendAsItem chat-item-clickable scroll-item with-avatar",onClick:()=>{!t||i?g(e):c({message:u("SelectSendAsPeerPremiumHint"),actionText:u("Open"),action:{action:"openPremiumModal",payload:{}}})},focus:v===s,rightElement:!i&&t&&n.Ay.createElement(Q.A,{name:"lock-badge",className:"send-as-icon-locked"})},n.Ay.createElement(xt.A,{size:"small",peer:l,className:A}),n.Ay.createElement("div",{className:"info"},l&&n.Ay.createElement(Vn.A,{peer:l,noFake:!0}),n.Ay.createElement("span",{className:"subtitle"},r?u("VoipGroupPersonalAccount"):u("Subscribers",o?.membersCount,"i"))))}))}),Pp=(0,n.ph)((0,s.EK)((e,{stickerSetId:t})=>({set:(0,c.ycM)(e,t),shouldPlay:(0,c.ML4)(e),isCurrentUserPremium:(0,c.g29)(e)}))(({stickerSetId:e,observeIntersection:t,set:a,shouldPlay:r,isModalOpen:o,isCurrentUserPremium:l})=>{const{loadStickers:c,toggleStickerSet:d,openStickerSet:m}=(0,s.ko)(),u=(0,n.li)(),A=(0,B.A)(),h=a&&!a.isArchived&&Boolean(a.installedDate),y=Boolean(a?.stickers),p=(0,n.Kr)(()=>{if(!a)return[];const e=(a.stickers?.filter(({hasEffect:e})=>e)??[]).slice(0,3),t=(a.covers||[]).map(({id:e})=>e),n=a.stickers?a.stickers.filter(({id:e})=>!t.includes(e)):[];return[...e,...a.covers||[],...n].slice(0,5)},[a]);(0,n.vJ)(()=>{!y&&p.length<5&&a&&c({stickerSetInfo:{shortName:a.shortName}})},[y,p.length,c,a,e]);const g=(0,n.hb)(()=>{d({stickerSetId:e})},[d,e]),v=(0,n.hb)(e=>{m({stickerSetInfo:e.stickerSetInfo})},[m]);if(!a)return;const E=p.length>0;return n.Ay.createElement("div",{key:a.id,className:"sticker-set",dir:A.isRtl?"rtl":void 0},n.Ay.createElement("div",{className:"sticker-set-header"},n.Ay.createElement("div",{className:"title-wrapper"},n.Ay.createElement("h3",{className:"title",dir:"auto"},a.title),n.Ay.createElement("p",{className:"count",dir:"auto"},A("Stickers",a.count,"i"))),n.Ay.createElement(Y.A,{className:h?"is-added":void 0,color:"primary",size:"tiny",pill:!0,fluid:!0,onClick:g},A(h?"Stickers.Installed":"Stickers.Install"))),n.Ay.createElement("div",{className:"sticker-set-main shared-canvas-container"},n.Ay.createElement("canvas",{ref:u,className:"shared-canvas"}),!E&&n.Ay.createElement(Ve.A,null),E&&p.map(e=>n.Ay.createElement(fo,{sticker:e,size:i.Rqe,observeIntersection:t,noPlay:!r||o,clickArg:e,onClick:v,noContextMenu:!0,isCurrentUserPremium:l,sharedCanvasRef:u}))))})),Mp=(0,ye.nF)(e=>e(),6e4,!0),Tp=(0,n.ph)((0,s.EK)(e=>{const t=(0,c.BmE)(e),{query:a,resultIds:n}=t||{},{featured:s}=e.stickers;return{query:a,featuredIds:s.setIds,resultIds:n,isModalOpen:Boolean((0,c.nTw)(e).openedStickerSetShortName)}})(({isActive:e,query:t,featuredIds:a,resultIds:r,isModalOpen:i,onClose:o})=>{const{loadFeaturedStickers:l}=(0,s.ko)(),c=(0,n.li)(),d=(0,B.A)(),{observe:m}=(0,io.BL)({rootRef:c,throttleMs:200});return(0,n.vJ)(()=>{Mp(()=>{l()})}),(0,Ee.A)({isActive:e,onBack:o}),n.Ay.createElement("div",{ref:c,className:"StickerSearch custom-scroll",dir:d.isRtl?"rtl":void 0},function(){if(void 0!==t)return!t&&a?a.map(e=>n.Ay.createElement(Pp,{key:e,stickerSetId:e,observeIntersection:m,isModalOpen:i})):r?r.length?r.map(e=>n.Ay.createElement(Pp,{key:e,stickerSetId:e,observeIntersection:m,isModalOpen:i})):n.Ay.createElement("p",{className:"helper-text",dir:"auto"},"Nothing found."):n.Ay.createElement(Dn.A,null)}())})),xp=(0,n.ph)((0,s.EK)(e=>{const t=(0,c.Wy7)(e),{query:a,results:n}=t||{},{chatId:s,threadId:r}=(0,c.Xf0)(e)||{},i=s?(0,c.hds)(e,s):void 0,o=s?(0,c.AWZ)(e,s):void 0,d=i?(0,c.ALW)(e,i):void 0,m=Boolean(s)&&(0,c.nZ4)(e,s),u=s&&r?(0,c.Vw0)(e,s,r):void 0,A=Boolean(!u?.isCommentsInfo&&u?.fromChannelId),h=s&&r?(0,c.S0q)(e,s,r):void 0;return{query:a,results:n,chat:i,isChatWithBot:d,isSavedMessages:m,canPostInChat:Boolean(i)&&Boolean(r)&&(0,l.__)(i,h,A,o),canScheduleUntilOnline:Boolean(s)&&(0,c.RBq)(e,s),currentMessageList:(0,c.Xf0)(e)}})(({isActive:e,query:t,results:a,chat:r,chatFullInfo:i,isChatWithBot:o,canScheduleUntilOnline:c,isSavedMessages:d,canPostInChat:m,currentMessageList:u,onClose:A})=>{const{searchMoreGifs:h,sendMessage:y,setGifSearchQuery:p}=(0,s.ko)(),g=(0,n.li)(),[v,f]=(0,Ih.A)(c),{observe:b}=(0,io.BL)({rootRef:g,debounceMs:300}),C=m&&(0,l.Q_)(r,i,o,d).canSendGifs,S=(0,n.hb)((e,t,a)=>{if(C){if(!u)return;a?v(a=>{y({messageList:u,gif:e,scheduledAt:a,isSilent:t})}):y({messageList:u,gif:e,isSilent:t})}E.TF&&p({query:void 0})},[C,u,v]),k=(0,n.hb)(()=>{h()},[h]),w=(0,B.A)();(0,Ee.A)({isActive:e,onBack:A});const N=Boolean(void 0!==t&&a&&a.length);return n.Ay.createElement("div",{className:"GifSearch",dir:w.isRtl?"rtl":void 0},n.Ay.createElement(fn.A,{ref:g,className:(0,ue.A)("gif-container custom-scroll",N&&"grid"),items:a,itemSelector:".GifButton",preloadBackwards:96,noFastList:!0,onLoadMore:k},function(){if(void 0!==t)return a?a.length?a.map(e=>n.Ay.createElement(Wy,{key:e.id,gif:e,observeIntersection:b,onClick:C?S:void 0,isSavedMessages:d})):n.Ay.createElement("p",{className:"helper-text",dir:"auto"},w("NoGIFsFound")):n.Ay.createElement(Dn.A,null)}()),f)}));var Bp=a(75319),Lp=a(71950);const Rp="OAKzmAva",Fp="BQ6HUOqN",Dp="U96CW2I7",Vp="vXi2JQlj",_p="bi3fL59p",Up="GUK4ajPK",Op="YH6jeZIh",Jp="q1LnuIUn",Kp="PJZzyVLK",Gp="C7NpG5Y9",jp=(0,n.ph)(function({postStatistic:e}){const t=(0,B.A)(),a=(0,Ua.A)();return n.Ay.createElement("div",{className:Op},e.reactionsCount>0&&n.Ay.createElement("span",{className:Jp},n.Ay.createElement(Q.A,{name:"heart-outline",className:Kp}),(0,qe.Vw)(a,e.reactionsCount)),e.forwardsCount>0&&n.Ay.createElement("span",{className:Jp},n.Ay.createElement(Q.A,{name:"forward",className:Kp}),(0,qe.Vw)(a,e.forwardsCount)),!e.forwardsCount&&!e.reactionsCount&&t("ChannelStats.SharesCount_ZeroValueHolder"))}),zp=(0,n.ph)(({postStatistic:e,message:t})=>{const a=(0,B.A)(),{toggleMessageStatistics:r}=(0,s.ko)(),i=(0,Ud.A)(t),o=(0,_d.A)(t,"micro"),c=(0,H.A)(o),d=Boolean((0,l.lk)(t)),m=(0,n.hb)(()=>{r({messageId:t.id})},[r,t.id]);return n.Ay.createElement("div",{className:(0,ue.A)(Rp,Boolean(c||i)&&Fp),onClick:m},n.Ay.createElement("div",{className:_p},n.Ay.createElement("div",{className:Vp},function(e,t,a,s){return a?n.Ay.createElement("span",null,n.Ay.createElement("img",{src:a,alt:"",draggable:!1,className:(0,ue.A)(Dp,s&&"yxjDeIct")}),(0,l.zX)(t)&&n.Ay.createElement(Q.A,{name:"play"}),(0,y.C)(e,t,!0)):(0,y.C)(e,t)}(a,t,c||i,d)),n.Ay.createElement("div",{className:Op},a("ChannelStats.ViewsCount",e.viewsCount,"i"))),n.Ay.createElement("div",{className:Up},n.Ay.createElement("div",{className:Gp},(0,$e.L2)(1e3*t.date,a.code)),n.Ay.createElement(jp,{postStatistic:e})))}),Hp=(0,n.ph)(function({chat:e,story:t,postStatistic:a}){const r=(0,B.A)(),{toggleStoryStatistics:i}=(0,s.ko)(),o=t&&"content"in t,c=o?t.content.video:void 0,d=o?(0,l.EN)(t):void 0,m=(0,H.A)(d),u=m||c?.thumbnail?.dataUri,A=(0,x.A)(()=>{i({storyId:a.storyId})});return n.Ay.createElement("div",{className:(0,ue.A)(Rp,Fp),onClick:A},n.Ay.createElement("div",{className:_p},n.Ay.createElement("div",{className:Vp},function(e,t,a){return n.Ay.createElement("span",null,a?n.Ay.createElement("span",{className:"TmJvv2A6"},n.Ay.createElement("img",{src:a,alt:"",draggable:!1,className:(0,ue.A)(Dp,"cdfiLmXo","BOfHPv20")})):n.Ay.createElement(xt.A,{peer:t,size:"small",className:Dp,withStorySolid:!0,forceUnreadStorySolid:!0}),e("Story"))}(r,e,m||u)),n.Ay.createElement("div",{className:Op},r("ChannelStats.ViewsCount",a.viewsCount,"i"))),n.Ay.createElement("div",{className:Up},n.Ay.createElement("div",{className:Gp},o&&Boolean(t.date)&&(0,$e.L2)(1e3*t.date,r.code)),n.Ay.createElement(jp,{postStatistic:a})))}),$p="T1l_4J8z",qp="S1x1ovkC",Wp="WxL3i5PM",Qp="aUrozL5_",Yp="QQHwjG88",Zp="QGctP1Nk";let Xp,eg;const tg={growthGraph:"ChannelStats.Graph.Growth",followersGraph:"ChannelStats.Graph.Followers",muteGraph:"ChannelStats.Graph.Notifications",topHoursGraph:"ChannelStats.Graph.ViewsByHours",viewsBySourceGraph:"ChannelStats.Graph.ViewsBySource",newFollowersBySourceGraph:"ChannelStats.Graph.NewFollowersBySource",languagesGraph:"ChannelStats.Graph.Language",interactionsGraph:"ChannelStats.Graph.Interactions",reactionsByEmotionGraph:"ChannelStats.Graph.Reactions",storyInteractionsGraph:"ChannelStats.Graph.Stories",storyReactionsByEmotionGraph:"ChannelStats.Graph.StoriesReactions"},ag=Object.keys(tg),ng={growthGraph:"Stats.GroupGrowthTitle",membersGraph:"Stats.GroupMembersTitle",languagesGraph:"Stats.GroupLanguagesTitle",messagesGraph:"Stats.GroupMessagesTitle",actionsGraph:"Stats.GroupActionsTitle",topHoursGraph:"Stats.GroupTopHoursTitle"},sg=Object.keys(ng),rg=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const a=(0,c.gqw)(e,t),n=(0,c.hds)(e,t),s=(0,c.AWZ)(e,t)?.statisticsDcId,r="chatTypeSuperGroup"===n?.type,i=(0,c.zeq)(e,t),o=(0,c._bp)(e,t)?.byId;return{statistics:a,dcId:s,isGroup:r,chat:n,messagesById:i,storiesById:o}})(({chatId:e,chat:t,statistics:r,dcId:i,isGroup:o,messagesById:l,storiesById:c})=>{const d=(0,B.A)(),m=(0,n.li)(),[u,A]=(0,n.J0)(!1),h=(0,n.li)(new Set),y=(0,n.li)(new Set),{loadStatistics:p,loadStatisticsAsyncGraph:g}=(0,s.ko)(),v=(0,T.A)();(0,n.vJ)(()=>{p({chatId:e,isGroup:o})},[e,p,o]);const E=(0,n.Kr)(()=>o?sg:ag,[o]),f=(0,n.Kr)(()=>o?ng:tg,[o]);return(0,n.vJ)(()=>{r&&E.forEach(t=>{const a=r[t];(0,Bp.R)(a)&&"async"===a.graphType&&g({name:t,chatId:e,token:a.token,isPercentage:"languagesGraph"===t})})},[E,e,r,g]),(0,n.vJ)(()=>{(async()=>{await async function(){return Xp||(Xp=a.e(1184).then(a.bind(a,31184)),eg=await Xp),Xp}(),u?r&&m.current&&(E.forEach((e,t)=>{const a=r[e];if(!(0,Bp.R)(a))return;const n="async"===a.graphType,s="error"===a.graphType;if(n||h.current.has(e))return;if(s)return h.current.add(e),void y.current.add(e);const{zoomToken:o}=a;eg.create(m.current.children[t],{title:d(f[e]),...o?{onZoom:e=>(0,Ze.px)("fetchStatisticsAsyncGraph",{token:o,x:e,dcId:i}),zoomOutLabel:d("Graph.ZoomOut")}:{},...a}),h.current.add(e),m.current.children[t].classList.remove(Zp)}),v()):A(!0)})()},[E,f,u,r,d,e,g,i,v]),n.Ay.createElement("div",{className:(0,ue.A)($p,"panel-content custom-scroll",u&&Qp)},r&&n.Ay.createElement(Lp.A,{statistics:r,type:o?"group":"channel",title:d("StatisticOverview")}),!h.current.size&&n.Ay.createElement(Dn.A,null),n.Ay.createElement("div",{ref:m},E.map(e=>{const t=h.current.has(e)&&!y.current.has(e);return n.Ay.createElement("div",{className:(0,ue.A)(Yp,!t&&Zp)})})),Boolean(r?.recentPosts?.length)&&n.Ay.createElement("div",{className:"suY9dEIz"},n.Ay.createElement("h2",{className:"evQIkAqx"},d("ChannelStats.Recent.Header")),r.recentPosts.map(e=>{if("msgId"in e){const t=l[e.msgId];if(!t||!("content"in t))return;return n.Ay.createElement(zp,{key:`statistic_message_${e.msgId}`,message:t,postStatistic:e})}if("storyId"in e&&t){const a=c?.[e.storyId];return n.Ay.createElement(Hp,{key:`statistic_story_${e.storyId}`,chat:t,story:a,postStatistic:e})}})))})),ig="oXLpD4Y4",og="paQ2VBe_",lg="WvFuOAIf",cg=(0,n.ph)(({data:e})=>{const t=(0,B.A)(),{openChatByUsername:a}=(0,s.ko)(),r=(0,n.Kr)(()=>e.chat?(0,l.Kl)(e.chat):void 0,[e.chat]),i=(0,n.hb)(()=>{a({username:r,messageId:e.messageId})},[e.messageId,a,r]);return n.Ay.createElement("div",{className:(0,ue.A)(ig,"statistic-public-forward"),onClick:i},n.Ay.createElement(xt.A,{size:"medium",peer:e.chat}),n.Ay.createElement("div",null,n.Ay.createElement("div",{className:og},e.title),n.Ay.createElement("div",{className:lg},t("ChannelStats.ViewsCount",e.views,"i"))))});let dg,mg;const ug={viewsGraph:"Stats.MessageInteractionsTitle",reactionsGraph:"ReactionsByEmotionChartTitle"},Ag=Object.keys(ug),hg=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const a=(0,c.AWZ)(e,t)?.statisticsDcId,n=(0,c.nTw)(e);return{statistics:n.statistics.currentMessage,dcId:a,messageId:n.statistics.currentMessageId}})(function({chatId:e,isActive:t,statistics:i,dcId:o,messageId:l}){const c=(0,B.A)(),d=(0,n.li)(),[m,u]=(0,n.J0)(!1),A=(0,n.li)(new Set),h=(0,n.li)(new Set),{loadMessageStatistics:y,loadMessagePublicForwards:p,loadStatisticsAsyncGraph:g}=(0,s.ko)(),v=(0,T.A)();(0,n.vJ)(()=>{l&&y({chatId:e,messageId:l})},[e,y,l]),(0,n.vJ)(()=>{t&&!l||(A.current.clear(),h.current.clear(),u(!1))},[t,l]),(0,n.vJ)(()=>{i&&Ag.forEach(t=>{const a=i[t];(0,Bp.R)(a)&&"async"===a.graphType&&g({name:t,chatId:e,token:a.token})})},[e,i,g]),(0,n.vJ)(()=>{(async()=>{await async function(){return dg||(dg=a.e(1184).then(a.bind(a,31184)),mg=await dg),dg}(),m?i&&d.current&&(Ag.forEach((e,t)=>{const a=i[e];if(!(0,Bp.R)(a))return;const n="async"===a.graphType,s="error"===a.graphType;if(n||A.current.has(e))return;if(s)return A.current.add(e),void h.current.add(e);const{zoomToken:r}=a;mg.create(d.current.children[t],{title:c(ug[e]),...r?{onZoom:e=>(0,Ze.px)("fetchStatisticsAsyncGraph",{token:r,x:e,dcId:o}),zoomOutLabel:c("Graph.ZoomOut")}:{},...a}),A.current.add(e)}),v()):u(!0)})()},[m,i,c,e,l,g,o,v]);const E=(0,x.A)(({direction:t})=>{t===r.TN.Backwards&&l&&p({chatId:e,messageId:l})});return m&&i&&l?n.Ay.createElement("div",{key:`${e}-${l}`,className:(0,ue.A)($p,"custom-scroll",m&&Qp)},n.Ay.createElement(Lp.A,{statistics:i,type:"message",title:c("StatisticOverview")}),(!A.current.size||!i.publicForwardsData)&&n.Ay.createElement(Dn.A,null),n.Ay.createElement("div",{ref:d},Ag.map(e=>{const t=A.current.has(e)&&!h.current.has(e);return n.Ay.createElement("div",{className:(0,ue.A)(Yp,!t&&Zp)})})),Boolean(i.publicForwards)&&n.Ay.createElement("div",{className:qp},n.Ay.createElement("h2",{className:Wp},c("Stats.Message.PublicShares")),n.Ay.createElement(fn.A,{items:i.publicForwardsData,itemSelector:".statistic-public-forward",onLoadMore:E,noFastList:!0},i.publicForwardsData.map(e=>n.Ay.createElement(cg,{key:e.messageId,data:e}))))):n.Ay.createElement(Dn.A,null)})),yg=(0,n.ph)(function({data:e,chatsById:t,usersById:a}){const r=(0,B.A)(),{openChat:i}=(0,s.ko)(),o=a[e.peerId],c=t[e.peerId],d=(0,x.A)(()=>{i({id:o.id})});return n.Ay.createElement("div",{className:(0,ue.A)(ig,"statistic-public-forward"),onClick:d},n.Ay.createElement(xt.A,{size:"medium",peer:o||c,withStorySolid:!0,forceUnreadStorySolid:!0}),n.Ay.createElement("div",null,n.Ay.createElement("div",{className:og},o?(0,l.Yg)(o):(0,l.Js)(r,c)),n.Ay.createElement("div",{className:lg},e.viewsCount?r("ChannelStats.ViewsCount",e.viewsCount,"i"):r("NoViews"))))});let pg,gg;const vg={viewsGraph:"Stats.StoryInteractionsTitle",reactionsGraph:"ReactionsByEmotionChartTitle"},Eg=Object.keys(vg),fg=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const a=(0,c.AWZ)(e,t)?.statisticsDcId,n=(0,c.nTw)(e),s=n.statistics.currentStory,r=n.statistics.currentStoryId,{byId:i}=e.users,{byId:o}=e.chats;return{statistics:s,dcId:a,storyId:r,usersById:i,chatsById:o}})(function({chatId:e,isActive:t,statistics:r,dcId:i,storyId:o,chatsById:l,usersById:c}){const d=(0,B.A)(),m=(0,n.li)(),[u,A]=(0,n.J0)(!1),h=(0,n.li)(new Set),y=(0,n.li)(new Set),{loadStoryStatistics:p,loadStoryPublicForwards:g,loadStatisticsAsyncGraph:v}=(0,s.ko)(),E=(0,T.A)();(0,n.vJ)(()=>{o&&p({chatId:e,storyId:o})},[e,o]),(0,n.vJ)(()=>{t&&!o||(h.current.clear(),y.current.clear(),A(!1))},[t,o]),(0,n.vJ)(()=>{r&&Eg.forEach(t=>{const a=r[t];(0,Bp.R)(a)&&"async"===a.graphType&&v({name:t,chatId:e,token:a.token})})},[e,r,v]),(0,n.vJ)(()=>{(async()=>{await async function(){return pg||(pg=a.e(1184).then(a.bind(a,31184)),gg=await pg),pg}(),u?r&&m.current&&(Eg.forEach((e,t)=>{const a=r[e];if(!(0,Bp.R)(a))return;const n="async"===a.graphType,s="error"===a.graphType;if(n||h.current.has(e))return;if(s)return h.current.add(e),void y.current.add(e);const{zoomToken:o}=a;gg.create(m.current.children[t],{title:d(vg[e]),...o?{onZoom:e=>(0,Ze.px)("fetchStatisticsAsyncGraph",{token:o,x:e,dcId:i}),zoomOutLabel:d("Graph.ZoomOut")}:{},...a}),h.current.add(e)}),E()):A(!0)})()},[u,r,d,e,o,v,i,E]);const f=(0,x.A)(()=>{o&&g({chatId:e,storyId:o})});return u&&r&&o?n.Ay.createElement("div",{key:`${e}-${o}`,className:(0,ue.A)($p,"custom-scroll",u&&Qp)},n.Ay.createElement(Lp.A,{statistics:r,type:"story",title:d("StatisticOverview")}),!h.current.size&&n.Ay.createElement(Dn.A,null),n.Ay.createElement("div",{ref:m},Eg.map(e=>{const t=h.current.has(e)&&!y.current.has(e);return n.Ay.createElement("div",{className:(0,ue.A)(Yp,!t&&Zp)})})),Boolean(r.publicForwards)&&n.Ay.createElement("div",{className:qp},n.Ay.createElement("h2",{className:Wp},d("Stats.Message.PublicShares")),n.Ay.createElement(fn.A,{items:r.publicForwardsData,itemSelector:".statistic-public-forward",onLoadMore:f,noFastList:!0},r.publicForwardsData.map(e=>"messageId"in e?n.Ay.createElement(cg,{key:`message_${e.messageId}`,data:e}):n.Ay.createElement(yg,{key:`story_${e.storyId}`,data:e,chatsById:l,usersById:c}))))):n.Ay.createElement(Dn.A,null)}));var bg=a(55573);const Cg=(0,n.ph)((0,s.EK)((e,{answer:t})=>{const{voters:a,offsets:n}=(0,c.nTw)(e).pollResults;return{voters:a?.[t.option],offset:n?.[t.option]||""}})(({chat:e,message:t,answer:a,answerVote:r,totalVoters:i,voters:o,offset:l})=>{const{loadPollOptionResults:c,openChat:d,closePollResults:m}=(0,s.ko)(),u=(0,U.A)(r.votersCount),[h,y]=(0,n.J0)(!0),p=Boolean(o),{option:g,text:v}=a,E=(0,B.A)();(0,n.vJ)(()=>{p&&u===r.votersCount||c({chat:e,messageId:t.id,option:g,offset:l,limit:4,shouldResetVoters:!0})},[r.votersCount,p]);const f=(0,n.hb)(()=>{y(!0),c({chat:e,messageId:t.id,option:g,offset:l,limit:50})},[e,c,t.id,l,g]);(0,n.vJ)(()=>{y(!1)},[o]);const b=(0,n.hb)(e=>{d({id:e}),m()},[m,d]);return n.Ay.createElement("div",{className:"PollAnswerResults"},n.Ay.createElement("div",{className:"poll-voters"},o?o.map(e=>n.Ay.createElement(ca.A,{key:e,className:"chat-item-clickable",onClick:()=>b(e)},(0,A.L8)(e)?n.Ay.createElement(kn.A,{avatarSize:"tiny",userId:e,forceShowSelf:!0,noStatusOrTyping:!0}):n.Ay.createElement(Sn.A,{avatarSize:"tiny",chatId:e,noStatusOrTyping:!0}))):n.Ay.createElement(Dn.A,null),o&&function(){const e=r.votersCount-o.length;return r.votersCount>4&&e>0&&n.Ay.createElement(bg.A,{count:e,itemName:"voter",isLoading:h,onClick:f})}()),n.Ay.createElement("div",{className:"answer-head",dir:E.isRtl?"rtl":void 0},n.Ay.createElement("span",{className:"answer-title",dir:"auto"},(0,Xa.fd)({text:v.text,entities:v.entities})),n.Ay.createElement("span",{className:"answer-percent",dir:E.isRtl?"auto":void 0},(C=r.votersCount,(S=i)>0?(C/S*100).toFixed():0),"%")));var C,S})),Sg=(0,n.ph)((0,s.EK)(e=>{const{pollResults:{chatId:t,messageId:a}}=(0,c.nTw)(e);if(!t||!a)return{};const n=(0,c.hds)(e,t),s=(0,c.O5q)(e,t,a);return{chat:n,message:s,poll:s&&(0,c.zcZ)(e,s)}})(({isActive:e,chat:t,message:a,poll:s,onClose:r})=>{const i=(0,B.A)();if((0,Ee.A)({isActive:e,onBack:r}),!a||!s||!t)return n.Ay.createElement(Dn.A,null);const{summary:o,results:l}=s;if(!l.results)return;const c=(0,Ea.dU)(l.results,"option");return n.Ay.createElement("div",{className:"PollResults",dir:i.isRtl?"rtl":void 0},n.Ay.createElement("h3",{className:"poll-question",dir:"auto"},(0,Xa.fd)({text:o.question.text,entities:o.question.entities})),n.Ay.createElement("div",{className:"poll-results-list custom-scroll"},o.answers.map(e=>n.Ay.createElement(Cg,{key:`${s.id}-${e.option}`,chat:t,message:a,answer:e,answerVote:c[e.option],totalVoters:l.totalVoters}))))}));var kg=a(90603);const wg="xrnUE4e6",Ng="z7kF7tij",Ig="T6wFpdQO",Pg="CWsWIKQ1",Mg="KBl0ycLl",Tg="iJ1U9kDD",xg="Rk6PT_yc",Bg="qlo3vSEw",Lg="r06zwL42",Rg=5*h.$,Fg=(0,n.ph)((0,s.EK)(e=>{const{createTopicPanel:t}=(0,c.nTw)(e);return{chat:t?.chatId?(0,c.hds)(e,t.chatId):void 0,createTopicPanel:t,isCurrentUserPremium:(0,c.g29)(e)}})(({isActive:e,chat:t,createTopicPanel:a,isCurrentUserPremium:r,onClose:o})=>{const{createTopic:l,openPremiumModal:c}=(0,s.ko)(),[d,m]=(0,n.J0)(""),[u,A]=(0,n.J0)(0),[h,y]=(0,n.J0)(void 0),p=(0,B.A)(),g=Boolean(d),v=Boolean(a?.isLoading);(0,Ee.A)({isActive:e,onBack:o}),(0,n.vJ)(()=>{e||(m(""),y(void 0))},[e]);const E=(0,n.hb)(e=>{m(e.target.value)},[]),f=(0,n.hb)(()=>{A(e=>(0,Ir.A)((0,kg.e$)().length,e+1))},[]),b=(0,n.hb)(()=>{l({chatId:t.id,title:d,iconColor:(0,kg.e$)()[u],iconEmojiId:h})},[t,l,u,h,d]),C=(0,n.hb)(e=>{e.isFree||r||e.id===i.MyF?e.id!==i.MyF?y(e.id):y(void 0):c({initialSection:"animated_emoji"})},[r,c]),S=(0,n.Kr)(()=>({id:0,title:d,iconColor:(0,kg.e$)()[u],iconEmojiId:h}),[u,h,d]);if(t?.isForum)return n.Ay.createElement("div",{className:wg},n.Ay.createElement("div",{className:(0,ue.A)(Ng,"custom-scroll")},n.Ay.createElement("div",{className:(0,ue.A)(Ig,Pg)},n.Ay.createElement("span",{className:Bg},p("CreateTopicTitle")),n.Ay.createElement(ne.Ay,{name:"zoomFade",activeKey:Number(S.iconEmojiId)||0,shouldCleanup:!0,direction:1,className:Tg},n.Ay.createElement(_n.A,{topic:S,className:(0,ue.A)(xg,"K1CTKtBS"),onClick:f,size:Rg,noLoopLimit:!0})),n.Ay.createElement(Z.A,{value:d,onChange:E,label:p("lng_forum_topic_title"),disabled:v,teactExperimentControlled:!0})),n.Ay.createElement("div",{className:(0,ue.A)(Ig,Mg)},n.Ay.createElement(Vo,{idPrefix:"create-topic-icons-set-",isHidden:!e,loadAndPlay:e,onCustomEmojiSelect:C,className:Lg,pickerListClassName:"fab-padding-bottom",withDefaultTopicIcons:!0}))),n.Ay.createElement(ka.A,{isShown:g,disabled:v,onClick:b,ariaLabel:p("Save")},v?n.Ay.createElement(Ve.A,{color:"white"}):n.Ay.createElement(Q.A,{name:"check"})))})),Dg=5*h.$,Vg=(0,n.ph)((0,s.EK)(e=>{const{editTopicPanel:t}=(0,c.nTw)(e);return{chat:t?.chatId?(0,c.hds)(e,t.chatId):void 0,topic:t?.chatId&&t?.topicId?(0,c.S0q)(e,t.chatId,t.topicId):void 0,editTopicPanel:t,isCurrentUserPremium:(0,c.g29)(e)}})(({isActive:e,chat:t,topic:a,editTopicPanel:r,isCurrentUserPremium:o,onClose:l})=>{const{editTopic:c,openPremiumModal:d}=(0,s.ko)(),[m,u]=(0,n.J0)(""),[A,h]=(0,n.J0)(void 0),y=(0,B.A)(),p=Boolean(r?.isLoading),g=a?.id===i.HxB;(0,Ee.A)({isActive:e,onBack:l}),(0,n.vJ)(()=>{e||(u(""),h(void 0))},[e]),(0,n.vJ)(()=>{(a?.title||a?.iconEmojiId)&&(u(a.title),h(a.iconEmojiId))},[a]);const v=(0,n.Kr)(()=>m!==a?.title||A!==a?.iconEmojiId,[A,m,a?.iconEmojiId,a?.title]),E=(0,n.hb)(e=>{const t=e.target.value;u(t)},[]),f=(0,n.hb)(()=>{c({chatId:t.id,title:m,topicId:a.id,iconEmojiId:A})},[t,c,A,m,a]),b=(0,n.hb)(e=>{e.isFree||o||e.id===i.MyF?e.id!==i.MyF?h(e.id):h("0"):d({initialSection:"animated_emoji"})},[o,d]),C=(0,n.Kr)(()=>({...a,title:m,iconEmojiId:A}),[A,m,a]);if(t?.isForum)return n.Ay.createElement("div",{className:wg},n.Ay.createElement("div",{className:(0,ue.A)(Ng,"custom-scroll")},!a&&n.Ay.createElement(Dn.A,null),a&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:(0,ue.A)(Ig,Pg,g&&"YftUWqqw")},n.Ay.createElement("span",{className:Bg},y(g?"CreateGeneralTopicTitle":"CreateTopicTitle")),n.Ay.createElement(ne.Ay,{name:"zoomFade",activeKey:Number(C.iconEmojiId)||0,shouldCleanup:!0,direction:1,className:Tg},n.Ay.createElement(_n.A,{topic:C,className:xg,size:Dg,noLoopLimit:!0})),n.Ay.createElement(Z.A,{value:m,onChange:E,label:y("lng_forum_topic_title"),disabled:p,teactExperimentControlled:!0})),!g&&n.Ay.createElement("div",{className:(0,ue.A)(Ig,Mg)},n.Ay.createElement(Vo,{idPrefix:"edit-topic-icons-set-",isHidden:!e,loadAndPlay:e,onCustomEmojiSelect:b,className:Lg,pickerListClassName:"fab-padding-bottom",withDefaultTopicIcons:!0})))),n.Ay.createElement(ka.A,{isShown:v,disabled:p,onClick:f,ariaLabel:y("Save")},p?n.Ay.createElement(Ve.A,{color:"white"}):n.Ay.createElement(Q.A,{name:"check"})))})),_g="Please provide name",Ug=(0,n.ph)((0,s.EK)((e,{userId:t})=>{const a=(0,c.yps)(e,t),n=(0,c.vGo)(e,t),{progress:s}=(0,c.nTw)(e).management,r=(0,dr.d)(e,"aboutLength");return{userId:t,user:a,progress:s,currentBio:n?.bio,maxBioLength:r}})(({userId:e,user:t,progress:a,onClose:i,currentBio:o,isActive:c,maxBioLength:d})=>{const{setBotInfo:m,uploadProfilePhoto:u,uploadContactProfilePhoto:A,startBotFatherConversation:h}=(0,s.ko)(),[y,p,g]=(0,M.A)(!1),[v,E,f]=(0,M.A)(!1),[b,C]=(0,n.J0)(),S=(0,B.A)(),k=(0,n.Kr)(()=>t?(0,l.Kl)(t):void 0,[t]);(0,Ee.A)({isActive:c,onBack:i});const w=t?(0,l.u0)(t):"",[N,I]=(0,n.J0)(),[P,T]=(0,n.J0)(w||""),[L,R]=(0,n.J0)(o||""),F=t&&(0,l.cP)(t),D=(0,H.A)(F,!1,J.qZ.BlobUrl);(0,n.vJ)(()=>{g(),f()},[e]),(0,n.vJ)(()=>{T(w||""),R(o||"")},[w,o,t]),(0,n.vJ)(()=>{I(void 0)},[D]),(0,n.vJ)(()=>{a===r.TD.Complete&&(g(),f(),C(void 0))},[a]);const V=(0,x.A)(e=>{T(e.target.value),p(),b===_g&&C(void 0)}),_=(0,x.A)(e=>{R(e.target.value),p()}),U=(0,x.A)(e=>{I(e),E()}),O=(0,x.A)(()=>{const e=P.trim(),a=L.trim();e.length?(m({...y&&{bot:t,name:e,description:a}}),N&&u({file:N,...v&&{bot:t}})):C(_g)}),K=(0,x.A)(()=>{h({param:`${k}-intro`})}),G=(0,x.A)(()=>{h({param:`${k}-commands`})}),j=(0,x.A)(()=>{h({param:k})}),z=(0,n.li)(),$=(0,n.li)(!1),q=(0,x.A)(t=>{E(),A({userId:e,file:t,isSuggest:$.current})});if(!t)return;const W=a===r.TD.InProgress;return n.Ay.createElement("div",{className:"Management"},n.Ay.createElement("div",{className:"custom-scroll"},n.Ay.createElement("div",{className:"section"},n.Ay.createElement(bu.A,{currentAvatarBlobUrl:D,onChange:U,title:S("ChatSetPhotoOrVideo"),disabled:W}),n.Ay.createElement(Z.A,{id:"user-name",label:S("PaymentCheckoutName"),onChange:V,value:P,error:b===_g?b:void 0,teactExperimentControlled:!0}),n.Ay.createElement(Xl.A,{value:L,onChange:_,label:S("DescriptionPlaceholder"),disabled:W,maxLength:d,maxLengthIndicator:d?(d-L.length).toString():void 0})),n.Ay.createElement("div",{className:"section"},n.Ay.createElement("div",{className:"dialog-buttons"},n.Ay.createElement(ca.A,{icon:"bot-commands-filled",ripple:!0,onClick:K},n.Ay.createElement("span",null,S("BotEditIntro"))),n.Ay.createElement(ca.A,{icon:"bot-command",ripple:!0,onClick:G},n.Ay.createElement("span",null,S("BotEditCommands"))),n.Ay.createElement(ca.A,{icon:"bots",ripple:!0,onClick:j},n.Ay.createElement("span",null,S("BotChangeSettings"))),n.Ay.createElement("div",{className:"section-info section-info_push"},(0,Tt.A)(S("BotManageInfo"),["links"]))))),n.Ay.createElement(ka.A,{isShown:y||v,onClick:O,disabled:W,ariaLabel:S("Save")},W?n.Ay.createElement(Ve.A,{color:"white"}):n.Ay.createElement(Q.A,{name:"check"})),n.Ay.createElement(lA.A,{onChange:q,inputRef:z}))})),Og="Channel title can't be empty",Jg=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const a=(0,c.hds)(e,t),{management:n}=(0,c.nTw)(e),{progress:s}=n,{invites:r}=n.byChatId[t]||{},i=e.appConfig?.channelAutoTranslationLevelMin,o=a?.hasAutoTranslation,d=a?.level,m=!(!d||!i)&&d>=i;return{chat:a,chatFullInfo:(0,c.AWZ)(e,t),progress:s,canChangeInfo:(0,l.ub)(a,"changeInfo"),canInvite:(0,l.ub)(a,"inviteUsers"),exportedInvites:r,availableReactions:e.reactions.availableReactions,hasAutoTranslation:o,canToggleAutoTranslation:m}},(e,{chatId:t})=>Boolean((0,c.hds)(e,t)))(({chatId:e,chat:t,chatFullInfo:a,progress:i,canChangeInfo:o,canInvite:d,exportedInvites:m,isActive:u,availableReactions:A,onScreenSelect:h,onClose:y,hasAutoTranslation:p,canToggleAutoTranslation:g})=>{const{updateChat:v,closeManagement:E,leaveChannel:f,deleteChannel:b,openChat:C,loadExportedChatInvites:S,loadChatJoinRequests:k,toggleAutoTranslation:w}=(0,s.ko)(),N=t?.title||"",I=a?.about||"",P=Boolean(a?.linkedChatId),[T,L,R]=(0,M.A)(),[F,D]=(0,n.J0)(!1),[V,_]=(0,n.J0)(N),[U,O]=(0,n.J0)(I),[K,G]=(0,n.J0)(),[j,z]=(0,n.J0)(),$=t&&(0,l.cP)(t),q=(0,H.A)($,!1,J.qZ.BlobUrl),W=(0,B.A)(),Y=t&&(0,l.WX)(t),X=(0,x.A)(()=>{w({chatId:e,isEnabled:!p})});(0,Ee.A)({isActive:u,onBack:y}),(0,n.vJ)(()=>{d&&(S({chatId:e}),S({chatId:e,isRevoked:!0}),k({chatId:e}))},[e,d]),(0,n.vJ)(()=>{i===r.TD.Complete&&(D(!1),z(void 0))},[i]);const ee=(0,n.Kr)(()=>Object.keys(a?.adminMembersById||{}).length,[a?.adminMembersById]),te=a?.kickedMembers?.length||0,ae=(0,x.A)(()=>{h(r.je.ChatPrivacyType)}),ne=(0,x.A)(()=>{h(r.je.Discussion)}),se=(0,x.A)(()=>{h(r.je.Reactions)}),re=(0,x.A)(()=>{h(r.je.ChatAdministrators)}),ie=(0,x.A)(()=>{h(r.je.Invites)}),oe=(0,x.A)(()=>{h(r.je.JoinRequests)}),le=(0,x.A)(e=>{G(e),D(!0)}),ce=(0,x.A)(e=>{_(e.target.value),D(!0)}),de=(0,x.A)(e=>{O(e.target.value),D(!0)}),me=(0,x.A)(()=>{const t=V.trim(),a=U.trim();t.length?v({chatId:e,title:t,about:a,photo:K}):z(Og)}),ue=(0,x.A)(()=>{h(r.je.ChannelSubscribers)}),Ae=(0,x.A)(()=>{h(r.je.ChannelRemovedUsers)}),he=(0,x.A)(()=>{t.isCreator?b({chatId:t.id}):f({chatId:t.id}),R(),E(),C({id:void 0})}),ye=(0,n.Kr)(()=>{if(!a?.enabledReactions)return W("ReactionsOff");if("all"===a.enabledReactions.type)return W("ReactionsAll");const e=a.enabledReactions.allowed.length,t=A?.filter(e=>!e.isInactive).length||0;return t?`${e} / ${t}`:e.toString()},[A,a?.enabledReactions,W]),pe=(0,n.Kr)(()=>(0,l.gA)(t),[t]);if((0,c._ls)((0,s.mS)(),e)||t.isForbidden)return;const ge=i===r.TD.InProgress;return n.Ay.createElement("div",{className:"Management"},n.Ay.createElement("div",{className:"panel-content custom-scroll"},n.Ay.createElement("div",{className:"section"},n.Ay.createElement(bu.A,{currentAvatarBlobUrl:q,onChange:le,disabled:!o}),n.Ay.createElement("div",{className:"settings-edit"},n.Ay.createElement(Z.A,{id:"channel-title",label:W("EnterChannelName"),onChange:ce,value:V,error:j===Og?j:void 0,disabled:!o}),n.Ay.createElement(Xl.A,{id:"channel-about",label:W("DescriptionPlaceholder"),onChange:de,value:U,maxLength:255,maxLengthIndicator:(255-U.length).toString(),disabled:!o,noReplaceNewlines:!0})),t.isCreator&&n.Ay.createElement(ca.A,{icon:"lock",multiline:!0,onClick:ae},n.Ay.createElement("span",{className:"title"},W("ChannelType")),n.Ay.createElement("span",{className:"subtitle"},W(pe?"TypePublic":"TypePrivate"))),n.Ay.createElement(ca.A,{icon:"message",multiline:!0,onClick:ne,disabled:!o},n.Ay.createElement("span",{className:"title"},W("Discussion")),n.Ay.createElement("span",{className:"subtitle"},W(P?"DiscussionUnlink":"Add"))),d&&n.Ay.createElement(ca.A,{icon:"link",onClick:ie,multiline:!0,disabled:!m},n.Ay.createElement("span",{className:"title"},W("GroupInfo.InviteLinks")),n.Ay.createElement("span",{className:"subtitle"},m?(0,qe.Sm)(m.length):W("Loading"))),Boolean(t.joinRequests?.length)&&n.Ay.createElement(ca.A,{icon:"add-user-filled",onClick:oe,multiline:!0},n.Ay.createElement("span",{className:"title"},W("SubscribeRequests")),n.Ay.createElement("span",{className:"subtitle"},(0,qe.Sm)(t.joinRequests.length))),n.Ay.createElement(ca.A,{icon:"heart-outline",multiline:!0,onClick:se,disabled:!o},n.Ay.createElement("span",{className:"title"},W("Reactions")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},ye)),Y&&n.Ay.createElement(ca.A,{icon:"language",narrow:!0,ripple:!0,disabled:!g,onClick:X},n.Ay.createElement("span",null,W("AutomaticTranslation")),n.Ay.createElement(va.A,{id:"auto-translation",label:W("AutomaticTranslation"),checked:p}))),n.Ay.createElement("div",{className:"section"},n.Ay.createElement(ca.A,{icon:"admin",multiline:!0,onClick:re},n.Ay.createElement("span",{className:"title"},W("ChannelAdministrators")),n.Ay.createElement("span",{className:"subtitle"},ee)),n.Ay.createElement(ca.A,{icon:"group",multiline:!0,onClick:ue},n.Ay.createElement("span",{className:"title",dir:"auto"},W("ChannelSubscribers")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},(0,qe.Sm)(t.membersCount))),n.Ay.createElement(ca.A,{icon:"delete-user",multiline:!0,onClick:Ae},n.Ay.createElement("span",{className:"title"},W("ChannelBlockedUsers")),n.Ay.createElement("span",{className:"subtitle"},te))),n.Ay.createElement("div",{className:"section"},n.Ay.createElement(ca.A,{icon:"delete",ripple:!0,destructive:!0,onClick:L},t.isCreator?W("ChannelDelete"):W("LeaveChannel")))),n.Ay.createElement(ka.A,{isShown:F,onClick:me,disabled:ge,ariaLabel:W("Save")},ge?n.Ay.createElement(Ve.A,{color:"white"}):n.Ay.createElement(Q.A,{name:"check"})),n.Ay.createElement(ya.A,{isOpen:T,onClose:R,text:t.isCreator?W("ChannelDeleteAlert"):W("ChannelLeaveAlert"),confirmLabel:t.isCreator?W("ChannelDelete"):W("LeaveChannel"),confirmHandler:he,confirmIsDestructive:!0}))})),Kg=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const a=(0,c.hds)(e,t);return{chat:a,currentUserId:e.currentUserId,isChannel:a&&(0,l.WX)(a),adminMembersById:(0,c.AWZ)(e,t)?.adminMembersById}})(({isActive:e,chat:t,isChannel:a,currentUserId:i,adminMembersById:o,onScreenSelect:c,onChatMemberSelect:d,onClose:m})=>{const{toggleSignatures:u}=(0,s.ko)(),A=(0,B.A)();(0,Ee.A)({isActive:e,onBack:m});const h=Boolean(t?.areSignaturesShown),y=Boolean(t?.areProfilesShown),p=Boolean(t?.isCreator||t&&(0,l.ub)(t,"addAdmins")),g=a&&(0,l.ub)(t,"postMessages"),v=(0,n.Kr)(()=>{if(!o)return[];const[e,t]=(0,Ea.jB)(Object.values(o),e=>e.isOwner);return[...e,...t]},[o]),E=(0,x.A)(e=>{d(e.userId,e.promotedByUserId===i),c(r.je.ChatAdminRights)}),f=(0,x.A)(()=>{u({chatId:t.id,areProfilesEnabled:y,areSignaturesEnabled:!h})}),b=(0,x.A)(()=>{u({chatId:t.id,areProfilesEnabled:!y,areSignaturesEnabled:h})}),C=(0,x.A)(()=>{c(r.je.GroupAddAdmins)}),S=(0,x.A)(e=>{if(e.isOwner)return A("ChannelCreator");const t=(0,s.mS)().users.byId,a=e.promotedByUserId?t[e.promotedByUserId]:void 0;return a?A("EditAdminPromotedBy",(0,l.Yg)(a)):A("ChannelAdmin")});return n.Ay.createElement("div",{className:"Management"},n.Ay.createElement("div",{className:"panel-content custom-scroll"},n.Ay.createElement("div",{className:"section"},n.Ay.createElement(ca.A,{icon:"recent",multiline:!0,disabled:!0},n.Ay.createElement("span",{className:"title"},A("EventLog")),n.Ay.createElement("span",{className:"subtitle"},A(a?"EventLogInfoDetailChannel":"EventLogInfoDetail")))),n.Ay.createElement("div",{className:"section",dir:A.isRtl?"rtl":void 0},n.Ay.createElement("p",{className:"section-help",dir:"auto"},A(a?"Channel.Management.AddModeratorHelp":"Group.Management.AddModeratorHelp")),v.map(e=>n.Ay.createElement(ca.A,{key:e.userId,className:"chat-item-clickable",onClick:()=>E(e)},n.Ay.createElement(kn.A,{userId:e.userId,status:S(e),forceShowSelf:!0}))),n.Ay.createElement(ka.A,{isShown:p,onClick:C,ariaLabel:A("Channel.Management.AddModerator")},n.Ay.createElement(Q.A,{name:"add-user-filled"}))),g&&n.Ay.createElement("div",{className:"section"},n.Ay.createElement("div",{className:"ListItem narrow"},n.Ay.createElement(as.A,{checked:h,label:A("ChannelSignMessages"),onChange:f})),h&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:"ListItem narrow"},n.Ay.createElement(as.A,{checked:y,label:A("ChannelSignMessagesWithProfile"),onChange:b})),n.Ay.createElement("p",{className:"section-info section-info_push"},A("ChannelSignProfilesInfo"))))))})),Gg=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const a=(0,c.hds)(e,t),{isUsernameAvailable:n,checkedUsername:s,error:r}=(0,c.YK)(e,t);return{chat:a,isChannel:(0,l.WX)(a),progress:(0,c.nTw)(e).management.progress,error:r,isUsernameAvailable:n,checkedUsername:s,isProtected:a?.isProtected,maxPublicLinks:(0,dr.d)(e,"channelsPublic"),privateInviteLink:(0,c.AWZ)(e,t)?.inviteLink}},(e,{chatId:t})=>Boolean((0,c.hds)(e,t)&&(0,c.YK)(e,t)))(({chat:e,isActive:t,isChannel:a,progress:o,isUsernameAvailable:c,checkedUsername:d,error:m,isProtected:u,maxPublicLinks:A,privateInviteLink:h,onClose:y})=>{const{updatePublicLink:p,updatePrivateLink:g,toggleIsProtected:v,openLimitReachedModal:E,resetManagementError:f}=(0,s.ko)(),b=(0,n.Kr)(()=>e.usernames?.find(({isEditable:e})=>e),[e.usernames]),C=b?.username||"",S=(0,n.Kr)(()=>(0,l.gA)(e),[e]),[k,w]=(0,n.J0)(!1),[N,I]=(0,n.J0)(S?"public":"private"),[P,T]=(0,n.J0)(),[x,L,R]=(0,M.A)(),[F,D,V]=(0,M.A)(),_=(0,U.A)(c),O=k&&Boolean("public"===N&&(P||C&&""===P)&&(c??_)||"private"===N&&S);(0,Ee.A)({isActive:t,onBack:y}),(0,n.vJ)(()=>{w(!1)},[C]),(0,n.vJ)(()=>{N&&!h&&g()},[N,h,g]);const J=(0,n.hb)(t=>{T(t),w(!0),m&&f({chatId:e.id})},[e.id,m]),K=(0,n.hb)((e,t)=>{if(Object.values((0,s.mS)().chats.byId).filter(({isCreator:e,usernames:t})=>e&&t?.some(e=>e.isActive)).length>=A&&"public"===e){E({limit:"channelsPublic"});const e=t.currentTarget.closest(".radio-group");return e.querySelector("[value=public]").checked=!1,void(e.querySelector("[value=private]").checked=!0)}I(e),w(!0)},[A,E]),G=(0,n.hb)(t=>{v({chatId:e.id,isProtected:"protected"===t})},[e.id,v]),j=(0,n.hb)(()=>{S&&"private"===N?D():p({username:"public"===N&&P||""})},[S,D,N,p,P]),z=(0,n.hb)(()=>{p({username:"",shouldDisableUsernames:!0}),V()},[V,p]),H=(0,n.hb)(()=>{R(),g()},[R,g]),$=(0,B.A)(),q=a?"Channel":"Mega",W=a?"Channel":"Group",Y=[{value:"private",label:$(`${q}Private`),subLabel:$(`${q}PrivateInfo`)},{value:"public",label:$(`${q}Public`),subLabel:$(`${q}PublicInfo`)}],Z=[{value:"allowed",label:$("ChannelVisibility.Forwarding.Enabled")},{value:"protected",label:$("ChannelVisibility.Forwarding.Disabled")}],X=o===r.TD.InProgress,te="public"===N&&e.usernames&&e.usernames.length>0;return n.Ay.createElement("div",{className:"Management"},n.Ay.createElement("div",{className:"panel-content custom-scroll"},n.Ay.createElement("div",{className:"section",dir:$.isRtl?"rtl":void 0},n.Ay.createElement("h3",{className:"section-heading"},$(`${W}Type`)),n.Ay.createElement(ee.A,{selected:N,name:"channel-type",options:Y,onChange:K})),"private"===N?n.Ay.createElement("div",{className:"section",dir:$.isRtl?"rtl":void 0},h?n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(qo.A,{link:h,className:"invite-link"}),n.Ay.createElement("p",{className:"section-info",dir:$.isRtl?"rtl":void 0},$(`${q}PrivateLinkHelp`)),n.Ay.createElement(ca.A,{icon:"delete",ripple:!0,destructive:!0,onClick:L},$("RevokeLink")),n.Ay.createElement(ya.A,{isOpen:x,onClose:R,text:$("RevokeAlert"),confirmLabel:$("RevokeButton"),confirmHandler:H,confirmIsDestructive:!0})):n.Ay.createElement(Dn.A,null)):n.Ay.createElement("div",{className:"section no-border"},n.Ay.createElement("div",{className:"settings-input"},n.Ay.createElement(fu,{asLink:!0,currentUsername:C,isLoading:X,isUsernameAvailable:c,checkedUsername:d,onChange:J})),m===i.Y3M&&function(){const e=`${i.jsp}${i.NjX}`;return n.Ay.createElement("p",{className:"section-info",dir:"auto"},$("lng_username_purchase_available").replace("{link}","%PURCHASE_LINK%").split("%").map(t=>"PURCHASE_LINK"===t?n.Ay.createElement(Vl.A,{url:e,text:`@${i.NjX}`}):t))}(),n.Ay.createElement("p",{className:"section-info",dir:"auto"},$(`${W}.Username.CreatePublicLinkHelp`))),te&&n.Ay.createElement(pu,{chatId:e.id,usernames:e.usernames,onEditUsername:J}),n.Ay.createElement("div",{className:"section",dir:$.isRtl?"rtl":void 0},n.Ay.createElement("h3",{className:"section-heading"},$(a?"ChannelVisibility.Forwarding.ChannelTitle":"ChannelVisibility.Forwarding.GroupTitle")),n.Ay.createElement(ee.A,{selected:u?"protected":"allowed",name:"forwarding-type",options:Z,onChange:G}),n.Ay.createElement("p",{className:"section-info section-info_push"},$(a?"ChannelVisibility.Forwarding.ChannelInfo":"ChannelVisibility.Forwarding.GroupInfo")))),n.Ay.createElement(ka.A,{isShown:O,disabled:X,ariaLabel:$("Save"),onClick:j},X?n.Ay.createElement(Ve.A,{color:"white"}):n.Ay.createElement(Q.A,{name:"check"})),n.Ay.createElement(ya.A,{isOpen:F,onClose:V,text:$("ChannelVisibility.Confirm.MakePrivate.Channel",C),confirmHandler:z,confirmIsDestructive:!0}))})),jg=(0,n.ph)((0,s.EK)((e,{chat:t})=>{const{currentUserId:a}=e;return{currentUserId:a,chatMembers:(0,c.AWZ)(e,t.id)?.members}})(({chat:e,currentUserId:t,chatMembers:a,isOpen:r,onClose:i})=>{const{loadMoreMembers:o,deleteChatMember:l}=(0,s.ko)(),c=(0,B.A)(),[d,m]=(0,n.J0)(""),u=(0,n.Kr)(()=>{const e=(a||[]).reduce((e,a)=>(a.isAdmin||a.isOwner||a.userId===t||e.push(a.userId),e),[]);return(0,Mt.PU)({ids:e,query:d,type:"user"})},[a,t,d]),A=(0,x.A)(()=>{o({chatId:e.id})}),h=(0,x.A)(t=>{l({chatId:e.id,userId:t}),i()});return n.Ay.createElement(Kn,{isOpen:r,chatOrUserIds:u,searchPlaceholder:c("ChannelBlockUser"),search:d,onSearchChange:m,loadMore:A,onSelectChatOrUser:h,onClose:i})})),zg=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const a=(0,c.hds)(e,t),{byId:n}=e.users;return{chat:a,usersById:n,canDeleteMembers:a&&((0,l.ub)(a,"banUsers")||a.isCreator),removedMembers:(0,c.AWZ)(e,t)?.kickedMembers||fa.p,isChannel:a&&(0,l.WX)(a)}})(({chat:e,usersById:t,canDeleteMembers:a,removedMembers:r,isChannel:i,onClose:o,isActive:c})=>{const{updateChatMemberBannedRights:d}=(0,s.ko)(),m=(0,B.A)(),[u,A,h]=(0,M.A)();(0,Ee.A)({isActive:c,onBack:o});const y=(0,n.hb)(e=>{if(!e.kickedByUserId)return;const a=t[e.kickedByUserId];return a?m("UserRemovedBy",(0,l.Yg)(a)):void 0},[m,t]),p=(0,n.hb)(t=>{if(e)return[{title:m("Unblock"),icon:"delete",destructive:!0,handler:()=>d({chatId:e.id,userId:t.userId,bannedRights:{}})}]},[m,e,d]);return n.Ay.createElement("div",{className:"Management"},n.Ay.createElement("div",{className:"panel-content custom-scroll"},n.Ay.createElement("div",{className:"section",dir:m.isRtl?"rtl":void 0},n.Ay.createElement("p",{className:"section-help"},m(i?"NoBlockedChannel2":"NoBlockedGroup2")),r.map(e=>n.Ay.createElement(ca.A,{key:e.userId,className:"chat-item-clickable",ripple:!0,contextActions:p(e)},n.Ay.createElement(kn.A,{userId:e.userId,status:y(e),forceShowSelf:!0}))),a&&n.Ay.createElement(ka.A,{isShown:!0,onClick:A,ariaLabel:m("Channel.EditAdmin.Permission.BanUsers")},n.Ay.createElement(Q.A,{name:"add-user-filled"})),e&&a&&n.Ay.createElement(jg,{chat:e,isOpen:u,onClose:h}))))})),Hg=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const a=(0,c.hds)(e,t),{linkedChatId:n}=(0,c.AWZ)(e,t)||{},{forDiscussionIds:s,byId:r}=e.chats;return{chat:a,chatsByIds:r,forDiscussionIds:s,linkedChat:n?(0,c.hds)(e,n):void 0,isChannel:a&&(0,l.WX)(a)}})(({chat:e,onClose:t,isActive:a,chatId:o,chatsByIds:c,linkedChat:d,forDiscussionIds:m,isChannel:u,onScreenSelect:A})=>{const{loadGroupsForDiscussion:h,linkDiscussionGroup:y,unlinkDiscussionGroup:p,toggleJoinRequest:g,toggleJoinToSend:v}=(0,s.ko)(),[E,f]=(0,n.J0)(),[b,C,S]=(0,M.A)(),[k,w,N]=(0,M.A)(),[I,P]=(0,n.J0)(Boolean(d?.isJoinToSend)),[T,L]=(0,n.J0)(Boolean(d?.isJoinRequest)),R=(0,B.A)(),F=d?.id;(0,Ee.A)({isActive:a,onBack:t}),(0,n.vJ)(()=>{h()},[h]),(0,n.vJ)(()=>{a&&(P(d?.isJoinToSend||!1),L(d?.isJoinRequest||!1))},[d,a]);const D=(0,n.hb)(()=>{S(),p({channelId:u?o:F}),u||A(r.je.Initial)},[S,p,u,o,F,A]),V=(0,n.hb)(()=>{N(),y({channelId:o,chatId:E})},[N,y,o,E]),_=(0,n.hb)(e=>{P(e),v({chatId:F,isEnabled:e}),e||L(!1)},[F,v]),U=(0,n.hb)(e=>{L(e),g({chatId:F,isEnabled:e})},[F,g]);const O=(0,x.A)(()=>{A(r.je.NewDiscussionGroup)});return n.Ay.createElement("div",{className:"Management"},n.Ay.createElement("div",{className:"panel-content custom-scroll"},n.Ay.createElement("div",{className:"section"},n.Ay.createElement(So.A,{tgsUrl:Co.w.DiscussionGroups,size:i.Uyp,className:"section-icon"}),d&&n.Ay.createElement("div",null,d&&n.Ay.createElement(ca.A,{className:"chat-item-clickable",inactive:!0},n.Ay.createElement(Sn.A,{chatId:d.id})),n.Ay.createElement(ca.A,{icon:"delete",ripple:!0,destructive:!0,onClick:C},R(u?"DiscussionUnlinkGroup":"DiscussionUnlinkChannel")),n.Ay.createElement(ya.A,{isOpen:b,onClose:S,header:n.Ay.createElement("div",{className:"modal-header"},n.Ay.createElement(xt.A,{size:"tiny",peer:d}),n.Ay.createElement("div",{className:"modal-title"},R(u?"DiscussionUnlinkGroup":"DiscussionUnlinkChannel"))),textParts:(0,Tt.A)(R(u?"DiscussionUnlinkChannelAlert":"DiscussionUnlinkGroupAlert",d?.title),["br","simple_markdown"]),confirmLabel:R(u?"DiscussionUnlinkGroup":"DiscussionUnlinkChannel"),confirmHandler:D,confirmIsDestructive:!0})),!d&&n.Ay.createElement("div",null,n.Ay.createElement("p",{className:"section-help",dir:"auto"},R("DiscussionChannelHelp")),n.Ay.createElement("div",{teactFastList:!0},n.Ay.createElement(ca.A,{key:"create-group",icon:"group",ripple:!0,className:"create-item",withPrimaryColor:!0,teactOrderKey:0,onClick:O},R("DiscussionCreateGroup")),m?m.map((e,t)=>n.Ay.createElement(ca.A,{key:e,teactOrderKey:t+1,className:"chat-item-clickable scroll-item",onClick:()=>{f(e),w()}},n.Ay.createElement(Sn.A,{chatId:e}))):n.Ay.createElement(Id.A,{key:"nothing-found",teactOrderKey:0,text:"No discussion groups found"})),n.Ay.createElement("p",{className:"mt-4 mb-0 section-help",dir:"auto"},R("DiscussionChannelHelp2")),n.Ay.createElement(ya.A,{isOpen:k,onClose:N,header:function(){if(!E)return;const e=c[E];return e?n.Ay.createElement("div",{className:"modal-header"},n.Ay.createElement(xt.A,{size:"tiny",peer:e}),n.Ay.createElement("div",{className:"modal-title"},R("Channel.DiscussionGroup.LinkGroup"))):void 0}(),textParts:function(){if(!E)return;const t=c[E];return t?(0,l.gA)(t)?(0,Tt.A)(`Do you want to make **${t.title}** the discussion board for **${e?.title}**?`,["br","simple_markdown"]):(0,Tt.A)(`Do you want to make **${t.title}** the discussion board for **${e?.title}**?\n\nAnyone from the channel will be able to see messages in this group.`,["br","simple_markdown"]):void 0}(),confirmLabel:R("DiscussionLinkGroup"),confirmHandler:V}))),d&&n.Ay.createElement("div",{className:"section"},n.Ay.createElement("h3",{className:"section-heading"},R("ChannelSettingsJoinTitle")),n.Ay.createElement("div",{className:"ListItem narrow"},n.Ay.createElement(as.A,{checked:I,onCheck:_,label:R("ChannelSettingsJoinToSend")})),I&&n.Ay.createElement("div",{className:"ListItem narrow"},n.Ay.createElement(as.A,{checked:T,onCheck:U,label:R("ChannelSettingsJoinRequest")})),n.Ay.createElement("p",{className:"section-info section-info_push"},R(I?"ChannelSettingsJoinRequestInfo":"ChannelSettingsJoinToSendInfo")))))})),$g="Group title can't be empty",qg=["sendMessages","embedLinks","sendPolls","changeInfo","inviteUsers","pinMessages","manageTopics","sendPhotos","sendVideos","sendRoundvideos","sendVoices","sendAudios","sendDocs"],Wg=qg.length+1,Qg=(0,ye.sg)(e=>e(),500,!1),Yg=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const a=(0,c.hds)(e,t),n=(0,c.AWZ)(e,t),{management:s,limitReachedModal:r}=(0,c.nTw)(e),{progress:i}=s,o=Boolean(n?.linkedChatId),d=(0,l.yn)(a),{invites:m}=s.byChatId[t]||{},u=!o&&((0,l.ub)(a,"changeInfo")||a.isCreator);return{chat:a,chatFullInfo:n,progress:i,isBasicGroup:d,hasLinkedChannel:o,canChangeInfo:a.isCreator||(0,l.ub)(a,"changeInfo"),canBanUsers:a.isCreator||(0,l.ub)(a,"banUsers"),canInvite:a.isCreator||(0,l.ub)(a,"inviteUsers"),exportedInvites:m,isChannelsPremiumLimitReached:"channels"===r?.limit,availableReactions:e.reactions.availableReactions,canEditForum:u}},(e,{chatId:t})=>Boolean((0,c.hds)(e,t)))(({chatId:e,chat:t,chatFullInfo:a,progress:i,isBasicGroup:o,hasLinkedChannel:d,canChangeInfo:m,canBanUsers:u,canInvite:A,canEditForum:h,isActive:y,exportedInvites:p,isChannelsPremiumLimitReached:g,availableReactions:v,onScreenSelect:E,onClose:f})=>{const{togglePreHistoryHidden:b,updateChat:C,deleteChat:S,leaveChannel:k,deleteChannel:w,closeManagement:N,openChat:I,loadExportedChatInvites:P,loadChatJoinRequests:T,toggleForum:L}=(0,s.ko)(),[R,F,D]=(0,M.A)(),V=t.title,_=a?.about||"",[U,O]=(0,n.J0)(!1),[K,G]=(0,n.J0)(V),[j,z]=(0,n.J0)(_),[$,q]=(0,n.J0)(),[W,Y]=(0,n.J0)(),[X,ee]=(0,n.J0)(t.isForum),te=(0,l.cP)(t),ae=(0,H.A)(te,!1,J.qZ.BlobUrl),ne=(0,n.Kr)(()=>(0,l.gA)(t),[t]),se=(0,B.A)(),re=(0,n.li)();(0,Ee.A)({isActive:y,onBack:f}),(0,n.vJ)(()=>{A&&(P({chatId:e}),P({chatId:e,isRevoked:!0}),T({chatId:e}))},[e,A]),(0,n.vJ)(()=>{ee(Boolean(t.isForum))},[t.isForum]),(0,n.vJ)(()=>{i===r.TD.Complete&&(O(!1),Y(void 0))},[i]);const ie=(0,x.A)(()=>{E(r.je.ChatPrivacyType)}),oe=(0,x.A)(()=>{E(r.je.Discussion)}),le=(0,x.A)(()=>{E(r.je.Reactions)}),ce=(0,x.A)(()=>{E(r.je.GroupPermissions)}),de=(0,x.A)(()=>{E(r.je.ChatAdministrators)}),me=(0,x.A)(()=>{E(r.je.Invites)}),ue=(0,x.A)(()=>{E(r.je.JoinRequests)}),Ae=(0,x.A)(e=>{q(e),O(!0)}),he=(0,x.A)(e=>{G(e.target.value),O(!0)}),ye=(0,x.A)(e=>{z(e.target.value),O(!0)}),pe=(0,x.A)(()=>{const t=K.trim(),a=j.trim();t.length?C({chatId:e,title:t,about:a,photo:$}):Y($g)}),ge=(0,x.A)(()=>{E(r.je.GroupMembers)}),ve=(0,x.A)(()=>{if(!a)return;const{isPreHistoryHidden:e}=a;b({chatId:t.id,isEnabled:!e})}),fe=(0,x.A)(()=>{ee(t=>{const a=!t;return Qg(()=>{L({chatId:e,isEnabled:a})}),a})});(0,n.vJ)(()=>{if(!g)return;const e=re.current?.querySelector("input");e.checked=!a?.isPreHistoryHidden},[g,a?.isPreHistoryHidden]);const be=(0,n.Kr)(()=>{if(!a?.enabledReactions)return se("ReactionsOff");if("all"===a.enabledReactions.type)return se("ReactionsAll");const e=a.enabledReactions.allowed.length,t=v?.filter(e=>!e.isInactive).length||0;return t?`${e} / ${t}`:e.toString()},[v,a?.enabledReactions,se]),Ce=(0,n.Kr)(()=>{if(!t.defaultBannedRights)return 0;let e=qg.filter(e=>!("manageTopics"===e&&!X||t.defaultBannedRights[e])).length;const{sendStickers:a,sendGifs:n}=t.defaultBannedRights;return a||n||(e+=1),e},[t.defaultBannedRights,X]),Se=(0,n.Kr)(()=>Object.keys(a?.adminMembersById||{}).length,[a?.adminMembersById]),ke=(0,x.A)(()=>{o?S({chatId:t.id}):t.isCreator?w({chatId:t.id}):k({chatId:t.id}),D(),N(),I({id:void 0})});if((0,c._ls)((0,s.mS)(),e)||t.isForbidden)return;const we=i===r.TD.InProgress;return n.Ay.createElement("div",{className:"Management"},n.Ay.createElement("div",{className:"panel-content custom-scroll"},n.Ay.createElement("div",{className:"section"},n.Ay.createElement(bu.A,{isForForum:X,currentAvatarBlobUrl:ae,onChange:Ae,disabled:!m}),n.Ay.createElement("div",{className:"settings-edit"},n.Ay.createElement(Z.A,{id:"group-title",label:se("GroupName"),onChange:he,value:K,error:W===$g?W:void 0,disabled:!m}),n.Ay.createElement(Xl.A,{id:"group-about",label:se("DescriptionPlaceholder"),maxLength:255,maxLengthIndicator:(255-j.length).toString(),onChange:ye,value:j,disabled:!m,noReplaceNewlines:!0})),t.isCreator&&n.Ay.createElement(ca.A,{icon:"lock",multiline:!0,onClick:ie},n.Ay.createElement("span",{className:"title"},se("GroupType")),n.Ay.createElement("span",{className:"subtitle"},se(ne?"TypePublic":"TypePrivate"))),d&&n.Ay.createElement(ca.A,{icon:"message",multiline:!0,onClick:oe},n.Ay.createElement("span",{className:"title"},se("LinkedChannel")),n.Ay.createElement("span",{className:"subtitle"},se("DiscussionUnlink"))),n.Ay.createElement(ca.A,{icon:"permissions",multiline:!0,onClick:ce,disabled:!u},n.Ay.createElement("span",{className:"title"},se("ChannelPermissions")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},Ce,"/",Wg-(X?0:1))),n.Ay.createElement(ca.A,{icon:"heart-outline",multiline:!0,onClick:le,disabled:!m},n.Ay.createElement("span",{className:"title"},se("Reactions")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},be)),n.Ay.createElement(ca.A,{icon:"admin",multiline:!0,onClick:de},n.Ay.createElement("span",{className:"title"},se("ChannelAdministrators")),n.Ay.createElement("span",{className:"subtitle"},(0,qe.Sm)(Se))),A&&n.Ay.createElement(ca.A,{icon:"link",onClick:me,multiline:!0,disabled:!p},n.Ay.createElement("span",{className:"title"},se("GroupInfo.InviteLinks")),n.Ay.createElement("span",{className:"subtitle"},p?(0,qe.Sm)(p.length):se("Loading"))),Boolean(t.joinRequests?.length)&&n.Ay.createElement(ca.A,{icon:"add-user-filled",onClick:ue,multiline:!0},n.Ay.createElement("span",{className:"title"},se("MemberRequests")),n.Ay.createElement("span",{className:"subtitle"},(0,qe.Sm)(t.joinRequests.length))),h&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(ca.A,{icon:"forums",ripple:!0,onClick:fe},n.Ay.createElement("span",null,se("ChannelTopics")),n.Ay.createElement(va.A,{id:"group-notifications",label:se("ChannelTopics"),checked:X,inactive:!0})),n.Ay.createElement("div",{className:"section-info section-info_push"},se("ForumToggleDescription")))),n.Ay.createElement("div",{className:"section"},n.Ay.createElement(ca.A,{icon:"group",multiline:!0,onClick:ge},n.Ay.createElement("span",{className:"title"},se("GroupMembers")),n.Ay.createElement("span",{className:"subtitle"},(0,qe.Sm)(t.membersCount??0))),!ne&&!d&&Boolean(a)&&n.Ay.createElement("div",{className:"ListItem narrow",ref:re},n.Ay.createElement(as.A,{checked:!a.isPreHistoryHidden,label:se("ChatHistory"),onChange:ve,subLabel:a.isPreHistoryHidden?se("ChatHistoryHiddenInfo2"):se("ChatHistoryVisibleInfo"),disabled:!u}))),n.Ay.createElement("div",{className:"section"},n.Ay.createElement(ca.A,{icon:"delete",ripple:!0,destructive:!0,onClick:F},se("DeleteMega")))),n.Ay.createElement(ka.A,{isShown:U,onClick:pe,disabled:we,ariaLabel:se("Save")},we?n.Ay.createElement(Ve.A,{color:"white"}):n.Ay.createElement(Q.A,{name:"check"})),n.Ay.createElement(ya.A,{isOpen:R,onClose:D,textParts:(0,Tt.A)(o||!t.isCreator?se("AreYouSureDeleteAndExit"):se("AreYouSureDeleteThisChatWithGroup",t.title),["br","simple_markdown"]),confirmLabel:o||!t.isCreator?se("DeleteMega"):se("DeleteGroupForAll"),confirmHandler:ke,confirmIsDestructive:!0}))})),Zg=(0,n.ph)((0,s.EK)((e,{chatId:t,isPromotedByCurrentUser:a})=>{const n=(0,c.hds)(e,t),s=(0,c.AWZ)(e,t),{byId:r}=e.users,{currentUserId:i}=e,o=(0,l.WX)(n),d=!(n.isCreator||a);return{chat:n,usersById:r,currentUserId:i,isChannel:o,isForum:n.isForum,isFormFullyDisabled:d,defaultRights:n.adminRights,hasFullInfo:Boolean(s),adminMembersById:s?.adminMembersById}},(e,{chatId:t})=>Boolean((0,c.hds)(e,t)))(({isActive:e,isNewAdmin:t,selectedUserId:a,defaultRights:i,chat:o,usersById:c,currentUserId:d,adminMembersById:m,hasFullInfo:u,isChannel:A,isForum:h,isFormFullyDisabled:y,onClose:p,onScreenSelect:g})=>{const{updateChatAdmin:v}=(0,s.ko)(),[E,f]=(0,n.J0)({}),[b,C]=(0,n.J0)(Boolean(t)),[S,k]=(0,n.J0)(!1),[w,N,I]=(0,M.A)(),[P,T]=(0,n.J0)(""),x=(0,B.A)();(0,Ee.A)({isActive:e,onBack:p});const L=(0,n.Kr)(()=>{const e=a?m?.[a]:void 0;if(!t||!e&&a){if(t){const e=(0,s.mS)().users.byId[a];return e?{userId:e.id,adminRights:i,customTitle:x("ChannelAdmin"),isOwner:!1,promotedByUserId:void 0}:void 0}return e}},[m,i,t,x,a]);(0,n.vJ)(()=>{u&&a&&!L&&g(r.je.ChatAdministrators)},[o,u,g,L,a]),(0,n.vJ)(()=>{f(L?.adminRights||{}),T((L?.customTitle||"").substr(0,16)),C(Boolean(t)),k(!1)},[i,t,L]);const R=(0,n.hb)(e=>{const{name:t}=e.target;f(e=>{return{...e,[t]:(a=e[t],!a||void 0)};var a}),C(!0)},[]),F=(0,n.hb)(()=>{a&&(k(!0),v({chatId:o.id,userId:a,adminRights:E,customTitle:P}))},[a,v,o.id,E,P]),D=(0,n.hb)(()=>{a&&(v({chatId:o.id,userId:a,adminRights:{}}),I())},[o.id,I,a,v]),V=(0,n.hb)(e=>!((0,l.yn)(o)||!y&&o.adminRights&&(o.isCreator||o.adminRights[e])),[o,y]),_=(0,n.Kr)(()=>{if(t||!L)return;if(L.isOwner)return x("ChannelCreator");const e=L.promotedByUserId?c[L.promotedByUserId]:void 0;return e?x("EditAdminPromotedBy",(0,l.Yg)(e)):x("ChannelAdmin")},[t,L,c,x]),U=(0,n.hb)(e=>{const{value:t}=e.target;T(t),C(!0)},[]);if(L)return n.Ay.createElement("div",{className:"Management"},n.Ay.createElement("div",{className:"panel-content custom-scroll"},n.Ay.createElement("div",{className:"section"},n.Ay.createElement(ca.A,{inactive:!0,className:"chat-item-clickable"},n.Ay.createElement(kn.A,{userId:L.userId,status:_,forceShowSelf:!0})),n.Ay.createElement("h3",{className:"section-heading mt-4",dir:"auto"},x("EditAdminWhatCanDo")),n.Ay.createElement("div",{className:"ListItem"},n.Ay.createElement(as.A,{name:"changeInfo",checked:Boolean(E.changeInfo),label:x(A?"EditAdminChangeChannelInfo":"EditAdminChangeGroupInfo"),blocking:!0,disabled:V("changeInfo"),onChange:R})),A&&n.Ay.createElement("div",{className:"ListItem"},n.Ay.createElement(as.A,{name:"postMessages",checked:Boolean(E.postMessages),label:x("EditAdminPostMessages"),blocking:!0,disabled:V("postMessages"),onChange:R})),A&&n.Ay.createElement("div",{className:"ListItem"},n.Ay.createElement(as.A,{name:"editMessages",checked:Boolean(E.editMessages),label:x("EditAdminEditMessages"),blocking:!0,disabled:V("editMessages"),onChange:R})),n.Ay.createElement("div",{className:"ListItem"},n.Ay.createElement(as.A,{name:"deleteMessages",checked:Boolean(E.deleteMessages),label:x(A?"EditAdminDeleteMessages":"EditAdminGroupDeleteMessages"),blocking:!0,disabled:V("deleteMessages"),onChange:R})),n.Ay.createElement("div",{className:"ListItem"},n.Ay.createElement(as.A,{name:"postStories",checked:Boolean(E.postStories),label:x("EditAdminPostStories"),blocking:!0,disabled:V("postStories"),onChange:R})),n.Ay.createElement("div",{className:"ListItem"},n.Ay.createElement(as.A,{name:"editStories",checked:Boolean(E.editStories),label:x("EditAdminEditStories"),blocking:!0,disabled:V("editStories"),onChange:R})),n.Ay.createElement("div",{className:"ListItem"},n.Ay.createElement(as.A,{name:"deleteStories",checked:Boolean(E.deleteStories),label:x("EditAdminDeleteStories"),blocking:!0,disabled:V("deleteStories"),onChange:R})),!A&&n.Ay.createElement("div",{className:"ListItem"},n.Ay.createElement(as.A,{name:"banUsers",checked:Boolean(E.banUsers),label:x("EditAdminBanUsers"),blocking:!0,disabled:V("banUsers"),onChange:R})),n.Ay.createElement("div",{className:"ListItem"},n.Ay.createElement(as.A,{name:"inviteUsers",checked:Boolean(E.inviteUsers),label:x("EditAdminAddUsers"),blocking:!0,disabled:V("inviteUsers"),onChange:R})),!A&&n.Ay.createElement("div",{className:"ListItem"},n.Ay.createElement(as.A,{name:"pinMessages",checked:Boolean(E.pinMessages),label:x("EditAdminPinMessages"),blocking:!0,disabled:V("pinMessages"),onChange:R})),n.Ay.createElement("div",{className:"ListItem"},n.Ay.createElement(as.A,{name:"addAdmins",checked:Boolean(E.addAdmins),label:x("EditAdminAddAdmins"),blocking:!0,disabled:V("addAdmins"),onChange:R})),n.Ay.createElement("div",{className:"ListItem"},n.Ay.createElement(as.A,{name:"manageCall",checked:Boolean(E.manageCall),label:x("StartVoipChatPermission"),blocking:!0,disabled:V("manageCall"),onChange:R})),h&&n.Ay.createElement("div",{className:"ListItem"},n.Ay.createElement(as.A,{name:"manageTopics",checked:Boolean(E.manageTopics),label:x("ManageTopicsPermission"),blocking:!0,disabled:V("manageTopics"),onChange:R})),!A&&n.Ay.createElement("div",{className:"ListItem"},n.Ay.createElement(as.A,{name:"anonymous",checked:Boolean(E.anonymous),label:x("EditAdminSendAnonymously"),blocking:!0,disabled:V("anonymous"),onChange:R})),y&&n.Ay.createElement("p",{className:"section-info mb-4",dir:"auto"},x("Channel.EditAdmin.CannotEdit")),!A&&n.Ay.createElement(Z.A,{id:"admin-title",label:x("EditAdminRank"),onChange:U,value:P,disabled:y,maxLength:16}),d!==a&&!y&&!t&&n.Ay.createElement(ca.A,{icon:"delete",ripple:!0,destructive:!0,onClick:N},x("EditAdminRemoveAdmin")))),n.Ay.createElement(ka.A,{isShown:b,onClick:F,ariaLabel:x("Save"),disabled:S},S?n.Ay.createElement(Ve.A,{color:"white"}):n.Ay.createElement(Q.A,{name:"check"})),!t&&n.Ay.createElement(ya.A,{isOpen:w,onClose:I,text:"Are you sure you want to dismiss this admin?",confirmLabel:x("Channel.Admin.Dismiss"),confirmHandler:D,confirmIsDestructive:!0}))}));var Xg=a(23459),ev=a(285);const tv=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const a=(0,c.hds)(e,t),{statusesById:n}=e.users,{members:s,adminMembersById:r,areParticipantsHidden:i}=(0,c.AWZ)(e,t)||{},o=a&&(0,l.WX)(a),{userIds:d}=e.contactList||{},m=e.appConfig?.hiddenMembersMinCount,u=a&&(a.isCreator||(0,l.ub)(a,"banUsers")),A=u&&!(0,l.yn)(a)&&void 0!==a.membersCount&&void 0!==m&&a.membersCount>=m,h=a&&((0,l.ub)(a,"inviteUsers")||!o&&!(0,l.Sq)(a,"inviteUsers")||a.isCreator),{query:y,fetchingStatus:p,globalUserIds:g,localUserIds:v}=(0,c.nTw)(e).userSearch;return{areParticipantsHidden:Boolean(a&&i),members:s,canAddMembers:h,adminMembersById:r,userStatusesById:n,isChannel:o,localContactIds:d,searchQuery:y,isSearching:p,globalUserIds:g,localUserIds:v,canDeleteMembers:u,currentUserId:e.currentUserId,canHideParticipants:A}})(({chatId:e,noAdmins:t,members:a,canAddMembers:i,adminMembersById:o,userStatusesById:c,isChannel:d,isActive:m,globalUserIds:u,localContactIds:A,localUserIds:h,isSearching:y,searchQuery:p,currentUserId:g,canDeleteMembers:v,areParticipantsHidden:E,canHideParticipants:f,onClose:b,onScreenSelect:C,onChatMemberSelect:S})=>{const{openChat:k,setUserSearchQuery:w,closeManagement:N,toggleParticipantsHidden:I,setNewChatMembersDialogState:P,toggleManagement:M}=(0,s.ko)(),T=(0,B.A)(),L=(0,n.li)(),R=(0,n.li)(),[F,D]=(0,n.J0)(),V=(0,n.Kr)(()=>t&&o?Object.keys(o):[],[o,t]),_=(0,n.Kr)(()=>{const e=(0,s.mS)().users.byId;if(!a||!e)return[];const n=(0,l.UB)(a.map(({userId:e})=>e),e,c);return t?n.filter(e=>!V.includes(e)):n},[a,c,t,V]);(0,Xg.A)(_);const U=(0,n.Kr)(()=>{const e=(0,s.mS)().users.byId,a=Boolean(p),n=a?A?(0,Mt.PU)({ids:A,query:p,type:"user"}):[]:_;return(0,xn.A)((0,Ea.Am)([...n,...a&&h||[],...a&&u||[]]).filter(a=>{const n=e[a];return!n||(d||n.canBeInvitedToGroup||!(0,l.tv)(n))&&(!t||!V.includes(a))}),!0)},[_,A,p,h,u,d,t,V]),[O,J]=(0,Ln.A)(void 0,U,Boolean(p)),K=(0,x.A)(e=>{t?(S(e,!0),C(r.je.ChatNewAdminRights)):(N(),k({id:e}))}),G=(0,x.A)(e=>{w({query:e.target.value})}),j=(0,Fn.A)(R,m,e=>{O&&O.length>0&&K(O[-1===e?0:e])},".ListItem-button",!0),z=(0,x.A)(()=>{D(void 0)}),H=(0,x.A)(()=>{I({chatId:e,isEnabled:!E})}),$=(0,x.A)(()=>{M(),P({newChatMembersProgress:r.D7.InProgress})});return(0,Ee.A)({isActive:m,onBack:b}),n.Ay.createElement("div",{className:"Management"},t&&n.Ay.createElement("div",{className:"Management__filter",dir:T.isRtl?"rtl":void 0},n.Ay.createElement(Z.A,{ref:L,value:p,onChange:G,placeholder:T("Search")})),n.Ay.createElement("div",{className:"panel-content custom-scroll"},f&&!d&&n.Ay.createElement("div",{className:"section"},n.Ay.createElement(ca.A,{icon:"group",ripple:!0,onClick:H},n.Ay.createElement("span",null,T("ChannelHideMembers")),n.Ay.createElement(va.A,{label:T("ChannelHideMembers"),checked:E})),n.Ay.createElement("p",{className:"section-info"},T(E?"GroupMembers.MembersHiddenOn":"GroupMembers.MembersHiddenOff"))),n.Ay.createElement("div",{className:"section"},O?.length?n.Ay.createElement(fn.A,{className:"picker-list custom-scroll",items:U,onLoadMore:J,noScrollRestore:Boolean(p),ref:R,onKeyDown:j},O.map(e=>{return n.Ay.createElement(ca.A,{key:e,className:"chat-item-clickable scroll-item",onClick:()=>K(e),contextActions:(t=e,t!==g&&v?[{title:T("lng_context_remove_from_group"),icon:"stop",handler:()=>{D(t)}}]:void 0),withPortalForMenu:!0},n.Ay.createElement(kn.A,{userId:e,forceShowSelf:!0,withStory:!0}));var t})):y||!O||O.length?n.Ay.createElement(Dn.A,null):n.Ay.createElement(Id.A,{teactOrderKey:0,key:"nothing-found",text:d?"No subscribers found":"No members found"}))),i&&n.Ay.createElement(ka.A,{isShown:!0,onClick:$,ariaLabel:T("lng_channel_add_users")},n.Ay.createElement(Q.A,{name:"add-user-filled"})),v&&n.Ay.createElement(ev.A,{isOpen:Boolean(F),userId:F,onClose:z}))})),av=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const a=(0,c.hds)(e,t),n=(0,c.AWZ)(e,t),{progress:s}=(0,c.nTw)(e).management,r=a?.paidMessagesStars,o=e.appConfig?.starsPaidMessageCommissionPermille;return{chat:a,progress:s,currentUserId:e.currentUserId,removedUsersCount:n?.kickedMembers?.length||0,members:n?.members,arePaidMessagesAvailable:Boolean(n?.arePaidMessagesAvailable&&o),canChargeForMessages:Boolean(r&&o),groupPeersPaidStars:r||i.wZe}})(({onScreenSelect:e,onChatMemberSelect:t,chat:a,progress:i,currentUserId:o,removedUsersCount:l,members:c,onClose:d,isActive:m,arePaidMessagesAvailable:u,canChargeForMessages:A,groupPeersPaidStars:h})=>{const{updateChatDefaultBannedRights:y,updatePaidMessagesPrice:p}=(0,s.ko)(),{permissions:g,havePermissionChanged:v,isLoading:E,handlePermissionChange:f,setIsLoading:b}=yc(a?.defaultBannedRights),C=(0,B.A)(),S=(0,Ua.A)();(0,Ee.A)({isActive:m,onBack:d});const k=(0,n.hb)(()=>{e(r.je.GroupRemovedUsers)},[e]),w=(0,n.hb)(()=>{e(r.je.GroupUserPermissionsCreate)},[e]),N=(0,n.hb)(a=>{t(a.userId,a.promotedByUserId===o),e(r.je.GroupUserPermissions)},[o,t,e]),[I,P]=(0,n.J0)(!1),[T,L,R]=(0,M.A)(),[F,D]=(0,n.J0)(A),[V,_]=(0,n.J0)(h);(0,n.vJ)(()=>{i===r.TD.Complete&&R()},[i]);const U=(0,x.A)(()=>{a&&(b(!0),y({chatId:a.id,bannedRights:g}))}),O=(0,x.A)(()=>{a&&p({chatId:a?.id,paidMessagesStars:F?V:0})}),J=(0,x.A)(()=>{T&&O(),v&&U()}),K=(0,n.Kr)(()=>c?c.filter(({bannedRights:e})=>Boolean(e)):[],[c]),G=(0,n.hb)(e=>{const{bannedRights:t}=e;if(!t||!a)return;const{defaultBannedRights:n}=a;return Object.keys(t).reduce((e,a)=>{const s=a;if(!t[s]||n?.[s]||"sendInline"===s||"viewMessages"===s||"sendGames"===s)return e;const r=function(e){switch(e){case"sendMessages":return"UserRestrictionsNoSend";case"sendMedia":return"UserRestrictionsNoSendMedia";case"sendStickers":return"UserRestrictionsNoSendStickers";case"embedLinks":return"UserRestrictionsNoEmbedLinks";case"sendPolls":return"UserRestrictionsNoSendPolls";case"changeInfo":return"UserRestrictionsNoChangeInfo";case"inviteUsers":return"UserRestrictionsInviteUsers";case"pinMessages":return"UserRestrictionsPinMessages";case"manageTopics":return"GroupPermission.NoManageTopics";case"sendPlain":return"UserRestrictionsNoSendText";case"sendDocs":return"UserRestrictionsNoSendDocs";case"sendRoundvideos":return"UserRestrictionsNoSendRound";case"sendVoices":return"UserRestrictionsNoSendVoice";case"sendAudios":return"UserRestrictionsNoSendMusic";case"sendVideos":return"UserRestrictionsNoSendVideos";case"sendPhotos":return"UserRestrictionsNoSendPhotos";default:return}}(s);if(!r)return e;const i=C(r);return`${e}${e.length?`, ${i}`:i}`},"")},[a,C]),j=(0,x.A)(()=>{D(!F),L()}),z=(0,x.A)(e=>{_(e),L()}),H=T||v,$=i===r.TD.InProgress||E;return n.Ay.createElement("div",{className:"Management with-shifted-dropdown",style:"--shift-height: 432px;--before-shift-height: 96px;"},n.Ay.createElement("div",{className:"panel-content custom-scroll"},n.Ay.createElement("div",{className:"section without-bottom-shadow"},n.Ay.createElement("h3",{className:"section-heading",dir:"auto"},S("ChannelPermissionsHeader")),n.Ay.createElement(gc,{chatId:a?.id,isMediaDropdownOpen:I,setIsMediaDropdownOpen:P,handlePermissionChange:f,permissions:g,dropdownClassName:"DropdownListTrap",className:(0,ue.A)("DropdownList",I&&"DropdownList--open"),shiftedClassName:(0,ue.A)("part",I&&"shifted")})),u&&n.Ay.createElement("div",{className:(0,ue.A)("section",I&&"shifted")},n.Ay.createElement(ca.A,{onClick:j},n.Ay.createElement("span",null,S("GroupMessagesChargePrice")),n.Ay.createElement(va.A,{id:"charge_for_messages",label:S("GroupMessagesChargePrice"),checked:F})),n.Ay.createElement("p",{className:"settings-item-description-larger",dir:S.isRtl?"rtl":void 0},S("RightsChargeStarsAbout"))),F&&n.Ay.createElement("div",{className:(0,ue.A)("section",I&&"shifted")},n.Ay.createElement(Wm,{canChangeChargeForMessages:!0,isGroupChat:!0,chargeForMessages:V,onChange:z})),n.Ay.createElement("div",{className:(0,ue.A)("section",I&&"shifted")},n.Ay.createElement(ca.A,{icon:"delete-user",multiline:!0,narrow:!0,onClick:k},n.Ay.createElement("span",{className:"title"},S("ChannelBlockedUsers")),n.Ay.createElement("span",{className:"subtitle"},l))),n.Ay.createElement("div",{className:(0,ue.A)("section",I&&"shifted")},n.Ay.createElement("h3",{className:"section-heading",dir:"auto"},S("PrivacyExceptions")),n.Ay.createElement(ca.A,{icon:"add-user",onClick:w},S("ChannelAddException")),K.map(e=>n.Ay.createElement(ca.A,{key:e.userId,className:"chat-item-clickable exceptions-member",onClick:()=>N(e)},n.Ay.createElement(kn.A,{userId:e.userId,status:G(e),forceShowSelf:!0}))))),n.Ay.createElement(ka.A,{isShown:H,onClick:J,ariaLabel:S("Save"),disabled:$},$?n.Ay.createElement(Ve.A,{color:"white"}):n.Ay.createElement(Q.A,{name:"check"})))})),nv=(0,n.ph)((0,s.EK)((e,{chatId:t,isPromotedByCurrentUser:a})=>{const n=(0,c.hds)(e,t),s=(0,c.AWZ)(e,t);return{chat:n,isFormFullyDisabled:!(n.isCreator||a),hasFullInfo:Boolean(s),members:s?.members}},(e,{chatId:t})=>Boolean((0,c.hds)(e,t)))(({chat:e,selectedChatMemberId:t,hasFullInfo:a,members:i,onScreenSelect:o,isFormFullyDisabled:l,onClose:c,isActive:d})=>{const{updateChatMemberBannedRights:m}=(0,s.ko)(),u=(0,n.Kr)(()=>{if(i)return i.find(({userId:e})=>e===t)},[i,t]),{permissions:A,havePermissionChanged:h,isLoading:y,handlePermissionChange:p,setIsLoading:g}=yc(u?.bannedRights||e?.defaultBannedRights),[v,E,f]=(0,M.A)(),b=(0,Ua.A)(),C=(0,B.A)();(0,Ee.A)({isActive:d,onBack:c}),(0,n.vJ)(()=>{a&&t&&!u&&o(r.je.GroupPermissions)},[e,a,o,u,t]);const S=(0,n.hb)(()=>{e&&t&&(g(!0),m({chatId:e.id,userId:t,bannedRights:A}))},[e,t,g,m,A]),k=(0,n.hb)(()=>{e&&t&&m({chatId:e.id,userId:t,bannedRights:{viewMessages:!0}})},[e,t,m]),w=(0,n.hb)(t=>!!l||!(!e||!e.defaultBannedRights)&&e.defaultBannedRights[t],[e,l]),[N,I]=(0,n.J0)(!1);if(u)return n.Ay.createElement("div",{className:"Management with-shifted-dropdown",style:"--shift-height: 431px;--before-shift-height: 192px;"},n.Ay.createElement("div",{className:"custom-scroll"},n.Ay.createElement("div",{className:"section without-bottom-shadow"},n.Ay.createElement(ca.A,{inactive:!0,className:"chat-item-clickable"},n.Ay.createElement(kn.A,{userId:u.userId,forceShowSelf:!0})),n.Ay.createElement("h3",{className:"section-heading mt-4",dir:"auto"},C("UserRestrictionsCanDo")),n.Ay.createElement(gc,{chatId:e?.id,isMediaDropdownOpen:N,setIsMediaDropdownOpen:I,handlePermissionChange:p,permissions:A,className:(0,ue.A)("DropdownList",N&&"DropdownList--open"),dropdownClassName:"DropdownListTrap",shiftedClassName:(0,ue.A)("part",N&&"shifted"),getControlIsDisabled:w})),!l&&n.Ay.createElement("div",{className:(0,ue.A)("section",N&&"shifted")},n.Ay.createElement(ca.A,{icon:"delete-user",ripple:!0,destructive:!0,onClick:E},C("UserRestrictionsBlock")))),n.Ay.createElement(ka.A,{isShown:h,onClick:S,ariaLabel:C("Save"),disabled:y},y?n.Ay.createElement(Ve.A,{color:"white"}):n.Ay.createElement(Q.A,{name:"check"})),n.Ay.createElement(ya.A,{isOpen:v,onClose:f,text:b("GroupManagementBanUserConfirm"),confirmLabel:"Remove",confirmHandler:k,confirmIsDestructive:!0}))})),sv=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const a=(0,c.hds)(e,t),{byId:n,statusesById:s}=e.users,r=(0,c.AWZ)(e,t)?.members;return{members:r,usersById:n,userStatusesById:s,isChannel:a&&(0,l.WX)(a)}})(({usersById:e,userStatusesById:t,members:a,isChannel:s,onScreenSelect:i,onChatMemberSelect:o,onClose:c,isActive:d})=>{(0,Ee.A)({isActive:d,onBack:c});const m=(0,n.Kr)(()=>{if(a&&e)return(0,l.UB)(a.filter(e=>!e.isOwner).map(({userId:e})=>e),e,t)},[a,e,t]),u=(0,n.hb)(e=>{o(e),i(r.je.GroupUserPermissions)},[o,i]);return n.Ay.createElement("div",{className:"Management"},n.Ay.createElement("div",{className:"custom-scroll"},n.Ay.createElement("div",{className:"section",teactFastList:!0},m?m.map((e,t)=>n.Ay.createElement(ca.A,{key:e,teactOrderKey:t,className:"chat-item-clickable scroll-item",onClick:()=>u(e)},n.Ay.createElement(kn.A,{userId:e,forceShowSelf:!0}))):n.Ay.createElement(Id.A,{teactOrderKey:0,key:"nothing-found",text:s?"No subscribers found":"No members found"}))))})),rv=[1,10,100],iv={hour:36e5,day:864e5,week:6048e5},ov=iv.hour,lv=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const{editingInvite:a}=(0,c.nTw)(e).management.byChatId[t]||{};return{editingInvite:a}})(({chatId:e,editingInvite:t,isActive:a,onClose:i,onScreenSelect:o})=>{const{editExportedChatInvite:l,exportChatInvite:c}=(0,s.ko)(),d=(0,B.A)(),[m,u,A]=(0,M.A)(),[h,y]=(0,n.J0)(!1),[p,g]=(0,n.J0)(""),[v,E]=(0,n.J0)(Date.now()+ov),[f,b]=(0,n.J0)("unlimited"),[C,S]=(0,n.J0)(10),[k,w]=(0,n.J0)("0"),[N,I]=(0,n.J0)(!1);(0,Ee.A)({isActive:a,onBack:i}),(0,z.A)(([e])=>{if(e!==t)if(t){const{title:e,usageLimit:a,expireDate:n,isRequestNeeded:s}=t;if(e&&g(e),a&&(w(rv.includes(a)?a.toString():"custom"),S(a)),n){const e=(0,la.Fm)()+ov;b("custom"),E(1e3*Math.max(n,e))}s&&y(!0)}else g(""),b("unlimited"),w("0"),E(1e3*(0,la.Fm)()+ov),S(10),y(!1)},[t]);const P=(0,n.hb)(e=>{y(e.target.checked)},[]),T=(0,n.hb)(e=>{g(e.target.value)},[]),x=(0,n.hb)(e=>{S(Number.parseInt(e.target.value,10))},[]),L=(0,n.hb)(e=>{E(e.getTime()),A()},[A]),R=(0,n.hb)(()=>{I(!0);const a="custom"===k?C:Number(k);let n;switch(f){case"custom":n=(0,la.Fm)()+(v-Date.now())/1e3;break;case"hour":case"day":case"week":n=(0,la.Fm)()+iv[f]/1e3;break;case"unlimited":n=0;break;default:n=void 0}t?l({link:t.link,chatId:e,title:p,isRequestNeeded:h,expireDate:n,usageLimit:a}):c({chatId:e,title:p,isRequestNeeded:h,expireDate:n,usageLimit:a}),o(r.je.Invites)},[e,v,C,l,t,c,h,f,k,p,o]);return n.Ay.createElement("div",{className:"Management ManageInvite"},n.Ay.createElement("div",{className:"panel-content custom-scroll"},n.Ay.createElement("div",{className:"section"},n.Ay.createElement(as.A,{label:d("ApproveNewMembers"),subLabel:d("ApproveNewMembersDescription"),checked:h,onChange:P})),n.Ay.createElement("div",{className:"section"},n.Ay.createElement(Z.A,{className:"link-name",placeholder:d("LinkNameHint"),value:p,onChange:T}),n.Ay.createElement("p",{className:"section-help hint"},d("LinkNameHelp"))),n.Ay.createElement("div",{className:"section"},n.Ay.createElement("div",{className:"section-heading"},d("LimitByPeriod")),n.Ay.createElement(ee.A,{name:"expireOptions",options:[{value:"hour",label:d("Hours",1)},{value:"day",label:d("Days",1)},{value:"week",label:d("Weeks",1)},{value:"unlimited",label:d("NoLimit")},{value:"custom",label:d("lng_group_invite_expire_custom")}],onChange:b,selected:f}),"custom"===f&&n.Ay.createElement(Y.A,{className:"expire-limit",isText:!0,onClick:u},(0,$e.Lu)(d,v)," ",(0,$e.fU)(d,v)),n.Ay.createElement("p",{className:"section-help hint"},d("TimeLimitHelp"))),!h&&n.Ay.createElement("div",{className:"section"},n.Ay.createElement("div",{className:"section-heading"},d("LimitNumberOfUses")),n.Ay.createElement(ee.A,{name:"usageOptions",options:[...rv.map(e=>({value:e.toString(),label:e})),{value:"0",label:d("NoLimit")},{value:"custom",label:d("lng_group_invite_usage_custom")}],onChange:w,selected:k}),"custom"===k&&n.Ay.createElement("input",{className:"form-control usage-limit",type:"number",min:"1",max:"99999",value:C,onChange:x}),n.Ay.createElement("p",{className:"section-help hint"},d("UsesLimitHelp"))),n.Ay.createElement(ka.A,{isShown:!0,onClick:R,disabled:N,ariaLabel:d(t?"SaveLink":"CreateLink")},n.Ay.createElement(Q.A,{name:"check"}))),n.Ay.createElement(cs,{isOpen:m,isFutureMode:!0,withTimePicker:!0,onClose:A,onSubmit:L,selectedAt:v,submitButtonLabel:d("Save")}))})),cv=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const{inviteInfo:a}=(0,c.nTw)(e).management.byChatId[t]||{},{invite:n,importers:s,requesters:r}=a||{},i=(0,c.hds)(e,t);return{invite:n,importers:s,requesters:r,isChannel:i&&(0,l.WX)(i)}})(({chatId:e,invite:t,importers:a,requesters:r,isChannel:i,isActive:o,onClose:l})=>{const{loadChatInviteImporters:c,loadChatInviteRequesters:d,openChat:m}=(0,s.ko)(),u=(0,B.A)(),{usage:A=0,usageLimit:h,link:y,adminId:p}=t||{},g=t?.expireDate&&1e3*(t.expireDate-(0,la.Fm)())+Date.now(),v=(t?.expireDate||0)-(0,la.Fm)()<0;return(0,n.vJ)(()=>{y&&(c({chatId:e,link:y}),d({chatId:e,link:y}))},[e,y,c,d]),(0,Ee.A)({isActive:o,onBack:l}),n.Ay.createElement("div",{className:"Management ManageInviteInfo"},n.Ay.createElement("div",{className:"panel-content custom-scroll"},!t&&n.Ay.createElement("p",{className:"section-help"},u("Loading")),t&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:"section"},n.Ay.createElement(qo.A,{title:t.title,link:t.link,className:"invite-link"}),Boolean(g)&&n.Ay.createElement("p",{className:"section-help"},v?u("ExpiredLink"):u("LinkExpiresIn",`${(0,$e.Lu)(u,g)} ${(0,$e.fU)(u,g)}`))),p&&n.Ay.createElement("div",{className:"section"},n.Ay.createElement("p",{className:"section-heading"},u("LinkCreatedeBy")),n.Ay.createElement(ca.A,{className:"chat-item-clickable scroll-item small-icon",onClick:()=>m({id:p})},n.Ay.createElement(kn.A,{userId:p,status:(0,$e.fS)(u,1e3*t.date,!0),forceShowSelf:!0}))),(()=>{if(a?.length||!r?.length)return a?n.Ay.createElement("div",{className:"section"},n.Ay.createElement("p",{className:"section-heading"},a.length?u("PeopleJoined",A):u("NoOneJoined")),n.Ay.createElement("p",{className:"section-help"},!a.length&&(h?u("PeopleCanJoinViaLinkCount",h-A):u("NoOneJoinedYet")),a.map(e=>{const t=(0,$e.fS)(u,1e3*e.date,!0),a=e.isFromChatList?`${t} • ${u("JoinedViaFolder")}`:t;return n.Ay.createElement(ca.A,{className:"chat-item-clickable scroll-item small-icon",onClick:()=>m({id:e.userId})},n.Ay.createElement(kn.A,{userId:e.userId,status:a,forceShowSelf:!0}))}))):n.Ay.createElement(Ve.A,null)})(),(()=>{if(!t?.isRevoked){if(!r&&a)return n.Ay.createElement(Ve.A,null);if(r?.length)return n.Ay.createElement("div",{className:"section"},n.Ay.createElement("p",{className:"section-heading"},u(i?"SubscribeRequests":"MemberRequests")),n.Ay.createElement("p",{className:"section-help"},r.map(e=>n.Ay.createElement(ca.A,{className:"chat-item-clickable scroll-item small-icon",onClick:()=>m({id:e.userId})},n.Ay.createElement(kn.A,{userId:e.userId,status:(0,$e.fS)(u,1e3*e.date,!0),forceShowSelf:!0})))))}})())))})),dv="•";function mv(e,t){const{isPermanent:a,usage:n=0,date:s}=e,{isPermanent:r,usage:i=0,date:o}=t;return a||r?Number(a)-Number(r):n||i?i-n:o-s}const uv=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const{invites:a,revokedInvites:n}=(0,c.nTw)(e).management.byChatId[t]||{},s=(0,c.hds)(e,t);return{exportedInvites:a,revokedExportedInvites:n,chat:s,isChannel:s&&(0,l.WX)(s)}})(({chatId:e,chat:t,exportedInvites:a,revokedExportedInvites:o,isActive:c,isChannel:d,onClose:m,onScreenSelect:u})=>{const{setEditingExportedInvite:A,showNotification:h,editExportedChatInvite:y,deleteExportedChatInvite:p,deleteRevokedExportedChatInvites:g,setOpenedInviteInfo:v}=(0,s.ko)(),E=(0,Ua.A)(),f=(0,B.A)(),[b,C,S]=(0,M.A)(),[k,w,N]=(0,M.A)(),[I,P]=(0,n.J0)(),[x,L,R]=(0,M.A)(),[F,D]=(0,n.J0)();(0,Ee.A)({isActive:c,onBack:m});const V=(0,n.Kr)(()=>{if(a)return a.some(({expireDate:e})=>e&&e-(0,la.Fm)()<$e.il/1e3)},[a]),_=(0,T.A)();(0,gs.A)(_,V?1e3:void 0);const U=(0,n.Kr)(()=>t&&(0,l.Kl)(t),[t]),O=a?.find(({isPermanent:e})=>e),J=U?`${i.jsp}${U}`:O?.link,K=(0,n.Kr)(()=>{const e=t?.hasUsername?a:a?.filter(({isPermanent:e})=>!e);return e?.sort(mv)},[t?.hasUsername,a]),G=(0,n.hb)(t=>{const{link:a,title:n,isRequestNeeded:s,expireDate:r,usageLimit:i}=t;y({chatId:e,link:a,title:n,isRequestNeeded:s,expireDate:r,usageLimit:i,isRevoked:!0})},[e,y]),j=(0,n.hb)(e=>{P(e),w()},[w]),z=(0,n.hb)(()=>{I&&(G(I),P(void 0),N())},[N,G,I]),H=(0,n.hb)(()=>{u(r.je.EditInvite)},[u]),$=(0,n.hb)(()=>{O&&j(O)},[j,O]),q=(0,n.hb)(()=>{g({chatId:e}),S()},[e,S,g]),W=(0,n.hb)(t=>{v({chatId:e,invite:t}),u(r.je.InviteInfo)},[e,u,v]),Y=(0,n.hb)(t=>{p({chatId:e,link:t.link})},[e,p]),Z=(0,n.hb)(e=>{D(e),L()},[L]),X=(0,n.hb)(()=>{F&&(Y(F),D(void 0),R())},[R,Y,F]),ee=(0,n.hb)(e=>{(0,Dc.eM)(e),h({message:f("LinkCopied")})},[f,h]),te=e=>{const{usage:t=0,usageLimit:a,expireDate:n,isPermanent:s,requested:r,isRevoked:i}=e;let o="";if(o=!i&&a&&t<a?f("CanJoin",a-t):t?f("PeopleJoined",t):f("NoOneJoined"),i)return o+=` ${dv} ${f("Revoked")}`,o;if(r&&(o+=` ${dv} ${f("JoinRequests",r)}`),void 0!==a&&t===a)o+=` ${dv} ${f("LinkLimitReached")}`;else if(n){const e=n-(0,la.Fm)();o+=` ${dv} `,o+=e>0?f("InviteLink.ExpiresIn",(0,$e.zt)(E,e)):f("InviteLink.Expired")}else s&&(o+=` ${dv} ${f("Permanent")}`);return o},ae=e=>{const{usage:t=0,usageLimit:a,isRevoked:n,expireDate:s}=e;return n?"link-status-icon-gray":a&&t<a?"link-status-icon-green":s&&1e3*(s-(0,la.Fm)())<=0?"link-status-icon-red":"link-status-icon-blue"},ne=t=>{const a=[];return a.push({title:f("Copy"),icon:"copy",handler:()=>ee(t.link)}),t.isPermanent||t.isRevoked||a.push({title:f("Edit"),icon:"edit",handler:()=>(t=>{A({chatId:e,invite:t}),u(r.je.EditInvite)})(t)}),t.isRevoked?a.push({title:f("DeleteLink"),icon:"delete",handler:()=>Z(t),destructive:!0}):a.push({title:f("RevokeButton"),icon:"delete",handler:()=>j(t),destructive:!0}),a};return n.Ay.createElement("div",{className:"Management ManageInvites"},n.Ay.createElement("div",{className:"panel-content custom-scroll"},n.Ay.createElement("div",{className:"section"},n.Ay.createElement(So.A,{tgsUrl:Co.w.Invite,size:i.xMZ,className:"section-icon"}),n.Ay.createElement("p",{className:"section-help"},f(d?"PrimaryLinkHelpChannel":"PrimaryLinkHelp"))),J&&n.Ay.createElement("div",{className:"section"},n.Ay.createElement(qo.A,{className:"settings-input",link:J,withShare:!0,onRevoke:t?.usernames?void 0:$,title:f(t?.usernames?"PublicLink":"lng_create_permanent_link_title")})),n.Ay.createElement("div",{className:"section",teactFastList:!0},n.Ay.createElement(ca.A,{icon:"add",withPrimaryColor:!0,key:"create",className:"create-item",onClick:H},f("CreateNewLink")),(!K||!K.length)&&n.Ay.createElement(Id.A,{text:"No links found",key:"nothing"}),K?.map(e=>n.Ay.createElement(ca.A,{leftElement:n.Ay.createElement(Q.A,{name:"link",className:`link-status-icon ${ae(e)}`}),secondaryIcon:"more",multiline:!0,onClick:()=>W(e),contextActions:ne(e),key:e.link},n.Ay.createElement("span",{className:"title invite-title"},e.title||e.link),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},te(e)))),n.Ay.createElement("p",{className:"section-help hint",key:"links-hint"},f("ManageLinksInfoHelp"))),o&&Boolean(o.length)&&n.Ay.createElement("div",{className:"section",teactFastList:!0},n.Ay.createElement("p",{className:"section-help",key:"title"},f("RevokedLinks")),n.Ay.createElement(ca.A,{icon:"delete",destructive:!0,key:"delete",onClick:C},n.Ay.createElement("span",{className:"title"},f("DeleteAllRevokedLinks"))),o?.map(e=>n.Ay.createElement(ca.A,{leftElement:n.Ay.createElement(Q.A,{name:"link",className:`link-status-icon ${ae(e)}`}),secondaryIcon:"more",multiline:!0,onClick:()=>W(e),contextActions:ne(e),key:e.link},n.Ay.createElement("span",{className:"title"},e.title||e.link),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},te(e)))))),n.Ay.createElement(ya.A,{isOpen:b,onClose:S,title:f("DeleteAllRevokedLinks"),text:f("DeleteAllRevokedLinkHelp"),confirmIsDestructive:!0,confirmLabel:f("DeleteAll"),confirmHandler:q}),n.Ay.createElement(ya.A,{isOpen:k,onClose:N,title:f("RevokeLink"),text:f("RevokeAlert"),confirmIsDestructive:!0,confirmLabel:f("RevokeButton"),confirmHandler:z}),n.Ay.createElement(ya.A,{isOpen:x,onClose:R,title:f("DeleteLink"),text:f("DeleteLinkHelp"),confirmIsDestructive:!0,confirmLabel:f("Delete"),confirmHandler:X}))})),Av=(0,n.ph)((0,s.EK)((e,{userId:t})=>({user:(0,c.mBe)(e,t)}))(({userId:e,chatId:t,about:a,date:r,isChannel:i,user:o})=>{const{openChat:c,hideChatJoinRequest:d}=(0,s.ko)(),m=(0,ue.x)("JoinRequest"),u=(0,B.A)(),A=(0,l.Yg)(o),h=1e3*(r-(0,la.Fm)())+Date.now(),y=(0,$e.cK)(new Date(h))?(0,$e.fU)(u,h):(0,$e.F5)(u,h,!0,!1,!0),p=(0,n.hb)(()=>{d({chatId:t,userId:e,isApproved:!0})},[t,d,e]),g=(0,n.hb)(()=>{d({chatId:t,userId:e,isApproved:!1})},[t,d,e]);return n.Ay.createElement("div",{className:m("&")},n.Ay.createElement("div",{className:m("top")},n.Ay.createElement("div",{className:m("user"),onClick:()=>{c({id:e})}},n.Ay.createElement(xt.A,{key:e,size:"medium",peer:o}),n.Ay.createElement("div",{className:m("user-info")},n.Ay.createElement("div",{className:m("user-name")},A),n.Ay.createElement("div",{className:m("user-subtitle")},a))),n.Ay.createElement("div",{className:m("date")},y)),n.Ay.createElement("div",{className:m("buttons")},n.Ay.createElement(Y.A,{className:m("button"),onClick:p},u(i?"ChannelAddToChannel":"ChannelAddToGroup")),n.Ay.createElement(Y.A,{className:m("button"),isText:!0,onClick:g},u("DismissRequest"))))})),hv=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const a=(0,c.hds)(e,t);return{chat:a,isChannel:a&&(0,l.WX)(a)}})(({chat:e,chatId:t,isActive:a,isChannel:r,onClose:o})=>{const{hideAllChatJoinRequests:l,loadChatJoinRequests:c}=(0,s.ko)(),[d,m,u]=(0,M.A)(),[h,y,p]=(0,M.A)(),g=(0,B.A)();(0,Ee.A)({isActive:a,onBack:o}),(0,n.vJ)(()=>{e?.joinRequests||(0,A.L8)(t)||c({chatId:t})},[e,t,c]);const v=(0,n.hb)(()=>{l({chatId:t,isApproved:!0}),u()},[l,t,u]),E=(0,n.hb)(()=>{l({chatId:t,isApproved:!1}),p()},[l,t,p]);return n.Ay.createElement("div",{className:"Management ManageJoinRequests"},n.Ay.createElement("div",{className:"custom-scroll"},n.Ay.createElement("div",{className:"section"},n.Ay.createElement(So.A,{tgsUrl:Co.w.JoinRequest,size:i.OMf,className:"section-icon"}),Boolean(e?.joinRequests?.length)&&n.Ay.createElement("div",{className:"bulk-actions"},n.Ay.createElement(Y.A,{className:"bulk-action-button",onClick:m},"Accept all"),n.Ay.createElement(Y.A,{className:"bulk-action-button",onClick:y,isText:!0},"Dismiss all"))),n.Ay.createElement("div",{className:"section",teactFastList:!0},n.Ay.createElement("p",{key:"title"},e?.joinRequests?e.joinRequests.length?g("JoinRequests",e.joinRequests.length):g("NoMemberRequests"):g("Loading")),!e?.joinRequests&&n.Ay.createElement(Ve.A,{key:"loading"}),0===e?.joinRequests?.length&&n.Ay.createElement("p",{className:"section-help",key:"empty"},g(r?"NoSubscribeRequestsDescription":"NoMemberRequestsDescription")),e?.joinRequests?.map(({userId:e,about:a,date:s})=>n.Ay.createElement(Av,{userId:e,about:a,date:s,isChannel:r,chatId:t,key:e})))),n.Ay.createElement(ya.A,{isOpen:d,onClose:u,title:"Accept all requests?",text:"Are you sure you want to accept all requests?",confirmHandler:v}),n.Ay.createElement(ya.A,{isOpen:h,onClose:p,title:"Reject all requests?",text:"Are you sure you want to reject all requests?",confirmHandler:E}))})),yv=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const a=(0,c.hds)(e,t),{maxUniqueReactions:n=i.UAx}=e.appConfig||{},s=(0,c.AWZ)(e,t),r=s?.reactionsLimit||n,o=(0,l.WX)(a);return{enabledReactions:s?.enabledReactions,availableReactions:e.reactions.availableReactions,chat:a,maxUniqueReactions:n,reactionsLimit:r,isChannel:o}},(e,{chatId:t})=>Boolean((0,c.hds)(e,t)))(({availableReactions:e,enabledReactions:t,chat:a,isActive:r,onClose:i,maxUniqueReactions:o,reactionsLimit:c,isChannel:d})=>{const{setChatEnabledReactions:m}=(0,s.ko)(),u=(0,B.A)(),[A,h]=(0,n.J0)(!1),[y,p]=(0,n.J0)(!1),[g,v]=(0,n.J0)(t),[E,f]=(0,n.J0)(c);(0,Ee.A)({isActive:r,onBack:i});const b=(0,n.Kr)(()=>[{value:"all",label:u("AllReactions")},{value:"some",label:u("SomeReactions")},{value:"none",label:u("NoReactions")}],[u]),C=(0,n.hb)(()=>{a&&(p(!0),m({chatId:a.id,enabledReactions:g,reactionsLimit:E}))},[a,g,m,E]);(0,n.vJ)(()=>{p(!1),h(!1),v(t),f(c)},[t,c]);const S=(0,n.Kr)(()=>e?.filter(({isInactive:e})=>!e),[e]);(0,n.vJ)(()=>{if(void 0===E||E===c){if("some"===g?.type&&"all"!==t?.type&&"some"!==t?.type&&0===g.allowed.length)return void h(!1);if(g?.type===t?.type){if("some"===g?.type&&"some"===t?.type){const e=g.allowed,a=t?.allowed;if(e.length!==a.length||e.reverse().some(e=>!a.find(t=>(0,l.a0)(e,t))))return void h(!0)}h(!1)}else h(!0)}else h(!0)},[E,c,g,t]);const k=(0,n.hb)(e=>{"all"===e?(v({type:"all"}),f(c)):"some"===e?(v({type:"some",allowed:"some"===t?.type?t.allowed:[]}),f(c)):(v(void 0),f(void 0))},[t,c]),w=(0,n.hb)(e=>{if(!a||!S)return;const{name:t,checked:n}=e.currentTarget;if("some"===g?.type){const e={emoticon:t};v(n?{type:"some",allowed:[...g.allowed,e]}:{type:"some",allowed:g.allowed.filter(t=>!(0,l.a0)(t,e))})}},[S,a,g]),N=(0,n.hb)(e=>{f(e)},[]),I=(0,n.hb)(e=>u("PeerInfo.AllowedReactions.MaxCountValue",e),[u]),P=d&&("all"===g?.type||"some"===g?.type);return n.Ay.createElement("div",{className:"Management"},n.Ay.createElement("div",{className:"panel-content custom-scroll"},Boolean(E&&P)&&n.Ay.createElement("div",{className:"section"},n.Ay.createElement("h3",{className:"section-heading"},u("MaximumReactionsHeader")),n.Ay.createElement(Qe.A,{min:1,max:o,value:E,onChange:N,renderValue:I,isCenteredLayout:!0}),n.Ay.createElement("p",{className:"section-info section-info_push"},u("ChannelReactions.MaxCount.Info"))),n.Ay.createElement("div",{className:"section"},n.Ay.createElement("h3",{className:"section-heading"},u("AvailableReactions")),n.Ay.createElement(ee.A,{selected:g?.type||"none",name:"reactions",options:b,onChange:k}),n.Ay.createElement("p",{className:"section-info section-info_push"},"all"===g?.type&&u("EnableAllReactionsInfo"),"some"===g?.type&&u("EnableSomeReactionsInfo"),!g&&u("DisableReactionsInfo"))),"some"===g?.type&&n.Ay.createElement("div",{className:"section section-with-fab"},n.Ay.createElement("h3",{className:"section-heading"},u("OnlyAllowThisReactions")),S?.map(({reaction:t,title:a})=>n.Ay.createElement("div",{className:"ListItem"},n.Ay.createElement(as.A,{name:t.emoticon,checked:g?.allowed.some(e=>(0,l.a0)(t,e)),label:n.Ay.createElement("div",{className:"Reaction"},n.Ay.createElement(wn.A,{reaction:t,availableReactions:e}),a),withIcon:!0,onChange:w}))))),n.Ay.createElement(ka.A,{isShown:A,onClick:C,ariaLabel:u("Save"),disabled:y},y?n.Ay.createElement(Ve.A,{color:"white"}):n.Ay.createElement(Q.A,{name:"check"})))})),pv="Please provide first name",gv=(0,n.ph)((0,s.EK)((e,{userId:t})=>{const a=(0,c.mBe)(e,t),n=(0,c.hds)(e,t),s=(0,c.vGo)(e,t),{progress:r}=(0,c.nTw)(e).management,i=n&&(0,Td.If)(n,(0,c.K52)(e),(0,c.P5N)(e,n.id)),o=s?.personalPhoto;return{user:a,progress:r,isMuted:i,personalPhoto:o,notPersonalPhoto:s?.profilePhoto||s?.fallbackPhoto}})(({userId:e,user:t,progress:a,isMuted:o,onClose:c,isActive:d,personalPhoto:m,notPersonalPhoto:u})=>{const{updateContact:A,deleteContact:h,closeManagement:y,uploadContactProfilePhoto:p}=(0,s.ko)(),[g,v,E]=(0,M.A)(),[f,b,C]=(0,M.A)(),[S,k]=(0,n.J0)(!1),[w,N]=(0,n.J0)(),I=(0,B.A)();(0,Ee.A)({isActive:d,onBack:c});const P=t&&t.firstName||"",T=t&&t.lastName||"",[x,L]=(0,n.J0)(P),[R,F]=(0,n.J0)(T),[D,V]=(0,n.J0)(!o);(0,n.vJ)(()=>{V(!o)},[o]),(0,n.vJ)(()=>{k(!1),E()},[E,e]),(0,n.vJ)(()=>{L(P),F(T)},[P,T,t]),(0,n.vJ)(()=>{a===r.TD.Complete&&(k(!1),N(void 0),E())},[E,a]);const _=(0,n.hb)(e=>{L(e.target.value),k(!0),w===pv&&N(void 0)},[w]),U=(0,n.hb)(e=>{F(e.target.value),k(!0)},[]),O=(0,n.hb)(e=>{V(e.target.checked),k(!0)},[]),J=(0,n.hb)(()=>{const t=x.trim(),a=R.trim();t.length?A({userId:e,isMuted:!D,firstName:t,lastName:a}):N(pv)},[x,R,A,e,D]),K=(0,n.hb)(()=>{h({userId:e}),E(),y()},[E,y,h,e]),G=(0,n.li)(),j=(0,n.li)(!1),z=(0,n.hb)(()=>{G.current?.click(),j.current=!0},[]),H=(0,n.hb)(()=>{G.current?.click(),j.current=!1},[]),$=(0,n.hb)(()=>{C(),k(!0),p({userId:e})},[C,p,e]),q=(0,n.hb)(t=>{k(!0),p({userId:e,file:t,isSuggest:j.current})},[p,e]);if(!t)return;const W=!(0,l.tv)(t)&&t.id!==i.zv8,Y=a===r.TD.InProgress;return n.Ay.createElement("div",{className:"Management"},n.Ay.createElement("div",{className:"custom-scroll"},n.Ay.createElement("div",{className:"section"},n.Ay.createElement(kn.A,{userId:t.id,avatarSize:"jumbo",noStatusOrTyping:!0,noEmojiStatus:!0,withFullInfo:!0}),n.Ay.createElement("div",{className:"settings-edit"},n.Ay.createElement(Z.A,{id:"user-first-name",label:I("UserInfo.FirstNamePlaceholder"),onChange:_,value:x,error:w===pv?w:void 0}),n.Ay.createElement(Z.A,{id:"user-last-name",label:I("UserInfo.LastNamePlaceholder"),onChange:U,value:R})),n.Ay.createElement("div",{className:"ListItem narrow"},n.Ay.createElement(as.A,{checked:D,label:I("Notifications"),subLabel:I(D?"UserInfo.NotificationsEnabled":"UserInfo.NotificationsDisabled"),onChange:O}))),W&&n.Ay.createElement("div",{className:"section"},n.Ay.createElement(ca.A,{icon:"camera-add",ripple:!0,onClick:z},n.Ay.createElement("span",{className:"list-item-ellipsis"},I("UserInfo.SuggestPhoto",t.firstName))),n.Ay.createElement(ca.A,{icon:"camera-add",ripple:!0,onClick:H},n.Ay.createElement("span",{className:"list-item-ellipsis"},I("UserInfo.SetCustomPhoto",t.firstName))),m&&n.Ay.createElement(ca.A,{leftElement:n.Ay.createElement(xt.A,{photo:u,noPersonalPhoto:!0,peer:t,size:"mini",className:"personal-photo"}),ripple:!0,onClick:b},I("UserInfo.ResetCustomPhoto")),n.Ay.createElement("p",{className:"section-help",dir:"auto"},I("UserInfo.CustomPhotoInfo",t.firstName))),n.Ay.createElement("div",{className:"section"},n.Ay.createElement(ca.A,{icon:"delete",ripple:!0,destructive:!0,onClick:v},I("DeleteContact")))),n.Ay.createElement(ka.A,{isShown:S,onClick:J,disabled:Y,ariaLabel:I("Save")},Y?n.Ay.createElement(Ve.A,{color:"white"}):n.Ay.createElement(Q.A,{name:"check"})),n.Ay.createElement(ya.A,{isOpen:g,onClose:E,text:I("AreYouSureDeleteContact"),confirmLabel:I("DeleteContact"),confirmHandler:K,confirmIsDestructive:!0}),n.Ay.createElement(ya.A,{isOpen:f,onClose:C,text:I("UserInfo.ResetToOriginalAlertText",t.firstName),confirmLabel:I("Reset"),confirmHandler:$,confirmIsDestructive:!0}),n.Ay.createElement(lA.A,{onChange:q,inputRef:G}))})),vv=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const{progress:a,error:n}=(0,c.nTw)(e).chatCreation||{};return{chat:(0,c.hds)(e,t),creationProgress:a,creationError:n}})(({chat:e,onClose:t,isActive:a,creationProgress:i,creationError:o})=>{const{createChannel:l}=(0,s.ko)(),c=(0,Ua.A)();(0,Ee.A)({isActive:a,onBack:t});const[d,m]=(0,n.J0)(c("NewDiscussionChatTitle",{name:e?.title})),[u,A]=(0,n.J0)(),[h,y]=(0,n.J0)(),p=i===r.n7.InProgress,g=(0,x.A)(e=>{const{value:t}=e.currentTarget,a=t.trimStart();m(a),a!==t&&(e.currentTarget.value=a)}),v=o&&c("NewChatTitleEmptyError")||(h!==c("NewChatTitleEmptyError")&&h!==c("NewChannelTitleEmptyError")?h:void 0),E=(0,x.A)(()=>{d.length?e&&l({discussionChannelId:e.id,title:d,photo:u,isSuperGroup:!0}):y(c("NewChatTitleEmptyError"))});return n.Ay.createElement("div",{className:"Management"},n.Ay.createElement("div",{className:"panel-content custom-scroll"},n.Ay.createElement("div",{className:"NewChat"},n.Ay.createElement("div",{className:"NewChat-inner step-2"},n.Ay.createElement(bu.A,{onChange:A,title:c("AddPhoto")}),n.Ay.createElement(Z.A,{value:d,onChange:g,label:c("GroupName"),error:h===c("NewChatTitleEmptyError")||h===c("NewChannelTitleEmptyError")?h:void 0}),v&&n.Ay.createElement("p",{className:"error"},v)),n.Ay.createElement(ka.A,{isShown:0!==d.length,onClick:E,disabled:p,ariaLabel:c("DiscussionCreateGroup")},p?n.Ay.createElement(Ve.A,{color:"white"}):n.Ay.createElement(Q.A,{name:"arrow-right"})))))})),Ev=(0,n.ph)((0,s.EK)(e=>({managementType:(0,c.vn8)(e)}))(({chatId:e,currentScreen:t,selectedChatMemberId:a,isPromotedByCurrentUser:s,onScreenSelect:i,onChatMemberSelect:o,onClose:l,isActive:c,managementType:d})=>{switch(t){case r.je.Initial:switch(d){case"bot":return n.Ay.createElement(Ug,{key:e,userId:e,onClose:l,isActive:c});case"user":return n.Ay.createElement(gv,{key:e,userId:e,onClose:l,isActive:c});case"group":return n.Ay.createElement(Yg,{key:e,chatId:e,onScreenSelect:i,onClose:l,isActive:c||[r.je.ChatPrivacyType,r.je.Discussion,r.je.GroupPermissions,r.je.ChatAdministrators,r.je.GroupRemovedUsers,r.je.GroupUserPermissionsCreate,r.je.GroupUserPermissions,r.je.ChatAdminRights,r.je.ChatNewAdminRights,r.je.GroupRecentActions].includes(t)});case"channel":return n.Ay.createElement(Jg,{key:e,chatId:e,onScreenSelect:i,onClose:l,isActive:c||[r.je.ChannelSubscribers,r.je.ChatAdministrators,r.je.ChannelRemovedUsers,r.je.Discussion,r.je.ChatPrivacyType,r.je.ChatAdminRights,r.je.ChatNewAdminRights,r.je.GroupRecentActions].includes(t)})}break;case r.je.ChatPrivacyType:return n.Ay.createElement(Gg,{chatId:e,isActive:c,onClose:l});case r.je.Discussion:return n.Ay.createElement(Hg,{chatId:e,onScreenSelect:i,isActive:c,onClose:l});case r.je.GroupPermissions:return n.Ay.createElement(av,{chatId:e,onScreenSelect:i,onChatMemberSelect:o,isActive:c||[r.je.GroupRemovedUsers,r.je.GroupUserPermissionsCreate,r.je.GroupUserPermissions].includes(t),onClose:l});case r.je.ChannelRemovedUsers:case r.je.GroupRemovedUsers:return n.Ay.createElement(zg,{chatId:e,isActive:c,onClose:l});case r.je.GroupUserPermissionsCreate:return n.Ay.createElement(sv,{chatId:e,onChatMemberSelect:o,onScreenSelect:i,isActive:c||[r.je.GroupUserPermissions].includes(t),onClose:l});case r.je.GroupUserPermissions:return n.Ay.createElement(nv,{chatId:e,selectedChatMemberId:a,isPromotedByCurrentUser:s,onScreenSelect:i,isActive:c,onClose:l});case r.je.ChatAdministrators:return n.Ay.createElement(Kg,{chatId:e,onScreenSelect:i,onChatMemberSelect:o,isActive:c||[r.je.ChatAdminRights,r.je.ChatNewAdminRights,r.je.GroupRecentActions].includes(t),onClose:l});case r.je.NewDiscussionGroup:return n.Ay.createElement(vv,{chatId:e,onScreenSelect:i,isActive:c,onClose:l});case r.je.ChatNewAdminRights:case r.je.ChatAdminRights:return n.Ay.createElement(Zg,{chatId:e,isNewAdmin:t===r.je.ChatNewAdminRights,selectedUserId:a,isPromotedByCurrentUser:s,onScreenSelect:i,isActive:c,onClose:l});case r.je.ChannelSubscribers:case r.je.GroupMembers:return n.Ay.createElement(tv,{chatId:e,isActive:c,onClose:l});case r.je.Invites:return n.Ay.createElement(uv,{chatId:e,isActive:c,onClose:l,onScreenSelect:i});case r.je.EditInvite:return n.Ay.createElement(lv,{chatId:e,isActive:c,onClose:l,onScreenSelect:i});case r.je.GroupAddAdmins:return n.Ay.createElement(tv,{chatId:e,noAdmins:!0,isActive:c,onClose:l,onScreenSelect:i,onChatMemberSelect:o});case r.je.Reactions:return n.Ay.createElement(yv,{chatId:e,isActive:c,onClose:l});case r.je.InviteInfo:return n.Ay.createElement(cv,{chatId:e,isActive:c,onClose:l});case r.je.JoinRequests:return n.Ay.createElement(hv,{chatId:e,isActive:c,onClose:l})}})),fv=/^4\d/,bv=/^5[1-5]/,Cv=/^2[2-7]\d{2}/,Sv=/^220[0-4]/;let kv=function(e){return e[e.Default=0]="Default",e[e.Visa=1]="Visa",e[e.Mastercard=2]="Mastercard",e[e.Mir=3]="Mir",e}({});const wv={[kv.Default]:"",[kv.Visa]:"visa",[kv.Mastercard]:"mastercard",[kv.Mir]:"mir"};function Nv(e){return e=e.replace(/\s/g,""),fv.test(e)?kv.Visa:Sv.test(e)?kv.Mir:bv.test(e)||Cv.test(e)?kv.Mastercard:kv.Default}const Iv={streetLine1:"",streetLine2:"",city:"",state:"",countryIso2:"",postCode:"",fullName:"",email:"",phone:"",shipping:"",cardNumber:"",cardholder:"",expiry:"",cvv:"",billingCountry:"",billingZip:"",saveInfo:!0,saveCredentials:!1,formErrors:{},tipAmount:0,savedCredentialId:""},Pv=(e,t)=>{switch(t.type){case"changeAddress1":return{...e,streetLine1:t.payload,formErrors:{...e.formErrors,streetLine1:void 0}};case"changeAddress2":return{...e,streetLine2:t.payload,formErrors:{...e.formErrors,streetLine2:void 0}};case"changeCity":return{...e,city:t.payload,formErrors:{...e.formErrors,city:void 0}};case"changeState":return{...e,state:t.payload,formErrors:{...e.formErrors,state:void 0}};case"changeCountry":return{...e,countryIso2:t.payload.iso2,billingCountry:t.payload.defaultName,formErrors:{...e.formErrors,countryIso2:void 0}};case"changePostCode":return{...e,postCode:t.payload,formErrors:{...e.formErrors,postCode:void 0}};case"changeFullName":return{...e,fullName:t.payload,formErrors:{...e.formErrors,fullName:void 0}};case"changeEmail":return{...e,email:t.payload,formErrors:{...e.formErrors,email:void 0}};case"changePhone":return{...e,phone:t.payload,formErrors:{...e.formErrors,phone:void 0}};case"changeShipping":return{...e,shipping:t.payload};case"changeCardNumber":return{...e,cardNumber:t.payload,formErrors:{...e.formErrors,cardNumber:void 0}};case"changeCardholder":return{...e,cardholder:t.payload,formErrors:{...e.formErrors,cardholder:void 0}};case"changeExpiryDate":return{...e,expiry:t.payload,formErrors:{...e.formErrors,expiry:void 0}};case"changeCvvCode":return{...e,cvv:t.payload,formErrors:{...e.formErrors,cvv:void 0}};case"changeBillingCountry":return{...e,billingCountry:t.payload,formErrors:{...e.formErrors,billingCountry:void 0}};case"changeBillingZip":return{...e,billingZip:t.payload,formErrors:{...e.formErrors,billingZip:void 0}};case"changeSaveInfo":return{...e,saveInfo:t.payload};case"changeSaveCredentials":return{...e,saveCredentials:t.payload};case"updateUserInfo":return t.payload.country?{...e,...t.payload,billingCountry:t.payload.country}:{...e,...t.payload};case"setFormErrors":return{...e,formErrors:{...e.formErrors,...t.payload}};case"setTipAmount":return{...e,tipAmount:t.payload};case"changeSavedCredentialId":return{...e,savedCredentialId:t.payload};case"resetState":return{...Iv};default:return e}};var Mv=a(37960);const Tv={root:"maC_9u6e",description:"zQ6lEVJ2","checkout-picture":"JgWvLdK2",checkoutPicture:"JgWvLdK2",text:"T2pYH395","checkout-title":"HadolzeF",checkoutTitle:"HadolzeF","checkout-description":"oZW7mUNP",checkoutDescription:"oZW7mUNP","price-info":"P618Q3yr",priceInfo:"P618Q3yr","price-info-item":"XNNG_ajy",priceInfoItem:"XNNG_ajy","price-info-item-main":"D9gYNLVk",priceInfoItemMain:"D9gYNLVk","price-info-item-title":"NtY5Aah7",priceInfoItemTitle:"NtY5Aah7",tipsList:"WHO341eB",tipsItem:"ksLlzBxw",tipsItem_active:"J4yem62L",tipsItemActive:"J4yem62L","invoice-info":"U2IBOLP1",invoiceInfo:"U2IBOLP1",provider:"kqWcdro1",stripe:"xKztZrna",smartglocal:"X_Ge1o4u","checkout-info-item-info-title":"ysWuPklS",checkoutInfoItemInfoTitle:"ysWuPklS","checkout-info-item-info-data":"MpC_P8_c",checkoutInfoItemInfoData:"MpC_P8_c","tos-checkbox":"OrRb0xG7",tosCheckbox:"OrRb0xG7",list:"l_wfiFG0"},xv=(0,n.ph)(({title:e,description:t,photo:a,invoice:i,shippingPrices:o,checkoutInfo:c,totalPrice:d,isTosAccepted:m,dispatch:u,onAcceptTos:A,tipAmount:h,needAddress:y,hasShippingOptions:p,savedCredentials:g,isPaymentFormUrl:v,botName:E})=>{const{setPaymentStep:f}=(0,s.ko)(),b=(0,B.A)(),C=(0,Ua.A)(),S=Boolean(u),{termsUrl:k,suggestedTipAmounts:w,maxTipAmount:N}=i||{},{paymentMethod:I,paymentProvider:P,shippingAddress:M,name:T,phone:x,shippingMethod:L}=c||{},R=(0,H.A)((0,l.cy)(a)),{ref:F}=(0,Mv.A)({hasMediaData:Boolean(R)}),D=(0,n.hb)(e=>{u({type:"setTipAmount",payload:N?Math.min(e,N):e})},[u,N]),V=(0,n.hb)(()=>{f({step:g?.length?r.tn.SavedPayments:r.tn.PaymentInfo})},[g?.length,f]),_=(0,n.hb)(()=>{f({step:r.tn.ShippingInfo})},[f]),U=(0,n.hb)(()=>{f({step:r.tn.Shipping})},[f]);return n.Ay.createElement("div",{className:Tv.root},n.Ay.createElement("div",{className:Tv.description},R&&n.Ay.createElement("img",{ref:F,className:Tv.checkoutPicture,src:R,draggable:!1,width:a.dimensions?.width,height:a.dimensions?.height,alt:""}),!R&&a&&n.Ay.createElement($a.A,{width:a.dimensions?.width,height:a.dimensions?.height,className:Tv.checkoutPicture,forceAspectRatio:!0}),n.Ay.createElement("div",{className:Tv.text},n.Ay.createElement("h5",{className:Tv.checkoutTitle},e),t&&n.Ay.createElement("div",{className:Tv.checkoutDescription},(0,Tt.A)(t,["br","links","emoji"])))),n.Ay.createElement("div",{className:Tv.priceInfo},i.prices.map(e=>Bv(C,e.label,e.amount,i.currency)),o&&o.map(e=>Bv(C,e.label,e.amount,i.currency)),w&&w.length>0&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:Tv.priceInfoItem},n.Ay.createElement("div",{className:Tv.priceInfoItemTitle},e),n.Ay.createElement("div",null,(0,mr.vv)(C,h,i.currency))),n.Ay.createElement("div",{className:Tv.tipsList},w.map(e=>n.Ay.createElement("div",{key:e,className:(0,ue.A)(Tv.tipsItem,e===h&&Tv.tipsItem_active),onClick:u?()=>D(e===h?0:e):void 0},(0,mr.vv)(C,e,i.currency,{shouldOmitFractions:!0}))))),void 0!==d&&Bv(C,b("Checkout.TotalAmount"),d,i.currency,!0)),n.Ay.createElement("div",{className:Tv.invoiceInfo},!v&&Lv({title:I||g?.[0].title,label:b("PaymentCheckoutMethod"),icon:"card",onClick:S?V:void 0}),P&&Lv({title:P,label:b("PaymentCheckoutProvider"),customIcon:(0,ue.A)(Tv.provider,Tv[P.toLowerCase()])}),(y||!S&&M)&&Lv({title:M,label:b("PaymentShippingAddress"),icon:"location",onClick:S?_:void 0}),T&&Lv({title:T,label:b("PaymentCheckoutName"),icon:"user"}),x&&Lv({title:x,label:b("PaymentCheckoutPhoneNumber"),icon:"phone"}),(p||!S&&L)&&Lv({title:L,label:b("PaymentCheckoutShippingMethod"),icon:"truck",onClick:S?U:void 0}),k&&(O=k,n.Ay.createElement(as.A,{label:function(e,t){const a=b("PaymentCheckoutAcceptRecurrent",E).split("*");return n.Ay.createElement(n.Ay.Fragment,null,a[0],n.Ay.createElement(Vl.A,{url:e,text:a[1],isRtl:t}),a.slice(2))}(O,b.isRtl),name:"checkout_tos",checked:Boolean(m),className:Tv.tosCheckbox,tabIndex:0,onCheck:A}))));var O});function Bv(e,t,a,s,r=!1){return n.Ay.createElement("div",{className:(0,ue.A)(Tv.priceInfoItem,r&&Tv.priceInfoItemMain)},n.Ay.createElement("div",{className:Tv.priceInfoItemTitle},t),n.Ay.createElement("div",null,(0,mr.vv)(e,a,s)))}function Lv({title:e,label:t,icon:a,customIcon:s,onClick:r}){const i=Boolean(e&&t!==e);return n.Ay.createElement(ca.A,{className:Tv.list,narrow:!0,multiline:i,icon:a,inactive:!r,onClick:r,leftElement:s&&n.Ay.createElement("i",{className:(0,ue.A)("icon",s)})},n.Ay.createElement("div",{className:Tv.checkoutInfoItemInfoTitle},e||t),e&&t!==e&&n.Ay.createElement("p",{className:Tv.checkoutInfoItemInfoData},t))}const Rv=(0,n.ph)(({url:e,noRedirect:t,onClose:a,onPaymentFormSubmit:r})=>{const{openTelegramLink:o}=(0,s.ko)(),l=(0,B.A)(),c=(0,n.hb)(e=>{try{const n=JSON.parse(e.data),{eventType:s,eventData:l}=n;switch(s){case"web_app_open_tg_link":if(!t){const e=i.jsp+l.path_full;o({url:e})}a();break;case"payment_form_submit":r&&r(l);break;default:a()}}catch(e){}},[a,t,o,r]);return(0,n.vJ)(()=>(window.addEventListener("message",c),()=>window.removeEventListener("message",c)),[c]),n.Ay.createElement("div",{className:"ConfirmPayment"},n.Ay.createElement("iframe",{src:e,title:l("Checkout.WebConfirmation.Title"),allow:"payment",sandbox:"allow-modals allow-forms allow-scripts allow-same-origin allow-top-navigation",className:"ConfirmPayment__content"}))}),Fv=(0,n.ph)((0,s.EK)(e=>{const{payment:t}=(0,c.nTw)(e);return{errorKey:t.error?.messageKey,passwordHint:e.twoFaSettings.hint,savedCredentials:"regular"===t.form?.type?t.form.savedCredentials:void 0}})(({isActive:e,errorKey:t,state:a,savedCredentials:r,passwordHint:i,onPasswordChange:o})=>{const{clearPaymentError:l}=(0,s.ko)(),c=(0,B.A)(),d=(0,Ua.A)(),[m,u]=(0,n.J0)(!1),A=(0,n.Kr)(()=>r?.length&&a.savedCredentialId?r.find(({id:e})=>e===a.savedCredentialId)?.title:void 0,[r,a.savedCredentialId]);return n.Ay.createElement("div",{className:"PaymentInfo"},n.Ay.createElement(_m.A,{isBig:!0,isPasswordVisible:m}),n.Ay.createElement(zl.A,{error:t&&d.withRegular(t),hint:i,description:c("PaymentConfirmationMessage",A),placeholder:c("Password"),clearError:l,shouldShowSubmit:!1,shouldResetValue:e,isPasswordVisible:m,onChangePasswordVisibility:u,onInputChange:o}))}));var Dv=a(63173);function Vv(e,t=300){(0,n.vJ)(()=>{E.TF||setTimeout(()=>{(0,o.YS)(()=>{e.current?.focus()})},t)},[e,t])}const _v=a.p+"mastercard.790db81f7978635f77d8.svg",Uv=a.p+"mir.e3a390b90e2e3e292621.svg",Ov=a.p+"visa.fb39984c9532c0336be9.svg",Jv=(0,n.ph)(({value:e,error:t,onChange:a})=>{const s=(0,B.A)(),r=(0,n.li)();Vv(r);const[i,o]=(0,n.J0)(kv.Default);(0,n.vJ)(()=>{const t=Nv(e);o(t)},[]);const l=(0,n.hb)(e=>{const t=function(e){const t=(e=e.replace(/[^\d]/g,"")).match(/.{1,4}/g);return t?t.join(" "):""}(e.target.value),n=Nv(e.target.value);o(n),a(t)},[a]),c=function(e){switch(e){case kv.Mastercard:return n.Ay.createElement("img",{src:_v,draggable:!1,alt:""});case kv.Visa:return n.Ay.createElement("img",{src:Ov,draggable:!1,alt:""});case kv.Mir:return n.Ay.createElement("img",{src:Uv,draggable:!1,alt:""});default:return}}(i);return n.Ay.createElement("div",{className:"CardInput"},n.Ay.createElement(Z.A,{ref:r,label:s("PaymentCardNumber"),onChange:l,value:e,inputMode:"numeric",className:i?"has-right-addon":"",error:t,tabIndex:0,maxLength:19,teactExperimentControlled:!0}),n.Ay.createElement("span",{className:"right-addon"},c))}),Kv=(0,n.ph)(({value:e,error:t,onChange:a})=>{const s=(0,B.A)(),r=(0,n.hb)(t=>{const n=t.target.value;e.endsWith("/")&&e.length>n.length?a(n):a(function(e){const t=(e=e.replace(/[^\d]/g,"").slice(0,4)).match(/.{1,2}/g);return t?.[0]&&Number(t[0])>12&&(t[0]="12"),t?.[0]&&2===t[0].length&&!t[1]&&(t[1]=""),t?t.join("/"):""}(t.target.value))},[a,e]);return n.Ay.createElement(Z.A,{label:s("PaymentCardExpireDate"),onChange:r,value:e,error:t,inputMode:"numeric",tabIndex:0,maxLength:5,teactExperimentControlled:!0})}),Gv=(0,n.ph)(({state:e,canSaveCredentials:t,needCardholderName:a,needCountry:s,needZip:r,countryList:i,dispatch:o})=>{const l=(0,n.li)();(0,n.vJ)(()=>{l.current&&l.current.value!==e.billingCountry&&(l.current.value=e.billingCountry)},[e.billingCountry]);const c=(0,n.hb)(e=>{o({type:"changeCardNumber",payload:e})},[o]),d=(0,n.hb)(e=>{o({type:"changeCardholder",payload:e.target.value.toUpperCase()})},[o]),m=(0,n.hb)(e=>{o({type:"changeExpiryDate",payload:e})},[o]),u=(0,n.hb)(e=>{const t=e.target.value.replace(/[^0-9]/g,"");o({type:"changeCvvCode",payload:t})},[o]),A=(0,n.hb)(e=>{o({type:"changeBillingCountry",payload:e.target.value})},[o]),h=(0,n.hb)(e=>{o({type:"changeBillingZip",payload:e.target.value})},[o]),y=(0,n.hb)(e=>{o({type:"changeSaveCredentials",payload:e.target.value})},[o]),p=(0,B.A)(),g=(0,Ua.A)(),{formErrors:v={}}=e;return n.Ay.createElement("div",{className:"PaymentInfo"},n.Ay.createElement("form",null,n.Ay.createElement("h5",null,p("PaymentCardTitle")),n.Ay.createElement(Jv,{onChange:c,value:e.cardNumber,error:v.cardNumber&&g.withRegular(v.cardNumber)}),a&&n.Ay.createElement(Z.A,{label:p("Checkout.NewCard.CardholderNamePlaceholder"),onChange:d,value:e.cardholder,inputMode:"text",tabIndex:0,error:v.cardholder&&g.withRegular(v.cardholder)}),n.Ay.createElement("section",{className:"inline-inputs"},n.Ay.createElement(Kv,{value:e.expiry,onChange:m,error:v.expiry&&g.withRegular(v.expiry)}),n.Ay.createElement(Z.A,{label:p("lng_payments_card_cvc"),onChange:u,value:e.cvv,inputMode:"numeric",maxLength:3,tabIndex:0,error:v.cvv&&g.withRegular(v.cvv),teactExperimentControlled:!0})),s||r?n.Ay.createElement("h5",null,p("PaymentBillingAddress")):void 0,n.Ay.createElement("section",{className:"inline-inputs"},s&&n.Ay.createElement(Dv.A,{label:p("PaymentShippingCountry"),onChange:A,value:e.billingCountry,hasArrow:Boolean(!0),id:"billing-country",error:v.billingCountry&&g.withRegular(v.billingCountry),tabIndex:0,ref:l},i.map(({defaultName:t,name:a})=>n.Ay.createElement("option",{value:t,className:"county-item",selected:t===e.billingCountry},t||a))),r&&n.Ay.createElement(Z.A,{label:p("PaymentShippingZipPlaceholder"),onChange:h,value:e.billingZip,inputMode:"text",tabIndex:0,maxLength:12,error:v.billingZip&&g.withRegular(v.billingZip)})),n.Ay.createElement("div",{className:"checkbox"},n.Ay.createElement(as.A,{label:p("PaymentCardSavePaymentInformation"),checked:!!t&&e.saveCredentials,tabIndex:0,subLabel:p(t?"Checkout.NewCard.SaveInfoHelp":"Checkout.2FA.Text"),onChange:y,disabled:!t}))))}),jv=(0,n.ph)(({state:e,savedCredentials:t,dispatch:a,onNewCardClick:s})=>{const r=(0,B.A)(),i=(0,n.Kr)(()=>t?.length?t.map(({id:e,title:t})=>({label:t,value:e})):fa.p,[t]),o=(0,n.hb)(e=>{a({type:"changeSavedCredentialId",payload:e})},[a]);return n.Ay.createElement("div",{className:"PaymentInfo"},n.Ay.createElement("form",null,n.Ay.createElement("h5",null,r("PaymentCardTitle")),n.Ay.createElement(ee.A,{name:"saved-credentials",options:i,selected:e.savedCredentialId,onChange:o}),n.Ay.createElement(Y.A,{isText:!0,onClick:s},r("PaymentCheckoutMethodNewCard"))))}),zv=(0,n.ph)(({state:e,shippingOptions:t,currency:a,dispatch:s})=>{const r=(0,B.A)(),i=(0,Ua.A)();(0,n.vJ)(()=>{t&&t.length&&!e.shipping&&s({type:"changeShipping",payload:t[0].id})},[t,e.shipping,s]);const o=(0,n.hb)(e=>{s({type:"changeShipping",payload:e})},[s]),l=(0,n.Kr)(()=>t.map(({id:e,title:t,amount:n})=>({label:t,subLabel:(0,mr.vv)(i,n,a),value:e})),[t,a,i]);return n.Ay.createElement("div",{className:"Shipping"},n.Ay.createElement("form",null,n.Ay.createElement("p",null,r("PaymentShippingMethod")),n.Ay.createElement(ee.A,{name:"shipping-options",options:l,onChange:o,selected:e.shipping})))}),Hv=(0,n.ph)(({state:e,needEmail:t,needPhone:a,needName:s,needAddress:r,countryList:i,dispatch:o})=>{const l=(0,n.li)(),c=(0,n.li)(),d=(0,n.li)();(0,n.vJ)(()=>{d.current&&d.current.value!==e.countryIso2&&(d.current.value=e.countryIso2)},[e.countryIso2]);const m=(0,B.A)(),u=(0,Ua.A)();Vv(l);const A=(0,n.hb)(e=>{o({type:"changeAddress1",payload:e.target.value})},[o]),h=(0,n.hb)(e=>{o({type:"changeAddress2",payload:e.target.value})},[o]),y=(0,n.hb)(e=>{o({type:"changeCity",payload:e.target.value})},[o]),p=(0,n.hb)(e=>{o({type:"changeState",payload:e.target.value})},[o]),g=(0,n.hb)(e=>{o({type:"changeCountry",payload:i.find(t=>t.iso2===e.target.value)})},[i,o]),v=(0,n.hb)(e=>{o({type:"changePostCode",payload:e.target.value})},[o]),E=(0,n.hb)(e=>{o({type:"changeFullName",payload:e.target.value})},[o]),f=(0,n.hb)(e=>{o({type:"changeEmail",payload:e.target.value})},[o]),b=(0,n.hb)(e=>{let{value:t}=e.target;t=`+${t.replace(/\D/g,"")}`,c.current&&(c.current.value=t),o({type:"changePhone",payload:t})},[o]),C=(0,n.hb)(e=>{o({type:"changeSaveInfo",payload:e.target.value})},[o]),{formErrors:S}=e;return n.Ay.createElement("div",{className:"ShippingInfo"},n.Ay.createElement("form",null,r?n.Ay.createElement("div",null,n.Ay.createElement("h5",null,m("PaymentShippingAddress")),n.Ay.createElement(Z.A,{ref:l,label:m("PaymentShippingAddress1Placeholder"),onChange:A,value:e.streetLine1,inputMode:"text",tabIndex:0,error:S.streetLine1&&u.withRegular(S.streetLine1)}),n.Ay.createElement(Z.A,{label:m("PaymentShippingAddress2Placeholder"),onChange:h,value:e.streetLine2,inputMode:"text",tabIndex:0,error:S.streetLine2&&u.withRegular(S.streetLine2)}),n.Ay.createElement(Z.A,{label:m("PaymentShippingCityPlaceholder"),onChange:y,value:e.city,inputMode:"text",tabIndex:0,error:S.city&&u.withRegular(S.city)}),n.Ay.createElement(Z.A,{label:m("PaymentShippingStatePlaceholder"),onChange:p,value:e.state,inputMode:"text",error:S.state&&u.withRegular(S.state)}),n.Ay.createElement(Dv.A,{label:m("PaymentShippingCountry"),onChange:g,value:e.countryIso2,hasArrow:Boolean(!0),id:"shipping-country",error:S.countryIso2&&u.withRegular(S.countryIso2),ref:d,tabIndex:0},i.map(({defaultName:t,name:a,iso2:s})=>n.Ay.createElement("option",{value:s,className:"county-item",selected:s===e.countryIso2},t||a))),n.Ay.createElement(Z.A,{label:m("PaymentShippingZipPlaceholder"),onChange:v,value:e.postCode,inputMode:"text",tabIndex:0,error:S.postCode&&u.withRegular(S.postCode)})):void 0,s||t||a?n.Ay.createElement("h5",null,m("PaymentShippingReceiver")):void 0,s&&n.Ay.createElement(Z.A,{label:m("PaymentShippingName"),onChange:E,value:e.fullName,inputMode:"text",tabIndex:0,error:S.fullName&&u.withRegular(S.fullName)}),t&&n.Ay.createElement(Z.A,{label:m("PaymentShippingEmailPlaceholder"),onChange:f,value:e.email,inputMode:"email",tabIndex:0,error:S.email&&u.withRegular(S.email)}),a&&n.Ay.createElement(Z.A,{label:m("PaymentShippingPhoneNumber"),onChange:b,value:e.phone,inputMode:"tel",tabIndex:0,error:S.phone&&u.withRegular(S.phone),ref:c}),n.Ay.createElement(as.A,{label:m("PaymentShippingSave"),subLabel:m("PaymentShippingSaveInfo"),checked:Boolean(e.saveInfo),tabIndex:0,onChange:C})))}),$v="stripe",qv="smartglocal",Wv=new Set([$v,qv]),Qv=(0,n.ph)((0,s.EK)(e=>{const{form:t,step:a,shippingOptions:n,error:s,confirmPaymentUrl:r,inputInvoice:i,requestId:o,stripeCredentials:d,smartGlocalCredentials:m,temporaryPassword:u,isExtendedMedia:A,url:h}=(0,c.nTw)(e).payment,{invoice:y,nativeParams:p,nativeProvider:g}=t||{},v=e.countryList.general;let E=t?.nativeProvider;!E&&h&&(E=h.startsWith("https://payment.smart-glocal.com")?qv:void 0);const f=i&&"chatId"in i?(0,c.hds)(e,i.chatId):void 0,b=Boolean(y&&(!E||!Wv.has(E))),{needCardholderName:C,needCountry:S,needZip:k}=p||{},w=t?.botId?(0,c.mBe)(e,t.botId):void 0,N=(0,l.Yg)(w);return{step:a,chat:f,shippingOptions:n,nativeProvider:E,isProviderError:b,form:t,invoice:y,needCardholderName:C,needCountry:S,needZip:k,error:s,confirmPaymentUrl:r??h,isPaymentFormUrl:Boolean(!g&&h),countryList:v,requestId:o,hasShippingOptions:Boolean(n?.length),smartGlocalToken:m?.token,stripeId:d?.id,passwordValidUntil:u?.validUntil,isExtendedMedia:A,botName:N}})(({isOpen:e,onClose:t,step:a,shippingOptions:i,form:o,isProviderError:l,invoice:c,nativeProvider:d,needCardholderName:m,needCountry:u,needZip:A,confirmPaymentUrl:h,error:y,countryList:p,hasShippingOptions:g,requestId:v,smartGlocalToken:E,stripeId:f,savedCredentials:b,passwordValidUntil:C,isExtendedMedia:S,isPaymentFormUrl:k,botName:w})=>{const{loadPasswordInfo:N,validateRequestedInfo:I,sendPaymentForm:P,setPaymentStep:T,sendCredentialsInfo:L,clearPaymentError:R,validatePaymentPassword:F,setSmartGlocalCardInfo:D}=(0,s.ko)(),V=(0,B.A)(),_=(0,Ua.A)(),[O,J,K]=(0,M.A)(),[G,j]=(0,Em.A)(Pv,Iv),[z,H]=(0,n.J0)(!1),[$,q]=(0,n.J0)(!1),[W,Z]=(0,n.J0)(""),ee=(0,U.A)(a,!0),te=(0,U.A)(v),ae=a!==r.tn.ConfirmPayment,se=(0,n.hb)(e=>{T({step:e})},[T]);(0,n.vJ)(()=>{e&&(Z(""),N(),J())},[e,N,J]),(0,n.vJ)(()=>{!e&&O&&K()},[K,O,e]),(0,n.vJ)(()=>{(void 0!==a||y)&&H(!1)},[a,y,v]),(0,n.vJ)(()=>{a!==r.tn.Checkout||a!==ee||v===te||G.savedCredentialId||G.cardNumber||se(r.tn.PaymentInfo)},[G.cardNumber,G.savedCredentialId,te,ee,v,se,a]),(0,n.vJ)(()=>{y?.field&&j({type:"setFormErrors",payload:{[y.field]:y.messageKey}})},[y,j]),(0,n.vJ)(()=>{if(o?.savedInfo){const{name:e,phone:t,email:a,shippingAddress:n}=o.savedInfo,{countryIso2:s,...r}=n||{},i=s&&p.find(({iso2:e})=>e===s).defaultName;j({type:"updateUserInfo",payload:{fullName:e,phone:t&&"+"!==t.charAt(0)?`+${t}`:t,email:a,...i&&{country:i,countryIso2:s,...r}}})}},[o,j,p]),(0,n.vJ)(()=>{b?.length&&j({type:"changeSavedCredentialId",payload:b[0].id})},[j,b]);const re=(0,n.hb)(()=>{R()},[R]),ie=(0,n.Kr)(()=>a!==r.tn.Checkout?0:function(e=[],t,a,n){const s=t?Zv(t,a):[];let r=n;return r=e.concat(s||[]).reduce((e,t)=>e+t.amount,r),r}(c?.prices,i,G.shipping,G.tipAmount),[a,c?.prices,i,G.shipping,G.tipAmount]),oe=(0,n.Kr)(()=>{if(a===r.tn.Checkout)return function(e,t,a){const n=function(e){const t=Nv(e);return wv[t]||""}(e.cardNumber),s=n&&e.cardNumber?`${n} *${e.cardNumber.slice(-4)}`:void 0,r=e.streetLine1?`${e.streetLine1}, ${e.city}, ${e.countryIso2}`:void 0,{phone:i,fullName:o}=e,l=t?Yv(t,e.shipping):void 0,c=l?.title;return{paymentMethod:s,paymentProvider:a,shippingAddress:r,name:o,phone:i,shippingMethod:c}}(G,i,d||"")},[a,G,i,d]),le=(0,n.hb)(()=>{se(r.tn.PaymentInfo)},[se]),ce=(0,n.hb)(()=>{R()},[R]),de=(0,n.hb)(()=>{P({shippingOptionId:G.shipping,saveCredentials:G.saveCredentials,savedCredentialId:G.savedCredentialId,tipAmount:G.tipAmount})},[P,G]),me=(0,n.hb)(e=>{const{credentials:t}=e;D(t),de()},[de]),Ae=(0,n.hb)(()=>{const{saveInfo:e}=G,t=function(e){const{streetLine1:t,streetLine2:a,city:n,state:s,countryIso2:r,postCode:i,fullName:o,phone:l,email:c}=e;return{name:o,phone:l,email:c,shippingAddress:{streetLine1:t,streetLine2:a,city:n,state:s,countryIso2:r,postCode:i}}}(G);I({requestInfo:t,saveInfo:e})},[I,G]),he=(0,n.hb)(()=>{const e=function(e){const{cardNumber:t,cardholder:a,expiry:n,cvv:s,billingCountry:r,billingZip:i}=e,[o,l]=n.split("/");return{data:{cardNumber:t,cardholder:a,expiryMonth:o,expiryYear:l,cvv:s,country:r,zip:i}}}(G);L({credentials:e})},[L,G]),ye=(0,x.A)(()=>{switch(a){case r.tn.ShippingInfo:H(!0),Ae();break;case r.tn.Shipping:se(r.tn.Checkout);break;case r.tn.SavedPayments:se(r.tn.ConfirmPassword);break;case r.tn.ConfirmPassword:if(""===W)return;H(!0),F({password:W});break;case r.tn.PaymentInfo:H(!0),he(),j({type:"changeSavedCredentialId",payload:""});break;case r.tn.Checkout:{if(k)return H(!0),void se(r.tn.ConfirmPayment);if(o?.savedInfo&&!v&&!G.shipping)return H(!0),void Ae();if(G.savedCredentialId&&(!C||C<=Date.now()/1e3-3))return void se(r.tn.ConfirmPassword);if(!G.savedCredentialId&&(d===$v&&!f||d===qv&&!E))return void se(r.tn.PaymentInfo);const{phone:e,email:t,fullName:a}=G,n=c?.isEmailRequested&&!t||c?.isPhoneRequested&&!e||c?.isNameRequested&&!a;if(c?.isShippingAddressRequested&&!v||n)return void se(r.tn.ShippingInfo);if(c?.isShippingAddressRequested&&!G.shipping&&i?.length)return void se(r.tn.Shipping);H(!0),de();break}}});(0,n.vJ)(()=>a===r.tn.ConfirmPassword?(0,Ra.A)({onEnter:ye}):void 0,[ye,a]);const pe=(0,n.hb)(()=>{j({type:"resetState"}),q(!1),t()},[t,j]),ge=(0,n.hb)(()=>{se(a===r.tn.ConfirmPassword?r.tn.SavedPayments:r.tn.Checkout)},[se,a]),ve=(0,n.Kr)(()=>{switch(a){case r.tn.Checkout:return V("PaymentCheckout");case r.tn.ShippingInfo:return V("PaymentShippingInfo");case r.tn.Shipping:return V("PaymentShippingMethod");case r.tn.SavedPayments:return V("PaymentCheckoutMethod");case r.tn.ConfirmPassword:return V("Checkout.PasswordEntry.Title");case r.tn.PaymentInfo:return V("PaymentCardInfo");case r.tn.ConfirmPayment:return V("Checkout.WebConfirmation.Title");default:return""}},[a,V]),Ee=a===r.tn.Checkout?V("Checkout.PayPrice",(0,mr.Ad)(ie,c.currency,V.code)):_("PaymentInfoDone");if(l)return n.Ay.createElement(X.A,{className:"error",isOpen:O,onClose:K,onCloseAnimationEnd:pe},n.Ay.createElement("p",null,"Sorry, Telegram Web A doesn't support payments with this provider yet."," ",n.Ay.createElement("br",null),"Please use one of our mobile apps to do this."),n.Ay.createElement("div",{className:"dialog-buttons mt-2"},n.Ay.createElement(Y.A,{isText:!0,onClick:K},V("OK"))));const fe=function(){if(z)return!0;switch(a){case r.tn.Checkout:return Boolean(c?.termsUrl)&&!$;case r.tn.PaymentInfo:return Boolean(""===G.cardNumber||m&&""===G.cardholder||""===G.cvv||""===G.expiry);default:return!1}}();return n.Ay.createElement(X.A,{className:(0,ue.A)("PaymentModal",c?.isRecurring&&"recurring"),isOpen:O,onClose:K,onCloseAnimationEnd:pe},n.Ay.createElement("div",{className:"header",dir:V.isRtl?"rtl":void 0},n.Ay.createElement(Y.A,{className:"close-button",color:"translucent",round:!0,size:"smaller",onClick:a===r.tn.Checkout?K:ge,ariaLabel:"Close"},n.Ay.createElement(Q.A,{name:a===r.tn.Checkout?"close":"arrow-left"})),n.Ay.createElement("h3",null,ve)),void 0!==a?n.Ay.createElement(ne.Ay,{name:"slide",activeKey:a,shouldCleanup:!0,cleanupOnlyKey:r.tn.ConfirmPayment},n.Ay.createElement("div",{className:"content custom-scroll"},function(e){switch(e){case r.tn.Checkout:return n.Ay.createElement(xv,{title:o.title,description:o.description,photo:o.photo,dispatch:j,shippingPrices:G.shipping&&i?Zv(i,G.shipping):void 0,totalPrice:ie,invoice:c,checkoutInfo:oe,isPaymentFormUrl:k,hasShippingOptions:g,tipAmount:G.tipAmount,needAddress:Boolean(c?.isShippingAddressRequested),savedCredentials:b,isTosAccepted:$,onAcceptTos:q,botName:w});case r.tn.SavedPayments:return n.Ay.createElement(jv,{state:G,savedCredentials:b,dispatch:j,onNewCardClick:le});case r.tn.ConfirmPassword:return n.Ay.createElement(Fv,{state:G,savedCredentials:b,onPasswordChange:Z,isActive:e===a});case r.tn.PaymentInfo:return n.Ay.createElement(Gv,{state:G,dispatch:j,canSaveCredentials:Boolean(!o.isPasswordMissing&&o.canSaveCredentials),needCardholderName:m,needCountry:u,needZip:A,countryList:p});case r.tn.ShippingInfo:return n.Ay.createElement(Hv,{state:G,dispatch:j,needAddress:Boolean(c?.isShippingAddressRequested),needEmail:Boolean(c?.isEmailRequested||c?.isEmailSentToProvider),needPhone:Boolean(c?.isPhoneRequested||c?.isPhoneSentToProvider),needName:Boolean(c?.isNameRequested),countryList:p});case r.tn.Shipping:return n.Ay.createElement(zv,{state:G,dispatch:j,shippingOptions:i||[],currency:c.currency});case r.tn.ConfirmPayment:return n.Ay.createElement(Rv,{url:h,noRedirect:S,onPaymentFormSubmit:me,onClose:K});default:return}}(a))):n.Ay.createElement("div",{className:"empty-content"},n.Ay.createElement(Ve.A,{color:"gray"})),ae&&n.Ay.createElement("div",{className:"footer"},n.Ay.createElement(Y.A,{className:"button-text",type:"submit",onClick:ye,disabled:fe,isLoading:z},Ee)),y&&!y.field&&function(){if(y)return n.Ay.createElement(X.A,{className:"error",isOpen:Boolean(y),onClose:re},n.Ay.createElement("h4",null,y.descriptionKey?_.withRegular(y.descriptionKey):_("ErrorUnspecified")),n.Ay.createElement("div",{className:"dialog-buttons mt-2"},n.Ay.createElement(Y.A,{isText:!0,onClick:ce},V("OK"))))}())}));function Yv(e,t){return e.find(({id:e})=>e===t)}function Zv(e,t){const a=Yv(e,t);return a?.prices}const Xv=(0,n.ph)((0,s.EK)(e=>{const{receipt:t}=(0,c.nTw)(e).payment;return{receipt:t}})(({isOpen:e,onClose:t,receipt:a})=>{const s=(0,Ua.A)(),[r,i,o]=(0,M.A)();(0,n.vJ)(()=>{e&&i()},[e,i]);const l=(0,cl.A)(a),c=a||l,d=(0,n.Kr)(()=>{if(c)return function(e,t,a){if(!t)return{paymentMethod:e};const{shippingAddress:n}=t,s=n?.streetLine1?`${n.streetLine1}, ${n.city}, ${n.countryIso2}`:void 0,{phone:r,name:i}=t;return{paymentMethod:e,shippingAddress:s,name:i,phone:r,shippingMethod:a}}(c.credentialsTitle,c.info,c.shippingMethod)},[c]);return n.Ay.createElement(X.A,{className:"PaymentModal PaymentModal-receipt",isOpen:r,onClose:o,onCloseAnimationEnd:t},c&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:"header",dir:s.isRtl?"rtl":void 0},n.Ay.createElement(Y.A,{className:"close-button",color:"translucent",round:!0,size:"smaller",onClick:o,ariaLabel:"Close"},n.Ay.createElement(Q.A,{name:"close"})),n.Ay.createElement("h3",null," ",s("PaymentReceipt")," ")),n.Ay.createElement("div",{className:"receipt-content custom-scroll"},n.Ay.createElement(xv,{shippingPrices:c.shippingPrices,totalPrice:c.totalAmount,tipAmount:c.tipAmount,invoice:c.invoice,checkoutInfo:d,title:c.title,description:c.description,photo:c.photo}))))})),eE="Qo4PtFZI",tE="wtfpombl",aE=(0,n.ph)((0,s.EK)((e,{modal:t})=>({chat:t?.chatId?(0,c.hds)(e,t.chatId):void 0}))(({modal:e,chat:t})=>{const{sendInviteMessages:a,closeInviteViaLinkModal:r,openPremiumModal:i}=(0,s.ko)(),{missingUsers:o}=e||{},c=(0,B.A)(),[d,m]=(0,n.J0)([]),u=(0,n.Kr)(()=>o?.map(e=>e.id)||fa.p,[o]),[A,h]=(0,n.Kr)(()=>{if(!o?.length)return[[],[]];const[e,t]=(0,Ea.jB)(o,e=>e.isRequiringPremiumToMessage);return[e.map(e=>e.id),t.map(e=>e.id)]},[o]),y=(0,n.Kr)(()=>o?.filter(e=>e.isRequiringPremiumToInvite||e.isRequiringPremiumToMessage).map(e=>e.id),[o]),p=(0,n.Kr)(()=>{if(o)return!o.some(e=>e.isRequiringPremiumToInvite&&!e.isRequiringPremiumToMessage)},[o]),g=(0,n.Kr)(()=>{const e=(0,s.mS)().users.byId;return y?.map(t=>e[t])},[y]);(0,n.vJ)(()=>{m(h)},[h]);const v=(0,x.A)(()=>r()),E=(0,n.hb)(()=>{a({chatId:t.id,userIds:d}),r()},[d,t]),f=(0,n.hb)(()=>{i()},[]),b=(0,n.Kr)(()=>{if(t)return Boolean(t?.isCreator||t?.adminRights?.inviteUsers)},[t]),C=(0,n.Kr)(()=>b?c(1===o?.length?"InviteBlockedOneMessage":"InviteBlockedManyMessage"):c("InviteRestrictedUsers2",o?.length),[b,c,o?.length]),S=(0,n.Kr)(()=>{if(!y?.length||!g?.length)return;const e=p?"InviteMessagePremiumBlocked":"InvitePremiumBlocked";let t=`${e}One`,a=[(0,l.Yg)(g[0])];return 2===y.length?(t=`${e}Two`,a=[(0,l.Yg)(g[0]),(0,l.Yg)(g[1])]):3===y.length?(t=`${e}Three`,a=[(0,l.Yg)(g[0]),(0,l.Yg)(g[1]),(0,l.Yg)(g[2])]):y.length>3&&(t=`${e}Many`,a=[(0,l.Yg)(g[0]),(0,l.Yg)(g[1]),(y.length-2).toString()]),c(t,a,void 0,g.length)},[y,p,c,g]),k=Boolean(g?.length),w=Boolean(h?.length);return n.Ay.createElement(X.A,{isOpen:Boolean(u&&t),contentClassName:"n8eENbaR",onClose:v,isSlim:!0},n.Ay.createElement(Y.A,{round:!0,color:"translucent",size:"smaller",className:"smosGkw9",ariaLabel:c("Close"),onClick:v},n.Ay.createElement(Q.A,{name:"close"})),S&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(on.A,{className:"Nc3SOtKd",peers:g,size:"large"}),n.Ay.createElement("h3",{className:tE},c(b?"InvitePremiumBlockedTitle":"ChannelInviteViaLinkRestricted")),n.Ay.createElement("p",{className:eE},(0,Tt.A)(S,["simple_markdown"])),n.Ay.createElement(Y.A,{withPremiumGradient:!0,isShiny:!0,size:"smaller",onClick:f},c("InvitePremiumBlockedSubscribe"))),k&&w&&n.Ay.createElement(Ic.A,{className:"UoMeVIyC"},c("InvitePremiumBlockedOr")),w&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("h3",{className:tE},c("InviteBlockedTitle")),n.Ay.createElement("p",{className:eE},C),n.Ay.createElement(ba.A,{className:"nEYyTS_m",itemIds:u,selectedIds:d,lockedUnselectedIds:A,lockedUnselectedSubtitle:c("InvitePremiumBlockedUser"),onSelectedIdsChange:m,isViewOnly:!b,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"}),b&&n.Ay.createElement(Y.A,{className:"Ttkq3nqt",size:"smaller",onClick:E,disabled:!d.length},c("SendInviteLink.ActionInvite"))))}));var nE=a(84555);const sE=(0,n.ph)(({modal:e})=>{const{closeOneTimeMediaModal:t}=(0,s.ko)(),a=(0,B.A)(),i=(0,La.A)(e?.message,!0),{shouldRender:o,transitionClassNames:d}=(0,Ke.A)(Boolean(e)),m=(0,x.A)(()=>{}),u=(0,x.A)(()=>{t()});if(!o||!i)return;const A=(0,l.Ie)(i),h=(0,c.SJA)((0,s.mS)()),y=a(A?"Chat.Voice.Single.Close":"Chat.Voice.Single.DeleteAndClose");return n.Ay.createElement("div",{className:(0,ue.A)("c3xMWwzW",d)},function(){if(!i?.content)return;const{voice:e,video:t}=i.content;return e?n.Ay.createElement(Nd.Ay,{className:"VLiJWMs0",theme:h,message:i,origin:r.d9.OneTimeModal,autoPlay:!0,onPlay:m,onPause:u}):t?.isRound?n.Ay.createElement(nE.A,{className:"ML2YEpGq",message:i,origin:"oneTimeModal",onStop:u}):void 0}(),n.Ay.createElement("div",{className:"VWy1qXJL"},n.Ay.createElement(Y.A,{faded:!0,onClick:u,pill:!0,size:"smaller",color:"dark"===h?"dark":"secondary",className:"FfMrCmD9"},y)))}),rE=(0,n.ph)(({isOpen:e})=>{const t=(0,B.A)(),a=(0,Ua.A)(),{closeWebAppsCloseConfirmationModal:r,closeWebAppModal:i}=(0,s.ko)(),[o,l]=(0,n.J0)(!1),c=(0,n.li)(),d=(0,n.hb)(()=>{r({shouldSkipInFuture:o})},[o]),m=(0,n.hb)(()=>{i({shouldSkipConfirmation:!0}),r({shouldSkipInFuture:o})},[o]),u=(0,n.hb)(e=>{-1===e&&m()},[m]),A=(0,Fn.A)(c,e,u,".Button");return n.Ay.createElement(X.A,{className:(0,ue.A)("confirm"),title:a("CloseMiniApps"),isOpen:e,onClose:d},n.Ay.createElement("p",null,a("AreYouSureCloseMiniApps")),n.Ay.createElement(as.A,{className:"dialog-checkbox",label:a("DoNotAskAgain"),checked:o,onCheck:l}),n.Ay.createElement("div",{className:"dialog-buttons mt-2",ref:c,onKeyDown:A},n.Ay.createElement(Y.A,{className:"confirm-dialog-button",isText:!0,onClick:m,color:"danger"},t("Confirm")),n.Ay.createElement(Y.A,{className:"confirm-dialog-button",isText:!0,onClick:d},t("Cancel"))))}),iE=(0,n.ph)((0,s.EK)(e=>{const t=e.appConfig?.freezeUntilDate,a=e.appConfig?.freezeAppealUrl,n=e.botFreezeAppealId?(0,c.mBe)(e,e.botFreezeAppealId):void 0;return{freezeUntilDate:t,freezeAppealUrl:a,botFreezeAppealUsername:n&&(0,l.Kl)(n)}})(({modal:e,freezeUntilDate:t,freezeAppealUrl:a,botFreezeAppealUsername:r})=>{const{closeFrozenAccountModal:i,openUrl:o}=(0,s.ko)(),l=(0,Ua.A)(),c=Boolean(e),d=(0,x.A)(()=>{i()}),m=(0,x.A)(()=>{i(),a&&o({url:a})}),u=(0,n.Kr)(()=>n.Ay.createElement("div",{className:"cW2rtp6M"},n.Ay.createElement(So.A,{size:160,tgsUrl:Co.w.BannedDuck,noLoop:!0}),n.Ay.createElement("div",{className:"qLSm0uyC"},l("FrozenAccountModalTitle"))),[l]),A=(0,n.Kr)(()=>{if(c)return n.Ay.createElement("div",{className:"Vj3QQ_JQ"},n.Ay.createElement(Y.A,{className:"anvg3JaY",size:"smaller",onClick:m,noForcedUpperCase:!0},l("ButtonAppeal")),n.Ay.createElement(Y.A,{isText:!0,size:"smaller",onClick:d,noForcedUpperCase:!0},l("ButtonUnderstood")))},[l,c]);if(!t||!r)return;const h=new Date(1e3*t),y=n.Ay.createElement(Ni.A,{onClick:m,isPrimary:!0},(0,Vc.A)(r)),p=[["hand-stop",l("FrozenAccountViolationTitle"),l("FrozenAccountViolationSubtitle")],["lock",l("FrozenAccountReadOnlyTitle"),l("FrozenAccountReadOnlySubtitle")],["frozen-time",l("FrozenAccountAppealTitle"),l("FrozenAccountAppealSubtitle",{botLink:y,date:(0,$e.A)(h,l.code)},{withNodes:!0})]];return n.Ay.createElement(Ul.A,{isOpen:c,header:u,listItemData:p,footer:A,hasBackdrop:!0,onClose:d})}))}}]);
//# sourceMappingURL=9451.4a7fd3f3d54689e44b60.js.map